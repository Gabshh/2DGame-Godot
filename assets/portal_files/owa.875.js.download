(window.$wj=window.$wj||[]).push([[875],{10584:function(e,n,t){"use strict";t.d(n,"c",(function(){return r})),t.d(n,"d",(function(){return c})),t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return l})),t.d(n,"f",(function(){return u})),t.d(n,"e",(function(){return s}));var i=t(20);const o=new i.c(()=>Promise.all([t.e(0),t.e(928)]).then(t.bind(null,14182)));let r=new i.a(o,e=>e.initializeUpsellBarState),c=new i.a(o,e=>e.initializeLeftNavUpsellState),a=new i.b(o,e=>e.ArcStore),l=new i.b(o,e=>e.BizBarArcStore),u=new i.a(o,e=>e.makeImpressionCall),s=new i.a(o,e=>e.makeBeaconCall)},10592:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return l}));var i=t(11978),o=t(9),r=t(99);function c(){var e;return!!(null===(e=null===window||void 0===window?void 0:window.navigator)||void 0===e?void 0:e.registerProtocolHandler)}function a(){if(!Object(o.b)(window,"MailToBannerAskAgainLater")){const e=Object(o.a)(window,i.b);if(e){const n=parseInt(e);Object(o.e)(window,i.b,(n+1).toString())}else Object(o.e)(window,i.b,"1")}}function l(){if(Object(r.f)()||Object(r.g)())return!1;if(Object(o.c)(window)){if(Object(o.b)(window,"MailToBannerTryItNow")||Object(o.b)(window,"MailToBannerClose"))return!1;if(Object(o.b)(window,"MailToBannerAskAgainLater"))return(new Date).getTime()-Number(Object(o.a)(window,"MailToBannerAskAgainLater"))>=i.a;{const e=Object(o.a)(window,i.b);return!e||parseInt(e)<=i.c}}return!1}},11978:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return o})),t.d(n,"a",(function(){return r})),t.d(n,"d",(function(){return c}));const i="mailtoHandlerIgnoredCount",o=14,r=6048e5,c={"https://outlook-sdf.office.com":"AugAIqsZDxGSVhnlEo0b/F1lgqztKRxkOfYrcIOvWJmm9lvo+HbqtpfvOBJRTp3paOK7ecDCRlNFfaFmsvKBFHIAAAB6eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLm9mZmljZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYzNzYxMjUxMX0=","https://outlook.office.com":"Am+WI2I40F25oTkqP5Ys+utnzwAsoI6jqgTlGG8to9eAkFQVDlvx9QtDpAiLN0k0TGCfySH4S2C3aZCKxd/XX68AAAB2eyJvcmlnaW4iOiJodHRwczovL291dGxvb2sub2ZmaWNlLmNvbTo0NDMiLCJpc1N1YmRvbWFpbiI6dHJ1ZSwiZmVhdHVyZSI6IlBhcnNlVXJsUHJvdG9jb2xIYW5kbGVyIiwiZXhwaXJ5IjoxNjM3NjEyNTI5fQ==","https://outlook-sdf.live.com":"AlSSLoybQyyL2N1S9eNsW42rpOymUMKCA6xw5hHCENqtpbtg93HxlyXhbjVyEYxHg9QxNqSOvrbsQjBKhtEawvQAAAB4eyJvcmlnaW4iOiJodHRwczovL291dGxvb2stc2RmLmxpdmUuY29tOjQ0MyIsImlzU3ViZG9tYWluIjp0cnVlLCJmZWF0dXJlIjoiUGFyc2VVcmxQcm90b2NvbEhhbmRsZXIiLCJleHBpcnkiOjE2Mzc2MTI1NTR9","https://outlook.live.com":"AkTNbUVviYOixRg4gKB7FammnVLuqXtO9VR71GZdDUPbUeMF0B0KYkHhpAVBc56Isq9A2zxibVh1AUlArykZTtIAAAB0eyJvcmlnaW4iOiJodHRwczovL291dGxvb2subGl2ZS5jb206NDQzIiwiaXNTdWJkb21haW4iOnRydWUsImZlYXR1cmUiOiJQYXJzZVVybFByb3RvY29sSGFuZGxlciIsImV4cGlyeSI6MTYzNzYxMjU0OH0="}},1865:function(e,n,t){"use strict";var i=t(1741),o=t(36),r=t(5),c=t(16),a=t(3),l=Object(a.mutatorAction)("initializeLightning",(function(e){if(o.h.info("initialize lightning store"),Object(i.a)().lastShownId=null,Object(i.a)().lightedCount=0,Object(i.a)().unseenItems=new c.ObservableMap,e)for(let n of e)Object(i.a)().unseenItems.set(n.identity,n)}));var u=t(327);const s="ows/v1.0/lightning/items/unseen";function d(){return o.h.info("initialize lightning from server"),Object(u.b)(s).then(e=>{let n=e.map(b);l(n)})}function b(e){return e.category?{identity:e.id,visible:!1,category:e.category}:{identity:e,visible:!1}}var f=t(38);let m;const O="lightning",j="UnseenLightening";function w(){if(!m){const n=Object(r.c)(O);if(n)m=function(e){o.h.info("initialize lightning from override query parameter");let n=e.split(",").map(e=>({identity:e,visible:!1}));return l(n),Promise.resolve()}(n);else{let n=Object(f.a)().PrimeSettings;if(null==n?void 0:n.Items)for(let t of n.Items)if(t.Id===j&&t.Value){e=t.Value,o.h.info("initialize lightning from session data"),l(e.map(e=>({identity:e.id,visible:!1,category:e.category}))),m=Promise.resolve();break}m||(m=d())}}var e;return m}var p=t(2327);let v=Object(a.action)("lightup",e=>({id:e}));var h=v;Object(a.mutator)(v,e=>{o.h.info(`lightup - id:${e.id}`),Object(i.a)().lastShownId=e.id,Object(i.a)().lightedCount++;const n=Object(i.a)().unseenItems.get(e.id);n&&(n.visible=!0)}),Object(a.orchestrator)(v,(function(e){Object(p.a)("LIGHTUP",e.id)}));var g,I=t(610);function y(e,n){if(o.h.info(`lightupOrReject - id:${e}, recurrenceCount:${n}, lightedCount:${Object(i.a)().lightedCount}, lastShown:${Object(i.a)().lastShownId}`),Object(I.w)())return void o.h.info("lightning is disabled for deeplink");if(!Object(i.a)().unseenItems.has(e))return;(!Object(i.a)().lastShownId||function(e,n){let t=!1;const{lastShownId:o}=Object(i.a)();if(o&&n&&!function(){const{lastShownId:e,unseenItems:n}=Object(i.a)();return e&&n.has(e)&&n.get(e).visible}()){let i=n.indexOf(o),r=n.indexOf(e);i>=0&&i+1==r&&(t=!0)}return t}(e,n)||function(e){const n=Object(i.a)().unseenItems.get(e);return!!n&&n.category==g.UIFeatureDiscovery}(e)||function(e){const n=Object(i.a)().unseenItems.get(e);return!!n&&n.category==g.Compliance}(e))&&h(e)}function S(e,n,t){o.h.info(`beginLightning - id:${e}`),n(()=>{w().then(()=>y(e,t)).catch(n=>{o.h.warn(`something is wrong, lightning id:${e}, reason:${n}`)})})}!function(e){e.None="0",e.UpSell="1",e.FeatureDiscovery="2",e.TeachingMoment="3",e.UITeachingMoment="4",e.UIFeatureDiscovery="5",e.UIUpSell="6",e.JITNewUser="7",e.Compliance="8",e.SatCoreMetric="9",e.UpSellExperiment="10"}(g||(g={}));var A=t(1861),k=t(1908);t.d(n,"d",(function(){return i.b})),t.d(n,"b",(function(){return S})),t.d(n,"a",(function(){return A.a})),t.d(n,"c",(function(){return k.a}))},19622:function(e,n,t){"use strict";t.r(n);var i=t(23),o=t(0),r=t(2027),c=t(20);const a=new c.c(()=>t.e(983).then(t.bind(null,19929)));let l=Object(c.d)(a,e=>e.IrisUpsellBanner);var u=t(10592);const s=new c.c(()=>t.e(891).then(t.bind(null,19930))),d=Object(c.d)(s,e=>e.MailtoProtocolUpsellBanner);var b,f=t(3);!function(e){e.IrisUpsell="IrisUpsell",e.OWAMailHandlerUpsell="OWAMailHandlerUpsell",e.CommercialBizBar="CommercialBizBar",e.None=""}(b||(b={}));let m=Object(f.createStore)("UpsellBannerState",{upsellBannerType:b.None})();var O=t(47),j=t(10584),w=Object(f.mutatorAction)("setUpsellBannerType",e=>{m.upsellBannerType=e}),p=t(99),v=t(4738),h=t(132),g=t(38);async function I(e){const{IsConsumerChild:n}=Object(g.a)();if(n)return!1;let t=await j.b.import();return(null==t?void 0:t.message)||await j.c.importAndExecute(),w(e),!!t.message}const y=Object(i.a)((function(){const[e,n]=o.useState(!1);if(o.useEffect(()=>{!async function(){let e=await async function(){var e=Object(v.b)(v.a.OutlookRecommendation);return Object(O.j)("fwk-mailtoProtocolHandler")&&Object(h.a)("showOWAMailtoBanner")&&Object(u.a)()&&Object(u.b)()?(w(b.OWAMailHandlerUpsell),!0):Object(O.j)("iris-commercial-bizbar")&&Object(p.n)()&&e?I(b.CommercialBizBar):!(Object(p.i)()||Object(p.e)()||Object(p.o)()||Object(p.k)()||!Object(O.j)("edge-iris-upsell-experiment"))&&I(b.IrisUpsell)}();n(e)}()},[]),e)switch(m.upsellBannerType){case b.CommercialBizBar:return o.createElement(l,{lid:r.b.CommercialBizBar});case b.IrisUpsell:return o.createElement(l,{lid:r.b.EdgeUpsell});case b.OWAMailHandlerUpsell:return o.createElement(d,{lid:r.b.MailtoProtocolHandler});default:return o.createElement("div",null)}return null}));t.d(n,"TopUpsellBanner",(function(){return y}))},2027:function(e,n,t){"use strict";var i=t(23),o=t(1865),r=t(0),c=t.n(r),a=t(1805);function l(e,n){const t=(n,t)=>c.a.createElement(u,Object.assign({},n),c.a.createElement(e,Object.assign({},n)));return t.displayName=e.displayName,n?c.a.forwardRef(t):t}const u=Object(i.a)((function(e){const{lid:n,when:t,series:i,children:r,disposeOnUnmount:l=!0}=e;return c.a.useEffect(()=>(Object(o.b)(n,t,i),()=>{l&&o.c.importAndExecute(n)}),[]),r&&Object(a.a)(n)?c.a.createElement(c.a.Fragment,null,r):null}));var s=t(2054);t.d(n,"c",(function(){return l})),t.d(n,"a",(function(){return u})),t.d(n,"e",(function(){return a.a})),t.d(n,"d",(function(){return s.a})),t.d(n,"b",(function(){return o.a}))},2327:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var i=t(71),o=t(1861);function r(e,n){Object.keys(o.a).some(t=>o.a[t]==n&&(Object(i.o)(e,{key:t,id:n},{isCore:!0}),!0))}},4631:function(e,n,t){"use strict";t.d(n,"i",(function(){return i})),t.d(n,"k",(function(){return o})),t.d(n,"h",(function(){return r})),t.d(n,"m",(function(){return c})),t.d(n,"n",(function(){return a})),t.d(n,"j",(function(){return l})),t.d(n,"l",(function(){return u})),t.d(n,"c",(function(){return s})),t.d(n,"b",(function(){return d})),t.d(n,"e",(function(){return b})),t.d(n,"g",(function(){return f})),t.d(n,"d",(function(){return m})),t.d(n,"f",(function(){return O})),t.d(n,"a",(function(){return j}));const i="ocpsfeedbackenabled",o="ocpsnpssurveyenabled",r="ocpsemailcollectionenabled",c="ocpspoliciesexpiration",a="ocpsscreenshotenabled",l="ocpslogcollectionenabled",u="ocpsoutlookrecommendationenabled",s="office16;L_SendFeedback",d="office16;L_EmailCollection",b="office16;L_SendSurvey",f="office16;L_Screenshot",m="office16;L_LogCollection",O="outlk16;L_RecommendOutlookExtension",j="CheckIn-Interval"},4738:function(e,n,t){"use strict";var i=t(20);const o=new i.c(()=>Promise.all([t.e(0),t.e(929)]).then(t.bind(null,19778)));let r=new i.a(o,e=>e.fetchPoliciesAndSetStore);var c;!function(e){e[e.Contact=0]="Contact",e[e.Content=1]="Content",e[e.Feedback=2]="Feedback",e[e.NpsSurvey=3]="NpsSurvey",e[e.OutlookRecommendation=4]="OutlookRecommendation",e[e.ScreenShot=5]="ScreenShot"}(c||(c={}));var a=t(4631);var l=t(9),u=t(296),s=t(47);function d(e){if(Object(u.a)()||!Object(s.j)("ocps-policy-check"))return!0;let n=function(e){switch(e){case c.Contact:return a.h;case c.Content:return a.j;case c.Feedback:return a.i;case c.NpsSurvey:return a.k;case c.OutlookRecommendation:return a.l;case c.ScreenShot:return a.n;default:return""}}(e);return!(!Object(l.c)(window)||!Object(l.b)(window,n))&&"1"==Object(l.a)(window,n)}t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return c})),r.importAndExecute()}}]);
//# sourceMappingURL=owa.875.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.875.js'] = 1;