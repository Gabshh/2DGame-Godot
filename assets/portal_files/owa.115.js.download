(window.$wj=window.$wj||[]).push([[115],{11840:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(71);function i(n,e,t,i,o,c,u){Object(r.o)("SharePointLinkClick",{newTabReason:n,isSafeLinkWrapped:e,isSafeLinkVerified:t,extraInfo:i,isOfficeSPLink:o,isServiceGeneratedLink:c,fileExtension:u},{isCore:!0})}},13460:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(11840),i=t(7584);function o(n,e,t){n.button===i.a?Object(r.a)("MouseMiddleButton",e,t):n.button===i.b&&Object(r.a)("MouseRightButton",e,t)}},13461:function(n,e,t){"use strict";t.d(e,"a",(function(){return s}));var r=t(71),i=t(326),o=t(2652),c=t(11840),u=t(2338),a=t(8848);function s(n,e,t,s){const d=Date.now(),f=new r.b("ServiceGeneratedLinkClickHandler"),l=`CT=${d}&OR=OWA-${n?n.ctrlKey||1===n.button?"NTB":n.shiftKey?"NW":"NT":"NT"}&CID=${Object(i.a)()}`;let p;const b=n.currentTarget,O=(I=new URL(b.href),["CID","OR","CT"].forEach(n=>{var e;(null===(e=I.searchParams)||void 0===e?void 0:e.get(n))&&I.searchParams.delete(n)}),I);var I;if(e){const n=O.href,e=n.indexOf(o.c);if(-1===e)return;const t=encodeURIComponent(btoa(l));p=n.substr(0,e)+"&xdata="+t+o.c}else{const n=O.href.indexOf("?")>=0?"&":"?";p=O.href+n+l}f.end(),window.open(p),n.preventDefault();const w={fileExt:""};Object(a.a)(e?b.getAttribute(o.b):O.toString(),!0,!0,w).then(r=>{u.f.import().then(r=>{Object(c.a)(s||(n.altKey?"AltKey":n.ctrlKey?"CtrlKey":n.metaKey?"MetaKey":n.shiftKey?"ShiftKey":"Default"),e,t,void 0,void 0,r(e?b.getAttribute(o.b):O.toString()),w.fileExt)})})}},1696:function(n,e,t){"use strict";var r=t(1709),i=t(2213),o=t(6);function c(n){let e;return n>=1073741824?(n/=1073741824,e=Object(o.b)(i.b)):n>=1048576?(n/=1048576,e=Object(o.b)(i.d)):n>=1024?(n/=1024,e=Object(o.b)(i.c)):e=Object(o.b)(i.a),Object(o.c)(e,Math.round(n))}var u=t(1850),a=t(47);const s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function d(n){if(!Object(a.j)("doc-attachment-documentThumbnail"))return!1;const e=Object(r.a)(n);return!!e&&s.indexOf(e.toLowerCase())>=0}var f;function l(n){switch(n){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return f.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return f.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return f.PowerPoint;default:return null}}!function(n){n[n.Word=0]="Word",n[n.Excel=1]="Excel",n[n.PowerPoint=2]="PowerPoint"}(f||(f={}));var p=t(1816);t.d(e,"b",(function(){return r.a})),t.d(e,"c",(function(){return r.b})),t.d(e,"d",(function(){return r.c})),t.d(e,"i",(function(){return c})),t.d(e,"g",(function(){return u.a})),t.d(e,"h",(function(){return d})),t.d(e,"f",(function(){return l})),t.d(e,"e",(function(){return p.b})),t.d(e,"a",(function(){return f}))},1709:function(n,e,t){"use strict";function r(n){if(!n)return null;const e=n.lastIndexOf(".");return e>0?n.substr(e).toLowerCase():null}function i(n){const e=r(n);return e?e.replace(".",""):null}function o(n){var e;return(null===(e=i(n))||void 0===e?void 0:e.substring(0,4))||""}t.d(e,"a",(function(){return r})),t.d(e,"b",(function(){return i})),t.d(e,"c",(function(){return o}))},1713:function(n,e,t){"use strict";t.d(e,"a",(function(){return i}));var r=t(1824);function i(n){if(!n)return null;return Object(r.a)().attachments.get(n.Id)}},1739:function(n,e,t){"use strict";t.d(e,"a",(function(){return i})),t.d(e,"i",(function(){return o})),t.d(e,"d",(function(){return c})),t.d(e,"c",(function(){return u})),t.d(e,"g",(function(){return a})),t.d(e,"b",(function(){return s})),t.d(e,"h",(function(){return d})),t.d(e,"f",(function(){return f})),t.d(e,"e",(function(){return l}));var r=t(3);const i=Object(r.action)("ADD_SHARING_LINK",(n,e,t,r,i,o,c,u,a,s,d,f,l)=>({linkId:n,url:e,sharingLinkIds:t,response:r,source:i,providerType:o,linksContainerId:c,unwrappedUrl:u,creationDateTime:a,thumbnailUrl:s,previewUrl:d,shareId:f,fromQuotedBody:l})),o=Object(r.action)("SHARING_LINK_REMOVED",(n,e,t,r,i)=>({linkId:n,sharingLinkIds:e,fileName:t,providerType:r,linksContainerId:i})),c=Object(r.action)("DELETE_LINK",(n,e)=>({linkId:n,targetWindow:e})),u=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(n,e,t,r)=>({linkId:n,providerId:e,isTryAgain:t,targetWindow:r})),a=Object(r.action)("ON_LINK_HAS_CHANGED",(n,e,t,r)=>({linkId:n,recipientInfos:e,composeId:t,isCalendar:r})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(n,e)=>({linkId:n,linkIdContainer:e})),d=Object(r.action)("REMOVE_SHARING_LINK_FROM_CONTAINER",(n,e)=>({linkId:n,linkIdContainer:e})),f=Object(r.action)("ON_FLUID_LINK_CREATED",(n,e,t,r,i)=>({linkId:n,containerId:e,owaSource:t,url:r,viewStateId:i})),l=Object(r.action)("ON_EXISTING_FLUID_LINK_PROCESSED",(n,e,t,r,i)=>({linkId:n,containerId:e,owaSource:t,url:r,viewStateId:i}))},1808:function(n,e,t){"use strict";var r,i=t(20),o=t(1739),c=t(1821),u=t(2409);!function(n){n.PasteHtml="PasteHtml",n.InsertLinkFromToolbar="InsertLinkFromToolbar",n.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",n.InsertLinkFromSonora="InsertLinkFromSonora",n.AutoLink="AutoLink",n.ReplyOrForward="ReplyOrForward",n.LinkContextMenu="LinkContextMenu",n.Undo="Undo",n.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",n.RestoreCursor="RestoreCursor",n.ShareLinkCompose="ShareLinkCompose",n.NewFluidFile="NewFluidFile",n.Unknown="Unknown"}(r||(r={}));var a=t(2104),s=t(2424),d=t(2369),f=t(1898),l=t(1912);const p=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function b(n){const e=Object(l.a)(n);return e&&-1!==p.indexOf(e.source)}var O=t(2349);function I(n){const e=Object(l.a)(n);return e?{id:e.linkId,name:e.fileName,supportsDownsell:!1,currentPermissionLevel:e.permissionLevel,sharingInfo:e.sharingInfo,sharingTipsIgnored:e.sharingTipsIgnored,sharingRecipientsInfo:e.sharingRecipientsInfo,typeOfLink:b(n)?"newLink":"oldLink"}:null}var w=t(2316);function h(){return Object(w.a)().sharingLinks.size}var g=t(2410);t.d(e,"t",(function(){return L})),t.d(e,"D",(function(){return S})),t.d(e,"K",(function(){return m})),t.d(e,"G",(function(){return v})),t.d(e,"E",(function(){return j})),t.d(e,"B",(function(){return E})),t.d(e,"H",(function(){return T})),t.d(e,"I",(function(){return _})),t.d(e,"J",(function(){return R})),t.d(e,"v",(function(){return N})),t.d(e,"s",(function(){return P})),t.d(e,"A",(function(){return y})),t.d(e,"u",(function(){return C})),t.d(e,"F",(function(){return A})),t.d(e,"C",(function(){return U})),t.d(e,"y",(function(){return x})),t.d(e,"x",(function(){return D})),t.d(e,"w",(function(){return W})),t.d(e,"z",(function(){return F})),t.d(e,"P",(function(){return k})),t.d(e,"d",(function(){return o.a})),t.d(e,"e",(function(){return o.b})),t.d(e,"f",(function(){return o.c})),t.d(e,"h",(function(){return o.d})),t.d(e,"R",(function(){return o.h})),t.d(e,"T",(function(){return o.i})),t.d(e,"M",(function(){return o.f})),t.d(e,"N",(function(){return o.g})),t.d(e,"L",(function(){return o.e})),t.d(e,"U",(function(){return c.e})),t.d(e,"V",(function(){return c.f})),t.d(e,"W",(function(){return c.g})),t.d(e,"S",(function(){return c.c})),t.d(e,"g",(function(){return c.b})),t.d(e,"Q",(function(){return u.b})),t.d(e,"a",(function(){return r})),t.d(e,"o",(function(){return a.a})),t.d(e,"q",(function(){return a.b})),t.d(e,"O",(function(){return s.a})),t.d(e,"c",(function(){return d.a})),t.d(e,"i",(function(){return f.a})),t.d(e,"j",(function(){return f.b})),t.d(e,"r",(function(){return f.c})),t.d(e,"p",(function(){return b})),t.d(e,"b",(function(){return O.a})),t.d(e,"m",(function(){return l.a})),t.d(e,"l",(function(){return I})),t.d(e,"k",(function(){return h})),t.d(e,"n",(function(){return g.a}));const k=new i.c(()=>Promise.all([t.e(0),t.e(24),t.e(96),t.e(525)]).then(t.bind(null,19465))),L=new i.b(k,n=>n.addRecipientsIntoLink),S=new i.b(k,n=>n.removeRecipientsFromLink),m=new i.b(k,n=>n.updateRecipientPermissionInfos),v=new i.b(k,n=>n.setGetPermissionInfoFailure),j=new i.b(k,n=>n.resetSharingRecipientsInfo),E=new i.b(k,n=>n.ignoreSharingTip),T=new i.b(k,n=>n.setLinkActionStatus),_=new i.b(k,n=>n.updateLinkContainerIdOfLink),R=new i.b(k,n=>n.updateLinkIds),N=new i.b(k,n=>n.createLinksIdContainer),P=new i.b(k,n=>n.addLinkIdToLinksIdContainer),y=new i.b(k,n=>n.getSharingTipRecipientInfo),C=new i.b(k,n=>n.createCloudFileFromSharingLink),A=new i.b(k,n=>n.retrieveImageUrlsForImageFile),U=new i.b(k,n=>n.imageLinkPreviewCondition),x=new i.b(k,n=>n.getLinksIdContainer),D=new i.b(k,n=>n.getAllLinksContainerIds),W=new i.b(k,n=>n.doesLinksIdContainerExist),F=new i.b(k,n=>n.getSharingLinkInfo)},1816:function(n,e,t){"use strict";function r(n){return function(n){const e=o.exec(n);return e&&e.length>1&&i[e[1].toLowerCase()]}(n||"")}t.d(e,"a",(function(){return r})),t.d(e,"b",(function(){return c}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},o=/^\s*([^;\s]*)(?:;|\s|$)/;function c(n){let e="";return Object.entries(i).forEach(t=>{t[1]===n&&(e=t[0])}),e}},1821:function(n,e,t){"use strict";t.d(e,"e",(function(){return i})),t.d(e,"f",(function(){return o})),t.d(e,"g",(function(){return c})),t.d(e,"c",(function(){return u})),t.d(e,"b",(function(){return a})),t.d(e,"a",(function(){return s})),t.d(e,"d",(function(){return d}));var r=t(3);const i=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(n,e)=>({linkId:n,sharingDialogResponse:e})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(n,e)=>({linkId:n,newPermission:e})),c=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(n,e,t,r)=>({linkId:n,newLinkUrl:e,oldLinkUrl:t,expirationDate:r})),u=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(n,e)=>({linkId:n,actionStatus:e})),a=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(n,e,t,r,i,o,c,u,a)=>({linkId:n,sharingUrl:e,currentUrl:t,canonicalUrl:r,newPermissionLevel:i,providerType:o,composeId:c,recipientInfos:u,isCalendar:a})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(n,e)=>({linkId:n,linkModel:e})),d=Object(r.action)("TOKEN_UNAVAILABLE",n=>({linkId:n}))},1850:function(n,e,t){"use strict";t.d(e,"a",(function(){return a})),t.d(e,"b",(function(){return s}));var r=t(1709),i=t(1816),o=t(175);const c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],u=[".tiff",".tif"];function a(n,e,t=!0){return s(Object(r.a)(n)||Object(i.a)(e),t)}function s(n,e=!0){return!!n&&(c.indexOf(n.toLowerCase())>=0||e&&u.indexOf(n.toLowerCase())>=0&&(Object(o.c)()||Object(o.f)()))}},1858:function(n,e,t){"use strict";t.d(e,"b",(function(){return r})),t.d(e,"d",(function(){return i})),t.d(e,"a",(function(){return o})),t.d(e,"c",(function(){return c})),t.d(e,"e",(function(){return u}));const r="originalsrc",i="shash",o="data-auth",c="&reserved=0",u="Verified"},1898:function(n,e,t){"use strict";t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return c})),t.d(e,"a",(function(){return u}));var r=t(47);const i="_ODSPPSL";function o(n){return Object(r.j)("doc-link-savePermission")&&n&&-1!==n.indexOf(i)?n.substring(0,n.length-i.length):n}function c(n){return!!Object(r.j)("doc-link-savePermission")&&n.lastIndexOf(i)===n.length-i.length}function u(n,e){return!Object(r.j)("doc-link-savePermission")||2!==e&&1!==e?n:n+i}},1912:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(2316),i=t(1898);function o(n){const e=Object(r.a)(),t=Object(i.b)(n);return e.sharingLinks.get(t)}},1990:function(n,e,t){"use strict";function r(n){return Object.assign({__type:"FetchDataProviderResourceRequest:#Exchange"},n)}t.d(e,"a",(function(){return r}))},2104:function(n,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"b",(function(){return c}));var r=t(1709),i=t(47);function o(n){const e=(Object(r.a)(n)||"").toLowerCase();return!!n&&(Object(i.j)("cmp-prague")&&(".fluid"===e||".note"===e))}function c(n){const e=(Object(r.a)(n)||"").toLowerCase();return!!n&&(Object(i.j)("cmp-prague")&&".note"===e)}},2213:function(n){n.exports=JSON.parse('{"b":"Haa","d":"Iaa","c":"Jaa","a":"Kaa"}')},2268:function(n,e,t){"use strict";t.d(e,"a",(function(){return o}));var r=t(35),i=t(1990);function o(n,e){return void 0===n||n.__type||(n=Object(i.a)(n)),Object(r.a)("FetchDataProviderResource",n,e)}},2316:function(n,e,t){"use strict";t.d(e,"b",(function(){return c}));var r=t(16),i=t(3);const o={sharingLinks:new r.ObservableMap({}),linksIdContainerMap:new r.ObservableMap({})},c=Object(i.createStore)("sharingLinkStore",o);e.a=c},2338:function(n,e,t){"use strict";t.d(e,"a",(function(){return o})),t.d(e,"c",(function(){return c})),t.d(e,"e",(function(){return u})),t.d(e,"f",(function(){return a})),t.d(e,"d",(function(){return s})),t.d(e,"b",(function(){return d}));var r=t(20);const i=new r.c(()=>t.e(1160).then(t.bind(null,3350))),o=new r.b(i,n=>n.extractFileUrlFromOfficeSharePointLink),c=new r.b(i,n=>n.isLinkPrefixedWithBaseUrl),u=new r.b(i,n=>n.isSharePointLink),a=new r.b(i,n=>n.isSharePointServiceGeneratedLink),s=new r.b(i,n=>n.isOfficeSharePointLink),d=new r.b(i,n=>n.getParsedQueryStringFromUrl)},2349:function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),function(n){n[n.none=0]="none",n[n.refreshing=1]="refreshing",n[n.refreshFailed=2]="refreshFailed",n[n.refreshSucceeded=3]="refreshSucceeded",n[n.attachingAsACopy=4]="attachingAsACopy",n[n.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2369:function(n,e,t){"use strict";var r;t.d(e,"a",(function(){return r})),function(n){n[n.linkIds=0]="linkIds",n[n.quotedBodyLinkIds=1]="quotedBodyLinkIds"}(r||(r={}))},2409:function(n,e,t){"use strict";function r(n){return void 0!==n.recipients}function i(n){return void 0!==n.length}t.d(e,"b",(function(){return r})),t.d(e,"a",(function(){return i}))},2410:function(n,e,t){"use strict";t.d(e,"a",(function(){return c}));var r=t(2338),i=t(703),o=t(227);async function c(n){return function(n){if(!Object(i.a)(null==n?void 0:n.nav)){const e={nav:n.nav};return Object(o.stringify)(e)}return null}((await r.b.import())(n))}},2424:function(n){n.exports=JSON.parse('{"a":"uca"}')},2652:function(n,e,t){"use strict";t.d(e,"f",(function(){return c})),t.d(e,"g",(function(){return u})),t.d(e,"h",(function(){return a}));var r=t(20),i=t(1858);t.d(e,"b",(function(){return i.b})),t.d(e,"d",(function(){return i.d})),t.d(e,"a",(function(){return i.a})),t.d(e,"c",(function(){return i.c})),t.d(e,"e",(function(){return i.e}));const o=new r.c(()=>t.e(1159).then(t.bind(null,4221))),c=new r.b(o,n=>n.evaluateSafeLink),u=(new r.b(o,n=>n.evaluateSafeLinks),new r.b(o,n=>n.isSafeLink)),a=new r.b(o,n=>n.isSafeLinkUrl)},2888:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var r=t(71),i=t(1990),o=t(2268),c=t(36);async function u(n,e,t,u,a){const s=new r.b("getWacInfoForOneDriveJsApi",{isCore:!0});u&&s.addCustomData({redeemSharingLinkIfNecessary:u});try{const r="u!"+btoa(e).replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),c=`${new RegExp(/.+?\:\/\/.+?(\/)/g).exec(e)[0]}_api/v2.0/shares/${r}/root?select=openWith/wac,officeBundle,@content.downloadUrl,webDavUrl,name,size,currentUserRole,sensitivityLabel&action=${t?"Open":"View"}`,d=new Object;u&&(d.prefer="redeemSharingLinkIfNecessary");const f=Object(i.a)({ProviderType:n,Url:c,Headers:JSON.stringify(d)}),l=(new Date).getTime(),p=await Object(o.a)(f);if(200===p.Status&&p.Body){const n=(new Date).getTime(),e=JSON.parse(p.Body);return e.fetchStartTime=l,e.responseStartTime=n,!e.openWith.wac&&a||(e.openWith.wac.fileGetUrl=e["@content.downloadUrl"],e.openWith.wac.accessTokenExpiry&&(e.openWith.wac.accessTokenExpiry=new Date(Number(e.openWith.wac.accessTokenExpiry))),!t&&e.currentUserRole&&(e.currentUserRole.readOnly=!0)),s.end(),e}{s.addCustomData({StatusCode:p.Status});const n=p.Headers;if(n){const e=JSON.parse(n);e&&s.addCustomData({SharePointError:e.SharePointError,SPClientServiceRequestDuration:e.SPClientServiceRequestDuration,SPRequestGuid:e.SPRequestGuid})}throw new Error(`Result status is: ${p.Status} or empty response body.`)}}catch(n){s.endWithError("ServerError",n),c.h.warn(`Something went wrong while calling fetchDataProviderResourceOperation: ${n}`)}return null}},6453:function(n,e,t){"use strict";t.d(e,"i",(function(){return i})),t.d(e,"h",(function(){return o})),t.d(e,"f",(function(){return c})),t.d(e,"b",(function(){return u})),t.d(e,"e",(function(){return a})),t.d(e,"c",(function(){return s})),t.d(e,"g",(function(){return d})),t.d(e,"d",(function(){return f})),t.d(e,"a",(function(){return l}));var r=t(3);const i=Object(r.action)("tryQueueGetWacInfo",n=>({url:n})),o=Object(r.action)("queueGetWacInfo",n=>({url:n})),c=Object(r.action)("processGetWacInfoQueue"),u=Object(r.action)("getWacInfoQueueShift"),a=Object(r.action)("onStartGetWacInfoOperation",n=>({url:n})),s=Object(r.action)("onFinishGetWacInfoOperation",n=>({url:n})),d=Object(r.action)("pushSupressedUrl",n=>({url:n})),f=Object(r.action)("onGetWacInfoSuccess",(n,e,t)=>({url:n,wacUrlInfo:e,needRedeem:t})),l=Object(r.action)("addGenericLinkClickListener",(n,e,t)=>({element:n,isSafeLinkWrapped:e,isSafeLinkVerified:t}))},703:function(n,e,t){"use strict";function r(n){return null==n||0==n.trim().length}t.d(e,"a",(function(){return r}))},7364:function(n,e,t){"use strict";var r=t(35);function i(n,e){var t;return void 0===n.request||n.request.__type||(n.request=(t=n.request,Object.assign({__type:"GetWacInfoRequest:#Exchange"},t))),Object(r.a)("GetWacInfo",n,e)}function o(n,e,t=!1,r=!1,o){return i({request:{Url:n,IsEdit:r,ProviderType:e,ShouldGrantAccess:t}},o)}t.d(e,"a",(function(){return o}))},7583:function(n,e,t){"use strict";var r=t(16),i=t(3);const o={activeGetWacInfoOperations:[],getWacInfoQueue:[],suppressedUrls:[],docLinkPreviewInfoMap:new r.ObservableMap},c=Object(i.createStore)("sharePointDocLinkPreview",o);e.a=c()},7584:function(n,e,t){"use strict";t.d(e,"g",(function(){return r})),t.d(e,"h",(function(){return i})),t.d(e,"b",(function(){return o})),t.d(e,"a",(function(){return c})),t.d(e,"c",(function(){return u})),t.d(e,"d",(function(){return a})),t.d(e,"e",(function(){return s})),t.d(e,"f",(function(){return d}));const r=18e5,i=2,o=2,c=1,u="OD_LINK_CLICK_EVENT_LISTENER",a="OD_LINK_MOUSEUP_EVENT_LISTENER",s="https://1drv.ms",d="https://my.microsoftpersonalcontent.com"},7585:function(n,e,t){"use strict";t.d(e,"a",(function(){return c})),t.d(e,"b",(function(){return u})),t.d(e,"c",(function(){return a}));var r=t(7584),i=t(7583),o=t(8848);function c(n){const{docLinkPreviewInfo:e}=a(n);return e||null}async function u(n){let{docLinkPreviewInfo:e}=a(n);return e&&!e.needRedeem||(e=await Object(o.a)(n,!0,!0)),e}function a(n){const e=i.a.docLinkPreviewInfoMap.get(n);return e?e.time+r.g>Date.now()?{docLinkPreviewInfo:e}:{reason:"Expired"}:i.a.getWacInfoQueue.some(e=>e===n)||i.a.activeGetWacInfoOperations.some(e=>e===n)?{reason:"InQueue"}:i.a.suppressedUrls.some(e=>e===n)?{reason:"FileTypeNotSupportedOrSuppressedAfterError"}:{reason:"Unknown"}}},8848:function(n,e,t){"use strict";t.d(e,"a",(function(){return s}));var r=t(7364),i=t(2888),o=t(47),c=t(1696),u=t(6453),a=t(7585);async function s(n,e,t,r){var s;try{Object(u.e)(n);let f=null;if(Object(o.j)("doc-SxS-jsApi-ODB-Links")){const e=await Object(i.a)(0,n,!0,t,!0);if(!e)return Object(u.g)(n),null;{const t=Object(c.b)(e.name),i=Object(c.f)(t);if(".fluid"===t||".note"===t||".whiteboard"===t)return Object(u.g)(n),null;r&&(r.fileExt=t),i===c.a.Word||i===c.a.Excel||i===c.a.PowerPoint?e.openWith.wac?f={wacUrl:e.openWith.wac.applicationUrl,jsApiInfo:{bootScriptUrl:e.openWith.wac.bootstrapperUrl,wopiSrcUrl:e.openWith.wac.wopiSrc,accessToken:e.openWith.wac.accessToken,accessTokenExpiry:e.openWith.wac.accessTokenExpiry,fileSize:e.size,fileGetUrl:e.openWith.wac.fileGetUrl,bundleInfo:e.officeBundle,fetchStartTime:e.fetchStartTime,responseStartTime:e.responseStartTime,openUrl:n,webDavUrl:e.webDavUrl,fileName:e.name,userId:e.openWith.wac.userId,clientThrottlingProtection:e.openWith.wac.clientThrottlingProtection,requestedCallThrottling:e.openWith.wac.requestedCallThrottling,irmEnabled:null===(s=e.sensitivityLabel)||void 0===s?void 0:s.protectionEnabled},readOnly:e.currentUserRole.readOnly}:Object(u.d)(n,null,!0):f=await d(n)}}else f=await d(n);return f&&Object(u.d)(n,f),e?Object(a.a)(n):null}finally{Object(u.c)(n)}}async function d(n){const e=await Object(r.a)(n,0);if(9===e.Status||6===e.Status||5===e.Status)Object(u.g)(n);else if(0===e.Status)return{wacUrl:e.WacUrl,bootScriptUrl:e.BootScriptUrl,wopiSrcUrl:e.WopiSrcUrl,accessToken:e.AccessToken,deprecatedTokenAndParameters:e.Token};return null}}}]);
//# sourceMappingURL=owa.115.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.115.js'] = 1;