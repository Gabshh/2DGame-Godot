(window.$wj=window.$wj||[]).push([[525],{1017:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),n.b=r},1678:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(66);function i(e){if(!e)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(e)}},1696:function(e,n,t){"use strict";var r=t(1709),i=t(2213),a=t(6);function o(e){let n;return e>=1073741824?(e/=1073741824,n=Object(a.b)(i.b)):e>=1048576?(e/=1048576,n=Object(a.b)(i.d)):e>=1024?(e/=1024,n=Object(a.b)(i.c)):n=Object(a.b)(i.a),Object(a.c)(n,Math.round(e))}var s=t(1850),c=t(47);const u=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(c.j)("doc-attachment-documentThumbnail"))return!1;const n=Object(r.a)(e);return!!n&&u.indexOf(n.toLowerCase())>=0}var d;function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return d.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return d.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return d.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(d||(d={}));var p=t(1816);t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return r.b})),t.d(n,"d",(function(){return r.c})),t.d(n,"i",(function(){return o})),t.d(n,"g",(function(){return s.a})),t.d(n,"h",(function(){return l})),t.d(n,"f",(function(){return f})),t.d(n,"e",(function(){return p.b})),t.d(n,"a",(function(){return d}))},1728:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage",e[e.Sonora=18]="Sonora"}(r||(r={}))},1777:function(e,n,t){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){let n=null;const t=r.exec(e);if(t){const e=t[1],r=t[2];let i=null;try{i=atob(r)}catch(e){}if(i){const t=new ArrayBuffer(i.length),r=new Uint8Array(t);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);n=new File([t],"image.png",{type:e})}}return n}var a=t(1728),o=t(1696);function s(e){return e.map(e=>({fileType:a.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}))}var c=t(36);function u(e,n,t){if(e.length!=n.length)return c.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let i=0;i<e.length;i++){const o={fileType:a.a.MailItem,name:e[i],size:(null==t?void 0:t[i])||0,itemId:n[i]};r.push(o)}return r}function l(e,n,t){const r=[],i={fileType:a.a.MailItem,name:e,size:t||0,mimeContent:n};return r.push(i),r}function d(e){if(!e)return null;let n=[];for(var t=0;t<e.length;t++){const r=e[t],i={fileType:a.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};n.push(i)}return n}function f(e){if(!e)return null;const n=[];for(let t=0;t<e.length;t++){const r=e[t],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};n.push(i)}return n}function p(e){var n,t;if(null===e)return null;return{fileType:a.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(n=e.Thumbnail)||void 0===n?void 0:n.Url)||"",previewUrl:(null===(t=e.Preview)||void 0===t?void 0:t.Url)||"",type:e.MimeType}}function h(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:a.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var m=t(1778);function b(e){switch(e?e.toLowerCase():null){case m.d.ONE_DRIVE_PRO.toLowerCase():return 0;case m.d.GDRIVE.toLowerCase():return 5;case m.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case m.d.DROPBOX.toLowerCase():return 2;case m.d.BOX.toLowerCase():return 3;case m.d.WOPI_BOX.toLowerCase():return 7;case m.d.WOPI_EGNYTE.toLowerCase():return 8;case m.d.MAILBOX.toLowerCase():return 4;case m.d.FACEBOOK.toLowerCase():return 6;default:return null}}t.d(n,"f",(function(){return i})),t.d(n,"j",(function(){return s})),t.d(n,"i",(function(){return u})),t.d(n,"h",(function(){return l})),t.d(n,"g",(function(){return d})),t.d(n,"d",(function(){return f})),t.d(n,"e",(function(){return p})),t.d(n,"c",(function(){return h})),t.d(n,"b",(function(){return b})),t.d(n,"a",(function(){return a.a}))},1778:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"e",(function(){return o})),t.d(n,"f",(function(){return s})),t.d(n,"g",(function(){return c})),t.d(n,"h",(function(){return u})),t.d(n,"i",(function(){return l})),t.d(n,"j",(function(){return d})),t.d(n,"k",(function(){return f})),t.d(n,"l",(function(){return p})),t.d(n,"d",(function(){return h}));const r="Box",i="Dropbox",a="Facebook",o="GDrive",s="Mailbox",c="MailMessage",u="OneDriveConsumer",l="OneDrivePro",d="WopiBox",f="WopiDropbox",p="WopiEgnyte",h={BOX:r,DROPBOX:i,FACEBOOK:a,GDRIVE:o,MAILBOX:s,ONE_DRIVE_CONSUMER:u,ONE_DRIVE_PRO:l,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:d,WOPI_EGNYTE:p}},1796:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}t.d(n,"a",(function(){return r}))},1816:function(e,n,t){"use strict";function r(e){return function(e){const n=a.exec(e);return n&&n.length>1&&i[n[1].toLowerCase()]}(e||"")}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},a=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){let n="";return Object.entries(i).forEach(t=>{t[1]===e&&(n=t[0])}),n}},1850:function(e,n,t){"use strict";t.d(n,"a",(function(){return c})),t.d(n,"b",(function(){return u}));var r=t(1709),i=t(1816),a=t(175);const o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],s=[".tiff",".tif"];function c(e,n,t=!0){return u(Object(r.a)(e)||Object(i.a)(n),t)}function u(e,n=!0){return!!e&&(o.indexOf(e.toLowerCase())>=0||n&&s.indexOf(e.toLowerCase())>=0&&(Object(a.c)()||Object(a.f)()))}},188:function(e,n,t){"use strict";function r(){var e=Object.create(null),n=0,t=0,r=0,i=!1;function a(n){r--,delete e[n]}this.put=function(n,t,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var s=e[n];s?clearTimeout(s.timeout):r++;var c={value:t,expire:i+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){a(n),o&&o(n,t)}.bind(this),i)),e[n]=c,t},this.del=function(n){var t=!0,r=e[n];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(t=!1)):t=!1,t&&a(n),t},this.clear=function(){for(var a in e)clearTimeout(e[a].timeout);r=0,e=Object.create(null),i&&(n=0,t=0)},this.get=function(a){var o=e[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&n++,o.value;i&&t++,r--,delete e[a]}else i&&t++;return null},this.size=function(){return r},this.memsize=function(){var n,t=0;for(n in e)t++;return t},this.debug=function(e){i=e},this.hits=function(){return n},this.misses=function(){return t},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var n={};for(var t in e){var r=e[t];n[t]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(n)},this.importJson=function(n,t){var r=JSON.parse(n),i=Date.now(),a=t&&t.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(e[o])continue;var s=r[o],c=s.expire-i;if(c<=0){this.del(o);continue}c=c>0?c:void 0,this.put(o,s.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},19465:function(e,n,t){"use strict";t.r(n);var r=t(1821),i=t(4698),a=t(1912),o=t(3);Object(o.mutator)(r.c,e=>{const n=Object(a.a)(e.linkId);n&&(n.linkActionStatus=e.actionStatus)}),Object(o.mutator)(i.h,e=>{const n=Object(a.a)(e.linkId);n&&(n.linkActionStatus=e.linkActionStatus)}),Object(o.mutator)(r.e,e=>{Object(a.a)(e.linkId).sharingInfo.blocksDownload=e.sharingDialogResponse.blocksDownload}),Object(o.mutator)(r.g,e=>{const n=Object(a.a)(e.linkId);n&&(n.sharingInfo.expirationDate=e.expirationDate)}),Object(o.mutator)(r.e,e=>{Object(a.a)(e.linkId).sharingInfo.linkType=e.sharingDialogResponse.isEdit?"edit":"view"});var s=t(1739);Object(o.mutator)(r.g,e=>{const n=Object(a.a)(e.linkId);n&&(n.url=e.newLinkUrl)}),Object(o.mutator)(s.f,e=>{const n=Object(a.a)(e.linkId);n&&(n.url=e.url)}),Object(o.mutator)(r.e,e=>{Object(a.a)(e.linkId).permissionLevel=e.sharingDialogResponse.permissionLevel}),Object(o.mutator)(r.f,e=>{Object(a.a)(e.linkId).permissionLevel=e.newPermission});var c=t(2142);Object(o.mutator)(i.b,e=>{const n=Object(a.a)(e.linkId);n&&e.recipients.forEach(e=>{n.sharingRecipientsInfo.recipientPermissionInfos.some(n=>n.emailAddress===e.emailAddress)||n.sharingRecipientsInfo.recipientPermissionInfos.push(e)})}),Object(o.mutator)(i.k,e=>{const n=Object(a.a)(e.linkId);n&&e.results.forEach(e=>{for(let t=0;t<n.sharingRecipientsInfo.recipientPermissionInfos.length;t++){const r=n.sharingRecipientsInfo.recipientPermissionInfos[t];if(r.emailAddress===e.recipient.alias){r.hasAccess=e.hasAccess,r.canHaveAccess=e.canBeInvited,r.getPermissionInfoStatus=c.a.Succeeded;break}}})}),Object(o.mutator)(i.g,e=>{const n=Object(a.a)(e.linkId);n&&e.recipients.forEach(e=>{for(let t=0;t<n.sharingRecipientsInfo.recipientPermissionInfos.length;t++){const r=n.sharingRecipientsInfo.recipientPermissionInfos[t];if(r.emailAddress===e.emailAddress){r.getPermissionInfoStatus=c.a.Failed;break}}})}),Object(o.mutator)(i.e,e=>{const n=Object(a.a)(e.linkId);n&&(n.sharingRecipientsInfo.recipientPermissionInfos=n.sharingRecipientsInfo.recipientPermissionInfos.filter((function(n){return t=n.emailAddress,!e.recipients.some(e=>e.emailAddress===t);var t})))}),Object(o.mutator)(i.f,e=>{const n=Object(a.a)(e.linkId);n&&(n.sharingRecipientsInfo.recipientPermissionInfos=[])}),Object(o.mutator)(r.e,e=>{Object(a.a)(e.linkId).sharingInfo.shareId=e.sharingDialogResponse.shareId});var u=t(2316);Object(o.mutator)(r.a,e=>{Object(u.a)().sharingLinks.set(e.linkId,e.linkModel)}),Object(o.mutator)(s.i,e=>{Object(u.a)().sharingLinks.delete(e.linkId)}),Object(o.mutator)(s.d,e=>{Object(u.a)().sharingLinks.delete(e.linkId)}),Object(o.mutator)(i.d,e=>{Object(a.a)(e.linkId).sharingTipsIgnored.push(e.sharingTipId)}),Object(o.mutator)(r.g,e=>{const n=Object(a.a)(e.linkId);n&&(n.unwrappedUrl=null)}),Object(o.mutator)(r.d,e=>{const n=Object(a.a)(e.linkId);n&&(n.accessTokenAvailable=!1)});var l=t(282),d=t(2369),f=t(47),p=t(1696),h=t(2490);function m(e,n){return Object(p.g)(e)&&(Object(f.j)("doc-deprecateCloudy-preview")||Object(f.j)("doc-deprecateCloudy-preview-thumbnailView"))&&(1===n||n===h.a.OneDriveConsumer)}Object(o.mutator)(i.c,e=>{if(e.linksContainerId){Object(u.a)().linksIdContainerMap.set(e.linksContainerId,{linkIds:[],quotedBodyLinkIds:[]})}}),Object(o.mutator)(i.a,e=>{if(e.linksContainerId){const n=Object(u.a)().linksIdContainerMap.get(e.linksContainerId);let t;switch(e.linkIdsArrayToUpdate){case d.a.linkIds:t=n.linkIds;break;case d.a.quotedBodyLinkIds:t=n.quotedBodyLinkIds;break;default:Object(l.a)(e.linkIdsArrayToUpdate)}e.linkId&&!t.includes(e.linkId)&&t.push(e.linkId)}}),Object(o.mutator)(s.i,e=>{if(m(e.fileName,e.providerType)){const n=Object(u.a)();if(n.linksIdContainerMap.has(e.linksContainerId)){let t=n.linksIdContainerMap.get(e.linksContainerId).linkIds;const r=t.indexOf(e.linkId);-1!==r&&t.splice(r,1)}}}),Object(o.mutator)(i.i,e=>{const n=Object(u.a)();e.linkSharingInformation.linksContainerId=e.newLinkContainerId,n.sharingLinks.set(e.linkSharingInformation.linkId,e.linkSharingInformation)}),Object(o.mutator)(i.j,e=>{if(e.linksContainerId){const n=Object(u.a)();n.linksIdContainerMap.has(e.linksContainerId)||n.linksIdContainerMap.set(e.linksContainerId,{linkIds:[],quotedBodyLinkIds:[]});const t=n.linksIdContainerMap.get(e.linksContainerId);switch(e.linkIdsArrayToUpdate){case d.a.linkIds:t.linkIds=e.newLinkIds;break;case d.a.quotedBodyLinkIds:t.quotedBodyLinkIds=e.newLinkIds;break;default:Object(l.a)(e.linkIdsArrayToUpdate)}}});var b=t(71),I=t(7),g=t(703);function O(e){return Object.assign({__type:"CreateAttachmentSharingLinkRequest:#Exchange"},e)}var v=t(35);function k(e,n,t){return void 0===(r=function(e,n,t){return O({PermissionLevel:n,ResourceLocation:e,DataProviderType:t||0})}(e,n,t))||r.__type||(r=O(r)),Object(v.a)("CreateAttachmentSharingLink",r,i);var r,i}var j=t(2349);Object(o.orchestrator)(c.n,async e=>{if("string"==typeof e.id){const n=Object(a.a)(e.id);if(0!==n.providerType)throw new Error("refreshExpirationDate only supports OneDrivePro link.");if(n){Object(r.c)(e.id,j.a.refreshing);const t=await k(n.sharingInfo.canonicalUrl,n.permissionLevel);if(Object(g.a)(t.Link))return Object(r.c)(e.id,j.a.refreshFailed),void Object(b.o)("LinkRefreshLinkFailed");Object(r.c)(e.id,j.a.refreshSucceeded),Object(r.g)(n.linkId,t.Link,n.url,t.ExpirationDate?Object(I.qc)(t.ExpirationDate):null)}}});var x=t(3642),C=t(1808),w=t(36);Object(o.orchestrator)(r.b,async e=>{let n=e.sharingUrl,t=null;if(null===n)switch(e.providerType){case 0:const r=await k(e.canonicalUrl,e.newPermissionLevel);n=r.Link,t=r.ExpirationDate;break;case 1:const i=await Object(x.i)(1,e.currentUrl,e.newPermissionLevel);i&&(n=i.link.webUrl,i.expirationDateTime!==x.h&&(t=i.expirationDateTime));break;case 5:await Object(x.i)(5,e.currentUrl,e.newPermissionLevel);break;default:w.d("Data provider is not supported")}5!=e.providerType&&Object(r.g)(e.linkId,n,e.currentUrl,t?Object(I.qc)(t):null),Object(C.V)(e.linkId,e.newPermissionLevel),Object(C.N)(e.linkId,e.recipientInfos,e.composeId,e.isCalendar)});var T=t(2279);function y(e){return{anonymousViewLink:e.AnonymousViewLink,anonymousEditLink:e.AnonymousEditLink,organizationViewLink:e.OrganizationViewLink,organizationEditLink:e.OrganizationEditLink}}var E=t(2264);function S(e,n){const t=Object(E.a)(e,n)||[];return-1===t.indexOf(0)&&0===n&&t.push(0),t}function L(e,n,t,r,i,a,o,s,c,u,l){switch(i){case h.a.OneDrivePro:case h.a.OfficeOneDrivePro:return function(e,n,t,r,i,a){let o;const s=t&&0===t.ResultCode;return o={getSharingInfoSucceeded:s,blocksDownload:!!s&&t.BlocksDownload,canonicalUrl:null==t?void 0:t.CanonicalUrl,canShareInternally:!!s&&t.CanShareInternally,canShareExternally:!!s&&t.CanShareExternally,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(I.qc)(t.ExpirationDate):null,canRefresh:!!s&&(t.CanCreateAnonymousEditLink||t.CanCreateAnonymousViewLink),shareId:s?t.ShareId:null,siteUrl:s?t.SiteUrl:null,linkType:s?t.Type:null,itemUniqueId:s?t.ItemUniqueId:null,mimeType:s?t.MimeType:null},{linkId:e,providerType:0,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i||(s?t.OriginalUrl:null),accessTokenAvailable:s,permissionLevel:s?Object(E.b)(t.SharingLinkKind,"edit"===t.Type,r===C.a.InsertLinkFromAttachMenu||r===C.a.NewFluidFile):0,sharingInfo:o,supportedPermissionLevels:s?S(t,0):null,sharingUrls:s?y(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r,creationDateTime:a}}(e,n,t,r,a,o);case h.a.OneDriveConsumer:return function(e,n,t,r,i,a,o,s,c){let u;const l=t&&0===t.ResultCode;return u={getSharingInfoSucceeded:l,canShareInternally:l,canShareExternally:l,blocksDownload:!1,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(I.qc)(t.ExpirationDate):null,canRefresh:!1,linkType:l?t.Type:null,providerFileId:l?t.providerFileId:null,location:l?t.location:null},{linkId:e,providerType:1,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:a,accessTokenAvailable:!1,permissionLevel:l?Object(E.b)(t.SharingLinkKind,"edit"===t.Type,!1):0,sharingInfo:u,supportedPermissionLevels:l?S(t,1):null,sharingUrls:l?y(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r,shareId:i,thumbnailUrl:o,previewUrl:s,linksContainerId:c}}(e,n,t,r,u,a,s,c,l);case h.a.Dropbox:return function(e,n,t,r,i){let a;const o=t&&0===t.ResultCode;return a={getSharingInfoSucceeded:o,canShareInternally:o,canShareExternally:o,blocksDownload:!!o&&t.BlocksDownload,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(I.qc)(t.ExpirationDate):null,canRefresh:!1,linkType:o?t.Type:null,providerFileId:o?t.providerFileId:null,location:o?t.location:null},{linkId:e,providerType:2,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i,accessTokenAvailable:!1,permissionLevel:3,sharingInfo:a,supportedPermissionLevels:o?S(t,2):null,sharingUrls:o?y(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r}}(e,n,t,r,a);case h.a.Box:return function(e,n,t,r,i){let a;const o=t&&0===t.ResultCode;return a={getSharingInfoSucceeded:o,canShareInternally:o,canShareExternally:o,blocksDownload:!!o&&t.BlocksDownload,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(I.qc)(t.ExpirationDate):null,canRefresh:!1,linkType:o?t.Type:null,providerFileId:o?t.providerFileId:null,location:o?t.location:null},{linkId:e,providerType:3,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i,accessTokenAvailable:!1,permissionLevel:3,sharingInfo:a,supportedPermissionLevels:o?S(t,3):null,sharingUrls:o?y(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r}}(e,n,t,r,a);case h.a.GDrive:return function(e,n,t,r,i){let a;const o=t&&0===t.ResultCode;return a={getSharingInfoSucceeded:o,canShareInternally:o,canShareExternally:o,blocksDownload:!!o&&t.BlocksDownload,expirationDate:(null==t?void 0:t.ExpirationDate)?Object(I.qc)(t.ExpirationDate):null,canRefresh:!1,linkType:o?t.Type:null,providerFileId:o?t.providerFileId:null},{linkId:e,providerType:5,fileName:null==t?void 0:t.FileName,mimeType:null==t?void 0:t.MimeType,url:n,unwrappedUrl:i,accessTokenAvailable:!1,permissionLevel:"edit"===(null==t?void 0:t.Type)?4:3,sharingInfo:a,supportedPermissionLevels:o?S(t,5):null,sharingUrls:o?y(t):null,sharingTipsIgnored:[],sharingRecipientsInfo:{recipientPermissionInfos:[]},linkActionStatus:j.a.none,source:r}}(e,n,t,r,a);default:throw new Error(`createLinkModel do not support ${i}`)}}function D(e){return Object(u.b)().linksIdContainerMap.has(e)}Object(o.orchestrator)(s.a,e=>{const n=L(e.linkId,e.url,e.response,e.source,e.providerType,e.unwrappedUrl,e.creationDateTime,e.thumbnailUrl,e.previewUrl,e.shareId,e.linksContainerId);if(Object(r.a)(e.linkId,n),m(n.fileName,e.providerType)){D(e.linksContainerId)||Object(i.c)(e.linksContainerId),Object(i.a)(e.linkId,e.linksContainerId,e.fromQuotedBody?d.a.quotedBodyLinkIds:d.a.linkIds)}!async function(e,n,t,i){const a=await h.g.import();try{a(t)&&i&&await Object(T.d)(0,!1,e)}catch(e){Object(r.d)(n)}}(n.sharingInfo.siteUrl,e.linkId,e.providerType,n.sharingInfo.siteUrl)});var R=t(2410);Object(o.orchestrator)(r.e,async e=>{const n=Object(a.a)(e.linkId),t=await Object(R.a)(n.url);let i=e.sharingDialogResponse.url;null!=t&&(i+=(-1===i.indexOf("?")?"?":"&")+t),Object(r.g)(e.linkId,i,n.url,e.sharingDialogResponse.expirationDate)});var A=t(3418);var M=t(923),P=t(1017),N=t(2409);function F(e,n){const t=function(e){if(!e||0===e.length)return[];let n=[];return e.filter(e=>!!e).map(e=>{const t=function(e){if(Object(N.b)(e))return e.recipients.slice();if(Object(N.a)(e)){return function(e){return e?e.map(e=>{const n=e.persona?e.persona:{EmailAddress:e.Mailbox,PersonaId:{Id:null}},t=n.EmailAddress;return{persona:n,isValid:Object(M.d)(t.EmailAddress),isSelected:!1,isEditing:!1,isFadedOut:!1,isExpanding:!1,isContextMenuOpen:!1,expansionStatus:P.a.None,members:[],displayText:t.Name?t.Name:t.EmailAddress}}):[]}(e)}return[]}(e);n=n.concat(t)}),n}(e);let r=[];return t.forEach(e=>{const t=e.persona,i=function(e,n){const t=Object(A.a)().get(e,n);return t?{TotalMemberCount:t.value.TotalMemberCount,ExternalMemberCount:t.value.ExternalMemberCount}:null}(n,t.EmailAddress.EmailAddress);null!==i&&r.push({recipient:e,totalMemberCount:i.TotalMemberCount,externalMemberCount:i.ExternalMemberCount})}),r}var _=t(1777);function U(e,n){let t=null,r=null;switch(e.providerType){case 1:const n=e.sharingInfo;t=n.location,r=n.providerFileId;break;case 0:t=e.sharingInfo.canonicalUrl}return{fileType:_.a.Cloud,name:e.fileName,size:null,providerId:n,providerType:e.providerType,location:t,providerEndpointUrl:null,isFolder:!1,fileId:r,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:e.mimeType}}async function z(e,n,t){if(1==n&&Object(p.g)(e)){Object(b.o)("RetrieveImageUrlsForImageFile");try{const e=await Object(x.l)(t);return{thumbnailUrl:e.value[0].c200x150_Crop.url,previewUrl:e.value[0].large.url}}catch(e){return Object(b.o)("RetrieveImageUrlsForImageFileFailure",{message:e.message}),{thumbnailUrl:null,previewUrl:null}}}return{thumbnailUrl:null,previewUrl:null}}function B(e){return Object(u.b)().linksIdContainerMap.get(e)}function G(){return Object(u.b)().linksIdContainerMap.keys()}t.d(n,"ignoreSharingTip",(function(){return i.d})),t.d(n,"addRecipientsIntoLink",(function(){return i.b})),t.d(n,"updateRecipientPermissionInfos",(function(){return i.k})),t.d(n,"removeRecipientsFromLink",(function(){return i.e})),t.d(n,"setGetPermissionInfoFailure",(function(){return i.g})),t.d(n,"resetSharingRecipientsInfo",(function(){return i.f})),t.d(n,"setLinkActionStatus",(function(){return i.h})),t.d(n,"updateLinkContainerIdOfLink",(function(){return i.i})),t.d(n,"updateLinkIds",(function(){return i.j})),t.d(n,"createLinksIdContainer",(function(){return i.c})),t.d(n,"addLinkIdToLinksIdContainer",(function(){return i.a})),t.d(n,"getSharingTipRecipientInfo",(function(){return F})),t.d(n,"createCloudFileFromSharingLink",(function(){return U})),t.d(n,"retrieveImageUrlsForImageFile",(function(){return z})),t.d(n,"imageLinkPreviewCondition",(function(){return m})),t.d(n,"getSharingLinkInfo",(function(){return a.a})),t.d(n,"getLinksIdContainer",(function(){return B})),t.d(n,"getAllLinksContainerIds",(function(){return G})),t.d(n,"doesLinksIdContainerExist",(function(){return D}))},1990:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}t.d(n,"a",(function(){return r}))},2007:function(e,n,t){"use strict";var r;function i(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},2067:function(e,n,t){var r=t(2074),i=36e5,a=6e4,o=2,s=/[T ]/,c=/:/,u=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],p=/^-(\d{2})$/,h=/^-?(\d{3})$/,m=/^-?(\d{2})-?(\d{2})$/,b=/^-?W(\d{2})$/,I=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,O=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,k=/([Z+-].*)$/,j=/^(Z)$/,x=/^([+-])(\d{2})$/,C=/^([+-])(\d{2}):?(\d{2})$/;function w(e,n,t){n=n||0,t=t||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var i=7*n+t+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+i),r}e.exports=function(e,n){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var t=(n||{}).additionalDigits;t=null==t?o:Number(t);var T=function(e){var n,t={},r=e.split(s);c.test(r[0])?(t.date=null,n=r[0]):(t.date=r[0],n=r[1]);if(n){var i=k.exec(n);i?(t.time=n.replace(i[1],""),t.timezone=i[1]):t.time=n}return t}(e),y=function(e,n){var t,r=l[n],i=f[n];if(t=d.exec(e)||i.exec(e)){var a=t[1];return{year:parseInt(a,10),restDateString:e.slice(a.length)}}if(t=u.exec(e)||r.exec(e)){var o=t[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(T.date,t),E=y.year,S=function(e,n){if(null===n)return null;var t,r,i,a;if(0===e.length)return(r=new Date(0)).setUTCFullYear(n),r;if(t=p.exec(e))return r=new Date(0),i=parseInt(t[1],10)-1,r.setUTCFullYear(n,i),r;if(t=h.exec(e)){r=new Date(0);var o=parseInt(t[1],10);return r.setUTCFullYear(n,0,o),r}if(t=m.exec(e)){r=new Date(0),i=parseInt(t[1],10)-1;var s=parseInt(t[2],10);return r.setUTCFullYear(n,i,s),r}if(t=b.exec(e))return a=parseInt(t[1],10)-1,w(n,a);if(t=I.exec(e)){a=parseInt(t[1],10)-1;var c=parseInt(t[2],10)-1;return w(n,a,c)}return null}(y.restDateString,E);if(S){var L,D=S.getTime(),R=0;return T.time&&(R=function(e){var n,t,r;if(n=g.exec(e))return(t=parseFloat(n[1].replace(",",".")))%24*i;if(n=O.exec(e))return t=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),t%24*i+r*a;if(n=v.exec(e)){t=parseInt(n[1],10),r=parseInt(n[2],10);var o=parseFloat(n[3].replace(",","."));return t%24*i+r*a+1e3*o}return null}(T.time)),T.timezone?L=function(e){var n,t;if(n=j.exec(e))return 0;if(n=x.exec(e))return t=60*parseInt(n[2],10),"+"===n[1]?-t:t;if(n=C.exec(e))return t=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-t:t;return 0}(T.timezone):(L=new Date(D+R).getTimezoneOffset(),L=new Date(D+R+L*a).getTimezoneOffset()),new Date(D+R+L*a)}return new Date(e)}},2074:function(e,n){e.exports=function(e){return e instanceof Date}},213:function(e,n,t){"use strict";var r=t(36);let i;function a(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}var o=t(113);const s=500,c=[],u=[],l=[];let d=!0;function f(e,n){Object(r.g)((e,n,t,i)=>{d&&(n==r.b.Error&&u.push({message:e,error:i}),c.push({message:e,level:n}))}),e(h),n(h),a()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(s):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(s))}function p(e){const n=Object(o.a)(e);return d=!1,{traces:c,errors:u,network:l,usage:n}}function h(){d&&l.push(arguments)}t.d(n,"a",(function(){return f})),t.d(n,"b",(function(){return p})),t.d(n,"d",(function(){return o.b})),t.d(n,"c",(function(){return a}))},2142:function(e,n,t){"use strict";t.d(n,"h",(function(){return u})),t.d(n,"i",(function(){return l})),t.d(n,"f",(function(){return d})),t.d(n,"k",(function(){return f})),t.d(n,"m",(function(){return p})),t.d(n,"e",(function(){return h})),t.d(n,"g",(function(){return m})),t.d(n,"j",(function(){return b})),t.d(n,"l",(function(){return I}));var r=t(20),i=t(2283);t.d(n,"n",(function(){return i.a}));var a=t(2269);t.d(n,"a",(function(){return a.a}));var o=t(2007);t.d(n,"d",(function(){return o.b})),t.d(n,"c",(function(){return o.a}));var s=t(2284);t.d(n,"b",(function(){return s.a}));const c=new r.c(()=>Promise.all([t.e(0),t.e(24),t.e(96),t.e(608)]).then(t.bind(null,3852))),u=new r.b(c,e=>e.getSharingInformation),l=new r.b(c,e=>e.getSharingIssuesForSharingData),d=new r.b(c,e=>e.getInfoBarCreator),f=new r.b(c,e=>e.hasLargeDLRecipient),p=new r.b(c,e=>e.hasRecipientExpansionFailure),h=new r.b(c,e=>e.getGroupsAndSmallDLs),m=new r.b(c,e=>e.getInvididualRecipients),b=new r.b(c,e=>e.hasGetRecipientPermissionFailed),I=new r.b(c,e=>e.logSharingTipChangesForLinkRemoval)},2213:function(e){e.exports=JSON.parse('{"b":"Haa","d":"Iaa","c":"Jaa","a":"Kaa"}')},226:function(e,n,t){"use strict";function r(e){var n,t;if((null==e?void 0:e.length)>0){const r=null===(n=e[0])||void 0===n?void 0:n.toLowerCase();return(null===(t=e[1])||void 0===t?void 0:t.length)>0?r:void 0}}const i="bearer",a="msauth1.0",o=3600,s=86400,c=6e4,u=1e3;function l(e){if(e){const n=e.split(" ");return r(n)==i?n[1]:e}}function d(e,n){if(e){const t=r(e.split(" "));if(t){if(n){return(1e3*n-Date.now()-c)/u}return t==a?s:o}}}function f(e){var n;const t=null===(n=null==e?void 0:e.split(" "))||void 0===n?void 0:n[0].toLowerCase();return"msauth1.0"==t||"bearer"==t?e:`Bearer ${e}`}t.d(n,"c",(function(){return l})),t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return f}))},2264:function(e,n,t){"use strict";function r(e,n){if(null===e)return[];const t=[];if(0===n){const n=e;n.CanShareInternally&&(t.push(2),t.push(1)),n.CanCreateOrganizationEditLink&&t.push(6),n.CanCreateOrganizationViewLink&&t.push(5)}return e.CanCreateAnonymousEditLink&&t.push(4),e.CanCreateAnonymousViewLink&&t.push(3),t.length>0?t:[]}function i(e,n,t){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return t?n?2:1:0;default:return 0}}var a=t(2933),o=t(6);const s="OneDrivePro";var c=t(282),u=t(38);function l(e,n){switch(e){case 3:return Object(o.b)(a.b);case 4:return Object(o.b)(a.a);case 6:return Object(o.b)(a.d);case 5:return Object(o.b)(a.e);case 1:return n===s?Object(o.b)(a.g):Object(o.b)(a.b);case 2:return n===s?Object(o.b)(a.f):Object(o.b)(a.a);case 0:return Object(o.b)(a.c);default:return Object(c.a)(e)}}function d(e,n){return 0===n?function(e){var n;const t=null===(n=Object(u.a)().SessionSettings)||void 0===n?void 0:n.CompanyName;switch(e){case 3:return Object(o.b)(a.i);case 4:return Object(o.b)(a.h);case 6:return Object(o.c)(Object(o.b)(a.j),t);case 5:return Object(o.c)(Object(o.b)(a.k),t);case 1:return Object(o.b)(a.g);case 2:return Object(o.b)(a.f);case 0:return Object(o.b)(a.c);default:return Object(c.a)(e)}}(e):l(e,null)}function f(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return d})),t.d(n,"e",(function(){return f}))},2268:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(35),i=t(1990);function a(e,n){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FetchDataProviderResource",e,n)}},2269:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},2283:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(3);const i=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},2284:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2339:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},2490:function(e,n,t){"use strict";t.d(n,"e",(function(){return o})),t.d(n,"b",(function(){return s})),t.d(n,"f",(function(){return c})),t.d(n,"g",(function(){return u})),t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return d}));var r=t(20),i=t(2339);t.d(n,"a",(function(){return i.a}));const a=new r.c(()=>Promise.all([t.e(0),t.e(24),t.e(96),t.e(711)]).then(t.bind(null,4091))),o=new r.b(a,e=>e.createGetSharingInfoResponse),s=new r.b(a,e=>e.checkSharingLinkUrlDomain),c=new r.b(a,e=>e.getLinkProviderType),u=new r.b(a,e=>e.isOneDriveProRelatedLink),l=new r.b(a,e=>e.convertToAttachmentDataProviderType),d=new r.b(a,e=>e.convertToLinkProviderType)},283:function(e,n,t){"use strict";var r=t(907);t.d(n,"a",(function(){return r.a}))},291:function(e,n,t){"use strict";t.d(n,"b",(function(){return s})),t.d(n,"a",(function(){return c}));var r=t(135),i=t(100),a=t(2);let o;function s(e){o=e}async function c(e){var n,t;if(Object(a.Q)())return i.f.importAndExecute(Object(r.a)());const s=o&&await o(void 0,e);if(s&&s.length>0){if("bearer"===(null===(n=null==s?void 0:s.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return s.split(" ")[1];if("msauth1.0"===(null===(t=null==s?void 0:s.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return s}}},2933:function(e){e.exports=JSON.parse('{"b":"bda","a":"cda","d":"dda","e":"eda","g":"fda","f":"gda","c":"hda","i":"ida","h":"jda","j":"kda","k":"lda"}')},3418:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(4392);function i(){return Object(r.b)().mailTips}},3695:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("updateMailtips",(e,n,t)=>({composeId:e,fromEmailAddress:n,recipients:t}))},3858:function(e,n,t){"use strict";var r=t(261),i=t(35);function a(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetMailTipsJsonRequest:#Exchange"},t)),Object(i.a)("GetMailTips",e,n)}var o=t(704),s=t(225);function c(e,n){const t=Object(o.a)(Object(s.d)(e));return a({Header:Object(r.b)(),Body:(i={MailTipsRequested:1,SendingAs:{EmailAddress:e},Recipients:n.map(e=>({EmailAddress:e}))},Object.assign({__type:"GetMailTipsRequest:#Exchange"},i))},t).then(e=>(null==e?void 0:e.Body)&&"Success"==e.Body.ResponseClass?e.Body:null).catch(e=>Promise.resolve(null));var i}t.d(n,"a",(function(){return c}))},3863:function(e,n,t){"use strict";var r;!function(e){e.CustomMailTip="CustomMailTip",e.DeliveryRestricted="DeliveryRestricted",e.ExternalMemberCount="ExternalMemberCount",e.GuestMailTipStatus="GuestMailTipStatus",e.IsModerated="IsModerated",e.MailboxFull="MailboxFull",e.MaxMessageSize="MaxMessageSize",e.OutOfOffice="OutOfOffice",e.PreferAccessibleContent="PreferAccessibleContent",e.RecipientAddress="RecipientAddress",e.TotalMemberCount="TotalMemberCount"}(r||(r={}));var i=r,a=t(3920);t.d(n,"a",(function(){return c}));const o=/<!--((.|\n)*?)-->/gi,s=e=>{const n=[];for(let t=0;t<e.length;t++)n.push(e[t]);return n};function c(e){if(!e)return null;const n=(new DOMParser).parseFromString(e,"text/xml").firstChild.childNodes;return s(n).reduce((e,n)=>{switch(n.localName){case i.RecipientAddress:n.childNodes.length>1&&(e.RecipientAddress=n.childNodes[1].textContent);break;case i.MailboxFull:e.MailboxFull="true"===n.textContent;break;case i.IsModerated:e.IsModerated="true"===n.textContent;break;case i.TotalMemberCount:e.TotalMemberCount=parseInt(n.textContent)||0;break;case i.ExternalMemberCount:e.ExternalMemberCount=parseInt(n.textContent)||0;break;case i.MaxMessageSize:e.MaxMessageSize=parseInt(n.textContent)||0;break;case i.DeliveryRestricted:e.DeliveryRestricted="true"===n.textContent;break;case i.PreferAccessibleContent:e.PreferAccessibleContent="true"===n.textContent;break;case i.OutOfOffice:e.OutOfOffice=u(n);break;case i.CustomMailTip:e.CustomMailTip=f(n);break;case i.GuestMailTipStatus:e.GuestStatus=d(n.textContent)}return e},{})}const u=e=>{if(e.childNodes){return f(s(e.childNodes).filter(e=>"ReplyBody"===e.localName)[0])}return""},l=e=>e.replace(o,""),d=e=>{const n=e.split(" ");let t=a.a.None;return n.map(e=>{t|=a.a[e]}),t};function f(e){var n;if(e){const t=l(e.textContent).replace(/<\/a>/gi,"</a> "),r=(new DOMParser).parseFromString(t,"text/html");if((null===(n=null==r?void 0:r.childNodes)||void 0===n?void 0:n.length)&&r.childNodes[0].textContent)return r.childNodes[0].textContent.replace(/\s\s+/g," ").trim()}return""}},3920:function(e,n,t){"use strict";var r;t.d(n,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.IsCalculated=1]="IsCalculated",e[e.GuestsEnabled=2]="GuestsEnabled",e[e.GroupHasGuests=4]="GroupHasGuests"}(r||(r={}))},3990:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var r=t(4008);class i extends r.a{constructor(e,n,t){super(n,t),this.value=e}}},3991:function(e,n,t){"use strict";var r=t(3);n.a=Object(r.action)("onMailTipRetrieved",(e,n)=>({composeId:e,fromAddress:n}))},4008:function(e,n,t){"use strict";var r=t(16),i=t(957);const a=72e5,o=12e5,s=300,c=50;class u{constructor(e,n){this.parentCacheKey=e,this.childMruCacheKey=n,this.cacheTime=Date.now()}static isExpired(e){return Date.now()-e.cacheTime>=a}static compareEntryCacheTime(e,n){return e.cacheTime-n.cacheTime}}var l=t(702);class d{constructor(e,n=s,t=Date.now()){this.comparer=e,this.cacheLimit=n,this.lastExpiredEntryClearedTime=t,this.cache=new r.ObservableMap}initialize(e){this.cache=e.cache}add(e,n){Object(l.action)("NestedMruCache_add")(()=>{this.clearOldEntriesIfNeeded();let t=null;this.cache.has(e)?t=this.cache.get(e):(t=new i.a(this.cacheLimit),t.initialize(new r.ObservableMap),this.cache.set(e,t)),t.add(n.childMruCacheKey,n)})()}containsValueForKey(e,n){if(!this.cache.has(e))return!1;const t=this.cache.get(e).get(n);return!(!t||u.isExpired(t))}get(e,n){let t=null;return this.containsValueForKey(e,n)&&(t=this.cache.get(e).get(n)),t}clearUpExpiredEntries(){if(!(Date.now()-this.lastExpiredEntryClearedTime<o)){for(let e of this.cache.values())e.getItemIds().forEach(n=>{u.isExpired(e.get(n))&&e.remove(n)});this.lastExpiredEntryClearedTime=Date.now()}}remove(e){Object(l.action)("NestedMruCache_remove")(()=>{if(this.cache.has(e)){const n=this.cache.get(e);n.getItemIds().map(e=>{n.remove(e)})}})()}clear(){Object(l.action)("NestedMruCache_clear")(()=>{const e=this.cache.keys();for(let n of e)this.remove(n)})()}countTotalNumberOfEntries(){let e=0;if(this.cache)for(let n of this.cache.values())e+=n.getItemIds().length;return e}returnAllMailTipsCacheEntries(){let e=[];if(this.cache)for(let n of this.cache.values())n&&n.getItemIds().map(t=>{const r=n.get(t);e.push(r)});return e}clearOldEntriesIfNeeded(){if(this.countTotalNumberOfEntries()>=s&&this.clearUpExpiredEntries(),this.countTotalNumberOfEntries()>=s){let e=[];for(let n of this.cache.values())n.getItemIds().forEach(t=>{e.push(n.get(t))});e.sort(this.comparer);for(let n=0;n<c;n++){const t=e[n].parentCacheKey,r=e[n].childMruCacheKey;this.cache.get(t).remove(r)}}}}t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return u}))},4392:function(e,n,t){"use strict";var r=t(3),i=t(3990),a=t(4008),o=t(3991),s=t(3695),c=t(3418),u=t(3858);var l=t(3863),d=t(71);Object(r.orchestrator)(s.a,async e=>{const{composeId:n,fromEmailAddress:t,recipients:r}=e;if(t&&r&&r.length){const e=Object(c.a)(),a=r.filter(n=>n&&!e.containsValueForKey(t,n));if(a.length){const e=await Object(u.a)(t,a);if(e){const r=e.ResponseMessages.map(e=>Object(l.a)(e.MessageText)).filter(e=>!!e);r&&r.length>0&&(!function(e,n){if(e&&e.length>0&&n){const t=Object(c.a)();e.map(e=>{t.add(n,new i.a(e,n,e.RecipientAddress))})}}(r,t),Object(o.a)(n,t))}}let s=r.filter(e=>-1==a.indexOf(e));Object(d.o)("UpdateMailtipsDatapoint",{owa_1:s.length>0,rec:r.length,ca:s.length})}});t.d(n,"b",(function(){return p}));const f={mailTips:new a.b(i.a.compareEntryCacheTime)},p=Object(r.createStore)("mailTipsCacheStore",f),h=p();n.a=h},4698:function(e,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"k",(function(){return a})),t.d(n,"e",(function(){return o})),t.d(n,"g",(function(){return s})),t.d(n,"f",(function(){return c})),t.d(n,"h",(function(){return u})),t.d(n,"d",(function(){return l})),t.d(n,"i",(function(){return d})),t.d(n,"j",(function(){return f})),t.d(n,"a",(function(){return p})),t.d(n,"c",(function(){return h}));var r=t(3);const i=Object(r.action)("ADD_RECIPIENTS_INTO_LINK",(e,n)=>({linkId:e,recipients:n})),a=Object(r.action)("UPDATE_RECIPIENT_PERMISSION_INFO",(e,n)=>({linkId:e,results:n})),o=Object(r.action)("REMOVE_RECIPIENTS_FROM_LINK",(e,n)=>({linkId:e,recipients:n})),s=Object(r.action)("SET_GET_PERMISSION_INFO_FAILURE",(e,n)=>({linkId:e,recipients:n})),c=Object(r.action)("RESET_SHARING_RECIPIENTS_INFO",e=>({linkId:e})),u=Object(r.action)("SET_ACTION_STATUS",(e,n)=>({linkId:e,linkActionStatus:n})),l=Object(r.action)("IGNORE_SHARING_TIP",(e,n)=>({linkId:e,sharingTipId:n})),d=Object(r.action)("UPDATE_LINK_CONTAINER_ID_OF_LINK",(e,n)=>({linkSharingInformation:e,newLinkContainerId:n})),f=Object(r.action)("UPDATE_LINK_IDS",(e,n,t)=>({linksContainerId:e,newLinkIds:n,linkIdsArrayToUpdate:t})),p=Object(r.action)("ADD_LINK_TO_LINK_IDS",(e,n,t)=>({linkId:e,linksContainerId:n,linkIdsArrayToUpdate:t})),h=Object(r.action)("CREATE_LINKS_ID_CONTAINER",e=>({linksContainerId:e}))},611:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}t.d(n,"a",(function(){return r}))},704:function(e,n,t){"use strict";function r(e,n){return e?Object.assign({mailboxInfo:e},n):null!=n?n:void 0}t.d(n,"a",(function(){return r}))},707:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"ItemResponseShape:#Exchange"},e)}t.d(n,"a",(function(){return r}))},907:function(e,n,t){"use strict";function r(e){return e>=200&&e<300}t.d(n,"a",(function(){return r}))},923:function(e,n,t){"use strict";t.d(n,"e",(function(){return u})),t.d(n,"d",(function(){return l})),t.d(n,"b",(function(){return d})),t.d(n,"c",(function(){return f})),t.d(n,"a",(function(){return p}));const r="A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴऀ-५ॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛱ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞭꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ0-9٠-٩۰-۹߀-߉०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯෦-෯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙᥆-᥏᧐-᧙᪀-᪉᪐-᪙᭐-᭙᮰-᮹᱀-᱉᱐-᱙꘠-꘩꣐-꣙꤀-꤉꧐-꧙꧰-꧹꩐-꩙꯰-꯹０-９",i=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),a=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),o=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),s=/[^\\]"/,c=/^[A-Za-z0-9_-]+:.*$/,u=e=>{const n=e.match(i);if(n)return-1!==n[0].indexOf("..")?null:n[0];const t=e.match(a);if(t){const e=s.exec(t[0]);return e&&e.index!==t[0].length-2?null:t[0]}return null};function l(e){if(!e)return!1;const n=u(e);return!!n&&!!e.substring(n.length+1).match(o)}function d(e){return c.test(e)}function f(e){return!u(e)}function p(e){return l(e)||d(e)}},957:function(e,n,t){"use strict";var r=t(702);class i{constructor(e){this.maxSize=e,this.references=[],this.mruList=[]}initialize(e,n){if(!this.store){this.store=e,this.deleteCallback=n;for(let n of e.keys())this.mruList.push(n)}}add(e,n){Object(r.action)("MruCache_add")(()=>{this.store.set(e,n),this.mruList.indexOf(e)>=0?this.touch(e):(this.mruList.push(e),this.purgeIfNecessary())})()}get(e){return this.store.get(e)}getAndTouch(e){const n=this.store.get(e);return n&&this.touch(e),n}has(e){return this.store.has(e)}remove(e){Object(r.action)("MruCache_remove")(()=>{if(this.store.has(e)&&!this.isReferenced(e))return this.removeItemAtIndex(this.mruList.indexOf(e))})()}registerReference(e){this.references.push(e)}clear(){Object(r.action)("MruCache_clear")(()=>{this.purgeTillSize(0)})()}getItemIds(){return new Array(...this.mruList)}touch(e){let n=this.mruList.indexOf(e);if(n<0)throw new Error(`Item with key '${e}' does not exist in the cache.`);this.mruList.splice(n,1),this.mruList.push(e)}purgeIfNecessary(){this.purgeTillSize(this.maxSize)}purgeTillSize(e){let n=0;for(;this.mruList.length>e&&n<this.mruList.length;){let e=this.mruList[n];this.isReferenced(e)?n++:this.removeItemAtIndex(n)}}removeItemAtIndex(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);let n=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(n):this.store.delete(n)}isReferenced(e){for(let n=0;n<this.references.length;n++){const t=this.references[n]();if(Array.isArray(t)){if(-1!=t.indexOf(e))return!0}else if(t==e)return!0}return!1}}t.d(n,"a",(function(){return i}))},960:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FindItemJsonRequest:#Exchange"},e)}t.d(n,"a",(function(){return r}))},970:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));var r=t(35),i=t(960);function a(e,n){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FindItem",e,n)}},973:function(e,n,t){"use strict";function r(e){return Object.assign({__type:"FindItemRequest:#Exchange"},e)}t.d(n,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.525.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.525.js'] = 1;