(window.$wj=window.$wj||[]).push([[319,24,28,33,35],{12127:function(e){e.exports=JSON.parse('{"a":"hca"}')},1688:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1691);function a(){return Object(r.a)().folderTable}},1689:function(e,t,n){"use strict";var r=n(1849),a=n(1803),i=n(3);const o=Object(i.action)("INITIALIZE_SCENARIO_STORE",(e,t)=>({scenarioId:e,isUsing3S:t}));Object(i.mutator)(o,e=>{const t=Object(r.a)(e.scenarioId);Object(a.b)().scenarioStores.get(t)||(Object(a.b)().scenarioStores.set(t,Object.assign({},Object(a.a)())),Object(a.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)});var c=n(1891),s=n(2068);n.d(t,"a",(function(){return c.b})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return r.a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return s.a}))},1690:function(e,t,n){"use strict";var r=n(3);const a=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),o=Object(r.action)("observableTodayChanged");var c=n(7),s=n(16),u=Object(r.createStore)("ObservableDateTime",{now:0,today:0});const l=Object(s.computed)(()=>Object(c.qc)(u().now)),d=()=>l.get(),f=Object(s.computed)(()=>Object(c.qc)(u().today)),m=()=>f.get(),h=e=>Object(c.Jb)(e,d()),p=e=>Object(c.Hb)(e,d()),b=e=>g(e,c.Jb),O=e=>g(e,c.Kb),g=(e,t)=>t(Object(c.bc)(Object(c.qc)(e)),m());function v(e){if(!e)return"";const t=Object(c.qc)(e);return function(e,t){const n=Object(c.bc)(e);if(Object(c.Lb)(n,t))return c.ab;const r=e=>Object(c.Rb)(n,Object(c.e)(t,-e),t);if(r(3))return c.ib;if(r(30))return c.hb;return c.Y}(t,m())(t)}function I(e){if(!e)return"";return function(e,t){const n=Object(c.bc)(e);return Object(c.Lb)(n,t)?Object(c.ab)(e):j(n,t,2)?Object(c.lb)(e):j(n,t,7)?Object(c.H)(Object(c.bb)(e),Object(c.ab)(e)):Object(c.H)(Object(c.J)(e),Object(c.ab)(e))}(Object(c.qc)(e),m())}function j(e,t,n){return Object(c.Rb)(e,Object(c.e)(t,-n),t)}const y=Object(r.action)("updateTimes"),S=Object(r.action)("setNow"),w=Object(r.action)("setToday",e=>({today:e}));Object(r.mutator)(S,()=>{u().now=Object(c.oc)()}),Object(r.mutator)(w,({today:e})=>{u().today=e});var A=n(22),C=n(88);let T=!1;Object(r.orchestrator)(a,()=>{if(y(),!T){const e=Object(c.Ub)(),t=Object(c.dc)(Object(c.h)(e,1)),n=Object(c.w)(t,e);setTimeout(()=>setInterval(y,A.g),n),document&&document.addEventListener("visibilitychange",y),T=!0}}),Object(r.orchestrator)(C.m,()=>{y()}),Object(r.orchestrator)(y,()=>{S();const e=Object(c.Cb)(Object(c.pc)()),t=u().today!=e;t&&w(e),i(),t&&o()}),n.d(t,"c",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return I}))},1691:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(3),a=n(16);const i=Object(r.createStore)("folderStore",{folderTable:new a.ObservableMap,mailboxFolderTreeData:new a.ObservableMap}),o=i();t.a=i},1696:function(e,t,n){"use strict";var r=n(1709),a=n(2213),i=n(6);function o(e){let t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(a.b)):e>=1048576?(e/=1048576,t=Object(i.b)(a.d)):e>=1024?(e/=1024,t=Object(i.b)(a.c)):t=Object(i.b)(a.a),Object(i.c)(t,Math.round(e))}var c=n(1850),s=n(47);const u=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(s.j)("doc-attachment-documentThumbnail"))return!1;const t=Object(r.a)(e);return!!t&&u.indexOf(t.toLowerCase())>=0}var d;function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return d.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return d.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return d.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(d||(d={}));var m=n(1816);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return m.b})),n.d(t,"a",(function(){return d}))},1698:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(66);function a(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1702:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1691),a=n(57);function i(e){return o(e).folderTreeTable}function o(e){return e||(e=Object(a.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return h})),n.d(t,"d",(function(){return p}));var r=n(20);const a=new r.c(()=>n.e(812).then(n.bind(null,3375))),i=new r.b(a,e=>e.clearSearchBox),o=new r.b(a,e=>e.endSearchSession),c=new r.b(a,e=>e.onBackspacePressedSearchInput),s=new r.b(a,e=>e.onDownArrowPressedSearchInput),u=new r.b(a,e=>e.onLeftArrowPressedSearchInput),l=new r.b(a,e=>e.onUpArrowPressedSearchInput),d=new r.b(a,e=>e.removeSuggestionPillFromSearchBox),f=new r.b(a,e=>e.setIsSuggestionsDropdownVisible),m=new r.b(a,e=>e.setShowSearchBoxInCompactMode),h=new r.b(a,e=>e.updateIsSuggestionSetComplete),p=new r.b(a,e=>e.onDismissGhostTextViaKeyboard)},1704:function(e,t,n){"use strict";var r=n(3);const a=Object(r.action)("ADD_SUGGESTION_PILL",(e,t,n)=>({suggestionPill:e,suggestionSelected:t,scenarioId:n})),i=Object(r.action)("ADD_SUGGESTION_PILL_INTERNAL",(e,t)=>({suggestionPill:e,scenarioId:t})),o=Object(r.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",(e,t,n)=>({indexToSelect:e,suggestionToSelect:t,scenarioId:n}));var c=n(2179);const s=Object(r.action)("DOWNLOAD_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n})),u=Object(r.action)("END_SEARCH_CONVERSATION",e=>({scenarioId:e}));var l=n(2180);const d=Object(r.action)("EXIT_SEARCH",(e,t,n=!1)=>({actionSource:e,scenarioId:t,forceExit:n})),f=Object(r.action)("GET_FILE_SUGGESTION_IMMERSIVE_VIEW",e=>({suggestion:e}));var m=n(2069),h=n(1689);const p=Object(r.mutatorAction)("OVERWRITE_EXISTING_SUGGESTION_PILL",(e,t,n)=>{const r=Object(h.d)(n),a=e.ReferenceId;r.suggestionPills.delete(t),r.suggestionPills.set(a,e);const i=r.suggestionPillIds.indexOf(t);r.suggestionPillIds[i]=a});var b=n(2181),O=n(2182);const g=Object(r.action)("ON_ENTER_PRESSED_SEARCH_INPUT",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t})),v=Object(r.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",e=>({scenarioId:e})),I=Object(r.action)("ON_KEY_DOWN_SEARCH_INPUT",(e,t)=>({evtKeyCode:e,scenarioId:t}));var j=n(2183);const y=Object(r.action)("ON_RESIZE_SUGGESTIONSCALLOUT",(e,t)=>({searchBoxWidth:e,scenarioId:t})),S=Object(r.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}));var w=n(80);const A=Object(r.action)("ON_SEARCH_INPUT_FOCUSED",e=>Object(w.b)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e}));var C=n(2209),T=n(2210);const P=Object(r.action)("onSearchScopeUiDismissed",e=>({searchScenarioType:e})),E=Object(r.action)("ON_SEARCH_TEXT_CHANGED",(e,t)=>({searchText:e,scenarioId:t})),k=Object(r.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",e=>({scenarioId:e})),R=Object(r.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",e=>({scenarioId:e}));var x=n(2184);const D=Object(r.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",(e,t)=>({scenarioId:e,callback:t}));var F=n(2185);const N=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",(e,t,n)=>({suggestionPillId:e,suggestionPillIndex:t,scenarioId:n})),M=Object(r.action)("RESET_CURRENT_SUGGESTIONS",e=>({scenarioId:e}));var _=n(2150);const L=Object(r.action)("SEARCH_BOX_BLURRED",e=>({scenarioId:e})),U=Object(r.action)("SEARCH_SESSION_ENDED",(e,t,n,r)=>({searchSessionGuid:e,scenarioId:t,latestTraceId:n,actionSource:r}));var B=n(1988);const W=Object(r.action)("SET_CURRENT_SUGGESTIONS",(e,t,n=null)=>({suggestionSet:e,scenarioId:t,qfRequestId:n})),G=Object(r.action)("SET_DISPLAYED_QF_REQUEST_TIME",(e,t)=>({displayedQFRequestTime:e,scenarioId:t}));var V=n(2186);const z=Object(r.action)("SET_LATEST_TRACE_ID",(e,t,n)=>({latestTraceId:e,scenarioId:t,isQFTraceId:n})),q=Object(r.action)("SET_SEARCH_TEXT",(e,t)=>({searchText:e,scenarioId:t})),H=Object(r.action)("SET_SELECTED_PILL_INDEX",(e,t)=>({selectedPillIndex:e,scenarioId:t})),$=Object(r.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",(e,t)=>({searchTextForSuggestion:e,scenarioId:t})),J=Object(r.action)("SET_SELECTED_SUGGESTION_INDEX",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t}));var K=n(2187);const Q=Object(r.action)("SET_SUGGESTION_PILL_IDS",(e,t)=>({suggestionPillIds:e,scenarioId:t})),X=Object(r.action)("SET_SUGGESTION_PILLS",(e,t)=>({suggestionPills:e,scenarioId:t})),Y=Object(r.action)("SHARE_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n}));var Z=n(1985);const ee=Object(r.action)("START_SEARCH_SESSION",(e,t,n)=>({actionSource:e,shouldStartSearch:t,scenarioId:n})),te=Object(r.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",(e,t,n,r,a,i)=>({suggestion:e,suggestionIndex:t,actionSource:n,scenarioId:r,suggestionSetTraceId:a,entityActionTakenType:i})),ne=Object(r.action)("SUGGESTION_SELECTED",(e,t,n,r,a)=>({suggestion:e,actionSource:t,scenarioId:n,suggestionSetTraceId:r,index:a}));var re=n(2188);const ae=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",(e,t)=>({isComplete:e,scenarioId:t})),ie=Object(r.action)("COMPLETE_GHOST_TEXT",(e,t)=>({scenarioId:e,evt:t})),oe=Object(r.action)("CLEAR_GHOST_TEXT",e=>({scenarioId:e})),ce=Object(r.action)("SET_GHOST_TEXT",(e,t)=>({scenarioId:e,ghostText:t}));var se=n(2189),ue=n(1703);n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c.a})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l.a})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return m.a})),n.d(t,"N",(function(){return p})),n.d(t,"w",(function(){return b.a})),n.d(t,"y",(function(){return O.a})),n.d(t,"z",(function(){return g})),n.d(t,"A",(function(){return v})),n.d(t,"B",(function(){return I})),n.d(t,"C",(function(){return j.a})),n.d(t,"D",(function(){return y})),n.d(t,"E",(function(){return S})),n.d(t,"F",(function(){return A})),n.d(t,"G",(function(){return C.a})),n.d(t,"H",(function(){return T.a})),n.d(t,"I",(function(){return P})),n.d(t,"J",(function(){return E})),n.d(t,"K",(function(){return k})),n.d(t,"L",(function(){return R})),n.d(t,"M",(function(){return x.a})),n.d(t,"O",(function(){return D})),n.d(t,"P",(function(){return F.a})),n.d(t,"Q",(function(){return N})),n.d(t,"R",(function(){return M})),n.d(t,"S",(function(){return _.a})),n.d(t,"T",(function(){return L})),n.d(t,"U",(function(){return U})),n.d(t,"V",(function(){return B.a})),n.d(t,"W",(function(){return W})),n.d(t,"X",(function(){return G})),n.d(t,"Z",(function(){return V.a})),n.d(t,"ab",(function(){return z})),n.d(t,"bb",(function(){return q})),n.d(t,"db",(function(){return H})),n.d(t,"cb",(function(){return $})),n.d(t,"eb",(function(){return J})),n.d(t,"fb",(function(){return K.a})),n.d(t,"gb",(function(){return Q})),n.d(t,"hb",(function(){return X})),n.d(t,"ib",(function(){return Y})),n.d(t,"jb",(function(){return Z.a})),n.d(t,"kb",(function(){return ee})),n.d(t,"lb",(function(){return te})),n.d(t,"mb",(function(){return ne})),n.d(t,"nb",(function(){return re.a})),n.d(t,"ob",(function(){return ae})),n.d(t,"f",(function(){return ie})),n.d(t,"d",(function(){return oe})),n.d(t,"Y",(function(){return ce})),n.d(t,"x",(function(){return se.a})),n.d(t,"m",(function(){return ue.a})),n.d(t,"n",(function(){return ue.b})),n.d(t,"o",(function(){return ue.c})),n.d(t,"q",(function(){return ue.e})),n.d(t,"r",(function(){return ue.f})),n.d(t,"s",(function(){return ue.g})),n.d(t,"t",(function(){return ue.h})),n.d(t,"u",(function(){return ue.i})),n.d(t,"v",(function(){return ue.k})),n.d(t,"p",(function(){return ue.d}))},1709:function(e,t,n){"use strict";function r(e){if(!e)return null;const t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function a(e){const t=r(e);return t?t.replace(".",""):null}function i(e){var t;return(null===(t=a(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}))},1713:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1824);function a(e){if(!e)return null;return Object(r.a)().attachments.get(e.Id)}},1728:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage",e[e.Sonora=18]="Sonora"}(r||(r={}))},1732:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return c}));const r="FileAttachment:#Exchange",a="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1735:function(e,t,n){"use strict";var r=n(1743);function a(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function i(e,t,n){t&&(e||n)&&Object(r.b)(t,a(e,n))}function o(e,t){var n;const r=null!=t?t:{},a=(null===(n=r.headers)||void 0===n?void 0:n.set)?new Headers(r.headers):new Headers;return r.datapoint=r.datapoint||{},r.datapoint.mailbox=r.datapoint.mailbox||"Explicit",i(e,a),Object.assign(Object.assign({},r),{headers:a})}var c=n(287),s=n(1744),u=n(59),l=n(307),d=n.n(l);async function f(e){return Object(u.b)().then(async t=>{if(e)if(Object(c.r)(e.userIdentity)){const n=await Object(s.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);d()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=a(e.mailboxSmtpAddress);d()(t,n)}return t})}function m(){return Object(u.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function h(e=null){return Object(c.r)(e)?m().then(t=>{return Object(s.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var p=n(52);function b(e,t,n,r){let a=new Headers;return n&&a.set("X-OWA-CANARY",Object(p.a)()),t&&a.set("X-OWA-ActionName",t),(e||r)&&(r?i(e,a,r):i(e,a)),a}n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return b}))},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.e}},1739:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return f}));var r=n(3);const a=Object(r.action)("ADD_SHARING_LINK",(e,t,n,r,a,i,o,c,s,u,l,d,f)=>({linkId:e,url:t,sharingLinkIds:n,response:r,source:a,providerType:i,linksContainerId:o,unwrappedUrl:c,creationDateTime:s,thumbnailUrl:u,previewUrl:l,shareId:d,fromQuotedBody:f})),i=Object(r.action)("SHARING_LINK_REMOVED",(e,t,n,r,a)=>({linkId:e,sharingLinkIds:t,fileName:n,providerType:r,linksContainerId:a})),o=Object(r.action)("DELETE_LINK",(e,t)=>({linkId:e,targetWindow:t})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(e,t,n,r)=>({linkId:e,providerId:t,isTryAgain:n,targetWindow:r})),s=Object(r.action)("ON_LINK_HAS_CHANGED",(e,t,n,r)=>({linkId:e,recipientInfos:t,composeId:n,isCalendar:r})),u=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(e,t)=>({linkId:e,linkIdContainer:t})),l=Object(r.action)("REMOVE_SHARING_LINK_FROM_CONTAINER",(e,t)=>({linkId:e,linkIdContainer:t})),d=Object(r.action)("ON_FLUID_LINK_CREATED",(e,t,n,r,a)=>({linkId:e,containerId:t,owaSource:n,url:r,viewStateId:a})),f=Object(r.action)("ON_EXISTING_FLUID_LINK_PROCESSED",(e,t,n,r,a)=>({linkId:e,containerId:t,owaSource:n,url:r,viewStateId:a}))},1740:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return f}));const r="POST",a="cors",i="GET",o="PUT",c="PATCH",s="_api/v2.0",u="v1.0",l="v2.1",d="https://api.onedrive.com",f="https://my.microsoftpersonalcontent.com"},1743:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function a(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},1744:function(e,t,n){"use strict";var r=n(1877),a=n(287),i=n(1690),o=n(71),c=n(7),s=n(36);const u="X-AnchorMailbox",l="Authorization",d="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function m(e,t){const n={},m=Object(a.k)(e);if(t?(n[u]=t,n[f]=t):m&&(n[u]=m.anchorMailbox),Object(a.s)())return s.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(m){if(m.accountState==a.b.AccessRevoked)return null;if(m.accountState==a.b.AccountDeprovisioned||m.accountState==a.b.AccountNotFound)return Object(a.d)(m.accountState,m.accountProviderType),null}if(m){let t,a=m.token,u=Object(i.f)(m.tokenExpiry);!u&&a||(Object(o.o)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(m.tokenExpiry,Object(c.Ub)()),isTokenExpired_1:u,isTokenInvalid_2:!a},{isCore:!0}),a=await r.a.importAndExecute(m.accountId,e,a),s.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+a),a||(a="")),"Outlook"==m.accountProviderType?(t=`MSAuth1.0 usertoken="${a}", type="MSACT"`,n[d]=1..toString()):"Google"!=m.accountProviderType&&"ICloud"!=m.accountProviderType&&"Yahoo"!=m.accountProviderType||(t=`Bearer ${a}`,n[d]=2..toString()),n[l]=t}return n}var h=n(1743),p=n(912);async function b(e,t){var n;const r=Object(h.a)();if(r.headers=await async function(e,t){var n;const r=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,a=await m(e.mailboxInfo.userIdentity,O(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(h.b)(r,a),r}(e,t),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},Object(a.s)()){const t=Object(p.a)(null===(n=null==e?void 0:e.mailboxInfo)||void 0===n?void 0:n.userIdentity);s.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+t),r.sourceId=t,r.datapoint.mailbox="Connected"}else r.datapoint.mailbox="Connected";return r}function O(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&s.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return O}))},1753:function(e,t,n){"use strict";var r=n(2887),a=n(2914),i=n(2915),o=n(702);t.a=Object(o.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(i.a)(e)?Object(a.a)(e,!0):Object(a.a)(e,!1)}))},1761:function(e,t,n){"use strict";var r=n(20);var a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"j",(function(){return o})),n.d(t,"k",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return a}));const i=new r.c(()=>Promise.all([n.e(0),n.e(543)]).then(n.bind(null,19504))),o=new r.a(i,e=>e.subscribe),c=new r.a(i,e=>e.unsubscribe),s=new r.b(i,e=>e.getChannelId),u=new r.a(i,e=>e.getChannelReady),l=new r.a(i,e=>e.retryDisconnectionWithMinimumReconnectInterval),d=new r.a(i,e=>e.setup),f=new r.a(i,e=>e.handleNotification),m=new r.a(i,e=>e.NotificationManager.stopConnection),h=new r.a(i,e=>e.initializeNotificationManager),p=new r.b(i,e=>e.getNotificationEmitter)},1764:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d}));var r=n(20);const a=new r.c(()=>Promise.all([n.e(0),n.e(28),n.e(643)]).then(n.bind(null,3857)));let i=new r.a(a,e=>e.logLocalContentDataSource),o=new r.a(a,e=>e.logLocalContentLayout),c=new r.a(a,e=>e.clearLocalContentInstrumentationCache),s=new r.b(a,e=>e.getLocalContentId);const u=new r.b(a,e=>e.substrateSearchInitOperation),l=(new r.b(a,e=>e.substrateSearchPostSuggestionsService),new r.b(a,e=>e.deleteSubstrateSearchHistoryService)),d=new r.b(a,e=>e.exportSubstrateSearchHistoryService)},1765:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},1767:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));var r=n(1678),a=n(1698),i=n(1691),o=n(1792),c=n(1688),s=n(1835),u=n(1839),l=n(1818);function d(e,t){const n=Object(c.a)();if(t){return[...n.values()].filter(n=>n.distinguishedFolderType===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function f(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(s.a)(t);break;case"SharedMailbox":n=Object(u.a)(t);break;default:n=Object(o.a)(t)}const c=Object(l.a)();if("UserMailbox"==e&&n.distinguishedFolderType==Object(o.a)(t).distinguishedFolderType&&n.id){const e=c.map(e=>d(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.id):e.map(e=>e.id)}const f=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>i.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.id)}(n,t);for(let e=0;e<f.length;e++)-1==c.indexOf(Object(a.a)(f[e]))&&r.push(f[e]);return r}function m(e,t){const n=Object(c.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},1774:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(332);function a(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1777:function(e,t,n){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function a(e){let t=null;const n=r.exec(e);if(n){const e=n[1],r=n[2];let a=null;try{a=atob(r)}catch(e){}if(a){const n=new ArrayBuffer(a.length),r=new Uint8Array(n);for(let e=0;e<a.length;e++)r[e]=a.charCodeAt(e);t=new File([n],"image.png",{type:e})}}return t}var i=n(1728),o=n(1696);function c(e){return e.map(e=>({fileType:i.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}))}var s=n(36);function u(e,t,n){if(e.length!=t.length)return s.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let a=0;a<e.length;a++){const o={fileType:i.a.MailItem,name:e[a],size:(null==n?void 0:n[a])||0,itemId:t[a]};r.push(o)}return r}function l(e,t,n){const r=[],a={fileType:i.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(a),r}function d(e){if(!e)return null;let t=[];for(var n=0;n<e.length;n++){const r=e[n],a={fileType:i.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(a)}return t}function f(e){if(!e)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n],a={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(a)}return t}function m(e){var t,n;if(null===e)return null;return{fileType:i.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function h(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:i.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var p=n(1778);function b(e){switch(e?e.toLowerCase():null){case p.d.ONE_DRIVE_PRO.toLowerCase():return 0;case p.d.GDRIVE.toLowerCase():return 5;case p.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case p.d.DROPBOX.toLowerCase():return 2;case p.d.BOX.toLowerCase():return 3;case p.d.WOPI_BOX.toLowerCase():return 7;case p.d.WOPI_EGNYTE.toLowerCase():return 8;case p.d.MAILBOX.toLowerCase():return 4;case p.d.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return a})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return i.a}))},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return m})),n.d(t,"d",(function(){return h}));const r="Box",a="Dropbox",i="Facebook",o="GDrive",c="Mailbox",s="MailMessage",u="OneDriveConsumer",l="OneDrivePro",d="WopiBox",f="WopiDropbox",m="WopiEgnyte",h={BOX:r,DROPBOX:a,FACEBOOK:i,GDRIVE:o,MAILBOX:c,ONE_DRIVE_CONSUMER:u,ONE_DRIVE_PRO:l,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:d,WOPI_EGNYTE:m}},1782:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return c}))},1784:function(e,t,n){"use strict";var r=n(1931),a=n(1864),i=n(1798),o=n(1857),c=n(2190),s=n(1738);function u(e,t,n,u){if(Object(i.c)(n))return function(e){return 2===Object(o.a)(e)?f():l()}(n);if(3===Object(o.a)(n)&&!u)return d();let m;switch(t){case 2:m={allowEdit:!1,previewMethod:a.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:m={allowEdit:!1,previewMethod:a.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:m={allowEdit:!1,previewMethod:a.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:m={allowEdit:e.wacEdit,previewMethod:a.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:m={allowEdit:!1,previewMethod:a.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:m={allowEdit:!1,previewMethod:a.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:m=f();break;case 11:m={allowEdit:!1,previewMethod:a.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:m={allowEdit:!1,previewMethod:a.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:m={allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]};break;case 13:m={allowEdit:!1,previewMethod:a.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]};break;default:m=function(e){return Object(c.a)(e)||Object(s.a)(e)}(n)?d():l()}return m}function l(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.Download]}}function d(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function f(){return{allowEdit:!1,previewMethod:a.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var m=n(3),h=Object(m.mutatorAction)("setIsPlaceholderAttachment",(function(e,t){e.isPlaceholderAttachment=t})),p=Object(m.mutatorAction)("setThumbnailLoadState",(function(e,t){e.thumbnailLoadState=t}));function b(e,t,n,r,i,o=null){return{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]},parentItemId:o,fileType:i}}var O,g=n(38);function v(){return Object(g.a)().SessionSettings.CompanyName}function I(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub"}(O||(O={})),n.d(t,"e",(function(){return u})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return I})),n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return O}))},1786:function(e,t,n){"use strict";var r,a=n(1696),i=n(2144),o=n(38),c=n(1850),s=n(2355),u=n(1857);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));class l{constructor(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPublicComputersEnabled):(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPrivateComputersEnabled),this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}getPolicyInfo(e,t,n,a){e&&(e=e.toLowerCase());let i=this.getFileAccessLevel(e,t),o=!1,u=!1,l=!1;const d=1===a||3===a;if(i!==r.Block&&n){this.isWacViewingEnabled(e)&&(o=!0),!this.directFileAccessEnabled&&d&&(o=!1),u=this.isForceBrowserViewingFirst(o),o&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(l=0===a?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),o||Object(c.b)(e)||Object(s.a)(e)||this.directFileAccessEnabled||(i=r.AccessDisabled)}return{directFileAccessEnabled:this.directFileAccessEnabled,level:i,useWac:o,forceBrowserViewingFirst:u,wacEdit:l}}isPdfPreviewEnabled(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled}getFileAccessLevel(e,t){let n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;const a=this.mimeTypeToPolicyMap[t];return a===r.Block?r.Block:n===r.ForceSave||a===r.ForceSave?r.ForceSave:n===r.Allow||a===r.Allow?r.Allow:this.policyForUnknownTypes}isWacViewingEnabled(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0}isForceBrowserViewingFirst(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)}addPolicyIntoMap(e,t,n){t&&t.forEach(t=>{e[t]=n})}createPolicyMap(e,t,n){const a={};return this.addPolicyIntoMap(a,n,r.Allow),this.addPolicyIntoMap(a,t,r.ForceSave),this.addPolicyIntoMap(a,e,r.Block),a}}let d=null,f=null;function m(){if(!d){const e=Object(o.a)(),t=Object(i.c)(),n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;d=new l(t,n),n&&(f=d)}return d}function h(e,t){const n=Object(a.b)(e.Name),r=e.ContentType;return m().getPolicyInfo(n,r,t,Object(u.a)(e))}function p(e,t){const n=Object(a.b)(e.Name),r=e.ContentType;return function(){if(!f){const e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return m();f=new l(Object(i.c)(),!0)}return f}().getPolicyInfo(n,r,t,Object(u.a)(e))}function b(e,t,n,a,i){if(a||i)return!1;const o=h(e,!0),c=m();return o.level!==r.Block&&c.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return m}))},1787:function(e,t,n){"use strict";var r=n(1740),a=n(2171);function i(e){let t;try{t=btoa(e)}catch(n){t=btoa(unescape(encodeURIComponent(e)))}finally{return"u!"+t.replace(/=+$/,"").replace("/","_").replace("+","-")}}n.d(t,"g",(function(){return r.i})),n.d(t,"a",(function(){return r.b})),n.d(t,"b",(function(){return r.c})),n.d(t,"h",(function(){return r.j})),n.d(t,"f",(function(){return r.h})),n.d(t,"c",(function(){return r.d})),n.d(t,"d",(function(){return r.f})),n.d(t,"e",(function(){return r.g})),n.d(t,"i",(function(){return a.a})),n.d(t,"j",(function(){return i}))},1792:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1795),a=n(1679);function i(e){return Object(r.a)(a.k,e)}},1795:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1702);function a(e,t){const n=Object(r.a)(t),a=n&&n.get(e);return null==a?void 0:a.rootFolder}},1796:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1798:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"l",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return h})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"m",(function(){return O}));var r=n(20),a=n(1905);n.d(t,"n",(function(){return a.a})),n.d(t,"o",(function(){return a.b})),n.d(t,"p",(function(){return a.c}));var i=n(1824);n.d(t,"a",(function(){return i.a}));var o=n(1957);n.d(t,"c",(function(){return o.a})),n.d(t,"b",(function(){return o.b}));const c=new r.c(()=>Promise.all([n.e(0),n.e(24),n.e(35),n.e(108),n.e(519)]).then(n.bind(null,3788))),s=new r.a(c,e=>e.addAndInitializeAttachments),u=new r.a(c,e=>e.setPreviewImageUrl),l=new r.a(c,e=>e.refreshDownloadUrl),d=new r.a(c,e=>e.createAttachmentInfo),f=new r.a(c,e=>e.setAttachmentInfo),m=new r.a(c,e=>e.refreshThumbnailImageUrl),h=new r.a(c,e=>e.refreshPreviewImageUrl),p=new r.b(c,e=>e.getAttachment),b=new r.b(c,e=>e.checkPendingAttachmentOperation),O=new r.b(c,e=>e.shouldShowImageView)},1803:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),a=n(3);const i=()=>({alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,alterationDisplayText:"",traceIdToLogicalIdMap:new r.ObservableMap,tableViewId:null,isScopePickerVisible:!1,filters:[],placeholderIdToIsRenderedMap:new r.ObservableMap}),o={scenarioStores:new r.ObservableMap},c=Object(a.createStore)("commonSearchStore",o);t.b=c},1804:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(a||(a={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},1808:function(e,t,n){"use strict";var r,a=n(20),i=n(1739),o=n(1821),c=n(2409);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.InsertLinkFromSonora="InsertLinkFromSonora",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.NewFluidFile="NewFluidFile",e.Unknown="Unknown"}(r||(r={}));var s=n(2104),u=n(2424),l=n(2369),d=n(1898),f=n(1912);const m=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function h(e){const t=Object(f.a)(e);return t&&-1!==m.indexOf(t.source)}var p=n(2349);function b(e){const t=Object(f.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:h(e)?"newLink":"oldLink"}:null}var O=n(2316);function g(){return Object(O.a)().sharingLinks.size}var v=n(2410);n.d(t,"t",(function(){return j})),n.d(t,"D",(function(){return y})),n.d(t,"K",(function(){return S})),n.d(t,"G",(function(){return w})),n.d(t,"E",(function(){return A})),n.d(t,"B",(function(){return C})),n.d(t,"H",(function(){return T})),n.d(t,"I",(function(){return P})),n.d(t,"J",(function(){return E})),n.d(t,"v",(function(){return k})),n.d(t,"s",(function(){return R})),n.d(t,"A",(function(){return x})),n.d(t,"u",(function(){return D})),n.d(t,"F",(function(){return F})),n.d(t,"C",(function(){return N})),n.d(t,"y",(function(){return M})),n.d(t,"x",(function(){return _})),n.d(t,"w",(function(){return L})),n.d(t,"z",(function(){return U})),n.d(t,"P",(function(){return I})),n.d(t,"d",(function(){return i.a})),n.d(t,"e",(function(){return i.b})),n.d(t,"f",(function(){return i.c})),n.d(t,"h",(function(){return i.d})),n.d(t,"R",(function(){return i.h})),n.d(t,"T",(function(){return i.i})),n.d(t,"M",(function(){return i.f})),n.d(t,"N",(function(){return i.g})),n.d(t,"L",(function(){return i.e})),n.d(t,"U",(function(){return o.e})),n.d(t,"V",(function(){return o.f})),n.d(t,"W",(function(){return o.g})),n.d(t,"S",(function(){return o.c})),n.d(t,"g",(function(){return o.b})),n.d(t,"Q",(function(){return c.b})),n.d(t,"a",(function(){return r})),n.d(t,"o",(function(){return s.a})),n.d(t,"q",(function(){return s.b})),n.d(t,"O",(function(){return u.a})),n.d(t,"c",(function(){return l.a})),n.d(t,"i",(function(){return d.a})),n.d(t,"j",(function(){return d.b})),n.d(t,"r",(function(){return d.c})),n.d(t,"p",(function(){return h})),n.d(t,"b",(function(){return p.a})),n.d(t,"m",(function(){return f.a})),n.d(t,"l",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"n",(function(){return v.a}));const I=new a.c(()=>Promise.all([n.e(0),n.e(24),n.e(96),n.e(525)]).then(n.bind(null,19465))),j=new a.b(I,e=>e.addRecipientsIntoLink),y=new a.b(I,e=>e.removeRecipientsFromLink),S=new a.b(I,e=>e.updateRecipientPermissionInfos),w=new a.b(I,e=>e.setGetPermissionInfoFailure),A=new a.b(I,e=>e.resetSharingRecipientsInfo),C=new a.b(I,e=>e.ignoreSharingTip),T=new a.b(I,e=>e.setLinkActionStatus),P=new a.b(I,e=>e.updateLinkContainerIdOfLink),E=new a.b(I,e=>e.updateLinkIds),k=new a.b(I,e=>e.createLinksIdContainer),R=new a.b(I,e=>e.addLinkIdToLinksIdContainer),x=new a.b(I,e=>e.getSharingTipRecipientInfo),D=new a.b(I,e=>e.createCloudFileFromSharingLink),F=new a.b(I,e=>e.retrieveImageUrlsForImageFile),N=new a.b(I,e=>e.imageLinkPreviewCondition),M=new a.b(I,e=>e.getLinksIdContainer),_=new a.b(I,e=>e.getAllLinksContainerIds),L=new a.b(I,e=>e.doesLinksIdContainerExist),U=new a.b(I,e=>e.getSharingLinkInfo)},1816:function(e,t,n){"use strict";function r(e){return function(e){const t=i.exec(e);return t&&t.length>1&&a[t[1].toLowerCase()]}(e||"")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const a={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){let t="";return Object.entries(a).forEach(n=>{n[1]===e&&(t=n[0])}),t}},1818:function(e,t,n){"use strict";var r=n(57),a=n(47);function i(e){var t;const n=Object(r.g)().SegmentationSettings,i=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(a.j)("cal-stickyNotesFolder")&&!i}var o=n(296);function c(){const e=Object(o.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(a.j)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}))},1821:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(3);const a=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(e,t)=>({linkId:e,sharingDialogResponse:t})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(e,t)=>({linkId:e,newPermission:t})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(e,t,n,r)=>({linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(e,t)=>({linkId:e,actionStatus:t})),s=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(e,t,n,r,a,i,o,c,s)=>({linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:a,providerType:i,composeId:o,recipientInfos:c,isCalendar:s})),u=Object(r.action)("ADD_SHARING_LINK_INFO",(e,t)=>({linkId:e,linkModel:t})),l=Object(r.action)("TOKEN_UNAVAILABLE",e=>({linkId:e}))},1824:function(e,t,n){"use strict";var r=n(16),a=n(3);const i={attachments:new r.ObservableMap({})},o=Object(a.createStore)("attachment",i);t.a=o},1835:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1795),a=n(1679);function i(e){return Object(r.a)(a.d,e)}},1836:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(i||(i={}))},1839:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1795);function a(e){return Object(r.a)(e)}},1846:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function a(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},1849:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1891);function a(e){switch(e){case r.a.Mail:return"Mail";case r.a.Calendar:return"Calendar";case r.a.FilesHub:return"FilesHub";case r.a.FilesPicker:return"FilesPicker";case r.a.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},1850:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u}));var r=n(1709),a=n(1816),i=n(175);const o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],c=[".tiff",".tif"];function s(e,t,n=!0){return u(Object(r.a)(e)||Object(a.a)(t),n)}function u(e,t=!0){return!!e&&(o.indexOf(e.toLowerCase())>=0||t&&c.indexOf(e.toLowerCase())>=0&&(Object(i.c)()||Object(i.f)()))}},1854:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},1857:function(e,t,n){"use strict";var r=n(1732),a=n(6);const i=e=>e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e);function o(e){const t=e.__type||e.OwsTypeName;switch(t){case r.a:return 0;case r.e:return e.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:const n=e,o=e.EmbeddedItemClass;return o&&i(o)||Object(a.k)(n.AttachmentIdToAttach)?2:0;default:throw new Error(`Invalid type of attachment ${t}`)}}n.d(t,"a",(function(){return o}))},1858:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c}));const r="originalsrc",a="shash",i="data-auth",o="&reserved=0",c="Verified"},1862:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1857);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},1864:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},1877:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(20),a=n(1765);n.d(t,"b",(function(){return a.a}));const i=new r.c(()=>n.e(874).then(n.bind(null,2361))),o=new r.a(i,e=>e.getAndUpdateAccessToken)},188:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,a=!1;function i(t){r--,delete e[t]}this.put=function(t,n,a,o){if(void 0!==a&&("number"!=typeof a||isNaN(a)||a<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):r++;var s={value:n,expire:a+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){i(t),o&&o(t,n)}.bind(this),a)),e[t]=s,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),a&&(t=0,n=0)},this.get=function(i){var o=e[i];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return a&&t++,o.value;a&&n++,r--,delete e[i]}else a&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){a=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),a=Date.now(),i=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(i)if(e[o])continue;var c=r[o],s=c.expire-a;if(s<=0){this.del(o);continue}s=s>0?s:void 0,this.put(o,c.value,s)}return this.size()}}e.exports=new r,e.exports.Cache=r},1891:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.FileSuggestions=5]="FileSuggestions"}(r||(r={})),t.b=r},1892:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},1898:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(47);const a="_ODSPPSL";function i(e){return Object(r.j)("doc-link-savePermission")&&e&&-1!==e.indexOf(a)?e.substring(0,e.length-a.length):e}function o(e){return!!Object(r.j)("doc-link-savePermission")&&e.lastIndexOf(a)===e.length-a.length}function c(e,t){return!Object(r.j)("doc-link-savePermission")||2!==t&&1!==t?e:e+a}},1905:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(3);const a=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",e=>({attachmentId:e})),i=Object(r.action)("SET_ATTACHMENT_CONTENTID",(e,t)=>({attachmentId:e,attachmentContentId:t})),o=Object(r.action)("SET_ATTACHMENT_ISINLINE",(e,t)=>({attachmentId:e,isInline:t}))},1912:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2316),a=n(1898);function i(e){const t=Object(r.a)(),n=Object(a.b)(e);return t.sharingLinks.get(n)}},1914:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"v",(function(){return c})),n.d(t,"l",(function(){return s})),n.d(t,"o",(function(){return u})),n.d(t,"r",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"h",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return O})),n.d(t,"k",(function(){return g})),n.d(t,"m",(function(){return v})),n.d(t,"p",(function(){return I})),n.d(t,"q",(function(){return j})),n.d(t,"n",(function(){return y})),n.d(t,"u",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"s",(function(){return A})),n.d(t,"t",(function(){return C}));var r=n(20);const a=new r.c(()=>n.e(1009).then(n.bind(null,3021)));let i=new r.a(a,e=>e.logEntityClicked);const o=new r.a(a,e=>e.logResponseReceived);let c=new r.a(a,e=>e.logSessionEnd),s=new r.a(a,e=>e.logResponseRendered);const u=new r.a(a,e=>e.logSearchBoxStateChanged);let l=new r.a(a,e=>e.logSearchResultInteraction),d=new r.a(a,e=>e.logResponseNeverRendered);const f=new r.a(a,e=>e.flushNonRenderedResponseReceivedItemsFromCache),m=new r.a(a,e=>e.logCachedContentRendered);let h=new r.a(a,e=>e.logFeedback);const p=new r.a(a,e=>e.logClientLayout),b=new r.a(a,e=>e.logClientDataSource),O=new r.a(a,e=>e.logEntitiesFromFilePicker),g=new r.a(a,e=>e.logResponseRecievedV2),v=new r.a(a,e=>e.logResultsRendered),I=new r.a(a,e=>e.logSearchEntityActions),j=new r.a(a,e=>e.logSearchFeedbackActions),y=new r.a(a,e=>e.logSearchActions);let S=new r.a(a,e=>e.logSecondaryEntityActionClicked);const w=new r.a(a,e=>e.clearProcessedTraceIds),A=new r.a(a,e=>e.logSearchSuggestionsClientLayoutEvent),C=new r.a(a,e=>e.logSearchSuggestionsResultsRenderedEvent)},1925:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1928:function(e,t,n){"use strict";var r=n(3016),a=n(2245),i=n(1753);const o={};class c{constructor(e,t,n){this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=()=>{this.currentTimePercent+=this.updateIntervalInPercent;const e=this.getActionCompletePercent();e<=this.maxPercent?(this.updatePropertyHandler(e),this.nextUpdateTimer=setTimeout(this.start,this.estimatedTimeToCompleteInMS*this.updateIntervalInPercent)):this.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}complete(){this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout(()=>this.updatePropertyHandler(1.1),500)}abort(){this.clearUpdateTimer(),this.updatePropertyHandler(0)}clearUpdateTimer(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)}getActionCompletePercent(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)}}function s(e,t){const n=o[e.Id];n&&(t?n.complete():n.abort(),delete o[e.Id])}function u(e,t,n,r){const a=new c(e,t,n);o[r.Id]=a,a.start()}var l=n(3026),d=n(3);Object(d.orchestrator)(r.a,async e=>{let t;!function(e){Object(i.a)(e,7,13)}(e.attachment);try{t=await Object(l.a)(null,null,null,e.attachment.attachmentId.Id)}catch(e){}const n=t?14:15;!function(e,t,n,r,o){s(e,!0),Object(a.a)(n,o),Object(i.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7)});var f=n(1854),m=n(2506),h=n(36);function p(e){return Object.assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var b=n(35);function O(e,t,n,r,a){const i=function(e,t,n,r,a){return p({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return void 0===(o={requestObject:i}).requestObject||o.requestObject.__type||(o.requestObject=p(o.requestObject)),Object(b.a)("ConvertLocalToRefAttachment",o,c);var o,c}var g=n(71),v=n(1713),I=n(2051),j=n(2118),y=n(47),S=n(1761),w=n(702);const A={};var C=Object(w.action)("convertClassicToCloudy")((function e(t,n,r,a=!0){const o=new g.b("AttachmentConvertClassicToCloudy");!function(e){Object(i.a)(e,5,8)}(t);return async function(e,t,n,r){const[a,i,o,c]=await Object(I.a)(n);A[e.Id]=a;try{await O(e.Id,t,a,c,a)}catch(e){r(e.message),S.k.importAndExecute(i,o)}}(t.attachmentId,n,i=>{if(T(t,i.ResultCode),P(o,t.attachmentId,i.ResultCode,i.Exception),0===i.ResultCode&&i.Response&&i.Response.ResponseMessages&&i.Response.ResponseMessages.Items&&i.Response.ResponseMessages.Items.length>0&&"NoError"===i.Response.ResponseMessages.Items[0].ResponseCode){const e=i.Response.ResponseMessages.Items[0];r(!0,e.Attachments[0])}else if(Object(y.j)("doc-authcontextStage2")&&25===i.ResultCode&&!a){const a=i.ClaimsChallenge;a?(async()=>{let i=!1;try{const e=await j.a.import();await e(a)}catch(e){i=!0}i?(h.h.info("convertClassicToCloud remediateAuth failed"),r(!1,null)):(h.h.info("Retry convertClassicToCloud after remediateAuth"),e(t,n,r,!0))})():r(!1,null)}else r(!1,null);return!0},e=>{T(t,1),r(!1,null),P(o,t.attachmentId,1,e)})}));function T(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,9)}delete A[e.attachmentId.Id]}function P(e,t,n,r){const a=Object(v.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function E(e){return Object.assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function k(e){const t=function(e){return E({cancellationId:e})}(e);return void 0===(n=t)||n.__type||(n=E(n)),Object(b.a)("CancelConvertLocalToRefAttachment",n,r);var n,r}var R=Object(g.r)({name:"CancelConvertClassicToCloudy"},(function(e){const t=(n=e.attachmentId.Id,A[n]);var n;if(!t)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(i.a)(e,5,10),k(t)})),x=n(1959),D=Object(d.mutatorAction)("setActionCompletePercent",(function(e,t){e.actionCompletePercent=t})),F=n(2256),N=n(2234),M=n(1784),_=n(2413),L=n(2691),U=n(2692),B=n(1862),W=n(2257),G=n(1941),V=Object(w.action)("updateAttachment")((function(e,t,n,r,a){Object(L.a)(e.attachmentId);const o=Object.assign(Object.assign({},r.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=o,r.Name&&(n.Name=r.Name),r.Size&&(n.Size=r.Size),r.ContentType&&(n.ContentType=r.ContentType),r.__type&&(n.__type=r.__type),n.IsInline&&(n.ContentId=r.ContentId),Object(B.b)(r)){const e=n;e.AttachLongPathName=r.AttachLongPathName,e.PermissionType=r.PermissionType,e.ProviderType=r.ProviderType,e.AttachmentThumbnailUrl=r.AttachmentThumbnailUrl,e.AttachmentPreviewUrl=r.AttachmentPreviewUrl}if(Object(_.a)([{attachmentId:o,attachment:n,permissionInfo:a}],!1),e.attachmentId=o,Object(W.a)(e))Object(N.a)(e,1);else{Object(M.h)(e,!1),setTimeout(()=>{D(e,1.1)},500),Object(i.a)(e,0,0),Object(F.a)(e,!1);const t=Object(v.a)(o);Object(G.a)(e,t,!1,e.strategy.supportedMenuActions),t.download.url||Object(U.a)(o,e.isReadOnly,!0)}}));function z(e){return Object.assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function q(e,t,n,r,a,i,o,c){const s=function(e,t,n,r,a,i,o,c){return z({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:i,attachmentDataProviderId:c,PermissionLevel:o})}(e,t,n,r,a,i,o,c);return void 0===(u={requestObject:s}).requestObject||u.requestObject.__type||(u.requestObject=z(u.requestObject)),Object(b.a)("ConvertRefToLocalAttachment",u,l);var u,l}function H(e){return X(Object(v.a)(e).model.Size)}function $(e){return 2856+.00145*e}function J(e){return 4*X(e)}function K(e){return 4*X(e)}function Q(e){return 2*X(e)}function X(e){return Math.round(e/256)}var Y=n(2890);const Z={},ee=Object(d.action)("convertCloudyToClassic",(e,t,n,r,a,i)=>({attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:i}));var te=ee;function ne(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,12)}delete Z[e.attachmentId.Id]}function re(e,t,n,r,a){var i;const o=Object(v.a)(t);e.addCosmosOnlyData(JSON.stringify({size:o.model.Size,attachmentId:null===(i=o.model.AttachmentId)||void 0===i?void 0:i.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}Object(d.orchestrator)(ee,e=>{const t=e.attachment;!async function(e,t,n,r,a,o){const c=new g.b("AttachmentConvertCloudyToClassic");!function(e){Object(i.a)(e,6,11)}(e);await async function(e,t,n,r,a,i){const[o,c,s,u]=await Object(I.a)(a);Z[e.Id]=o;try{await q(e.Id,t,o,u,o,n,r)}catch(e){i(e.message),S.k.importAndExecute(c,s)}}(e.attachmentId,t,n,r,t=>{if(ne(e,t.ResultCode),re(c,e.attachmentId,t.ResultCode,t.Exception,o),0===t.ResultCode){const e=Object(Y.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});a(!0,e)}else a(!1,null);return!0},t=>{ne(e,1),a(!1,null),re(c,e.attachmentId,1,t,o)})}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(n,r)=>{n?e.replaceAttachmentHandler(t,r,!1,!0):s(t.attachmentId,n)},e.source),u(H(t.attachmentId),.1,e=>{D(t,e)},t.attachmentId)});var ae={name:"CancelConvertCloudyToClassic"};function ie(e){return Object.assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function oe(e){const t=function(e){return ie({cancellationId:e})}(e);return void 0===(n=t)||n.__type||(n=ie(n)),Object(b.a)("CancelConvertRefToLocalAttachment",n,r);var n,r}var ce=n(80);const se=Object(d.action)("cancel_ConvertCloudyToClassic",e=>Object(ce.b)(ae,{attachmentViewState:e}));var ue=se;Object(d.orchestrator)(se,e=>{const t=function(e){return Z[e]}(e.attachmentViewState.attachmentId.Id);if(!t)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(i.a)(e.attachmentViewState,6,10),oe(t)});var le=n(1798),de=n(1786),fe=n(2490),me=n(2142),he=n(1778);async function pe(e){const t=await me.h.import(),n=e.model;n.ProviderType===he.d.ONE_DRIVE_PRO&&t(n.AttachLongPathName,fe.a.OneDrivePro,!1).then(async t=>{if(!t||0!==t.ResultCode)return;const n=Object(de.b)(e.model,!0),r=await le.f.importAndExecute(n,e.attachmentClass,e.model,!0,e.model.ProviderType,t);le.k.importAndExecute(e.id,r),Object(le.n)(e.id)})}var be=n(1696);function Oe(e,t,n){if(e&&t===he.d.ONE_DRIVE_PRO&&(Object(y.j)("doc-SxS-jsApi-ODB-Base")||Object(y.j)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(y.j)("doc-SxS-jsApi-ODB-Readonly"))){const e=n&&n.substring(n.lastIndexOf("."));switch(Object(be.f)(e)){case be.a.Word:return Object(y.j)("doc-SxS-jsApi-ODB-Word");case be.a.Excel:return Object(y.j)("doc-SxS-jsApi-ODB-Excel");case be.a.PowerPoint:return!Object(y.j)("doc-SxS-jsApi-ODB-Readonly")&&Object(y.j)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var ge=n(2255),ve=n(1777);function Ie(e,t,n=!1,r=0,a=!1){return{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:ve.a.Inline,skipProcessInlineImage:a}}function je(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var ye=n(2254);n.d(t,"a",(function(){return f.a})),n.d(t,"h",(function(){return m.a})),n.d(t,"c",(function(){return R})),n.d(t,"e",(function(){return C})),n.d(t,"u",(function(){return x.a})),n.d(t,"w",(function(){return x.c})),n.d(t,"v",(function(){return x.b})),n.d(t,"D",(function(){return x.d})),n.d(t,"x",(function(){return D})),n.d(t,"y",(function(){return F.a})),n.d(t,"z",(function(){return N.a})),n.d(t,"A",(function(){return i.a})),n.d(t,"E",(function(){return V})),n.d(t,"r",(function(){return G.a})),n.d(t,"o",(function(){return G.b})),n.d(t,"d",(function(){return ue})),n.d(t,"f",(function(){return te})),n.d(t,"m",(function(){return pe})),n.d(t,"b",(function(){return Oe})),n.d(t,"B",(function(){return u})),n.d(t,"C",(function(){return s})),n.d(t,"k",(function(){return $})),n.d(t,"l",(function(){return K})),n.d(t,"q",(function(){return J})),n.d(t,"j",(function(){return Q})),n.d(t,"g",(function(){return ge.a})),n.d(t,"i",(function(){return Ie})),n.d(t,"p",(function(){return H})),n.d(t,"t",(function(){return je})),n.d(t,"s",(function(){return W.a})),n.d(t,"n",(function(){return ye.a}))},1931:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},1934:function(e,t,n){"use strict";var r=n(1799),a=n(611);function i(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function o(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var c=n(1925),s=n(1698);var u=n(1678),l=n(1782),d=n(1679),f=n(1767);n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return y}));const m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(l.b)({folderId:Object(u.a)(d.k),kind:"PrimaryMailbox"}));const t=Object(f.b)("UserMailbox");for(let n of t)e.push(Object(l.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(s.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(a.a)({Id:e.folderId}),[(i={FolderScope:o({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},i))];var i}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(l.a)({folderId:Object(u.a)(d.d),kind:"ArchiveMailbox"})),e.push(Object(l.a)({folderId:Object(u.a)(d.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(s.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(a.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(c={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},c))]:[i({FolderScope:o({BaseFolderId:n})})];var c}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},b={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(c.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},O={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v=e=>{switch(e.kind){case"PrimaryMailbox":return m;case"ArchiveMailbox":return h;case"SharedFolders":return p;case"Group":return b;case"Calendar":return O;case"PublicFolder":return g;default:throw new Error("Unregistered search scope")}},I=e=>v(e).getKey(e),j=e=>v(e).getSearchScopeList(),y=e=>v(e).getSearchScopeType(e)},1941:function(e,t,n){"use strict";var r=n(2493),a=n(6),i=n(2245),o=n(1753);var c=n(1854),s=n(1862),u=n(1786),l=n(1798),d=n(1857),f=n(702);n.d(t,"b",(function(){return h}));let m=null;function h(){return m||(m=Object.keys(c.a).reduce((e,t)=>{const n=c.a[t];return Number.isInteger(n)&&e.push(n),e},[])),m}t.a=Object(f.action)("initializeAttachmentFullViewState")((function(e,t,n,f,m,p){var b;f&&0!==f.length||(b=t.model,f=Object(l.c)(b)?function(e){return 2===Object(d.a)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(b):h());const O=Object(u.b)(t.model,!0),g=Object(u.e)(),v=Object(s.a)(t),I=Object(r.a)(g,O,t.attachmentClass,t.model,v?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,f,e.isReadOnly,n,m,p);e.strategy=I,function(e,t,n){n&&!Object(a.k)(t.model.AttachmentOriginalUrl)&&(Object(i.a)(e,2),Object(o.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1943:function(e,t,n){"use strict";var r=n(2435),a=n(2488),i=n(282);const{getDataProviderInfo:o,getDefaultDataProviderInfo:c}=Object(r.a)((function(e){switch(e){case 0:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:(e,t)=>t,supportedPermissionLevels:[2,1]});case 3:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 2:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:(e,t)=>!1});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:e=>Object(a.a)(e),supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(i.a)(e)}}));t.a=o},1953:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(282);function a(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1957:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&a(e.AttachmentId.Id)}function a(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},1959:function(e,t,n){"use strict";var r=n(36),a=n(71),i=n(2574),o=n(2975),c=n(1713),s=n(2604),u=n(2896),l=n(2118),d=n(47),f=n(2803),m=n(702),h=n(3018),p=n(2245),b=n(2493),O=n(1753),g=Object(m.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return S}));t.a=Object(m.action)("saveToCloud")((function e(t,n,r,a,i,o,c=!0){const[s,l]=I(t,n,r,a,!1,i,o,c,()=>{e(t,n,r,a,i,o,!0)});Object(u.b)(t.attachmentId,null,o,s,l)}));function v(e,t,n,r,a,i,o){const[c,s]=I(e,t,n,r,!0,i,o,!0,null);Object(u.c)(e.attachmentId,c,s,a,o)}function I(e,t,n,i,o,c,s,u,f){const m=new a.b("AttachmentSaveToCloud");h.a.run(2,e.attachmentId,s),y(e,o);return[a=>{const o=0===a.ResultCode;if(Object(d.j)("doc-authcontextStage2")&&25===a.ResultCode&&!u&&f){const u=a.ClaimsChallenge;if(u)return j(m,e.attachmentId,a.ResultCode,"ServerError",a.Exception,n,i,c),(async()=>{let n=!1;try{const e=await l.a.import();await e(u)}catch(e){n=!0}n?(r.h.info("saveToCloud remediateAuth failed"),S(e,o,o?a.Item.Location:null,s),t(o)):(r.h.info("saveToCloud retry after remediateAuth"),f())})(),!0}return S(e,o,o?a.Item.Location:null,s),t(o),j(m,e.attachmentId,a.ResultCode,"ServerError",a.Exception,n,i,c),!0},(r,a,o,s)=>{S(e,!1,null,s),t(!1),j(m,e.attachmentId,a,o,r,n,i,c)}]}function j(e,t,n,r,a,o,u,l){const d=Object(c.a)(t);e.addCustomData({entryPoint:o,result:n});const m=Object(s.a)(d);e.addCosmosOnlyData(JSON.stringify({size:d.model.Size,fileType:m})),0===n?e.end():e.endWithError(r,new Error(a)),Object(f.a)(null==u?void 0:u.Id).then(e=>{i.a.importAndExecute("SavedAttachment",{itemId:e,customProperties:{FileId:t.Id,FileType:m,Destination:"Cloud",Sender:l}})})}function y(e,t=!1){const n=t?18:1;Object(O.a)(e,2,n)}function S(e,t,n,r){if(t){Object(p.a)(e,2),Object(o.a)(e.attachmentId,n),h.a.run(3,e.attachmentId,r);const t=Object(b.b)(!1,!1,n);g(e,t)}else h.a.run(4,e.attachmentId,r);Object(O.a)(e,0,t?3:4)}},1961:function(e,t,n){"use strict";var r=n(3),a=n(2853);const i=Object(r.createStore)("fileProviderStore",Object(a.a)());t.a=i},1969:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n(3);const a=Object(r.action)("FILE_PROVIDER_ADDED",e=>({providerViewState:e})),i=Object(r.action)("FILE_PROVIDER_REMOVED",e=>({providerType:e})),o=Object(r.action)("PROVIDERS_LOADED",e=>({providers:e}))},1971:function(e,t,n){"use strict";n.d(t,"l",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"k",(function(){return b})),n.d(t,"m",(function(){return O}));var r=n(20),a=n(2368);n.d(t,"b",(function(){return a.a}));var i=n(2328);n.d(t,"i",(function(){return i.a}));n(1961);var o=n(1969);n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"o",(function(){return o.c}));var c=n(2314);n.d(t,"a",(function(){return c.b}));var s=n(2102);n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return s.b}));var u=n(2315);n.d(t,"j",(function(){return u.a}));var l=n(2136);n.d(t,"c",(function(){return l.a}));var d=n(2291);n.d(t,"f",(function(){return d.b}));var f=n(910);const m=new r.c(()=>Promise.all([n.e(0),n.e(680)]).then(n.bind(null,4090))),h=new r.b(m,e=>e.loadProviders),p=new r.b(m,e=>e.removeFileProvider),b=new r.b(m,e=>e.addFileProvider),O=new r.b(m,e=>e.removeAndAddFileProvider);Object(r.f)(f.a,m,e=>e.resetFileProviderStoreOrchestrator)},1981:function(e,t,n){"use strict";var r=n(2645),a=n(2125),i=n(327),o=n(2265),c=n(36),s=n(610);function u(e,t,n,r,u,l,d,f){const m={cvid:n,query:e,textdecorations:"1",scenario:u,entityTypes:r};return d&&(m.logicalId=d),f&&(null==e?void 0:e.length)>0&&(m.setflight=f),t?Object(i.b)(Object(s.v)(Object(a.a)("suggestions"),Object(o.a)(m)),void 0,!0,l,void 0,!1).then(e=>e).catch(e=>(c.h.warn(e),null)):Promise.resolve(null)}var l=n(2124),d=n(1934),f=n(1764),m=n(2582);function h(e,t,n,r){const a=[];if(r===n){const n={Range:{[r]:{gte:t,lte:e}}};a.push(n)}else{const i={Range:{[r]:{gte:t}}};a.push(i);const o={Range:{[n]:{lte:e}}};a.push(o)}return a}var p=n(1678),b=n(1698),O=n(1679);function g(e,t,n,r=null){const a=[];0===e.length&&0===t.length&&null!=r&&e.push(Object(p.a)(r));for(const e of t)a.push({Term:{DistinguishedFolderName:e}});for(const t of e){if(t&&Object(b.a)(t)==O.d)return[];a.push({Term:{FolderId:t}})}n&&a.push({Term:{DistinguishedFolderName:"DeletedItems"}});const i=[],o={Or:a};return i.push(o),a.length>0?i:null}function v(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.TimeZoneContext)||void 0===t?void 0:t.TimeZoneDefinition)||void 0===n?void 0:n.Id)?e.TimeZoneContext.TimeZoneDefinition.Id:"UTC"}function I(e){var t,n,r;return(null===(r=null===(n=null===(t=null==e?void 0:e.EntitySets)||void 0===t?void 0:t[0])||void 0===n?void 0:n.ResultSets)||void 0===r?void 0:r[0])?e.EntitySets[0].ResultSets[0]:null}function j(e){return e?{Id:e.Id,ChangeKey:null}:null}function y(e,t){let n=null;if(null==t?void 0:t.TimeZone){n=new Date(e).toISOString()}return n}function S(e){return(null==e?void 0:e.EmailAddress)?{Mailbox:{EmailAddress:e.EmailAddress.Address,Name:e.EmailAddress.Name,RoutingType:"SMTP"}}:null}function w(e){return e?{__typename:"FolderId",Id:e.Id}:null}function A(e){switch(e){case"DateTime":return"DateTime";case"Hybrid":return"Hybrid";case"Relevance":return"Relevance";default:return null}}function C(e){if(null===e||0===e.length)return null;const t=[];for(let n=0;n<e.length;n++)t[n]=j(e[n]);return t}function T(e){var t;return(null===(t=null==e?void 0:e.QueryId)||void 0===t?void 0:t.Id)?{Id:e.QueryId.Id}:null}var P=n(38);const E="IPM.Appointment";function k(e){var t;const n=S(e.Organizer);return{CalendarItemType:e.CalendarItemType.toString(),Categories:e.Categories,CharmId:e.Charm,DisplayTo:e.DisplayTo,End:e.End,Start:e.Start,HasAttachments:e.HasAttachments,IsAllDayEvent:e.IsAllDayEvent,IsMeeting:e.IsMeeting,IsMeetingPollEvent:e.IsMeetingPollEvent,ItemClass:e.ItemClass?e.ItemClass:E,FreeBusyType:e.LegacyFreeBusyStatus?e.LegacyFreeBusyStatus.toString():null,Location:{DisplayName:e.Location},Sensitivity:e.Sensitivity,SeriesId:e.SeriesMasterItemId?e.SeriesMasterItemId.Id:null,Subject:e.Subject,Organizer:n,UID:e.UID,ItemId:j(e.ItemId),ParentFolderId:w(e.ParentFolderId),SerializedImmutableId:e.ImmutableId,SortOrderSource:A(e.SortOrderSource),Preview:e.Preview,IsOrganizer:e.IsOrganizer&&Object(P.a)().SessionSettings.UserEmailAddress===(null===(t=null==n?void 0:n.Mailbox)||void 0===t?void 0:t.EmailAddress),IsCancelled:e.IsCancelled,ResponseType:e.MyResponseType}}function R(e,t){var n;return{__typename:"ConversationType",Categories:e.Categories,ConversationId:j(e.ConversationId),ConversationTopic:e.ConversationTopic,FlagStatus:e.FlagStatus,From:S(e.From),GlobalItemIds:C(e.GlobalItemIds),GlobalMessageCount:e.GlobalMessageCount,GlobalUnreadCount:e.GlobalUnreadCount,HasAttachments:e.HasAttachments,HasIrm:e.HasIrm,HasProcessedSharepointLink:e.HasProcessedSharepointLink,Importance:e.Importance,ItemClasses:e.ItemClasses,ItemIds:C(e.ItemIds),LastDeliveryOrRenewTime:y(null!==(n=e.LastDeliveryOrRenewTime)&&void 0!==n?n:e.LastDeliveryTime,t),LastDeliveryTime:y(e.LastDeliveryTime,t),LastModifiedTime:y(e.LastModifiedTime,t),MessageCount:e.MessageCount,ParentFolderId:w(e.ParentFolderId),Preview:e.Preview,SortOrderSource:A(e.SortOrderSource),UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,UnreadCount:e.UnreadCount}}var x=n(47),D=n(1846);function F(e,t){var n;const r=function(e){if(!e)return e;const t=e.indexOf(":");return t>0&&t<6&&t+1<e.length?e.substring(t+1).trim():e}(e.Subject),a=Object(x.j)("fwk-immutable-ids")&&e.ImmutableId?{Id:Object(D.b)(e.ImmutableId),ChangeKey:null}:e.ItemId;return{Categories:e.Categories,ConversationId:j(e.ConversationId),ConversationIndex:e.ConversationIndex,ConversationThreadId:{Id:e.ConversationThreadId,ChangeKey:null},ConversationTopic:r,DateTimeReceived:y(e.DateTimeReceived,t),DateTimeSent:e.DateTimeSent&&y(e.DateTimeSent,t),LastModifiedTime:y(e.DateTimeLastModified,t),DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:(i=e.Flag,i?{FlagStatus:i.FlagStatus,CompleteDate:i.CompleteDate,DueDate:i.DueDate,StartDate:i.StartDate}:null),From:S(e.From),HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,IconIndex:e.IconIndex,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:a,MailboxGuids:e.MailboxGuids,ParentFolderId:w(e.ParentFolderId),Preview:e.Preview,Sender:S(e.Sender),SenderSMTPAddress:e.SenderSMTPAddress,Sensitivity:e.Sensitivity,SerializedImmutableId:e.ImmutableId,SortOrderSource:A(e.SortOrderSource),Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,ExtendedProperty:[{ExtendedFieldURI:{DistinguishedPropertySetId:"Common",PropertyId:3613,PropertyType:"String"},Value:r}]};var i}function N(e,t){var n,r,a,i,o,c,s,u,l;let d,f,m,h;if((null==t?void 0:t.length)>0){let e,n,r,a,i;t.sort((e,t)=>e.Timestamp&&t.Timestamp?t.Timestamp.localeCompare(e.Timestamp):0).forEach(t=>{"Modified"!=t.Type||n?"Created"!=t.Type||e?"Shared"!=t.Type||r?"Read"!=t.Type||a?"Trending"!=t.Type||i||(i=!0):a=!0:r=!0:(e=!0,d=t.User,f=t.Timestamp):(n=!0,m=t.User,h=t.Timestamp)})}const p=null!==(i=null!==(a=null!==(r=null!==(n=e.LinkingUrl)&&void 0!==n?n:e.ServerRedirectedURL)&&void 0!==r?r:e.OriginalPath)&&void 0!==a?a:e.ClassicAttachmentVisualizationUrl)&&void 0!==i?i:"";return{ItemId:null!==(s=null!==(c=null!==(o=e.UniqueId)&&void 0!==o?o:e.Id)&&void 0!==c?c:e.DocId)&&void 0!==s?s:"",FileName:null!==(u=e.FileName)&&void 0!==u?u:e.Filename,Title:e.Title,FileExtension:e.FileExtension,LinkingUrl:p,Author:(null==d?void 0:d.DisplayName)?[d.DisplayName]:e.Author,AuthorUpn:(null==d?void 0:d.Upn)||"",Created:null!=f?f:e.Created,ModifiedBy:null!==(l=null==m?void 0:m.DisplayName)&&void 0!==l?l:e.ModifiedBy,ModifiedByUpn:(null==m?void 0:m.Upn)||"",LastModifiedTime:null!=h?h:e.LastModifiedTime}}function M(){return{SearchResults:{MoreResultsAvailable:!1,TotalResultsCount:0,SearchResultsCount:0,TDQueryId:T(null)}}}function _(e){return 0===(e?e.length:0)?null:e.map(e=>({RefinerString:e.RefinerQuery}))}function L(e){if(!e)return"MailItems";switch(e){case"CalendarItems":return"Event";case"MailConversations":return"Conversation";case"MessageItems":return"Email";case"Files":return"File";case"MailItems":default:return"Message"}}var U,B,W=n(1782),G=n(2326),V=n(2152);!function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(U||(U={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData"}(B||(B={}));var z=n(2583),q=n(1892),H=n(1836);n.d(t,"J",(function(){return r.a})),n.d(t,"K",(function(){return u})),n.d(t,"g",(function(){return l.a})),n.d(t,"r",(function(){return d.a})),n.d(t,"y",(function(){return d.b})),n.d(t,"D",(function(){return f.e})),n.d(t,"E",(function(){return f.g})),n.d(t,"B",(function(){return f.b})),n.d(t,"C",(function(){return f.c})),n.d(t,"z",(function(){return a.a})),n.d(t,"w",(function(){return m.a})),n.d(t,"o",(function(){return h})),n.d(t,"q",(function(){return g})),n.d(t,"A",(function(){return v})),n.d(t,"x",(function(){return I})),n.d(t,"l",(function(){return k})),n.d(t,"k",(function(){return R})),n.d(t,"n",(function(){return F})),n.d(t,"m",(function(){return N})),n.d(t,"j",(function(){return T})),n.d(t,"p",(function(){return M})),n.d(t,"h",(function(){return _})),n.d(t,"i",(function(){return L})),n.d(t,"F",(function(){return W.b})),n.d(t,"e",(function(){return W.a})),n.d(t,"H",(function(){return W.d})),n.d(t,"I",(function(){return W.e})),n.d(t,"G",(function(){return W.c})),n.d(t,"s",(function(){return G.a})),n.d(t,"u",(function(){return V.b})),n.d(t,"t",(function(){return V.a})),n.d(t,"v",(function(){return V.c})),n.d(t,"f",(function(){return z.a})),n.d(t,"c",(function(){return q.b})),n.d(t,"b",(function(){return H.b})),n.d(t,"d",(function(){return H.c})),n.d(t,"a",(function(){return H.a}))},1985:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("START_SEARCH",(e,t,n=!1,r=[],a,i="All")=>({actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r,searchProvider:a,filter:i}))},1988:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("SEARCH_SESSION_STARTED",(e,t,n)=>({actionSource:e,shouldStartSearch:t,scenarioId:n}))},1990:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2007:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},2035:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"s",(function(){return i})),n.d(t,"q",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"n",(function(){return s})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"k",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"p",(function(){return O})),n.d(t,"m",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"o",(function(){return I})),n.d(t,"l",(function(){return j}));const r="multipart/signed",a="application/pkcs7-mime",i="application/x-pkcs7-mime",o=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",s="CLASSID",u="4",l="0800",d=57,f=78,m="IPM.Note.SMIME.MultipartSigned",h="smime-",p="image",b="OwaToSmime",O="SmimeToOwa",g="en-US",v=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],I="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",j="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},2036:function(e,t,n){"use strict";var r=n(2792),a=n(702);const i=Object(a.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=[...e.infoBarIds];const a=e.infoBarHostKey;n&&(r.b[a]||(r.b[a]={}),r.b[a][t]=n)}}));t.a=i},2048:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(6),a=n(296),i=n(52),o=n(2270),c=n(99),s=n(2),u=n(32),l=n(2050),d=n(2049);function f(e,t,n,f=!1,m=null){if(!e||!e.Id||!e.mailboxInfo)return null;const h=Object(l.b)(e.mailboxInfo),p=null==h?void 0:h.downloadUrlBase,b=Object(d.a)(e.mailboxInfo);if(m=m||Object(r.c)(t,encodeURIComponent(e.Id)),!p||f&&"Firefox"===Object(c.a)().browser){const e=o.e+m+"&X-OWA-CANARY="+Object(i.a)();return Object(u.a)(e)}let O="{0}{1}/{2}";Object(a.a)()&&(O+="&isc=1");let g=Object(r.c)(O,p,b,m);return n&&(g+="&token="+(null==h?void 0:h.downloadToken),g+="&X-OWA-CANARY="+Object(i.a)()),g+="&owa="+window.location.hostname,g+="&scriptVer="+Object(s.u)()||!1,g}},2049:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225),a=n(287);function i(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const t=e.userIdentity&&Object(a.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2050:function(e,t,n){"use strict";var r=n(287);const a={};function i(e){return a[e]}function o(e,t){const n=a[e];a[e]=Object.assign(Object.assign({},n),t)}var c=n(57),s=n(614),u=n(71),l=n(912),d=n(811),f=n(35);var m=n(36),h=n(1744),p=n(1743);const b=Object(d.b)({timeBetweenRetryInMS:()=>3e4});async function O(e){const t=async()=>{try{let t={};return Object(s.b)()?t={sourceId:Object(l.a)(null==e?void 0:e.userIdentity)}:Object(r.r)(e.userIdentity)&&(t=await async function(e){let t={};t.headers=new Headers;const n=await Object(h.a)(e);return Object(p.b)(t.headers,n),t}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(t)}catch(e){throw m.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},n=i(e.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){o(e.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:r}=b(async()=>{n++;const r=await t();m.h.info("update new token"),o(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),a=new u.c("AttachmentRefreshDownloadToken");try{await r(),a.addCustomData([n]),a.end()}catch(t){m.h.warn(`Retry to refresh token failed: ${t}`),a.addCustomData([n]),a.endWithError("ServerError",t),o(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function g(e){const t=Object(r.r)(e.userIdentity)?Object(c.h)(e.userIdentity):Object(c.g)(),n=null==t?void 0:t.ApplicationSettings;if(n){const t=n.DownloadUrlBase;o(e.userIdentity,{downloadUrlBase:t,downloadToken:n.FirstDownloadToken}),t&&function(e,t){t=t<1?1:t,Object(s.b)()&&O(e),setInterval(()=>{O(e)},6e4*t)}(e,n.DownloadTokenRefreshMinutes)}}var v=n(282);function I(e){const t=Object(r.j)(null==e?void 0:e.userIdentity),n=i(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Office365":case"Outlook":g(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(v.a)(t)}const a=i(e.userIdentity);return a||(Object(u.o)("FilesUrlDataNotFound",{accountProviderType:t}),m.h.warn("Unable to get the url data")),a}function j(e){if(!e)return null;const t=I(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return j}))},2051:function(e,t,n){"use strict";var r=n(326),a=n(1761);async function i(e,t){const n=t||Object(r.a)(),i={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},o=t=>{e(t)&&a.k.importAndExecute(i,o)};(await a.j.import())(i,o);const c=(await a.b.import())();return[n,i,o,c]}n.d(t,"a",(function(){return i}))},2067:function(e,t,n){var r=n(2074),a=36e5,i=6e4,o=2,c=/[T ]/,s=/:/,u=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,h=/^-?(\d{3})$/,p=/^-?(\d{2})-?(\d{2})$/,b=/^-?W(\d{2})$/,O=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/([Z+-].*)$/,y=/^(Z)$/,S=/^([+-])(\d{2})$/,w=/^([+-])(\d{2}):?(\d{2})$/;function A(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var C=function(e){var t,n={},r=e.split(c);s.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=j.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),T=function(e,t){var n,r=l[t],a=f[t];if(n=d.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=u.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(C.date,n),P=T.year,E=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=h.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=p.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=b.exec(e))return i=parseInt(n[1],10)-1,A(t,i);if(n=O.exec(e)){i=parseInt(n[1],10)-1;var s=parseInt(n[2],10)-1;return A(t,i,s)}return null}(T.restDateString,P);if(E){var k,R=E.getTime(),x=0;return C.time&&(x=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=v.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=I.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(C.time)),C.timezone?k=function(e){var t,n;if(t=y.exec(e))return 0;if(t=S.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=w.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(C.timezone):(k=new Date(R+x).getTimezoneOffset(),k=new Date(R+x+k*i).getTimezoneOffset()),new Date(R+x+k*i)}return new Date(e)}},2068:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1849),a=n(1803);function i(e){return Object(a.b)().scenarioStores.get(Object(r.a)(e))||Object(a.a)()}},2069:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),a=n(80);const i=Object(r.action)("GET_SUGGESTIONS",e=>Object(a.b)({name:"Search_SuggestionsE2E"},{scenarioId:e}))},2074:function(e,t){e.exports=function(e){return e instanceof Date}},2101:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2792),a=n(3);const i=Object(a.mutatorAction)("removeInfoBarMessages",(e,t,n)=>{t>=0&&e.infoBarIds.splice(t,1);const a=e.infoBarHostKey;r.b[a]&&(delete r.b[a][n],0===Object.keys(r.b[a]).length&&delete r.b[a])});function o(e,t){if(e){const n=Array.isArray(t)?t:t?[t]:e.infoBarIds?[...e.infoBarIds]:[];for(const t of n){const n=e.infoBarIds&&e.infoBarIds.indexOf(t);i(e,n,t)}}}},2102:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(1961);const a=()=>[...Object(r.a)().providers.values()],i=e=>Object(r.a)().providers.get(e)||null},2104:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1709),a=n(47);function i(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(a.j)("cmp-prague")&&(".fluid"===t||".note"===t))}function o(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(a.j)("cmp-prague")&&".note"===t)}},2118:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20);const a=new r.c(()=>n.e(1032).then(n.bind(null,4154))),i=(new r.b(a,e=>e.launchRemediateAuthDialogAndRefresh),new r.b(a,e=>e.remediateAuth))},2124:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1934);function a(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},2125:function(e,t,n){"use strict";function r(e,t){return`search/api/${2===t?"v2":"v1"}/${e}`}n.d(t,"a",(function(){return r}))},213:function(e,t,n){"use strict";var r=n(36);let a;function i(){return null==a&&(a="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),a}var o=n(113);const c=500,s=[],u=[],l=[];let d=!0;function f(e,t){Object(r.g)((e,t,n,a)=>{d&&(t==r.b.Error&&u.push({message:e,error:a}),s.push({message:e,level:t}))}),e(h),t(h),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function m(e){const t=Object(o.a)(e);return d=!1,{traces:s,errors:u,network:l,usage:t}}function h(){d&&l.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return i}))},2130:function(e,t,n){"use strict";var r=n(1774);function a(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(1953),o=n(1738);function c(){return a()}function s(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(o.a)(e)}(e))}(e)?a():[]).map(i.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}))},2136:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},2142:function(e,t,n){"use strict";n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"g",(function(){return p})),n.d(t,"j",(function(){return b})),n.d(t,"l",(function(){return O}));var r=n(20),a=n(2283);n.d(t,"n",(function(){return a.a}));var i=n(2269);n.d(t,"a",(function(){return i.a}));var o=n(2007);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(2284);n.d(t,"b",(function(){return c.a}));const s=new r.c(()=>Promise.all([n.e(0),n.e(24),n.e(96),n.e(608)]).then(n.bind(null,3852))),u=new r.b(s,e=>e.getSharingInformation),l=new r.b(s,e=>e.getSharingIssuesForSharingData),d=new r.b(s,e=>e.getInfoBarCreator),f=new r.b(s,e=>e.hasLargeDLRecipient),m=new r.b(s,e=>e.hasRecipientExpansionFailure),h=new r.b(s,e=>e.getGroupsAndSmallDLs),p=new r.b(s,e=>e.getInvididualRecipients),b=new r.b(s,e=>e.hasGetRecipientPermissionFailed),O=new r.b(s,e=>e.logSharingTipChangesForLinkRemoval)},2144:function(e,t,n){"use strict";var r=n(20);const a=[0,1];var i=n(2518),o=n(2500),c=n(6),s=n(282),u=n(1804);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(o.a),messageParts:[Object(c.b)(o.a),d()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(i.b),messageParts:[Object(c.b)(i.b),d()],color:u.a.Red};default:return Object(s.a)(e)}}function d(){return{text:Object(c.b)(i.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2130),m=n(1953),h=n(47),p=n(1774);function b(){const e=Object(p.a)();if(Object(h.j)("fwk-devTools")){if(Object(h.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(h.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){const e=b();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return v})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return m.a})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return b}));const g=new r.c(()=>n.e(1929).then(n.bind(null,19270))),v=new r.b(g,e=>e.getAccessIssuesForAttachments)},2150:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("RESET_SEARCH_STORE",e=>({scenarioId:e}))},2152:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));const r=[{resultRowOffset:0,resultRowCount:25,pageNumber:0},{resultRowOffset:25,resultRowCount:50,pageNumber:1},{resultRowOffset:75,resultRowCount:75,pageNumber:2},{resultRowOffset:150,resultRowCount:100,pageNumber:3},{resultRowOffset:250,resultRowCount:200,pageNumber:4},{resultRowOffset:450,resultRowCount:200,pageNumber:5},{resultRowOffset:650,resultRowCount:200,pageNumber:6},{resultRowOffset:850,resultRowCount:200,pageNumber:7}];let a=function(e,t={pageContexts:r}){if(e<0||e>=t.pageContexts.length)throw new Error("The pageNumber for execute search is invalid:"+e);return t.pageContexts[e]},i=function(e,t,n,i={pageContexts:r}){const o=e.pageNumber+1,c="PrimaryMailbox"===n?2:4;return t.MoreResultsAvailable&&o<c?a(o,i):null};const o=e=>{switch(e){case 74:return r[2];case 149:return r[3];case 249:return r[4];case 449:return r[5];case 649:return r[6];case 849:return r[7];default:return null}}},2171:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(71),a=n(2279),i=n(326),o=n(283),c=n(1990),s=n(2268),u=n(47),l=n(36),d=n(2118),f=n(1740);let m=!1;async function h(e,t,n,h,b,O=!1){let g;try{g=await Object(a.d)(e,!1,n)}catch(e){}if(Object(u.j)("doc-authContext")&&0===e&&(b?b["x-ms-cc"]="t":b={"x-ms-cc":"t"}),Object(u.j)("doc-odcconvergence")&&1===e)if(m)t=p(t);else{const e="Migration=EnableRedirect";b?b.prefer?b.prefer+=", "+e:b.prefer=e:b={prefer:e}}if(g&&g.split(a.a)[1])return Object(r.o)("fetchServiceViaDataProvider",[e]),l.h.info("fetchServiceViaDataProvider"),async function e(t,n,c,s,l,f,h){const b=l.datapointNamePrefix+"DataProvider",O=new r.b(b);O.addCustomData({dataProviderType:t});let g={Authorization:s,"Content-Type":"application/json",Accept:"application/json"};if(h){Object.keys(h).forEach(e=>{g[e]=h[e]})}if(0===t||1===t){const e=Object(i.a)();g["X-TransactionId"]=e,O.addCustomData({TransactionId:e}),0===t&&(g.SPResponseGuid=e)}const v=await fetch(n,{method:l.method,mode:l.mode,headers:g,body:l.body,redirect:"manual"});if(Object(o.a)(v.status)){O.end();const e=await v.json();return JSON.stringify(e)}{const r=new Error(`${b} : Response status = ${v.status}, body = ${v.body}`);O.endWithError("ServerError",r);let i={datapointName:b,responseStatus:v.status,responseBody:v.body,headers:v.headers,claims:null};if(Object(u.j)("doc-odcconvergence")&&1===t&&"opaqueredirect"===v.type){m=!0;const r=p(n);return e(t,r,r,s,l,!0,h)}if(Object(u.j)("doc-authContext")&&0===t&&!f){const r=v.headers.get("www-authenticate");if(r){let o;try{const e=await d.a.import();o=await e(r)}catch(e){throw JSON.stringify(i)}try{s=await Object(a.d)(t,!0,c,o)}catch(e){}return e(t,n,c,s,l,!0,h)}}throw JSON.stringify(i)}}(e,t,n,g,h,O,b);if(Object(r.o)("fetchServiceFailedToGetToken",[e]),0===e)return Object(r.o)("fetchServiceViaOWAServer"),l.h.info("fetchServiceViaOWAServer"),async function(e,t,n,a){const i=n.datapointNamePrefix+"OWA",u=new r.b(i),l=Object(c.a)({ProviderType:e,Url:t,Method:n.method,Body:n.body?n.body:JSON.stringify({}),Headers:JSON.stringify(a),IsJsonPost:n.method===f.i}),d=await Object(s.a)(l);if(Object(o.a)(d.Status))return u.end(),d.Body;const m=new Error(`${i} : Response status = ${d.Status}, ServerTraceLog = ${d.ServerTraceLog}`);u.endWithError("ServerError",m);const h={datapointName:i,responseStatus:d.Status,responseServerTraceLog:d.ServerTraceLog};throw JSON.stringify(h)}(e,t,h,b);throw new Error("Fetch service has failed to retrieve client token.")}function p(e){if(e&&e.startsWith(f.e)){let{pathname:t,search:n}=new URL(e);if(1===t.indexOf(f.d))return t=t.substring(f.d.length+1),`${f.a}/${f.f}${t}${n}`;if(t.startsWith(`/${f.g}`))return`${f.a}/_api${t}${n}`}return e}},2179:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("CLEAR_SEARCH_BOX",e=>({scenarioId:e}))},2180:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("END_SEARCH_SESSION",(e,t)=>({scenarioId:e,actionSource:t}))},2181:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2182:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2183:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2184:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2185:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",(e,t,n)=>({suggestionPillId:e,scenarioId:t,actionSource:n}))},2186:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",(e,t)=>({isSuggestionsDropdownVisible:e,scenarioId:t}))},2187:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("setShowSearchBoxInCompactMode",(function(e,t){return{scenarioId:e,showSearchBoxInCompactMode:t}}))},2188:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",(e,t)=>({isComplete:e,scenarioId:t}))},2189:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_DISMISS_GHOST_TEXT_VIA_KEYBOARD",e=>({scenarioId:e}))},2190:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.d}},2199:function(e,t,n){"use strict";const r="https://www.googleapis.com/drive/v3/files";var a=n(2279);async function i(e,t,n={forceTokenRefresh:!1,requestInit:{}}){const r=n.forceTokenRefresh,i=n.requestInit||{},o=await Object(a.d)(t,r,e);return i.headers||(i.headers=new Headers),i.headers.set("Authorization",o),await fetch(e,i)}async function o(e,t=!1){const n=`${r}?${e}`,a=await i(n,5,{forceTokenRefresh:t});if(a.ok){const e=await a.text();return{errorResponse:null,result:JSON.parse(e)}}return{errorResponse:a,result:null}}async function c(e){const t=`${r}/${e}?fields=id,mimeType,name,size,modifiedTime,createdTime,thumbnailLink,webViewLink,webContentLink,fileExtension`,n=await i(t,5);if(n.ok){const e=await n.text();return{errorResponse:null,result:JSON.parse(e)}}return{errorResponse:n,result:null}}var s=n(282),u=n(1787),l=n(290);const d=Object.freeze({name:"name",size:"size",lastModifiedBy:"lastModifiedBy",lastModifiedDateTime:"lastModifiedDateTime",file:"file",folder:"folder",id:"id",webDavUrl:"webDavUrl",package:"package",shared:"shared"});function f(){return Object.keys(d).map(e=>d[e]).join(",")}const m="root";function h(e){switch(e){case 1:return u.c;case 0:return u.d;default:return Object(s.a)(e)}}function p(e){return`${h(e)}/drive`}function b(e){return`${h(e)}/shares`}function O(e){return`${p(e)}/items`}var g;async function v(e,t,n,r,a,i=g.None,o){a=a||m;let c=`expand=thumbnails(select=medium)&orderby=${function(e,t,n){switch(e){case 0:case 1:return`folder,${t} ${n}`;default:return Object(s.a)(e)}}(t,function(e){switch(e){case 0:return d.name;case 1:return d.size;default:return d.lastModifiedDateTime}}(n),function(e){switch(e){case 0:return"asc";case 1:return"desc";default:return Object(s.a)(e)}}(r))}`;0===t&&(c=`${c}&select=${f()}`),i!==g.None&&(c=`${c}&filter=${function(e){switch(e){case g.None:return"";case g.Folder:return`(${d.folder} ne null)`;default:return Object(s.a)(e)}}(i)}`),o&&(c=`${c}&$top=${o.maxEntries}`,o.skipToken&&(c=`${c}&$skiptoken=${o.skipToken}`));const h=`${e}/${O(t)}/${a}/children?${c}`,p=await Object(u.i)(t,encodeURI(h),h,{method:u.b,mode:u.a,datapointNamePrefix:"getOneDriveItems"},{Prefer:"HonorNonIndexedQueriesWarningMayFailRandomly"}),b=JSON.parse(p),v=b["@odata.nextLink"]?function(e){const t=Object(l.parse)(e,!0);return t.query?t.query.$skiptoken:null}(decodeURI(b["@odata.nextLink"])):null;return{errorResponse:null,result:{items:b.value,skipToken:v}}}async function I(e,t,n,r){r=r||m;const a=`expand=thumbnails(select=medium)&select=${f()}`,i=`${t}/${O(e)}/${r}/children?${a}`,o={name:n,folder:{}},c=new Headers;c.append("Content-Type","application/json"),c.append("Accept","application/json");try{const t=await Object(u.i)(e,encodeURI(i),i,{method:u.g,mode:u.a,body:JSON.stringify(o),datapointNamePrefix:"createNewFolder"},null);return{errorResponse:null,result:JSON.parse(t)}}catch(e){return{errorResponse:e,result:null}}}!function(e){e[e.None=0]="None",e[e.Folder=1]="Folder"}(g||(g={}));var j=n(2917),y=n(2171),S=n(283);const w=Object.freeze({folderInfo:{type:0,identifier:m},sliceSize:10485760,conflictBehavior:"rename",onProgress:()=>{}});function A(e,t,n){let r=()=>Promise.resolve({errorResponse:null,result:null});return{uploadPromise:(async()=>{!function(e){Object.keys(w).forEach(t=>{e[t]=e[t]||w[t]})}(n);const{fileToUpload:{fileName:a,fileBlob:i},folderInfo:{type:o,identifier:c},conflictBehavior:l,sliceSize:d,onProgress:f}=n;let m;switch(o){case 0:m=`${t}/${O(e)}/${c}:/${encodeURI(a)}:/createUploadSession`;break;case 1:m=`${t}/${p(e)}/${c}:/${encodeURI(a)}:/createUploadSession`;break;default:Object(s.a)(o)}const h={item:{"@name.conflictBehavior":l}},b=await Object(y.a)(e,m,m,{method:u.g,mode:u.a,body:JSON.stringify(h),datapointNamePrefix:"createUploadSession"},null),{uploadPromise:g,cancel:v}=function(e,t,n,r){const{uploadUrl:a}=e,i=t.size;let o=null,c=null;const u=function(e,t,n,r,a,i){return async(o,c)=>{const s=function(e,t,n){const{rangeStart:r,rangeEnd:a}=C(e,t,n);return new Headers({"Content-Range":`bytes ${r}-${a}/${n}`,Accept:"application/json"})}(c,t,n),u=(e=>{const{rangeStart:a}=C(e,t,n);return e=>{const{loaded:t}=e;r({loaded:a+t,total:n})}})(c),l=await function(e,t,n={method:"POST"}){return new Promise(async(r,a)=>{const{method:i,body:o,headers:c}=n,s=new XMLHttpRequest;s.onreadystatechange=function(){4===s.readyState&&r({status:s.status,text:()=>Promise.resolve(s.responseText)})},s.ontimeout=()=>{a(new Error("Request timed out"))},s.onerror=()=>{a(new Error("Request failed"))},s.onabort=()=>{a(new Error("Request aborted"))},t&&(s.upload.onprogress=t),s.open(i,e,!0),new Headers(c).forEach((e,t)=>{s.setRequestHeader(t,e)}),o?s.send(o instanceof ReadableStream?(await o.getReader().read()).value:o):s.send()})}(e,u,{method:"PUT",body:o,headers:s});if(201===l.status||200===l.status){const e=await l.text(),t=JSON.parse(e);a(t)}if(!Object(S.a)(l.status))throw i(l),new Error("Unable to upload file")}}(a,n,i,r,e=>{o=e},e=>{c=e}),{onCompletePromise:l,cancel:d}=Object(j.a)(t,u,{sliceSize:n,numberOfSlicesToParallelize:1}),f=(async()=>{let e=null;try{e=await l}catch(e){return{errorResponse:c,result:null}}switch(e){case 0:return o?{errorResponse:null,result:o}:{errorResponse:c,result:null};case 1:throw new Error("Upload was cancelled");default:return Object(s.a)(e)}})();return{uploadPromise:f,cancel:async()=>{d();try{await f}finally{return async function(e){const t=await fetch(e,{method:"DELETE"});return Object(S.a)(t.status)?{errorResponse:null,result:null}:{errorResponse:t,result:null}}(a)}}}}(JSON.parse(b),i,d,f);return r=v,g})(),cancel:()=>r()}}function C(e,t,n){const r=e*t;return{rangeStart:r,rangeEnd:Math.min(r+t,n)-1}}const T="https://api.dropboxapi.com/2/files";function P(e,t){switch(e){case 0:return t;case 1:return null;default:Object(s.a)(e)}return null}var E=n(7);async function k(e,t,n=!1){let r,a;switch(t){case 1:r=`https://api.onedrive.com/${u.e}/drive/recent?top=50`;break;case 0:r=e+`/_api/${u.e}/drive/recent?top=50`;break;default:throw Error("OneDriveMRUItems only supports OneDrive providers!")}try{const e=await Object(u.i)(t,r,r,{method:u.b,mode:u.a,datapointNamePrefix:"getOneDriveMRUItems"},null,n);a=JSON.parse(e),a&&(a.value=a.value.sort((e,t)=>{var n,r,a,i;return Object(E.w)(Object(E.qc)(null===(r=null===(n=t.remoteItem)||void 0===n?void 0:n.fileSystemInfo)||void 0===r?void 0:r.lastAccessedDateTime),Object(E.qc)(null===(i=null===(a=e.remoteItem)||void 0===a?void 0:a.fileSystemInfo)||void 0===i?void 0:i.lastAccessedDateTime))}))}catch(e){}return a?{errorResponse:null,result:a}:{errorResponse:null,result:null}}function R(e){return"file"===e[".tag"]}function x(e){return"folder"===e[".tag"]}function D(e){return"deleted"===e[".tag"]}function F(e){return"folder"===e.type}async function N(e){e.path=e.path||"";const t=`${T}/list_folder`,n={method:"POST",headers:new Headers({"Content-Type":"application/json",Accept:"application/json"}),body:JSON.stringify(e)},r=await i(t,2,{requestInit:n});if(r.ok){const e=await r.text();return{errorResponse:null,result:JSON.parse(e).entries}}return{errorResponse:r,result:null}}const M="https://api.box.com/2.0",_=2e3;async function L(e,t=_){const n=`${M}/folders/${e=e||"0"}/items?fields=id,size,name,type,path_collection,modified_at,modified_by&limit=${t}&offset=0`,r=await i(n,3);if(r.ok){const e=await r.text();return{errorResponse:null,result:JSON.parse(e).entries}}return{errorResponse:r,result:null}}var U=n(970),B=n(973),W=n(611),G=n(1678),V=n(1796),z=n(707),q=n(261),H=n(36);function $(e,t){const n=function(e,t){return Object(B.a)({ParentFolderIds:[Object(W.a)({Id:e})],ItemShape:Object(z.a)({BaseShape:"IdOnly"}),ShapeName:"MailListItem",Traversal:"Shallow",Paging:t,FocusedViewFilter:-1,ViewFilter:"All",SortOrder:null})}(e,t);return Object(U.a)({Header:Object(q.b)(),Body:n})}async function J(e,t){const n=Object(V.a)({BasePoint:"Beginning",Offset:t,MaxEntriesReturned:100});e=e||Object(G.a)("inbox");const r=(await $(e,n)).Body.ResponseMessages.Items[0];if(r&&"Success"===r.ResponseClass&&r.RootFolder.Items)return{errorResponse:null,result:r.RootFolder.Items};return H.h.warn(`Find Item Response of get mail messages failed with ${r}`),{errorResponse:{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null},result:null}}n.d(t,"k",(function(){return o})),n.d(t,"j",(function(){return c})),n.d(t,"m",(function(){return v})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return I})),n.d(t,"u",(function(){return A})),n.d(t,"h",(function(){return p})),n.d(t,"p",(function(){return b})),n.d(t,"d",(function(){return"https://api.onedrive.com"})),n.d(t,"b",(function(){return"https://api.dropboxapi.com/2/sharing"})),n.d(t,"c",(function(){return r})),n.d(t,"o",(function(){return P})),n.d(t,"n",(function(){return k})),n.d(t,"s",(function(){return R})),n.d(t,"t",(function(){return x})),n.d(t,"r",(function(){return D})),n.d(t,"i",(function(){return N})),n.d(t,"q",(function(){return F})),n.d(t,"g",(function(){return L})),n.d(t,"a",(function(){return M})),n.d(t,"l",(function(){return J}))},2209:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),a=n(80);const i=Object(r.action)("onSearchScopeButtonClicked",(e,t)=>Object(a.b)({name:"Search_ScopeButtonClicked",customData:{isFolderScopeVisible:e,searchScenarioType:t}},{isScopeVisible:e,searchScenarioType:t}))},2210:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("onSearchScopeOptionSelected",(e,t)=>({selectedSearchScope:e,searchScenarioType:t}))},2213:function(e){e.exports=JSON.parse('{"b":"Haa","d":"Iaa","c":"Jaa","a":"Kaa"}')},2234:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},2238:function(e,t,n){"use strict";var r=n(282),a=n(2614),i=n(52),o=n(2712);function c(e,t,n,i,c=!0){var s;const{Name:u,OriginalPermissionType:l,PermissionType:d}=t,f=Object(o.a)(t),m="GroupMailbox"===(null===(s=null==e?void 0:e.mailboxInfo)||void 0===s?void 0:s.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return a.b(e,f,n,i,d,l,c,u,m);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:a.b(e,f,1,i,d,l,c,u,m);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function s(e,t,n=!1,r=!0){return a.a(e,t,n,r)}function u(e,t,n,r,o=!1){const u=n?c(e,t,1,r,!1):s(e,1,o,!1);if(n)return{url:u,init:{credentials:"include",headers:new Headers}};{const t=a.c(e.mailboxInfo),n=new Headers;return n.set("X-Token",t),n.set("X-OWA-CANARY",Object(i.a)()),{url:u,init:{headers:n}}}}function l(e,t,n,r,a,i=!1){return r?c(e,t,n,a):s(e,n,i)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u}))},2245:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},225:function(e,t,n){"use strict";var r=n(38),a=n(378),i=n(47),o=n(36);function c(){const e=Object(r.a)();if(!e||!e.SessionSettings)return o.d("SessionSettings not available"),"no-mailbox-id";let t=e.SessionSettings.UserEmailAddress;return Object(i.j)("doc-attachment-usePrimarySmtpAddressForMailboxId")?t:(e.SessionSettings.IsShadowMailbox?t=e.SessionSettings.LogonEmailAddress:Object(a.c)(e.HexCID,e.SessionSettings.UserEmailAddress)&&(t=Object(a.b)(e.HexCID,e.SessionSettings.NotManagedEmailAddresses,e.SessionSettings.UserProxyAddresses)),t)}var s=n(519),u=n(435);function l(e){const t=Object(u.a)().userMailboxInfoMap;t&&t.delete(e)}function d(e,t){return e===t||null!=e&&null!=t&&e.Id===t.Id}var f=n(308);n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s.a})),n.d(t,"g",(function(){return s.b})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return f.a}))},2254:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(282),a=n(2435),i=n(296);const{getDataProviderInfo:o,getDefaultDataProviderInfo:c}=Object(a.a)((function(e){switch(e){case 0:return function(){const e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object.assign(Object.assign({},e),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0})}();case 1:return function(){const e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object.assign(Object.assign({},e),{supportConvertCloudyToClassic:Object(i.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(r.a)(e)}}));t.a=o},2255:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1784),a=n(1777);function i(e,t,n,i,o=a.a.Unknown,c=!1,s=null){const u=Object(r.d)(e,t,i,c,o,s),l=u.strategy;return Object.assign(Object.assign({},u),{attachmentType:0,strategy:Object.assign(Object.assign({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},2256:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2257:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},226:function(e,t,n){"use strict";function r(e){var t,n;if((null==e?void 0:e.length)>0){const r=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(n=e[1])||void 0===n?void 0:n.length)>0?r:void 0}}const a="bearer",i="msauth1.0",o=3600,c=86400,s=6e4,u=1e3;function l(e){if(e){const t=e.split(" ");return r(t)==a?t[1]:e}}function d(e,t){if(e){const n=r(e.split(" "));if(n){if(t){return(1e3*t-Date.now()-s)/u}return n==i?c:o}}}function f(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}))},2264:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];const n=[];if(0===t){const t=e;t.CanShareInternally&&(n.push(2),n.push(1)),t.CanCreateOrganizationEditLink&&n.push(6),t.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function a(e,t,n){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return n?t?2:1:0;default:return 0}}var i=n(2933),o=n(6);const c="OneDrivePro";var s=n(282),u=n(38);function l(e,t){switch(e){case 3:return Object(o.b)(i.b);case 4:return Object(o.b)(i.a);case 6:return Object(o.b)(i.d);case 5:return Object(o.b)(i.e);case 1:return t===c?Object(o.b)(i.g):Object(o.b)(i.b);case 2:return t===c?Object(o.b)(i.f):Object(o.b)(i.a);case 0:return Object(o.b)(i.c);default:return Object(s.a)(e)}}function d(e,t){return 0===t?function(e){var t;const n=null===(t=Object(u.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(o.b)(i.i);case 4:return Object(o.b)(i.h);case 6:return Object(o.c)(Object(o.b)(i.j),n);case 5:return Object(o.c)(Object(o.b)(i.k),n);case 1:return Object(o.b)(i.g);case 2:return Object(o.b)(i.f);case 0:return Object(o.b)(i.c);default:return Object(s.a)(e)}}(e):l(e,null)}function f(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f}))},2265:function(e,t,n){"use strict";var r=n(132);var a=n(47),i=n(5);n.d(t,"a",(function(){return c}));const o="searchtesthook";function c(e={}){const t=function(e,...t){const n={};for(const r of t)for(const t of Object.keys(r))e.includes(t)&&n.hasOwnProperty(t)?n[t]=n[t]+","+r[t]:n[t]=r[t];return n}(["setflight"],e,function(){let e={};const t=Object(i.c)(o),n=decodeURIComponent(t||"").trim();if(Object(a.j)("sea-debugHook")&&n.length>0){e=n.split("&").reduce((e,t)=>{const[n,r]=t.split("=");return e[n]=r,e},{})}return e}(),Object(r.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(t).filter(e=>null!==t[e]).reduce((e,n)=>Object.assign(Object.assign({},e),{[n]:t[n]}),{})}},2268:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),a=n(1990);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},2269:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},227:function(e,t,n){"use strict";t.decode=t.parse=n(380),t.encode=t.stringify=n(381)},2270:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return l}));const r="/owa/",a="service.svc/s/GetFileAttachment?id={0}",i="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",o="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",s="service.svc/s/GetAttachmentThumbnail?id={0}",u="pdfprint.aspx?id={0}",l="pdfprint.aspx?id={0}&location={1}"},2271:function(e,t,n){"use strict";var r=n(282),a=n(6),i=n(52),o=n(2270);const c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var s=n(2048),u=n(32);function l(e,t,n,l,d=0,f=0,m=!0,h=null,p=null){let b;switch(n){case 0:b=o.f;break;case 3:b=o.h;break;case 1:if(!function(e){if(!e)return!1;let t=null;const n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&c.indexOf(t.toLowerCase())>=0}(h))return null;b=o.g;break;default:Object(r.a)(n)}let O=l?f:d;!O&&d&&(O=d);let g=Object(a.c)("{0}&permissionLevel={1}",Object(a.c)(b,encodeURIComponent(e.Id),encodeURIComponent(t)),O);const v=Object(s.a)(e,b,!0,3===n,g);if(v)return v;let I=Object(a.c)("{0}{1}{2}",o.e,p,g);if(m){I=`${I}&X-OWA-CANARY=${Object(i.a)()}`}return Object(u.a)(I)}function d(e,t,n=!1,i=!0){let c;switch(t){case 0:c=o.a;break;case 1:c=o.b;break;case 2:c=o.d;break;case 3:c=o.c;break;default:return Object(r.a)(t)}if(!Object(a.k)(c)){const r=Object(s.a)(e,c,i,3===t);return Object(a.c)("{0}{1}{2}",r,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}))},2279:function(e,t,n){"use strict";var r=n(2772),a=n.n(r),i=n(6),o=n(296),c=n(404),s=n(35);function u(e){return Object.assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}async function l(e,t,n,r){const a=u({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1,ClaimsChallenge:r?atob(r):null});let i;i=n?"getAccessTokenForDataProvider_"+n:"getAccessTokenForDataProvider";let o=new Headers;o.append("X-OWA-ActionName",i);const c={headers:o,datapoint:{customData:{actionSource:n},headersCustomData:e=>({tokenResultDetails:e.get("x-tokenresult")}),jsonCustomData:e=>({tokenStatus:e.TokenResultCode.toString()})},returnFullResponseOnSuccess:!0},l=await function(e,t){return void 0===e||e.__type||(e=u(e)),Object(s.a)("GetAccessTokenforDataProvider",e,t)}(a,c);return{token:await l.json(),response:l}}const d="onedrive_implicit.access",f="Bearer ";var m=n(47),h=n(71);const p=(e,t,n)=>Object.assign({resultCode:t,isAdalException:n,_typeSpec:"TokenRetrievalError"},e),b=e=>"TokenRetrievalError"===e._typeSpec;let O=[];const g={},v=1,I=30,j="",y="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function S(e){g[e]=null}async function w(e,t,n,r){const a=await l(e,t,n,r);return function(e,t,n){O=O.filter(e=>e!==t);const r=n.token;if(0!==r.TokenResultCode||!r.AccessToken||""===r.AccessToken){const t=`Access token request failed for token key ${e} with response code ${r.TokenResultCode}`,a=n.response.headers.get("x-tokenresult"),i=null!=a&&a.indexOf(y)>0;throw p(new Error(t),r.TokenResultCode,i)}{const n=g[e]||{};n[t]=r,g[e]=n}}(e,t,a),a.token}async function A(e,t,n,r){let a=j;if(0===e&&n){const e=new URL(n);a=Object(i.c)("{0}//{1}/",e.protocol,e.hostname)}return Object(m.j)("doc-attachment-testAuthFallback")?"":T(e,a,t,null,r)}async function C(e,t,n){return T(0,e,t,n)}async function T(e,t,n,r,o){if(0===e&&!Object(i.k)(t)){const e=await Object(c.getAccessTokenforResource)(t);if(e)return e;Object(h.o)("getFileProviderAccessTokenForResource_emptyTokenFrom_getAccessTokenforResource")}if(!n&&function(e,t){const n=g[e];if(!n)return!1;const r=n[t];if(!r||!r.AccessTokenExpiry)return!1;const i=new Date(r.AccessTokenExpiry),o=a()(new Date(Date.now()),v);return null!=i&&o<i}(e,t)){const n=g[e][t];return a()(new Date(Date.now()),I)>new Date(n.AccessTokenExpiry)&&-1===O.indexOf(t)&&(O.push(t),w(e,t,r)),n.AccessToken}return(await w(e,t,r,o)).AccessToken}async function P(e,t,n,r){let a;return a=Object(o.a)()&&1===e?await Object(c.getDelegationTokenForOwa)(d):await A(e,t,n,r),f+a}n.d(t,"d",(function(){return P})),n.d(t,"c",(function(){return A})),n.d(t,"e",(function(){return C})),n.d(t,"b",(function(){return S})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return f}))},2283:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},2284:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2291:function(e,t,n){"use strict";var r=n(35);function a(e){return Object.assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function i(e){const t=a({ProviderType:e});return void 0===(n=t)||n.__type||(n=a(n)),Object(r.a)("GetNewAttachmentDataProviderCreationInfo",n,i);var n,i}function o(e){return Object.assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function c(e){const t=o({ProviderType:e});return void 0===(n=t)||n.__type||(n=o(n)),Object(r.a)("GetAttachmentDataProviderCreator",n,a);var n,a}var s=n(2834),u=n(2715);n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v}));const l="code",d=3e3,f=3;function m(e){return{state:e}}function h(e){return e.state}function p(e){return e.code}function b(e,t,n,r,a){const o={providerType:e,getAuthUrlInfo:null,getCSRFToken:h,getOAuthCode:p};return async function e(t,n,r,a,o,u,l){try{let e;if(7===t||9===t||8===t){const n=await c(t);e=n.AttachmentDataProviderCreator.ProviderAppKey,r=n.AttachmentDataProviderCreator.AuthorizationUri}else{e=(await i(t)).ProviderAppKey}n.getAuthUrlInfo=Object(s.d)(t,r,a,e,o,u)}catch(i){l>0&&setTimeout(()=>e(t,n,r,a,o,u,--l),d)}}(e,o,t,n,r,a,f),o}let O=null;function g(){if(!O){if(O={},Object(u.a)(3)&&(O[3]=b(3,"https://app.box.com/api/oauth2/authorize",Object(s.c)(3),l,m)),Object(u.a)(2)&&(O[2]=b(2,"https://www.dropbox.com/oauth2/authorize",Object(s.b)(2),l,m)),Object(u.a)(5)){const e=b(5,"https://accounts.google.com/o/oauth2/auth",`${s.a}/ADPRedirect.aspx`,l,e=>{const t={state:e,provider:5..toString(),url:Object(s.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});e.getCSRFToken=e=>{return JSON.parse(e.state).state},O[5]=e}Object(u.a)(1)&&(O[1]=b(1,"https://login.live.com/oauth20_authorize.srf",Object(s.c)(1),l,e=>({state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}))),Object(u.a)(7)&&(O[7]=b(7,"",Object(s.c)(7),l,m)),Object(u.a)(8)&&(O[8]=b(8,"",Object(s.c)(8),l,m)),Object(u.a)(9)&&(O[9]=b(9,"",Object(s.c)(9),l,m))}return O}function v(e){const t=g();return e in t?t[e]:null}},2314:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));const a=Object.freeze([1,3,2,6,5,7,8,9]),i=Object.freeze([...a,0,4,10])},2315:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1961);function a(){return Object(r.a)().loadState}},2316:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(16),a=n(3);const i={sharingLinks:new r.ObservableMap({}),linksIdContainerMap:new r.ObservableMap({})},o=Object(a.createStore)("sharingLinkStore",i);t.a=o},2322:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="IPM.Note.SMIME"},2326:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7);function a(){return Object(r.qc)().toString()}},2328:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2874),a=n(2795),i=n(2852),o=n(6),c=n(282);function s(e,t=!1){if(t)return"";switch(e){case 0:return Object(o.b)(i.b);case 1:return Object(o.b)(i.a);case 2:case 9:return Object(o.b)(r.b);case 3:case 7:return Object(o.b)(r.a);case 5:return Object(o.b)(r.e);case 6:return Object(o.b)(r.d);case 4:return Object(o.b)(r.f);case 10:return Object(o.b)(a.b);case 8:return Object(o.b)(r.c);default:return Object(c.a)(e)}}},2329:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(35);function a(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},2338:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(20);const a=new r.c(()=>n.e(1160).then(n.bind(null,3350))),i=new r.b(a,e=>e.extractFileUrlFromOfficeSharePointLink),o=new r.b(a,e=>e.isLinkPrefixedWithBaseUrl),c=new r.b(a,e=>e.isSharePointLink),s=new r.b(a,e=>e.isSharePointServiceGeneratedLink),u=new r.b(a,e=>e.isOfficeSharePointLink),l=new r.b(a,e=>e.getParsedQueryStringFromUrl)},2339:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},2349:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2355:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(1709);const a=[".txt",".xml",".log"];function i(e){return o(Object(r.a)(e))}function o(e){return!!e&&a.indexOf(e.toLowerCase())>=0}},2368:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},2369:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.linkIds=0]="linkIds",e[e.quotedBodyLinkIds=1]="quotedBodyLinkIds"}(r||(r={}))},2409:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function a(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},2410:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2338),a=n(703),i=n(227);async function o(e){return function(e){if(!Object(a.a)(null==e?void 0:e.nav)){const t={nav:e.nav};return Object(i.stringify)(t)}return null}((await r.b.import())(e))}},2413:function(e,t,n){"use strict";var r=n(47),a=n(6),i=n(2945),o=n(3020),c=n(1943),s=n(2998),u=n(2533),l=n(2426),d=n(2916),f=n(1862),m=n(2802),h=n(1786),p=n(36),b=n(702),O=n(1824);var g=n(1857),v=n(1738);t.a=Object(b.action)("addAndInitializeAttachments")((function(e,t,n=!1,I=!1){const j=Object(O.a)();n||(e=e.filter(e=>!j.attachments.has(e.attachment.AttachmentId.Id))),e.map(e=>{const{attachmentId:n,attachment:j,permissionInfo:y,modelInitializationValues:S}=e,w=function(e,t){const n={id:e,type:Object(g.a)(t),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:t};if(1===n.type&&Object(v.a)(t)){return Object.assign(Object.assign({},n),{type:1,openUrl:null,originalUrl:null,isFolder:t.AttachmentIsFolder,requiresFetchingSharingInformation:!1})}return n}(n,j);return I||function(e,t,n){const g=Object(f.a)(e),v=Object(h.b)(e.model,!0),I=Object(o.a)(v,e.model);e.attachmentClass=I,e.info=Object(i.a)(v,I,e.model,g,g?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(l.a)(e.id,e.model,!0,!0)),g&&(e.openUrl=Object(d.a)(e.model)),(g&&Object(r.j)("doc-unwrap-safelinks")?Object(u.a)(e.model):Promise.resolve(void 0)).then(t=>{if(t&&(e.originalUrl=t),g&&!n){const t=e.model,n=Object(c.a)(t.ProviderType);(null==n?void 0:n.requiresFetchingSharingInformation)&&!Object(a.k)(t.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)}if(Object(m.a)(e.model)){const t=e.id.Id;Object(s.a)(e.id,e.model,g).then(Object(b.action)("updateAttachmentThumbnailUrl")((function(e){Object(O.a)().attachments.has(t)&&(Object(O.a)().attachments.get(t).thumbnailImage.url=e)})),e=>{p.h.warn(e)})}})}(w,y,t),function(e,t){t=t||{},Object.keys(t).forEach(n=>{t[n]&&(e[n]=t[n])})}(w,S||{}),w}).forEach(e=>{var t;const n=e.model;if(n&&!n.AttachmentOriginalUrl){const r=j.attachments.get(e.id.Id);(null===(t=null==r?void 0:r.model)||void 0===t?void 0:t.AttachmentOriginalUrl)&&(n.AttachmentOriginalUrl=r.model.AttachmentOriginalUrl)}if(n&&Object(f.b)(n)){const t=n;if(!t.AttachLongPathName){const n=j.attachments.get(e.id.Id),r=null==n?void 0:n.model;(null==r?void 0:r.AttachLongPathName)&&(t.AttachLongPathName=r.AttachLongPathName)}}j.attachments.set(e.id.Id,e)})}))},2424:function(e){e.exports=JSON.parse('{"a":"uca"}')},2425:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.a}},2426:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1778),a=n(1862),i=n(2238);function o(e,t,n,o=!1){if(Object(a.b)(t))switch(t.ProviderType){case r.b:return function(e){const t=e.AttachLongPathName,n=t.lastIndexOf("?");return`${t.substring(0,n)}?dl=1`}(t)}return Object(i.a)(e,t,0,Object(a.b)(t),n,o)}},2435:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1778),a=n(1777);const i=[0,1,3,2,6,5,7,8,4];function o(e){let t=null;const n=function(n){const r=Object(a.b)(n);return null===r?null:function(){if(!t){t={};for(const n of i)t[n]=e(n)}return t}()[r]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?r.h:r.i)}}}},247:function(e,t,n){"use strict";var r=n(711),a="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||a||Function("return this")();t.a=i},2488:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function a(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},2490:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n(20),a=n(2339);n.d(t,"a",(function(){return a.a}));const i=new r.c(()=>Promise.all([n.e(0),n.e(24),n.e(96),n.e(711)]).then(n.bind(null,4091))),o=new r.b(i,e=>e.createGetSharingInfoResponse),c=new r.b(i,e=>e.checkSharingLinkUrlDomain),s=new r.b(i,e=>e.getLinkProviderType),u=new r.b(i,e=>e.isOneDriveProRelatedLink),l=new r.b(i,e=>e.convertToAttachmentDataProviderType),d=new r.b(i,e=>e.convertToLinkProviderType)},2493:function(e,t,n){"use strict";var r=n(6),a=n(1786),i=n(1854),o=n(282),c=n(1784);function s(e){switch(e){case i.a.Download:return c.a.Download;case i.a.OpenInNewTab:return c.a.OpenInNewTab;case i.a.Preview:return c.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(o.a)(e)}}function u(e){switch(e){case c.a.Download:return i.a.Download;case c.a.OpenInNewTab:return i.a.OpenInNewTab;case c.a.Preview:return i.a.Preview;case c.a.NoAction:return null;default:return Object(o.a)(e)}}var l=n(2254);var d=n(296),f=n(2144),m=n(1738),h=n(2190);function p(e,t,n,r,o,d,p,O,g,v,I,j){const y=Object(c.e)(t,n,r,v);j&&(O=O.filter(e=>e!==i.a.Download)),function(e,t){const n=Object(f.d)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter(e=>e!==c.a.Download):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter(e=>e!==c.a.Download&&e!==c.a.Preview));const r=function(e,t,n=!1){let r=e.filter(e=>-1!==t.indexOf(e));return n&&(r=r.filter((e,t,n)=>n.indexOf(e)===t)),r}(e.supportedOpenActions.map(u).filter(e=>!!e),t);e.supportedOpenActions=r.map(s)}(y,O);const S=Object(m.a)(r),w=v&&Object(h.a)(r),A=Object(a.d)(r,S||w,g,I,j),C=S,T=b(S,w,d),P=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,S||w,g),E=function(e,t,n,r,a){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){const e=Object(l.a)(a);return(null==e?void 0:e.supportConvertCloudyToClassic)||!1}return!1}(e,S,g,p,o),k=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,S,w,g);let R;switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:R=function(e,t,n,r,a,i,o,c){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:r,isViewingInProviderSupported:a,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:o,isMoveAttachmentToInlineSupported:c,showActionsMenu:!0,supportedMenuActions:[]})}(y,A,S||w,C,T,P,E,k);break;case 1:R=function(e){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(y);break;default:R=S?function(e,t,n,r){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:r,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(y,C,T,E):function(e,t,n,r){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:r,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(y,A,T,P)}return R.supportedMenuActions=O,R}function b(e,t,n){if(e||t)return!1;{const e=Object(d.a)(),t=Object(l.b)(e);return!Object(r.k)(n)&&(e||(null==t?void 0:t.supportViewInProvider))}}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return b}))},2500:function(e){e.exports=JSON.parse('{"a":"rda"}')},2506:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(1941),a=n(3065),i=n(3066),o=n(2255),c=n(1777),s=n(1928),u=n(2413),l=n(1713);function d(e,t,n,d,f,m,h,p=null,b,O=!1){Object(u.a)([{attachmentId:e,attachment:t}],n,f);const g=Object(l.a)(e),v=Object(o.a)(e,n,d,1===g.type,c.a.Unknown,!1,p);if(Object(r.a)(v,g,!1,b,m,h),O){const e=g.model.ProviderType;Object(s.b)(v.isCloudy,e,g.model.Name)?Object(i.a)(g,v):Object(a.a)(v)}return v}},2518:function(e){e.exports=JSON.parse('{"a":"pda","b":"qda"}')},252:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},2521:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.c}},2533:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2652);async function a(e){let t,n;return(n=await r.f.import())&&(t=await n(e.AttachLongPathName)),t}},2552:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Constant:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2553:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FieldURIOrConstantType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2554:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"RestrictionType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2560:function(e,t,n){"use strict";var r=n(1931),a=n(1864),i=n(3);t.a=Object(i.mutatorAction)("disableWacPreview",(function(e){e.previewMethod===a.a.Wac&&(e.previewMethod=a.a.Unsupported,e.supportedOpenActions=e.supportedOpenActions.filter(e=>e!==r.a.Preview))}))},2574:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4);const a=new r.d(()=>n.e(1152).then(n.bind(null,4096))),i=new r.a(a,e=>e.logSigsDatapoint)},2582:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2873),a=n(2552),i=n(2553),o=n(3146),c=n(3083),s=n(1701),u=n(2554),l=n(7);const d="DateTimeReceived";function f(e,t,n,f){if(e||t){const m=[];m.push(Object(c.a)({FieldURIOrConstant:Object(i.a)({Item:Object(a.a)({Value:Object(l.ub)(t||l.b)})}),Item:Object(s.a)({FieldURI:n||d})})),m.push(Object(o.a)({FieldURIOrConstant:Object(i.a)({Item:Object(a.a)({Value:Object(l.ub)(e||l.d)})}),Item:Object(s.a)({FieldURI:f||d})}));const h=Object(r.a)({Items:m});return Object(u.a)({Item:h})}return null}},2583:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return O}));var r=n(326),a=n(327),i=n(10),o=n(156),c=n(142),s=n(36),u=n(2);const l="ows/beta/substratesearch/query",d=2048;function f(e,t,n,r,a,i){return h(e,t,n,r,b,a,i)}function m(e,t,n,r,a,i){return h(e,t,n,r,p,a,i)}function h(e,t,n,r,a,i,c){return Object(o.a)().then(o=>{const s=o.headers;i&&s.append("X-OWA-ActionSource",i);const u=a("ExecuteSearch",t,e,n,o,c);let l=0,d=0;return r&&(l=r.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then(()=>{d=r.addCheckmark("ClientJSRequestThread")})),u?u.then(e=>{const t=e[0],n=e[1],r=[t,n,e[2]];return n.ClientJSPreRequestTime=l,n.ClientJSRequestThreadTime=d,r}):Promise.reject(new Error("Client-side issue prevented request from being sent"))})}function p(e,t,n,a,o,s){const l=JSON.stringify(n),f=encodeURIComponent(l);let m=!1;const h=o.headers;h.append("Content-Type","application/json; charset=utf-8"),o.returnFullResponseOnSuccess=!0,f.length>d?o.body=l:(m=!0,h.append("X-OWA-UrlPostData",f),o.body=null);const p=function(e,t){const n=Object(i.a)();let a=(n.baseUrl?`${n.baseUrl}/service.svc?action=`:"/owa/service.svc?action=")+e+`&app=${Object(u.m)()}`;t&&(a+="&EP=1");return a+="&id="+Object(r.a)(),a}(e,m),b=new Date;return Object(c.a)("ExecuteSearch",p,1,o).then(async e=>{const r=await e.json();return[r,O(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"ExecuteSearch",b,new Date,a,o.headers,t,s),e.url]})}function b(e,t,n,i,o,c){if(!i)return s.d("SearchQueryId must be specified when calling makeExecuteSearchRequest!"),null;const u={};o.headers.forEach((e,t)=>{u[t]=e}),u["X-Search-Griffin-Version"]="GWSv2";const d=new Date;return n.Body.SearchSessionId=i,n.Body.Scenario=c,Object(a.e)(l,n,Object(r.a)(),!0,u).then(async e=>{const r=await e.json();return[r,O(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"SubstrateSearch",d,new Date,i,o.headers,t,c),e.url]}).catch(e=>(s.h.warn(e),null))}const O=(e,t,n,r,a,i,o,c,s,l)=>{const d=e.headers||new Headers;return{ClientSearchProvider:r,PageNumber:s,ClientNetworkTime:i.getTime()-a.getTime(),ClientJSEndToEndTime:0,ClientJSPreRequestTime:0,ClientJSRequestThreadTime:0,ClientResponseProcessTime:0,ClientJSRenderingTime:0,SearchDateTime:d.get("date"),SearchBETarget:d.get("x-calculatedbetarget"),SearchFETarget:d.get("x-calculatedfetarget"),SearchBEHttpStatus:d.get("x-backendhttpstatus"),SearchMsEdgeRef:d.get("x-msedge-ref"),SearchErrorContent:n,SearchTraceID:d.get("request-id"),SearchQueryId:o,ClientBuildNumber:Object(u.u)(),ClientTimeSentUTC:a,ClientTimeFinishedUTC:i,ClientHttpStatus:e.status||-1,SearchClientRequestID:c.get("client-request-id"),SearchClientSessionID:Object(u.t)(),ClientName:l,DiagnosticsCheckpoints:d.get("x-ms-diagnostics-checkpoints"),ResourceTimingEntry:null,PIIData:{queryText:t}}}},2604:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1696);function a(e){var t;return(null===(t=function(e){let t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}(e))||void 0===t?void 0:t.substring(0,4))||""}},2614:function(e,t,n){"use strict";var r=n(2271);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var a=n(2050);n.d(t,"c",(function(){return a.a}));var i=n(2049);n.d(t,"e",(function(){return i.a}));var o=n(2048);n.d(t,"d",(function(){return o.a}))},2645:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2265),a=n(2326),i=n(2125),o=n(326),c=n(327),s=n(59),u=n(6),l=n(36),d=n(610);function f(e,t,n,f,h,p){const b=function(e,t,n,r,i){const c=Object(s.b)().bestEffort;c["client-session-id"]=t,c["client-request-id"]=Object(o.a)(),c["x-client-localtime"]=Object(a.a)(),c["X-Search-Griffin-Version"]="GWSv2",c["Accept-Language"]=Object(u.e)(),r&&r.length>0&&(c["x-anchormailbox"]=r[0].mailboxSmtpAddress,c.authorization=r[0].tokenString);n&&(c["X-Client-Flights"]=n);c.scenariotag=function(e){const t=e.EntityRequests.length>1,n=e.EntityRequests[0],r=[];t&&r.push("ErrMER");0==n.From&&r.push("1stPg");const a=m[n.EntityType];return r.push(a||"Unknown"),r.join("_")}(e),i&&Object.keys(i).forEach(e=>{c[e]=i[e]});return c}(e,t,n,f,h);return Object(c.e)(Object(d.v)(Object(i.a)("query",p),Object(r.a)()),e,null,!0,b,void 0,void 0,!1).then(e=>[e,b]).catch(e=>(l.h.warn(e),[e]))}const m={Event:"ev",Conversation:"cv",Email:"em",Message:"mg",MailItems:"mi",CalendarItems:"ci",MailConversations:"mc",MessageItems:"gi"}},2652:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return s}));var r=n(20),a=n(1858);n.d(t,"b",(function(){return a.b})),n.d(t,"d",(function(){return a.d})),n.d(t,"a",(function(){return a.a})),n.d(t,"c",(function(){return a.c})),n.d(t,"e",(function(){return a.e}));const i=new r.c(()=>n.e(1159).then(n.bind(null,4221))),o=new r.b(i,e=>e.evaluateSafeLink),c=(new r.b(i,e=>e.evaluateSafeLinks),new r.b(i,e=>e.isSafeLink)),s=new r.b(i,e=>e.isSafeLinkUrl)},2691:function(e,t,n){"use strict";var r=n(1824),a=n(702);t.a=Object(a.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2692:function(e,t,n){"use strict";var r=n(1713),a=n(2426),i=n(702);t.a=Object(i.action)("refreshDownloadUrl")((function(e,t,n=!1){const i=Object(r.a)(e),o=Object(a.a)(e,i.model,t,n);i.download.url=o}))},2712:function(e,t,n){"use strict";function r(e){let t=null;return t=e.AttachLongPathName,t||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},2715:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1774),a=n(296),i=n(282),o=n(47);function c(e){const t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-dropbox");case 6:return!1;case 1:return!!Object(a.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(o.j)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2721:function(e,t,n){var r=n(2067);e.exports=function(e,t){var n=r(e).getTime(),a=Number(t);return new Date(n+a)}},2772:function(e,t,n){var r=n(2721),a=6e4;e.exports=function(e,t){var n=Number(t);return r(e,n*a)}},2775:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){let n="";n=t?"Empty response from server":"Null response from server",i(e,n)}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o}))},2776:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.b}},2792:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));const r={};function a(e,t){var n;const a=e.infoBarHostKey;return null===(n=r[a])||void 0===n?void 0:n[t]}},2795:function(e){e.exports=JSON.parse('{"a":"Lca","b":"Mca"}')},2802:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1943),a=n(1957),i=n(1786),o=n(1696),c=n(1738),s=n(2425),u=n(2521);function l(e){if(!Object(i.b)(e,!0).directFileAccessEnabled&&!e.IsInline||Object(a.b)(e.AttachmentId.Id))return!1;if(e.Thumbnail)return!0;const t=Object(o.g)(e.Name,e.ContentType,!1),n=Object(o.h)(e.Name);if((Object(s.a)(e)||Object(u.a)(e))&&(t||n))return!0;if(Object(c.a)(e)){const n=Object(r.a)(e.ProviderType);if(e.AttachmentThumbnailUrl||t&&n&&n.supportImageThumbnail)return!0}return!1}},2803:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(467),a=n(954),i=n(905),o=n(707),c=n(955),s=n(261),u=n(36);const l="0xe0b",d=Object(r.a)({PropertyTag:l,PropertyType:"Binary"});async function f(e){var t;let n=null;const r=Object(o.a)({BaseShape:"IdOnly",AdditionalProperties:[d]}),f=await function(e,t){const n=Object(s.b)(),r=e.map(e=>Object(i.a)({Id:e}));return Object(c.a)({Header:n,Body:Object(a.a)({ItemShape:t,ItemIds:r})}).then(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}).catch(e=>(u.h.warn("GetItem:"+e.message),null))}([e],r);if("Success"===(null===(t=null==f?void 0:f[0])||void 0===t?void 0:t.ResponseClass)){n=function(e,t){var n;if(e){const r=e.ExtendedProperty;if(r){const e=r.length;for(let a=0;a<e;a++){const e=r[a];if((null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t)return e}}}return null}(f[0].Items[0],l)}return n?n.Value:(u.h.info("[getImmutableEntryId] extendedProperty could not be retrieved"),null)}},283:function(e,t,n){"use strict";var r=n(907);n.d(t,"a",(function(){return r.a}))},2834:function(e,t,n){"use strict";var r=n(610),a=n(2);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?`${e}&${t}=${n}`:`${e}?${t}=${n}`}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return u}));const o=Object(a.S)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){const t=e?encodeURIComponent(`?provider=${e}`):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return`${Object(r.n)()}/mail/${n}${t}`}function s(e){const t=`${Object(r.n)()}/mail/AddFileProvider.html`,n=encodeURIComponent(`provider=${e}&url=${t}`);return`${o}/ADPRedirect.aspx?${n}`}function u(e,t,n,r,a,o){return()=>{const e=function(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[];for(let r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}();let c=i(t,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",a),o){const t=o(e);c=Object.keys(t).reduce((e,n)=>i(e,n,t[n]),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2852:function(e){e.exports=JSON.parse('{"b":"Yca","a":"Zca"}')},2853:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),a=n(2136);function i(){return{providers:new r.ObservableMap,loadState:a.a.NotLoaded,removalPending:new r.ObservableMap}}},287:function(e,t,n){"use strict";var r,a=n(3);!function(e){e[e.Valid=0]="Valid",e[e.AccountDeprovisioned=1]="AccountDeprovisioned",e[e.AccessRevoked=2]="AccessRevoked",e[e.TransientTokenError=3]="TransientTokenError",e[e.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",e[e.AccountNotFound=5]="AccountNotFound",e[e.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var i=n(80);const o=Object(a.action)("addAccount",e=>({userIdentity:e.userIdentity,account:e})),c=Object(a.action)("removeAccount",e=>({userIdentity:e})),s=Object(a.action)("updateAccount",(e,t,n)=>({userIdentity:e,accountToken:t,accountTokenExpiresIn:n})),u=Object(a.action)("updateOWAConnectedAccountStatus",(e,t)=>({userIdentity:e,accountState:t})),l=Object(a.action)("connectedAccountIsInErrorState",(e,t)=>Object(i.b)({name:"connectedAccountIsInErrorState",customData:{accountState_1:r[e],accountProvider_2:t}},{accountState:e})),d=Object(a.action)("connectedAccountsListRequested",e=>({isSuccess:e})),f=Object(a.action)("setAccountsStoreState",e=>({state:e}));var m,h=n(16);!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",e[e.AccountsLoadError=3]="AccountsLoadError"}(m||(m={}));var p=Object(a.createStore)("OWAAccountsStore",{accountsMap:new h.ObservableMap({}),accountsLoadedState:m.None}),b=n(282),O=n(57),g=n(912),v=n(971),I=n(516);function j(e){var t;if(Object(I.a)()){const n=Object(v.a)(Object(g.a)(e));if(n&&"OFFICE365"==(null===(t=n.mailbox)||void 0===t?void 0:t.mailboxType))return!1}else if(e==Object(O.b)())return!1;return void 0!==w(e)}var y=n(972);function S(){return[...p().accountsMap.values()]}function w(e){return p().accountsMap.get(e)}function A(){var e,t;return Object(I.a)()?(null===(e=S())||void 0===e?void 0:e.length)>1?S()[1]:null:(null===(t=S())||void 0===t?void 0:t.length)>0?S()[0]:null}function C(){return S().filter(e=>e.accountState!=r.Valid)}function T(e){return S().filter(t=>e.includes(t.accountState))}function P(e){return S().filter(t=>t.accountProviderType==e)}function E(e){return j(e)?w(e).accountProviderType:null}function k(e){return Object(I.a)()?e.token:"Outlook"==e.accountProviderType?`MSAuth1.0 usertoken="${e.token}", type="MSACT"`:"Google"==e.accountProviderType||"ICloud"==e.accountProviderType||"Yahoo"==e.accountProviderType?`Bearer ${e.token}`:"Office365"==e.accountProviderType?(Object(y.a)(!1,"Office365 accounts should not use this function."),""):Object(b.a)(e.accountProviderType)}function R(e,t){return function(n){const r=w(n);return r?r[e]:t}}R("accountUniqueId","0");const x=R("accountState",r.Valid),D=()=>S().some(e=>!M(e.userIdentity)),F=R("accountProviderType",null),N=e=>"Outlook"==F(e),M=e=>x(e)==r.Valid,_=()=>S().length>0;function L(){return p().accountsLoadedState}var U=n(71),B=n(727),W=n(7),G=n(132),V=n(13);function z(){return!Object(G.a)("acctmonaccounts")&&(Object(V.i)("sourcelistapi")||Object(V.i)("accountsapi"))}Object(a.mutator)(o,({account:e})=>{Object(U.o)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),p().accountsMap.set(e.userIdentity,e)}),Object(a.orchestrator)(o,({account:e})=>{z()&&B.a.importAndExecute(e.userIdentity,e.accountUniqueId,e.accountState)}),Object(a.mutator)(c,({userIdentity:e})=>{p().accountsMap.delete(e)}),Object(a.orchestrator)(c,({userIdentity:e})=>{z()&&B.c.importAndExecute(e)}),Object(a.mutator)(s,({userIdentity:e,accountToken:t,accountTokenExpiresIn:n})=>{const r=p().accountsMap.get(e);r.token=t,r.tokenExpiry=Object(W.j)(Object(W.Ub)(),n)}),Object(a.mutator)(u,({userIdentity:e,accountState:t})=>{const n=p().accountsMap.get(e);n.accountState==r.Valid&&t!=r.Valid&&Object(U.o)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[t]}),n.accountState=t}),Object(a.orchestrator)(u,({userIdentity:e,accountState:t})=>{z()&&B.d.importAndExecute(e,t)}),Object(a.mutator)(d,e=>{const t=e.isSuccess?m.AccountsLoadSuccessful:m.AccountsLoadError;p().accountsLoadedState=t}),Object(a.mutator)(f,e=>{p().accountsLoadedState=e.state}),n.d(t,"c",(function(){return o})),n.d(t,"v",(function(){return c})),n.d(t,"y",(function(){return s})),n.d(t,"x",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"w",(function(){return f})),n.d(t,"n",(function(){return S})),n.d(t,"k",(function(){return w})),n.d(t,"i",(function(){return A})),n.d(t,"f",(function(){return C})),n.d(t,"g",(function(){return T})),n.d(t,"o",(function(){return P})),n.d(t,"j",(function(){return E})),n.d(t,"m",(function(){return k})),n.d(t,"l",(function(){return x})),n.d(t,"q",(function(){return D})),n.d(t,"u",(function(){return N})),n.d(t,"t",(function(){return M})),n.d(t,"p",(function(){return _})),n.d(t,"h",(function(){return L})),n.d(t,"r",(function(){return j})),n.d(t,"s",(function(){return I.a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return m}))},2873:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"And:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2874:function(e){e.exports=JSON.parse('{"b":"Rca","a":"Sca","e":"Tca","d":"Uca","f":"Vca","c":"Wca"}')},2887:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2888:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(71),a=n(1990),i=n(2268),o=n(36);async function c(e,t,n,c,s){const u=new r.b("getWacInfoForOneDriveJsApi",{isCore:!0});c&&u.addCustomData({redeemSharingLinkIfNecessary:c});try{const r="u!"+btoa(t).replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),o=`${new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0]}_api/v2.0/shares/${r}/root?select=openWith/wac,officeBundle,@content.downloadUrl,webDavUrl,name,size,currentUserRole,sensitivityLabel&action=${n?"Open":"View"}`,l=new Object;c&&(l.prefer="redeemSharingLinkIfNecessary");const d=Object(a.a)({ProviderType:e,Url:o,Headers:JSON.stringify(l)}),f=(new Date).getTime(),m=await Object(i.a)(d);if(200===m.Status&&m.Body){const e=(new Date).getTime(),t=JSON.parse(m.Body);return t.fetchStartTime=f,t.responseStartTime=e,!t.openWith.wac&&s||(t.openWith.wac.fileGetUrl=t["@content.downloadUrl"],t.openWith.wac.accessTokenExpiry&&(t.openWith.wac.accessTokenExpiry=new Date(Number(t.openWith.wac.accessTokenExpiry))),!n&&t.currentUserRole&&(t.currentUserRole.readOnly=!0)),u.end(),t}{u.addCustomData({StatusCode:m.Status});const e=m.Headers;if(e){const t=JSON.parse(e);t&&u.addCustomData({SharePointError:t.SharePointError,SPClientServiceRequestDuration:t.SPClientServiceRequestDuration,SPRequestGuid:t.SPRequestGuid})}throw new Error(`Result status is: ${m.Status} or empty response body.`)}}catch(e){u.endWithError("ServerError",e),o.h.warn(`Something went wrong while calling fetchDataProviderResourceOperation: ${e}`)}return null}},2889:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2199),a=n(2974);async function i(e){var t;const n=Object(a.a)(e.AttachLongPathName);return(null===(t=(await Object(r.j)(n)).result)||void 0===t?void 0:t.thumbnailLink)||null}},2890:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FileAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2896:function(e,t,n){"use strict";var r=n(1798),a=n(71);const i={},o=5e3,c=12;function s(e,t,n,s,l){const d=new a.b("SaveToCloudProgressManager"),f=setInterval(()=>{!async function(e,t,n,a,i,o,c){const s=c[e];if(!s)return;if(s.counter++,s.counter>o)return u(e,c),s.datapoint.addCustomData({operationId:e,counter:s.counter}),s.datapoint.endWithError("Timeout"),void(i&&i());(await r.e.import())(t,n,e,0,e=>{a&&a(e.NotificationPayloads)})}(n,e,t,s,l,c,i)},o);i[n]={timer:f,counter:0,datapoint:d}}function u(e,t=null){t||(t=i);const n=t[e];if(!n)return;clearInterval(n.timer);const r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}var l=n(3);var d=Object(l.action)("cancelSaveAttachmentsToCloud",e=>({operationId:e}));Object(l.orchestrator)(d,e=>{u(e.operationId)});var f=Object(l.action)("saveAttachmentsToCloud",(function(e,t,n,r,a,i,o,c,s,u){return{attachmentId:e,itemId:t,sxsId:n,notificationHandler:r,serviceCallFailureCallback:a,operationCreatedCallback:i,folderId:o,attachmentIds:c,showProgressBar:s,subscriptionId:u}}));function m(e){return Object.assign({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}var h=n(35);var p=n(704);function b(e,t,n,r,a,i,o){const c=function(e,t,n,r,a,i,o){return m({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:a,channelId:r,folderItemId:i,attachmentIds:o})}(e,t,n,r,"GroupMailbox"===(null==a?void 0:a.type)?a.mailboxSmtpAddress:null,i,o);return s={requestObject:c},u=Object(p.a)(a),void 0===s.requestObject||s.requestObject.__type||(s.requestObject=m(s.requestObject)),Object(h.a)("SaveAttachmentsToCloud",s,u);var s,u}var O=n(2051),g=n(1761);Object(l.orchestrator)(f,async e=>{let t=!1!==e.showProgressBar,n=e.attachmentId||e.itemId;!n&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]);const r=r=>{if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;const a=e.notificationHandler(r);return t&&a&&(u(n.Id),t=!1),a},a=e.subscriptionId,[i,o,c,l]=await Object(O.a)(r,a);!async function(e,t,n,r,a,i,o,c,s,u){try{await b(e?e.Id:null,t?t.Id:null,n,i,function(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}(t,e,u),s,u?u.map(e=>e.Id):null)}catch(e){return c(e,1,"ServerError",o),g.k.importAndExecute(r,a),null}}(e.attachmentId,e.itemId,i,o,c,l,e.sxsId,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&s(e.attachmentId,e.itemId,n.Id,e=>{e.forEach(e=>{r(e)})},()=>{e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout",e.sxsId)}),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,o,c)});async function v(e,t,n,r,a){const i=n=>{if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;const r=t(n);return r&&u(e.Id),r};await Object(O.a)(i,r),s(e,null,e.Id,e=>{e.forEach(e=>{i(e)})},()=>{n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout",a)})}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v}))},290:function(e,t,n){"use strict";var r=n(446),a=n(447);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=v,t.resolve=function(e,t){return v(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?v(e,!1,!0).resolveObject(t):t},t.format=function(e){a.isString(e)&&(e=v(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var o=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,s=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),d=["%","/","?",";","#"].concat(l),f=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},b={javascript:!0,"javascript:":!0},O={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=n(227);function v(e,t,n){if(e&&a.isObject(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}i.prototype.parse=function(e,t,n){if(!a.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),c=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(c);u[0]=u[0].replace(/\\/g,"/");var v=e=u.join(c);if(v=v.trim(),!n&&1===e.split("#").length){var I=s.exec(v);if(I)return this.path=v,this.href=v,this.pathname=I[1],I[2]?(this.search=I[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var j=o.exec(v);if(j){var y=(j=j[0]).toLowerCase();this.protocol=y,v=v.substr(j.length)}if(n||j||v.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===v.substr(0,2);!S||j&&b[j]||(v=v.substr(2),this.slashes=!0)}if(!b[j]&&(S||j&&!O[j])){for(var w,A,C=-1,T=0;T<f.length;T++){-1!==(P=v.indexOf(f[T]))&&(-1===C||P<C)&&(C=P)}-1!==(A=-1===C?v.lastIndexOf("@"):v.lastIndexOf("@",C))&&(w=v.slice(0,A),v=v.slice(A+1),this.auth=decodeURIComponent(w)),C=-1;for(T=0;T<d.length;T++){var P;-1!==(P=v.indexOf(d[T]))&&(-1===C||P<C)&&(C=P)}-1===C&&(C=v.length),this.host=v.slice(0,C),v=v.slice(C),this.parseHost(),this.hostname=this.hostname||"";var E="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!E)for(var k=this.hostname.split(/\./),R=(T=0,k.length);T<R;T++){var x=k[T];if(x&&!x.match(m)){for(var D="",F=0,N=x.length;F<N;F++)x.charCodeAt(F)>127?D+="x":D+=x[F];if(!D.match(m)){var M=k.slice(0,T),_=k.slice(T+1),L=x.match(h);L&&(M.push(L[1]),_.unshift(L[2])),_.length&&(v="/"+_.join(".")+v),this.hostname=M.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+U,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==v[0]&&(v="/"+v))}if(!p[y])for(T=0,R=l.length;T<R;T++){var W=l[T];if(-1!==v.indexOf(W)){var G=encodeURIComponent(W);G===W&&(G=escape(W)),v=v.split(W).join(G)}}var V=v.indexOf("#");-1!==V&&(this.hash=v.substr(V),v=v.slice(0,V));var z=v.indexOf("?");if(-1!==z?(this.search=v.substr(z),this.query=v.substr(z+1),t&&(this.query=g.parse(this.query)),v=v.slice(0,z)):t&&(this.search="",this.query={}),v&&(this.pathname=v),O[y]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var q=this.search||"";this.path=U+q}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&a.isObject(this.query)&&Object.keys(this.query).length&&(o=g.stringify(this.query));var c=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||O[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),c&&"?"!==c.charAt(0)&&(c="?"+c),t+i+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(c=c.replace("#","%23"))+r},i.prototype.resolve=function(e){return this.resolveObject(v(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(a.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var n=new i,r=Object.keys(this),o=0;o<r.length;o++){var c=r[o];n[c]=this[c]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),u=0;u<s.length;u++){var l=s[u];"protocol"!==l&&(n[l]=e[l])}return O[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!O[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var m=d[f];n[m]=e[m]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||b[e.protocol])n.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),n.pathname=h.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var p=n.pathname||"",g=n.search||"";n.path=p+g}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var v=n.pathname&&"/"===n.pathname.charAt(0),I=e.host||e.pathname&&"/"===e.pathname.charAt(0),j=I||v||n.host&&e.pathname,y=j,S=n.pathname&&n.pathname.split("/")||[],w=(h=e.pathname&&e.pathname.split("/")||[],n.protocol&&!O[n.protocol]);if(w&&(n.hostname="",n.port=null,n.host&&(""===S[0]?S[0]=n.host:S.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),j=j&&(""===h[0]||""===S[0])),I)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,S=h;else if(h.length)S||(S=[]),S.pop(),S=S.concat(h),n.search=e.search,n.query=e.query;else if(!a.isNullOrUndefined(e.search)){if(w)n.hostname=n.host=S.shift(),(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift());return n.search=e.search,n.query=e.query,a.isNull(n.pathname)&&a.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!S.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var A=S.slice(-1)[0],C=(n.host||e.host||S.length>1)&&("."===A||".."===A)||""===A,T=0,P=S.length;P>=0;P--)"."===(A=S[P])?S.splice(P,1):".."===A?(S.splice(P,1),T++):T&&(S.splice(P,1),T--);if(!j&&!y)for(;T--;T)S.unshift("..");!j||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),C&&"/"!==S.join("/").substr(-1)&&S.push("");var E,k=""===S[0]||S[0]&&"/"===S[0].charAt(0);w&&(n.hostname=n.host=k?"":S.length?S.shift():"",(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift()));return(j=j||n.host&&S.length)&&!k&&S.unshift(""),S.length?n.pathname=S.join("/"):(n.pathname=null,n.path=null),a.isNull(n.pathname)&&a.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=c.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},291:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var r=n(135),a=n(100),i=n(2);let o;function c(e){o=e}async function s(e){var t,n;if(Object(i.Q)())return a.f.importAndExecute(Object(r.a)());const c=o&&await o(void 0,e);if(c&&c.length>0){if("bearer"===(null===(t=null==c?void 0:c.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return c.split(" ")[1];if("msauth1.0"===(null===(n=null==c?void 0:c.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return c}}},2914:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},2915:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2916:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(6),a=n(1778),i=n(2264),o=n(38);function c(e){return Object(r.k)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function s(e){let t=e.AttachLongPathName;if(Object(i.e)(e.PermissionType)||e.ProviderType!==a.i)return t;const n=Object(o.a)(),r=n.ApplicationSettings;if(null!==t&&null!==r){let e;e=c(r.VDirIsPublicProperty||n.PublicComputersDetectionEnabled&&n.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL),null!==e&&(t=function(e,t){const n=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),r=n.exec(e),a=n.exec(t);let i,o,c;return r&&a&&r.length>=5&&a.length>=5&&(a[1]&&a[2]&&(c=a[1]+"://"+a[2],i=!0),a[3]&&(c+=a[3]),r[4]&&(o=!0,c+=r[4])),i&&o?c:null}(t,e))}return null!==t?t:e.AttachLongPathName}},2917:function(e,t,n){"use strict";function r(e,t,n,r,a,i){let o=!1;return{task:()=>new Promise((c,s)=>{let u=0,l=0,d=0;const f=()=>{o&&c(1),u<n&&d<t.length&&((n=>{const{start:o,end:c}=t[n],s=e.slice(o,c);return r(s,i(n),a)})(d).then(()=>(e=>{u-=1,l+=1,l===t.length&&c(0),f()})()).catch(s),d+=1,u+=1)};for(let e=0;e<n;e++)f()}),cancelTask:()=>o=!0}}const a=Object.freeze({sliceSize:14680064,numberOfSlicesToParallelize:2});function i(e,t,n=a){!function(e){e.sliceSize=e.sliceSize||a.sliceSize,e.numberOfSlicesToParallelize=e.numberOfSlicesToParallelize||a.numberOfSlicesToParallelize}(n);const{sliceSize:i,numberOfSlicesToParallelize:s}=n,u=Math.ceil(e.size/i),l=function(e,t,n){const r=[];let a=0;for(let i=0;i<e;i++){const e=Math.min(a+t,n);r.push({start:a,end:e}),a=e}return r}(u,i,e.size),d=r(e,[l[0]],1,t,u,()=>0),f=l.length>2?r(e,l.slice(1,l.length-1),s,t,u,e=>e+1):c(),m=l.length>1?r(e,[l[l.length-1]],1,t,u,()=>l.length-1):c();return{onCompletePromise:d.task().then(o(f.task)).then(o(m.task)),cancel:()=>{d.cancelTask(),f.cancelTask(),m.cancelTask()}}}function o(e){return t=>0===t?e():Promise.resolve(t)}function c(){let e=!1;return{task:()=>e?Promise.resolve(1):Promise.resolve(0),cancelTask:()=>e=!0}}n.d(t,"a",(function(){return i}))},2933:function(e){e.exports=JSON.parse('{"b":"bda","a":"cda","d":"dda","e":"eda","g":"fda","f":"gda","c":"hda","i":"ida","h":"jda","j":"kda","k":"lda"}')},2945:function(e,t,n){"use strict";var r=n(2264),a=n(1696),i=n(7),o=n(47);var c=n(2956),s=n(1943);function u(e,t,n,u,l,d=null){if(1===t)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};const f=Object(a.b)(n.Name),m=Object(c.a)(e,n,f),h=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;const r=Object(s.a)(t);return null==r?void 0:r.supportedPermissionLevels}(u,l,Object(r.a)(d,0)),p=(b=d)&&0===b.ResultCode?(Object(o.j)("doc-attachment-referenceAttachmentExpiration")||(b.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:b.BlocksDownload,canonicalUrl:b.CanonicalUrl,canShareInternally:b.CanShareInternally,canShareExternally:b.CanShareExternally,expirationDate:b.ExpirationDate?Object(i.qc)(b.ExpirationDate):null,canRefresh:!1,shareId:b.ShareId,siteUrl:b.SiteUrl,linkType:b.Type,itemUniqueId:b.ItemUniqueId,mimeType:b.MimeType}):null;var b;return u?function(e,t,n){return{allowDownload:e,supportedPermissionLevels:t,sharingInfo:n}}(m,h,p):function(e){return{allowDownload:e,supportedPermissionLevels:null,sharingInfo:null}}(m)}n.d(t,"a",(function(){return u}))},2955:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(99);function a(e,t){return r.d()||r.e()||r.h()?function(e){const t=["Chrome PDF Viewer","Microsoft Edge PDF Viewer","WebKit built-in PDF"];e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins);try{return"function"==typeof(null==e?void 0:e.namedItem)&&t.some(t=>null!==e.namedItem(t))}catch(e){}return!1}(t):(r.f(),!1)}},2956:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1738),a=n(1943),i=n(1786),o=n(47);function c(e,t,n){let c=e.level!==i.a.Block&&e.directFileAccessEnabled;return c&&Object(r.a)(t)&&(c=function(e,t){if(e.AttachLongPathName){const t=document.createElement("a");if(t.href=e.AttachLongPathName,!Object(o.j)("doc-unwrap-safelinks")&&t.host.indexOf(s,0)>0||t.search.indexOf(u,0)>0)return!1}if(function(e){const t=Object(a.a)(e);return null==t?void 0:t.supportDownload}(e.ProviderType)&&!e.AttachmentIsFolder)return".fluid"!==t&&!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);return!1}(t,n)),c}const s="safelinks.protection.outlook.com",u="b7780972f918485c8cfc32b1ba7438eb"},2974:function(e,t,n){"use strict";function r(e){const t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},2975:function(e,t,n){"use strict";var r=n(1713),a=n(702);t.a=Object(a.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},2997:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(71),a=n(2775),i=n(3017),o=n(704);const c={},s={},u=[];let l=0;const d=2;async function f(e,t,n,a){const i=new r.b("InitializeWacUrl");n&&i.addCustomProperty("actionSource",n);const o=h(e,t,i);return o||new Promise((r,o)=>{const c={attachmentId:e,isEdit:t,actionSource:n,datapoint:i,resolve:r,reject:o};a?m(c):(u.push(c),async function e(){if(!u.length)return;if(l>=d)return;const t=u.shift();l++;try{await m(t)}finally{l--,e()}}())})}async function m(e){var t;const{attachmentId:n,isEdit:r,actionSource:u,datapoint:l,resolve:d,reject:f}=e,m=h(n,r,l);if(m)return void d(m);let p;l.addCustomProperty("ReturnFromCache",!1);try{if(p=await Object(i.a)(n.Id,r,null,Object(o.a)(n.mailboxInfo),u),0===p.Status){(r?s:c)[n.Id]={expireTime:(new Date).getTime()+36e5,value:p}}p.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",null===(t=p.Status)||void 0===t?void 0:t.toString()),l.end(),d(p)}catch(e){Object(a.a)(e)&&Object(a.c)(l,e.response),Object(a.d)(l,e.toString()),l.endWithError("ServerError"),f(e)}}function h(e,t,n){const r=t?s:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},2998:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1778),a=n(2889),i=n(2238);async function o(e,t,n){if(!n)return Object(i.a)(e,t,2,n,!0);const o=t;return o.ProviderType===r.e&&o.AttachLongPathName?Object(a.a)(o):o.AttachmentThumbnailUrl||null}},3016:function(e,t,n){"use strict";var r=n(3),a=n(80);const i=Object(r.action)("addCalendarEventsAttachment",(e,t)=>Object(a.b)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e}));t.a=i},3017:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2329);function a(e,t,n,a,i){if(i){const e="getWacAttachmentInfo"+i;(a=a||{}).headers=a.headers||new Headers,a.headers.set("X-OWA-ActionName",e)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},a)}},3018:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let r=null;const a={register:e=>{r=e},run:(e,t,n)=>{r&&r(e,t,n)}}},3020:function(e,t,n){"use strict";var r=n(1943),a=n(1696);function i(e){const t=Object(a.b)(e.Name);return t&&".pdf"===t.toLowerCase()}const o=[".mp3"];const c=[".ics",".ical",".ifb",".icalendar"];const s=[".eml",".msg"];var u=n(2488),l=n(1738);const d=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(a.g)(e.Name)||!Object(l.a)(e)&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var m=n(2955),h=n(1786);function p(e,t){if(i(e)&&Object(m.a)()){if(t)return!0;{const t=Object(h.c)(e,!0);return Object(h.b)(e,!0).directFileAccessEnabled&&t.directFileAccessEnabled}}return!1}var b=n(2355);const O=[".mp4"],g=[".mov"];var v=n(296),I=n(2425),j=n(2521),y=n(2776),S=n(2190);function w(e,t){let n;if(Object(l.a)(t)||Object(S.a)(t)){n=function(e){const t=Object(r.a)(e.ProviderType);return t&&t.supportPreview(e,Object(v.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(u.a)(t)?6:p(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0}else n=Object(I.a)(t)?e.level===h.a.Block?1:e.level===h.a.AccessDisabled?0:f(t)?2:i(t)?function(e,t){if(!Object(h.e)().isPdfPreviewEnabled())return 1;if(p(t,!1))return 3;if(function(e){return i(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){const t=Object(a.b)(e.Name);return!!t&&o.indexOf(t.toLowerCase())>=0}(t)?5:function(e){const t=Object(a.b)(e.Name);return!!t&&s.indexOf(t.toLowerCase())>=0}(t)?10:Object(b.b)(t.Name)?11:function(e,t){var n;const r=Object(a.b)(e.Name);if(r){const e=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),a=-1!==e.indexOf("Safari")&&-1===e.indexOf("Chrome");return O.indexOf(r.toLowerCase())>=0||a&&g.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){const t=Object(a.b)(e.Name);return!!t&&-1!==c.indexOf(t.toLowerCase())}(t)?13:0:Object(y.a)(t)?8:Object(j.a)(t)?9:0;return n}n.d(t,"a",(function(){return w}))},3026:function(e,t,n){"use strict";var r=n(705);const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ImportEventsFromIcsFile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileContent"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"calendarId"}},type:{kind:"NamedType",name:{kind:"Name",value:"CalendarIdInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"importEventsFromIcsFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"fileContent"},value:{kind:"Variable",name:{kind:"Name",value:"fileContent"}}},{kind:"ObjectField",name:{kind:"Name",value:"attachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}},{kind:"ObjectField",name:{kind:"Name",value:"calendarId"},value:{kind:"Variable",name:{kind:"Name",value:"calendarId"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"numberOfEventsImported"}}]}}]}}]};async function i(e,t,n,i,o){var c;const s=Object(r.a)(),u={fileContent:e,folderId:t,calendarId:n?{id:n.id,changeKey:n.changeKey,mailboxInfo:n.mailboxInfo}:null,mailboxInfo:o,attachmentId:i},l=await s.mutate({variables:u,mutation:a});return null===(c=null==l?void 0:l.data)||void 0===c?void 0:c.importEventsFromIcsFile}n.d(t,"a",(function(){return i}))},306:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},3065:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2560),a=n(1864),i=n(2997);async function o(e){if(e.strategy.previewMethod===a.a.Wac){const t=await Object(i.a)(e.attachmentId,!1);9!==t.Status&&6!==t.Status||Object(r.a)(e.strategy)}}},3066:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2560),a=n(2533),i=n(2888),o=n(47);async function c(e,t){const n=e,c=Object(o.j)("doc-unwrap-safelinks")?await Object(a.a)(e.model):n.openUrl;await Object(i.a)(0,c,!1,!1,!0)||Object(r.a)(t.strategy)}},308:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(57),a=n(47);function i(e){const t=Object(r.h)(e);return t&&t.SessionSettings?0===t.SessionSettings.WebSessionType?Object(a.j)("doc-attachment-routingKeyAadSmtp")?"SMTP:":"":"MSA:":"no-routing-key:"}},3083:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsLessThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3146:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsGreaterThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3205:function(e,t,n){"use strict";n.d(t,"n",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"f",(function(){return h})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"g",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"e",(function(){return j})),n.d(t,"l",(function(){return y})),n.d(t,"b",(function(){return S}));var r=n(3591),a=n(99),i=n(2035),o=n(2322),c=n(3245),s=n(132);function u(){return Object(a.d)()||Object(a.e)()}function l(e){return function(e){if(e.length<2)return!1;const t=e[0]-parseInt(i.b),n=e[1]-parseInt(i.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map(e=>parseInt(e)):[])}function d(e){const t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=i.b}function f(){return Object(r.a)()&&Object(s.a)("smimeExtension")}function m(e){return 0!==e}function h(e){const t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);const n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function p(e){let t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function b(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function O(e,t){const n=Object(c.a)().ClearSign;return t||e&&!n?o.a:i.e}function g(e){return btoa(unescape(encodeURIComponent(e)))}function v(e,t){const n=Object(c.a)();return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function I(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function j(e){return i.k+(e||I()+I()+I()+I())}function y(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function S(){return i.d+I()+"@"+I()+"."+I()}},3245:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(66);function a(){var e;return null===(e=r.a.userConfiguration)||void 0===e?void 0:e.SmimeAdminSettings}},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function o(e){return r.test(e)}},327:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return d}));var r=n(20);const a=new r.c(()=>Promise.all([n.e(0),n.e(901),n.e(504)]).then(n.bind(null,1565))),i=new r.a(a,e=>e.makePostRequest).importAndExecute,o=new r.a(a,e=>e.makePatchRequest).importAndExecute,c=new r.a(a,e=>e.makePutRequest).importAndExecute,s=new r.a(a,e=>e.makeGetRequest).importAndExecute,u=new r.a(a,e=>e.makeDeleteRequest).importAndExecute,l=new r.a(a,e=>e.makeGraphRequest).importAndExecute,d=new r.a(a,e=>e.sendOwsPrimeRequest).importAndExecute},328:function(e,t,n){"use strict";var r,a=n(565),i=n(247).a["__core-js_shared__"],o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var c=function(e){return!!o&&o in e},s=n(252),u=n(434),l=/^\[object .+?Constructor\]$/,d=Function.prototype,f=Object.prototype,m=d.toString,h=f.hasOwnProperty,p=RegExp("^"+m.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var b=function(e){return!(!Object(s.a)(e)||c(e))&&(Object(a.a)(e)?p:l).test(Object(u.a)(e))};var O=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=O(e,t);return b(n)?n:void 0}},3303:function(e,t,n){"use strict";var r=n(3342),a=n(2691),i=n(1713),o=n(702);t.a=Object(o.action)("removeAttachmentFromWell")((function(e,t,n=!0,o=!0){const c=Object(i.a)(t.attachmentId);if(!c)return;let s,u=!1;1===t.attachmentType?(s=e.inlineAttachments,u=!0):s=e.imageViewAttachments.some(e=>e.attachmentId===t.attachmentId)?e.imageViewAttachments:e.docViewAttachments;let l=!1;for(let e=0;e<s.length;e++)if(s[e].attachmentId===t.attachmentId){s.splice(e,1),l=!0;break}n&&l&&(u||!t.isCloudy)&&Object(r.a)(e,-1*c.model.Size),o&&Object(a.a)(t.attachmentId)}))},3342:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.mutatorAction)("changeTotalClassicAttachmentSize",(function(e,t){e.totalClassicAttachmentSize+=t}))},3448:function(e,t,n){"use strict";var r=n(1689),a=n(3);t.a=Object(a.mutatorAction)("setNextSearchQueryId",(e,t)=>{Object(r.d)(t).nextSearchQueryId=e})},347:function(e,t,n){"use strict";var r=n(366),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,c=r.a?r.a.toStringTag:void 0;var s=function(e){var t=i.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var a=o.call(e);return r&&(t?e[c]=n:delete e[c]),a},u=Object.prototype.toString;var l=function(e){return u.call(e)},d="[object Null]",f="[object Undefined]",m=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:d:m&&m in Object(e)?s(e):l(e)}},3561:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(e,t)=>({jsEndToEndTime:e,jsRenderingTime:t}))},3591:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(99),a=n(2035);function i(){return Object(r.d)()&&Object(r.m)([a.f])||Object(r.e)()&&Object(r.m)([a.g])}},366:function(e,t,n){"use strict";var r=n(247).a.Symbol;t.a=r},369:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},378:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return u}));var r=n(38),a=n(308),i=n(47),o=n(36);function c(e,t,n){if(n)for(const t of n)if(!s(e,t))return t;return t&&t.length>0?t[0]:"NoResolvableAddress@invalid.outlook.com"}function s(e,t){return("outlook_"+e+"@outlook.com").toLowerCase()===t.toLowerCase()}function u(){let e=function(){const e=Object(r.a)();if(!e||!e.SessionSettings)return o.d("SessionSettings not available"),"no-routing-key";let t=e.SessionSettings.UserEmailAddress;if(0===e.SessionSettings.WebSessionType)return Object(a.a)()+t;if(Object(i.j)("doc-attachment-routingKeyPuid"))return"PUID:"+e.SessionSettings.UserPuid+"@"+e.SessionSettings.TenantGuid;if(e.SessionSettings.IsShadowMailbox)return Object(a.a)()+e.SessionSettings.LogonEmailAddress;if(s(e.HexCID,e.SessionSettings.UserEmailAddress))return Object(a.a)()+c(e.HexCID,e.SessionSettings.NotManagedEmailAddresses,e.SessionSettings.UserProxyAddresses);return Object(a.a)()+t}();return e=encodeURIComponent(e),e}},380:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var c=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var u=e.length;s>0&&u>s&&(u=s);for(var l=0;l<u;++l){var d,f,m,h,p=e[l].replace(c,"%20"),b=p.indexOf(n);b>=0?(d=p.substr(0,b),f=p.substr(b+1)):(d=p,f=""),m=decodeURIComponent(d),h=decodeURIComponent(f),r(o,m)?a(o[m])?o[m].push(h):o[m]=[o[m],h]:o[m]=h}return o};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},381:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(o(e),(function(o){var c=encodeURIComponent(r(o))+n;return a(e[o])?i(e[o],(function(e){return c+encodeURIComponent(r(e))})).join(t):c+encodeURIComponent(r(e[o]))})).join(t):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},4005:function(e,t,n){"use strict";n.r(t);var r=n(1808),a=n(3);function i(e,t){const n=e.indexOf(t);-1!==n&&e.splice(n,1)}function o(e,t){t&&!e.includes(t)&&e.push(t)}Object(a.mutator)(r.d,e=>{o(e.sharingLinkIds,e.linkId)}),Object(a.mutator)(r.T,e=>{i(e.sharingLinkIds,e.linkId)}),Object(a.mutator)(r.e,e=>{o(e.linkIdContainer,e.linkId)}),Object(a.mutator)(r.R,e=>{i(e.linkIdContainer,e.linkId)});var c=n(6461);Object(a.mutator)(c.a,e=>{const{attachmentWell:t,message:n}=e;t.announcedComponentMessage=n});const s=Object(a.action)("addInlineAttachment",(e,t)=>({attachmentWell:e,inlineAttachment:t}));Object(a.mutator)(s,e=>{const{attachmentWell:t,inlineAttachment:n}=e;t.inlineAttachments.push(n)});var u=n(12127),l=n(6);const d=Object(a.action)("REFRESH_SHARING_TIPS_ATTACHMENT_WELL",(e,t,n,r,a)=>({attachmentWellViewState:e,parentItemId:t,recipientInfo:n,infoBarIds:r,infoBar:a}));var f=n(4448),m=n(4606),h=n(1713);function p(e){const t=e.docViewAttachments.concat(e.imageViewAttachments);return(n=t,n.filter(e=>e.isCloudy).map(e=>(function(e,t){if(1!==e.type)return null;const n=e.model;return{id:e.id,name:n.Name,supportsDownsell:t,currentPermissionLevel:n.PermissionType,sharingInfo:e.info.sharingInfo,sharingRecipientsInfo:{recipientPermissionInfos:[]},sharingTipsIgnored:[],typeOfLink:"referenceAttachment"}})(Object(h.a)(e.attachmentId),e.strategy.isConvertCloudyToClassicSupported))).filter(e=>{var t;return null===(t=e.sharingInfo)||void 0===t?void 0:t.getSharingInfoSucceeded});var n}var b=n(71),O=n(2036),g=n(2101),v=n(1928),I=n(2142);function j(e,t,n,r){return y(e,p(t),n,[],null,r,!0,null)}function y(e,t,n,r,a,i,o,c){let s;for(let u=0;u<e.length;u++){const l=S(e[u],t,n,r,a,i,o,c);l&&(s=l)}if("function"==typeof s){const e=s(null);if((null==e?void 0:e.messageParts)&&e.messageParts.length>0&&"string"==typeof e.messageParts[0])return e.messageParts[0]}else if("object"==typeof s&&s.length>0)return s[0];return null}function S(e,t,n,r,a,i,o,c){const s=i(t,e,n,o,c);return Object(g.a)(a,[e]),s&&(Object(O.a)(a,e,s),r.push(e)),s}Object(a.orchestrator)(d,async e=>{const{attachmentWellViewState:t,parentItemId:n,recipientInfo:r,infoBarIds:a,infoBar:i}=e,o=p(t),c=new b.b("AttachmentRefreshSharingTips"),s=[];y(Object(I.d)(),o,r,s,i,await I.f.import(),!1,e=>{const r=Object(f.a)(t,e);if(r){const e=Object(h.a)(r.attachmentId);return{text:Object(l.b)(u.a),action:()=>{const a=e.model;Object(b.o)("SharingTipsConvertToClassic"),Object(v.f)(r,n.Id,a.AttachLongPathName,a.PermissionType,(e,n,r,a)=>{Object(m.a)(t,e,n,r,a)},1)}}}return null}),function(e,t){const n=Object(I.d)(),r=e.filter(e=>-1!==n.indexOf(e)),a=t.filter(e=>-1===r.indexOf(e)),i=r.filter(e=>-1===t.indexOf(e));0!==a.length&&Object(b.o)("AttachmentSharingTipAdded",a);0!==i.length&&Object(b.o)("AttachmentSharingTipsRemoved",i)}(a,s),Promise.resolve().then(()=>c.end())});Object(a.orchestrator)(c.a,e=>{const{attachmentWell:t,message:n}=e;null!==n&&setTimeout(()=>{Object(c.a)(t,null)},2e3)});var w=n(7150),A=n(1931),C=n(1864);var T=n(2802),P=n(47),E=n(4171),k=n(1738),R=n(3342);const x=Object(a.mutatorAction)("storeAndInitializeAttachment",(e,t,n)=>{const r=!!t.parentItemIdMap;e.IsInline&&!Object(k.a)(e)&&e.ContentId&&""!=e.ContentId&&"unknown"!=e.ContentId.toLowerCase()?t.inlineAttachments.push(Object(v.i)(e.AttachmentId,e.AttachmentId.Id,!0,4)):Object(P.j)("doc-removeCloudyAttachmentsFromWell")&&Object(k.a)(e)?t.deprecatedReferenceAttachments.push(n):Object(T.a)(e)&&!r?t.imageViewAttachments.push(n):t.docViewAttachments.push(n)});var D=Object(b.r)({name:"AttachmentWellInitialization",customData:(e,t,n,r,a,i,o,c,s,u)=>({hasAttachments:e&&e.length>0,isCompose:a}),options:{sessionSampleRate:1}},(function(e,t,n,r,a,i,o,c,s,u){if(!e)return;const l=function(e){return e?Object(v.o)().filter(t=>!e.includes(t)):null}(i);n.isInitialized||e.forEach(e=>{!function(e,t,n,r,a,i,o,c){if("application/x-sharing-metadata-xml"===e.ContentType)return;if(o&&Object(E.a)(e))return;const s=Object(v.h)(Object.assign(Object.assign({},e.AttachmentId),{mailboxInfo:t}),e,n.isReadOnly,!0,r,o,c,null,a,!0);if(x(e,n,s),s.isCloudy){if(!Object(P.j)("doc-removeCloudyAttachmentsFromWell")){const e=Object(h.a)(s.attachmentId);e.requiresFetchingSharingInformation&&i&&Object(v.m)(e)}}else Object(R.a)(n,e.Size)}(e,t,n,r,l,o,s,u)}),F(n,c,l)}));const F=Object(a.mutatorAction)("initializeAttachments",(e,t,n)=>{t&&e.docViewAttachments.forEach(e=>{(function(e){const t=Object(h.a)(e);if(null==t?void 0:t.model){return"IPM.Appointment"===t.model.EmbeddedItemClass}return!1})(e.attachmentId)&&function(e){e.previewMethod=C.a.Unsupported,e.supportedOpenActions=e.supportedOpenActions.filter(e=>e!==A.a.Preview)}(e.strategy)}),e.supportedMenuActions=n,e.isInitialized=!0});var N=n(702),M=Object(N.action)("reinitializeAttachments")((function(e,t,n,r,a,i,o,c,s){e&&(n.docViewAttachments=[],n.imageViewAttachments=[],n.inlineAttachments=[],n.isInitialized=!1,D(e,t,n,r,!1,a,i,o,c,s))})),_=n(5513);function L(e,t){const n=Object(_.a)(!1,void 0===t,e);if(t){const{attachments:e,mailboxInfo:r,parentItemId:a}=t;D(e,r,n,!0,!0,null,a)}return n}var U=n(5940);function B(e,t){const n=Object(_.a)(!0,!1,"");return Object.assign(Object.assign({},n),{parentItemIdMap:e,itemReceivedTimeMap:t,isVisible:!1,maxHeight:0})}var W=n(5283),G=n(1957),V=n(3205);var z=(e,t,n,r)=>{if(e){const{docViewAttachments:a,imageViewAttachments:i,inlineAttachments:o}=e,c=[...a,...i,...o.filter(e=>{const r=Object(h.a)(e.attachmentId);if((null==r?void 0:r.model)&&"HTML"===n){const e=t;return e&&!Object(V.l)(e,r.model)}return!1})];return r?c.filter(e=>Object(G.b)(e.attachmentId.Id)):c.filter(e=>!Object(G.b)(e.attachmentId.Id))}return[]},q=n(2506),H=n(2234),$=n(2255),J=n(7335),K=n(1777),Q=n(2108);async function X(e,t,n,r,a,i,o){const c=await Q.c.import(),s=r.filter(e=>!function(e){return!Object(k.a)(e)&&e.IsInline}(e)).map(c),u=s.filter(e=>e.fileType===K.a.Cloud),l=s.filter(e=>e.fileType===K.a.AttachmentItem);l.length>0&&Y(n,e,t,l,a,!1,!1,i,o),u.length>0&&Y(n,e,t,u,a,!1,!0,i,o)}function Y(e,t,n,r,a,i,o,c,s){const u={isInline:i,isHiddenInline:!1},l=o?Object.assign(Object.assign({},u),{shouldShare:!0}):Object.assign(Object.assign({},u),{shouldShare:!1});Q.f.import().then(i=>{i(e,t,r,a,l,null,c,s,null,n)})}var Z=n(8329),ee=Object(a.mutatorAction)("mergeToConversationAttachmentWell",(function(e,t,n,r){e&&(e.docViewAttachments.forEach(e=>{te(e,t,n,r)}),e.imageViewAttachments.forEach(e=>{te(e,t,n,r)}))}));function te(e,t,n,r){t.parentItemIdMap[e.attachmentId.Id]||(t.docViewAttachments.push(Object.assign({},e)),t.parentItemIdMap[e.attachmentId.Id]=n,t.itemReceivedTimeMap[e.attachmentId.Id]=r)}var ne=Object(a.mutatorAction)("sortConversationAttachmentWell",(function(e,t){e.docViewAttachments=e.docViewAttachments.sort((n,r)=>(t?1:-1)*(new Date(e.itemReceivedTimeMap[n.attachmentId.Id]).getTime()-new Date(e.itemReceivedTimeMap[r.attachmentId.Id]).getTime()))})),re=n(2238),ae=n(1798),ie=n(2975),oe=n(3303);function ce(e,t,n){if(Object(h.a)(t.attachmentId)&&e.imageViewAttachments.indexOf(t)>=0){Object(oe.a)(e,t,!1,!1),Object(ae.o)(t.attachmentId,n),Object(ae.p)(t.attachmentId,!0);const r=Object(re.b)(t.attachmentId,1);Object(ie.a)(t.attachmentId,r);const a=Object(v.i)(t.attachmentId,t.attachmentId.Id,!1);a.status=3,s(e,a)}}var se=n(7153),ue=n(5639);function le(e){return Object(P.j)("doc-attachment-useUpsellForLargeFiles")&&e?e:{shouldShare:!0,shareProperties:{folderInfo:{identifierType:1,identifier:ue.a}}}}n.d(t,"refreshSharingTipsAttachmentWell",(function(){return d})),n.d(t,"addAttachmentIntoWellBeforeUpload",(function(){return w.a})),n.d(t,"initializeAttachments",(function(){return D})),n.d(t,"reinitializeAttachments",(function(){return M})),n.d(t,"getAttachmentWellForCompose",(function(){return L})),n.d(t,"getAttachmentWellInitialValue",(function(){return _.a})),n.d(t,"getAvailableLocalAttachmentSize",(function(){return U.a})),n.d(t,"getConversationAttachmentWellInitialValue",(function(){return B})),n.d(t,"getMaxClassicAttachmentsSize",(function(){return W.a})),n.d(t,"getAllValidAttachments",(function(){return z})),n.d(t,"createAttachmentFullViewStateAndStoreBackingModel",(function(){return q.a})),n.d(t,"setInlineAttachmentStatus",(function(){return H.a})),n.d(t,"createAttachmentFullViewState",(function(){return $.a})),n.d(t,"createAttachmentsViaQueueManager",(function(){return J.a})),n.d(t,"deleteAttachmentViaQueueManager",(function(){return J.b})),n.d(t,"createAttachmentsFromRecentAttachments",(function(){return X})),n.d(t,"createAttachmentFileFromExistingMailboxAttachment",(function(){return Z.a})),n.d(t,"mergeToConversationAttachmentWell",(function(){return ee})),n.d(t,"sortConversationAttachmentWell",(function(){return ne})),n.d(t,"convertImageViewAttachmentToInlineAttachment",(function(){return ce})),n.d(t,"getLastCloudyAttachmentsSharingIssueForBlockOnSend",(function(){return j})),n.d(t,"uploadLocalFile",(function(){return se.a})),n.d(t,"getShouldShareAttachmentProperties",(function(){return le}))},402:function(e,t,n){"use strict";var r=n(565),a=n(570);t.a=function(e){return null!=e&&Object(a.a)(e.length)&&!Object(r.a)(e)}},4171:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2035);const a=(e,t)=>e.substring(0,t.length)===t,i=(e,t)=>e.substring(e.length-t.length)===t,o=e=>e.ContentType&&(a(e.ContentType,r.s)||a(e.ContentType,r.j)),c=e=>e.ContentType&&e.ContentType===r.h;function s(e){return(null==e?void 0:e.Name)&&i(e.Name,r.q)&&(o(e)||c(e))}},4188:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));const r=1024,a=1048576,i="Not support special characters"},434:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},435:function(e,t,n){"use strict";var r=n(3),a=n(16);t.a=Object(r.createStore)("OWAClientIdStore",{userMailboxInfoMap:new a.ObservableMap})},4448:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(225);function a(e,t){let n=e.docViewAttachments.filter(e=>Object(r.e)(e.attachmentId,t));return 0===n.length&&(n=e.imageViewAttachments.filter(e=>Object(r.e)(e.attachmentId,t))),0===n.length?null:n[0]}},446:function(e,t,n){(function(e,r){var a;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r&&r;o.global!==o&&o.window!==o&&o.self;var c,s=2147483647,u=36,l=1,d=26,f=38,m=700,h=72,p=128,b="-",O=/^xn--/,g=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},j=u-l,y=Math.floor,S=String.fromCharCode;function w(e){throw new RangeError(I[e])}function A(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function C(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+A((e=e.replace(v,".")).split("."),t).join(".")}function T(e){for(var t,n,r=[],a=0,i=e.length;a<i;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<i?56320==(64512&(n=e.charCodeAt(a++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),a--):r.push(t);return r}function P(e){return A(e,(function(e){var t="";return e>65535&&(t+=S((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=S(e)})).join("")}function E(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function k(e,t,n){var r=0;for(e=n?y(e/m):e>>1,e+=y(e/t);e>j*d>>1;r+=u)e=y(e/j);return y(r+(j+1)*e/(e+f))}function R(e){var t,n,r,a,i,o,c,f,m,O,g,v=[],I=e.length,j=0,S=p,A=h;for((n=e.lastIndexOf(b))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&w("not-basic"),v.push(e.charCodeAt(r));for(a=n>0?n+1:0;a<I;){for(i=j,o=1,c=u;a>=I&&w("invalid-input"),((f=(g=e.charCodeAt(a++))-48<10?g-22:g-65<26?g-65:g-97<26?g-97:u)>=u||f>y((s-j)/o))&&w("overflow"),j+=f*o,!(f<(m=c<=A?l:c>=A+d?d:c-A));c+=u)o>y(s/(O=u-m))&&w("overflow"),o*=O;A=k(j-i,t=v.length+1,0==i),y(j/t)>s-S&&w("overflow"),S+=y(j/t),j%=t,v.splice(j++,0,S)}return P(v)}function x(e){var t,n,r,a,i,o,c,f,m,O,g,v,I,j,A,C=[];for(v=(e=T(e)).length,t=p,n=0,i=h,o=0;o<v;++o)(g=e[o])<128&&C.push(S(g));for(r=a=C.length,a&&C.push(b);r<v;){for(c=s,o=0;o<v;++o)(g=e[o])>=t&&g<c&&(c=g);for(c-t>y((s-n)/(I=r+1))&&w("overflow"),n+=(c-t)*I,t=c,o=0;o<v;++o)if((g=e[o])<t&&++n>s&&w("overflow"),g==t){for(f=n,m=u;!(f<(O=m<=i?l:m>=i+d?d:m-i));m+=u)A=f-O,j=u-O,C.push(S(E(O+A%j,0))),f=y(A/j);C.push(S(E(f,0))),i=k(n,I,r==a),n=0,++r}++n,++t}return C.join("")}c={version:"1.4.1",ucs2:{decode:T,encode:P},decode:R,encode:x,toASCII:function(e){return C(e,(function(e){return g.test(e)?"xn--"+x(e):e}))},toUnicode:function(e){return C(e,(function(e){return O.test(e)?R(e.slice(4).toLowerCase()):e}))}},void 0===(a=function(){return c}.call(t,n,t,e))||(e.exports=a)}()}).call(this,n(369)(e),n(190))},4463:function(e,t,n){"use strict";var r=n(3561),a=n(20);const i=new a.c(()=>Promise.all([n.e(15),n.e(40),n.e(48),n.e(132),n.e(399)]).then(n.bind(null,19926))),o=new a.b(i,e=>e.addSearchRequestInstrumentation),c=new a.b(i,e=>e.addResourceTimingEntry),s=new a.b(i,e=>e.searchDiagnostics),u=()=>{const e=s.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c}))},4467:function(e,t,n){"use strict";var r=n(2101);const a=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function i(e){e&&Object(r.a)(e,a)}n.d(t,"a",(function(){return i}))},447:function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},4535:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="special/attachments"},4606:function(e,t,n){"use strict";var r=n(3342),a=n(3303),i=n(1798),o=n(36),c=n(702),s=Object(c.action)("replaceAttachmentInWell")((function(e,t,n,c){let s=e.docViewAttachments.indexOf(t);s>-1?(Object(a.a)(e,t),e.docViewAttachments.splice(s,0,n)):(s=e.imageViewAttachments.indexOf(t))>-1?(Object(a.a)(e,t),e.imageViewAttachments.splice(s,0,n)):o.d("Can't find the oldAttachment when invoking replaceAttachmentInWell"),n.isCloudy||Object(r.a)(e,c),Object(i.n)(n.attachmentId)})),u=n(1928);function l(e,t,n,r,a){const i=Object(u.h)(Object.assign(Object.assign({},n.AttachmentId),{mailboxInfo:t.attachmentId.mailboxInfo}),n,r,a,!0,!1,!1,null,null,!1);s(e,t,i,n.Size)}n.d(t,"a",(function(){return l}))},4940:function(e,t,n){"use strict";t.a={AttachmentCreationClassicFromLocalFile:{name:"AttachmentCreationClassicFromLocalFile",customData:(e,t,n,r,a)=>r?[r.size]:[0]},AttachmentCreationFromRecentAttachment:{name:"AttachmentCreationFromRecentAttachment",customData:(e,t,n,r,a,i)=>[(null==r?void 0:r.size)||0,null==r?void 0:r.fileType]},AttachmentCreationCloudyFromLocalFile:{name:"AttachmentCreationCloudyFromLocalFile"},AttachmentDeletionAction:{name:"AttachmentDeletionAction",customData:(e,t,n,r)=>({generatedAttachmentId:t.attachmentId.Id}),cosmosOnlyData:(e,t,n,r)=>JSON.stringify({attachmentId:t.attachmentId.Id,fileType:r}),options:{isCore:!0}}}},516:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(132),a=n(13);function i(){return Object(r.a)("acctmonaccounts")&&Object(a.i)("acctmonaccounts")}},519:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(57),a=n(435);let i=void 0;function o(e){i=e}function c(e,t){if(i&&!t){const t=i(e);if(t)return t}const n=Object(a.a)().userMailboxInfoMap;if(!n||!n.get(e)){let t=!1;e&&(t=e!=Object(r.b)());let a={type:"UserMailbox",userIdentity:t?e:Object(r.b)(),mailboxSmtpAddress:t?e:Object(r.c)()};return n.set(e,a),a}return n.get(e)}},5248:function(e,t,n){"use strict";var r=n(3);const a={uploadFolders:new(n(16).ObservableMap)},i=Object(r.createStore)("attachmentsUploadFolderStore",a);var o,c=n(57);!function(e){e.User="User",e.Group="Group"}(o||(o={}));const s=Object(r.action)("preloadUploadFolder",(e=Object(c.g)().SessionSettings.UserEmailAddress,t=o.User)=>({mailboxId:e,uploadFolderMailboxType:t})),u=Object(r.action)("uploadFolderLoaded",(e,t)=>({mailboxId:e,uploadFolder:t}));Object(r.mutator)(u,e=>{const{mailboxId:t,uploadFolder:n}=e;i().uploadFolders.set(t,n)});var l=n(5697),d=n(6),f=n(282),m=n(703);const h="Email attachments";function p(e){switch(e){case o.Group:return h;case o.User:return Object(d.b)(l.a);default:return Object(f.a)(e)}}var b=n(35);var O=n(1735);function g(e,t){switch(t){case o.Group:const n=new Headers;return Object(O.f)(e,n),n;case o.User:return null;default:return Object(f.a)(t)}}function v(e=Object(c.g)().SessionSettings.UserEmailAddress){return i().uploadFolders.get(e)||null}var I=n(36);async function j(e=null,t=o.User){e=e||Object(c.g)().SessionSettings.UserEmailAddress;try{const a=v(e);if(a)return a;const i=function(e,t,n){return{mailboxId:e,folderId:n.FolderId,folderName:Object(m.a)(n.FolderName)?p(t):n.FolderName}}(e,t,await(n={},r={headers:g(e,t)},Object(b.a)("GetAttachmentDataProviderUploadFolderProps",n,r)));return u(e,i),i}catch(n){return I.h.warn("fetchUploadFolder got error: "+n.message),function(e,t){return{mailboxId:e,folderId:null,folderName:p(t)}}(e,t)}var n,r}Object(r.orchestrator)(s,async e=>{const{mailboxId:t,uploadFolderMailboxType:n}=e;v(t)||await j(t,n)}),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return o}))},5283:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(4188),a=n(16),i=n(38);const o=25*r.b;function c(){return s.get()}const s=Object(a.computed)(()=>{const e=Object(i.a)();return e&&e.SessionSettings?(e.SessionSettings.MaxMessageSizeInKb-2048)*r.a:o})},5513:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(5283);let a;function i(e,t,n){return a||(a=Object(r.a)()),{composeId:n,allowShowMultipleRows:!e,didViewOverflowOneRow:!1,canOverrideAllowShowMultipleRows:!0,docViewAttachments:[],imageViewAttachments:[],inlineAttachments:[],deprecatedReferenceAttachments:[],isInitialized:t,isReadOnly:e,groupId:null,maxTotalClassicAttachmentSize:a,totalClassicAttachmentSize:0,saveAllToCloudStatus:0,supportedMenuActions:null,sharingLinkIds:[],announcedComponentMessage:null}}},5639:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(20),a=n(4535);n.d(t,"a",(function(){return a.a}));const i=new r.c(()=>Promise.all([n.e(0),n.e(4),n.e(12),n.e(15),n.e(384)]).then(n.bind(null,8510))),o=new r.b(i,e=>e.showAttachmentFolderPicker);new r.b(i,e=>e.initializeAttachmentFolderPicker)},565:function(e,t,n){"use strict";var r=n(347),a=n(252),i="[object AsyncFunction]",o="[object Function]",c="[object GeneratorFunction]",s="[object Proxy]";t.a=function(e){if(!Object(a.a)(e))return!1;var t=Object(r.a)(e);return t==o||t==c||t==i||t==s}},568:function(e,t,n){"use strict";t.a=function(e){return e}},5697:function(e){e.exports=JSON.parse('{"a":"Eca"}')},570:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},5705:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("updateChangeKeyOnItemId")((function(e,t){e.ChangeKey=t}))},578:function(e,t,n){"use strict";var r=n(328),a=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=a},5887:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"CreateAttachmentJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},5940:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(71);function a(e){const t=e.maxTotalClassicAttachmentSize-e.totalClassicAttachmentSize;return t<0?(Object(r.o)("AttachmentSizeReachedMax",{},{isCore:!0}),0):t}},5981:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"AttachmentItemsPagingDetails:#Exchange"},e)}var a=n(1796),i=n(35);function o(e){return Object.assign({__type:"SearchAttachmentDataProviderItemsRequest:#Exchange"},e)}var c=n(36);function s(e,t,n,r){return e?n(e):(c.h.warn(null==t?void 0:t.statusText),404===(null==t?void 0:t.status)?r(4):401===(null==t?void 0:t.status)||403===(null==t?void 0:t.status)?r(2):r(1))}const u=Object.freeze({SortColumn:2,SortOrder:1}),l="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",d="GDriveDataProviderItem:#Exchange",f="FileAttachmentDataProviderItem:#Exchange",m="FolderAttachmentDataProviderItem:#Exchange",h="OneDriveProScope:#Exchange",p="OneDriveItemSkipTokenPagingMetadata:#Client",b="OneDriveConsumerScope:#Exchange",O="oneNote",g="application/onenote";var v=n(2199);function I(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map(e=>t(e))}}function j(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}const y="application/vnd.google-apps.folder";function S(e){return{__type:d,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===y?1:0}}function w(e){return Object.assign(Object.assign({},I(e.files,S)),{NextPageToken:e.nextPageToken})}function A(e){return Object.assign(Object.assign({},j(e)),{NextPageToken:null})}async function C(e,t=!1){const{errorResponse:n,result:r}=await Object(v.k)(e,t);return r?s(r,null,w,A):s(null,n,w,A)}var T=n(6283),P=n(3448);function E(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function k(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:E(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}const R=e=>I(e,k);var x=n(326),D=n(261),F=n(1704),N=n(1689),M=n(4463),_=n(1981),L=n(1914);const U=200;async function B(e){if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");const t=Object(N.d)(N.a.FilesPicker);Object(T.a)(t.nextSearchQueryId,N.a.FilesPicker),Object(P.a)(Object(x.a)(),N.a.FilesPicker);const n=Object(D.b)(),r={Cvid:Object(x.a)(),Scenario:{Name:_.c.MailEmailAttachmentPicker},TimeZone:Object(_.A)(n),TextDecorations:"Off",EntityRequests:W(e)},a=new Date,i=await Object(_.J)(r,t.searchSessionGuid);if(!i||2!=i.length){return c.h.warn("3S Response for search mail messages failed"),s(null,{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null},R,j)}const o=i[0].status==U,u=o?null:i[0].statusText,l=function(e,t,n,r,a,i,o){if(!e||2!=e.length)return null;const c=Object(_.f)(e[0],t,n,"SubstrateSearch",r,new Date,a.currentSearchQueryId,new Headers(e[1]),0,_.c.MailEmailAttachmentPicker);return c.ClientJSPreRequestTime=i,c.ClientJSRequestThreadTime=o,Object(F.ab)(c.SearchTraceID,N.a.FilesPicker,!1),M.d.import().then(e=>e(c)),L.j.importAndExecute(c.SearchTraceID,c.ClientNetworkTime,c.ClientHttpStatus,new Date),c}(i,e,u,a,t,0,0);if(o){const e=await i[0].json(),t=function(e,t){if(e&&e.Results&&0!==e.Results.length){const n=[],r=e.Results;for(const e of r){const r=Object(_.n)(e.Source,t);r.InstanceKey=e.ReferenceId,n.push(r)}return n}return[]}(Object(_.x)(e),r);return L.l.importAndExecute(l.SearchTraceID,new Date,_.c.MailEmailAttachmentPicker),s(t,null,R,j)}{c.h.warn(`3S Response for search mail messages failed with ${u}`);const e={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:u,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null};return L.i.importAndExecute(l.SearchTraceID,_.c.MailEmailAttachmentPicker),s(null,e,R,j)}}function W(e){return[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:e},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}]}function G(e,t,n,c,s,d=null,f){if(5===e)return async function(e,t=""){let n=`${l}&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '${e}'`;return t&&(n=`${n} and '${t}' in parents`),C(n)}(n,s);if(10===e)return B(n);const m=o({AttachmentDataProviderId:t,Query:n,Paging:r({Sort:f||(h=u,Object.assign({__type:"AttachmentItemsSort:#Exchange"},h)),FolderId:c,Location:s,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:d})});var h,p,b;return void 0===(p={request:m}).request||p.request.__type||(p.request=o(p.request)),Object(i.a)("SearchAttachmentDataProviderItems",p,b)}var V=n(71),z=n(2118),q=n(47),H=n(6);function $(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"GetAttachmentDataProviderItemsRequest:#Exchange"},n))),Object(i.a)("GetAttachmentDataProviderItems",e,t)}var J=n(2279);function K(e){return null!==e&&e.__type===h}function Q(e){return e&&e.__type===p}function X(e,t){return 1===e&&t&&function(e){return null!==e&&e.__type===b}(t)?t.Type:null}function Y(e,t){return 0===e&&t&&K(t)?t.Type:null}async function Z(e,t){const n=[e];try{const r=await Object(J.c)(e,!1,t);return!Object(H.k)(r)||(Object(V.o)("FPAccessTokenUnavailable",n),!1)}catch(e){return Object(V.o)("FPAccessTokenUnavailable",n),!1}}async function ee(e,t,n){switch(e){case 3:case 2:case 6:return Z(e,void 0);case 5:case 10:return!0;case 0:return(0===Y(e,n)||4===Y(e,n))&&Z(e,t);case 1:return 4===X(e,n)||Object(q.j)("doc-odcgetitems");default:return!1}}function te(e){return e.__type===m||1===e.Type}function ne(e){const t=e.filter(te),n=e.filter(e=>!te(e));return t.concat(n)}var re=n(282);function ae(e,t,n){let r=null,a=null;switch(e){case"asc":[r,a]=[t,n];break;case"desc":[r,a]=[n,t];break;default:Object(re.a)(e)}return r<a?-1:r>a?1:0}function ie(e,t,n){switch(t){case 2:e.sort((e,t)=>{const r=e.Modified,a=t.Modified,i=r?new Date(r):new Date(0),o=a?new Date(a):new Date(0);return ae(0===n?"asc":"desc",i,o)});break;case 1:e.sort((e,t)=>{const r=e.Size||0,a=t.Size||0;return 0===n?r-a:a-r});break;default:e.sort((e,t)=>{const r=e.Name.toLowerCase(),a=t.Name.toLowerCase();return ae(0===n?"asc":"desc",r,a)})}}function oe(e){return{__type:Object(v.q)(e)?m:f,Id:e.id,AttachmentProviderId:null,Location:`${t=e.path_collection,`/${(t.entries||[]).map(e=>e.name).join("/")}`}/${e.name}`,Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(v.q)(e)?1:0};var t}const ce=e=>I(e,oe);function se(e){return{__type:Object(v.t)(e)?m:f,Id:Object(v.r)(e)?null:e.id,AttachmentProviderId:null,Location:Object(v.r)(e)?"":e.path_lower,Modified:Object(v.s)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(v.s)(e)?e.size:0,Type:Object(v.t)(e)?1:0}}const ue=e=>I(e,se);function le(e){return e.file?e.file.mimeType:e.package&&e.package.type===O?g:null}function de(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function fe(e,t){return 1===t?e.parentReference?`${e.parentReference.path}/${e.name}`:null:e.webDavUrl}function me(e,t,n,r,a,i){let o=void 0;if(a)switch(r){case 0:o=he(e,a,i);break;case 1:if(Object(q.j)("doc-odcgetitems")){o=he(e,a,i);break}throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(re.a)(r)}let c=e.length;return a&&o?c=o.totalItemsFetched+1:o&&(c=o.totalItemsFetched),{TotalItemCount:c,ResultCode:0,Items:e.map(e=>(function(e,t,n,r){var a,i,o;const[c,s,u,l,d]=e.folder?[m,null,e.folder.childCount,1,0]:[f,le(e),0,0,e.size];return{__type:c,Id:e.id,Name:e.name,Size:d,Thumbnail:{Url:(null===(i=null===(a=e.thumbnails)||void 0===a?void 0:a[0])||void 0===i?void 0:i.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(o=e.lastModifiedBy)||void 0===o?void 0:o.user)?e.lastModifiedBy.user.displayName:null,MimeType:s,Location:fe(e,r),ProviderEndpointUrl:t,ChildCount:u,AttachmentProviderId:n,ProviderType:r,Type:l}})(e,t,n,r)),PagingMetadata:o}}function he(e,t,n){const r=n?n.totalItemsFetched+e.length:e.length;return a={skipToken:t,totalItemsFetched:r},Object.assign(Object.assign({},a),{__type:"OneDriveItemSkipTokenPagingMetadata:#Client"});var a}async function pe(e,t,n,r,a,i,o,c=null){const u=c?{maxEntries:c.maxEntries,skipToken:c.metadata?c.metadata.skipToken:null}:null,{errorResponse:l,result:{items:d,skipToken:f}}=await Object(v.m)(t,n,a,i,o,void 0,u);return function(e,t,n,r,a,i,o){return t?s(t,null,e=>me(e,n,r,a,i,o),de):s(null,e,e=>me(e,n,r,a,i,o),de)}(l,d,e,r,n,f,c?c.metadata:null)}const be="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";var Oe=n(1709),ge=n(296);async function ve(e,t,n,r=!1){const{errorResponse:a,result:i}=await Object(v.n)(e,n,r);return i?s(i.value,null,r=>Ie(r,e,t,n),de):s(null,a,r=>Ie(r,e,t,n),de)}function Ie(e,t,n,r){const a=function(e,t,n,r){const a=[];return e.forEach(e=>{const i=function(e,t,n,r){var a,i,o;if(!Object(ge.a)()&&".fluid"===Object(Oe.a)(e.name))return null;return{__type:f,Id:e.remoteItem.id?e.remoteItem.id:e.id,Name:e.name,Size:e.remoteItem.size,Modified:null===(a=e.remoteItem.fileSystemInfo)||void 0===a?void 0:a.lastAccessedDateTime,ModifiedBy:null===(o=null===(i=e.remoteItem.lastModifiedBy)||void 0===i?void 0:i.user)||void 0===o?void 0:o.displayName,MimeType:je(e),Location:e.remoteItem.webDavUrl,ProviderEndpointUrl:we(e)?null:t,ChildCount:0,AttachmentProviderId:n,ProviderType:r,Type:0}}(e,t,n,r);i&&a.push(i)}),a}(e,t,n,r);return{TotalItemCount:a.length,ResultCode:0,Items:a,PagingMetadata:null}}function je(e){var t;return e.remoteItem.file?e.remoteItem.file.mimeType:(null===(t=e.package)||void 0===t?void 0:t.type)===O?g:null}const ye=(e,t)=>e.substring(0,t.length)===t,Se="https://";function we(e){return!!e.remoteItem.webDavUrl&&!!ye(e.remoteItem.webDavUrl.toLowerCase(),Se)}const Ae=(Ce={Type:0,DisplayName:"Files",AriaLabel:"Files"},Object.assign({__type:"OneDriveProScope:#Exchange"},Ce));var Ce;async function Te(e,t,n,i,o=null,l=null,d,f,m=null,h,p=null,b=!1){try{const c=await ee(e,l,o);let O,g=!1;if(c)if(1===e){if(4===X(e,o)){g=!0;try{O=await ve(l,t,e)}catch(e){Object(V.o)("OneDriveConsumerMRUError",{info:e.message})}}else if(Object(q.j)("doc-odcgetitems")&&0===X(e,o)){if(m&&!Q(m))throw new Error("The paging metadata is not of type OneDriveItemsSkipTokenPagingMetadata");g=c;try{O=await async function(e,t,n,r,a=null){return pe(v.d,v.d,1,e,t,n,r,a)}(t,h?h.SortColumn:u.SortColumn,h?h.SortOrder:u.SortOrder,d,{metadata:m,maxEntries:100})}catch(e){}}}else if(5===e)g=!0,O=await C(function(e,t){let n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");const r=t&&0===t.SortOrder?"asc":"desc";return`${be}&orderBy=folder,${n} ${r}&q=mimeType!="application/octet-stream" and trashed=false and "${e||"root"}" in parents`}(f,h));else if(2===e){const e=h?h.SortColumn:u.SortColumn,t=h?h.SortOrder:u.SortOrder;g=!0;try{O=await async function(e,t,n){const{errorResponse:r,result:a}=await Object(v.i)({path:e});if(a){const e=s(a,null,ue,j);return ie(e.Items,t,n),e.Items=ne(e.Items),e}return s(null,r,ue,j)}(f,e,t)}catch(e){}}else if(3===e){const e=h?h.SortColumn:u.SortColumn,t=h?h.SortOrder:u.SortOrder;g=!0;try{O=await async function(e,t,n){const{errorResponse:r,result:a}=await Object(v.g)(e);if(a){const e=s(a,null,ce,j);return ie(e.Items,t,n),e.Items=ne(e.Items),e}return s(null,r,ce,j)}(d,e,t)}catch(e){}}else 10===e&&(g=!0,O=await async function(e,t){const{errorResponse:n,result:r}=await Object(v.l)(e,t);return r?s(r,null,R,j):s(null,n,R,j)}(d,n));if(0===Y(e,o)){if(m&&!Q(m))throw new Error("The paging metadata is not of type OneDriveItemsSkipTokenPagingMetadata");g=c;try{O=await async function(e,t,n,r,a,i=null){const o=new URL(e);return pe(e,`${o.protocol}//${o.host}`,0,t,n,r,a,i)}(l,t,h?h.SortColumn:u.SortColumn,h?h.SortOrder:u.SortOrder,d,{metadata:m,maxEntries:100})}catch(e){}}if(4===Y(e,o)){g=!0;try{O=await ve(l,t,e,b)}catch(e){Object(V.o)("OneDriveProMRUError",{info:e.message})}}if(O&&0===O.ResultCode)return Object(V.o)("FPgetItemsClientCall",[!0,e]),O;g&&Object(V.o)("FPgetItemsClientCall",[!1,e]);let I=null,y=function(e,t){if(4===Y(e,t)||4===X(e,t)){const e=new V.b("getOneDriveMRUItemsDataProvider");return e.addCustomData({IsViaServer:!0}),e}return null}(e,o);try{return I=await async function e(t,n,i,o,c,s,l,d,f,m){const h={AttachmentDataProviderId:t,Paging:r({Sort:m||u,FolderId:c||"",Location:l||"",ItemsEndpointUrl:s||"",FilterBy:i,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:n,MaxEntriesReturned:100}),PagingMetadata:f}),Scope:null==d?Ae:d};let p=await $({request:h});if(Object(q.j)("doc-authContext")&&!o&&p&&!Object(H.k)(p.ClaimsChallenge)){try{const e=await z.a.import();await e(p.ClaimsChallenge)}catch(e){return p}p=await e(t,n,i,!0,c,s,l,d,f,m);const r=p&&Object(H.k)(p.ClaimsChallenge);return Object(V.o)("getFileProviderItemsAfterReAuth",{isSuccess:r}),p}return p}(t,n,i,b,d,p,f,o,m,h),y&&y.end(),I}catch(e){throw y&&y.endWithError("ClientError"),e}}catch(e){throw c.h.warn("FilePicker: getFileProviderItems got error: "+e.message),e}}n.d(t,"f",(function(){return G})),n.d(t,"b",(function(){return Te})),n.d(t,"a",(function(){return ee})),n.d(t,"e",(function(){return K})),n.d(t,"d",(function(){return Q})),n.d(t,"c",(function(){return le}))},6053:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"CreateAttachmentRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6083:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Item:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6097:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemIdAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},614:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(132),a=n(13);function i(){return Object(r.a)("acctmonaccounts")&&Object(a.i)("acctmonaccounts")}function o(){return i()||!Object(r.a)("acctmonaccounts")&&Object(a.i)("accountsapi")}},618:function(e,t,n){"use strict";function r(e,t){for(var n,r=/\r\n|[\n\r]/g,a=1,i=t+1;(n=r.exec(e.body))&&n.index<t;)a+=1,i=t+1-(n.index+n[0].length);return{line:a,column:i}}n.d(t,"a",(function(){return r}))},6283:function(e,t,n){"use strict";var r=n(3),a=n(1689);t.a=Object(r.mutatorAction)("setCurrentSearchQueryId",(e,t)=>{Object(a.d)(t).currentSearchQueryId=e})},6458:function(e){e.exports=JSON.parse('{"a":"lfa"}')},6461:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("setAnnouncedComponentMessage",(e,t)=>({attachmentWell:e,message:t}))},6468:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ReferenceAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6597:function(e,t,n){"use strict";var r=n(71),a=n(4940),i=n(3303),o=n(5705),c=n(705);const s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteAttachmentFromDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AttachmentIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAttachmentFromDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"AttachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"RootItemId"}}]}}]}}]};n.d(t,"b",(function(){return l}));t.a=Object(r.r)(a.a.AttachmentDeletionAction,(async function(e,t,n,r){const a=await u(t.attachmentId,n);Object(i.a)(e,t),Object(o.a)(n,a.RootItemId.RootItemChangeKey)}));const u=async function(e,t,n){var r;const a=Object(c.a)(),i=await a.mutate({variables:{attachmentId:{Id:e.Id,mailboxInfo:e.mailboxInfo,RootItemId:e.RootItemId||t.Id,RootItemChangeKey:e.RootItemChangeKey}},context:{requestOptions:n},mutation:s});return null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.deleteAttachmentFromDraft},l={invokeDeleteAttachmentFromDraftMutation:u}},6742:function(e,t,n){"use strict";var r=n(1905),a=n(1713),i=n(2916),o=n(47),c=n(702);t.a=Object(c.action)("setAttachmentPermissionLevel")((function(e,t,n,c){const s=Object(a.a)(e),u=s.model;u.PermissionType=t,n&&(u.AttachLongPathName=n,s.openUrl=Object(i.a)(u)),Object(o.j)("doc-attachment-referenceAttachmentExpiration")&&s.info&&s.info.sharingInfo&&(s.info.sharingInfo.expirationDate=c),Object(r.a)(e)}))},703:function(e,t,n){"use strict";function r(e){return null==e||0==e.trim().length}n.d(t,"a",(function(){return r}))},704:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},705:function(e,t,n){"use strict";var r=n(567),a=n(964),i=n(953);let o=!0;const c=()=>{o=!1},s=()=>({Query:{fields:{userConfiguration:{read(e,{args:t,toReference:n}){if(e)return e;if(o){const e=!0;return n(Object(i.a)(null==t?void 0:t.id),e)}return n({__typename:"UserConfiguration",id:t.id})}}}},UserConfiguration:{fields:{ApplicationSettings:{merge:!0},AttachmentPolicy:{merge:!0},Favorites:{merge:!0},MasterCategoryList:{merge:!0},PolicySettings:{merge:!0},PrimeSettings:{merge:!0},SafetyUserOptions:{merge:!0},SegmentationSettings:{merge:!0},SessionSettings:{merge:!0},SmimeAdminSettings:{merge:!0},TenantThemeData:{merge:!0},UserOptions:{merge:!0},ViewStateConfiguration:{merge:!0}}}});var u=n(921);var l=n(71);const d="ApolloNotInitialized";let f=null,m=null;function h(){if(!f){const e=new Error(d);throw e.addQueue=!0,e}return f}function p(e){if(!f)return Object(l.o)(d,{s:e,cs:(new Error).stack}),m}function b({lazyLinks:e,context:t}){return m=e.then(e=>(f=function({links:e,context:t}){const n={watchQuery:{fetchPolicy:"no-cache"},query:{fetchPolicy:"no-cache"}},i=s(),o=new r.ApolloClient({cache:new r.InMemoryCache({possibleTypes:a.a,typePolicies:Object(u.a)(i)}),defaultOptions:n});return t.client=o,o.setLink(r.ApolloLink.from(e)),o}({links:e,context:t}),f)),m}var O=n(0);function g(e){return()=>O.createElement(r.ApolloProvider,{client:h()},e())}n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return c}))},709:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},711:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(190))},713:function(e,t,n){"use strict";var r=n(718),a=n.n(r);let i,o;async function c(){try{i||(i=fetch(a.a));const e=await i;return o||(o=e.text()),o}catch(e){throw i=void 0,o=void 0,e}}function s(e){return e}n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return"DefaultUserConfig"})),n.d(t,"b",(function(){return c}))},714:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));var r="function"==typeof Symbol&&null!=Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Symbol&&null!=Symbol.asyncIterator?Symbol.asyncIterator:"@@asyncIterator",i="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag"},715:function(e,t,n){"use strict";var r=n(315);const a=n.n(r)()("Profile",{profileId:"",profileName:"",accountSources:[]});t.a=a},7150:function(e,t,n){"use strict";var r=n(3342),a=n(2413),i=n(2802),o=n(702),c=n(1928);t.a=Object(o.action)("addAttachmentIntoWellBeforeUpload")((function(e,t,n,o,s=null){let u;n.AttachmentId=o,Object(a.a)([{attachmentId:Object.assign(Object.assign({},n.AttachmentId),{mailboxInfo:o.mailboxInfo}),attachment:n,modelInitializationValues:s}],!1,!0,!0),Object(c.s)(e)?(t.inlineAttachments.push(e),u=!0):(e.isPlaceholderAttachment=!0,Object(i.a)(n)?t.imageViewAttachments.push(e):t.docViewAttachments.push(e)),!u&&e.isCloudy||Object(r.a)(t,n.Size)}))},7151:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(7152),a=n(6),i=n(36),o=n(4188),c=n(5940),s=n(2036);function u(e,t,n){let u=0;for(let t,n=0;t=e[n];n++)u+=t.size;const l=Object(c.a)(t);if(u>l){const t=Math.floor(l/o.b);let i,c;return e.length>1?(c="ErrorTooLargeForLocalAttachmentMultiple",i=Object(a.c)(Object(a.b)(r.a),t)):(c="ErrorTooLargeForLocalAttachmentSingle",i=Object(a.c)(Object(a.b)(r.b),t)),Object(s.a)(n,c,[i]),!0}return i.h.info("Attachment: TotalSize = "+Math.floor(t.totalClassicAttachmentSize/1048576)),!1}},7152:function(e){e.exports=JSON.parse('{"a":"pea","b":"qea"}')},7153:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(282),a=n(2199),i=n(1971),o=n(296);function c(e,t,n,r){const c=Object(o.a)()?1:0,u=Object(i.h)(),[l]=u.filter(e=>e.type===c);if(!l)throw new Error("Unable to upload file as couldnt find OneDrive provider");const{model:{EndPointUrl:d}}=l,f={fileToUpload:{fileName:e,fileBlob:t},conflictBehavior:"rename",folderInfo:s(n),onProgress:r};return[1===c?Object(a.u)(1,a.d,f):Object(a.u)(0,d,f),l]}function s(e){const{identifierType:t,identifier:n}=e;switch(t){case 0:return{type:0,identifier:n};case 1:return{type:1,identifier:n};default:return Object(r.a)(t)}}},718:function(e,t,n){e.exports=n.p+"../resources/graphql/schema.all.min-bceb7e9db1d7169983b4eed839783dbc.graphql"},727:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return s}));var r=n(4);const a=new r.b(()=>n.e(850).then(n.bind(null,1569)));let i=new r.a(a,e=>e.initOwaAccountSourceListStore),o=new r.a(a,e=>e.addConnectedAccount),c=new r.a(a,e=>e.removeConnectedAccount),s=new r.a(a,e=>e.updateConnectedAccountState)},7335:function(e,t,n){"use strict";var r=n(7607),a=n(6),i=n(2377),o=n(2378),c=n(4467),s=n(71),u=n(282),l=n(1713),d=n(1696),f=n(8326),m=n(7151);var h=n(7150),p=n(1928),b=n(36),O=n(702),g=n(1761),v=n(1798),I=n(6742),j=n(2264);var y=n(3303),S=n(6461),w=n(5705),A=n(9891);function C(e,t,n,r,i,o,c){Object(S.a)(c,Object(a.b)(A.a)),Object(p.E)(e,t,n,r,o),Object(w.a)(i,r.AttachmentId.RootItemChangeKey),function(e,t,n){n&&0===n.ResultCode&&0===e.attachmentType&&(n.CanShareInternally||Object(j.e)(t.PermissionType)||(Object(s.o)("AttachmentsCanNotShareInternally"),Object(I.a)(e.attachmentId,0)),Object(v.n)(t.AttachmentId))}(e,n,o)}function T(e,t,n,r){let a=!0;1===e.attachmentType&&(Object(p.z)(e,2),a=!1),t&&Object(y.a)(t,e,a),n&&r&&g.k.importAndExecute(n,r)}var P=Object(O.action)("handleCreateAttachmentNotification")((function(e,t,n,r,a,i,o,c){const s=e;try{if(0!==s.ResultCode)throw new Error(`ResultCode:${s.ResultCode}, Id:${s.Id}, Exception: ${s.Exception}`);{const e=s.Response.ResponseMessages.Items[0];if(e&&e.Attachments.length>0)return Object(p.C)(a.attachmentId,!0),i(e.Attachments[0]),void C(a,n,r,e.Attachments[0],t,s.Response.SharingInformation,c.attachmentWellViewState)}}catch(e){b.d("Error handling the create attachment notification: "+e)}Object(p.C)(a.attachmentId,!1),o(new Error(s.Exception)),T(a,c.attachmentWellViewState,null,null)})),E=n(326);async function k(e,t){const n=Object(E.a)(),r={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null},a=e=>{t(e),g.k.importAndExecute(r,a)};(await g.j.import())(r,a);const i=(await g.b.import())();e(n,r,i,a)}var R=n(35),x=n(905);var D=n(704);function F(e,t,n,r,a,i){const o=Object(D.a)(e.mailboxInfo)||{};return c={itemId:e,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",subscriptionId:r,channelId:a,dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:t,isInline:i},s=o,void 0===c.itemId||c.itemId.__type||(c.itemId=Object(x.a)(c.itemId)),Object(R.a)("CreateAttachmentFromAttachmentDataProvider",c,s);var c,s}var N=n(4188),M=Object(O.action)("createAttachmentFromAttachmentDataProvider")((function(e,t,n,r,a,i,o,c,u){const l=new s.b("AttachmentCreationClassicFromAttachmentDataProvider");l.addCustomData([a.providerType]);const d=e=>{o(e),l.end()},f=e=>{c(),l.endWithError("ServerError",e)};k(async(t,n,o,s)=>{try{if(0===a.providerType){if(function(e){return-1!==e.indexOf("%")||-1!==e.indexOf("#")}(a.name))throw new Error(N.c)}if(0===i.attachmentType&&Object(p.B)(Object(p.k)(a.size),.05,e=>{Object(p.x)(i,e)},i.attachmentId),!await F(e,r,a,t,o,!1))throw new Error("Empty response for createAttachmentFromAttachmentDataProvider request")}catch(e){return Object(p.C)(i.attachmentId,!1),c(e),void T(i,u.attachmentWellViewState,n,s)}},r=>{P(r,e,t,n,i,d,f,u)})}));var _=n(4940),L=n(1735);function U(e,t,n,r,a,i){return new Promise(async(o,c)=>{const s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState)if(200===s.status){let e;try{e=JSON.parse(s.responseText)}catch(e){b.d("Attachment: Deserialize response failed with error: "+e.Message),b.d("Attachment: Deserialize response Failure Stack Trace: "+e.stack),c(e)}o(e)}else c(new Error("Request failed with status "+s.status+". Message: "+s.responseText))},s.ontimeout=function(){c(new Error("Request timed out"))},i&&(s.upload.onprogress=i),s.open("POST",e,!0),s.setRequestHeader("X-OWA-Action",n);const u=await Object(L.d)(r);u&&Object.keys(u).forEach(e=>{s.setRequestHeader(e,u[e])});const l=JSON.stringify(t);a?(s.setRequestHeader("X-OWA-UrlPostData",encodeURI(l)),s.send(a)):s.send(l)})}var B=n(10);function W(e){const t=Object(B.a)();return t.baseUrl?`${t.baseUrl}${e}`:`/owa${e}`}var G=n(5887),V=n(6053),z=n(261),q=n(705);const H={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddAttachmentToDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AddAttachmentToDraftOptions"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addAttachmentToDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attachment"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwsTypeName"}},{kind:"Field",name:{kind:"Name",value:"AttachmentId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"RootItemId"}},{kind:"Field",name:{kind:"Name",value:"RootItemChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"IsInline"}},{kind:"Field",name:{kind:"Name",value:"ContentId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReferenceAttachment"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ProviderType"}},{kind:"Field",name:{kind:"Name",value:"WebUrl"}},{kind:"Field",name:{kind:"Name",value:"AttachLongPathName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}}]}}]}}]};var $=n(47);const J=W("/service.svc/CreateAttachmentFromLocalFile");async function K(e,t,n,r,a,i){if(b.h.info(`Attachment: createAttachment Id: ${e.Id}, ChangeKey: ${e.ChangeKey}`),Object($.j)("mon-cmp-graphQLAttachments")){const a=function(e){const t=Object.assign(Object.assign({},e),{OwsTypeName:e.__type});delete t.__type,t.AttachmentId&&delete t.AttachmentId.__typename;return t}(t),o=Object(q.a)(),c=(await o.mutate({variables:{options:{ParentItemId:e,Attachment:a,CancellationId:n,attachmentType:"LocalFile",fileBlob:r,mailboxInfo:e.mailboxInfo,isInline:t.IsInline,sliceInformation:i}},mutation:H})).data.addAttachmentToDraft;return{ResponseMessages:{Items:[{Attachments:[Object.assign(Object.assign({},c.attachment),{__type:c.attachment.OwsTypeName})],IsCancelled:c.isCancelled,ResponseClass:"Success",ResponseCode:"NoError"}]}}}{const o=Object(V.a)({ParentItemId:e,Attachments:[t],RequireImageType:t.IsInline,IncludeContentIdInResponse:t.IsInline,ClientSupportsIrm:!0,CancellationId:n});i&&(o.SliceNumber=i.sliceNumber,o.TotalSlices=i.totalSlices);const c=Object(G.a)({Header:Object(z.b)(),Body:o}),s=t;return(await U(J,c,"CreateAttachmentFromLocalFile",e.mailboxInfo,s&&r?r:null,a)).Body}}function Q(e,t){let n="Attachment: createAttachment failed",r=null!=t?t:"genericError";return(null==e?void 0:e.MessageText)&&(n+=` with MessageText: ${e.MessageText}`),b.h.warn(n),(null==e?void 0:e.ResponseCode)&&(r=e.ResponseCode),{errorMessage:n,errorCode:r}}function X(e){const t=Object.assign({},e);return Object.keys(t).forEach((function(e,n){null===t[e]&&(t[e]=void 0)})),t}var Y=Object(s.r)(_.a.AttachmentCreationClassicFromLocalFile,(async function(e,t,n,r,a){let i=null;0===a.attachmentType&&(i=function(e){const t=e.loaded/e.total;Object(p.x)(a,t)});const o=X(t),c=(await K(e,o,n,r,i)).ResponseMessages.Items[0];if(c&&c.Attachments.length>0&&c.Attachments[0]){return{attachment:c.Attachments[0],sharingInfo:null}}throw Q(c)})),Z=n(6097),ee=Object(s.r)(_.a.AttachmentCreationFromRecentAttachment,(async function(e,t,n,r,a,i){let o=null;0===a.attachmentType&&(o=function(e){const t=e.loaded/e.total;Object(p.x)(a,t)});let c=X(t);if(i){c=function(e,t){return Object(Z.a)({AttachmentId:e.AttachmentId,AttachmentIdToAttach:t,ContentType:e.ContentType,Name:e.Name,Size:e.Size,Thumbnail:e.Thumbnail,ThumbnailMimeType:e.ThumbnailMimeType,CreateAttachmentInlineType:2})}(c,r.fileId)}const s=await K(e,c,n,null,o),u=s.ResponseMessages.Items[0];if(u&&u.Attachments.length>0&&u.Attachments[0]){return{attachment:u.Attachments[0],sharingInfo:s.SharingInformation}}throw Q(u)}));function te(e,t,n,r,a,i){const o=Object(D.a)(e.mailboxInfo)||{};return s=o,void 0===(c={itemId:e,uri:t,name:n,subscriptionId:r,isInline:a,contentId:i}).itemId||c.itemId.__type||(c.itemId=Object(x.a)(c.itemId)),Object(R.a)("CreateAttachmentFromUri",c,s);var c,s}var ne=Object(O.action)("createAttachmentFromUri")((function(e,t,n,r,a,i,o,c,u){const l=new s.b("AttachmentCreationFromUri");l.addCustomData({size:a?a.size:0});const d=e=>{o(e),l.end()},f=e=>{c(),l.endWithError("ServerError",e)};k(async(t,r,o,s)=>{try{if(0===i.attachmentType&&Object(p.B)(Object(p.l)(a.size),.05,e=>{Object(p.x)(i,e)},i.attachmentId),!await te(e,a.uri,a.name,t,n.IsInline,null))throw new Error("Empty response for createAttachmentFromUriProvider request")}catch(e){Object(p.C)(i.attachmentId,!1),c(),T(i,u.attachmentWellViewState,r,s)}},r=>{P(r,e,t,n,i,d,f,u)})})),re=n(8328);function ae(e,t,n){const r=Object(D.a)(e.mailboxInfo)||{};return Object(re.a)({itemId:e,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:t,thumbnailUrl:n.thumbnailUrl,previewUrl:n.previewUrl,isFolder:n.isFolder,mimeType:n.type},r)}var ie=n(2118),oe=Object(s.r)({name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:(e,t,n,r,a)=>[n.providerType,n.fileType]},(async function e(t,n,r,i,o){return 0===i.attachmentType&&Object(p.B)(4e3,.05,e=>{Object(p.x)(i,e)},i.attachmentId),ae(t,n,r).then(async c=>{const s=c.ResponseMessages.Items.length>0?c.ResponseMessages.Items[0]:null;if(s&&s.Attachments.length>0){return Object(p.C)(i.attachmentId,!0),{attachment:s.Attachments[0],sharingInfo:c.SharingInformation}}if(Object(p.C)(i.attachmentId,!1),Object($.j)("doc-authContext")&&!o&&c.SharingInformation&&!Object(a.k)(c.SharingInformation.ClaimsChallenge)){const o=c.SharingInformation.ClaimsChallenge;if(!Object(a.k)(o)){try{const e=await ie.a.import();await e(o)}catch(e){throw Q(s,c.SharingInformation.ResultCode.toString())}return e(t,n,r,i,!0)}}throw Q(s)})}));const ce=W("/service.svc/CreateReferenceAttachmentFromLocalFile");async function se(e,t,n,r,a,i,o,c,s,u){var l;const d={requestObject:(l={ParentItemId:e,FileName:t.Name,SubscriptionId:a,ChannelId:i,FileSizeInBytes:t.Size,SliceNumber:o,TotalSlices:c,CancellationId:n,FileContentToUpload:"",GroupSmtpAddress:s,UploadFolderId:u},Object.assign({__type:"CreateReferenceAttachmentFromLocalFileRequest:#Exchange"},l))};return await U(ce,d,"CreateReferenceAttachmentFromLocalFile",e.mailboxInfo,r,void 0)}var ue=n(5248);var le=Object(s.r)(_.a.AttachmentCreationCloudyFromLocalFile,(function(e,t,n,r,a,i,o,c,s){k((t,o,u,l)=>{!async function(e,t,n,r,a,i,o,c,s,u,l,d){var f;const m=Math.ceil(r.size/u);Object(p.B)(Object(p.q)(r.size),.05,e=>{Object(p.x)(a,e)},a.attachmentId);let h=null;const b=null===(f=null==d?void 0:d.attachmentWellViewState)||void 0===f?void 0:f.groupId;if(b&&(h=Object(ue.c)(b)?Object(ue.c)(b).folderId:null,!h)){const e=await Object(ue.b)(b,ue.a.Group);e&&(h=e.folderId)}for(let f=0;f<m;f++){const O=0+f*u,g=Math.min(O+u,r.size),v=r.slice(O,g);try{if(!await se(e,t,n,v,i,c,f,m,b,h))throw new Error("Empty response for createReferenceAttachmentFromLocalFile request")}catch(e){return Object(p.C)(a.attachmentId,!1),l(),void T(a,d.attachmentWellViewState,o,s)}}}(e,n,r,a,i,t,o,u,l,10485760,c,s)},r=>{P(r,e,t,n,i,o,c,s)})}));var de=n(1777),fe=n(5981),me=n(290),he=n(7153);function pe(e,t,n,r,a,i,o,c){const u=new s.b("UploadLocalFileAndCreateCloudyAttachment",{timeout:3e5}),[{uploadPromise:l,cancel:d},f]=Object(he.a)(n.Name,i,a,({loaded:e,total:t})=>{const n=e/t;Object(p.x)(o,n)}),{model:{Id:m,EndPointUrl:h,Type:b}}=f;let O=!1;return{onCompletePromise:(async()=>{let a=null;try{const{errorResponse:i,result:d}=await l;if(i){const e=await i.text();throw new Error(`Unable to upload file with status code: ${i.status}; response: ${e}`)}const f=function(e,t,n,r){return{fileType:de.a.Cloud,name:e.name,size:e.size,providerId:t,providerType:n,location:be(e,n),providerEndpointUrl:r,isFolder:!1,fileId:e.id,fileParentId:e.parentReference.id,thumbnailUrl:"",previewUrl:"",type:Object(fe.c)(e)}}(d,m,b,h),O=await ae(e,r,f),g=O.ResponseMessages.Items[0];if(g&&g.Attachments.length>0){Object(p.C)(o.attachmentId,!0);const r=g.Attachments[0];return C(o,t,n,r,e,O.SharingInformation,c.attachmentWellViewState),r}throw new Error(g.MessageText)}catch(e){if(Object(p.C)(o.attachmentId,!1),T(o,c.attachmentWellViewState),O)return null;throw a=e,e}finally{a?(new s.b("UploadLocalFileAndCreateCloudyAttachmentError",{isCore:!0}).endWithError(a),u.endWithError(a)):u.end()}})(),cancel:()=>{O=!0,d()}}}function be(e,t){return 1===t?`${e.parentReference.path}/${e.name}`:Object(me.parse)(e.webUrl).path}var Oe=n(2917);const ge=14680064;function ve(e,t,n,r){e.addCustomData([t]),n?e.end():e.endWithError("ServerError",r)}function Ie(e,t,n,r,a,i={}){i.sliceSizeInBytes=i.sliceSizeInBytes||ge;const o=new s.b("AttachmentCreationClassicFromLocalFileSliced",{timeout:3e5}),{action:c,getLastResponseMessage:l}=function(e,t,n,r,a){let i=null,o=null;return{action:async(c,s,u)=>{o||(o=function(e){const t=[];for(let n=0;n<e;n++)t[n]=0;return t}(u));let l=null;0===a.attachmentType&&(l=function(e){o[s]=e.loaded;const t=o.reduce((e,t)=>e+t,0)/r.size;Object(p.x)(a,t)});const d=X(t),f=await K(e,d,n,c,l,{sliceNumber:s,totalSlices:u});if(i=f.ResponseMessages.Items[0],!function(e){return e&&e.Attachments.length>0&&e.Attachments[0]}(i))throw Q(i);t=Object.assign(Object.assign({},t),{AttachmentId:i.Attachments[0].AttachmentId})},getLastResponseMessage:()=>i}}(e,t,n,r,a),{onCompletePromise:d,cancel:f}=Object(Oe.a)(r,c,{sliceSize:i.sliceSizeInBytes,numberOfSlicesToParallelize:1});let m=!1;return{onCompletePromise:d.then(e=>{switch(e){case 0:return ve(o,r.size,!0),{status:0,attachment:l().Attachments[0]};case 1:return{status:1};default:return Object(u.a)(e)}}).catch(e=>{if(m)return{status:1};throw ve(o,r.size,!1,e),e}),cancel:()=>{m=!0,f()}}}function je(e,t,n,r,a,i,o={shouldShare:!1}){const c=r&&(r.fileType===de.a.Cloud||r.fileType===de.a.CloudSuggestion||r.fileType===de.a.ContextualSuggestion);let s=null;const l=Object.assign(Object.assign({},t.AttachmentId),{mailboxInfo:e.mailboxInfo}),{shouldShare:d}=o;let f=()=>{};if((m=r).fileType===de.a.AttachmentItem||m.fileType===de.a.AttachmentItemSuggestion||(m.fileType===de.a.Cloud||m.fileType===de.a.CloudSuggestion||m.fileType===de.a.ContextualSuggestion)&&4===m.providerType)s=ee(e,t,n,r,a,c).then(e=>e);else if(d||c){if(!d&&c){return{createAttachmentPromise:new Promise((o,c)=>{M(e,l,t,n,r,a,o,c,i)}),cancelCreateAttachment:f}}if(!d||!c){if(o.shouldShare&&o.shareProperties&&!o.shareProperties.groupMailboxId){const{onCompletePromise:c,cancel:s}=pe(e,l,t,n,o.shareProperties.folderInfo,r.fileObject,a,i);return{createAttachmentPromise:c,cancelCreateAttachment:s}}return{createAttachmentPromise:new Promise((o,c)=>(le(e,l,t,n,r.fileObject,a,o,c,i),t)),cancelCreateAttachment:f}}s=oe(e,n,r,a)}else if(r&&r.fileType===de.a.Local&&r.fileObject){const{onCompletePromise:i,cancel:o}=Ie(e,t,n,r.fileObject,a);f=o,s=i.then(e=>{switch(e.status){case 0:return{attachment:e.attachment,sharingInfo:null};case 1:return null;default:return Object(u.a)(e)}})}else{if(r&&r.fileType===de.a.Uri){return{createAttachmentPromise:new Promise((o,c)=>{ne(e,l,t,n,r,a,o,c,i)}),cancelCreateAttachment:f}}s=Y(e,t,n,r&&r.fileType===de.a.Local?r.fileObject:null,a)}var m;return function(e,t,n,r,a,i,o){return{createAttachmentPromise:i.then(i=>i?(C(r,t,n,i.attachment,e,i.sharingInfo,a.attachmentWellViewState),i.attachment):null).catch(e=>{throw T(r,a.attachmentWellViewState,null,null),e}),cancelCreateAttachment:o}}(e,l,t,a,i,s,f)}var ye=n(6597);function Se(e){return t={cancellationId:e},Object(R.a)("CancelAttachment",t,n);var t,n}const we="ErrorNonExistentMailbox";var Ae=n(1778);function Ce(e){if(null==e)return null;switch(e){case 0:return Ae.i;case 5:return Ae.e;case 1:return Ae.h;case 2:return Ae.b;case 3:return Ae.a;case 7:return Ae.j;case 9:return Ae.k;case 8:return Ae.l;case 4:return Ae.f;case 6:return Ae.c;case 10:return Ae.g;default:return Object(u.a)(e)}}var Te=n(2890),Pe=n(6083),Ee=n(7608),ke=n(7609),Re=n(6468),xe=n(6458),De=n(2036);function Fe(e,t){const n=Object(l.a)(e.item.attachmentId);if(n){!function(e,t,n){Object(De.a)(n,e,[t])}("WarningAttachmentsCanNotBeDeleted",Object(a.c)(Object(a.b)(xe.a),n.model.Name),t)}}var Ne=n(1804),Me=n(9892);const _e=4;function Le(e,t,n){Object(De.a)(n,e,[t])}function Ue(e,t){const n=(r=e=>e.reason,e.reduce((e,t)=>{const n=r(t);return e[n]?e[n].push(t):e[n]=[t],e},{}));var r;Object.keys(n).forEach(e=>{const r=n[e];switch(parseInt(e)){case 0:!function(e,t){let n=null,r=null;if(1===e.length&&null!==e[0].item.tryAgainCallback){const n=e[0],r=n.item.file.name,i=Object(a.c)(Object(a.b)(Me.e),r),o={key:"WarningFilesCanNotBeAttachedWithNamesGenericError",source:Ne.c.Compose,rank:Ne.b.Info,message:i,messageParts:[i]},c={text:Object(a.b)(Me.a),action:()=>n.item.tryAgainCallback()};return o.messageParts.push(c),void Object(De.a)(t,"WarningFilesCanNotBeAttachedWithNamesGenericError",e=>o)}if(e.length<_e){const t=e.map(e=>e.item.file.name).join(", ");r="WarningFilesCanNotBeAttachedWithNamesGenericError",n=Object(a.c)(Object(a.b)(Me.b),t)}else r="WarningSeveralFilesCanNotBeAttachedGenericError",n=Object(a.c)(Object(a.b)(Me.d),e.length);Le(r,n,t)}(r,t);break;case 1:!function(e,t){Le("WarningFilesCannotBeAttachedFromOtherMailboxes",Object(a.b)(Me.c),t)}(0,t);break;case 2:!function(e,t){Le("WarningSpecialCharactersAreNotSupported",Object(a.b)(Me.f),t)}(0,t)}})}class Be{constructor(e,t,n,r=null,a=null){this.attachmentWellViewState=e,this.parentItemId=t,this.infoBar=n,this.onAnyAttachmentCreatedInParentItemCallback=r,this.onAnyAttachmentDeletedInParentItemCallback=a,this.uploadQueue=[],this.deleteQueue=[],this.uploadFailures=[],this.onFinishPromise=new Promise((e,t)=>{this.onFinish=function(t){e(t)}})}enqueueAttachmentCreation(e,t,n=null,r=null,a=null){const{isInline:i,shouldShare:o,isHiddenInline:u,skipProcessInlineImage:l}=t;if(Object(c.a)(this.infoBar),!o&&Object(m.a)(e,this.attachmentWellViewState,this.infoBar))return i&&Object(s.o)("InlineImageFailure",{reason:"OverSizeLimit"}),[];e=Object(f.a)(e,i,this.infoBar);for(let c,s=0;c=e[s];s++){let e,s=null;const d={Name:null,ContentType:null,ContentId:null,ContentLocation:null,AttachmentOriginalUrl:null,Size:0,LastModifiedTime:null,IsInline:!1,IsInlineToUniqueBody:!1,IsInlineToNormalBody:!1,ThumbnailMimeType:null,Thumbnail:null};if(o){const t=c;e=Object(Re.a)(Object.assign(Object.assign({},d),{Name:t.name,Size:t.size,ContentType:t.type,ProviderType:Ce(t.providerType),AttachmentIsFolder:t.isFolder,IsInline:!1,PermissionType:0,AttachLongPathName:null,ProviderEndpointUrl:null,AttachmentThumbnailUrl:null,AttachmentPreviewUrl:null,OriginalPermissionType:0})),0===t.providerType&&(e.AttachmentOriginalUrl=t.location)}else if(c.fileType===de.a.Base64InlineImage){const t=c;e=Object(Te.a)(Object.assign(Object.assign({},d),{Name:t.name,Size:t.size,ContentType:t.type,IsInline:!0,Content:t.dataUri,IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),s=t.tempId}else if(c.fileType===de.a.MailItem){const t=c;if(t.mimeContent)e=Object(Ee.a)(Object.assign(Object.assign({},d),{Name:c.name,Size:c.size,IsInline:!1,Item:Object(Pe.a)({MimeContent:Object(ke.a)({Value:t.mimeContent})}),ContentType:"message/rfc822"}));else{const n=Object(x.a)({Id:t.itemId});e=Object(Z.a)(Object.assign(Object.assign({},d),{Name:c.name,IsInline:!1,ItemId:n,Size:c.size,AttachmentIdToAttach:null,CreateAttachmentInlineType:0}))}}else if(c.fileType===de.a.AttachmentItem||c.fileType===de.a.AttachmentItemSuggestion){const t=c;e=Object(Z.a)(Object.assign(Object.assign({},d),{Name:t.name,AttachmentIdToAttach:t.attachmentItemId,__type:t.type,Size:c.size,ItemId:null,CreateAttachmentInlineType:0}))}else c.fileType===de.a.Uri?e=Object(Te.a)(Object.assign(Object.assign({},d),{Name:c.name,AttachmentOriginalUrl:c.uri,Size:c.size,ContentType:c.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})):(e=Object(Te.a)(Object.assign(Object.assign({},d),{Name:c.name,Size:c.size,ContentType:c.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),s=c.tempId);const f={Id:s||Object(E.a)(),mailboxInfo:this.parentItemId.mailboxInfo};let m;i?m=Object(p.i)(f,f.Id,u,0,l):(m=Object(p.g)(f,!1,!1,o,c.fileType,!0),t.isAddedFromSmartDoc&&(m.fileType=de.a.SmartDoc),t.isAddedFromSonora&&(m.fileType=de.a.Sonora),this.attachmentWellViewState.supportedMenuActions&&(m.strategy.supportedMenuActions=this.attachmentWellViewState.supportedMenuActions),t.downsellFromLink&&Object(p.A)(m,6,11)),Object(h.a)(m,this.attachmentWellViewState,e,f);const O={attachmentState:m,file:c,attachment:e,shouldShareInfo:t,cancelPendingUpload:()=>{},onAttachmentCreatedCallback:n,onAttachmentCanceledOrFailedCallback:r,tryAgainCallback:a};b.h.info("Attachment: UploadQueue enqueue attachment: Name="+c.name),this.uploadQueue.push(O)}return this.startProcessIfNotStarted(),e}deleteAttachment(e,t=null){Object(c.a)(this.infoBar);const n=1===e.attachmentType,r=n?0===e.status:e.actionCompletePercent<=1;if(n||Object(p.A)(e,3,r?10:6),r&&this.currentUploadItem)if(this.currentUploadItem.attachmentState.attachmentId===e.attachmentId){b.h.info("Attachment: Cancelling attachment: TempId="+e.attachmentId);const n=this.currentUploadItem;if(n.cancelPendingUpload(),0===e.attachmentType&&e.isCloudy){if(b.h.info(`Attachment: Put attachment: Id= ${e.attachmentId} into deleteQueue`),0===this.deleteQueue.filter(t=>t.attachmentState.attachmentId===e.attachmentId).length){const n={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(n)}this.startProcessIfNotStarted()}else this.isCancelling||(this.isCancelling=!0,Se(e.attachmentId.Id).then(t=>{this.isCancelling=!1,t?(Object(y.a)(this.attachmentWellViewState,e),n.onAttachmentCanceledOrFailedCallback&&n.onAttachmentCanceledOrFailedCallback(!0)):this.onAttachmentDeleteFailure(e)}))}else b.h.info("Attachment: Removing attachment: TempId= "+e.attachmentId+" from queue"),function(e,t){for(let n=0;n<t.length;n++){const r=t[n];r.attachmentState.attachmentId===e.attachmentId&&(r.onAttachmentCanceledOrFailedCallback&&r.onAttachmentCanceledOrFailedCallback(!0),t.splice(n,1))}}(e,this.uploadQueue),Object(y.a)(this.attachmentWellViewState,e);else{if(b.h.info(`Attachment: Put attachment: Id= ${e.attachmentId} into deleteQueue`),0===this.deleteQueue.filter(t=>t.attachmentState.attachmentId===e.attachmentId).length){const n={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(n)}this.startProcessIfNotStarted()}}onAttachmentDeleteFailure(e){var t,n;t={item:e,reason:0},(n=this.infoBar)&&(Object(c.a)(n),Fe(t,n)),1!==e.attachmentType&&Object(p.A)(e,0,0),b.h.warn("Attachment: Failed to cancel attachment: TempId="+e.attachmentId)}startProcessIfNotStarted(){this.isInProgress||(this.datapoint=new s.b("AttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment("NewProcess"))}processNextAttachment(e){if(b.h.info("Attachment: Invoking processNextAttachment from: "+e),0!==this.deleteQueue.length){const{attachmentState:e,onAttachmentDeletedCallback:t}=this.deleteQueue[0],n=Object(l.a)(e.attachmentId);b.h.info("Attachment: Deleting attachment: Id= "+e.attachmentId),Object(ye.a)(this.attachmentWellViewState,e,this.parentItemId,e.fileType).then(()=>{this.deleteQueue.shift(),We(t,this.parentItemId,e.attachmentId,n.model),We(this.onAnyAttachmentDeletedInParentItemCallback,this.parentItemId,e.attachmentId,n.model),this.processNextAttachment("DeleteAttachmentFinish")}).catch(t=>{this.deleteQueue.shift(),this.onAttachmentDeleteFailure(e),this.logDeletionFailure(t.message,e),this.processNextAttachment("DeleteAttachmentFinish")})}else if(0!==this.uploadQueue.length){this.currentUploadItem=this.uploadQueue.shift();const e=this.currentUploadItem.onAttachmentCreatedCallback,t={attachmentWellViewState:this.attachmentWellViewState,parentItemId:this.parentItemId,infoBar:this.infoBar},{createAttachmentPromise:n,cancelCreateAttachment:r}=je(this.parentItemId,this.currentUploadItem.attachment,this.currentUploadItem.attachmentState.attachmentId.Id,this.currentUploadItem.file,this.currentUploadItem.attachmentState,t,this.currentUploadItem.shouldShareInfo);this.currentUploadItem.cancelPendingUpload=r,n.then(t=>{if(t){const n=Object.assign(Object.assign({},t.AttachmentId),{mailboxInfo:this.parentItemId.mailboxInfo});We(e,this.parentItemId,n,t),We(this.onAnyAttachmentCreatedInParentItemCallback,this.parentItemId,n,t)}this.processNextAttachment("CreateAttachmentFinish")}).catch(e=>{let t=0;(null==e?void 0:e.message)===N.c&&(t=2),e&&e.errorCode===we&&(t=1),this.uploadFailures.push({item:this.currentUploadItem,reason:t}),this.currentUploadItem.onAttachmentCanceledOrFailedCallback&&this.currentUploadItem.onAttachmentCanceledOrFailedCallback(!1),this.logCreationFailure(),this.processNextAttachment("CreateAttachmentFinish")})}else this.finishProcess()}finishProcess(){b.h.info("Attachment: AttachmentQueueManager: finishProcess"),this.isInProgress=!1;const e=this.currentUploadItem&&this.currentUploadItem.attachmentState?this.currentUploadItem.attachmentState.attachmentId:null;this.currentUploadItem=null,this.onFinish(e),this.datapoint.end(),this.datapoint=null,Ue(this.uploadFailures,this.infoBar),this.uploadFailures=[]}logCreationFailure(){Object(s.o)("AttachmentCreationFailure")}logDeletionFailure(e,t){Object(s.o)("AttachmentDeletionFailure",[e],{cosmosOnlyData:JSON.stringify({attachmentId:t.attachmentId.Id})})}}function We(e,t,n,r){e&&e(t,n,r)}n.d(t,"a",(function(){return Ve})),n.d(t,"b",(function(){return ze}));const Ge={};function Ve(e,t,n,i,o={isInline:!1,isHiddenInline:!1,shouldShare:!1,skipProcessInlineImage:!1},u,l,f,m,h){if(!t)return Object(c.a)(i),Object(De.a)(i,"WarningFilesCanNotBeAttachedGenericError",[Object(a.b)(r.a)]),[];const p=qe(e,t,i,u),{isInline:b,shouldShare:O}=o;return function(e,t,n,r){for(let a=0;a<e.length;a++){const i=e[a];Object(s.o)("AttachmentCreation",[n,r],{cosmosOnlyData:JSON.stringify({fileType:i.fileType,size:i.size,ext:Object(d.d)(i.name)||"",logTraceId:t})})}}(n,h,b,O),p.enqueueAttachmentCreation(n,o,l,f,m)}function ze(e,t,n,r,a){const i=qe(e,n,r);!function(e){const t=e.attachmentType;switch(t){case 1:Object(s.o)("AttachmentDeletion",[!0,!1,0]);break;case 0:const n=Object(l.a)(e.attachmentId);Object(s.o)("AttachmentDeletion",[!1,e.isCloudy],{cosmosOnlyData:JSON.stringify({size:n.model.Size})});break;default:Object(u.a)(t)}}(t),i.deleteAttachment(t,a)}function qe(e,t,n,r){let a=Ge[t.Id];return a||(a=function(e,t,n,r=null,a=null){return new Be(e,t,n,r,a)}(e,t,n,i.a,o.a),Ge[t.Id]=a,a.onFinishPromise.then(e=>{delete Ge[t.Id],r&&r(e)})),a}},7607:function(e){e.exports=JSON.parse('{"a":"Cda"}')},7608:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},7609:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"MimeContentType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},80:function(e,t,n){"use strict";var r=n(3);function a(e,t){return(t=t||{}).dp=e,t}function i(e,t,n){return Object(r.action)(e,(...r)=>{const i=t?t(...r):{},o=n?n(i,...r):{name:e};return o.name=o.name||e,o.options=o.options||{isCore:!0},a(o,i)})}function o(e){const{value:t,exactMatches:n=[0,1,2,3,4,5],buckets:r=[10,15,25,50,100]}=e;if(0===r.length)throw new Error("getAggregationBucket: buckets cannot be an empty array");if(n[0]&&t<n[0])return`<${n[0]}`;if(n.includes(t))return`${t}`;for(let e=0;e<r.length;e++)if(t<=r[e])return`${e>0?r[e-1]+1:n[n.length-1]+1||"0"}-${r[e]}`;return`${r[r.length-1]+1}+`}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o}))},811:function(e,t,n){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:t,timeBetweenRetryInMS:n}=e;return e=>{let r=0,a=!1;const i=(o,c)=>{a?c(new Error("The function retry was cancelled")):(r++,e().then(e=>o(e)).catch(e=>{t&&r>=t?c(e):setTimeout(()=>i(o,c),n(r))}))};return{retriableFunc:()=>new Promise((e,t)=>i(e,t)),cancel:()=>a=!0}}}function a(e){return t=>Math.pow(2,t)*e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},817:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(618);function a(e){return i(e.source,Object(r.a)(e.source,e.start))}function i(e,t){var n=e.locationOffset.column-1,r=c(n)+e.body,a=t.line-1,i=e.locationOffset.line-1,s=t.line+i,u=1===t.line?n:0,l=t.column+u,d="".concat(e.name,":").concat(s,":").concat(l,"\n"),f=r.split(/\r\n|[\n\r]/g),m=f[a];if(m.length>120){for(var h=Math.floor(l/80),p=l%80,b=[],O=0;O<m.length;O+=80)b.push(m.slice(O,O+80));return d+o([["".concat(s),b[0]]].concat(b.slice(1,h+1).map((function(e){return["",e]})),[[" ",c(p-1)+"^"],["",b[h+1]]]))}return d+o([["".concat(s-1),f[a-1]],["".concat(s),m],["",c(l-1)+"^"],["".concat(s+1),f[a+1]]])}function o(e){var t=e.filter((function(e){e[0];return void 0!==e[1]})),n=Math.max.apply(Math,t.map((function(e){return e[0].length})));return t.map((function(e){var t,r=e[0],a=e[1];return c(n-(t=r).length)+t+(a?" | "+a:" |")})).join("\n")}function c(e){return Array(e+1).join(" ")}},8326:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8327),a=n(2036),i=n(6),o=n(4467),c=n(1777),s=n(1696);function u(e,t,n,r){const i=[],o=[];if(e.forEach(e=>{n(e)?i.push(e):o.push(e)}),t&&o.length>0){const e=o.map(e=>e.name).join(", "),{messageId:n,message:i}=r(e);Object(a.a)(t,n,[i])}return i}function l(e,t,n){Object(o.a)(n);let a=[];for(let t=0;t<e.length;t++)a.push(e[t]);return a=function(e,t){return u(e,t,e=>!(e.fileType===c.a.Local&&0===e.size),(function(e){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(i.c)(Object(i.b)(r.a),e)}}))}(a,n),t&&(a=function(e,t){return u(e,t,e=>Object(s.g)(e.name,e.type),(function(e){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(i.c)(Object(i.b)(r.b),e)}}))}(a,n)),a}},8327:function(e){e.exports=JSON.parse('{"a":"tea","b":"uea"}')},8328:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),a=n(905);function i(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=Object(a.a)(e.itemId)),Object(r.a)("CreateReferenceAttachmentFromAttachmentDataProvider",e,t)}},8329:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1777),a=n(1738),i=n(1732);function o(e){if(Object(a.a)(e)){const t=e;return{fileType:r.a.Cloud,name:t.Name,size:t.Size,providerId:"",providerType:4,location:t.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:t.AttachmentThumbnailUrl,previewUrl:t.AttachmentPreviewUrl,fileId:t.AttachmentId.Id,fileParentId:"",type:t.ContentType}}return{attachmentItemId:e.AttachmentId.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:i.c,EmbeddedItemClass:e.EmbeddedItemClass,ContentType:e.ContentType}}},905:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},907:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},910:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_SELECTED_ACCOUNT_CHANGED",(e,t,n)=>({selectedAccountSourceId:e,selectedEmailAddress:t,oldSourceId:n}))},912:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(715);function a(e){const t=Object(r.a)().accountSources.filter(t=>{var n;return(null===(n=t.mailbox)||void 0===n?void 0:n.emailAddress)===e});if(t.length>1)throw new Error("Found "+t.length+" duplicated accounts with same email address: "+e);return 1===t.length?t[0].id:null}},919:function(e,t,n){"use strict";var r=n(931),a=n(940);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,c=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,c&&Object(a.a)(n[0],n[1],c)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var s=n[r];s&&e(t,s,r,o)}return t}))}},920:function(e){e.exports=JSON.parse('{"a":{"AccountEntry":["AccountLocalFile","AccountMailbox","AccountSource"],"AppendOnSend":[],"Attachment":["BasicAttachment","ReferenceAttachment"],"AttachmentTypeUnion":["BasicAttachment","ReferenceAttachment"],"CalendarEntry":["LinkedCalendarEntry","LocalCacheForRemoteCalendarEntry","LocalCalendarEntry"],"Connection":["ConversationRowConnection","ConversationToConversationNodesConnection","ItemRowConnection"],"ConversationNodeItem":["Item","Message","MeetingMessage","MeetingResponseMessage","MeetingRequestMessage","MeetingCancellationMessage"],"ConversationRowByIdResult":["ConversationType","NotFound"],"CopyMoveGroupFolderResult":["CopyMoveGroupFolderResponse","ErrorMessage"],"CreateAccountResult":["AccountSource","AccountCreationFailure"],"CreateFolderResult":["FolderId","AccessDenied"],"CreateGroupFolderResult":["CreateGroupFolderResponse","ErrorMessage"],"DeleteGroupFolderResult":["DeleteGroupFolderResponse","ErrorMessage"],"Edge":["ConversationConversationNodesEdge","ConversationRowEdge","ItemRowEdge"],"GenericItem":["CalendarItem","Item","MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"GenericMeetingMessage":["MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage"],"GenericMessage":["MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"GetItemResponseType":["Item","Message","MeetingMessage","MeetingResponseMessage","MeetingRequestMessage","MeetingCancellationMessage"],"IntervalRecurrencePatternBase":["AbsoluteMonthlyRecurrence","DailyRecurrence","RegeneratingPatternBaseType","RelativeMonthlyRecurrence","WeeklyRecurrence"],"M365Application":["M365HubApplication","M365PlatformApplication"],"M365ApplicationBadge":["M365ApplicationNumericBadge"],"M365ApplicationIcon":["InternalIcon","RemoteImage"],"MailFolderPermissions":["MailFolder"],"Node":["CalendarEvent","CalendarItem","Conversation","ConversationNode","ConversationType","Draft","Item","ItemRow","MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"NotificationPayload":["GroupFolderHierarchyNotificationPayload","HierarchyNotificationPayload","RowNotificationChangePayload","RowNotificationDeletePayload","UnreadItemNotificationPayload"],"PropertyPath":["BuiltInPropertyUri","ExtendedPropertyUri"],"RecurrencePatternType":["AbsoluteYearlyRecurrence","AbsoluteMonthlyRecurrence","DailyRecurrence","RegeneratingPatternBaseType","RelativeYearlyRecurrence","RelativeMonthlyRecurrence","WeeklyRecurrence"],"RecurrenceRangeBase":["EndDateRecurrence","NoEndRecurrence","NumberedRecurrence"],"RecurrenceRangeType":["EndDateRecurrence","NoEndRecurrence","NumberedRecurrence"],"RenameGroupFolderResult":["RenameGroupFolderResponse","ErrorMessage"],"RowNotificationPayload":["RowNotificationChangePayload","RowNotificationDeletePayload"],"UndoableActionResult":["CategorizeConversationResult","CategorizeItemResult","DeleteConversationResult","DeleteItemResult","MarkItemAsJunkResult","MoveConversationResult","MoveItemResult","ScheduleConversationResult"],"calendarsUnionType":["LocalCalendarEntry","LinkedCalendarEntry","LocalCacheForRemoteCalendarEntry"]}}')},921:function(e,t,n){"use strict";var r=n(471),a=n(575),i=n(406);var o=function(e,t,n){(void 0===n||Object(i.a)(e[t],n))&&(void 0!==n||t in e)||Object(a.a)(e,t,n)},c=n(939),s=n(948),u=n(949),l=n(947),d=n(951),f=n(520),m=n(262),h=n(934),p=n(518),b=n(565),O=n(252),g=n(950),v=n(574);var I=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},j=n(909),y=n(708);var S=function(e){return Object(j.a)(e,Object(y.a)(e))};var w=function(e,t,n,r,a,i,c){var j=I(e,n),y=I(t,n),w=c.get(y);if(w)o(e,n,w);else{var A=i?i(j,y,n+"",e,t,c):void 0,C=void 0===A;if(C){var T=Object(m.a)(y),P=!T&&Object(p.a)(y),E=!T&&!P&&Object(v.a)(y);A=y,T||P||E?Object(m.a)(j)?A=j:Object(h.a)(j)?A=Object(l.a)(j):P?(C=!1,A=Object(s.a)(y,!0)):E?(C=!1,A=Object(u.a)(y,!0)):A=[]:Object(g.a)(y)||Object(f.a)(y)?(A=j,Object(f.a)(j)?A=S(j):Object(O.a)(j)&&!Object(b.a)(j)||(A=Object(d.a)(y))):C=!1}C&&(c.set(y,A),a(A,y,r,i,c),c.delete(y)),o(e,n,A)}};var A=function e(t,n,a,i,s){t!==n&&Object(c.a)(n,(function(c,u){if(s||(s=new r.a),Object(O.a)(c))w(t,n,u,a,e,i,s);else{var l=i?i(I(t,u),c,u+"",t,n,s):void 0;void 0===l&&(l=c),o(t,u,l)}}),y.a)},C=n(919),T=Object(C.a)((function(e,t,n){A(e,t,n)}));t.a=T},931:function(e,t,n){"use strict";var r=n(568),a=n(943),i=n(941);t.a=function(e,t){return Object(i.a)(Object(a.a)(e,t,r.a),e+"")}},934:function(e,t,n){"use strict";var r=n(402),a=n(306);t.a=function(e){return Object(a.a)(e)&&Object(r.a)(e)}},938:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return"object"==r(e)&&null!==e}n.d(t,"a",(function(){return a}))},939:function(e,t,n){"use strict";var r=function(e){return function(t,n,r){for(var a=-1,i=Object(t),o=r(t),c=o.length;c--;){var s=o[e?c:++a];if(!1===n(i[s],s,i))break}return t}}();t.a=r},940:function(e,t,n){"use strict";var r=n(406),a=n(402),i=n(577),o=n(252);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(a.a)(n)&&Object(i.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},941:function(e,t,n){"use strict";var r=function(e){return function(){return e}},a=n(578),i=n(568),o=a.a?function(e,t){return Object(a.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i.a,c=800,s=16,u=Date.now;var l=function(e){var t=0,n=0;return function(){var r=u(),a=s-(r-n);if(n=r,a>0){if(++t>=c)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(o);t.a=l},943:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},a=Math.max;t.a=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,c=a(i.length-t,0),s=Array(c);++o<c;)s[o]=i[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=i[o];return u[t]=n(s),r(e,this,u)}}},946:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return O}));var r=n(938),a=n(714),i=n(618),o=n(817);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,p(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),h(r,e)})(e)}function f(e,t,n){return(f=m()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&h(a,n.prototype),a}).apply(null,arguments)}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(b,e);var t,n,o,c,d,f=(t=b,n=m(),function(){var e,r=p(t);if(n){var a=p(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return u(this,e)});function b(e,t,n,a,o,c,s){var d,m,h,p,O;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),O=f.call(this,e);var g,v=Array.isArray(t)?0!==t.length?t:void 0:t?[t]:void 0,I=n;!I&&v&&(I=null===(g=v[0].loc)||void 0===g?void 0:g.source);var j,y=a;!y&&v&&(y=v.reduce((function(e,t){return t.loc&&e.push(t.loc.start),e}),[])),y&&0===y.length&&(y=void 0),a&&n?j=a.map((function(e){return Object(i.a)(n,e)})):v&&(j=v.reduce((function(e,t){return t.loc&&e.push(Object(i.a)(t.loc.source,t.loc.start)),e}),[]));var S=s;if(null==S&&null!=c){var w=c.extensions;Object(r.a)(w)&&(S=w)}return Object.defineProperties(l(O),{name:{value:"GraphQLError"},message:{value:e,enumerable:!0,writable:!0},locations:{value:null!==(d=j)&&void 0!==d?d:void 0,enumerable:null!=j},path:{value:null!=o?o:void 0,enumerable:null!=o},nodes:{value:null!=v?v:void 0},source:{value:null!==(m=I)&&void 0!==m?m:void 0},positions:{value:null!==(h=y)&&void 0!==h?h:void 0},originalError:{value:c},extensions:{value:null!==(p=S)&&void 0!==p?p:void 0,enumerable:null!=S}}),null!=c&&c.stack?(Object.defineProperty(l(O),"stack",{value:c.stack,writable:!0,configurable:!0}),u(O)):(Error.captureStackTrace?Error.captureStackTrace(l(O),b):Object.defineProperty(l(O),"stack",{value:Error().stack,writable:!0,configurable:!0}),O)}return o=b,(c=[{key:"toString",value:function(){return O(this)}},{key:a.c,get:function(){return"Object"}}])&&s(o.prototype,c),d&&s(o,d),b}(d(Error));function O(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var a=r[n];a.loc&&(t+="\n\n"+Object(o.a)(a.loc))}else if(e.source&&e.locations)for(var i=0,c=e.locations;i<c.length;i++){var s=c[i];t+="\n\n"+Object(o.b)(e.source,s)}return t}},950:function(e,t,n){"use strict";var r=n(347),a=n(712),i=n(306),o="[object Object]",c=Function.prototype,s=Object.prototype,u=c.toString,l=s.hasOwnProperty,d=u.call(Object);t.a=function(e){if(!Object(i.a)(e)||Object(r.a)(e)!=o)return!1;var t=Object(a.a)(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==d}},953:function(e,t,n){"use strict";var r=n(713),a=n(36);function i(e){var t;const n={};return null===(t=null==e?void 0:e.Items)||void 0===t||t.forEach(e=>{e.Id&&(n[e.Id]=e.Value)}),n}const o=e=>{switch(e){case 0:return"Business";case 1:return"ExoConsumer";case 2:return"GMail";default:return null}},c=e=>{switch(e){case 1:return"Disabled";case 2:return"Enabled";case 0:return"FirstRun";default:return null}},s=e=>{switch(e){case 1:return"Celsius";case 0:return"Default";case 2:return"Fahrenheit";default:return null}},u=e=>{switch(e){case 1:return"Disabled";case 2:return"Enabled";case 0:return"FirstRun";default:return null}},l=e=>{switch(e){case 2:return"EmailToast";case 8:return"FaxToast";case 0:return"None";case 1:return"Sound";case 4:return"VoiceMailToast";default:return null}},d=e=>{switch(e){case 7:return"All";case 1:return"Bold";case 2:return"Italic";case 0:return"Normal";case 4:return"Underline";default:return null}},f=e=>{switch(e){case 3:return"Gmail";case 0:return"Hotmail";case 1:return"Off";case 4:return"Owa";case 2:return"Yahoo";default:return null}},m=e=>{switch(e){case 2:return"CalendarItems";case 0:return"Conversation";case 1:return"Message";default:return null}},h=e=>{switch(e){case 1:return"Jsmvvm";case 0:return"None";case 2:return"React";default:return null}},p=e=>{switch(e){case 2:return"Archive";case 1:return"Delete";case 0:return"None";case 5:return"ToggleFlag";case 3:return"TogglePin";case 4:return"ToggleRead";default:return null}},b=e=>{switch(e){case 0:return"None";case 1:return"ExternalLink";case 2:return"DeleteFlaggedMessage";case 4:return"DeleteFlaggedContacts";case 8:return"DeleteFlaggedItems";case 16:return"DeleteOutlookDisabledRules";case 32:return"DisabledRulesLeft";case 64:return"DeleteConversation";case 128:return"IgnoreConversation";case 256:return"CancelIgnoreConversation";case 512:return"FilteredByUnread";case 1024:return"DeleteAllClutter";case 2048:return"ShowFirstRunModalDialog";case 4096:return"StopShowConsumerPromotion";case 8192:return"ShowAdsEdgePromotionMiddle";case 16384:return"UseUCMALegacyChat";case 32768:return"DonotShowAds";case 65536:return"FocusedInboxFirstRunExperience";case 131072:return"ShowGroupsAppUpsellBanner";case 262144:return"HideUpNextAgendaButtonLabel";case 524288:return"FocusedInboxFeedback";case 1048576:return"NotO365HomesubscribedUser";case 2097152:return"SweepGreyEmails";case 4194304:return"ReactDefaultSettingsOverride";case 8388608:return"AdsExperiments";case 16777216:return"AdsDisplayOn";case 33554432:return"AdsNativeOn";case 67108864:return"AdsFocusOnOnly";case 134217728:return"ShowGetStartedPane";case 268435456:return"GdprAdsPrefNotSet";case 536870912:return"GetStartedEnabledViaNewUserPath";case 1073741824:return"OneNoteFeedEverInitialized";case 2147483647:return"All";default:return null}},O=e=>{switch(e){case 2:return"Archive";case 1:return"Delete";case 0:return"None";case 5:return"FlagUnflag";case 6:return"Move";case 3:return"PinUnpin";case 4:return"ReadUnread"}},g=e=>{switch(e){case 0:return"All";case 4:return"DistributionGroups";case 2:return"ExcludeFavorites";case 5:return"FamilyGroup";case 1:return"Favorites";case 3:return"PublicOnly";default:return null}},v=e=>{switch(e){case 0:return"MemberOfUnifiedGroups";case 1:return"OwnerOfDeletedUnifiedGroups";default:return null}},I=e=>{switch(e){case 3:return"DeleteAndAllowRecovery";case 5:return"MarkAsPastRetentionLimit";case 6:return"MoveToArchive";case 1:return"MoveToDeletedItems";case 2:return"MoveToFolder";case 0:return"None";case 4:return"PermanentlyDelete";default:return null}},j=e=>{switch(e){case 1:return"Calendar";case 2:return"Contacts";case 3:return"DeletedItems";case 4:return"Drafts";case 5:return"Inbox";case 6:return"JunkEmail";case 7:return"Journal";case 8:return"Notes";case 9:return"Outbox";case 10:return"SentItems";case 11:return"Tasks";case 12:return"All";case 13:return"ManagedCustomFolder";case 14:return"RssSubscriptions";case 15:return"SyncIssues";case 16:return"ConversationHistory";case 17:return"Personal";case 18:return"RecoverableItems";case 19:return"NonIpmRoot";default:return null}},y=e=>e?e.map(O):null,S=e=>Object.assign(Object.assign({},e),{FilterType:g(null==e?void 0:e.FilterType),GroupsSetType:v(null==e?void 0:e.GroupsSetType)}),w=e=>e?e.map(S):null,A=e=>Object.assign(Object.assign({},e),{WebSessionType:o(null==e?void 0:e.WebSessionType)}),C=e=>Object.assign(Object.assign({},e),{WeatherEnabled:c(null==e?void 0:e.WeatherEnabled),WeatherUnit:s(null==e?void 0:e.WeatherUnit),LocalEventsEnabled:u(null==e?void 0:e.LocalEventsEnabled),NewItemNotify:l(null==e?void 0:e.NewItemNotify),ComposeFontFlags:d(null==e?void 0:e.ComposeFontFlags),NewEnabledPonts:b(null==e?void 0:e.NewEnabledPonts),KeyboardShortcutsMode:f(null==e?void 0:e.KeyboardShortcutsMode),GlobalListViewTypeReact:m(null==e?void 0:e.GlobalListViewTypeReact),ClientTypeOptInState:h(null==e?void 0:e.ClientTypeOptInState),TasksClientTypeOptInState:h(null==e?void 0:e.TasksClientTypeOptInState)}),T=e=>Object.assign(Object.assign({},e),{TemperatureUnit:s(null==e?void 0:e.TemperatureUnit),MailLeftSwipeAction:p(null==e?void 0:e.MailLeftSwipeAction),MailRightSwipeAction:p(null==e?void 0:e.MailRightSwipeAction),MailTriageOnHoverActions:y(null==e?void 0:e.MailTriageOnHoverActions)}),P=e=>({UnifiedGroupsSets:w(null==e?void 0:e.UnifiedGroupsSets)}),E=e=>Object.assign(Object.assign({},e),{Type:j(e.Type),RetentionAction:I(e.RetentionAction)}),k=e=>e?e.map(E):null;var R=n(921);const x=new Map;function D(e,t,n){t=t||r.a;try{if(e){const r=function(e,t){return Object.assign(Object.assign({__typename:"UserConfiguration",id:t},e),{PrimeSettings:i(e.PrimeSettings),UserOptions:C(e.UserOptions),SessionSettings:A(e.SessionSettings),ViewStateConfiguration:T(e.ViewStateConfiguration),GroupsSets:P(e.GroupsSets),RetentionPolicyTags:k(e.RetentionPolicyTags)})}(JSON.parse(JSON.stringify(e)),t);n?N(t,r):x[t]=r}}catch(e){a.d("User configuration cache set failed: "+e)}}function F(e){return e=e||r.a,x[e]||{id:e}}function N(e,t){if(t){e=e||r.a;const n=x[e]||{};x[e]=Object(R.a)(n,t)}}n.d(t,"a",(function(){return F})),n.d(t,"b",(function(){return D})),n.d(t,"c",(function(){return N}))},954:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},955:function(e,t,n){"use strict";var r=n(35);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return a}))},960:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FindItemJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},962:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},964:function(e,t,n){"use strict";var r=n(920);n.d(t,"a",(function(){return r.a}))},970:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),a=n(960);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FindItem",e,t)}},971:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(36),a=n(715);function i(e){const t=Object(a.a)().accountSources.filter(t=>t.id===e);if(1===t.length)return t[0];t.length>1&&r.h.warn("Found more than one account with the same source id")}},972:function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}n.d(t,"a",(function(){return r}))},973:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FindItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},9891:function(e){e.exports=JSON.parse('{"a":"Ifa"}')},9892:function(e){e.exports=JSON.parse('{"b":"ffa","d":"gfa","e":"hfa","c":"ifa","f":"jfa","a":"kfa"}')}}]);
//# sourceMappingURL=owa.319.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.319.js'] = 1;