(window.$wj=window.$wj||[]).push([[667],{16917:function(t){t.exports=JSON.parse('{"a":"x9a"}')},2155:function(t,e,n){"use strict";var a=n(925),r=n(712),c=n(915),o=n(927),u=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)Object(a.a)(e,Object(c.a)(t)),t=Object(r.a)(t);return e}:o.a;e.a=u},2485:function(t,e,n){"use strict";var a=n(926),r=n(2155),c=n(708);e.a=function(t){return Object(a.a)(t,c.a,r.a)}},2512:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,a=null==t?0:t.length;++n<a&&!1!==e(t[n],n,t););return t}},2524:function(t,e,n){"use strict";var a=n(471),r=n(2512),c=n(959),o=n(909),u=n(566);var i=function(t,e){return t&&Object(o.a)(e,Object(u.a)(e),t)},s=n(708);var b=function(t,e){return t&&Object(o.a)(e,Object(s.a)(e),t)},l=n(948),j=n(947),f=n(915);var g=function(t,e){return Object(o.a)(t,Object(f.a)(t),e)},O=n(2155);var d=function(t,e){return Object(o.a)(t,Object(O.a)(t),e)},v=n(816),m=n(2485),S=n(803),p=Object.prototype.hasOwnProperty;var y=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&p.call(t,"index")&&(n.index=t.index,n.input=t.input),n},h=n(944);var w=function(t,e){var n=e?Object(h.a)(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},A=/\w*$/;var x=function(t){var e=new t.constructor(t.source,A.exec(t));return e.lastIndex=t.lastIndex,e},M=n(366),R=M.a?M.a.prototype:void 0,E=R?R.valueOf:void 0;var I=function(t){return E?Object(E.call(t)):{}},N=n(949),k="[object Boolean]",C="[object Date]",U="[object Map]",$="[object Number]",_="[object RegExp]",D="[object Set]",L="[object String]",B="[object Symbol]",P="[object ArrayBuffer]",F="[object DataView]",K="[object Float32Array]",V="[object Float64Array]",W="[object Int8Array]",T="[object Int16Array]",H="[object Int32Array]",G="[object Uint8Array]",J="[object Uint8ClampedArray]",q="[object Uint16Array]",z="[object Uint32Array]";var Q=function(t,e,n){var a=t.constructor;switch(e){case P:return Object(h.a)(t);case k:case C:return new a(+t);case F:return w(t,n);case K:case V:case W:case T:case H:case G:case J:case q:case z:return Object(N.a)(t,n);case U:return new a;case $:case L:return new a(t);case _:return x(t);case D:return new a;case B:return I(t)}},X=n(951),Y=n(262),Z=n(518),tt=n(306),et="[object Map]";var nt=function(t){return Object(tt.a)(t)&&Object(S.a)(t)==et},at=n(930),rt=n(812),ct=rt.a&&rt.a.isMap,ot=ct?Object(at.a)(ct):nt,ut=n(252),it="[object Set]";var st=function(t){return Object(tt.a)(t)&&Object(S.a)(t)==it},bt=rt.a&&rt.a.isSet,lt=bt?Object(at.a)(bt):st,jt=1,ft=2,gt=4,Ot="[object Arguments]",dt="[object Function]",vt="[object GeneratorFunction]",mt="[object Object]",St={};St[Ot]=St["[object Array]"]=St["[object ArrayBuffer]"]=St["[object DataView]"]=St["[object Boolean]"]=St["[object Date]"]=St["[object Float32Array]"]=St["[object Float64Array]"]=St["[object Int8Array]"]=St["[object Int16Array]"]=St["[object Int32Array]"]=St["[object Map]"]=St["[object Number]"]=St[mt]=St["[object RegExp]"]=St["[object Set]"]=St["[object String]"]=St["[object Symbol]"]=St["[object Uint8Array]"]=St["[object Uint8ClampedArray]"]=St["[object Uint16Array]"]=St["[object Uint32Array]"]=!0,St["[object Error]"]=St[dt]=St["[object WeakMap]"]=!1;e.a=function t(e,n,o,f,O,p){var h,w=n&jt,A=n&ft,x=n&gt;if(o&&(h=O?o(e,f,O,p):o(e)),void 0!==h)return h;if(!Object(ut.a)(e))return e;var M=Object(Y.a)(e);if(M){if(h=y(e),!w)return Object(j.a)(e,h)}else{var R=Object(S.a)(e),E=R==dt||R==vt;if(Object(Z.a)(e))return Object(l.a)(e,w);if(R==mt||R==Ot||E&&!O){if(h=A||E?{}:Object(X.a)(e),!w)return A?d(e,b(h,e)):g(e,i(h,e))}else{if(!St[R])return O?e:{};h=Q(e,R,w)}}p||(p=new a.a);var I=p.get(e);if(I)return I;p.set(e,h),lt(e)?e.forEach((function(a){h.add(t(a,n,o,a,e,p))})):ot(e)&&e.forEach((function(a,r){h.set(r,t(a,n,o,r,e,p))}));var N=x?A?m.a:v.a:A?s.a:u.a,k=M?void 0:N(e);return Object(r.a)(k||e,(function(a,r){k&&(a=e[r=a]),Object(c.a)(h,r,t(a,n,o,r,e,p))})),h}},2927:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o}));var a=n(3),r=n(4189);const c=Object(a.createStore)("signature",Object(r.a)()),o=c()},4189:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var a=n(16);function r(){return{legacySignature:{html:null,txt:null},roamingSignatureMap:new a.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""}}},566:function(t,e,n){"use strict";var a=n(719),r=n(942),c=n(402);e.a=function(t){return Object(c.a)(t)?Object(a.a)(t):Object(r.a)(t)}},614:function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return o}));var a=n(132),r=n(13);function c(){return Object(a.a)("acctmonaccounts")&&Object(r.i)("acctmonaccounts")}function o(){return c()||!Object(a.a)("acctmonaccounts")&&Object(r.i)("accountsapi")}},6676:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return r})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return o})),n.d(e,"f",(function(){return u})),n.d(e,"i",(function(){return i})),n.d(e,"h",(function(){return s})),n.d(e,"e",(function(){return b})),n.d(e,"c",(function(){return l}));const a="/ows/beta/OutlookCloudSettings/settings/account",r="Roaming_Signature_List",c="Roaming_New_Signature",o="Roaming_Reply_Signature",u="signaturehtml",i="signaturetxt",s=r.toLowerCase(),b=c.toLowerCase(),l=o.toLowerCase()},6889:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var a=n(20);const r=new a.c(()=>n.e(1967).then(n.bind(null,10206)));let c=new a.a(r,t=>t.loadSignatureInUserOptions)},6916:function(t,e,n){"use strict";var a=n(2524),r=4;e.a=function(t){return Object(a.a)(t,r)}},717:function(t,e,n){"use strict";var a=n(328),r=n(247),c=Object(a.a)(r.a,"Set");e.a=c},7907:function(t,e,n){"use strict";n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return j})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return g}));var a=n(2927),r=n(327),c=n(6676),o=n(38);const u=621355968e9,i=1e4,s="encoding:utf-8",b={"x-outlook-client":"owa",Accept:"application/json","x-overridetimestamp":!0};function l(t){const e=[];t.forEach((t,n)=>{e.push(...function(t){var e,n;const a=null===(e=t.html)||void 0===e?void 0:e.name,r=t.txt?t.txt.value:"";return[O(a,null===(n=t.html)||void 0===n?void 0:n.value,"Blob","RoamingSetting","htm",!0,"roaming_signature_list"),O(a,r,"Blob","RoamingSetting","txt",!0,"roaming_signature_list")]}(t))}),e.length>0&&Object(r.d)(c.a,e,void 0,!0,Object.assign(Object.assign({},b),{"x-islargesetting":!0}))}function j(){const{roamingSignatureMap:t}=a.b,e=[];t.forEach(t=>{var n;(null===(n=t.html)||void 0===n?void 0:n.name)&&e.push(t.html.name)});const n=[O(c.g,e.join(),"BlobArray","RoamingSetting",c.g,!1)];Object(r.d)(c.a,n,void 0,!0,b)}function f(t){const e=[O(c.d,t,"String","RoamingSetting",c.d,!1)];Object(r.d)(c.a,e,void 0,!0,b)}function g(t){const e=[O(c.b,t,"String","RoamingSetting",c.b,!1)];Object(r.d)(c.a,e,void 0,!0,b)}function O(t,e,n,a,r,c,b){var l;const j={name:t,value:e,type:n,scope:null===(l=Object(o.a)().SessionSettings)||void 0===l?void 0:l.UserEmailAddress,itemClass:a,timestamp:u+Date.now()*i,secondaryKey:r,metadata:s};return b&&(j.parentSetting=b),c&&(j["value@is.Large"]=c),j}},803:function(t,e,n){"use strict";var a=n(328),r=n(247),c=Object(a.a)(r.a,"DataView"),o=n(475),u=Object(a.a)(r.a,"Promise"),i=n(717),s=Object(a.a)(r.a,"WeakMap"),b=n(347),l=n(434),j=Object(l.a)(c),f=Object(l.a)(o.a),g=Object(l.a)(u),O=Object(l.a)(i.a),d=Object(l.a)(s),v=b.a;(c&&"[object DataView]"!=v(new c(new ArrayBuffer(1)))||o.a&&"[object Map]"!=v(new o.a)||u&&"[object Promise]"!=v(u.resolve())||i.a&&"[object Set]"!=v(new i.a)||s&&"[object WeakMap]"!=v(new s))&&(v=function(t){var e=Object(b.a)(t),n="[object Object]"==e?t.constructor:void 0,a=n?Object(l.a)(n):"";if(a)switch(a){case j:return"[object DataView]";case f:return"[object Map]";case g:return"[object Promise]";case O:return"[object Set]";case d:return"[object WeakMap]"}return e});e.a=v},816:function(t,e,n){"use strict";var a=n(926),r=n(915),c=n(566);e.a=function(t){return Object(a.a)(t,c.a,r.a)}},9012:function(t,e,n){"use strict";n.r(e);var a=n(218),r=n(327),c=n(3),o=n(2927),u=Object(c.mutatorAction)("setDefaultSignatureName",(t,e)=>{e?Object(o.a)().defaultReplySignatureName=t:Object(o.a)().defaultSignatureName=t}),i=Object(c.mutatorAction)("setLegacySignatureInStore",(t,e)=>{"html"==t?Object(o.a)().legacySignature.html=e:"txt"==t&&(Object(o.a)().legacySignature.txt=e)}),s=Object(c.mutatorAction)("setRoamingSignatureInStore",t=>{const{roamingSignatureMap:e}=Object(o.a)();if("htm"==t.secondaryKey){let n=e.get(t.name);n?n.html=t:n={html:t,txt:null},e.set(t.name,n)}else if("txt"==t.secondaryKey){let n=e.get(t.name);n?n.txt=t:n={html:null,txt:t},e.set(t.name,n)}}),b=n(6676),l=n(57),j=n(7907),f=n(6),g=n(16917);const O="dataURI";function d(){var t,e;const{roamingSignatureMap:n,legacySignature:a}=Object(o.a)(),r=Object(l.g)().UserOptions,c=null===(t=a.html)||void 0===t?void 0:t.value;if(!c)return;const i=function(t){var e;const n=(new DOMParser).parseFromString(t,"text/html"),a=n.getElementsByTagName("img");for(let t=0;t<a.length;t++){let n=a[t];if(!n.currentSrc){let t=n.nextElementSibling;(null==t?void 0:t.id)==O&&(t.textContent&&(n.src=t.textContent),null===(e=n.parentElement)||void 0===e||e.removeChild(t))}}return n.body.innerHTML}(c),b={name:Object(f.b)(g.a),value:i,secondaryKey:"htm"};if(s(b),null===(e=a.txt)||void 0===e?void 0:e.value){const t={name:Object(f.b)(g.a),value:a.txt.value,secondaryKey:"txt"};s(t)}Object(j.c)(n),Object(j.d)(),r&&(r.AutoAddSignature&&(u(Object(f.b)(g.a),!1),Object(j.b)(Object(f.b)(g.a))),r.AutoAddSignatureOnReply&&(u(Object(f.b)(g.a),!0),Object(j.a)(Object(f.b)(g.a))))}let v;function m(t){return v&&!t||(v=Object(r.b)(`${b.a}?settingname=${b.f},${b.i},${b.h},${b.e},${b.c}`,void 0,!1,{"x-outlook-client":"owa"}).then(e=>{if(!t||t===Object(a.a)().selectedSourceId){let t;e.forEach(e=>{var n;switch(null===(n=e.name)||void 0===n?void 0:n.toLowerCase()){case b.f:i("html",e);break;case b.i:i("txt",e);break;case b.h:t=e.value,function(t){Object(r.b)(`${b.a}?settingname=${t}`,void 0,!1,{"x-islargesetting":!0}).then(t=>{t.forEach(t=>{s(t)})})}(e.value);break;case b.e:u(e.value,!1);break;case b.c:u(e.value,!0)}}),t&&""!=t||d()}})),v}var S=n(6889),p=n(38),y=n(47);function h(t){if(Object(y.j)("cmp-roaming-signature")&&!(null===(e=Object(p.a)().SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)){const e=Object(o.a)();if(null==e.legacySignature.html||null==e.legacySignature.txt)return m(t)}else{const t=Object(p.a)().UserOptions;if(t&&(null==t.SignatureHtml||null==t.SignatureText))return S.a.importAndExecute()}var e;return Promise.resolve()}var w=n(6916),A=n(614),x=n(20),M=n(255),R=n(4189);const E=new Map,I=Object(x.e)(M.k,"clone_onSelectedAccountChanged",t=>{if(!Object(A.b)())throw new Error(`Reset Signature store for account selection change is called when multi accounts is turned off. ${t.selectedEmailAddress}`);const e=Object(w.a)(o.b);E.set(t.oldSourceId,e);const n=E.get(t.selectedAccountSourceId);n?N(n):(N(Object(R.a)()),h(t.selectedAccountSourceId))}),N=Object(c.mutatorAction)("resetStoreForAccountSelectionChange",t=>{o.b.legacySignature=t.legacySignature,o.b.roamingSignatureMap=t.roamingSignatureMap,o.b.defaultSignatureName=t.defaultSignatureName,o.b.defaultReplySignatureName=t.defaultReplySignatureName});n.d(e,"loadSignature",(function(){return h})),n.d(e,"resetSignatureStoreOrchestrator",(function(){return I}))},915:function(t,e,n){"use strict";var a=n(945),r=n(927),c=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,u=o?function(t){return null==t?[]:(t=Object(t),Object(a.a)(o(t),(function(e){return c.call(t,e)})))}:r.a;e.a=u},925:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,a=e.length,r=t.length;++n<a;)t[r+n]=e[n];return t}},926:function(t,e,n){"use strict";var a=n(925),r=n(262);e.a=function(t,e,n){var c=e(t);return Object(r.a)(t)?c:Object(a.a)(c,n(t))}},927:function(t,e,n){"use strict";e.a=function(){return[]}},942:function(t,e,n){"use strict";var a=n(573),r=n(720),c=Object(r.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;e.a=function(t){if(!Object(a.a)(t))return c(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},945:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,a=null==t?0:t.length,r=0,c=[];++n<a;){var o=t[n];e(o,n,t)&&(c[r++]=o)}return c}}}]);
//# sourceMappingURL=owa.667.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.667.js'] = 1;