(window.$wj=window.$wj||[]).push([[611],{10789:function(e,t,n){"use strict";n.r(t);var r=n(9083);n.d(t,"getAdditionalPropertiesFromServer",(function(){return r.b})),n.d(t,"getItemProperties",(function(){return r.c})),n.d(t,"cleanUpByItemId",(function(){return r.a}))},1688:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1691);function i(){return Object(r.a)().folderTable}},1691:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(3),i=n(16);const o=Object(r.createStore)("folderStore",{folderTable:new i.ObservableMap,mailboxFolderTreeData:new i.ObservableMap}),s=o();t.a=o},1692:function(e,t,n){"use strict";var r=n(20),i=n(1693),o=n(2053),s=n(1868),a=n(1848);const u="ChronologicalNewestOnBottom";function c(e,t){return e[t==u?0:e.length-1]}var d=n(707),l=n(1701);function f(e){return Object(a.a)(e,Object(d.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(l.a)({FieldURI:"TailoredXpEntities"}),Object(l.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(l.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(l.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then(e=>{if(e&&!(e instanceof Error)){const{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}=e;return{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:i}}return{}})}var m=n(2091),b=n(38);function h(e){const t=i.a.conversations.get(e);if(t){const e=Object(b.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==e}return!1}var p=n(1937),v=n(1681);function g(e,t={folderTable:v.d.folderTable}){return!!t.folderTable.get(e)}var O=n(1679);function I(e,t){const n=v.d.folderTable.get(e);return!!n&&(Object(v.H)(n,O.d,t)||n.distinguishedFolderType===O.b)}function j(e){return I(e)||function(e){const t=v.d.folderTable.get(e);return t&&t.distinguishedFolderType===O.d}(e)}function y(e,t,n={folderTable:v.d.folderTable}){return Object(v.H)(e,t,n)}var S=n(1942),w=n(1895);function E(e){return e&&(Object(w.a)(e,O.i)||Object(w.a)(e,O.b))}function T(e){return e&&(y(e,O.h)||y(e,O.a))}var M=n(1986);function x(e,t){try{return P(e,t)}catch(e){return null}}function P(e,t){if(!e||!t)return null;const n=Object(v.m)().get(e).PermissionSet.Permissions.filter(e=>e.UserId.PrimarySmtpAddress===t);return null==n?void 0:n[0]}var C=n(296);const A="OneOff",R="Unknown";function F(e,t,n){return!Object(C.a)()&&(n==A||n==R)&&(null==e?void 0:e.indexOf(t))<0}var k=n(3),L=Object(k.mutatorAction)("setIsDraftQueuedForSubmission",(e,t)=>{const n=Object(i.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}),N=n(1758);n.d(t,"s",(function(){return B})),n.d(t,"u",(function(){return i.a})),n.d(t,"g",(function(){return i.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return s.a})),n.d(t,"e",(function(){return a.a})),n.d(t,"d",(function(){return c})),n.d(t,"t",(function(){return f})),n.d(t,"v",(function(){return m.a})),n.d(t,"q",(function(){return h})),n.d(t,"c",(function(){return p.a})),n.d(t,"r",(function(){return g})),n.d(t,"m",(function(){return I})),n.d(t,"l",(function(){return j})),n.d(t,"n",(function(){return y})),n.d(t,"j",(function(){return S.a})),n.d(t,"k",(function(){return E})),n.d(t,"p",(function(){return T})),n.d(t,"f",(function(){return M.a})),n.d(t,"h",(function(){return x})),n.d(t,"i",(function(){return P})),n.d(t,"o",(function(){return F})),n.d(t,"w",(function(){return L})),n.d(t,"x",(function(){return N.a}));const D=new r.c(()=>n.e(1960).then(n.bind(null,19870))),B=new r.a(D,e=>e.setTriageActionAnnouncement)},1693:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(16),i=n(3);const o={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}};let s=Object(i.createStore)("mail",o);const a=s();t.a=a},1698:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(66);function i(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1702:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(1691),i=n(57);function o(e){return s(e).folderTreeTable}function s(e){return e||(e=Object(i.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},1747:function(e,t,n){"use strict";var r=n(3);let i=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}});var o=i();function s(){return o.selectedNode}function a(){const e=s();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o}))},1758:function(e,t,n){"use strict";var r=n(47),i=n(132),o=n(57),s=n(20);const a=new s.c(()=>n.e(970).then(n.bind(null,19895))),u=new s.b(a,e=>e.isReadingPaneConversationEnabled);function c(){var e,t;if(Object(r.j)("mon-rp-unstackedConversation")){return 0==(null===(t=null===(e=Object(o.g)())||void 0===e?void 0:e.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)&&!function(){var e,t;let n=null;const r=u.tryImportForRender();if(r)n=r();else{const r=Object(i.a)("useNativeConversationOptions");let s=null===(e=Object(o.g)())||void 0===e?void 0:e.PrimeSettings;if(null==s?void 0:s.Items)for(let e of s.Items)if("ReadingPaneConversationOptions"===e.Id&&e.Value){const i=null===(t=e.Value.options)||void 0===t?void 0:t[0];n=r?null==i?void 0:i.conversationEnabledNativeHost:null==i?void 0:i.conversationEnabled;break}null==n&&(n=!r)}return n}()}return!1}n.d(t,"a",(function(){return c}))},1767:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));var r=n(1678),i=n(1698),o=n(1691),s=n(1792),a=n(1688),u=n(1835),c=n(1839),d=n(1818);function l(e,t){const n=Object(a.a)();if(t){return[...n.values()].filter(n=>n.distinguishedFolderType===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function f(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(u.a)(t);break;case"SharedMailbox":n=Object(c.a)(t);break;default:n=Object(s.a)(t)}const a=Object(d.a)();if("UserMailbox"==e&&n.distinguishedFolderType==Object(s.a)(t).distinguishedFolderType&&n.id){const e=a.map(e=>l(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.id):e.map(e=>e.id)}const f=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>o.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.id)}(n,t);for(let e=0;e<f.length;e++)-1==a.indexOf(Object(i.a)(f[e]))&&r.push(f[e]);return r}function m(e,t){const n=Object(a.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},1792:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1795),i=n(1679);function o(e){return Object(r.a)(i.k,e)}},1795:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1702);function i(e,t){const n=Object(r.a)(t),i=n&&n.get(e);return null==i?void 0:i.rootFolder}},1818:function(e,t,n){"use strict";var r=n(57),i=n(47);function o(e){var t;const n=Object(r.g)().SegmentationSettings,o=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(i.j)("cal-stickyNotesFolder")&&!o}var s=n(296);function a(){const e=Object(s.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(i.j)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}))},1835:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1795),i=n(1679);function o(e){return Object(r.a)(i.d,e)}},1839:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1795);function i(e){return Object(r.a)(e)}},1848:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2371),i=n(47),o=n(4);const s=new o.d(()=>Promise.all([n.e(8),n.e(10),n.e(13),n.e(33),n.e(584)]).then(n.bind(null,3381))),a=new o.a(s,e=>e.getItemViaGraphQL);function u(e,t,n,o,s,u,c,d,l){if(Object(i.j)("mon-rp-loadItemViaGql")){if(!e&&!d)throw new Error("getItem passed a null or undefined id");return a.importAndExecute(e,t,n,o,s,u,c,d,l)}return Object(r.a)(e,t,n,o,u,c,d)}},1868:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1869:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1901),i=n(1890);function o(e,t){if(!e)return null==t||t.addCheckpoint("HSR_NO_R"),Promise.reject(Object(r.a)("500","Server returned a null response!",null));const n=Array.isArray(e)?e:[e];for(const e of n)if(e&&!Object(i.a)(e))return null==t||t.addCheckpoint("HSR_R_E"),Promise.reject(Object(r.a)(e.ResponseCode,e.StackTrace,e.MessageText));return null==t||t.addCheckpoint("HSR_S"),Promise.resolve()}},1890:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r="Success";function i(e){return e&&e.ResponseClass==r}},1895:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(66);function i(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},1901:function(e,t,n){"use strict";function r(e,t,n){let r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);const i=new Error(r);return i.responseCode=e,i.fetchErrorType="ServerFailure",n&&(i.diagnosticInfo="MessageText= "+n),i}n.d(t,"a",(function(){return r}))},1937:function(e,t,n){"use strict";const r=new(n(957).a)(50);t.a=r},1942:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1895),i=n(1679);function o(e){return e&&(Object(r.a)(e,i.h)||Object(r.a)(e,i.a))}},1986:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1681),i=n(1747);function o(){const e=Object(i.c)();let t=null;return t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id,null==t?null:r.d.folderTable.get(t)}},2053:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},2091:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1693);function i(e){return r.a.items.get(e)}},2371:function(e,t,n){"use strict";var r=n(954),i=n(905);var o=n(955),s=n(261),a=n(36),u=n(1869);function c(e,t,n,c,d,l,f){const m=Object(s.b)();var b;return c&&(m.RequestServerVersion=c),l&&(m.ManagementRole=(b={UserRoles:["MailboxSearch"]},Object.assign({__type:"ManagementRoleType:#Exchange"},b))),Object(o.a)({Header:m,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map(e=>Object(i.a)({Id:e})):e?[Object(i.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:f})},d).then(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}).then(e=>Object(u.a)(e).then(()=>e)).then(t=>{if(!(null==t?void 0:t.length))return null;let n=[];return t.forEach(e=>{n=n.concat(e.Items)}),n.length?Array.isArray(e)||void 0!==f?n:n[0]:null}).catch(e=>(a.h.warn("GetItem:"+e.message),e))}n.d(t,"a",(function(){return c}))},611:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},614:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(132),i=n(13);function o(){return Object(r.a)("acctmonaccounts")&&Object(i.i)("acctmonaccounts")}function s(){return o()||!Object(r.a)("acctmonaccounts")&&Object(i.i)("accountsapi")}},704:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},9083:function(e,t,n){"use strict";var r=n(3),i=n(1692),o=Object(r.mutatorAction)("updateItemInStore",(e,t)=>{const n=i.u.items.get(e);n&&Object.keys(t).forEach(e=>{"ExtendedProperty"==e?n.ExtendedProperty=[...t.ExtendedProperty,...n.ExtendedProperty]:"ItemId"!=e&&(n[e]=t[e])})}),s=n(71),a=n(1848),u=n(1693),c=n(707),d=n(36),l=n(704);n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return g}));const f={},m={},b="GetItemManagerFailure";function h(e){e.forEach(e=>{m[e.featureId]=e})}function p(e,t){if(f[e]&&"Pending"==f[e].requestStatus)return;const{itemShape:n,defaultValues:r}=function(e,t){const n=[];let r={};if(Object.keys(m).forEach(i=>{const{isPropertyExistedOnItem:o,shouldGetItemPropertiesFromServer:s,propertyPaths:a,getDefaultValues:u}=m[i];!o(e)&&s(e,t)&&(n.push(...a),r=Object.assign(Object.assign({},r),null==u?void 0:u()))}),n.length>0)return{itemShape:Object(c.a)({BaseShape:"IdOnly",AdditionalProperties:n}),defaultValues:r};return{itemShape:null,defaultValues:null}}(e,t);if(!n)return;const i=u.a.items.get(e);if(!i)return;const h={itemId:e,listViewType:t,requestStatus:"Pending",pendingPromise:null};f[e]=h;const p=Object(l.a)(i.MailboxInfo);h.pendingPromise=Object(a.a)(e,n,null,null,i.MailboxInfo,p,null,null).then(t=>{if(!t||t instanceof Error)return t?(t.fetchErrorType="ServerFailure",Promise.reject(t)):Promise.resolve(null);{let n;h.requestStatus="Success",n=Array.isArray(t)?t[0]:t;const i=Object.assign(Object.assign({},r),n);return o(e,i),Promise.resolve(u.a.items.get(e))}}).catch(e=>(h.requestStatus="Error",Object(s.o)(b,{errorMessage:e.message}),d.h.warn(`[GetItemManager_getAdditionalPropertiesFromServer] Error: ${e.message}`),Promise.reject(e)))}function v(e,t){const n=m[t];if(!n)return Promise.reject(new Error("GetItemManager: The featureId is not registered in GetItemManager."));if(n.isPropertyExistedOnItem(e)||"WebExtNotifications"==t)return Promise.resolve(u.a.items.get(e));if(!f[e])return Promise.reject("GetItemManager: Please trigger getItem after the container finished loading.");{const t=f[e];switch(t.requestStatus){case"Success":return Promise.resolve(u.a.items.get(e));case"Pending":case"Error":return t.pendingPromise;default:return Promise.reject(new Error("GetItemManager: The request status is unknown."))}}}function g(e){delete f[e]}},957:function(e,t,n){"use strict";var r=n(702);class i{constructor(e){this.maxSize=e,this.references=[],this.mruList=[]}initialize(e,t){if(!this.store){this.store=e,this.deleteCallback=t;for(let t of e.keys())this.mruList.push(t)}}add(e,t){Object(r.action)("MruCache_add")(()=>{this.store.set(e,t),this.mruList.indexOf(e)>=0?this.touch(e):(this.mruList.push(e),this.purgeIfNecessary())})()}get(e){return this.store.get(e)}getAndTouch(e){const t=this.store.get(e);return t&&this.touch(e),t}has(e){return this.store.has(e)}remove(e){Object(r.action)("MruCache_remove")(()=>{if(this.store.has(e)&&!this.isReferenced(e))return this.removeItemAtIndex(this.mruList.indexOf(e))})()}registerReference(e){this.references.push(e)}clear(){Object(r.action)("MruCache_clear")(()=>{this.purgeTillSize(0)})()}getItemIds(){return new Array(...this.mruList)}touch(e){let t=this.mruList.indexOf(e);if(t<0)throw new Error(`Item with key '${e}' does not exist in the cache.`);this.mruList.splice(t,1),this.mruList.push(e)}purgeIfNecessary(){this.purgeTillSize(this.maxSize)}purgeTillSize(e){let t=0;for(;this.mruList.length>e&&t<this.mruList.length;){let e=this.mruList[t];this.isReferenced(e)?t++:this.removeItemAtIndex(t)}}removeItemAtIndex(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);let t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)}isReferenced(e){for(let t=0;t<this.references.length;t++){const n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1}}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.611.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.611.js'] = 1;