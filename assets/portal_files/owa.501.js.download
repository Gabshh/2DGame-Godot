(window.$wj=window.$wj||[]).push([[501],{11901:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));const r="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function o(e){var t,n;t=`${e} - start`,r&&(null===(n=null===performance||void 0===performance?void 0:performance.mark)||void 0===n||n.call(performance,t))}function c(e){var t,n;if(!r)return;try{null===(t=null===performance||void 0===performance?void 0:performance.measure)||void 0===t||t.call(performance,e,`${e} - start`)}catch(e){return}const o=performance&&performance.getEntriesByName(e);return null===(n=null===performance||void 0===performance?void 0:performance.clearMarks)||void 0===n||n.call(performance,`${e} - start`),o&&o.length>0?o.slice(-1)[0]:void 0}},123:function(e,t,n){var r;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var c=typeof r;if("string"===c||"number"===c)e.push(r);else if(Array.isArray(r)){if(r.length){var a=o.apply(null,r);a&&e.push(a)}}else if("object"===c)if(r.toString===Object.prototype.toString)for(var i in r)n.call(r,i)&&r[i]&&e.push(i);else e.push(r.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},15608:function(e){e.exports=JSON.parse('{"c":"c5b","b":"d5b","a":"e5b"}')},15609:function(e){e.exports=JSON.parse('{"a":"b5b"}')},1689:function(e,t,n){"use strict";var r=n(1849),o=n(1803),c=n(3);const a=Object(c.action)("INITIALIZE_SCENARIO_STORE",(e,t)=>({scenarioId:e,isUsing3S:t}));Object(c.mutator)(a,e=>{const t=Object(r.a)(e.scenarioId);Object(o.b)().scenarioStores.get(t)||(Object(o.b)().scenarioStores.set(t,Object.assign({},Object(o.a)())),Object(o.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)});var i=n(1891),s=n(2068);n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return o.a})),n.d(t,"c",(function(){return r.a})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s.a}))},1704:function(e,t,n){"use strict";var r=n(3);const o=Object(r.action)("ADD_SUGGESTION_PILL",(e,t,n)=>({suggestionPill:e,suggestionSelected:t,scenarioId:n})),c=Object(r.action)("ADD_SUGGESTION_PILL_INTERNAL",(e,t)=>({suggestionPill:e,scenarioId:t})),a=Object(r.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",(e,t,n)=>({indexToSelect:e,suggestionToSelect:t,scenarioId:n}));var i=n(2179);const s=Object(r.action)("DOWNLOAD_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n})),u=Object(r.action)("END_SEARCH_CONVERSATION",e=>({scenarioId:e}));var d=n(2180);const l=Object(r.action)("EXIT_SEARCH",(e,t,n=!1)=>({actionSource:e,scenarioId:t,forceExit:n})),b=Object(r.action)("GET_FILE_SUGGESTION_IMMERSIVE_VIEW",e=>({suggestion:e}));var f=n(2069),O=n(1689);const S=Object(r.mutatorAction)("OVERWRITE_EXISTING_SUGGESTION_PILL",(e,t,n)=>{const r=Object(O.d)(n),o=e.ReferenceId;r.suggestionPills.delete(t),r.suggestionPills.set(o,e);const c=r.suggestionPillIds.indexOf(t);r.suggestionPillIds[c]=o});var g=n(2181),j=n(2182);const p=Object(r.action)("ON_ENTER_PRESSED_SEARCH_INPUT",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t})),h=Object(r.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",e=>({scenarioId:e})),I=Object(r.action)("ON_KEY_DOWN_SEARCH_INPUT",(e,t)=>({evtKeyCode:e,scenarioId:t}));var m=n(2183);const v=Object(r.action)("ON_RESIZE_SUGGESTIONSCALLOUT",(e,t)=>({searchBoxWidth:e,scenarioId:t})),E=Object(r.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}));var T=n(80);const P=Object(r.action)("ON_SEARCH_INPUT_FOCUSED",e=>Object(T.b)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e}));var _=n(2209),F=n(2210);const y=Object(r.action)("onSearchScopeUiDismissed",e=>({searchScenarioType:e})),w=Object(r.action)("ON_SEARCH_TEXT_CHANGED",(e,t)=>({searchText:e,scenarioId:t})),C=Object(r.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",e=>({scenarioId:e})),A=Object(r.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",e=>({scenarioId:e}));var R=n(2184);const k=Object(r.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",(e,t)=>({scenarioId:e,callback:t}));var N=n(2185);const x=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",(e,t,n)=>({suggestionPillId:e,suggestionPillIndex:t,scenarioId:n})),D=Object(r.action)("RESET_CURRENT_SUGGESTIONS",e=>({scenarioId:e}));var L=n(2150);const M=Object(r.action)("SEARCH_BOX_BLURRED",e=>({scenarioId:e})),U=Object(r.action)("SEARCH_SESSION_ENDED",(e,t,n,r)=>({searchSessionGuid:e,scenarioId:t,latestTraceId:n,actionSource:r}));var G=n(1988);const H=Object(r.action)("SET_CURRENT_SUGGESTIONS",(e,t,n=null)=>({suggestionSet:e,scenarioId:t,qfRequestId:n})),V=Object(r.action)("SET_DISPLAYED_QF_REQUEST_TIME",(e,t)=>({displayedQFRequestTime:e,scenarioId:t}));var B=n(2186);const Q=Object(r.action)("SET_LATEST_TRACE_ID",(e,t,n)=>({latestTraceId:e,scenarioId:t,isQFTraceId:n})),q=Object(r.action)("SET_SEARCH_TEXT",(e,t)=>({searchText:e,scenarioId:t})),K=Object(r.action)("SET_SELECTED_PILL_INDEX",(e,t)=>({selectedPillIndex:e,scenarioId:t})),W=Object(r.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",(e,t)=>({searchTextForSuggestion:e,scenarioId:t})),z=Object(r.action)("SET_SELECTED_SUGGESTION_INDEX",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t}));var X=n(2187);const Z=Object(r.action)("SET_SUGGESTION_PILL_IDS",(e,t)=>({suggestionPillIds:e,scenarioId:t})),$=Object(r.action)("SET_SUGGESTION_PILLS",(e,t)=>({suggestionPills:e,scenarioId:t})),J=Object(r.action)("SHARE_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n}));var Y=n(1985);const ee=Object(r.action)("START_SEARCH_SESSION",(e,t,n)=>({actionSource:e,shouldStartSearch:t,scenarioId:n})),te=Object(r.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",(e,t,n,r,o,c)=>({suggestion:e,suggestionIndex:t,actionSource:n,scenarioId:r,suggestionSetTraceId:o,entityActionTakenType:c})),ne=Object(r.action)("SUGGESTION_SELECTED",(e,t,n,r,o)=>({suggestion:e,actionSource:t,scenarioId:n,suggestionSetTraceId:r,index:o}));var re=n(2188);const oe=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",(e,t)=>({isComplete:e,scenarioId:t})),ce=Object(r.action)("COMPLETE_GHOST_TEXT",(e,t)=>({scenarioId:e,evt:t})),ae=Object(r.action)("CLEAR_GHOST_TEXT",e=>({scenarioId:e})),ie=Object(r.action)("SET_GHOST_TEXT",(e,t)=>({scenarioId:e,ghostText:t}));var se=n(2189),ue=n(1703);n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i.a})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d.a})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return f.a})),n.d(t,"N",(function(){return S})),n.d(t,"w",(function(){return g.a})),n.d(t,"y",(function(){return j.a})),n.d(t,"z",(function(){return p})),n.d(t,"A",(function(){return h})),n.d(t,"B",(function(){return I})),n.d(t,"C",(function(){return m.a})),n.d(t,"D",(function(){return v})),n.d(t,"E",(function(){return E})),n.d(t,"F",(function(){return P})),n.d(t,"G",(function(){return _.a})),n.d(t,"H",(function(){return F.a})),n.d(t,"I",(function(){return y})),n.d(t,"J",(function(){return w})),n.d(t,"K",(function(){return C})),n.d(t,"L",(function(){return A})),n.d(t,"M",(function(){return R.a})),n.d(t,"O",(function(){return k})),n.d(t,"P",(function(){return N.a})),n.d(t,"Q",(function(){return x})),n.d(t,"R",(function(){return D})),n.d(t,"S",(function(){return L.a})),n.d(t,"T",(function(){return M})),n.d(t,"U",(function(){return U})),n.d(t,"V",(function(){return G.a})),n.d(t,"W",(function(){return H})),n.d(t,"X",(function(){return V})),n.d(t,"Z",(function(){return B.a})),n.d(t,"ab",(function(){return Q})),n.d(t,"bb",(function(){return q})),n.d(t,"db",(function(){return K})),n.d(t,"cb",(function(){return W})),n.d(t,"eb",(function(){return z})),n.d(t,"fb",(function(){return X.a})),n.d(t,"gb",(function(){return Z})),n.d(t,"hb",(function(){return $})),n.d(t,"ib",(function(){return J})),n.d(t,"jb",(function(){return Y.a})),n.d(t,"kb",(function(){return ee})),n.d(t,"lb",(function(){return te})),n.d(t,"mb",(function(){return ne})),n.d(t,"nb",(function(){return re.a})),n.d(t,"ob",(function(){return oe})),n.d(t,"f",(function(){return ce})),n.d(t,"d",(function(){return ae})),n.d(t,"Y",(function(){return ie})),n.d(t,"x",(function(){return se.a})),n.d(t,"m",(function(){return ue.a})),n.d(t,"n",(function(){return ue.b})),n.d(t,"o",(function(){return ue.c})),n.d(t,"q",(function(){return ue.e})),n.d(t,"r",(function(){return ue.f})),n.d(t,"s",(function(){return ue.g})),n.d(t,"t",(function(){return ue.h})),n.d(t,"u",(function(){return ue.i})),n.d(t,"v",(function(){return ue.k})),n.d(t,"p",(function(){return ue.d}))},1746:function(e,t,n){"use strict";const r={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"};let o=0;function c(e="id"){return`${e}${o++}`}function a(e){return Array.isArray(e)?e.join(" "):e}function i(e){if(!e)return null;let t={},n=Object.keys(e);for(let r=0;r<n.length;r++){switch(n[r]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=a(e.controls);break;case"describedBy":t["aria-describedby"]=a(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=a(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=a(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=a(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=a(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=a(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return i}))},1764:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(0),n.e(28),n.e(643)]).then(n.bind(null,3857)));let c=new r.a(o,e=>e.logLocalContentDataSource),a=new r.a(o,e=>e.logLocalContentLayout),i=new r.a(o,e=>e.clearLocalContentInstrumentationCache),s=new r.b(o,e=>e.getLocalContentId);const u=new r.b(o,e=>e.substrateSearchInitOperation),d=(new r.b(o,e=>e.substrateSearchPostSuggestionsService),new r.b(o,e=>e.deleteSubstrateSearchHistoryService)),l=new r.b(o,e=>e.exportSubstrateSearchHistoryService)},1794:function(e,t,n){"use strict";var r=n(16),o=n(3),c=n(3894);function a(e){return Math.floor(Math.random()*e+1)}n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return u}));const i={toDate:null,fromDate:null,includeAttachments:!1,initialSearchScope:null,isSearchHistoryDirty:!1,isAnswerInitialized:!1,isAnswerLocalizationCompleted:!1,isUnread:!1,isToMe:!1,isFlagged:!1,isMentioned:!1,previousNode:null,searchNumber:0,staticSearchScope:null,staticSearchScopeList:null,shouldShowAdvancedSearch:!1,advancedSearchViewState:Object(c.a)(),initialAdvancedSearchViewState:Object(c.a)(),legacySuggestions:new r.ObservableMap({}),recipientForPersonalizedGhostTextIndex:a(9),generalizedGhostTextBankIndex:a(3),personalizedGhostTextBankIndex:a(7),usePersonalGhostText:!1,isAnswerAvailable:!1,provider:null,isAlterationRecourse:!1,filtersInstrumentationContext:null,answersPositionAndPropertyMapping:new r.ObservableMap,serpHasScrolled:!1},s=Object.assign({},i),u=Object(o.createStore)("mailSearchStore",s),d=u();t.a=d},1836:function(e,t,n){"use strict";var r,o,c;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(c||(c={}))},1892:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},1914:function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"j",(function(){return a})),n.d(t,"v",(function(){return i})),n.d(t,"l",(function(){return s})),n.d(t,"o",(function(){return u})),n.d(t,"r",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return f})),n.d(t,"h",(function(){return O})),n.d(t,"e",(function(){return S})),n.d(t,"d",(function(){return g})),n.d(t,"f",(function(){return j})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return h})),n.d(t,"p",(function(){return I})),n.d(t,"q",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"u",(function(){return E})),n.d(t,"a",(function(){return T})),n.d(t,"s",(function(){return P})),n.d(t,"t",(function(){return _}));var r=n(20);const o=new r.c(()=>n.e(1009).then(n.bind(null,3021)));let c=new r.a(o,e=>e.logEntityClicked);const a=new r.a(o,e=>e.logResponseReceived);let i=new r.a(o,e=>e.logSessionEnd),s=new r.a(o,e=>e.logResponseRendered);const u=new r.a(o,e=>e.logSearchBoxStateChanged);let d=new r.a(o,e=>e.logSearchResultInteraction),l=new r.a(o,e=>e.logResponseNeverRendered);const b=new r.a(o,e=>e.flushNonRenderedResponseReceivedItemsFromCache),f=new r.a(o,e=>e.logCachedContentRendered);let O=new r.a(o,e=>e.logFeedback);const S=new r.a(o,e=>e.logClientLayout),g=new r.a(o,e=>e.logClientDataSource),j=new r.a(o,e=>e.logEntitiesFromFilePicker),p=new r.a(o,e=>e.logResponseRecievedV2),h=new r.a(o,e=>e.logResultsRendered),I=new r.a(o,e=>e.logSearchEntityActions),m=new r.a(o,e=>e.logSearchFeedbackActions),v=new r.a(o,e=>e.logSearchActions);let E=new r.a(o,e=>e.logSecondaryEntityActionClicked);const T=new r.a(o,e=>e.clearProcessedTraceIds),P=new r.a(o,e=>e.logSearchSuggestionsClientLayoutEvent),_=new r.a(o,e=>e.logSearchSuggestionsResultsRenderedEvent)},2150:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("RESET_SEARCH_STORE",e=>({scenarioId:e}))},2179:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("CLEAR_SEARCH_BOX",e=>({scenarioId:e}))},2180:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("END_SEARCH_SESSION",(e,t)=>({scenarioId:e,actionSource:t}))},2181:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2182:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2183:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2184:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2185:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",(e,t,n)=>({suggestionPillId:e,scenarioId:t,actionSource:n}))},2186:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",(e,t)=>({isSuggestionsDropdownVisible:e,scenarioId:t}))},2187:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("setShowSearchBoxInCompactMode",(function(e,t){return{scenarioId:e,showSearchBoxInCompactMode:t}}))},2188:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",(e,t)=>({isComplete:e,scenarioId:t}))},2189:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("ON_DISMISS_GHOST_TEXT_VIA_KEYBOARD",e=>({scenarioId:e}))},2209:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(3),o=n(80);const c=Object(r.action)("onSearchScopeButtonClicked",(e,t)=>Object(o.b)({name:"Search_ScopeButtonClicked",customData:{isFolderScopeVisible:e,searchScenarioType:t}},{isScopeVisible:e,searchScenarioType:t}))},2210:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("onSearchScopeOptionSelected",(e,t)=>({selectedSearchScope:e,searchScenarioType:t}))},2292:function(e,t,n){"use strict";var r=n(2528),o=n(20),c=n(2695),a=n(2484);function i(){let e=Object(a.a)();return{isFullOptionsShown:e.isFullOptionsShown,areAllAllowedSubCategoriesLoaded:e.areAllAllowedSubCategoriesLoaded,currentCategoryKey:e.currentCategoryKey,currentSubCategoryKey:e.currentSubCategoryKey,currentOptionKey:e.currentOptionKey}}n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return i}));const s=new o.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(267)]).then(n.bind(null,19619)));let u=new o.a(s,e=>e.mountAndShowFullOptions),d=new o.b(s,e=>e.hideFullOptions),l=new o.b(s,e=>e.confirmDirtyOptionsAndPerformAction),b=new o.b(s,e=>e.exitOptionsFullPage);var f=Object(r.a)(s,e=>e.QuickOptions);Object(o.f)(c.a,s,e=>e.mountFullOptionsOrchestrator)},2484:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(16),o=n(3);const c=Object(o.createStore)("optionsViewState",{isFullOptionsShown:!1,areAllAllowedSubCategoriesLoaded:!1,isSaving:!1,currentCategoryKey:null,currentSubCategoryKey:null,subCategoryLoadState:new r.ObservableMap,currentOptionKey:null,allowedOptions:[],dirtyOptions:[]})},2523:function(e,t,n){"use strict";var r=n(1689),o=n(3),c=n(1704);Object(o.mutator)(c.W,e=>{const t=e.suggestionSet;Object(r.d)(e.scenarioId).currentSuggestions=t}),Object(o.mutator)(c.R,e=>{const t=Object(r.b)();Object(r.d)(e.scenarioId).currentSuggestions=t.currentSuggestions}),Object(o.mutator)(c.Z,e=>{Object(r.d)(e.scenarioId).isSuggestionsDropdownVisible=e.isSuggestionsDropdownVisible});Object(o.mutator)(c.bb,e=>{Object(r.d)(e.scenarioId).searchText=e.searchText});var a=n(71);Object(o.mutator)(c.b,e=>{const t=Object(r.d)(e.scenarioId),n=e.suggestionPill,o=n.ReferenceId;t.suggestionPills.set(o,n),t.suggestionPillIds.push(o);const c=t.suggestionPillIds.length;c>=3&&Object(a.o)("Search_ManyPeoplePills",{NumberOfPeoplePills:c,ScreenWidth:window.screen.width,SearchSessionGuid:t.searchSessionGuid})}),Object(o.mutator)(c.ab,e=>{const t=Object(r.d)(e.scenarioId),n=e.latestTraceId;t.latestTraceId=n,e.isQFTraceId&&(t.latestQFTraceId=n)});Object(o.mutator)(c.F,e=>{Object(r.d)(e.scenarioId).searchBoxHasFocus=!0}),Object(o.mutator)(c.T,e=>{Object(r.d)(e.scenarioId).searchBoxHasFocus=!1});Object(o.mutator)(c.cb,e=>{Object(r.d)(e.scenarioId).searchTextForSuggestion=e.searchTextForSuggestion});var i=Object(o.mutatorAction)("setLatestRenderedQFTraceId",(e,t)=>{Object(r.d)(t).latestRenderedQFTraceId=e}),s=n(2643),u=n(1764),d=n(1914),l=(Object(o.orchestrator)(c.h,e=>{const{scenarioId:t}=e;d.b.importAndExecute(Object(s.a)(t)),u.a.importAndExecute(),d.a.importAndExecute()}),n(326)),b=n(16);Object(o.mutator)(c.jb,e=>{const{scenarioId:t,actionSource:n}=e,o=Object(r.d)(t);t===r.a.Mail&&(o.currentSearchQueryId=o.nextSearchQueryId,o.nextSearchQueryId=Object(l.a)(),o.answerPlaceholderId=Object(l.a)(),o.isAnswerRendered=!1,o.tableViewId=null,o.placeholderIdToIsRenderedMap=new b.ObservableMap),o.queryActionSource=n,o.queryAlterationType=null});Object(o.mutator)(c.W,e=>{Object(r.d)(e.scenarioId).traceIdToLogicalIdMap.set(e.suggestionSet.TraceId,e.qfRequestId)});Object(o.mutator)(c.h,e=>{const t=Object(r.d)(e.scenarioId),n=Object(r.b)();t.latestQFRequestId=n.latestQFRequestId,t.searchTextForSuggestion=n.searchTextForSuggestion,t.currentSuggestions=n.currentSuggestions,t.selectedSuggestionIndex=n.selectedSuggestionIndex}),Object(o.orchestrator)(c.F,e=>{const t=e.scenarioId,{searchSessionGuid:n,searchText:o,searchTextForSuggestion:a}=Object(r.d)(t);if(Object(c.Z)(!0,t),n){if(o&&o===a)return;Object(c.cb)(o,t),Object(c.l)(t)}else Object(c.kb)("SearchBox",!1,t)});var f=n(3241),O=(Object(o.orchestrator)(c.z,e=>{const{scenarioId:t,selectedSuggestionIndex:n}=e,o=Object(r.d)(t);n!==Object(r.b)().selectedSuggestionIndex?(Object(c.mb)(o.currentSuggestions.Suggestions[n],"keyboard",t,o.currentSuggestions.TraceId,n),o.searchText||(Object(c.J)("",t),Object(c.cb)("",t))):Object(f.a)(t)||Object(c.jb)("Keyboard",t,!0),Object(c.Z)(!1,t)}),Object(o.orchestrator)(c.J,e=>{const{scenarioId:t,searchText:n}=e;Object(c.bb)(n,t)}),n(1856));var S=n(3448),g=Object(o.mutatorAction)("setSearchSessionGuid",(e,t)=>{Object(r.d)(t).searchSessionGuid=e}),j=n(47);function p(e){if(e!==r.a.Mail)return null;const t=[];return Object(j.j)("sea-files-mru")&&t.push("ZQFileSuggestionsOwa"),Object(j.j)("sea-joinEventSuggestion")&&t.push("CalIncludeOngoing"),Object(j.j)("sea-bestmatch-v15")&&t.push("OWA_BestMatch_V15"),Object(j.j)("sea-bestmatch-v23")&&t.push("OWA_BestMatch_V23"),Object(j.j)("sea-bestmatch-v27")&&t.push("OWA_BestMatch_V27_no_headers"),(Object(j.j)("sea-calendarAnswer-v2")||Object(j.j)("sea-calendarAnswer-v3"))&&t.push("CalendarInsightsFlight"),Object(j.j)("sea-ghostingSuggestion")&&t.push("ClientEnableGhostingSuggestion"),t.length>0?t.join(","):null}Object(o.orchestrator)(c.kb,e=>{const{actionSource:t,shouldStartSearch:n,scenarioId:o}=e,i=Object(r.d)(o);if(i.searchSessionGuid)throw new Error("searchSessionGuid should not be set when starting a search session.");const d=Object(l.a)();g(d,o),Object(S.a)(Object(l.a)(),o),i.isUsing3S&&o!==r.a.Mail&&u.g.import().then(e=>{e(i.nextSearchQueryId,Object(s.a)(o),p(o),1)}),Object(c.V)(t,n,o),c.m.import(),c.n.import(),O.j.import(),c.t.import(),O.n.import(),Object(a.o)("Search_SessionStarted",[r.a[o],t])});var h=n(4240),I=(Object(o.orchestrator)(c.O,e=>{Object(h.b)(e.scenarioId,e.callback)}),n(1836));Object(o.orchestrator)(c.a,e=>{const t=e.scenarioId,n=e.suggestionPill;if(!n)return;const o=function(e,t){const n=Object(r.d)(t);switch(e.kind){case I.c.People:{const t=[...n.suggestionPills.values()].filter(t=>{if(t.kind!==I.c.People)return!1;for(const n of e.EmailAddresses)for(const e of t.EmailAddresses)if(n===e)return!0;return!1});return 1==t.length?t[0].ReferenceId:null}case I.c.Category:return n.suggestionPillIds.indexOf(e.ReferenceId)>-1?e.ReferenceId:null;default:return null}}(n,t);o?Object(c.N)(n,o,t):Object(c.b)(n,t),e.suggestionSelected&&(Object(c.J)("",t),Object(c.cb)("",t))});function m(e){const t=Object(r.d)(r.a.Mail),{suggestionPills:n}=t;let o=e.SearchTerms;return n.forEach(e=>{switch(e.kind){case I.c.People:{const t=e,n=t.DisplayName.toLowerCase().split(" ");v(o,n),v(o,t.EmailAddresses);break}case I.c.Category:{const t=e.Name.toLowerCase().split(" ");v(o,t)}}}),o}function v(e,t){t.forEach(t=>{!function(e,t){let n=-1;for(var r=0;r<e.length;r++)0==e[r].localeCompare(t,"en",{sensitivity:"base",ignorePunctuation:!0})&&(n=r);n>-1&&e.splice(n,1)}(e,t)})}n(2082);var E=n(2581),T=n(3203),P=n(3405),_=n(3569),F=n(3449);function y(e){const t=Object(r.d)(e).suggestionPills;return!(!t||0===t.size)&&[...t.values()].filter(e=>e.kind===I.c.People).length>0}n.d(t,"t",(function(){return i})),n.d(t,"d",(function(){return m})),n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return E.a})),n.d(t,"e",(function(){return T.a})),n.d(t,"j",(function(){return P.a})),n.d(t,"a",(function(){return _.a})),n.d(t,"f",(function(){return F.a})),n.d(t,"s",(function(){return y})),n.d(t,"q",(function(){return O.m})),n.d(t,"r",(function(){return O.n})),n.d(t,"b",(function(){return O.b})),n.d(t,"c",(function(){return O.d})),n.d(t,"k",(function(){return O.f})),n.d(t,"m",(function(){return O.h})),n.d(t,"n",(function(){return O.i})),n.d(t,"o",(function(){return O.j})),n.d(t,"l",(function(){return O.g})),n.d(t,"p",(function(){return O.k}))},2525:function(e,t,n){"use strict";var r=n(2899),o=n(2660),c=n(1678),a=n(1721),i=n(1692),s=function(e,t){const n=Object(c.a)(e)||e;Object(i.r)(n)?Object(a.isFolderInFavorites)(n)?Object(o.a)(n,"favorites",t):Object(o.a)(n,"primaryFolderTree",t):Object(r.a)(t)},u=n(1747);function d(e,t){const n=Object(u.c)();return(null==n?void 0:n.id)&&n.treeType==t&&e.toLowerCase()==n.id.toLowerCase()}function l(e,t,n){const r=Object(u.c)();return(null==r?void 0:r.id)&&(null==r?void 0:r.groupId)&&r.treeType==n&&e.toLowerCase()==r.groupId.toLowerCase()&&t.toLowerCase()==r.id.toLowerCase()}var b=n(1827),f=n(3),O=n(4174);Object(f.orchestrator)(O.a,e=>{s("notes",e.actionSource)});n.d(t,"o",(function(){return r.a})),n.d(t,"p",(function(){return o.a})),n.d(t,"q",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return l})),n.d(t,"n",(function(){return b.m})),n.d(t,"i",(function(){return b.h})),n.d(t,"h",(function(){return b.g})),n.d(t,"j",(function(){return b.i})),n.d(t,"g",(function(){return b.f})),n.d(t,"l",(function(){return b.k})),n.d(t,"m",(function(){return b.l})),n.d(t,"f",(function(){return b.e})),n.d(t,"e",(function(){return b.d})),n.d(t,"c",(function(){return b.b})),n.d(t,"d",(function(){return b.c})),n.d(t,"k",(function(){return b.j}))},2528:function(e,t,n){"use strict";var r=n(0),o=n(567),c=n(20),a=n(705);function i(e,t,n,i){return Object(c.d)(e,e=>{const n=t(e);return e=>r.createElement(o.ApolloProvider,{client:Object(a.a)()},r.createElement(n,Object.assign({},e)))},n,i)}n.d(t,"a",(function(){return i}))},2581:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(38);function o(){return Object(r.a)().SessionSettings.IsSubstrateSearchServiceAvailable}},2643:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1689),o=n(1892);function c(e){switch(e){case r.a.Mail:return o.b.Mail;case r.a.Calendar:return o.b.Calendar;case r.a.FilesHub:return o.b.FilesHub;case r.a.FileSuggestions:return o.b.FileSuggestions;default:throw Error(`No corresponding SubstrateSearchScenario for given SearchScenarioId (${e}).`)}}},2695:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("mountFullOptions",(e,t,n)=>({category:e,subcategory:t,option:n}))},2864:function(e,t,n){"use strict";var r=n(20),o=n(3496),c=n(1794),a=n(2047),i=n(3287),s=n(3059),u=n(3444),d=(n(2871),n(4110)),l=n(4111);function b(e){return Object(l.a)()||Object(d.a)()||Object(c.c)().isUnread||Object(c.c)().isToMe||Object(c.c)().isFlagged||Object(c.c)().isMentioned||!!(null==e?void 0:e.viewFilter)&&"All"!==(null==e?void 0:e.viewFilter)}var f=n(1995);n.d(t,"a",(function(){return S})),n.d(t,"l",(function(){return g})),n.d(t,"b",(function(){return o.b})),n.d(t,"q",(function(){return c.a})),n.d(t,"g",(function(){return c.c})),n.d(t,"e",(function(){return a.a})),n.d(t,"s",(function(){return a.g})),n.d(t,"r",(function(){return a.e})),n.d(t,"f",(function(){return i.a})),n.d(t,"h",(function(){return s.a})),n.d(t,"i",(function(){return u.a})),n.d(t,"j",(function(){return b})),n.d(t,"m",(function(){return f.i})),n.d(t,"d",(function(){return f.d})),n.d(t,"c",(function(){return f.c})),n.d(t,"n",(function(){return f.j})),n.d(t,"o",(function(){return f.k})),n.d(t,"p",(function(){return f.m})),n.d(t,"k",(function(){return f.h}));const O=new r.c(()=>Promise.all([n.e(0),n.e(6),n.e(7),n.e(8),n.e(264)]).then(n.bind(null,5242))),S=Object(r.d)(O,e=>e.AnswersContainer);let g=new r.a(O,e=>e.initializeAndWarmupAnswers)},2871:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1794),o=n(47),c=n(2581),a=n(57);function i(){const{staticSearchScope:e}=Object(r.c)(),t=null==e?void 0:e.kind;return"SharedFolders"===t||"PublicFolder"===t?"FindItem":Object(a.g)().SessionSettings.IsExplicitLogon?"ArchiveMailbox"===t?"FindItem":"PrimaryMailbox"===t&&Object(c.a)()?"SubstrateSearch":"ExecuteSearch":"PrimaryMailbox"===t?Object(c.a)()?Object(o.j)("sea-v23sQueryApi2")&&!Object(o.j)("sea-v13sQueryApiHoldback")?"SubstrateSearchV2":"SubstrateSearch":"ExecuteSearch":"ArchiveMailbox"===t?Object(o.j)("sea-archive-mailbox-3S-2")&&Object(c.a)()?"SubstrateSearch":"ExecuteSearch":"Group"===t?"ExecuteSearch":null}},3059:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var r=n(47),o=n(2581),c=n(478),a=n(2871);function i(){return Object(o.a)()&&(Object(r.j)("sea-fetchPeople3")||Object(r.j)("sea-fetchEvents2")||Object(r.j)("sea-calendarTriggerControl2")||Object(r.j)("sea-fetchFlights2")||Object(r.j)("sea-flightTriggerControl2")||Object(r.j)("sea-fetchFiles4")||Object(r.j)("sea-fileTriggerControl4")||Object(r.j)("sea-peopleTriggerControl3")||Object(r.j)("sea-answers-sdf")||Object(r.j)("sea-answers-ms"))||Object(o.a)()&&Object(c.a)()&&(Object(r.j)("sea-fetchBookmarks2")||Object(r.j)("sea-bookmarkTriggerControl2")||Object(r.j)("sea-fetchAcronyms3")||Object(r.j)("sea-fetchLinks2")||Object(r.j)("sea-linkTriggerControl2")||Object(r.j)("sea-acronymTriggerControl3")||Object(r.j)("sea-answers-sdf")||Object(r.j)("sea-answers-ms"))}function s(){return i()&&Object(r.j)("sea-v23sQueryApi2")&&Object(r.j)("sea-single3sQueryCallForAnswersAndSerp")&&"SubstrateSearchV2"===Object(a.a)()}},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function c(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function a(e){return r.test(e)}},3287:function(e,t,n){"use strict";function r(e){const t=e.tableQuery;if(0===t.type)return t.folderId;if(function(e){if(1!=e.type)return!1;const t=e.searchScope;return["PrimaryMailbox","ArchiveMailbox","SharedFolders"].indexOf(t.kind)>-1}(t)){return t.searchScope.folderId}return null}n.d(t,"a",(function(){return r}))},3405:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(47),o=n(296);function c(){return Object(r.j)("sea-modernFileSuggestions")&&!Object(o.a)()}},3444:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(47);function o(){return Object(r.j)("sea-interactiveFiltersAll")||Object(r.j)("sea-interactiveFiltersUnreadTime")}},3448:function(e,t,n){"use strict";var r=n(1689),o=n(3);t.a=Object(o.mutatorAction)("setNextSearchQueryId",(e,t)=>{Object(r.d)(t).nextSearchQueryId=e})},3449:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1689);function o(e){return Object(r.d)(e).searchBoxWidth}},3496:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(1836);const o=[r.c.File,r.c.People,r.c.Keywords],c=[r.c.File,r.c.People,r.c.Keywords,r.c.Message,r.c.Event,r.c.Category,r.c.TrySuggestion,r.c.Setting]},3894:function(e,t,n){"use strict";function r(){return{selectedSearchScope:null,subjectFieldText:"",keywordsFieldText:"",fromDate:null,toDate:null,hasAttachments:null,fromPeopleSuggestions:[],toPeopleSuggestions:[],ccPeopleSuggestions:[]}}n.d(t,"a",(function(){return r}))},4110:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1794);function o(){return null!==Object(r.c)().fromDate||null!==Object(r.c)().toDate}},4111:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1794);function o(){return Object(r.c)().includeAttachments}},4174:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);let o=Object(r.action)("OPEN_NOTES_FOLDER",e=>({actionSource:e}))},4240:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));let r={};function o(e){return r[e]}function c(e,t){r[e]=t}},526:function(e,t,n){"use strict";var r,o=n(1),c=n(0),a=n(906),i=n(36);!function(e){e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None"}(r||(r={}));let s=class extends c.Component{constructor(e){super(e),this.state={}}componentDidCatch(e,t){var n,r;null===(r=(n=this.props).onError)||void 0===r||r.call(n,e,t),this.props.suppressErrorReport||(e.component=!0,e.diagnosticInfo=(e.diagnosticInfo||"")+t.componentStack,Object(i.d)(e)),this.setState({error:e})}render(){const{error:e}=this.state,{children:t,type:n,windowIcons:o}=this.props;if(e){if(n==r.None)return null;if(n==r.Simple||!this.props.fullErrorComponent)return c.createElement("div",null,e);const t=this.props.fullErrorComponent;return c.createElement(t,Object.assign({error:e,windowIcons:o},this.props.fullErrorComponentProps))}return t}};s=Object(o.__decorate)([a.observer],s),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}))},6132:function(e,t,n){"use strict";n.r(t);var r=n(4046),o=n(2951),c=n(2899),a=n(805),i=n(2981),s=n(47),u=n(4159),d=n(1747),l=n(71),b=n(1721),f=Object(l.r)(r.a.selectFavoriteCategory,(function(e){let t;if(e!=Object(d.c)().id){let n;if(Object(s.j)("tri-favorites-roaming")){const t=Object(b.getFavoriteIdFromCategoryId)(e),r=Object(b.getStore)().outlookFavorites.get(t);if(!r)return Object(c.a)("ResetInbox"),Promise.resolve();n={id:r.categoryId,treeType:r.treeType,type:4}}else n=Object(b.getStore)().favoriteCategories.get(e);t=Object(i.a)(n);const r=function(e){if("UserCategory"!=e.filterType)throw new Error("getFilteredFolderId should only be called for 'UserCategory' viewfilter type");return e.filterType+u.a+e.filterValue}({filterType:"UserCategory",filterValue:Object(a.k)(e,Object(a.o)())});Object(u.b)(r)}return Object(o.a)(),t}));var O=n(2660),S=n(4109),g=n(1681),j=n(2587),p=n(4235),h=n(3007),I=n(2478),m=n(3793),v=n(1675),E=n(2100),T=n(1845),P=n(2392),_=n(2548),F=n(4105),y=n(4045),w=n(2403),C=n(1678),A=n(2128),R=n(3443),k=n(4108);function N(e){if("UserCategory"!=e.filterType)throw new Error("getQueryTypeForFilteredFolder should only be called for 'UserCategory' viewfilter type");const t=Object(a.i)(e.filterValue,Object(a.o)());return t?Object(k.a)(t):null}let x={};function D(){if(Object(s.j)("fwk-prefetch-data-off"))return;Object(p.a)(),setTimeout(L,1e4)}function L(){const e=Math.min(5,h.b.length);let t=[];for(let n=0;n<e;n++){const e=h.b[n].FolderId;let r=null;if(G(e)){const t=U(e);if(!t||"UserCategory"!=t.filterType)continue;r=N(t)}else r=Object(I.a)(e,Object(E.a)(e),M(e),-1,null,null,Object(w.a)(e));if(!r)continue;const o=Object(T.c)(r),c=Object(v.I)();if(c&&c.id!=o.id&&Object(y.a)()&&-1==Object(F.a)(o,!1)){const n=_.c.importAndExecute(()=>Object(m.a)(o,!0,P.a));t.push(n),x[e]=!0}}!function(e){const t=Object.keys(x);Object(l.o)("prefetchFrequentlyUsedFolders_count",{total:e,personaTotal:h.b.slice(0,e).filter(e=>Object(b.isFolderPersonaFavoriteSearchFolder)(e.FolderId)).length,allPrefetched:t.length,personaPrefetched:t.filter(e=>Object(b.isFolderPersonaFavoriteSearchFolder)(e)).length})}(e),Promise.all(t).then(()=>{!function(){let e=0,t=0,n=0,r=0,o=0,c=0;const a=Object(C.a)("inbox"),i=v.Z.tableViews.values();for(let s of i){const i=s.tableQuery,u=i.folderId;if(0!=i.type)return;c++,Object(A.l)(i)&&o++;let d=0;for(let e=0;e<s.rowKeys.length;e++){const t=s.rowKeys[e];if(!v.b.getIsPinned(t,s))break;d++}u===a&&"All"===i.viewFilter&&(t+=d),e+=d,d>=20?n++:d>=10&&r++}Object(l.o)("TnS_PinnedRowsCount",{total:e,inbox:t,tfc:c,pfc:o,ftwenty:n,ften:r})}()}).catch(e=>{})}function M(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e)?"persona":Object(b.isFolderPrivateDLFavoriteSearchFolder)(e)?"privatedistributionlist":"mail"}function U(e){const t=e.split(R.a);return 2==t.length?{filterType:t[0],filterValue:t[1]}:null}function G(e){return["SystemCategory","Hashtag","UserCategory"].reduce((t,n)=>t||e.slice(0,n.length)==n,!1)}function H(e){return x[e]}var V=n(11901),B=n(7),Q=n(3),q=Object(l.r)(r.a.selectPersona,(function(e){let t;if(Object(V.a)("🏃‍ SelectPersonaToPersonaHeaderRender"),e!==Object(d.c)().id){const n=Object(s.j)("tri-favorites-roaming");let r;if(n){const t=Object(b.getStore)().outlookFavorites.get(e);r=t?Object(b.convertFavoritePersonaDataToFavoritePersonaNode)(t):void 0}else r=Object(b.getStore)().favoritesPersonaNodes.get(e);if(!r)return Object(c.a)("ResetInbox"),Promise.resolve();let o=!1;Object(j.isFavoritingInProgress)(r.personaId)||Object(j.isFavoritingInProgress)(r.mainEmailAddress)||g.d.folderTable.has(r.searchFolderId)||(o=!0,K(r));const a=!r.isSearchFolderPopulated,d=r.searchFolderId&&H(r.searchFolderId),f=Object(l.q)();if(f&&f.addCustomData({isSearchFallback:a,searchFolderNotFound:o,isPrefetchedFuf:!!d}),t=Object(i.a)(r,"FavoritesPersonaNode"),n||j.lazyOnFavoritePersonaSelected.importAndExecute(r.id),r.searchFolderId&&(Object(u.b)(r.searchFolderId),Object(v.V)(Object(C.a)("inbox")))){const e=g.d.folderTable.get(r.searchFolderId).totalMessageCount;Object(l.o)("TnS_PauseSelectPersona",[e-g.d.folderTable.get(r.searchFolderId).pausedTotalCount,Object(B.vb)(v.Z.inboxPausedDateTime),v.Z.inboxPausedLength?v.Z.inboxPausedLength:-1],{isCore:!0}),W(r,e)}}return Object(o.a)(),t}));const K=Object(Q.mutatorAction)("updateclearPersonaNodePersonaNode",e=>{e.searchFolderId=void 0,e.isSearchFolderPopulated=!1}),W=Object(Q.mutatorAction)("setPausedTotalCount",(e,t)=>{g.d.folderTable.get(e.searchFolderId).pausedTotalCount=t});var z=Object(l.r)(r.a.selectPrivateDistributionList,(function(e){let t;if(e!=Object(d.c)().id){const n=Object(b.getStore)().outlookFavorites.get(e);if(!n)return Object(c.a)("ResetInbox"),Promise.resolve();const r=Object(b.convertFavoritePdlDataToFavoritePdlNode)(n);let o=!1;Object(j.isFavoritingInProgress)(r.data.favoriteId)||g.d.folderTable.has(r.data.searchFolderId)||(o=!0,X(r));const a=!r.data.isSearchFolderPopulated,s=r.data.searchFolderId&&H(r.data.searchFolderId),d=Object(l.q)();d&&d.addCustomData({isSearchFallback:a,searchFolderNotFound:o,isPrefetchedFuf:!!s}),t=Object(i.a)(r,"FavoritesPrivateDistributionList"),r.data.searchFolderId&&Object(u.b)(r.data.searchFolderId)}return Object(o.a)(),t}));const X=Object(Q.mutatorAction)("clearPdlNode",e=>{e.data.searchFolderId=void 0,e.data.isSearchFolderPopulated=!1});var Z=n(3956),$=n(2864),J=n(20);const Y=Object(J.e)(Z.a,"selectPreviousNodeClone",e=>{const t=e.actionSource,n=$.q.previousNode||Object(d.c)();switch(n.type){case 1:q(n.id);break;case 5:z(n.id);break;case 0:case 6:Object(O.a)(n.id,n.treeType,t,n.type);break;case 4:f(n.id);break;case 2:Object(S.a)(n.id,n.treeType);break;default:throw new Error("exitSearchOrchestrator: Unknown node type")}});var ee=n(4104),te=n(15608),ne=n(6),re=n(564),oe=n(1679),ce=n(2525),ae=n(2292);const ie=Object(J.e)(ee.a,"validateDumpsterQuota",()=>(async function(){if(await Object(re.b)(Object(ne.b)(te.c),Object(ne.b)(te.b),!1,{okText:Object(ne.b)(te.a)})===re.a.ok){(await ae.d.import())(),Object(ce.p)(Object(C.a)(oe.i),"primaryFolderTree","Dumpster")}})());var se=n(4234),ue=n(2414),de=n(2523),le=n(1704),be=n(1689),fe=Object(l.r)(r.a.selectFavoriteSearch,(async function(e){const t=Object(d.d)();if(Object(b.getStore)().favoriteSearches.get(e)!=t.selectedNode){Oe(e);const t=await le.m.import(),n=await de.m.import(),r=await $.o.import();n(be.a.Mail)||Object(le.kb)("FavoritesSearchNode",!1,be.a.Mail),t(be.a.Mail),r(!1),Object(le.J)(e,be.a.Mail),Object(le.jb)("FavoritesSearchNode",be.a.Mail,!1)}Object(se.a)(),ue.b(),Object(v.g)(!0)}));const Oe=Object(Q.mutatorAction)("resetFolderForestSelectedNode",e=>{const t=Object(d.d)(),n=Object(b.getStore)().favoriteSearches.get(e);t.selectedNode={id:n.id,type:3,treeType:"favorites"}});async function Se(e,t,n){if(t){e==Object(d.b)()&&Object(O.a)(Object(C.a)("inbox"),"primaryFolderTree","ResetInbox"),(await j.lazyRemoveFavoriteFolder.import())(e,n)}else{(await j.lazyAddFavoriteFolder.import())(e,n)}}var ge=n(702),je=Object(ge.action)("selectFolderNode")((function(e,t){const n=e||Object(d.c)();switch(n.type){case 1:ce.l.importAndExecute(n.id);break;case 5:ce.m.importAndExecute(n.id);break;case 0:Object(ce.p)(n.id,n.treeType,t);break;case 4:ce.g.importAndExecute(n.id);break;case 2:ce.j.importAndExecute(n.id,n.treeType);break;default:throw new Error("selectFolderNode: Unknown node type")}})),pe=n(57),he=n(2699),Ie=n(1701),me=n(2222),ve=n(80),Ee=n(611);const Te=7776e6,Pe=25;async function _e(){if(!Object(pe.r)())return;const e=Object(C.a)("deleteditems"),t=await async function(e){const t=await Object(me.c)(Object(Ee.a)({Id:e}),0,Pe,"All",[Object(he.a)({Order:"Ascending",Path:Object(Ie.a)({FieldURI:"DateTimeReceived"})})],-1,Object(me.f)(),void 0,null,null);return t.RootFolder&&t.RootFolder.Items.map(e=>Date.parse(e.DateTimeReceived))}(e);let n=0;if(t){const e=Date.now();for(const r of t){if(!(e-r>=Te))break;++n}}Object(l.o)("TnS_ConsumerDeletedItemsRetentionPolicy",[Object(ve.c)({value:n,exactMatches:[0,25],buckets:[5,10,15,20,24]})])}var Fe=n(15609),ye=n(3193);function we(e,t){const n=Object(C.a)(e),r=g.d.folderTable.has(n);if(n&&!r){const r={UnreadCount:0,totalMessageCount:-1,id:n,distinguishedFolderType:e,displayName:Object(ne.b)(Fe.a),FolderClass:"IPM.Note",mailboxInfo:t};Ce(n,r),Object(ye.a)(n)}}const Ce=Object(Q.mutatorAction)("addDumpsterFolderToStore",(e,t)=>{g.d.folderTable.set(e,t)});var Ae=Object(Q.mutatorAction)("loadPopoutDataToFolderStore",e=>{const{folderId:t,mailboxInfo:n,permission:r,principalSMTPAddress:o}=e,c=Object(g.m)();if(!c.get(t)){const e={id:t,mailboxInfo:n,PermissionSet:{Permissions:[r]},principalSMTPAddress:o};c.set(t,e)}}),Re=n(8534);var ke=Object(Q.mutatorAction)("loadPopoutDataToPublicFolderFavoriteStore",e=>{const{folderId:t,mailboxInfo:n,replicaItem:r}=e,o=Re.b.folderTable;if(!o.get(t)){const e={id:t,mailboxInfo:n,replicaList:[r]};o.set(t,e)}}),Ne=n(4173);n.d(t,"selectPreviousNodeOrchestrator",(function(){return Y})),n.d(t,"validateDumpsterQuotaOrchestrator",(function(){return ie})),n.d(t,"selectPersona",(function(){return q})),n.d(t,"selectFavoriteSearch",(function(){return fe})),n.d(t,"selectPrivateDistributionList",(function(){return z})),n.d(t,"toggleFavoriteFolder",(function(){return Se})),n.d(t,"selectFolderNode",(function(){return je})),n.d(t,"prefetchFrequentlyUsedFolders",(function(){return D})),n.d(t,"selectGroup",(function(){return S.a})),n.d(t,"selectFavoriteCategory",(function(){return f})),n.d(t,"logConsumerDeletedRetentionPolicy",(function(){return _e})),n.d(t,"loadDumpster",(function(){return we})),n.d(t,"loadPopoutDataToFolderStore",(function(){return Ae})),n.d(t,"loadPopoutDataToPublicFolderFavoriteStore",(function(){return ke})),n.d(t,"selectGroupFolder",(function(){return Ne.a}))},6644:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ADD_PUBLIC_FOLDER_TO_STORE",(e,t)=>({state:e,item:t}))},6875:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_OUTLOOK_FAVORITE_STORE")},6876:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("POPULATE_PUBLIC_FOLDER_FAVORITE_STORE_V1")},6877:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("REMOVE_FAVORITE_FROM_PUBLIC_FOLDER_STORE",e=>({folderId:e}))},8534:function(e,t,n){"use strict";var r=n(6875),o=n(6876),c=n(20),a=n(2266),i=n(6644),s=n(3),u=(Object(s.mutator)(i.a,e=>{const{state:t,item:n}=e;let r=n.id;t.folderTable.has(r)||t.folderTable.set(r,n)}),n(6877)),d=n(2287);Object(s.mutator)(u.a,e=>{const{folderId:t}=e;d.a.folderTable.has(t)&&d.a.folderTable.delete(t)}),n(2620);n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return d.a}));const l=new c.c(()=>Promise.all([n.e(19),n.e(61),n.e(821)]).then(n.bind(null,19706)));Object(c.f)(a.a,l,e=>e.loadPublicFolderFavoritesOchestrator),Object(c.f)(r.a,l,e=>e.populatePublicFolderOutlookFavoriteStoreOrchestrator),Object(c.f)(o.a,l,e=>e.populatePublicFolderFavoriteStoreV1Orchestrator);const b=Object(c.d)(l,e=>e.PostedToLine)}}]);
//# sourceMappingURL=owa.501.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.501.js'] = 1;