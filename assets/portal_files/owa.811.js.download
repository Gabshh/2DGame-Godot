(window.$wj=window.$wj||[]).push([[811],{1690:function(t,e,n){"use strict";var c=n(3);const o=Object(c.action)("initializeOwaObservableDateTime"),r=Object(c.action)("observableNowChanged"),i=Object(c.action)("observableTodayChanged");var a=n(7),u=n(16),s=Object(c.createStore)("ObservableDateTime",{now:0,today:0});const b=Object(u.computed)(()=>Object(a.qc)(s().now)),d=()=>b.get(),l=Object(u.computed)(()=>Object(a.qc)(s().today)),f=()=>l.get(),j=t=>Object(a.Jb)(t,d()),O=t=>Object(a.Hb)(t,d()),p=t=>y(t,a.Jb),h=t=>y(t,a.Kb),y=(t,e)=>e(Object(a.bc)(Object(a.qc)(t)),f());function m(t){if(!t)return"";const e=Object(a.qc)(t);return function(t,e){const n=Object(a.bc)(t);if(Object(a.Lb)(n,e))return a.ab;const c=t=>Object(a.Rb)(n,Object(a.e)(e,-t),e);if(c(3))return a.ib;if(c(30))return a.hb;return a.Y}(e,f())(e)}function v(t){if(!t)return"";return function(t,e){const n=Object(a.bc)(t);return Object(a.Lb)(n,e)?Object(a.ab)(t):g(n,e,2)?Object(a.lb)(t):g(n,e,7)?Object(a.H)(Object(a.bb)(t),Object(a.ab)(t)):Object(a.H)(Object(a.J)(t),Object(a.ab)(t))}(Object(a.qc)(t),f())}function g(t,e,n){return Object(a.Rb)(t,Object(a.e)(e,-n),e)}const T=Object(c.action)("updateTimes"),A=Object(c.action)("setNow"),w=Object(c.action)("setToday",t=>({today:t}));Object(c.mutator)(A,()=>{s().now=Object(a.oc)()}),Object(c.mutator)(w,({today:t})=>{s().today=t});var I=n(22),S=n(88);let x=!1;Object(c.orchestrator)(o,()=>{if(T(),!x){const t=Object(a.Ub)(),e=Object(a.dc)(Object(a.h)(t,1)),n=Object(a.w)(e,t);setTimeout(()=>setInterval(T,I.g),n),document&&document.addEventListener("visibilitychange",T),x=!0}}),Object(c.orchestrator)(S.m,()=>{T()}),Object(c.orchestrator)(T,()=>{A();const t=Object(a.Cb)(Object(a.pc)()),e=s().today!=t;e&&w(t),r(),e&&i()}),n.d(e,"c",(function(){return o})),n.d(e,"i",(function(){return r})),n.d(e,"k",(function(){return i})),n.d(e,"h",(function(){return d})),n.d(e,"j",(function(){return f})),n.d(e,"f",(function(){return j})),n.d(e,"d",(function(){return O})),n.d(e,"e",(function(){return p})),n.d(e,"g",(function(){return h})),n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return v}))},1743:function(t,e,n){"use strict";function c(t,e){Object.keys(e).forEach(n=>t.set(n,e[n]))}function o(t){let e=null!=t?t:{headers:new Headers};return e.datapoint=e.datapoint||{},e.datapoint.mailbox="Default",e}n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return o}))},1744:function(t,e,n){"use strict";var c=n(1877),o=n(287),r=n(1690),i=n(71),a=n(7),u=n(36);const s="X-AnchorMailbox",b="Authorization",d="X-OwaWebSessionType",l="X-OWA-ExplicitLogonUser";async function f(t,e){const n={},f=Object(o.k)(t);if(e?(n[s]=e,n[l]=e):f&&(n[s]=f.anchorMailbox),Object(o.s)())return u.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(f){if(f.accountState==o.b.AccessRevoked)return null;if(f.accountState==o.b.AccountDeprovisioned||f.accountState==o.b.AccountNotFound)return Object(o.d)(f.accountState,f.accountProviderType),null}if(f){let e,o=f.token,s=Object(r.f)(f.tokenExpiry);!s&&o||(Object(i.o)("getAndUpdateAccessToken",{tokenExpiry:Object(a.y)(f.tokenExpiry,Object(a.Ub)()),isTokenExpired_1:s,isTokenInvalid_2:!o},{isCore:!0}),o=await c.a.importAndExecute(f.accountId,t,o),u.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+t+o),o||(o="")),"Outlook"==f.accountProviderType?(e=`MSAuth1.0 usertoken="${o}", type="MSACT"`,n[d]=1..toString()):"Google"!=f.accountProviderType&&"ICloud"!=f.accountProviderType&&"Yahoo"!=f.accountProviderType||(e=`Bearer ${o}`,n[d]=2..toString()),n[b]=e}return n}var j=n(1743),O=n(912);async function p(t,e){var n;const c=Object(j.a)();if(c.headers=await async function(t,e){var n;const c=e&&(null===(n=t.headers)||void 0===n?void 0:n.set)?new Headers(t.headers):new Headers,o=await f(t.mailboxInfo.userIdentity,h(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null);return Object(j.b)(c,o),c}(t,e),c.authNeededOnUnAuthorized=!1,c.datapoint=c.datapoint||{},Object(o.s)()){const e=Object(O.a)(null===(n=null==t?void 0:t.mailboxInfo)||void 0===n?void 0:n.userIdentity);u.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+e),c.sourceId=e,c.datapoint.mailbox="Connected"}else c.datapoint.mailbox="Connected";return c}function h(t,e){const n="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return n&&null==e&&u.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return p})),n.d(e,"c",(function(){return h}))},1765:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var c=n(3);const o=Object(c.action)("triggerReInitializeAccount",t=>({userIdentity:t}))},1877:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var c=n(20),o=n(1765);n.d(e,"b",(function(){return o.a}));const r=new c.c(()=>n.e(874).then(n.bind(null,2361))),i=new c.a(r,t=>t.getAndUpdateAccessToken)},1933:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var c=n(47);function o(){return Object(c.j)("rp-cacheFirstPeopleTrieSize300")||Object(c.j)("rp-cacheFirstPeopleTrieSize500")||Object(c.j)("rp-cacheFirstPeopleTrieSize700")||Object(c.j)("rp-peopleTrieOnTimeoutLow")||Object(c.j)("rp-peopleTrieOnTimeoutMed")||Object(c.j)("rp-peopleTrieOnTimeoutHigh")}},19902:function(t,e,n){"use strict";n.r(e);var c=n(5130),o=n(225);async function r(){await Object(c.b)(Object(o.d)().userIdentity,null,!1)}n.d(e,"execute3SPrimeCall",(function(){return r}))},2265:function(t,e,n){"use strict";var c=n(132);var o=n(47),r=n(5);n.d(e,"a",(function(){return a}));const i="searchtesthook";function a(t={}){const e=function(t,...e){const n={};for(const c of e)for(const e of Object.keys(c))t.includes(e)&&n.hasOwnProperty(e)?n[e]=n[e]+","+c[e]:n[e]=c[e];return n}(["setflight"],t,function(){let t={};const e=Object(r.c)(i),n=decodeURIComponent(e||"").trim();if(Object(o.j)("sea-debugHook")&&n.length>0){t=n.split("&").reduce((t,e)=>{const[n,c]=e.split("=");return t[n]=c,t},{})}return t}(),Object(c.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(e).filter(t=>null!==e[t]).reduce((t,n)=>Object.assign(Object.assign({},t),{[n]:e[n]}),{})}},283:function(t,e,n){"use strict";var c=n(907);n.d(e,"a",(function(){return c.a}))},4928:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var c=n(1933);const o=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle","PersonId","MRI"],r=o.concat(["FeatureData","GivenName","Surname","Alias","AdditionalNames"]),i=o.concat(["FeatureData"]),a=o.concat(["Phones","OfficeLocation","Department"]);function u(t,e=!0){return 2===t?a:Object(c.a)()&&e?function(t){return 0==t?[...r]:[...i]}(t):o}},5130:function(t,e,n){"use strict";n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return T})),n.d(e,"c",(function(){return w}));var c=n(287),o=n(1744),r=n(47),i=n(326),a=n(283),u=n(327),s=n(2265),b=n(296),d=n(1933),l=n(36),f=n(4928),j=n(7);const O="/search/api/v1/init?",p="/search/api/v1/suggestions?",h="owa.react.compose",y="20",m="5",v="CSRClientEnabled",g="owa.projectMoca.peopleCard";async function T(t,e,n,c,o,r,s,b=!0){const d=s||h;if(null==e)return async function(t){return Object(u.b)(O+w(t),void 0,!0,await I(null),!0,!1).then(t=>Object(a.a)(t.status)?t.json():null).catch(t=>(t.networkError=!0,l.d(t),null))}(d);{let a=function(t,e,n,c){return{AppName:"OWA",Scenario:{Name:n},Cvid:e||Object(i.a)(),EntityRequests:[t],LogicalId:c}}(await async function(t,e,n,c,o){let r={Query:{QueryString:t},EntityType:"People",Provenances:A(e),Size:e?y:m};c&&c.length>0&&(r.Context=function(t){let e={};t&&(e.RecipientsTo=t.toString());return e}(c));return r.Fields=o===g?Object(f.a)(2,n):Object(f.a)(1,n),r}(e,n,b,r,d),null==o?void 0:o.conversationId,d,c||"");return Object(u.e)(p+w(d,e),a,c,!1,await I(t,null==o?void 0:o.clientSessionId),!0,!0,!1).then(t=>t).catch(t=>(l.h.info(t),null))}}function A(t){let e=["Mailbox"];return t&&!Object(b.a)()&&e.push("Directory"),e}function w(t,e){const n=Object.assign({scenario:t},Object(s.a)());let c=[];return Object(d.a)()&&c.push(v),Object(r.j)("rp-cacheFirstPeopleTrieSize500cf")&&c.push(v),n.setflight&&c.push(n.setflight),c.length>0&&(n.setflight=c.join(",")),Object.keys(n).map(t=>`${t}=${n[t]}`).join("&")}async function I(t,e){let n={};if(e&&(n["client-session-id"]=e),Object(r.j)("rp-3STelemetryEvents")){const t=Object(j.qc)();n["x-client-localtime"]=t.toString()}return t&&Object(c.r)(t)?Object(o.a)(t).then(t=>(Object.keys(t).forEach(e=>n[e]=t[e]),n)):n}},907:function(t,e,n){"use strict";function c(t){return t>=200&&t<300}n.d(e,"a",(function(){return c}))}}]);
//# sourceMappingURL=owa.811.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.811.js'] = 1;