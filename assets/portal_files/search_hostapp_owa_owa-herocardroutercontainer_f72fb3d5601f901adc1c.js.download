(window.msfast_search_hostapp_owa_jsonp=window.msfast_search_hostapp_owa_jsonp||[]).push([[2],{313:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i});var r={};n.r(r),n.d(r,"getCompactRelativeTimeString",function(){return s}),n.d(r,"getDetailedTimestamp",function(){return u}),n.d(r,"getFriendlyTimestamp",function(){return d}),n.d(r,"getAlternativeFriendlyTimestamp",function(){return m}),n.d(r,"getSemiDetailedRelativeTimestamp",function(){return p}),n.d(r,"getDetailedRelativeTimeString",function(){return f}),n.d(r,"getShortDurationTimeString",function(){return h}),n.d(r,"getShortDurationFromHoursDifferenceString",function(){return g}),n.d(r,"getRelativeTimeFromNow",function(){return v}),n.d(r,"getLongDurationTimeString",function(){return b}),n.d(r,"getWeekRelativeDateString",function(){return y});var i=n(409),a=n(415),o=n(97),l=n(200),c=n(63);function s(e,t,n,r,o,l){return void 0===o&&(o=!1),void 0===l&&(l=!1),O(n,r)&&n.timeFormats?a.o(e,t)?Object(i.format)(o||n.todayAsLabel?n.timeFormats.todayDayShort:n.timeFormats.todayShort,e,t,n,r):a.q(e,t)?Object(i.format)(n.timeFormats.yesterdayShort,e,t,n,r):a.j(e,t)?Object(i.format)(n.timeFormats.daysAgoShort,e,t,n,r):a.p(e,t)?Object(i.format)(n.timeFormats.tomorrowShort,e,t,n,r):a.n(e,t)?Object(c.l)(e,n.timeFormats,"long"):l?Object(c.c)(e,n.timeFormats,"short"):Object(i.format)(n.timeFormats.generic,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function u(e,t,n,r){return O(n,r)&&n.timeFormats?a.m(e,t)?n.timeFormats.justNow:a.h(e,t)?Object(i.format)(n.timeFormats.minutesAgoShort,e,t,n,r):a.o(e,t)?Object(i.format)(n.timeFormats.hoursAgoShort,e,t,n,r):a.q(e,t)?Object(i.format)(n.timeFormats.yesterdayLong,e,t,n,r):a.j(e,t)?Object(i.format)(n.timeFormats.weekdayShort,e,t,n,r):a.a(e,t)?Object(i.format)(n.timeFormats.timestampDate,e,t,n,r):Object(i.format)(n.timeFormats.timestampDateYear,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function d(e,t,n,r){return O(n,r)&&n.timeFormats?a.p(e,t)?Object(i.format)(n.startWithLowercase?n.timeFormats.tomorrowShortLowercase:n.timeFormats.tomorrowShort,e,t,n,r):a.l(e,t)?a.d(e,t)<=59?Object(i.format)(n.a11yFriendly?n.timeFormats.inMinutesShortNumbers:n.timeFormats.inMinutesShorterNumbers,e,t,n,r):a.c(e,t)<=23?Object(i.format)(n.a11yFriendly?n.timeFormats.inHoursShortNumbers:n.timeFormats.inHoursShorterNumbers,e,t,n,r):Object(i.format)(n.startWithLowercase?n.timeFormats.todayLongLowercase:n.timeFormats.todayLong,e,t,n,r):a.m(e,t)?n.startWithLowercase?n.timeFormats.justNowLowercase:n.timeFormats.justNow:a.h(e,t)?Object(i.format)(n.a11yFriendly?n.timeFormats.minutesAgoShortNumbers:n.timeFormats.minutesAgoShorterNumbers,e,t,n,r):a.o(e,t)?Object(i.format)(n.a11yFriendly?n.timeFormats.hoursAgoShortNumbers:n.timeFormats.hoursAgoShorterNumbers,e,t,n,r):a.q(e,t)?Object(i.format)(n.startWithLowercase?n.timeFormats.yesterdayLongLowercase:n.timeFormats.yesterdayLong,e,t,n,r):a.j(e,t)?Object(i.format)(n.timeFormats.weekdayShort,e,t,n,r):a.a(e,t)?Object(i.format)(n.timeFormats.timestampDate,e,t,n,r):Object(i.format)(n.timeFormats.timestampDateYear,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function m(e,t,n,r){return O(n,r)&&n.timeFormats?a.o(e,t)?d(e,t,n,r):a.j(e,t)?Object(c.l)(e,n.timeFormats,"long"):a.a(e,t)?Object(i.format)(n.timeFormats.monthNameAndDate,e,t,n,r):d(e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function p(e,t,n,r){return O(n,r)&&n.timeFormats?a.p(e,t)?Object(i.format)(n.timeFormats.tomorrowShort,e,t,n,r):a.l(e,t)?Object(i.format)(n.timeFormats.todayLong,e,t,n,r):a.m(e,t)?n.timeFormats.justNow:a.h(e,t)?Object(i.format)(n.timeFormats.minutesAgoShortNumbers,e,t,n,r):a.o(e,t)?Object(i.format)(n.timeFormats.hoursAgoShortNumbers,e,t,n,r):a.j(e,t)?Object(i.format)(n.timeFormats.daysAgoShortWithYesterday,e,t,n,r):a.i(e,t)?Object(i.format)(n.timeFormats.weeksAgoLongNumbers,e,t,n,r):a.g(e,t)<1?Object(i.format)(n.timeFormats.monthsAgoLongNumbers,e,t,n,r):Object(i.format)(n.timeFormats.yearsAgoLong,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()}function f(e,t,n,r,o){return void 0===o&&(o=!1),O(n,r)&&n.timeFormats?a.o(e,t)?Object(i.format)(n.timeFormats.todayLong,e,t,n,r):a.q(e,t)?Object(i.format)(n.timeFormats.yesterdayLong,e,t,n,r):a.j(e,t)?Object(i.format)(n.timeFormats.daysAgoLong,e,t,n,r):o&&a.i(e,t)?Object(i.format)(n.timeFormats.weeksAgoLong,e,t,n,r):o&&a.k(e,t)?Object(i.format)(n.timeFormats.monthsAgoLong,e,t,n,r):o?Object(i.format)(n.timeFormats.yearsAgoLong,e,t,n,r):Object(i.format)(n.timeFormats.generic,e,t,n,r):e.getDate()+"/"+(e.getMonth()+1)+"/"+e.getFullYear()+" "+e.getHours()+":"+e.getMinutes()}function h(e,t,n,r){if(n){var i=new Date(e).setHours(0,0,0,0),a=new Date(t).setHours(0,0,0,0),l=Object(c.s)((a-i)/o.c);return l<1?"":r.shortDurationByDays.replace(o.d,String(l))}var s=t.getTime()-e.getTime(),u=Object(c.s)(s/o.c),d=Object(c.s)(s/o.e)%24,m=Object(c.s)(s/o.h)%60;return!u||d||m?u&&d&&!m?r.shortDurationByDaysAndHours.replace(o.d,String(u)).replace(o.f,String(d)):u&&d&&m?r.shortDurationByDaysHoursAndMinutes.replace(o.d,String(u)).replace(o.f,String(d)).replace(o.i,String(m)):u&&!d&&m?r.shortDurationByDaysAndMinutes.replace(o.d,String(u)).replace(o.i,String(m)):u||!d||m?!u&&d&&m?r.shortDurationByHoursAndMinutes.replace(o.f,String(d)).replace(o.i,String(m)):u||d||!m?"":r.shortDurationByMinutes.replace(o.i,String(m)):r.shortDurationByHours.replace(o.f,String(d)):r.shortDurationByDays.replace(o.d,String(u))}var g=function(e,t,n){return h(e,new Date(e.getTime()+Math.abs(t*o.m)),!1,n)};function v(e,t,n,r){var i=t.getTime()>e.getTime(),a=Math.abs(e.getTime()-t.getTime())>o.c,l=i?e:t,c=i?t:e,s=r?b(l,c,void 0,a):h(l,c,a,n);return""===s?n.justNowLowercase:i?n.durationFuture({p0:s}):n.durationPast({p0:s})}function b(e,t,n,r){var a=Object(l.b)(),s=t.getTime()-e.getTime();if(s<0)return"";if(r){var u=new Date(e).setHours(0,0,0,0),d=new Date(t).setHours(0,0,0,0),m=Object(c.s)((d-u)/o.c);return m<1?"":Object(i.getPluralizedFormatString)(a.longDurationByDays,m,n).replace(o.o,String(m))}var p=Object(c.s)(s/o.c),f=Object(c.s)((s-p*o.c)/o.e),h=Object(c.s)((s-p*o.c-f*o.e)/o.h);return!p||f||h?p&&f&&!h?[Object(i.getPluralizedFormatString)(a.longDurationByDays,p,n).replace(o.o,String(p)),Object(i.getPluralizedFormatString)(a.longDurationByHours,f,n).replace(o.p,String(f))].join(" "):p&&f&&h?[Object(i.getPluralizedFormatString)(a.longDurationByDays,p,n).replace(o.o,String(p)),Object(i.getPluralizedFormatString)(a.longDurationByHours,f,n).replace(o.p,String(f)),Object(i.getPluralizedFormatString)(a.longDurationByMinutes,h,n).replace(o.q,String(h))].join(" "):p&&!f&&h?[Object(i.getPluralizedFormatString)(a.longDurationByDays,p,n).replace(o.o,String(p)),Object(i.getPluralizedFormatString)(a.longDurationByMinutes,h,n).replace(o.q,String(h))].join(" "):p||!f||h?!p&&f&&h?[Object(i.getPluralizedFormatString)(a.longDurationByHours,f,n).replace(o.p,String(f)),Object(i.getPluralizedFormatString)(a.longDurationByMinutes,h,n).replace(o.q,String(h))].join(" "):p||f||!h?"":Object(i.getPluralizedFormatString)(a.longDurationByMinutes,h,n).replace(o.q,String(h)):Object(i.getPluralizedFormatString)(a.longDurationByHours,f,n).replace(o.p,String(f)):Object(i.getPluralizedFormatString)(a.longDurationByDays,p,n).replace(o.o,String(p))}function y(e,t,n,r){return void 0===n&&(n="long"),isNaN(e.getTime())?Object(i.format)(t.timeFormats.generic,new Date(432e5),new Date,t,r):a.o(e)?Object(i.format)(t.todayAsLabel?t.timeFormats.todayDayShort:t.timeFormats.todayShort,e,new Date,t,r):a.q(e)?Object(i.format)(t.timeFormats.yesterdayShort,e,new Date,t,r):a.p(e)?Object(i.format)(t.timeFormats.tomorrowShort,e,new Date,t,r):a.j(e)||a.n(e)?Object(c.l)(e,t.timeFormats,n):Object(i.format)(t.timeFormats.generic,e,new Date,t,r)}function O(e,t){if(!e.timeFormats)return Object(c.r)(t,"validateFormatStrings",{message:"Failed validating format strings: timeFormats object was not provided"}),!1;var n=[];return e.is24HourFormat||e.timeFormats.amPartOfDay||n.push("amPartOfDay"),e.is24HourFormat||e.timeFormats.pmPartOfDay||n.push("pmPartOfDay"),e.timeFormats.timeZone||n.push("timeZone"),e.timeFormats.todayShort||n.push("todayShort"),e.timeFormats.todayShortWithTimeZone||n.push("todayShortWithTimeZone"),e.timeFormats.todayDayShort||n.push("todayDayShort"),e.timeFormats.todayLong||n.push("todayLong"),e.timeFormats.yesterdayShort||n.push("yesterdayShort"),e.timeFormats.yesterdayLong||n.push("yesterdayLong"),e.timeFormats.daysAgoShort||n.push("daysAgoShort"),e.timeFormats.daysAgoLong||n.push("daysAgoLong"),e.timeFormats.weeksAgoLong||n.push("weeksAgoLong"),e.timeFormats.monthsAgoLong||n.push("monthsAgoLong"),e.timeFormats.yearsAgoLong||n.push("yearsAgoLong"),e.timeFormats.generic||n.push("generic"),!(n.length>0)||(Object(c.r)(t,"validateFormatStrings",{message:"Failed validating "+n.length+" timeFormat(s)",failedTimeFormats:n}),!1)}},406:function(e,t,n){"use strict";n.d(t,"a",function(){return i});n(97);var r=n(200);new Date(2014,1,1,15,0,0,0);function i(e){var t=Object(r.b)();return[t.sundayLong,t.mondayLong,t.tuesdayLong,t.wednesdayLong,t.thursdayLong,t.fridayLong,t.saturdayLong][e]}},409:function(e,t,n){"use strict";n.r(t),n.d(t,"format",function(){return c}),n.d(t,"formatCalendarDate",function(){return s}),n.d(t,"formatUTCCalendarDate",function(){return u}),n.d(t,"formatTimeZone",function(){return d}),n.d(t,"formatCalendarDateFromString",function(){return m}),n.d(t,"getPluralizedFormatString",function(){return p}),n.d(t,"getWeekDayDate",function(){return f}),n.d(t,"getTimeInAMPM",function(){return h}),n.d(t,"getCompleteDate",function(){return g});var r=n(505),i=n(415),a=n(97),o=n(200),l=n(63);function c(e,t,n,r,o,c){if(!e||!t||isNaN(t.valueOf())||!n||isNaN(n.valueOf()))return"";if(e.match(a.t)){var u=i.g(t,n);e=(e=p(e,u,o)).replace(a.t,String(u))}else if(e.match(a.r)){var d=i.e(t,n);e=(e=p(e,d,o)).replace(a.r,String(d))}else if(e.match(a.s)){var m=i.f(t,n);e=(e=p(e,m,o)).replace(a.s,String(m))}else if(e.match(a.o)){var f=i.b(t,n);e=(e=p(e,f,o)).replace(a.o,String(f))}else if(e.match(a.p)){var h=i.c(t,n);e=(e=p(e,h,o)).replace(a.p,String(h))}else if(e.match(a.q)){var g=i.d(t,n);e=(e=p(e,g,o)).replace(a.q,String(g))}e=(e=(e=(e=(e=e.replace(a.f,l.d(t,r.is24HourFormat,r.hostAppTimeFormat))).replace(a.i,l.e(t))).replace(a.a,l.a(t,r.timeFormats,r.is24HourFormat))).replace(a.x,l.l(t,r.timeFormats,"short"))).replace(a.g,l.l(t,r.timeFormats,"long"));var v=null!=c?c:l.j(t);return e=s(e=e.replace(a.v,l.k(v)),t,r.timeFormats)}function s(e,t,n){return e&&t&&!isNaN(t.valueOf())?e.replace(a.d,""+t.getDate()).replace(a.l,""+(t.getMonth()+1)).replace(a.k,l.f(t.getMonth(),n)).replace(a.z,""+t.getFullYear()):""}function u(e){var t=Object(o.b)(),n=t.timestampDateYear;return n&&e&&!isNaN(e.valueOf())?n.replace(a.d,""+e.getUTCDate()).replace(a.l,""+(e.getUTCMonth()+1)).replace(a.k,l.f(e.getUTCMonth(),t)).replace(a.z,""+e.getUTCFullYear()):""}function d(e,t){return e.replace(a.v,l.k(t))}function m(e,t,n){if(!e||!t||l.o(t))return"";var r=/(\d{4})-(\d{2})-(\d{2})/,i=r.exec(t);if(!r.test(t)||!i)return"";var o=parseInt(i[1],10),c=parseInt(i[2],10),s=parseInt(i[3],10);return e=(e=(e=(e=e.replace(a.d,""+s)).replace(a.l,""+c)).replace(a.k,l.f(c-1,n))).replace(a.z,""+o)}function p(e,t,n){try{return Object(r.a)(e,t)}catch(t){return l.r(n,"getPluralizedFormatString",{message:"Failed parsing pluralized format string '"+e+"'"}),e}}var f=function(e){if(!e)return"";var t=Object(o.b)();return[m(t.monthNameAndDate,e,t),l.l(new Date(e),t,"long")].join(Object(o.a)()+" ")},h=function(e,t){return e&&t?l.i(new Date(new Date(e).getTime()),t,!1,!1).toUpperCase():""},g=function(e){if(!e)return"";var t=Object(o.b)();return m(t.timestampDateYear,e,t)}},415:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"g",function(){return o}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"m",function(){return m}),n.d(t,"h",function(){return p}),n.d(t,"o",function(){return f}),n.d(t,"l",function(){return h}),n.d(t,"p",function(){return g}),n.d(t,"q",function(){return v}),n.d(t,"j",function(){return b}),n.d(t,"i",function(){return y}),n.d(t,"k",function(){return O}),n.d(t,"n",function(){return x});var r=n(97);function i(e,t){return void 0===t&&(t=new Date),e.getDate()===t.getDate()&&function(e,t){void 0===t&&(t=new Date);return e.getMonth()===t.getMonth()&&a(e,t)}(e,t)}function a(e,t){return void 0===t&&(t=new Date),e.getFullYear()===t.getFullYear()}function o(e,t){var n=t.getTime(),i=e.getTime();return Math.floor((n-i)/r.y)}function l(e,t){var n=t.getTime(),i=e.getTime();return Math.floor((n-i)/r.j)}function c(e,t){var n=t.getTime(),i=e.getTime();return Math.ceil((n-i)/r.w)}function s(e,t,n){var i=t.getTime(),a=e.getTime();return n&&1===n?Math.floor((i-a)/r.c):Math.ceil((i-a)/r.c)}function u(e,t){var n=t.getTime(),i=e.getTime();return Math.abs(Math.ceil((n-i)/r.e))}function d(e,t){var n=t.getTime(),i=e.getTime();return Math.abs(Math.ceil((n-i)/r.h))}function m(e,t){return void 0===t&&(t=new Date),Boolean(e&&t.getTime()-e.getTime()<r.h)}function p(e,t){return void 0===t&&(t=new Date),Boolean(e&&t.getTime()-e.getTime()<r.e)}function f(e,t){return void 0===t&&(t=new Date),!!e&&i(e,t)}function h(e,t){return void 0===t&&(t=new Date),!!e&&(!!i(e,t)&&t.getTime()-e.getTime()<0)}function g(e,t){return void 0===t&&(t=new Date),!!e&&i(e,new Date(t.getTime()+r.c))}function v(e,t){return void 0===t&&(t=new Date),!!e&&i(new Date(t.getTime()-r.c),e)}function b(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime(),i=n<r.w&&n>=0,a=t.getDay()===e.getDay()&&n>=r.c;return i&&!a}function y(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime();return n<r.j&&n>=0}function O(e,t){void 0===t&&(t=new Date);var n=t.getTime()-e.getTime();return n<r.y&&n>=0}function x(e,t){void 0===t&&(t=new Date);var n=t.getTime(),i=e.getTime()-n;return i<r.w&&i>=0}},419:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function i(){return r.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)})}},505:function(e,t,n){"use strict";n.d(t,"a",function(){return g});var r=n(1),i=n(253),a=n(78),o=n(401),l="||",c="::",s=",",u=["->","–>","-","–"],d="INF",m="*",p=/^\d+$/;function f(e){var t=Object(i.a)(u,function(t){return e.indexOf(t)>=0}),n=t?e.split(t).map(function(e){return e.trim()}):[e.trim()];if(1===n.length){var r=n[0];if(Object(a.e)(r,m)){var o=r.substring(m.length);return o.match(p)?function(e){return Object(a.b)(e.toString(),o)}:null}return r.match(p)?function(e){return e.toString()===r}:null}if(2===n.length){if(!n[0].match(p))return null;var l=parseInt(n[0],10);if(isNaN(l))return null;if(n[1]===d)return function(e){return e>=l};if(!n[1].match(p))return null;var c=parseInt(n[1],10);return isNaN(c)?null:function(e){return e>=l&&e<c}}return null}function h(e,t){var n,i,a,o,u=function(t){throw new Error('pluralized string "'+e+'" '+t)};try{for(var d=Object(r.__values)(e.split(l)),m=d.next();!m.done;m=d.next()){var p=m.value,h=p.split(c);2!==h.length&&u("is missing separator "+c+' in clause "'+p+'"');var g=Object(r.__read)(h,2),v=g[0],b=g[1];try{for(var y=(a=void 0,Object(r.__values)(v.split(s))),O=y.next();!O.done;O=y.next()){var x=O.value,S=f(x);if(null===S)u('contains invalid range "'+x+'"');else if(!t(b,S))return}}catch(e){a={error:e}}finally{try{O&&!O.done&&(o=y.return)&&o.call(y)}finally{if(a)throw a.error}}}}catch(e){n={error:e}}finally{try{m&&!m.done&&(i=d.return)&&i.call(d)}finally{if(n)throw n.error}}}function g(e,t){if(void 0===t)return e;try{return function(e,t){if(t<0||t!==1/0&&!Object(o.a)(t))throw new Error("count must be a positive integer or Infinity");var n="";return h(e,function(e,r){return!r(t)||(n=e,!1)}),n}(e,t)}catch(t){return e}}},512:function(e,t,n){"use strict";n.r(t),n.d(t,"HeroCardRouterContainer",function(){return gu});var r=n(179),i=n(1),a=n(12),o=a.createContext(void 0);var l=function(e){var t=e.target,n=Object(i.__rest)(e,["target"]),r=a.useContext(o);return a.createElement("a",Object(i.__assign)({target:t||r},n,{id:n.id}))},c=n(267),s=n(20),u=n(85);var d=n(187),m=n(134),p=n(151);n(353);var f=n(158),h=n(15),g=n(157),v=n(72);function b(){return Object(u.useSelector)(h.k)}var y=["SkypeTeams","Yammer","Exchange"],O=n(390),x=n(6),S=n(25),C=n(10);function j(e){var t=function(e){if(Object(x.B)(e))return Object(C.j)(e);var t=Object(S.g)(e);return t&&"Conversation"===t.domain?t.provenance:void 0}(e);return t?Object(O.a)(y,function(e){return e===t?-1:0}):y}var k,E=n(342),w=n(153),T=n(290),I=(k=function(e,t){return(k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}k(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),A=function(e){function t(t){var n=e.call(this,t)||this;return n.state={hasError:!1},n}return I(t,e),t.getDerivedStateFromError=function(){return{hasError:!0}},t.prototype.componentDidCatch=function(e,t){var n=this.props,r=n.appContext,i=n.codeLocation;Object(w.g)(r.logger,i+".componentDidCatch:"+t.componentStack,e)},t.prototype.render=function(){return this.state.hasError?null:this.props.children},t}(a.Component),N=Object(T.a)(A),P=n(96),F=n(152),D=n(38),L=n(45),H=n(106),B=n(73),R=n(8),M=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),z=function(){return(z=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function _(e){return{heroDomain:Object(R.c)(e),allResultDomains:Object(R.a)(e),domainsFilter:Object(x.e)(e),areConnectorsEnabled:Object(x.b)(e),variantEnabledAsyncDomains:Object(h.l)(e)}}var W=n(65),U=(n(285),n(50)),q=n(393),V=n(22),K=n(184),Y=n(3),Q=n(111),G=n(37);function $(e,t){return void 0===t&&(t=Y.c),Object(q.a)(Object(W.filterOutNull)(Object(V.a)(e,function(e){return t(e)})))}function J(e){var t=e.logger,n=e.eventId,r=e.cardType,i=e.clientSize,a=e.eventScope,o=e.items,l=e.isHero,c=e.pageNumber,s=e.target,u=e.initialHeroImpression,d=e.placement,m=e.value,p=e.queryType,f=e.verticalId,h=e.externalSourceType,g=e.content,v=e.isAnswer;if(!Object(L.a)(o)){var b={cardType:r,clientSize:i,eventScope:a,count:Object(K.a)(o).toString(),isHero:l,pageNumber:c,target:s||$(o),entityId:$(o,Y.b),initialHeroImpression:u,placement:d,value:m,queryType:p,verticalId:f,externalSourceType:h,content:g,isAnswer:v};Object(Y.p)(t,{properties:b,eventId:n})}}var Z="Hero";function X(){var e=Object(u.useSelector)(C.x),t=a.useState(!1),n=t[0],r=t[1],i=Object(E.a)(),o=Object(c.b)(),l=Object(u.useSelector)(C.E);a.useEffect(function(){e&&!n&&(r(!0),function(e,t,n,r,i,a){var o={eventScope:"AnswerRoot",cardType:t,clientSize:n,target:r,alreadySignedIn:i,ssoSignedIn:a};Object(Y.p)(e,{properties:o,eventId:"Answer_Impression"})}(i,Z,o,l?"Hide":"Shown"))},[e,i,l])}n(524);var ee=n(66),te=n(40);function ne(){return window.performance?performance.now():Date.now()}function re(e){var t=a.useRef({}),n=a.useRef(ne());t.current.logger=Object(E.a)(),t.current.clientSize=Object(c.b)(),t.current.muid=Object(c.e)(),t.current.prevStaticProperties=Object(c.g)(),t.current.isSuppressed=Object(u.useSelector)(h.z),t.current.isHero=Object(u.useSelector)(h.y),t.current.heroDomain=Object(u.useSelector)(R.c);var r=function(e){var r=t.current,a=r.logger,o=r.clientSize,l=r.isSuppressed,c=r.isHero,s=r.heroDomain;n.current&&!l&&a&&o&&(!function(e,t,n,r,a,o){var l=n&&Object(G.b)(n),c=Object(i.__assign)({name:"DwellTime",value:t.toString(),eventScope:l,clientSize:r,isHero:a},o||{});Object(Y.C)(e,{eventId:"DwellTime",properties:c})}(a,ne()-n.current,s,o,!!c,e),n.current=ne())};return a.useEffect(function(){return function(){r(t.current.prevStaticProperties)}},[e]),r}var ie=n(133),ae=n(190),oe=n(258),le=n(33),ce=n(31);function se(e,t){void 0===t&&(t=!0);var n=a.useRef(void 0);return a.useEffect(function(){(t||null!=e)&&(n.current=e)},[e]),n.current}var ue=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,l)}c((r=r.apply(e,t||[])).next())})},de=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}};var me=n(156);function pe(e,t){var n=function(e){switch(e){case"Bookmark":return{BookmarkAnswerTriggered:!0};case"Calendar":return{CalendarAnswerTriggered:!0};case"File":return{FileAnswerTriggered:!0};case"Flight":return{FlightAnswerTriggered:!0};case"Person":return{PersonAnswerTriggered:!0};case"Acronym":return{AcronymAnswerTriggered:!0};case"Link":return{LinkAnswerTriggered:!0};case"TuringQnA":return{TuringQnAAnswerTriggered:!0};case"PeopleAlsoAsk":return{PeopleAlsoAskAnswerTriggered:!0};default:return}}(t);if(n){var r={TriggerConditions:n};Object(Y.m)(e,r)}}var fe=n(19),he=n(440);function ge(e,t,n,r,i){var a,o,l=t.offsetWidth,c=t.offsetHeight;if(i&&(0===l&&(l=(null===(a=t.parentElement)||void 0===a?void 0:a.offsetWidth)||0),0===c&&(c=(null===(o=t.parentElement)||void 0===o?void 0:o.offsetHeight)||0)),!n||n.offsetWidth!==l||n.offsetHeight!==c){var s=0;try{s=null==t?void 0:t.getBoundingClientRect().width}catch(n){console.log("element "+t+" is not on DOM when calling 'element.getBoundingClientRect()' in useDimension from "+e)}r({offsetWidth:l,offsetHeight:c,preciseOffsetWidth:s})}}function ve(e,t){var n=a.useState({offsetWidth:0,offsetHeight:0,preciseOffsetWidth:0}),r=n[0],i=n[1],o=se(r),l=function(e){var t=a.useRef(null);return a.useEffect(function(){if(t&&t.current){var n=t.current,r=new he.a(function(t){window.requestAnimationFrame(function(){Array.isArray(t)&&t.length&&(t[0].target===n&&e(n.clientHeight,n.clientWidth))})});return r.observe(n),function(){r.unobserve(n)}}},[t]),[t]}(function(){var n=l.current;n&&ge(e,n,o,i,t)})[0];return a.useEffect(function(){var n=l.current;n&&ge(e,n,o,i,t)}),[l,r]}function be(e,t,n,r){var i=ve(e+" + useDynamicClientSize"),a=i[0],o=i[1];return 0===o.offsetWidth?[a,n]:[a,r?r():o.offsetWidth<=t?"Small":"Large"]}var ye=n(103),Oe=n(520),xe=n(29),Se=n(391),Ce=n(47),je="<sep/>";Object(ye.a)(function(e,t,n,r){return t?function(e,t){var n=(r=t,i=Object(Oe.a)(r,RegExp("\\W+","g")),a="",Object(xe.a)(i,function(e){return a+=(a.length>0?"|":"")+"(\\b"+e+"\\b)"}),new RegExp(a,"gi"));var r,i,a;return ke(e,n)}(e,t):function(e,t,n){if(!t||!n)return[e];var r=new RegExp(t+".*?"+n,"gi");return ke(e,r)}(e,n,r)});function ke(e,t){var n=Object(Se.a)(e,t,function(e){return""+je+e+je});return Ee(Object(Oe.a)(n,je))}function Ee(e){return Object(H.a)(e,function(e){return!!e})}function we(e,t){!t||"Enter"!==e.key&&" "!==e.key||t()}var Te=function(e){return e.replace(/-/g,"/").replace(/_/g,"+")},Ie=n(420),Ae=n(344);function Ne(){var e=a.useContext(Ie.a),t=Ae.a.getSettings(["theme"],"WithTheme",e.customizations),n=a.useState(t.theme),r=n[0],i=n[1];return a.useEffect(function(){var t=function(){var t=Ae.a.getSettings(["theme"],"WithTheme",e.customizations).theme;i(t)};return Ae.a.observe(t),function(){return Ae.a.unobserve(t)}}),r}var Pe=n(430),Fe=n(526),De=n(0),Le=(Object(De.declareString)("search-components.search.shared.seeMore")),He=(Object(De.declareString)("search-components.search.shared.seeLess")),Be=(Object(De.declareString)("search-components.search.shared.ellipsisString")),Re=(Object(De.declareString)("search-components.search.shared.illustration")),Me=(Object(De.declareString)("search-components.search.shared.event")),ze=(Object(De.declareString)("search-components.search.shared.file")),_e=(Object(De.declareString)("search-components.search.shared.people")),We=(Object(De.declareString)("search-components.search.shared.closeButton")),Ue=(Object(De.declareString)("search-components.search.shared.answerTile"));var qe=n(346),Ve=n(343),Ke=Object(Ve.b)(function(e,t){var n;return Object(qe.t)({heroTileFrame:["ms-search-heroFrame",{background:e.palette.white,margin:"12px 12px 17px 12px",borderRadius:"2px",boxShadow:e.effects.elevation4,border:"1px solid "+e.palette.neutralLighterAlt,selectors:(n={"&:hover":{boxShadow:e.effects.elevation8},"&:active":{boxShadow:e.effects.elevation4}},n["&.ms-search-maxWidth"]={maxWidth:t||"603px"},n["&.ms-search-image-maxWidth"]={maxWidth:t||"871px"},n["&.ms-search-maxContent"]={maxWidth:"fit-content",minWidth:"360px"},n["&.ms-search-IEAdjustment"]={marginRight:"24px"},n)}]})}),Ye=function(e){return{margin:"0 "+(e?12:24)+"px",padding:"8px 0"}},Qe=Object(ye.a)(function(e,t,n,r,i,a,o,l,c){var s,u=e.palette,d=u.neutralLighter,m=u.neutralLighterAlt,p=u.themePrimary;return Object(qe.t)({bodyContainer:["ms-search-heroTile-bodyContainer",Ye(t),{overflow:"hidden"},c?c(e).bodyStyles:{}],flushTile:{selectors:(s={},s["& .ms-search-heroFrame"]={margin:0,boxShadow:"none"},s["& .ms-search-heroFrame:hover"]={margin:0,boxShadow:"none",backgroundColor:m},s["& .ms-search-tile-container"]={cursor:"default"},s)},headerContainer:["ms-search-heroTile-headerContainer",Ye(t),{borderBottom:"1px solid "+d,display:"flex",alignItems:"center"},c?c(e).headerStyles:{}],footerContainer:["ms-search-heroTile-footerContainer",{backgroundColor:m,height:"48px",overflow:"hidden",display:"flex"},c?c(e).footerStyles:{}],tileContainer:["ms-search-tile-container",{display:"flex",flexDirection:"Top"===n?"column":"Bottom"===n?"column-reverse":"Right"===n?"row-reverse":"row",cursor:l?"pointer":"default"}],imageContainer:{cursor:o?"pointer":"auto",overflow:"inherit",selectors:{"> img":{backgroundColor:p,width:i,maxWidth:a,height:r}}},content:{width:"100%"},cardStyles:[c?c(e).cardStyles:{}]})}),Ge=Object(ye.a)(function(e){var t=e.palette.neutralPrimary;return Object(qe.t)({root:["ms-search-heroTile-dismissButton",{marginLeft:"auto",float:"right"}],icon:["ms-search-heroTile-dimissButton-icon",{color:t}]})}),$e=n(94);function Je(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(W.filterOutNull)(e).join(" ")}var Ze=function(e,t,n){if(t&&n)return e?e({name:t,emailAddress:n}):void 0};var Xe=function(e){var t,n,r,i=e.className,o=e.cardStyles,l=Ne(),c=Ke(l).heroTileFrame,s=!(r=null===(n=null===(t=null===window||void 0===window?void 0:window.navigator)||void 0===t?void 0:t.userAgent)||void 0===n?void 0:n.toLowerCase())||-1===r.indexOf("msie")&&-1===r.indexOf("edge")&&-1===r.indexOf("rv:11.0")?void 0:"ms-search-IEAdjustment";return a.createElement("div",{className:Je(c,i,o,s)},e.children)};Xe.displayName="HeroTileFrame";var et=function(e){var t=e.body,n=e.className,r=e.header,i=e.footer,o=e.isSmall,l=e.imageProps,c=e.isFlushLayout,s=e.styleOverrides,u=e.cardClickProps,d=e.onDismiss,m=e.isDismissible,p=null==l?void 0:l.imagePosition,f=null==l?void 0:l.imageHeight,h=null==l?void 0:l.imageWidth,g=null==l?void 0:l.imageMaxWidth,v=null==l?void 0:l.headerImageUrl,b=null==l?void 0:l.onImageClick,y=Ne(),O=a.useState(!0),x=O[0],S=O[1],C=function(){m&&d&&d(),S(!1)},j=Qe(y,void 0===o||o,p,f,v&&h,g,!!b,!!u,s),k=j.headerContainer,E=j.bodyContainer,w=j.footerContainer,T=j.tileContainer,I=j.imageContainer,A=j.content,N=j.cardStyles,P=null==u?void 0:u.onCardClick,F=null==u?void 0:u.clickRole,D=function(){b&&b()},L=function(e){var t;null===(t=e.currentTarget.parentElement)||void 0===t||t.setAttribute("hidden","true")},H={iconName:Ce.d};return a.createElement(a.Fragment,null,x&&a.createElement("div",{className:c?j.flushTile:void 0},a.createElement(Xe,{className:n,cardStyles:N},a.createElement("div",{role:F||"presentation",className:T,tabIndex:P?0:-1,onClick:P,onKeyPress:function(e){e.preventDefault(),we(e,function(){return null==P?void 0:P()})},"aria-label":Ue()},!o&&p&&v&&a.createElement(Pe.a,{alt:Re(),src:v,className:I,onClick:D,onError:function(e){return L(e)}}),a.createElement("div",{className:A},r&&a.createElement("div",{className:k},r,m&&a.createElement(Fe.a,{iconProps:H,onClick:function(e){return function(e){e.stopPropagation(),C()}(e)},onKeyPress:function(e){e.stopPropagation(),we(e,C)},styles:Ge(y),title:We(),ariaLabel:We()})),o&&p&&v&&a.createElement(Pe.a,{alt:Re(),role:"presentation",src:v,className:I,onClick:D,onError:function(e){return L(e)}}),a.createElement("div",{className:E},t),i&&a.createElement("div",{className:w},i))))))},tt=n(222),nt=n(313),rt=n(200),it=n(415),at=n(97),ot=n(409),lt=n(63),ct="ConnectingFlights",st=(Object(De.declareString)("search-components-flight.search.flights.nonStop")),ut=(Object(De.declareString)("search-components-flight.search.flights.stops")),dt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightToday")),mt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightTomorrow")),pt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightInDays")),ft=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightNextWeek")),ht=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.futureFlight")),gt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.pastFlight")),vt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.flightDetails")),bt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.reservationIdWithLabel")),yt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.genericDayAndDate")),Ot=(Object(De.declareString)("search-components-flight.search.flights.viewReservation")),xt=(Object(De.declareString)("search-components-flight.search.flight.share")),St=(Object(De.declareString)("search-components-flight.search.flights.checkin")),Ct=(Object(De.declareString)("search-components-flight.search.flights.openFlightMail")),jt=(Object(De.declareString)("search-components-flight.search.flights.departureDetailsAriaLabel")),kt=(Object(De.declareString)("search-components-flight.search.flights.departureDetailsAriaLabel")),Et=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureDestinationAriaLabel")),wt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureCityAriaLabel")),Tt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureDateAriaLabel")),It=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalDateAriaLabel")),At=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.departureTimeAriaLabel")),Nt=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.arrivalDateAriaLabel")),Pt=(Object(De.declareString)("search-components-flight.search.flights.travelDurationDetailsAriaLabel")),Ft=(Object(De.declareStringWithPlaceholders)("search-components-flight.search.flights.travelDurationAriaLabel")),Dt=function(e,t){return e&&t?nt.b.getShortDurationTimeString(new Date(e),new Date(t),!1,Object(rt.b)()):""};function Lt(e,t){var n,r;if(!(n=e,r=new Date,!(new Date(n)>=r))){var i=new Date(e),a=new Date;if(Object(it.l)(i,a))return dt({destinationCity:t});var o=function(e,t){void 0===t&&(t=new Date),e.setHours(0,0,0,0),t.setHours(0,0,0,0);var n=e.getTime()-t.getTime();return Math.trunc(n/at.c)}(i,a),l=o.toString();return Object(it.p)(i,a)?mt({destinationCity:t}):o<at.w/at.c?pt({destinationCity:t,days:l}):o<2*at.w/at.c-(a.getDay()+6)%7?ft({destinationCity:t}):ht({destinationCity:t})}return gt({destinationCity:t})}function Ht(e){var t=new Date(e).getTime()-(new Date).getTime(),n=Math.trunc(t/at.e),r=Math.trunc((t-n*at.e)/at.h);return(n>0||r>0)&&n<24}var Bt=n(456),Rt=n(506),Mt=n(522),zt={display:"flex",flexDirection:"row",justifyContent:"space-between"},_t={display:"inline-block"},Wt={display:"inline-block",maxWidth:"45%",textAlign:"right"},Ut={fontSize:"12px",fontWeight:"600"},qt=Object(ye.a)(function(e,t){var n=e.palette.themeDark;return Object(qe.t)({row:[zt,{height:"100%",width:"100%",padding:"8px "+(t?"12px":"24px"),maxWidth:"556px"}],actionButton:{padding:"0 8px"},rightColumn:[Wt,{display:"flex",fontSize:"14px",maxWidth:"100%"}],confirmation:{paddingRight:"2px",paddingTop:"2px",lineHeight:"32px",verticalAlign:"middle"},shareMail:{border:"none",background:"inherit",color:n,padding:"0 12px",selectors:{"&:hover":{color:n}}},forwardIcon:{paddingLeft:"10px"}})}),Vt=function(e){var t=e.actionUrl,n=e.onActionButtonClick,r=e.actionType,i=e.isSmall,o=e.onShareClick,l=e.reservationId,c=e.isCheckin,s=e.openLink,u=function(e){e.stopPropagation(),t&&(s?s(t):window.open(t,"_blank"),n())},d=Ne(),m=qt(d,i),p=m.row,f=m.actionButton,h=m.rightColumn,g=m.confirmation,v=m.shareMail,b=m.forwardIcon;return a.createElement("div",{className:p},!c&&t&&a.createElement(Bt.a,{role:"link",text:r,onClick:function(e){return u(e)},className:f}),c&&t&&a.createElement(Rt.a,{role:"link",text:r,onClick:function(e){return u(e)},className:f}),a.createElement("div",{className:h},!i&&a.createElement("div",{className:g},bt({reservationId:l})),o&&a.createElement(Bt.a,{className:v,onClick:function(e){e.stopPropagation(),o&&o()}},a.createElement("span",null,xt()),a.createElement(Mt.a,{className:b,iconName:"Forward"}))))};function Kt(e){var t=a.useRef(new Image),n=a.useState(!1),r=n[0],i=n[1],o=function(){var e;(e=t.current)&&1===e.naturalHeight&&1===e.naturalWidth||i(!0)};return a.useEffect(function(){if(t.current.addEventListener("load",o,!1),e)return t.current.src=e,function(){t.current.removeEventListener("load",o,!1)}},[e]),r}var Yt=n(507),Qt=n(455),Gt=n(517),$t=(n(349),{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"}),Jt=[$t,{whiteSpace:"nowrap"}];Object(qe.s)({from:{opacity:0},to:{opacity:1}});var Zt=Object(ye.a)(function(e){var t=e.palette,n=t.neutralPrimary,r=t.neutralSecondary;return Object(qe.t)({header:{color:n,fontSize:"14px",fontWeight:"600",lineHeight:"24px",maxWidth:"556px",width:"100%"},row:zt,leftColumn:[{maxWidth:"100%",width:"100%"},_t],rightColumn:[Wt,{float:"right"}],airlineDetails:Ut,profilePhoto:{float:"left",marginRight:"8.75px"},answerTitle:[Jt,{fontWeight:"600",fontSize:"14px",color:r}]})}),Xt=function(){return(Xt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},en=function(e){var t=e.arrivalAirportCity,n=e.departureTimeInUtc,r=e.firstFlight,i=e.isSmall,o=e.imageUrl,l=e.LpcWrapper,c=e.userName,s=Ne(),u=Zt(s),d=u.header,m=u.row,p=u.leftColumn,f=u.rightColumn,h=u.airlineDetails,g=u.profilePhoto,v=u.answerTitle,b=r.airline,y=r.airlineIata,O=r.flightNumber,x={imageUrl:Kt(o)?o:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(Yt.a)(c,!1),initialsColor:Object(Qt.a)({text:c})},S=a.createElement("div",{className:g},a.createElement(Gt.a,Xt({},x))),C=l?a.createElement(l,null,S):S,j=Lt(n,t);return a.createElement("div",{className:d,role:"heading","aria-level":3},a.createElement("div",{className:m},a.createElement("div",{className:p},C,a.createElement("div",{className:v,title:j},j,!i&&a.createElement("div",{className:f},a.createElement("div",{className:h},vt({airline:b,airlineIata:y,flightNumber:O})))))))},tn=n(505),nn=n(518),rn=n(408),an=Object(ye.a)(function(e,t,n,r){var i=e.palette,a=i.neutralPrimary,o=i.neutralSecondary,l=i.neutralTertiaryAlt;return Object(qe.t)({itineraryContainer:{paddingBottom:"8px",paddingTop:"4px",margin:"0 0.8px",cursor:n?"pointer":"auto",maxWidth:"556px"},row:zt,departIata:{paddingRight:"24px",color:a,fontSize:"21px",fontWeight:"600"},arrivalIata:{paddingLeft:"24px",color:a,fontSize:"21px",fontWeight:"600"},lineContainer:{flexGrow:"10",display:"flex",flexDirection:"row"},flightIcon:{fontSize:"14px",height:"14px",color:l,position:"relative",letterSpacing:"0px",top:"54%",transform:"translateY(-50%)"},line:{flexGrow:"10",borderTop:l+" 0.5px solid",top:"50%",position:"relative"},durationContainer:{fontSize:"12px",color:o,position:"relative",top:"50%",height:"16px",padding:"4px 2px",transform:"translateY(-50%)",textAlign:"center"},duration:{marginBottom:"2px"},stops:{fontWeight:"600",cursor:0!==t?"pointer":"inherit",color:0===t?o:a},leftColumn:[_t,{maxWidth:"45%"}],rightColumn:[Wt,{maxWidth:"60%"}],smallText:{color:o,fontSize:r?"12px":"14px",height:"16px",marginTop:"4px"},time:{marginTop:"4px",fontWeight:"600",fontSize:"14px"},stopData:{fontWeight:"600",textAlign:"center",fontSize:"14px",color:a},airlineDetails:[Ut,{paddingBottom:"4px",color:o}],confirmation:{fontSize:"12px",paddingBottom:"4px",color:o}})}),on=/{C}/g,ln=function(e){var t,n,r=e.firstFlight,i=e.departureAirportIata,o=e.arrivalAirportIata,l=e.departureAirportCity,c=e.arrivalAirportCity,s=e.departureTime,u=e.arrivalTime,d=e.departureTimeInUtc,m=e.arrivalTimeInUtc,p=e.stopsCount,f=e.intermediateFlights,h=e.isSmall,g=e.onClick,v=e.getDisplayTime,b=e.dateTimeFormatter,y=Ne(),O=an(y,p,!!g,h),x=O.itineraryContainer,S=O.row,C=O.departIata,j=O.arrivalIata,k=O.flightIcon,E=O.line,w=O.lineContainer,T=O.durationContainer,I=O.duration,A=O.stops,N=O.leftColumn,P=O.rightColumn,F=O.smallText,D=O.time,L=O.stopData,H=O.airlineDetails,B=O.confirmation,R={onRenderContent:function(){return a.createElement(a.Fragment,null,Object(V.a)(f,function(e,t){if(0!==t)return a.createElement("div",{className:L},a.createElement("strong",null,e.departureAirportIata),": ",a.createElement("span",null,Dt(f[t-1].arrivalTimeInUtc,f[t].departureTimeInUtc)))}))}},M=function(e,t,n){var r=null==b?void 0:b.formatWeekDayDate,i=null==b?void 0:b.formatUserTime,o=(r?r(t):"")||function(e){if(!e)return"";var t=Object(rt.b)(),n=Object(ot.formatCalendarDateFromString)(t.generic,e,t),r=Object(lt.l)(new Date(e),t,"short");return yt({weekDay:r,genericDate:n})}(t),l=(i?i(t):"")||v(t);return a.createElement(a.Fragment,null,a.createElement("div",{className:F,role:"listitem","aria-label":n?Et({cityName:e}):wt({cityName:e})},e),a.createElement("div",{className:F,role:"listitem","aria-label":n?Tt({displayDate:o}):It({displayDate:o})},o),a.createElement("div",{className:D,role:"listitem","aria-label":n?At({displayTime:l}):Nt({displayTime:l})},l))},z=r.airline,_=r.airlineIata,W=r.flightNumber,U=r.reservationId;return a.createElement("div",{className:x,role:"presentation",onClick:g,tabIndex:g?0:-1,onKeyPress:function(e){e.preventDefault(),we(e,function(){return null==g?void 0:g()})},"aria-label":Ct()},h&&a.createElement("div",{className:S},a.createElement("div",{className:N},a.createElement("div",{className:H},vt({airline:z,airlineIata:_,flightNumber:W}))),a.createElement("div",{className:P},a.createElement("div",{className:B},bt({reservationId:U})))),a.createElement("div",{className:S},a.createElement("div",{className:C},i),a.createElement("div",{className:w},a.createElement(Mt.a,{className:k,iconName:"AirplaneSolid"}),a.createElement("div",{className:E}),a.createElement("div",{className:T,role:"list","aria-label":Pt()},a.createElement("div",{className:I,role:"listitem","aria-label":Ft({travelDuration:(t=d,n=m,t&&n?nt.b.getLongDurationTimeString(new Date(t),new Date(n),void 0):"")})},Dt(d,m)),a.createElement(nn.a,{tooltipProps:R,directionalHint:rn.a.bottomCenter,id:r.reservationId,styles:{root:{display:"inline-block"}},hidden:0===p},a.createElement("div",{className:A,role:"listitem","aria-describedby":r.reservationId,tabIndex:0===p?-1:0},cn(p)))),a.createElement("div",{className:E})),a.createElement("div",{className:j},o)),a.createElement("div",{className:S},a.createElement("div",{className:N,role:"list","aria-label":jt()},M(l,s,!0)),a.createElement("div",{className:P,role:"list","aria-label":kt()},M(c,u,!1))))},cn=function(e){return 0===e?st():Object(tn.a)(ut().replace(on,String(e)),e)},sn=function(){return(sn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},un=function(e){var t,n=e.intermediateFlights,r=e.scenarioType,i=e.clientSize,o=e.onCardClick,l=e.onShareClick,c=e.onWebCheckinClick,s=e.onViewReservationClick,u=e.imageUrl,d=e.userName,m=e.userEmail,p=e.getDisplayTime,f=e.livePersonaCard,h=e.dateTimeFormatter,g=e.setAnswerHeight,v=e.openLink,b=Object(U.a)(n),y=be("HeroFlightsTile",752,i),O=y[0],x=y[1],S=null===(t=O.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){S&&g&&g(S)},[S]);var C=a.useMemo(function(){return Ze(f,d,m)},[f,d,m]),j="Small"===x;if(!b)return null;var k=b.immutableItemIdsForMail,E=k[k.length-1],w=function(){if(E){var e=Te(E);o&&o({itemId:e})}},T={body:function(e,t,n,r,i,o,l){var c=n===ct?Object(tt.a)(t):e;if(!c)return null;var s=e.departureAirportIata,u=e.departureAirportCity,d=e.departureTime,m=e.departureTimeInUtc,p=c.arrivalAirportIata,f=c.arrivalAirportCity,h=c.arrivalTime,g=c.arrivalTimeInUtc,v=t.length-1,b={firstFlight:e,intermediateFlights:t,scenarioType:n,departureAirportIata:s,departureAirportCity:u,departureTime:d,departureTimeInUtc:m,arrivalAirportIata:p,arrivalAirportCity:f,arrivalTime:h,arrivalTimeInUtc:g,stopsCount:v,isSmall:r,getDisplayTime:i,onClick:l,dateTimeFormatter:o};return a.createElement(ln,sn({},b))}(b,n,r,j,p,h,o&&E?w:void 0),header:dn(b,n,r,j,u,d,C),footer:mn(b,j,c,s,l&&E?function(){if(E){var e=Te(E);l&&l({itemId:e})}}:void 0,v),isSmall:j,styleOverrides:function(){return{cardStyles:"ms-search-maxWidth"}}};return a.createElement("div",{ref:O,role:"presentation"},a.createElement(et,sn({},T)))};function dn(e,t,n,r,i,o,l){var c=n===ct?Object(tt.a)(t):e;if(!c)return null;var s={arrivalAirportCity:c.arrivalAirportCity,departureTimeInUtc:e.departureTimeInUtc,isSmall:r,firstFlight:e,imageUrl:i,userName:o,LpcWrapper:l};return a.createElement(en,sn({},s))}function mn(e,t,n,r,i,o){var l=e.potentialActions;if(0===l.length)return null;var c={actionUrl:l[0].value,actionType:Ht(e.departureTimeInUtc)?St():Ot(),onActionButtonClick:function(){Ht(e.departureTimeInUtc)?n():r()},isSmall:t,reservationId:e.reservationId,isCheckin:Ht(e.departureTimeInUtc),onShareClick:i,openLink:o};return a.createElement(Vt,sn({},c))}function pn(e){return Object(C.s)(e,"Flight")}function fn(e){var t=pn(e);return t?Object(U.a)(t):void 0}var hn=n(419),gn=n(265),vn=n(14),bn=n(49);const yn=["Hero_File_Impression","PowerBiApp_Impression"];function On(e){return Object(F.a)(yn,t=>t===e)}var xn=n(292),Sn=n(489),Cn=n(311),jn=n(271);function kn(){var e=Object(u.useSelector)(h.j);return Object(u.useSelector)(x.y)?"Ribbon"===e:"RichRibbon"===e}var En=n(286);function wn(e){var t=e.domain,n=e.isHero,r=e.isAsyncDomainImpressionFromMainRequest,i=e.intent,a=e.intentId,o=e.traceId,l=e.useAnswerOnly,c=e.pageNum;return Object(u.useSelector)(function(e){if(o)return o;if(n&&(r||!i))return Object(h.k)(e);switch(t){case"Conversation":case"Message":case"Person":var u=t&&Object(En.b)(t);return u&&Object(v.g)(e,u,{intent:i,intentId:a,useAnswerOnly:l,pageNum:c});case"Site":return Object(g.b)(e);case"File":return Object(m.c)(e)||Object(h.k)(e);case"PowerBi":return Object(f.b)(e);case"Connectors":return Object(d.a)(e,a);case"EducationAssignment":case"EducationClass":case"Calendar":case"CalendarAvailability":case"Group":case"Bookmark":case"Qna":case"Building":case"Acronym":case"FileEntity":case"Flight":case"FileAndSite":case"Notification":case"Turing":case"TuringQnA":case"PeopleAlsoAsk":case"Topic":case"Link":case"MeetingRoomProposal":case"External":case"EmployeeOffer":case"All":case"SharePoint":case"EducationAssignment":case"QueryReformulation":case"EnterpriseLearning":case void 0:return Object(h.k)(e);case"FloorPlan":return;default:return Object(s.a)(t)}})}var Tn=function(){return(Tn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function In(e){var t,n=e.domain,r=e.entity,i=e.impressionEventId,o=e.clickEventId,l=e.cardType,s=e.isHero,d=e.pageNumber,m=e.calendarIntent,p=e.eventScope,f=e.hasSubGroup,h=e.isFromMainSearch,g=e.virtualDomain,v=e.traceId,y=e.queryIntent,O=e.expandClickEventId,x=e.layoutProps,S=e.externalSourceType,C=e.verticalId,j=Object(E.a)(),k=Object(c.b)(),w=Object(jn.b)(),T=Object(jn.c)(),I=j.getStaticProperties()().logicalSearchId,A=Object(c.f)(),N=b(),F=wn({traceId:v,domain:g||n,isHero:!!s,isAsyncDomainImpressionFromMainRequest:h&&Object(P.d)(n)||On(i)}),D=kn(),L=Object(u.useSelector)(te.b),H=!D&&!L,B=a.useState(!1),R=B[0],M=B[1],z=a.useState(void 0),_=z[0],W=z[1],q=a.useState(void 0),V=q[0],K=q[1],$=a.useState(!1),J=$[0],Z=$[1],X=a.useState(!1),ne=X[0],re=X[1],ie=null===(t=Object(c.g)())||void 0===t?void 0:t.logicalSearchId,ae=(x||{}).isAnswer,oe=Object(u.useSelector)(ee.c);oe=oe||"Pole";var le=a.useMemo(function(){return{cardType:l,clientSize:k,eventScope:p||Object(G.b)(n),isHero:s,pageNumber:d,placement:oe,traceId:F,externalSourceType:S,verticalId:C}},[l,k,p,n,s,d,oe,F,S,C]),ce=function(e){var t,n;return JSON.stringify(((t={}).topicId=e.id,t.topicStatus=e.state,t.hasTopicDescription=!(null===(n=e.definitionProperties)||void 0===n||!n.text),t.topicLifeCycleState=e.lifeCycleState,t.topicSource=e.source,t.topicType=e.topicType,t.topicRelevanceScore=Math.round(100*e.relevanceScore)/100,t))};a.useEffect(function(){var e;A&&J&&!ne&&(re(!0),Object(Q.e)({logger:j,domain:g||n,impressionEventId:i,traceId:F,startTime:A,endTime:new Date,pageNumber:d,componentStartTime:_,componentEndTime:Object(G.a)(),dontSendResultsRendered:!(null===(e=null===vn.a||void 0===vn.a?void 0:vn.a.flightParams)||void 0===e?void 0:e.isRRFixEnabled)&&!(F!==N||ie&&ie!==I)}))}),a.useEffect(function(){var e=Object(G.a)();W(e),K(new Date),re(!1),Object(Q.g)(i,e),M(!1),Z(!1)},[d,F]),a.useEffect(function(){if(r&&!R){if(M(!0),Object(me.b)({logger:j,entity:r,traceId:F,pageLoadStartTime:V,domain:g||n,hasSubGroup:f,entityProperties:"Topic"===(n||r.domain)?ce(r):void 0,isHero:s,eventId:i,overridePlaceholderId:w,layoutProps:x,placement:T}),i){var e={logger:j,eventId:i,cardType:l,clientSize:k,isHero:s,initialHeroImpression:H,isAnswer:ae};switch(n){case"Calendar":m&&function(e){var t=e.logger,n=e.eventId,r={cardType:e.cardType,clientSize:e.clientSize,eventScope:"Calendar",target:e.intent,isHero:e.isHero,placement:e.placement,initialHeroImpression:e.initialHeroImpression,isAnswer:e.isAnswer};Object(Y.p)(t,{properties:r,eventId:n})}(Tn(Tn({},e),{intent:m,placement:oe}));break;case"Bookmark":!function(e){var t=e.logger,n=e.eventId,r=e.heroBookmark,i=e.cardType,a=e.clientSize,o=e.isHero,l=e.placement,c=e.initialHeroImpression,s=e.isAnswer;if(r){var u={cardType:i,clientSize:a,eventScope:"Bookmark",target:Object(Y.c)(r),entityId:Object(Y.b)(r),index:"1",queryType:r.queryType,isHero:o,value:r.entityType||"",content:r.isSystemOwned?"SystemOwned":void 0,placement:l,initialHeroImpression:c,isAnswer:s};Object(Y.p)(t,{properties:u,eventId:n})}}(Tn(Tn({},e),{heroBookmark:r,placement:oe}));break;case"Flight":!function(e){var t=e.logger,n=e.eventId,r=e.flightEntity,i=e.cardType,a=e.clientSize,o=e.isHero,l=e.initialHeroImpression,c=e.isAnswer;if(r&&Object(U.a)(r.flights)){var s={cardType:i,clientSize:a,eventScope:"Flight",isHero:o,initialHeroImpression:l,isAnswer:c};Object(Y.p)(t,{properties:s,eventId:n})}}(Tn(Tn({},e),{flightEntity:r}));break;default:!function(e){var t=e.logger,n=e.eventId,r=e.entity,i=e.cardType,a=e.clientSize,o=e.eventScope,l=e.isHero,c=e.pageNumber,s=e.queryType,u=e.index,d=e.initialHeroImpression,m=e.placement,p=e.value,f=e.externalSourceType,h=e.verticalId,g=e.isAnswer;if(r){var v={cardType:i,clientSize:a,eventScope:o,target:Object(Y.c)(r),isHero:l,pageNumber:c,queryType:s,index:u,initialHeroImpression:d,placement:m,value:p,externalSourceType:f,verticalId:h,isAnswer:g};Object(Y.p)(t,{properties:v,eventId:n})}}({logger:j,entity:r,eventId:i,eventScope:p||Object(G.b)(n),cardType:l,clientSize:k,isHero:s,pageNumber:d,queryType:"Qna"===n?r.queryType:"Person"===n&&y?y:void 0,initialHeroImpression:H,placement:oe,value:"Hero_Adaptive_Async_Answer_Impression"===i?r.contentSource:void 0,externalSourceType:S,verticalId:C,isAnswer:ae})}}Z(!0)}},[j,r,F,A,n,i,p,l,k,s,d,m,H,oe,w,x]);var se=a.useMemo(function(){return function(e,t){var i;if(o&&r){var a=(t||{}).interpretation;Object(gn.e)(j,e||o,r,Tn(Tn(Tn({},le),t),{entityAttributes:"Topic"===(n||r.domain)?a||JSON.stringify((i={},i.topicId=r.id,i)):void 0,interpretation:a||r.interpretation,queryType:r.queryType}),0)}}},[o,r,le,n]),ue=a.useMemo(function(){return function(e,t){se(e,t)}},[]),de=a.useMemo(function(){return function(e,t){O&&se(O,Tn(Tn({},t),{isExpanded:e}))}},[]),pe=a.useMemo(function(){return function(e,t){return Object(gn.d)(j,e,Tn(Tn({},le),t))}},[j,le]);return a.useMemo(function(){return{entityActions:{onEntityClick:se,onActionClick:ue},nonEntityActions:{onExpandClick:de,onSearchActionClick:pe},placeholderId:w}},[se,ue,de,pe,w])}function An(e){var t,n=e.entities,i=e.domain,o=e.isHero,l=e.intent,s=e.calendarIntent,d=e.impressionEventId,m=e.clickEventId,p=e.cardType,f=e.pageNumber,h=e.target,g=e.provenance,v=e.eventScope,y=e.isFromMainSearch,O=e.intentId,x=e.startIndex,S=e.virtualDomain,C=e.traceId,j=e.completedLoading,k=e.expandClickEventId,w=e.groupReferenceId,T=e.contentSources,I=e.queryTypes,A=e.isSuppressed,N=e.layoutProps,F=e.placement,D=e.verticalId,L=e.externalSourceType,H=e.content,B=Object(E.a)(),R=B.getStaticProperties()().logicalSearchId,M=Object(c.f)(),z=b(),_=Object(c.b)(),W=wn({traceId:C,domain:S||i,isHero:o,intent:l,intentId:O,isAsyncDomainImpressionFromMainRequest:y&&Object(P.d)(i)||On(d)}),U=a.useState(void 0),V=U[0],K=U[1],Y=a.useState(void 0),$=Y[0],Z=Y[1],X=a.useState(!1),ne=X[0],re=X[1],ie=a.useState(!1),ae=ie[0],oe=ie[1],le=null===(t=Object(c.g)())||void 0===t?void 0:t.logicalSearchId,ce=a.useState(Object(hn.a)())[0],se=a.useState(!1),ue=se[0],de=se[1],pe=kn(),fe=Object(u.useSelector)(te.b),he=Object(jn.b)(),ge=Object(jn.c)(),ve=!pe&&!fe,be=N||{},ye=be.isAnswer,Oe=be.isDomainResult,Se=Object(u.useSelector)(ee.c);Se=F||(Se||"Pole");var Ce=a.useMemo(function(){return{cardType:p,clientSize:_,eventScope:v||Object(G.b)(i),isHero:o,groupReferenceId:w,pageNumber:f,placement:Se,target:h,traceId:W,verticalId:D,externalSourceType:L,content:H}},[p,_,v,i,o,w,f,Se,h,W,D,L,H]);a.useEffect(function(){var e;V&&M&&ne&&!ae&&d&&(oe(!0),Object(Q.e)({logger:B,domain:S||i,impressionEventId:d,traceId:W,startTime:M,endTime:new Date,noResultsPage:Object(r.a)(n),pageNumber:f,componentStartTime:V,componentEndTime:Object(G.a)(),dontSendResultsRendered:!(null===(e=null===vn.a||void 0===vn.a?void 0:vn.a.flightParams)||void 0===e?void 0:e.isRRFixEnabled)&&!(W!==z||le&&le!==R)}))}),a.useEffect(function(){var e;if(((null===(e=null===vn.a||void 0===vn.a?void 0:vn.a.flightParams)||void 0===e?void 0:e.isRRFixEnabled)||le!==R)&&!Object(bn.c)()){var t=Object(G.a)();K(t),Z(new Date),A||Object(Q.g)(d,t)}re(!1),oe(!1),de(!1)},[f,W]),a.useEffect(function(){var e;Object(r.a)(n)&&!j||ue||(de(!0),(null===(e=null===vn.a||void 0===vn.a?void 0:vn.a.flightParams)||void 0===e?void 0:e.isFlatClientLayoutEnabled)&&!he&&(ye||Oe)&&!(null==N?void 0:N.layoutType)?Object(xe.a)(n,function(e){return Object(me.b)({logger:B,entity:e,traceId:W,pageLoadStartTime:$,domain:S||i,isHero:o,eventId:d,overridePlaceholderId:he,layoutProps:N,placement:ge})}):Object(me.c)({logger:B,entities:n,domain:S||i,isHero:o,traceId:W,pageLoadStartTime:$,provenance:g,intent:l,layoutKey:ce,eventId:d,groupReferenceId:w,overridePlaceholderId:he,layoutProps:N,placement:ge}),d&&J({logger:B,items:n,eventId:d,eventScope:v||Object(G.b)(i),cardType:p,clientSize:_,isHero:o,pageNumber:f,target:h||s,initialHeroImpression:ve,placement:Se,value:Object(q.a)(T),queryType:Object(q.a)(I),verticalId:D,externalSourceType:L,content:H,isAnswer:ye}),re(!0))},[B,n,i,W,M,g,l,d,v,p,_,o,f,h,ve,ce,Se,N]);var je=a.useMemo(function(){return function(e,t,r){var i=Object(xn.a)(n,function(t){return t.id===e}),a=null==n?void 0:n[i];a&&ke(a,i,t,r)}},[n]),ke=a.useMemo(function(){return function(e,t,r,i){if(m){var a=e.queryType||(null==r?void 0:r.queryIntent);n&&Object(Sn.a)(t)&&(t=Object(Cn.a)(n,e)),t=Object(Sn.a)(t)||-1===t?void 0:t+(x||0),Object(gn.e)(B,i||m,e,Tn(Tn(Tn(Tn({},Ce),{interpretation:e.interpretation}),r),{queryType:a,traceId:e.traceId||W}),t)}}},[m,n,x,B,Ce,W]),Ee=a.useMemo(function(){return function(e,t,n,r,a){m&&ke(e,t,Tn({eventScope:v||(n?Object(G.b)(n):Object(G.b)(i))},r),a)}},[m,v,i]),we=a.useMemo(function(){return function(e,t,n){je(e,n,t)}},[]),Te=a.useMemo(function(){return function(e,t,n,r){ke(e,n,r,t)}},[]),Ie=a.useMemo(function(){return function(e,t){k&&Ae(k,Tn(Tn({},t),{isExpanded:e}))}},[k]),Ae=a.useMemo(function(){return function(e,t){return Object(gn.d)(B,e,Tn(Tn({},Ce),t))}},[B,Ce]);return a.useMemo(function(){return{entityActions:{onEntityClickId:je,onEntityClick:ke,onEntityClickDifferentDomain:Ee,onActionClickId:we,onActionClick:Te},nonEntityActions:{onExpandClick:Ie,onSearchActionClick:Ae},placeholderId:he}},[je,ke,Ee,we,Te,Ie,Ae,he])}var Nn=n(521);function Pn(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1);var r=Object(Nn.a)(String(e.getMinutes()),2,"0");return n?Fn(e,!1)+":"+r+" "+Dn(e,t):Fn(e,!1)+":"+r+Dn(e,t)}function Fn(e,t){var n=Object(lt.d)(e,t,void 0);return Number(n)}function Dn(e,t){void 0===t&&(t=!0);var n=Object(rt.b)();return t?e.getHours()>=12?n.pmPartOfDayLowercaseAbbreviated:n.amPartOfDayLowercaseAbbreviated:e.getHours()>=12?n.pmPartOfDayLowercase:n.amPartOfDayLowercase}var Ln=n(289),Hn=n(254);n(387),n(279);var Bn=100;function Rn(e){return e&&"data:image/jpeg;base64,"+e}function Mn(e,t){if(e&&!Object(L.a)(e))for(var n=0;n<e.length;n++){var r=zn(e[n],t);if(r)return r}}function zn(e,t){var n=e.text,r=e.children;if(n)return n.substr(0,t||Bn);if(r)for(var i=0;i<r.length;i++){var a=zn(r[i],t);if(a)return a}}var _n=n(288),Wn=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,l)}c((r=r.apply(e,t||[])).next())})},Un=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},qn="ErrorItemNotFound";function Vn(e,t){var n=this,r=Object(E.a)(),i=a.useState(void 0),o=i[0],l=i[1],c=Object(_n.b)(function(t){return!!e&&function(e,t){return Hn.b.getSelectors(e).isCallInProgress(Object(Hn.c)(t))}(t,e)},function(t){return!!e&&function(e,t){return Hn.b.getSelectors(e).hasLoaded(Object(Hn.c)(t))}(t,e)},function(t){return!!e&&function(e,t){return Hn.b.getSelectors(e).hasError(Object(Hn.c)(t))}(t,e)},function(t){return e?function(e,t){return Hn.b.getSelectors(e).getLatestSuccess(Object(Hn.c)(t))}(t,e):void 0},function(r){return function(e,r){return function(i){return Wn(n,void 0,void 0,function(){var n;return Un(this,function(a){switch(a.label){case 0:return!r||t?[3,2]:(n=[Object(ce.f)("GET","ProfilePhoto",r)],[4,i(Object(Ln.a)(e,n,r))]);case 1:a.sent(),a.label=2;case 2:return[2]}})})}}(r,e)},"FetchPersonPhoto_"+e);return a.useEffect(function(){var n,i,a;if(e)if(t)Promise.resolve(t(e)).then(function(e){l(e)}).catch(function(){});else{if(c.isFetching||!c.data)return;var o=null===(n=null==c?void 0:c.data)||void 0===n?void 0:n.responses[0].status;if(o&&200!==o){if(404===o)try{if((null===(i=null==c?void 0:c.data)||void 0===i?void 0:i.responses[0].body).error.code===qn)return}catch(e){}return void Object(w.a)(r,o.toString())}l(Rn(null===(a=c.data)||void 0===a?void 0:a.responses[0].body))}},[c.data,t,e]),o}var Kn=n(28),Yn=n(255);function Qn(e){var t,n=null===(t=Yn.b.getSelectors(e).getLatestSuccess(Yn.c))||void 0===t?void 0:t.responses;return null==n||n.sort(function(e,t){return e.id.valueOf()-t.id.valueOf()}),n}function Gn(e){var t=Qn(e);return t&&t[0].body}function $n(e){var t=Gn(e);return null==t?void 0:t.displayName}function Jn(e){var t=Gn(e);return null==t?void 0:t.mail}function Zn(e){var t=Gn(e);return null==t?void 0:t.userPrincipalName}function Xn(e){var t=function(e){var t=Qn(e);return t&&t[1].body}(e);return null==t?void 0:t.value[0].displayName}function er(){var e,t=Object(u.useSelector)(Kn.f),n=null===(e=nr())||void 0===e?void 0:e.userData,r=Object(u.useSelector)(Jn);return rr()?(null==n?void 0:n.mail)||r:t}function tr(){var e,t=Object(u.useSelector)(Kn.f),n=null===(e=nr())||void 0===e?void 0:e.userData,r=Object(u.useSelector)(Zn);return rr()?(null==n?void 0:n.userPrincipalName)||r:t}function nr(){var e;return null===(e=Object(c.h)())||void 0===e?void 0:e.userProperties}function rr(){var e;return!!(null===(e=Object(c.h)().additionalAnswerConfigs)||void 0===e?void 0:e.disableMsbApis)}var ir="Flight";var ar=function(){return(ar=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},or=function(e){var t,n,r,i,o=e.className,l=Object(u.useSelector)(fn),s=er(),d=(n=Object(u.useSelector)(Kn.d),r=null===(t=nr())||void 0===t?void 0:t.userData,i=Object(u.useSelector)($n),rr()?(null==r?void 0:r.displayName)||i:n),m=Object(c.b)(),p=Object(E.a)(),f=Object(c.a)(),h=b(),g=function(e){if(!e||Object(L.a)(e.flights))return null;var t=e.flights,n=Object(U.a)(t);return n?{firstFlight:n,intermediateFlights:t}:null}(l),v=null==g?void 0:g.firstFlight,y=se(v),O=null==g?void 0:g.intermediateFlights,x=null==f?void 0:f.setAnswerHeight,S=null==f?void 0:f.openLink,C=null==f?void 0:f.getProfilePhotoUrl,j=Object(c.h)().additionalAnswerConfigs,k=null==j?void 0:j.enableDwellStartLogging,w=Vn(s,C),T=In({domain:"Flight",entity:l,impressionEventId:"Hero_Flight_Impression",cardType:"Hero",isHero:!0,clickEventId:"Flight_Card_Click"});a.useEffect(function(){var e;!y&&v&&(null===(e=null==f?void 0:f.setAnswerBlockRendered)||void 0===e||e.call(f,T.placeholderId),k&&T.entityActions.onActionClick("Display_Started"))},[v,y]);var I=null==f?void 0:f.openMail,A=null==f?void 0:f.forwardMail,N=null==f?void 0:f.livePersonaCard,P=null==f?void 0:f.dateTimeFormatter;if(!l||Object(L.a)(l.flights))return null;var F=l.scenarioType;if(!v||!O)return null;var D={intermediateFlights:O,scenarioType:F,clientSize:m,onWebCheckinClick:function(){!function(e,t,n,r,i,a,o){Object(gn.a)(e,i?"Flight_Web_CheckIn_Click_Expanded":"Flight_Web_CheckIn_Click_Collapsed",{eventScope:ir,cardType:n,clientSize:r,traceId:a,isHero:o},t)}(p,l,"Hero",m,!0,h,!0)},onViewReservationClick:function(){!function(e,t,n,r,i,a){Object(gn.a)(e,"Flight_View_Reservation_Click",{eventScope:ir,cardType:n,clientSize:r,traceId:i,isHero:a},t)}(p,l,"Hero",m,h,!0)},getDisplayTime:function(e){return Pn(new Date(e),!1,!0).toUpperCase()},imageUrl:w,className:o,userEmail:s,userName:d,onCardClick:I?function(e){null==I||I(e),function(e,t,n,r,i,a){Object(gn.a)(e,"Flight_Card_Click",{eventScope:ir,cardType:n,clientSize:r,traceId:i,isHero:a},t)}(p,l,"Hero",m,h,!0)}:void 0,onShareClick:A?function(e){null==A||A(e),function(e,t,n,r,i,a){Object(gn.a)(e,"Flight_Share_Click",{eventScope:ir,cardType:n,clientSize:r,traceId:i,isHero:a},t)}(p,l,"Hero",m,h,!0)}:void 0,dateTimeFormatter:P,livePersonaCard:N,setAnswerHeight:x,openLink:S};return a.createElement(un,ar({},D))},lr=n(504),cr=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sr=function(){return(sr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var ur=n(508),dr={black:{red:0,green:0,blue:0,alpha:1},transparent:{red:0,green:0,blue:0,alpha:0},white:{red:255,green:255,blue:255,alpha:1}};function mr(e,t,n){if(!t||!(t<0||t>1)){var r=function(e,t){if(void 0===t&&(t=!1),(e=e.toLowerCase())in dr)return dr[e];var n=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/);if(n)return t?{alpha:parseInt(n[1],16)/255,red:parseInt(n[2],16),green:parseInt(n[3],16),blue:parseInt(n[4],16)}:{red:parseInt(n[1],16),green:parseInt(n[2],16),blue:parseInt(n[3],16),alpha:parseInt(n[4],16)/255};var r=e.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/);if(r)return{red:parseInt(r[1],16),green:parseInt(r[2],16),blue:parseInt(r[3],16),alpha:1};var i=e.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])([0-9a-f])$/);if(i)return t?{alpha:parseInt(""+i[1],16)/15,red:parseInt(""+i[2]+i[2],16),green:parseInt(""+i[3]+i[3],16),blue:parseInt(""+i[4]+i[4],16)}:{red:parseInt(""+i[1]+i[1],16),green:parseInt(""+i[2]+i[2],16),blue:parseInt(""+i[3]+i[3],16),alpha:parseInt(""+i[4],16)/15};var a=e.match(/^#([0-9a-f])([0-9a-f])([0-9a-f])$/);if(a)return{red:parseInt(""+a[1]+a[1],16),green:parseInt(""+a[2]+a[2],16),blue:parseInt(""+a[3]+a[3],16),alpha:1};var o=e.replace(/\s/g,"").match(/^rgb\(([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/);if(o)return{red:Number(o[1]),green:Number(o[2]),blue:Number(o[3]),alpha:1};var l=e.replace(/\s/g,"").match(/^rgba\(([0-9\.]+),([0-9\.]+),([0-9\.]+),([0-9\.]+)\)/);return l?{red:Number(l[1]),green:Number(l[2]),blue:Number(l[3]),alpha:Number(l[4])}:{red:0,green:0,blue:0,alpha:1}}(e),i=r.red,a=r.green,o=r.blue,l=r.alpha,c=null!=t?t:l,s=i+","+a+","+o+(1!==c?","+c:"");return n?s:1!==c?"rgba("+s+")":"rgb("+s+")"}}var pr,fr,hr=Object(Ve.b)(function(e,t){return Object(qe.t)({h1:{fontSize:"2em",margin:".67em 0"},h2:{fontSize:"1.5em",margin:".83em 0"},h3:{fontSize:"1.17em",margin:"1em 0"},h4:{margin:"1.33em 0"},code:{background:mr(e.palette.white,.05),borderRadius:"2px"},blockquote:{padding:"0 1rem",marginLeft:"0",color:"#819198",borderLeft:".3rem solid #dce6f0"},ol:{paddingLeft:"40px",selectors:{"> li":{listStyleType:"decimal"},".ms-search-text &":{paddingLeft:"40px"}}},ul:{paddingLeft:"40px",selectors:{"> li":{listStyleType:"disc"},".ms-search-text &":{paddingLeft:"40px"}}},td:{border:"1px solid",padding:"8px"},th:{border:"1px solid",padding:"8px",fontWeight:"bold"},p:{selectors:{"+ &":{marginTop:t?"0px":"1em"}}}})}),gr=(pr=function(e){return function(e){var t=e.theme,n=e.item,r=e.isCompactView,i=e.onLinkClick,o=hr(t,r);switch(Object(ur.a)(n.type)){case"a":return a.createElement(l,{href:n.href,title:n.title,onClick:i},vr(e));case"blockquote":return a.createElement("blockquote",{className:o.blockquote},vr(e));case"br":return a.createElement("br",null);case"code":return a.createElement("code",{className:Je(o.code,n.class)},vr(e));case"div":return a.createElement("div",null,vr(e));case"em":return a.createElement("em",null,vr(e));case"h1":return a.createElement("h1",{className:o.h1},vr(e));case"h2":return a.createElement("h2",{className:o.h2},vr(e));case"h3":return a.createElement("h3",{className:o.h3},vr(e));case"h4":return a.createElement("h4",{className:o.h4},vr(e));case"hr":return a.createElement("hr",null,vr(e));case"img":return a.createElement("img",{src:n.src,title:n.title,alt:n.alt},vr(e));case"li":return a.createElement("li",null,vr(e));case"ol":return a.createElement("ol",{className:o.ol},vr(e));case"p":return a.createElement("p",{className:o.p},vr(e));case"pre":return a.createElement("pre",null,vr(e));case"strong":return a.createElement("strong",null,vr(e));case"text":return a.createElement(a.Fragment,null,n.text);case"span":return a.createElement("span",null,vr(e));case"ul":return a.createElement("ul",{className:o.ul},vr(e));case"table":return a.createElement("table",null,vr(e));case"thead":return a.createElement("thead",null,vr(e));case"tbody":return a.createElement("tbody",null,vr(e));case"tr":return a.createElement("tr",null,vr(e));case"th":return a.createElement("th",{style:br(n),className:o.th},vr(e));case"td":return a.createElement("td",{style:br(n),className:o.td},vr(e));default:return null}}(e)},fr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return cr(t,e),t.prototype.render=function(){return a.createElement(pr,sr({},this.props))},t}(a.Component),Object(lr.a)("WithTheme",["theme"])(fr));function vr(e){var t=e.item,n=e.isCompactView,r=e.onLinkClick;if(!t.children)return null;if(1===Object(K.a)(t.children)&&"text"===Object(ur.a)(t.children[0].type)){for(var i=t.children[0].text,o=i&&Object(Oe.a)(i,"\n")||[],l=[],c=0,s=0;s<o.length;s++){var u={type:"text",text:o[s]};l.push(a.createElement(gr,{item:u,key:c,isCompactView:n})),c++,s<o.length-1&&(l.push(a.createElement("br",{key:c})),c++)}return l}return Object(V.a)(t.children,function(e,t){return a.createElement(gr,{item:e,key:t,isCompactView:n,onLinkClick:r})})}function br(e){if(e&&e.style)try{var t={},n=Object(H.a)(Object(Oe.a)(e.style,";"),function(e){return!!e});return Object(xe.a)(n,function(e){var n=Object(V.a)(Object(H.a)(Object(Oe.a)(e,":"),function(e){return!!e}),function(e){return e.trim()});if(2===Object(K.a)(n)){var r=n[0],i=n[1];switch(r){case"text-align":t.textAlign=i}}}),t}catch(t){return void console.warn("Invalid style format in markdown: "+e.style)}}var yr=n(154),Or=n(336),xr=/([\r\n]+|,|_|\.|-|\/|\\|\))/g,Sr=/(\()/g,Cr=/([^A-Z])([A-Z]\w)/g;function jr(e,t,n,r,i,a,o){if(void 0===o&&(o=!1),Object(Or.d)(e)||!a)return{originalText:e,numLines:0,text:e};a.font=Tr(t);var l=r,c=n,s=e,u=function(e,t){void 0===t&&(t=!1);var n=Object(Or.b)(e),r=!n&&(i=e,i.indexOf(" ")<0&&!(i.match(xr)||i.match(Sr)||i.match(Cr)));var i;return{textUnits:n||r||t?e.split(""):(a=e,a.replace(xr,"$1​").replace(Sr,"​$1").replace(Cr,"$1​$2")).match(/([\u200B]?[ ]?[\u200B]?[^\u200B ]+)/g)||[],isCJKLanguage:n,isSingleWord:r};var a}(s,o),d=u.textUnits,m=u.isCJKLanguage,p=u.isSingleWord;!m&&p&&(l=1,r=1);for(var f=o?s:d,h=0,g=f[h],v=g;h<f.length&&l>0;)if(a.measureText(Er(g,h,f.length,l,i)).width>=c){if(0===--l&&!o){for(var b=g.length,y=g.length/2;y>=1;)a.measureText(i.replace("{0}",g.slice(0,-b+y))).width<c&&(b-=y),y/=2;var O=f[h].slice(0,-b);O.length>2&&(v+=O)}g=f[h].trim()}else h>0&&(v+=f[h]),g+=f[++h];return{originalText:e,numLines:0===l?r:r-l+1,text:v=Er(v,h,f.length,l,i)}}function kr(){return window&&window.document?window.document.createElement("canvas").getContext("2d"):null}function Er(e,t,n,r,i){return t===n||r>1?e:i.replace("{0}",e)}function wr(e,t,n,r){if(Object(Or.d)(n.fontFamily)||Object(Or.d)(n.fontSize.toString()))throw new RangeError("Font parameters not provided ");return function(e,t,n,r,i){if(Object(Or.d)(e)||!i||t<=0)return{originalText:e,text:""};i.font=Tr(n);var a=e;if(i.measureText(e).width>t){var o=i.measureText(r).width,l=t-o,c=jr(e,n,l/2,1,"{0}",i,!0),s=jr(e.split("").reverse().join(""),n,l/2,1,"{0}",i,!0);s.text=e.slice(-s.text.length),a=""+c.text+r+s.text}return{originalText:e,text:a}}(e,t,n,r,kr())}function Tr(e){return(e.fontStyle||"")+" "+(e.fontVariant||"")+" "+(e.fontWeight||"")+" "+e.fontSize+"px "+e.fontFamily}var Ir=Object(Ve.b)(function(){return Object(qe.t)({container:["ms-search-splitter",{display:"inline-block",verticalAlign:"middle"}]})}),Ar=function(e){var t=Ir(),n=e.className,r=e.isLarge;return a.createElement("div",{className:Je(t.container,n),"aria-hidden":!0},r?a.createElement(a.Fragment,null,"•"):a.createElement(a.Fragment,null,"·"))};var Nr={context:a.createContext([]),makeStyles:function(e){var t=Object(Ve.b)(function(t){var n={};return Object.keys(e).forEach(function(r){var i=e[r];n[r]="function"==typeof i?i(t):i}),Object(qe.t)(n)});return function(){var e=Ne();return t(e)}},mergeClasses:qe.u},Pr=function(e,t){return function(e,t,n){var r=e.makeStyles(n);function o(){var n=r(),o=a.useContext(e.context).map(function(e){return e[t]}).filter(Boolean);if(o.length>0){var l=o.map(function(e){return e()}),c={};return Object.keys(n).forEach(function(t){c[t]=e.mergeClasses.apply(e,Object(i.__spreadArray)([n[t]],Object(i.__read)(l.map(function(e){return e[t]}))))}),c}return n}return o.componentName=t,o}(Nr,e,t)},Fr=13,Dr=17,Lr=function(e){return{color:e.palette.themePrimary,textDecoration:"none",cursor:"pointer",selectors:{":hover":{textDecoration:"underline"}}}},Hr=function(e){return[Br(e),Lr(e),{selectors:{span:{verticalAlign:"middle"}}}]},Br=function(e){return["ms-search-text",e.fonts.small,{fontSize:Fr+"px",lineHeight:Dr+"px"}]},Rr=function(e){return[Br(e),{color:e.palette.neutralPrimary}]},Mr=function(e){return[[zr(e),{color:e.palette.themePrimary}]]},zr=function(e){return["ms-search-text-h1",e.fonts.large,{lineHeight:"26px",color:e.palette.black,fontWeight:"normal"}]},_r=function(e){return["ms-search-text-h3",e.fonts.medium,{lineHeight:"19px",color:e.palette.black}]},Wr=function(e){return[Br(e),Jt]},Ur=function(e){return["ms-search-text-s",e.fonts.tiny,{fontSize:"11px",lineHeight:"13px",color:e.palette.neutralPrimary}]},qr=(Pr("Attribution",{text:function(e){return[Wr(e),{display:"block",color:e.palette.green,marginTop:"4px",textOverflow:"ellipsis"}]}}),Pr("Title",{text:function(e){return Mr(e)}}),Pr("TitleSmall",{text:function(e){return[Mr(e),{lineHeight:"24px"}]}}),Pr("Description",{text:function(e){return[Br(e),{color:e.palette.black,marginTop:"8px",wordWrap:"normal",textOverflow:"ellipsis"}]}}),Pr("Footnote",{text:function(e){return[Ur(e)]}})),Vr=(Pr("Header",{text:function(e){return[_r(e)]}}),Pr("DescriptionNeutral",{text:function(e){return[Rr(e)]}}),Pr("DescriptionAccented",{text:function(e){return[Br(e),{color:e.palette.themePrimary}]}}),Pr("Subtitle",{text:function(e){return[Ur(e),{selectors:{a:Lr(e)}}]}})),Kr=(Pr("LinkContent",{text:function(e){return[Hr(e)]}}),"Arial, Helvetica, sans-serif"),Yr="'SF UI Text', HelveticaNeue, Roboto, Arial, sans-serif";var Qr=function(){return(Qr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Gr=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},$r=Yr,Jr=12,Zr=Kr,Xr=11,ei=function(e){var t=[{display:"block",maxWidth:"50%",whiteSpace:"nowrap"}];return{attribution:Gr(["ms-search-attribution",Jt],t),attributionFileType:["ms-search-attribution",t],attributionSource:[Lr(e)],scopeAttributionWrapper:{selectors:{" > span":{maxWidth:"50%"}}},dotSplitter:{marginLeft:"4px",marginRight:"4px"}}},ti=Object(Ve.b)(function(e,t){return Object(qe.t)(t?function(e){var t=["ms-search-attribution",{display:"block",color:e.palette.neutralPrimary,fontFamily:$r,fontSize:Jr+"px",lineHeight:"16px",whiteSpace:"nowrap",selectors:{a:Lr(e)}}];return Qr(Qr({},ei(e)),{attribution:[Jt,t],attributionFileType:["ms-search-attribution",t],scopeAttributionWrapper:{selectors:{" > span":{marginBottom:0}}}})}(e):ei(e))}),ni=function(e){var t=e.id,n=e.source,r=e.sourceType,i=e.sourceId,o=e.url,l=e.tenantName,c=e.onLinkClick,u=e.isSmall,d=e.disableClickThrough,m=e.className,p=e.fromSourceElement,f=e.openLink,h=qr(),g=Vr(),v=ve("AcronymAttribution"),b=v[0],y=v[1],O=Ne(),x=ti(O,u),S=x.attribution,C=x.attributionFileType,j=x.attributionSource,k=x.scopeAttributionWrapper,E=x.dotSplitter,w=function(e,t,n){if(!e)return;return"Email"===e&&n?function(e){return"https://outlook.office365.com/mail/deeplink/read/"+encodeURIComponent(e)}(Te(n)):t}(r,o,i),T=Object(L.a)(n),I=Je(m,k);switch(r){case"Editorial":case"Annotation":if(!l)return null;var A=a.createElement(a.Fragment,null,l,w&&a.createElement(a.Fragment,null,a.createElement(Ar,{className:E,isLarge:!0}),ii(w,t,Object(yr.n)(),j,c,d)));return ri(oi(u,S,h.text),A,l,yr.k,p);case"Email":if(!w)return null;var N=ii(w,t,P=T?Object(yr.g)():Object(yr.h)({subject:n}),j,c,d,f);return ri(oi(u,S,g.text),N,P,yr.i,void 0,I);case"FileItem":case"File":if(!w)return null;var P,F=function(e){return e?{fontFamily:$r,fontSize:Jr}:{fontFamily:Zr,fontSize:Xr}}(u),D=function(e,t){var n=kr();return n?(n.font=Tr(t),n.measureText(e).width):0}(Object(yr.j)({source:""}),F),H=wr(n,y.offsetWidth-D,F,Be());N=ii(w,t,P=T?w:H.text,j,c,d,f);return ri(oi(u,T?S:C,g.text),N,P,yr.j,void 0,I,b,n);default:return Object(s.a)(r)}};function ri(e,t,n,r,i,o,l,c){var s=r({source:"|"}),u=Object(Oe.a)(s,"|");return a.createElement("span",{className:o},a.createElement("span",{className:e,ref:l,title:c||n},i||a.createElement(a.Fragment,null,u[0],t,u[1])))}function ii(e,t,n,r,i,o,c){return o?a.createElement("span",{className:r},n):a.createElement(l,{onClick:function(n){n.stopPropagation(),c?c(e):window.open(e,"_blank"),ai(t,i)},onKeyPress:function(n){n.stopPropagation(),c?c(e):window.open(e,"_blank"),ai(t,i)}},n)}function ai(e,t){t&&t(e)}function oi(e,t,n){return e?t:Je(t,n)}var li=Object(ye.a)(function(e){return Object(qe.t)({icon:{fontSize:11,verticalAlign:"middle",cursor:"pointer",color:e.palette.neutralPrimary},link:{marginLeft:"4px"}})}),ci="https://support.microsoft.com/en-us/office/find-acronym-definitions-89062352-e1ce-4f59-b58c-f94869521404",si=function(e){var t=Ne(),n=li(t),r=e.onPrivacyIconClick,i=e.openLink,o=function(e){null==e||e.preventDefault(),i?i(ci):window.open(ci,"_blank"),null==r||r()};return a.createElement("a",{href:ci,className:n.link,target:"_blank",tabIndex:0,onClick:function(e){return null==o?void 0:o(e)},onKeyPress:function(e){return we(e,o)},"aria-label":Object(yr.l)()},a.createElement(Mt.a,{iconName:"Info",className:n.icon}))};function ui(e){return!!e.sourceType&&!!e.expanded}function di(e,t,n,r,i){var a=Object(V.a)(null==e?void 0:e.filter(ui),function(e){return function(e,t,n,r){var i=e.id,a=e.shortened,o=e.expanded,l=e.snippet,c=e.source,s=e.url,u=e.sourceId,d=e.sourceType,m=e.sourceShardType,p=e.descriptionText,f=l&&l.json,h=t&&r?r(o,"None"):n?"https://www.bing.com/work/?q="+o+"&FORM=BFBACR":void 0;return{id:i,mappingId:Object(Y.c)(e),abbreviation:a,expansion:o,description:f,descriptionPlainText:f?Mn(f):p,source:c,url:s,sourceId:u,sourceType:d,sourceShardType:m,requeryUrl:h}}(e,n,r,i)});return e.length&&!a.length&&Object(w.e)(t,"Acronym answer dropped due to missing required fields"),a}var mi=n(181),pi=function(){return(pi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},fi="Hero";function hi(){var e,t,n,r,i=Object(u.useSelector)(mi.c),o=Object(c.b)(),l=b(),s=(t=Object(u.useSelector)(Kn.a),n=null===(e=nr())||void 0===e?void 0:e.userOrganization,r=Object(u.useSelector)(Xn),rr()?(null==n?void 0:n.displayName)||r:t),d=Object(c.a)(),m=null==d?void 0:d.getCurrentClientSize,p=null==d?void 0:d.setAnswerHeight,f=Object(c.h)().additionalAnswerConfigs,h=null==f?void 0:f.answerBlockId,g=null==f?void 0:f.enableDwellStartLogging,v=An({entities:i,domain:"Acronym",isHero:!0,cardType:fi,impressionEventId:"Hero_Acronym_Impression",clickEventId:"Acronym_Source_Click",expandClickEventId:"Acronym_Expand_Click",isFromMainSearch:!0,groupReferenceId:h,traceId:l});a.useEffect(function(){var e;i&&!Object(L.a)(i)&&(null===(e=null==d?void 0:d.setAnswerBlockRendered)||void 0===e||e.call(d,v.placeholderId))},[]);return{acronyms:i,clientSize:o,clientLogger:v,tenantName:s,onDisplayStarted:function(e){g&&v.entityActions.onActionClick(e,"Display_Started")},onAcronymCarouselClick:function(e,t){v.nonEntityActions.onSearchActionClick(e,{pageNumber:t})},onAcronymEntityClick:function(e,t){v.entityActions.onActionClickId(e,"Acronym_Expand_Description_Click",{isExpanded:t})},onPrivacyIconClick:function(){v.nonEntityActions.onSearchActionClick("Acronym_PrivacyIcon_Click")},onAcronymAttributionClick:function(e,t,n,r){v.entityActions.onEntityClickId(e,pi(pi({},function(e){if(e)switch(e){case"File":case"FileItem":return{RelatedEntityType:"FileSource"};case"Email":return{RelatedEntityType:"EmailSource"};case"Annotation":case"Editorial":default:return}}(r)),{interpretation:n}))},getClientSizeCallback:m,onAcronymListExpandClick:function(e){v.nonEntityActions.onExpandClick(e,{pageNumber:"1"})},setAnswerHeight:p}}var gi=n(510),vi=(Object(De.declareString)("search-components-carousel.search.carousel.nextPage")),bi=(Object(De.declareString)("search-components-carousel.search.carousel.previousPage")),yi=(Object(De.declareStringWithPlaceholders)("search-components-carousel.search.carousel.pageNumber")),Oi=(Object(De.declareStringWithPlaceholders)("search-components-carousel.search.carousel.pageNumberSelected")),xi=(Object(qe.s)({"0%":{opacity:.6},"50%":{opacity:1},"100%":{opacity:.6}}),Object(qe.s)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),function(e,t){return{visibility:"visible",opacity:1,transition:"opacity "+e+"ms",transitionTimingFunction:t}}),Si=function(e,t){return{visibility:"hidden",opacity:0,transition:"visibility 0s linear "+e+"ms, opacity "+e+"ms",transitionTimingFunction:t}},Ci=Object(ye.a)(function(e,t,n,r,i){var a=e.palette.neutralSecondary;return Object(qe.t)({nextIconContainer:{width:"30px",fontSize:"14px",height:"24px",marginTop:"8px",float:"left",display:"flex"},carouselContainer:{position:"relative"},nextIcon:{display:n?"none":void 0,alignSelf:"center",color:a,marginLeft:"-4px",selectors:{":hover":{color:a}}},previousIconContainer:{width:"30px",fontSize:"14px",height:"24px",marginTop:"8px",float:"left",display:"flex"},previousIcon:{display:t?"none":void 0,alignSelf:"center",color:a,marginLeft:"4px",selectors:{":hover":{color:a}}},pageBar:{width:"calc(100% - 62px)",height:"24px",float:"left",display:"flex",justifyContent:"center",marginTop:"8px",alignItems:"center"},footer:{height:"40px"},body:[xi(r,i),{width:"100%"}],hidden:[Si(r,i),{position:"absolute",top:"0",width:"100%"}]})}),ji=Object(ye.a)(function(e,t){var n=e.palette.neutralSecondary;return Object(qe.t)({dot:{height:"7px",width:"7px",marginRight:"8px",border:"1px solid "+n,background:t?n:"",opacity:t?"100%":"40%",borderRadius:"50%",display:"inline-block",selectors:{":hover":{opacity:t?"100%":"65%",cursor:t?"auto":"pointer"}}}})}),ki=function(e){var t=e.pages,n=e.onNextButtonClick,r=e.onPreviousButtonClick,i=e.onDotButtonClick,o=Ne(),l=a.useState(0),c=l[0],s=l[1],u=t.length,d=Ci(o,0===c,c===u-1,500,"cubic-bezier(0.3,0.55,0.1,1.0)"),m=d.nextIconContainer,p=d.previousIconContainer,f=d.pageBar,h=d.footer,g=d.body,v=d.hidden,b=d.nextIcon,y=d.previousIcon,O=d.carouselContainer,x=a.useRef(null);function S(e){var t;s(e),i&&i(e),null===(t=x.current)||void 0===t||t.focus()}return a.createElement("div",{className:O,tabIndex:-1,ref:x},t.map(function(e,t){return t===c?a.createElement("div",{key:"page"+t,className:g,tabIndex:-1},e):a.createElement("div",{key:"page"+t,className:v},e)}),a.createElement("div",{className:h},a.createElement("div",{className:p},a.createElement(Fe.a,{iconProps:{iconName:"ChevronLeftMed"},title:bi(),"aria-label":bi(),onClick:function(){var e;s(c-1),r&&r(c-1),null===(e=x.current)||void 0===e||e.focus()},className:y})),a.createElement("div",{className:f},Object(gi.a)(t.length,function(e){var t=ji(o,e===c).dot,n=e===c?-1:0,r=e!==c?yi({index:(e+1).toString()}):void 0,i=e!==c?yi({index:(e+1).toString()}):Oi({index:(e+1).toString()});return a.createElement("span",{className:t,key:"dot"+e,onClick:function(){return S(e)},tabIndex:n,onKeyPress:function(){return S(e)},title:r,"aria-label":i,role:"button"})})),a.createElement("div",{className:m},a.createElement(Fe.a,{iconProps:{iconName:"ChevronRightMed"},title:vi(),"aria-label":vi(),onClick:function(){var e;s(c+1),n&&n(c+1),null===(e=x.current)||void 0===e||e.focus()},className:b}))))},Ei=Object(ye.a)(function(e){var t=e.palette.neutralLight;return Object(qe.t)({pageContainer:{minHeight:"182px",borderBottom:"1px solid",borderColor:t}})}),wi=3,Ti=function(){return(Ti=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ii=function(e){var t,n=e.numberOfResults,r=e.acronymViews,i=e.acronyms,o=e.displayStartedStatus,l=e.updateDisplayStatus,c=e.setactivePage,s=e.onDisplayStarted,u=e.onAcronymCarouselClick,d=[],m=Ne(),p=Ei(m).pageContainer;function f(e){for(var t=(e-1)*wi,r=Math.min(e*wi,n)-1,a=t;a<=r;a++)!o[a]&&(null==s||s(i[a]));l(t,r)}function h(e,t){c(e),f(e+1),u&&u(t,(e+1).toString())}for(a.useEffect(function(){f(1)},[]),t=0;t<n/wi;t++){var g=r.slice(t*wi,Math.min((t+1)*wi,n)),v=a.createElement("div",{className:p},g);d.push(v)}var b={pages:d,onNextButtonClick:function(e){return h(e,"Acronym_Carousel_Next_Click")},onPreviousButtonClick:function(e){return h(e,"Acronym_Carousel_Previous_Click")},onDotButtonClick:function(e){return h(e,"Acronym_Carousel_Page_Click")}};return a.createElement(ki,Ti({},b))},Ai=Object(ye.a)(function(e,t,n,r,i,a){var o,l=e.palette,c=l.neutralPrimary,s=l.neutralDark,u=l.neutralSecondary,d=l.neutralLight,m=l.neutralLighterAlt,p=l.themeLighterAlt;return Object(qe.t)({singleAcronymContainer:{cursor:a&&!i?"pointer":"auto",borderBottom:n?"none":"1px solid",borderColor:d,padding:"8px 0 12px 0",display:r?"block":"flex",backgroundColor:t&&!i?p:void 0,selectors:!a||i||t?{}:{":hover":{backgroundColor:m}}},singleAcronym:{margin:"0 12px 0 12px",width:"calc(100% - 24px)"},detailsContainer:{display:r?"block":"flex",width:r?"100%":"calc(100% - 376px)",float:r?"none":"left",flexDirection:t&&!r?"column":void 0},expansionContainer:[!t&&Jt,{fontWeight:"600",fontSize:14,lineHeight:"20px",color:c,height:"20px",width:r?"100%":"288px",float:r?"none":"left",marginRight:r?"0":"24px"}],expansionText:[Jt,"ms-search-acronymTile-expansionText"],expandContainer:{height:"20px",maxWidth:r||!a||t?"100%":"50%"},iconContainer:{width:"10px",height:r?"10px":"20px",float:"left",transform:t?"rotate(90deg)":void 0,transitionDuration:"200ms",fontSize:"9px",marginRight:"8px",marginTop:r?"5px":"0",display:i?"none":void 0},sourceContainer:[Jt,{fontSize:"14px",lineHeight:"20px"},{color:s,height:"100%",width:r&&a?"calc(100% - 20px)":"100%",float:"left",alignItems:"center",selectors:(o={"& .ms-search-text-s":[{fontSize:"14px",lineHeight:"20px"},{maxWidth:"100%"}]},o["& .ms-search-attribution"]=[Jt,{marginTop:r?"2px":"0",selectors:{a:{color:s}}}],o)}],descriptionContainer:[!t&&Jt,{fontSize:"14px",lineHeight:"20px"},{color:u,display:!r||t?"block":"none",marginLeft:r||t?"0":"17px",height:t?"auto":"20px"}]})}),Ni=function(e){var t=e.acronym,n=e.isSmall,r=e.isLast,i=e.isSingleAcronym,o=e.activePage,l=e.tenantName,c=e.index,s=e.openLink,u=e.onAcronymEntityClick,d=e.onAcronymAttributionClick,m=t.expansion,p=t.source,f=t.descriptionPlainText,h=t.sourceType,g=t.id,v=t.url,b=t.sourceId,y=t.sourceShardType,O=a.useState(i),x=O[0],S=O[1],C=a.useState(!1),j=C[0],k=C[1],E=function(e,t){return t&&function(e){switch(e){case"User":case"PublicModernGroup":case"EditorialImport":case"Unknown":return!0;default:return!1}}(t)?"Source: "+e+"  Shard: "+t:e}(h,y);a.useEffect(function(){!i&&S(!1)},[o]);var w=Ne(),T=!!f&&("Editorial"===h||"Annotation"===h),I=f;f&&f.length>450&&(I=f.slice(0,450)+"...");var A=Ai(w,x,r,n,i,T),N=A.expansionContainer,P=A.descriptionContainer,F=A.singleAcronymContainer,D=A.sourceContainer,L=A.expandContainer,H=A.iconContainer,B=A.detailsContainer,R=A.singleAcronym,M=A.expansionText,z=a.useRef(null);function _(){var e;if(!i&&T){var t=!x;S(t),null===(e=z.current)||void 0===e||e.focus(),u&&u(g,t)}}var W=("Editorial"===h||"Annotation"===h)&&l||("File"===h||"Email"===h)&&(p||v);return a.createElement("div",{className:F,onClick:_,tabIndex:0,ref:z,onKeyPress:_,role:T?"button":"presentation","aria-label":"Editorial"===h||"Annotation"===h?x&&f?Object(yr.a)({description:f}):l?Object(yr.b)({expansion:m,tenantName:l}):"":""},a.createElement("div",{className:R},a.createElement("div",{className:N},T&&!n&&a.createElement("div",{className:H},a.createElement(Mt.a,{iconName:"ChevronRightMed"})),a.createElement("div",{title:j?m:void 0,onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;k(n!==r)}(e)},role:"presentation",className:M},m)),a.createElement("div",{className:B},W&&h&&a.createElement("div",{className:L},T&&n&&a.createElement("div",{className:H},a.createElement(Mt.a,{iconName:"ChevronRightMed"})),a.createElement("div",{className:D},a.createElement(ni,{id:g,source:p,url:v,sourceType:h,sourceId:b,tenantName:l,isSmall:n,onLinkClick:function(e){d&&d(e,c,E,h)},openLink:s}))),T&&a.createElement("div",{title:f,className:P},I))))};Ni.displayName="AcronymEntity";var Pi={background:"none",padding:0,border:0},Fi=function(e,t,n){return{fontSize:e,width:t||e,height:n||e}},Di=(Fi("6px"),Fi("8px"),Fi("12px")),Li=(Fi("14px"),Fi("16px"),Fi("20px"),Fi("24px"),Fi("25px"),Fi("28px")),Hi=(Fi("32px"),Fi("40px"),Object(ye.a)(function(e){var t=e.palette,n=t.neutralLight,r=t.neutralDark;return Object(qe.t)({pageContainer:{borderBottom:"1px solid",borderColor:n},expandLinkContainer:{height:"36px",display:"flex",margin:"0 12px 4px 12px",alignItems:"center"},expandLink:{cursor:"pointer"},button:[Hr(e),Pi,{color:r}],icon:[Di,{lineHeight:"100%",verticalAlign:"middle",margin:"3px 0 0 8px",color:r}]})})),Bi=function(e){var t=e.isCardExpanded,n=e.acronymViews,r=e.maxResultsOnCollapsed,i=e.acronyms,o=e.displayStartedStatus,l=e.updateDisplayStatus,c=e.onDisplayStarted,s=e.onExpandLinkClick,u=t?n:n.slice(0,r),d=Ne(),m=Hi(d),p=m.pageContainer,f=m.expandLinkContainer,h=m.button,g=m.icon,v=m.expandLink,b=t?He():Le(),y=t?"ChevronUpMed":"ChevronDownMed";function O(){s(),function(){for(var e=r;e<n.length;e++)!o[e]&&(null==c||c(i[e]));l(r,n.length-1)}()}return a.useEffect(function(){!function(){for(var e=Math.min(n.length,r)-1,t=0;t<=e;t++)!o[t]&&(null==c||c(i[t]));l(0,e)}()},[]),a.createElement(a.Fragment,null,a.createElement("div",{className:p},u),a.createElement("div",{className:f},a.createElement("div",{className:v,onClick:O,onKeyPress:O,tabIndex:0,role:"button"},a.createElement("button",{className:h},a.createElement("span",null,b)),a.createElement(Mt.a,{iconName:y,className:g}))))},Ri=n(245);var Mi=Object(ye.a)(function(e){var t,n=e.palette.neutralSecondary;return Object(qe.t)({header:["ms-search-acronymTile-header",{color:n,fontWeight:"600",margin:"0 12px",fontSize:14}],tileBodyOverride:["ms-search-tile-body"],tileHeaderOverride:["ms-search-tile-header"],tile:{selectors:(t={},t["& .ms-search-tile-header"]={margin:"0"},t["& .ms-search-tile-body"]={margin:"0",padding:"1px 0 0 0"},t["& .ms-search-heroTile-dismissButton"]={marginRight:"12px"},t)}})}),zi=function(){return(zi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},_i=function(e){var t,n=e.acronyms,r=e.tenantName,i=e.clientSize,o=e.isExpanded,l=e.className,c=e.isDismissible,s=e.onAcronymListExpandClick,u=e.onAcronymCarouselClick,d=e.onAcronymEntityClick,m=e.getClientSizeCallback,p=e.onAcronymAttributionClick,f=e.setAnswerHeight,h=e.openLink,g=e.onDisplayStarted,v=e.onDismiss,b=e.onPrivacyIconClick,y=be("HeroAcronymTile",752,i,m),O=y[0],x=y[1],S=null===(t=O.current)||void 0===t?void 0:t.offsetHeight,C=a.useState(new Array(n.length).fill(!1)),j=C[0],k=C[1];function E(e,t){k(j.map(function(n,r){return r>=e&&r<=t||n}))}a.useEffect(function(){S&&f&&f(S)},[S]);var w=Ne(),T=a.useState(0),I=T[0],A=T[1],N=a.useState(!!o),P=N[0],F=N[1],D=function(e,t){return Object(Ri.a)(e,t)}(n,9),L="Small"===x,H=Object(U.a)(D).abbreviation,B=D.length,R=Mi(w),M=R.header,z=R.tileBodyOverride,_=R.tileHeaderOverride,W=R.tile;function q(){var e=!P;F(e),s&&s(e)}var V=1===B,K=D.map(function(e,t){var n=function(e,t,n,r,i){return e||!t?n===r-1||n%i==i-1:n===r-1}(L,P,t,B,wi),i={acronym:e,isSmall:L,tenantName:r,isLast:n,isSingleAcronym:V,activePage:I,index:t,openLink:h,onAcronymEntityClick:d,onAcronymAttributionClick:p};return a.createElement(Ni,zi({key:"acronym"+t},i))}),Y={header:a.createElement("div",{className:M},Object(yr.c)({abbreviation:H}),a.createElement(si,{onPrivacyIconClick:b,openLink:h})),body:function(){if(L){if(B>wi){var e={numberOfResults:B,acronymViews:K,acronyms:n,displayStartedStatus:j,onDisplayStarted:g,setactivePage:A,updateDisplayStatus:E,onAcronymCarouselClick:u};return a.createElement(Ii,zi({},e))}return a.createElement("div",null,K)}if(B<=wi)return a.createElement("div",null,K);var t={isCardExpanded:P,acronymViews:K,acronyms:n,displayStartedStatus:j,maxResultsOnCollapsed:wi,onDisplayStarted:g,updateDisplayStatus:E,onExpandLinkClick:q};return a.createElement(Bi,zi({},t))}(),styleOverrides:function(){return{bodyStyles:z,headerStyles:_,cardStyles:W}},className:l,isDismissible:c,onDismiss:v};return a.createElement("div",{ref:O},a.createElement(et,zi({},Y)))};_i.displayName="HeroAcronymTile";var Wi=function(){return(Wi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ui=function(e){var t=e.className,n=hi(),r=n.acronyms,i=n.tenantName,o=n.onDisplayStarted,l=n.onAcronymListExpandClick,s=n.onAcronymEntityClick,u=n.onPrivacyIconClick,d=n.onAcronymAttributionClick,m=n.getClientSizeCallback,p=n.setAnswerHeight,f=n.onAcronymCarouselClick,h=Object(c.b)(),g=Object(E.a)(),v=Object(c.a)(),b=null==v?void 0:v.openLink;if(!r||Object(L.a)(r))return Object(w.h)(g,"Unexpected Empty response received for Acronym"),null;var y={clientSize:h,tenantName:i,acronyms:di(r,g),onAcronymListExpandClick:l,onAcronymCarouselClick:f,onAcronymEntityClick:s,getClientSizeCallback:m,onAcronymAttributionClick:d,setAnswerHeight:p,openLink:b,onDisplayStarted:o,className:t,onPrivacyIconClick:u};return a.createElement(_i,Wi({},y))};function qi(e){if(e&&e.audience)return{token:e.token,audience:e.audience}}var Vi=n(239),Ki="Hero";var Yi=n(189),Qi=n(231),Gi=Object(ye.a)(function(e){var t=e.palette,n=t.themeLight,r=t.neutralSecondary,i=t.neutralPrimary,a=t.neutralTertiary;return Object(qe.t)({headerContent:["ms-search-bookmarkTile-headerContent",{overflow:"hidden",fontSize:"14px",lineHeight:"20px",verticalAlign:"middle",display:"flex"}],headerIcon:{width:"20px",height:"20px",float:"left",textAlign:"center",borderRadius:"50%",background:n},answerTitle:[{float:"left",marginLeft:"8px",fontWeight:"600",color:r},Jt],title:["ms-search-bookmarkTile-title",{color:i,fontSize:"17px",fontWeight:"600"},Jt],description:["ms-search-bookmarkTile-description",{maxWidth:"100%",maxHeight:"40px",margin:"0 auto",fontSize:"14px",lineHeight:"20px",color:r},Jt],url:[{color:Qi.a,fontSize:"12px",height:"20px",lineHeight:"20px"},Jt],content:{overflow:"hidden",paddingBottom:"8px"},bodyIcon:[Li,{color:a,paddingRight:"12px",paddingTop:"4px",float:"left"}]})}),$i=function(){return($i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ji=function(e){var t,n=e.heroBookmark,r=e.onHeroBookmarkClick,i=e.clientSize,o=e.setAnswerHeight,l=e.className,c=e.isFlushLayout,s=e.isDismissible,u=e.onDismiss,d=Ne(),m=Gi(d),p=m.headerContent,f=m.headerIcon,h=m.answerTitle,g=m.title,v=m.description,b=m.url,y=m.content,O=m.bodyIcon,x=be("HeroBookmarkTile",752,i),S=x[0],C=x[1],j=null===(t=S.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){j&&o&&o(j)},[j]);var k="Small"===C,E={body:a.createElement(a.Fragment,null,a.createElement(Mt.a,{iconName:Ce.b,className:O}),a.createElement("div",{className:y},a.createElement("div",{className:g,title:n.title},n.title),a.createElement("div",{className:b,title:n.url},n.url),a.createElement("div",{className:v,title:n.description},n.description))),header:a.createElement("div",{className:p},a.createElement(Mt.a,{className:f,iconName:"Link12"}),a.createElement("div",{className:h,title:Object(Yi.c)(),role:"heading","aria-level":3},Object(Yi.c)())),isSmall:k,cardClickProps:{onCardClick:function(){r&&r(n.url)},clickRole:"link"},className:l,isDismissible:s,isFlushLayout:c,onDismiss:u};return a.createElement("div",{ref:S},a.createElement(et,$i({},E)))};Ji.displayName="HeroBookmarkTile";var Zi=function(){return(Zi=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Xi=function(e){var t=e.className,n=function(){var e=Object(u.useSelector)(Vi.c),t=Object(c.b)(),n=Object(u.useSelector)(h.k),r=Object(c.a)(),i=null==r?void 0:r.setAnswerHeight,o=null==r?void 0:r.openLink,l=Object(c.h)().additionalAnswerConfigs,s=null==l?void 0:l.answerBlockId,d=null==l?void 0:l.enableDwellStartLogging,m=An({domain:"Bookmark",entities:e?[e]:void 0,impressionEventId:"Hero_Bookmark_Impression",clickEventId:"Bookmark_Click",cardType:Ki,isHero:!0,groupReferenceId:s,traceId:n});return a.useEffect(function(){var t;e&&(null===(t=null==r?void 0:r.setAnswerBlockRendered)||void 0===t||t.call(r,m.placeholderId),d&&m.entityActions.onActionClick(e,"Display_Started"))},[]),{heroBookmark:e,clientSize:t,clientLogger:m,setAnswerHeight:i,onHeroBookmarkClick:function(t){o?o(t):window.open(t,"_blank"),e&&m.entityActions.onEntityClick(e,0,{EntityClickDetails:o?"OpenInViewer":void 0},"Bookmark_Click")}}}(),r=n.heroBookmark,i=n.clientSize,o=n.setAnswerHeight,l=n.onHeroBookmarkClick,s=Object(E.a)(),d=Object(c.h)().additionalAnswerConfigs,m=null==d?void 0:d.enableBookmarkAnswerV2;if(!r)return Object(w.h)(s,"Unexpected Empty response received for Bookmark"),null;var p,f,g,v,b,y,O,x,S,C,j,k={className:t,heroBookmark:(v=(p=r).id,b=p.displayTitle,y=p.snippet,O=p.url,x=p.displayIconInfo,S=p.powerApp,C=p.powerBiApp,j=y&&(y.raw||y.json&&y.json[0]&&y.json[0].text)||"",{id:v,mappingId:Object(Y.c)(p),title:b,description:j,url:O,displayIconInfo:x,powerApp:S,powerAppToken:qi(f),powerBiApp:C,powerBiToken:qi(g)}),clientSize:i,isFlushLayout:m,onHeroBookmarkClick:l,setAnswerHeight:o};return a.createElement(Ji,Zi({},k))},ea=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeStringWithoutDotSeparator")),ta=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingStartAndEndTime"));var na,ra,ia,aa,oa=(Object(De.declareString)("search-components-calendar.search.calendar.onlineMeeting")),la=(Object(De.declareString)("search-components-calendar.search.calendar.eventsHeading")),ca=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.dateTimeStringForDifferentStartAndEndWeekDays")),sa=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.calendarTileConnectionString")),ua=(Object(De.declareString)("search-components-calendar.search.calendar.joinTeamsMeetingButtonAriaLabel")),da=(Object(De.declareString)("search-components-calendar.search.calendar.editMeetingButtonAriaLabel")),ma=(Object(De.declareString)("search-components-calendar.search.calendar.join"));!function(e){e.OutOfRoutine="OutOfRoutine",e.Quorum="Quorum",e.Conflicts="Conflicts"}(na||(na={})),function(e){e.FileAttachment="FileAttachment",e.RelatedEmail="RelatedEmail",e.RelatedFile="RelatedFile"}(ra||(ra={})),function(e){e.ClassicAttachment="ClassicAttachment",e.ReferenceAttachment="ReferenceAttachment"}(ia||(ia={})),function(e){e.Implicit="Implicit",e.Explicit="Explicit"}(aa||(aa={}));var pa=10;Object(ye.a)(function(e,t){var n=(new Date).getTime()/1e3,r=n+86400,i=Object(H.a)(e,function(e){return e.meetingStart>=n&&e.meetingStart<r});return Object(V.a)(t?i:e,function(e){var t,n=e.meetingSubject,r=e.meetingStart,i=e.meetingEnd,a=e.meetingLocation,o=e.id;return{subject:n,start:Object(lt.b)(r),end:Object(lt.b)(i),location:a,url:(t=o,"https://outlook.office.com/calendar/deeplink/read/"+(t=encodeURIComponent(t)))}})});function fa(e,t){return void 0===t&&(t=pa),Object(Ri.a)(e,t)}function ha(e,t,n){var r=(new Date).getTime()/1e3;return n?"Canceled":r+15*at.h/at.u<e?"Pre":r>t?"Post":"During"}function ga(e){var t=Object(rt.b)();return[t.january,t.february,t.march,t.april,t.may,t.june,t.july,t.august,t.september,t.october,t.november,t.december][Object(lt.b)(e).getMonth()]}var va=n(263),ba=(Object(De.declareString)("search-components-calendar.search.calendar.edit")),ya=(Object(De.declareString)("search-components-calendar.search.calendar.reply")),Oa=(Object(De.declareString)("search-components-calendar.search.calendar.replyAll")),xa=(Object(De.declareString)("search-components-calendar.search.calendar.forward")),Sa=(Object(De.declareString)("search-components-calendar.search.calendar.scheduleNextMeeting")),Ca=(Object(De.declareString)("search-components-calendar.search.calendar.rsvp")),ja=(Object(De.declareString)("search-components-calendar.search.calendar.yes")),ka=(Object(De.declareString)("search-components-calendar.search.calendar.no")),Ea=(Object(De.declareString)("search-components-calendar.search.calendar.maybe")),wa=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.duringOthersEvent")),Ta=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventStartingSoon")),Ia=(Object(De.declareString)("search-components-calendar.search.calendar.duringYourEvent")),Aa=(Object(De.declareString)("search-components-calendar.search.calendar.eventStartingSoon")),Na=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersPastEvent")),Pa=(Object(De.declareString)("search-components-calendar.search.calendar.yourPastEvent")),Fa=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersCanceledEvent")),Da=(Object(De.declareString)("search-components-calendar.search.calendar.yourCanceledEvent")),La=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.yourEventInMinutes")),Ha=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventInMinutes")),Ba=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.yourEventInDays")),Ra=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventInDays")),Ma=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventToday")),za=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventToday")),_a=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventTomorrow")),Wa=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventTomorrow")),Ua=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventNextWeek")),qa=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventNextWeek")),Va=(Object(De.declareString)("search-components-calendar.search.calendar.yourEventLaterThisMonth")),Ka=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersEventLaterThisMonth")),Ya=(Object(De.declareString)("search-components-calendar.search.calendar.yourUpcomingEvent")),Qa=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.othersUpcomingEvent")),Ga=(Object(De.declareString)("search-components-calendar.search.calendar.happeningNow")),$a=(Object(De.declareString)("search-components-calendar.search.calendar.startingSoon")),Ja=(Object(De.declareString)("search-components-calendar.search.calendar.numberOfConflicts")),Za=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.calendarEventListItemAriaLabel")),Xa=(Object(De.declareString)("search-components-calendar.search.calendar.recurring")),eo=(Object(De.declareString)("search-components-calendar.search.calendar.hasAttachments")),to=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.meetingLocationWithLabel")),no=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.conflictNameString")),ro=(Object(De.declareString)("search-components-calendar.search.calendar.noConflictsString")),io=(Object(De.declareString)("search-components-calendar.search.calendar.outOfRoutine")),ao=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.acceptedAttendeeCountString")),oo=(Object(De.declareString)("search-components-calendar.search.calendar.acceptedAttendeeNoResponse")),lo=(Object(De.declareStringWithPlaceholders)("search-components-calendar.search.calendar.additionConflictNumberString")),co=(Object(De.declareString)("search-components-calendar.search.calendar.preReadsTitle")),so=(Object(De.declareString)("search-components-calendar.search.calendar.relatedContentSuggestion")),uo=(Object(De.declareString)("search-components-calendar.search.calendar.editRsvpButtonLabel")),mo=(Object(De.declareString)("search-components-calendar.search.calendar.noMeetingSubject"));function po(e){var t=Object(rt.b)();return[t.sundayShort,t.mondayShort,t.tuesdayShort,t.wednesdayShort,t.thursdayShort,t.fridayShort,t.saturdayShort][Object(lt.b)(e).getDay()]}function fo(e,t,n,r){var i,a,o=new Date,l=o.getTime()/1e3,c=Object(lt.b)(e),s=e-l,u=(a=o,(i=c).setHours(0,0,0,0),a.setHours(0,0,0,0),(i.getTime()-a.getTime())/at.c),d=o.getDay()||7;if(s<at.e/at.u){var m=s*at.u/at.h;return t?La({minutes:Math.ceil(m).toString()}):Ha({name:n,minutes:Math.ceil(m).toString()})}return r===o.getDate()?t?Ma():za({name:n}):Object(lt.p)(o,c)?t?_a():Wa({name:n}):u<=at.w/at.c?t?Ba({days:Math.ceil(u).toString()}):Ra({name:n,days:Math.ceil(u).toString()}):u<=2*at.w/at.c-d?t?Ua():qa({name:n}):c.getMonth()===o.getMonth()?t?Va():Ka({name:n}):t?Ya():Qa({name:n})}function ho(e,t,n){return{key:"no",text:ka(),iconProps:{iconName:va.f},onClick:function(){n(e,"Decline").then(function(e){e&&t("Declined")})}}}function go(e,t,n){return{key:"maybe",text:Ea(),iconProps:{iconName:va.h},onClick:function(){n(e,"Tentative").then(function(e){e&&t("TentativelyAccepted")})}}}function vo(e,t,n){return{key:"yes",text:ja(),iconProps:{iconName:va.d},onClick:function(){n(e,"Accept").then(function(e){e&&t("Accepted")})}}}function bo(e,t,n,r){var i=[];switch(t){case"Accepted":i.push(ho(e,n,r)),i.push(go(e,n,r));break;case"Declined":i.push(vo(e,n,r)),i.push(go(e,n,r));break;case"TentativelyAccepted":i.push(vo(e,n,r)),i.push(ho(e,n,r));break;case"None":case"NotResponded":case"Organizer":i.push(vo(e,n,r)),i.push(ho(e,n,r)),i.push(go(e,n,r));break;default:return Object(s.a)(t)}return{items:i}}function yo(e){switch(e){case"Accepted":return ja();case"TentativelyAccepted":return Ea();case"Declined":return ka();case"NotResponded":case"None":case"Organizer":return Ca();default:return Object(s.a)(e)}}function Oo(e){return e>2}function xo(e){return Object(tn.a)(Ja().replace(va.a,String(e)),e)}function So(e,t){return Object(L.a)(e)?t?oa():"":e}var Co=function(e,t){var n,r=e.meetingStart,i=e.meetingEnd,a=e.isCanceled,o=e.insights,l=null===(n=Object(H.a)(o,function(e){return e.Type===na.Conflicts})[0])||void 0===n?void 0:n.Source,c=ha(r,i,!!a),s=(new Date).getTime()/1e3,u=l&&!l.ConflictFetchFailed?l.ConflictingEvents.length:0;return{meetingInfoString:"During"===c?s<r?$a():Ga():t&&0===u?"":xo(u),eventScenario:c}},jo=function(e){return Object(L.a)(e.seriesMasterId)?"":Xa()},ko=function(e){return e.hasAttachments?eo():""};function Eo(e,t,n){var r,i,a,o=e.insights;if(o){var l=null===(r=Object(H.a)(o,function(e){return e.Type===na.Conflicts})[0])||void 0===r?void 0:r.Source;if(l&&!l.ConflictFetchFailed&&!Object(L.a)(l.ConflictingEvents)){var c=e.id,s=e.hexItemId,u=e.joinOnlineMeetingUrl,d=e.meetingEnd,m=e.meetingStart,p={itemId:c,hexItemId:s,itemIndex:n,onlineMeetingUrl:u,startTime:new Date(1e3*m).toISOString(),endTime:new Date(1e3*d).toISOString()},f=null==t?void 0:t.onConflictClick,h=f?function(e){null==e||e.stopPropagation(),f(p)}:void 0;return{insightType:na.Conflicts,text:xo(l.ConflictingEvents.length),iconName:va.i,onClick:h,onKeyPress:function(e){h&&we(e,h)}}}var g=null===(i=Object(H.a)(o,function(e){return e.Type===na.OutOfRoutine})[0])||void 0===i?void 0:i.Source;if(g&&g.IsOutOfRoutine)return{insightType:na.OutOfRoutine,text:io(),iconName:va.k};var v=null===(a=Object(H.a)(o,function(e){return e.Type===na.Quorum})[0])||void 0===a?void 0:a.Source;return v&&v.AcceptedAttendeesCount&&v.AcceptedAttendeesCount>0?{insightType:na.Quorum,text:ao({acceptedCount:v.AcceptedAttendeesCount.toString()}),iconName:va.l}:l&&!l.ConflictFetchFailed&&Object(L.a)(l.ConflictingEvents)?{insightType:na.Conflicts,text:ro(),iconName:va.i}:void 0}}var wo="Calendar";var To,Io=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,l)}c((r=r.apply(e,t||[])).next())})},Ao=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}};function No(e,t,n,r,i,a,o,l,c){var s=this,u=null==c?void 0:c.rsvpEvent,d=u&&t?function(t,n){return Io(s,void 0,void 0,function(){return Ao(this,function(r){switch(r.label){case 0:return function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_RSVPItem_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),[4,u(t,n)];case 1:return[2,r.sent()]}})})}:void 0,m=null==c?void 0:c.forwardEvent,p=m&&n?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_Forward_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),m(t)}:void 0,f=null==c?void 0:c.editEvent,h=f&&r?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_Edit_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),f(t)}:void 0,g=null==c?void 0:c.reply,v=g&&i?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_Reply_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),g(t)}:void 0,b=null==c?void 0:c.replyAll,y=b&&i?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_ReplyAll_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),b(t)}:void 0,O=null==c?void 0:c.joinMeeting,x=null==c?void 0:c.openLink,S=O||x?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_Join_Teams_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),O?O(t):x&&t.onlineMeetingUrl&&x(t.onlineMeetingUrl)}:void 0,C=null==c?void 0:c.scheduleNextMeeting,j=C?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_ScheduleNextMeeting_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),C(t)}:void 0,k=null==c?void 0:c.livePersonaCard,E=k?function(e){return k(e)}:void 0,w=null==c?void 0:c.openEvent,T=null==c?void 0:c.onConflictClick,I=T?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_Conflicts_Expand_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),T(t)}:void 0;return{rsvpEvent:d,forwardEvent:p,editEvent:h,reply:v,replyAll:y,joinMeeting:S,scheduleNextMeeting:j,livePersonaCard:E,openEvent:w?function(t){!function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_Event_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex),w(t)}:void 0,dateTimeFormatter:null==c?void 0:c.dateTimeFormatter,getProfilePhotoUrl:null==c?void 0:c.getProfilePhotoUrl,onConflictClick:I,relatedAttachmentClick:function(t){t.accessUrl&&(x?x(t.accessUrl):window.open(t.accessUrl,"_blank"),function(e,t,n,r,i,a,o){Object(gn.a)(e,"CalendarEvent_RelatedAttachment_Click",{eventScope:wo,cardType:n,clientSize:r,traceId:i,isHero:a},t,o)}(a,e,"Hero",o,l,!0,t.itemIndex))}}}function Po(e,t){var n=Object(lt.b)(e),r=null==t?void 0:t.formatUserTime,i=r?r(n.toISOString()):void 0;return i&&!Object(L.a)(i)?i:Pn(n,!1,!0)}function Fo(e,t,n){var r=Object(E.a)(),i=Object(c.b)(),o=Object(ie.a)().clientActionCallbacks,l=a.useState(!1),s=l[0],u=l[1],d=a.useState(!1),m=d[0],p=d[1],f=a.useState(!1),h=f[0],g=f[1],v=a.useState(!1),b=v[0],y=v[1];if(a.useEffect(function(){var e,n,r,i;Promise.all([null===(e=null==o?void 0:o.canEdit)||void 0===e?void 0:e.call(o,t),null===(n=null==o?void 0:o.canForward)||void 0===n?void 0:n.call(o,t),null===(r=null==o?void 0:o.canRsvp)||void 0===r?void 0:r.call(o,t),null===(i=null==o?void 0:o.canReply)||void 0===i?void 0:i.call(o,t)]).then(function(e){u(!!e[0]),p(!!e[1]),g(!!e[2]),y(!!e[3])})},[t]),e)return a.useMemo(function(){return No(e,h,m,s,b,r,i,n,o)},[h,m,s,b])}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed",e[e.Pending=2]="Pending"}(To||(To={}));var Do=n(126);var Lo=n(259),Ho=3;var Bo=Object(ye.a)(function(e){var t=e.palette.themeLight;return Object(qe.t)({headerContent:["ms-search-calendarTile-headerContent",{fontSize:14,lineHeight:"24px",verticalAlign:"middle",overflow:"hidden"}],headerIcon:{width:"20px",height:"20px",float:"left",textAlign:"center",borderRadius:"50%",background:t},answerTitle:["ms-search-calendarTile-answerTitle",Jt,{fontWeight:"400",fontSize:14,paddingLeft:"8.75px"}],profilePhoto:["ms-search-profile-photo",{float:"left"}],boldText:{fontWeight:"600"},row:{display:"flex",flexDirection:"row"}})}),Ro=function(){return(Ro=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Mo=function(e){var t=e.heroCalendar,n=e.imageUrl,r=e.coinSize,i=e.livePersonaCard,o=e.onOrganizerProfileClick,l=t.organizer,c=t.meetingStart,u=t.meetingEnd,d=l.email,m=l.fullName,p=t.isOrganizer,f=t.isCanceled;p=!!p,f=!!f;var h=Object(lt.b)(c).getDate(),g=function(e){return e.split(" ")[0]}(m),v=function(e,t,n,r,i){var a=(new Date).getTime()/1e3;if(t)switch(e){case"Canceled":return Da();case"Post":return Pa();case"During":return a<n?Aa():Ia();case"Pre":return fo(n,t,r,i);default:return Object(s.a)(e)}else switch(e){case"Canceled":return Fa({name:r});case"Post":return Na({name:r});case"During":return a<n?Ta({name:r}):wa({name:r});case"Pre":return fo(n,t,r,i);default:return Object(s.a)(e)}}(ha(c,u,f),p,c,m,h).split(m),b=a.useMemo(function(){return Ze(i,m,d)},[i,m,d]),y={imageUrl:Kt(n)?n:void 0,coinSize:r,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(Yt.a)(m,!1),initialsColor:Object(Qt.a)({text:m})},O=Ne(),x=Bo(O),S=a.createElement("div",{className:x.profilePhoto,role:i?"button":void 0,onClick:i?function(){return null==o?void 0:o(t)}:void 0,onKeyPress:i?function(){return null==o?void 0:o(t)}:void 0},a.createElement(Gt.a,Ro({},y))),C=b?a.createElement(b,null,S):S,j=a.createElement("span",{className:x.boldText,role:i?"button":void 0,onClick:i?function(){return null==o?void 0:o(t)}:void 0,onKeyPress:i?function(){return null==o?void 0:o(t)}:void 0},g),k=b?a.createElement(b,null,j):j;return a.createElement("div",{className:x.headerContent,title:sa({preOrganizerNameText:v[0],organizerName:p?"":g,postOrganizerNameText:v[1]})},a.createElement("div",{className:x.row},C,a.createElement("div",{className:x.answerTitle},v[0],!p&&k,v[1])))},zo=n(519),_o=n(530),Wo="ms-search-calendarTile-joinButton-root",Uo=Object(ye.a)(function(e){return Object(qe.t)({root:{marginRight:"auto",padding:"8px 0px 8px "+(e?12:24)+"px"}})}),qo=Object(ye.a)(function(e){return Object(qe.t)({root:{position:"relative",float:"right",padding:"8px "+(e?14:24)+"px 8px 0px"}})}),Vo=Object(ye.a)(function(e,t){var n=e.palette,r=n.themePrimary,i=n.neutralPrimary;return Object(qe.t)({body:["ms-search-heroCalender-entity-classname",{cursor:"pointer",overflow:"hidden",margin:"0 0.8px"}],mailActionIcon:{color:r,paddingLeft:"6px"},meetingTitle:[Jt,{color:i,display:"inline-block",fontSize:"17px",fontWeight:"600",height:"24px",lineHeight:"22px",textDecoration:t?"line-through":"none"}],meetingTime:[{maxWidth:"100%",maxHeight:"40px",margin:"0 auto",fontSize:"14px",lineHeight:"20px",overflow:"hidden",textOverflow:"ellipsis"}],meetingVenue:[Jt,{fontSize:"12px",overflow:"hidden",textOverflow:"ellipsis",display:"inline-block",height:"20px",lineHeight:"20px"}],dateContainer:[{width:"100%",textAlign:"center",fontSize:"17px",fontWeight:"600",color:i}],monthNameContainer:[Jt,{width:"100%",textAlign:"center",fontSize:"14px",color:i}],leftContainer:{width:"28px",float:"left",paddingRight:"15px"},rightContainer:{overflow:"hidden"},attachmentIcon:[{fontSize:"14px",lineHeight:"20px"},{float:"right",marginLeft:"auto"}],meetingTitleContainer:{display:"flex",alignItems:"center"}})}),Ko=Object(ye.a)(function(){return Object(qe.t)({root:["ms-search-calendarTile-editButton-root",{borderRadius:"2px"}]})}),Yo=Object(ye.a)(function(e){var t=e.palette,n=t.themePrimary,r=t.white,i=t.themeDark,a=t.themeDarker;return Object(qe.t)({root:[Wo,{borderRadius:"2px",backgroundColor:n,padding:"0px 4px 0px 4px",minWidth:"80px",height:"32px",marginLeft:"0px",selectors:{":hover":{backgroundColor:i},":active":{backgroundColor:a}}}],label:{color:r,height:"20px",minWidth:"26px",width:"auto",lineHeight:"20px",margin:"6px 12px 6px 4px"},icon:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"},iconHovered:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"},iconPressed:{color:r,height:"16px",width:"17px",margin:"6px 1px 6px 12px",padding:"0px"}})}),Qo=Object(ye.a)(function(e){var t=e.palette,n=t.white,r=t.neutralSecondaryAlt;return Object(qe.t)({root:{borderRadius:"2px",borderColor:r,borderWidth:"1px",border:"solid",backgroundColor:n,padding:"0 8px"},label:{margin:"0px"}})}),Go=Object(ye.a)(function(e,t){var n=e.palette,r=n.white,i=n.neutralSecondaryAlt,a=n.neutralPrimary;return Object(qe.t)({root:["ms-search-calendarTile-rsvpButton-root",{borderRadius:"2px",borderColor:i,minWidth:"80px",padding:t?"0px 8px 0px 8px":"0px 12px 0px 12px",backgroundColor:r}],label:{margin:"0px",color:a},menuIcon:{margin:"0px",paddingLeft:"8px",color:a},icon:{margin:"0px",paddingRight:"8px"}})}),$o=function(){return($o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Jo=function(e){var t=e.clientActionItem,n=e.rsvpResponse,r=e.setRsvpResponse,i=e.className,o=e.onRSVPItemClick,l=function(e){switch(e){case"Accepted":return va.d;case"Declined":return va.f;case"TentativelyAccepted":return va.h;case"None":case"NotResponded":case"Organizer":return;default:Object(s.a)(e)}}(n),c=Ne();if(!o)return null;var u=bo(t,n,r,o),d=u.items;return Object(K.a)(d)>0?a.createElement(Bt.a,{ariaLabel:uo(),onKeyPress:function(e){e.stopPropagation()},text:yo(n),menuProps:$o($o({},u),{className:i}),styles:Go(c,!!l),iconProps:{iconName:l}}):null};var Zo=function(){return(Zo=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var Xo=function(e){var t=e.heroCalendar,n=e.actionCallbacks,i=e.isOrganizer,o=e.eventScenario,l=e.isSmall,c=Ne(),s=Vo(c).mailActionIcon,u={childrenGap:8},d=t.responseStatus,m=t.requiredAttendees,p=t.id,f=t.joinOnlineMeetingUrl,h=t.hexItemId,g=Object(K.a)(m);d=d||"None";var v=a.useState(d),b=v[0],y=v[1],O=n.joinMeeting,x=n.scheduleNextMeeting,S=n.reply,C=n.replyAll,j=n.editEvent,k=n.forwardEvent,E=n.rsvpEvent,w={itemId:p,hexItemId:h,onlineMeetingUrl:f};return a.createElement(a.Fragment,null,a.createElement(zo.a,{horizontal:!0,tokens:u,horizontalAlign:"baseline",styles:Uo(l)},i&&("Pre"===o||"Canceled"===o)&&j&&a.createElement(Rt.a,{"aria-label":da(),text:ba(),styles:Ko(),onClick:function(){return j(w)}}),"During"===o&&O&&f&&!Object(r.a)(f)&&a.createElement(_o.a,{"aria-label":ua(),iconProps:{iconName:va.p},styles:Yo(c),onClick:function(){return O(w)}},ma()),i&&"Post"===o&&x&&a.createElement(Bt.a,{text:Sa(),styles:Qo(c),onClick:function(){return x(w)}}),!i&&E&&"Pre"===o&&function(e,t,n,r){var i={clientActionItem:e,rsvpResponse:t,setRsvpResponse:n,onRSVPItemClick:r};return a.createElement(Jo,Zo({},i))}(w,b,y,E)),a.createElement(zo.a,{horizontal:!0,tokens:u,styles:qo(l),horizontalAlign:"end"},!i&&S&&a.createElement(Fe.a,{iconProps:{iconName:va.m},className:s,title:ya(),ariaLabel:ya(),onClick:function(){return S(w)}}),Oo(g)&&C&&a.createElement(Fe.a,{iconProps:{iconName:va.n},className:s,title:Oa(),ariaLabel:Oa(),onClick:function(){return C(w)}}),k&&a.createElement(Fe.a,{iconProps:{iconName:va.g},className:s,title:xa(),ariaLabel:xa(),onClick:function(){return k(w)}})))},el=function(){return(el=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},tl=function(e){var t,n=e.heroCalendar,r=e.actionCallbacks,i=e.getMeetingDateTimeText,o=e.imageUrl,l=e.clientSize,c=e.className,s=e.isDismissible,u=e.onOrganizerProfileClick,d=e.setAnswerHeight,m=e.onDismiss,p=n.meetingSubject,f=n.meetingStart,h=n.meetingEnd,g=n.meetingLocation,v=n.id,b=n.hexItemId,y=n.joinOnlineMeetingUrl,O=n.hasAttachments,x={itemId:v,hexItemId:b,itemIndex:-1},S=Object(L.a)(p)?mo():p,C=n.isOrganizer,j=n.isCanceled;C=!!C,j=!!j;var k=be("HeroCalendarTile",va.q,l),E=k[0],w=k[1],T=null===(t=E.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){T&&d&&d(T)},[T]);var I,A,N,P,F,D,H,B,R,M="Small"===w,z=Object(lt.b)(f).getDate(),_=ga(f),W=ha(f,h,j),U=So(g,!Object(L.a)(y)),q=Ne(),V=Vo(q,j),K=V.meetingTitle,Y=V.leftContainer,Q=V.rightContainer,G=V.meetingVenue,$=V.meetingTime,J=V.dateContainer,Z=V.monthNameContainer,X=V.body,ee=V.attachmentIcon,te=V.meetingTitleContainer,ne=r.openEvent,re=r.livePersonaCard,ie={heroCalendar:n,imageUrl:o,livePersonaCard:re,onOrganizerProfileClick:u},ae=function(e){e.preventDefault(),we(e,function(){return null==ne?void 0:ne(x)})},oe=i(f,h),le={body:a.createElement("div",{role:"link",tabIndex:0,onClick:function(){return null==ne?void 0:ne(x)},onKeyPress:ae,className:X},a.createElement("div",{className:Y},a.createElement("div",{className:J},z),a.createElement("div",{className:Z,title:_},_)),a.createElement("div",{className:Q},a.createElement("div",{className:te},a.createElement("div",{className:K,title:S},S),O&&a.createElement(Mt.a,{iconName:va.e,className:ee})),a.createElement("div",{className:$,title:oe},oe),U&&!Object(L.a)(U)&&a.createElement("div",{className:G,title:U},U))),header:a.createElement(Mo,el({},ie)),footer:(R={heroCalendar:n,actionCallbacks:r,isOrganizer:C,eventScenario:W,isSmall:M},!j&&(I=r.rsvpEvent,A=r.forwardEvent,N=r.editEvent,P=r.deleteEvent,F=r.cancelEvent,D=r.reply,H=r.replyAll,B=r.joinMeeting,!(!I&&!A&&!N&&!P&&!F&&!D&&!H&&(!B||"During"!==W||Object(L.a)(y))))&&a.createElement(Xo,el({},R))),isSmall:M,styleOverrides:function(){return{cardStyles:M?void 0:"ms-search-maxContent"}},className:c,isDismissible:s,onDismiss:m};return a.createElement("div",{ref:E},a.createElement(et,el({},le)))};tl.displayName="HeroCalendarTile";var nl=n(447),rl=n(516),il=Object(ye.a)(function(e,t){var n,r=e.palette,i=r.themePrimary,a=r.neutralLighterAlt,o=r.neutralSecondary;return Object(qe.t)({calendarInsightsActionBlock:["ms-search-calendarInsightsActionBlock",{display:"none",alignItems:"center",cursor:"default",backgroundColor:a,minHeight:"32px"}],insightsIcon:{marginRight:"10px",marginLeft:"12px",minWidth:"26px",height:"20px",lineHeight:"20px",textAlign:"center",color:o,fill:o},rsvpMenuButttonIcon:{selectors:(n={},n["& .ms-ContextualMenu-icon"]={color:o},n)},conflictsInfoContainer:["ms-search-conflictsInfoContainer",Jt,{fontSize:"14px",lineHeight:"20px"},{display:"flex",paddingRight:"5px",height:"20px",lineHeight:"20px",color:o}],firstConflictName:[Jt],primaryActionContainer:{marginLeft:"auto"},conflictsInfoLink:{color:i,cursor:t?"pointer":"default"},insightsInfoContainer:[Jt,{fontSize:"14px",lineHeight:"20px"},{paddingRight:"40px",color:o,width:"175px"}]})}),al=Object(ye.a)(function(e,t,n,r){var i,a,o,l,c=r.palette,s=c.white,u=c.neutralDark,d=c.neutralLight,m=c.neutralLighterAlt,p=c.neutralSecondary;return Object(qe.t)({commandbar:{marginLeft:e?"auto":"0px",width:e?"24px":"100%",alignItems:"center",float:"right",padding:"0px",overflow:"hidden",minWidth:"24px",backgroundColor:"transparent",selectors:(i={},i["& .ms-OverflowSet-item"]={alignItems:"center",cursor:"pointer"},i["& .ms-OverflowSet-overflowButton"]={marginLeft:"auto",alignItems:"center",cursor:"pointer",paddingRight:"16px"},i["& .ms-OverflowSet-overflowButton:hover"]={backgroundColor:"transparent"},i["& .ms-OverflowSet-item:first-child"]={marginRight:t?"auto":void 0,marginLeft:t?void 0:"auto"},i["& .ms-OverflowSet-item:last-child"]={paddingRight:"16px"},i["& .ms-CommandBar"]={backgroundColor:"transparent"},i["& .ms-Button--commandBar"]={backgroundColor:"transparent"},i["& .ms-Button--commandBar:hover"]={backgroundColor:"transparent"},i["& .ms-Button--commandBar:active"]={backgroundColor:"transparent"},i["& .ms-Button--commandBar:hover .ms-Button-menuIcon"]={backgroundColor:d},i["& .ms-Button-menuIcon"]={fontSize:"16px",padding:"4px",borderSize:"2px"},i)},primaryActionInsightsContainer:{selectors:(a={},a["& .ms-search-calendarInsightsActionBlock"]={backgroundColor:n?m:s},a["& .ms-search-conflictsInfoContainer"]={width:"189px",marginRight:"20px"},a)},iconButton:{height:"36px",minWidth:"20px",selectors:(o={"&:hover .ms-Button-icon":{color:u,backgroundColor:d,borderRadius:"2px"},"&:active .ms-Button-icon":{color:u}},o["& .ms-Button-icon"]={color:p,fontSize:"16px",margin:"0",padding:"4px"},o["& .ms-ContextualMenu-icon"]={color:p},o)},rsvpMenuIconButton:{selectors:(l={},l["& .ms-ContextualMenu-icon"]={color:p},l)},joinMeetingButton:{marginLeft:"auto"}})}),ol=Object(ye.a)(function(e){var t=e.palette.neutralPrimary;return Object(qe.t)({root:{color:t,padding:"0px"}})}),ll=(Object(ye.a)(function(){return Object(qe.t)({root:{height:"100%",padding:"0px"}})}),Object(ye.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:["ms-search-calendarTile-commandbarButton-root",{background:t,height:"24px",minWidth:"24px",width:"24px",border:"none"}]})})),cl=Object(ye.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,float:"right",height:"100%",padding:"0px",width:"100%"}})}),sl=function(){return(sl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ul=function(e){var t=e.meetingItem,n=e.index,r=e.actionCallbacks,i=e.className,o=e.rsvpResponse,c=e.setRsvpResponse,s=t.meetingStart,u=t.meetingEnd,d=t.isCanceled,m=t.insights,p=t.id,f=t.hexItemId,h=t.joinOnlineMeetingUrl,g=t.isOrganizer,v=ha(s,u,!!d),b=Ne();if("Post"===v)return null;var y={itemId:p,hexItemId:f,itemIndex:n,onlineMeetingUrl:h,startTime:new Date(1e3*s).toISOString(),endTime:new Date(1e3*u).toISOString()},O=null==r?void 0:r.joinMeeting,x=null==r?void 0:r.rsvpEvent,S=null==r?void 0:r.editEvent,C=null==r?void 0:r.onConflictClick,j="During"===v&&O&&!Object(L.a)(h),k=!g&&x&&"Pre"===v,E=!(!g||!S||"Pre"!==v&&"Canceled"!==v),w=il(b,!!C);if(!Eo(t,r,n)&&!(k||j||E))return null;return a.createElement("div",{className:i},a.createElement("div",{className:w.calendarInsightsActionBlock,role:"presentation",onClick:function(e){return e.stopPropagation()}},function(){var e,t,n;if(!m)return null;var r=C?function(e){null==e||e.stopPropagation(),C(y)}:void 0,i=null===(e=Object(H.a)(m,function(e){return e.Type===na.Conflicts})[0])||void 0===e?void 0:e.Source;if(i&&!i.ConflictFetchFailed&&!Object(L.a)(i.ConflictingEvents)){var o=no({conflictName:i.ConflictingEvents[0].Subject}),c=a.createElement(a.Fragment,null,a.createElement("div",{className:w.firstConflictName,title:o},o),i.ConflictingEvents.length>1&&a.createElement("span",null,lo({additionalNumber:(i.ConflictingEvents.length-1).toString()})));return a.createElement(a.Fragment,null,a.createElement(Mt.a,{iconName:va.i,className:w.insightsIcon}),r&&a.createElement(l,{role:"button",onClick:r,onKeyPress:function(e){null==e||e.stopPropagation(),r&&we(e,r)},className:Je(w.conflictsInfoContainer,w.conflictsInfoLink)},c),!r&&a.createElement("div",{className:w.conflictsInfoContainer},c))}var s=null===(t=Object(H.a)(m,function(e){return e.Type===na.OutOfRoutine})[0])||void 0===t?void 0:t.Source;if(s&&s.IsOutOfRoutine)return a.createElement(a.Fragment,null,a.createElement(Mt.a,{iconName:va.k,className:w.insightsIcon}),a.createElement("div",{className:w.insightsInfoContainer,title:io()},io()));var u=null===(n=Object(H.a)(m,function(e){return e.Type===na.Quorum})[0])||void 0===n?void 0:n.Source;if(u&&u.AcceptedAttendeesCount){var d=u.AcceptedAttendeesCount>0?ao({acceptedCount:u.AcceptedAttendeesCount.toString()}):oo();return a.createElement(a.Fragment,null,a.createElement(Mt.a,{iconName:va.l,className:w.insightsIcon}),a.createElement("div",{className:w.insightsInfoContainer,title:d},d))}if(i&&!i.ConflictFetchFailed&&Object(L.a)(i.ConflictingEvents)){o=ro(),c=a.createElement("div",{className:w.firstConflictName,title:o},o);return a.createElement(a.Fragment,null,a.createElement(Mt.a,{iconName:va.i,className:w.insightsIcon}),a.createElement("div",{className:w.conflictsInfoContainer},c))}return null}(),function(){if(!(k||j||E))return null;var e=function(e){e.stopPropagation(),S&&S(y)},t=function(e){e.stopPropagation(),O&&h&&O(y)},n={clientActionItem:y,rsvpResponse:o,setRsvpResponse:c,onRSVPItemClick:x,className:w.rsvpMenuButttonIcon};return a.createElement("div",{className:w.primaryActionContainer},j&&O&&h&&a.createElement(_o.a,{role:"link","aria-label":ua(),iconProps:{iconName:va.p},styles:Yo(b),onClick:function(e){return t(e)},onKeyPress:function(e){return t(e)}},ma()),E&&S&&a.createElement(Bt.a,{role:"link","aria-label":da(),text:ba(),styles:Ko(),onClick:function(t){return e(t)},onKeyPress:function(t){return e(t)}}),k&&x&&a.createElement(Jo,sl({},n)))}()))};ul.displayName="CalendarInsightsWithPrimaryAction";var dl=function(){return(dl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ml=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},pl=function(e){var t,n=Ne(),r=e.heroCalendar,i=e.actionCallbacks,o=e.isMultiEntity,l=e.index,c=e.isSmall,s=e.className,u=e.rsvpResponse,d=e.setRsvpResponse,m=r.id,p=r.joinOnlineMeetingUrl,f=r.hexItemId,h=r.requiredAttendees,g=r.meetingStart,v=r.meetingEnd,b=r.isCanceled,y=r.isOrganizer,O=Object(K.a)(h),x=i.reply,S=i.replyAll,C=i.forwardEvent,j=i.rsvpEvent,k=i.editEvent,E=i.joinMeeting,w=ha(g,v,!!b),T=a.useState(!1),I=T[0],A=T[1],N="During"===w&&E&&!Object(L.a)(p);if(a.useEffect(function(){!N||!o&&c||A(!0)},[]),!(x||S||C||j||N))return null;var P=!!(x||S||C||j),F=o||!c?Eo(r,i,l):void 0;if(F){var D=F.insightType,H=F.text,B=F.onClick,R=F.onKeyPress,M=F.iconName;switch(D){case"Conflicts":t={text:H,key:H,onClick:B,onKeyPress:R,iconProps:{iconName:M,style:{color:n.palette.neutralSecondary}},style:{color:H!==ro()?n.palette.themePrimary:n.palette.neutralSecondary},disabled:!B};break;case"OutOfRoutine":case"Quorum":t={text:H,key:H,disabled:!0,iconProps:{iconName:M}};break;default:t=void 0}t&&(t.commandBarButtonAs=function(e){return a.useEffect(function(){W&&t&&A(!1)},[]),a.createElement(fl,dl({},e,{meetingItem:r,actionCallbacks:i,index:l,rsvpResponse:u,setRsvpResponse:d}))})}var z=!!y&&!!k&&(o||!o&&!c||"During"===w)&&"Post"!==w,_=!y&&!!j&&(o||!o&&!c)&&"Pre"===w||z,W=_&&!!t||!o&&!c&&!!t,U=al(c,W||_,W,n),q=function(e){e.stopPropagation(),E&&p&&E(V)},V={itemId:m,hexItemId:f,onlineMeetingUrl:p},Y={text:ya(),title:ya(),key:ya(),tooltipHostProps:{content:""},iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==x||x(V)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:va.m},className:U.iconButton},Q={text:Oa(),title:Oa(),key:Oa(),tooltipHostProps:{content:""},iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==S||S(V)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:va.n},className:U.iconButton},G={text:xa(),title:xa(),key:xa(),tooltipHostProps:{content:""},iconOnly:!0,onClick:function(e){null==e||e.stopPropagation(),null==C||C(V)},onKeyPress:function(e){null==e||e.stopPropagation()},iconProps:{iconName:va.g},className:U.iconButton},$=j?bo(V,u,d,j):void 0,J=function(e){return W&&t?null:a.createElement(fl,dl({},e,{meetingItem:r,actionCallbacks:i,index:l,rsvpResponse:u,setRsvpResponse:d}))},Z=$?{text:Ca(),key:Ca(),subMenuProps:dl(dl({},$),{className:U.rsvpMenuIconButton}),iconProps:{iconName:"Calendar"},commandBarButtonAs:J,className:U.rsvpMenuIconButton}:void 0,X={text:ba(),key:ba(),onClick:function(){null==k||k(V)},onKeyPress:function(e){null==e||e.stopPropagation(),null==k||k(V)},iconProps:{iconName:"Edit",style:{color:n.palette.neutralSecondary}},commandBarButtonAs:J},ee={key:"divider_1",itemType:nl.a.Divider,commandBarButtonAs:function(e){return null}};t&&(t.className=U.primaryActionInsightsContainer),(!t||!W&&_)&&(X.className=U.primaryActionInsightsContainer,Z&&(Z.className=U.primaryActionInsightsContainer));var te=ml(ml(ml(ml(ml([],W&&t?[t]:[]),_?z?[X,ee]:Z?[Z,ee]:[]:[]),x&&!y?[Y]:[]),S&&Oo(O)&&Q?[Q]:[]),C?[G]:[]),ne=[];return a.createElement(a.Fragment,null,I&&a.createElement(_o.a,{role:"link","aria-label":ua(),iconProps:{iconName:va.p},styles:Yo(n),onClick:function(e){return q(e)},onKeyPress:function(e){return q(e)},className:Je(U.joinMeetingButton,s)},ma()),P&&a.createElement(rl.a,{styles:cl(n),items:c?ne:te,overflowItems:c?te:ne,className:Je(U.commandbar,s),overflowButtonProps:{menuProps:{items:ne,directionalHint:rn.a.rightTopEdge,gapSpace:6},menuIconProps:{iconName:"MoreVertical",styles:ol(n)},styles:ll(n),onKeyPress:function(e){null==e||e.stopPropagation()}},dataDidRender:function(e){e&&0===e.primaryItems.length&&(!N||!o&&c||A(!0))}}))},fl=function(e){var t={meetingItem:e.meetingItem,actionCallbacks:e.actionCallbacks,index:e.index,className:e.className,rsvpResponse:e.rsvpResponse,setRsvpResponse:e.setRsvpResponse};return a.createElement(ul,dl({},t))};pl.displayName="CalendarCommandBar";var hl=Object(ye.a)(function(e,t){var n,r=e.palette,i=r.white,a=r.neutralLighterAlt,o=r.neutralLighter;return Object(qe.t)({body:["ms-search-calendarBody-ItemContent",{display:t?"block":"flex",overflow:"hidden",marginBottom:"1px",backgroundColor:i,paddingLeft:t?"18px":"35px",paddingTop:"8px",paddingBottom:"8px",paddingRight:"20px",selectors:{"&:hover":{backgroundColor:a}}}],calendarActionContainer:["ms-search-calendarEntity-calendarActionContainer",{display:"none",selectors:(n={},n["& .ms-search-calendarInsightsActionBlock"]={display:"flex",marginLeft:t?"0":"auto",marginRight:t?"0":"206px",maxWidth:t?"undefined":"294px",borderTop:t?"1px solid "+o:void 0,padding:"4px "+(t?"4px":"20px")},n)}],meetingDetailsWithAction:["ms-search-calendarEntity-meetingDetailsWithActions"],calendarCommandBar:["ms-search-calendarEntity-calendarCommandBar",{display:"none",marginLeft:"auto"}]})}),gl=n(515),vl=n(268),bl=Object(ye.a)(function(e,t){return Object(qe.t)({meetingAttachmentContainer:["ms-search-meeting-attachment-container",{display:"flex",paddingBottom:t?"0":"14px",alignItems:"center"}],shimmer:{width:"75%",marginLeft:t?"0":"17px"},attachmentIcon:{marginLeft:e?"15px":"0"},attachmentsContainer:["ms-search-attachment-container",{marginLeft:t?"0":"17px"}],additionAttachmentData:{display:"inline-block",padding:"6px"}})}),yl=Object(ye.a)(function(e,t){var n;return Object(qe.t)({root:["ms-search-attachment-button-container",{display:e?"inline-grid":"inline-block",marginRight:t&&e?"3px":"8px",width:e?"80px":"auto",minWidth:e?"75px":"80px",padding:t?"0":"0px 16px",maxWidth:e?void 0:"122px",marginTop:"4px",selectors:(n={},n["& .ms-Button-flexContainer"]={overflow:"hidden"},n)}],label:["ms-search-text-label-container",{noWrapTruncation:Jt}],textContainer:["ms-search-text-button-container",{overflow:"hidden"}]})}),Ol=function(e){var t=e.meetingItem,n=e.isSmall,i=e.meetingArtifactsFetchingStatus,o=e.actionCallbacks,l=e.meetingIndex,c=e.hasInsights,s=t.hasAttachments,u=t.artifacts,d=bl(n,c),m=c&&n?1:2;if(!s||i===To.Failed)return null;var p=Object(H.a)(u,function(e){return e.Type===ra.FileAttachment});if(i===To.Success&&Object(r.a)(p))return null;var f;return a.createElement("div",{className:d.meetingAttachmentContainer,role:"presentation",onClick:function(e){return e.stopPropagation()}},!c&&a.createElement(Mt.a,{iconName:va.e,className:d.attachmentIcon}),i===To.Pending&&a.createElement(gl.a,{className:d.shimmer}),i===To.Success&&a.createElement("div",{className:d.attachmentsContainer},(f=p.slice(0,m),a.createElement(a.Fragment,null,Object(V.a)(f,function(e,t){var r=e.Source,i=Object(vl.getFileTypeIconProps)({extension:r.FileExtension,size:16}),s=function(e){var t;null==e||e.stopPropagation();var n={accessUrl:r.Url,itemIndex:l};null===(t=null==o?void 0:o.relatedAttachmentClick)||void 0===t||t.call(o,n)};return a.createElement(Bt.a,{iconProps:i,styles:yl(n,c),title:r.Title,onClick:s,onKeyPress:function(e){e.stopPropagation(),"Enter"!==e.key&&" "!==e.key||s(e)},key:t},r.Title)}),p.length>m&&a.createElement("div",{className:d.additionAttachmentData},lo({additionalNumber:(p.length-m).toString()}))))))},xl=Object(ye.a)(function(e,t){var n=e.palette.neutralPrimary;return Object(qe.t)({meetingDateDayContainer:["ms-search-meetingDateDayContainer",{width:"28px",float:"left",marginRight:t?"22px":"16px"}],monthNameContainer:["ms-search-calendarTile-meetingMonth",{fontSize:"14px",lineHeight:"20px"},Jt,{color:n,width:"100%",textAlign:"center"}],dateContainer:["ms-search-calendarTile-meetingDate",{fontSize:"17px",fontWeight:"600"},{width:"100%",textAlign:"center",color:n}]})}),Sl=function(e){var t=e.startDate,n=e.startMonth,r=e.isSmall,i=Ne(),o=xl(i,r),l=o.meetingDateDayContainer,c=o.dateContainer,s=o.monthNameContainer;return a.createElement("div",{className:l},a.createElement("div",{className:c},t),a.createElement("div",{className:s,title:n},n))},Cl=Object(ye.a)(function(e,t){var n=e.palette,r=n.neutralLighterAlt,i=n.neutralPrimary;return Object(qe.t)({actionBlockContainer:["ms-search-calender-actionblock-content-classname",{backgroundColor:r,borderRadius:"4px",height:"40px",lineHeight:"40px",display:"flex",marginTop:"5px",width:t?"auto":"294px",maxWidth:"294px",alignItems:"center"}],actionContainer:{marginLeft:"auto",marginRight:"4px",display:"flex"},conflictInfoIcon:["ms-search-conflict-info-classname",{fontSize:"14px",lineHeight:"20px"},{color:i,margin:"0 13px 0 15px"}],conflictData:[Jt,{fontSize:"14px",lineHeight:"20px"},{color:i}]})}),jl=function(){return(jl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},kl=function(e){var t,n=e.meetingItem,r=e.actionCallbacks,i=e.index,o=e.isSmall,l=n.joinOnlineMeetingUrl,c=n.isOrganizer,s=n.id,u=n.hexItemId,d=n.insights,m={itemId:s,hexItemId:u,itemIndex:i,onlineMeetingUrl:l},p=n.responseStatus||"None",f=a.useState(p),h=f[0],g=f[1],v=Ne(),b=Cl(v,o),y=b.actionBlockContainer,O=b.conflictInfoIcon,x=b.conflictData,S=b.actionContainer,C=null==r?void 0:r.joinMeeting,j=null==r?void 0:r.rsvpEvent,k=null==r?void 0:r.editEvent,E=null===(t=Object(H.a)(d,function(e){return e.Type===na.Conflicts})[0])||void 0===t?void 0:t.Source,w=E&&!E.ConflictFetchFailed,T=Co(n),I=T.meetingInfoString,A=T.eventScenario,N="During"===A&&C&&!Object(L.a)(l),P=!c&&j&&"Pre"===A,F=!(!c||!k||"Pre"!==A&&"Canceled"!==A);if(!w)return null;if(!(P||N||F))return null;var D=function(e){e.stopPropagation(),k&&k(m)},B=function(e){e.stopPropagation(),C&&l&&C(m)},R={clientActionItem:m,rsvpResponse:h,setRsvpResponse:g,onRSVPItemClick:j};return a.createElement("div",{className:y},a.createElement(Mt.a,{className:O,iconName:va.i}),a.createElement("div",{className:x,title:I},I),a.createElement("div",{className:S},N&&C&&l&&a.createElement(_o.a,{role:"link","aria-label":ua(),iconProps:{iconName:va.p},styles:Yo(v),onClick:function(e){return B(e)},onKeyPress:function(e){return B(e)}},ma()),F&&k&&a.createElement(Rt.a,{role:"link","aria-label":da(),text:ba(),styles:Ko(),onClick:function(e){return D(e)},onKeyPress:function(e){return D(e)}}),P&&j&&a.createElement(Jo,jl({},R))))};kl.displayName="MeetingActionBlock";var El=Object(ye.a)(function(e,t,n){var r=e.palette,i=r.neutralPrimary,a=r.themePrimary;return Object(qe.t)({meetingDetailsContainer:["ms-search-calender-meeting-detail-content-classname",{overflow:"hidden",display:t?"block":"flex"}],meetingTitleContainer:[{fontSize:"14px",lineHeight:"20px"},{display:"flex",width:t?"auto":"235px",minWidth:t?"auto":"235px",paddingRight:t?"0px":"25px",height:"22px",alignItems:"center",color:i}],moreDetailsContainer:["ms-search-calendarTile-moreDetailsContainer",{overflow:"hidden",width:t?void 0:"100%"}],meetingTitle:["ms-search-calendarTile-meetingTitle",Jt,{fontWeight:"600",textDecoration:n?"line-through":"none"}],meetingTimeContainer:{display:"flex"},meetingTime:["ms-search-calendarTile-meetingTime",Jt,{fontSize:"14px",lineHeight:"20px"},{maxHeight:"40px",whiteSpace:"nowrap",display:"inline-block"}],meetingVenue:["ms-search-meeting-venue-classname",Jt,{fontSize:"14px",lineHeight:"20px"},{display:"inline-block",height:"20px",marginLeft:t?"0px":"16px"}],moreDetails:["ms-search-calender-moredetail-content-classname",{display:t?"block":"flex",overflow:"hidden"}],attachmentIcon:["ms-search-calendarTile-attachmentIcon",{fontSize:"14px",lineHeight:"20px"},{float:"right",marginLeft:"auto"}],recurringIcon:[{fontSize:"14px",lineHeight:"20px"},{padding:"0 8px",verticalAlign:"middle"}],insightsIcon:["ms-search-calendarTile-insightsIcon",{display:"none",color:a,marginLeft:"4px",fontWeight:"600"}]})}),wl=function(){return(wl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Tl=function(e){var t=e.meetingItem,n=e.meetingDayTimeText,r=e.isSmall,i=e.actionCallbacks,o=e.index,l=e.showActionsInBody,c=e.hasRelatedEmailArtifacts,s=e.meetingArtifactsFetchingStatus,u=e.hasInsights,d=t.meetingSubject,m=t.joinOnlineMeetingUrl,p=t.hasAttachments,f=t.isCanceled,h=t.seriesMasterId,g=t.meetingLocation,v=t.meetingStart,b=t.meetingEnd,y=Ne(),O=El(y,r,f),x=Object(L.a)(d)?mo():d,S=ha(v,b,!!f),C=O.meetingDetailsContainer,j=O.meetingTitle,k=O.meetingTime,E=O.meetingVenue,w=O.moreDetails,T=O.attachmentIcon,I=O.meetingTitleContainer,A=O.moreDetailsContainer,N=O.recurringIcon,P=O.meetingTimeContainer,F=O.insightsIcon,D=So(g,!Object(L.a)(m)),H={meetingItem:t,actionCallbacks:i,index:o,isSmall:r};return a.createElement("div",{className:C},a.createElement("div",{className:I},a.createElement("div",{className:j,title:x},x),c&&a.createElement(Mt.a,{iconName:va.j,className:F,title:c?"Post"===S?so():co():void 0}),p&&a.createElement(Mt.a,{iconName:va.e,className:T})),a.createElement("div",{className:A},a.createElement("div",{className:w},a.createElement("div",{className:P},a.createElement("div",{className:k,title:n},n),!Object(L.a)(h)&&a.createElement(Mt.a,{className:N,iconName:va.o})),D&&!Object(L.a)(D)&&a.createElement("div",{className:E,title:D},D)),!l&&a.createElement(kl,wl({},H)),(u||!r)&&a.createElement(Ol,{meetingItem:t,isSmall:r,meetingArtifactsFetchingStatus:s,actionCallbacks:i,hasInsights:u})))};Tl.displayName="MeetingDetails";var Il=function(){return(Il=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Al=function(e){var t,n=e.meetingItem,r=e.isSmall,i=e.maxMeetingsToDisplay,o=e.index,l=e.showActionsInBody,c=e.meetingArtifactsFetchingStatus,s=e.getMeetingDateTimeText,u=e.useCalendarCallbacks,d=e.hasInsights,m={itemId:n.id||"",hexItemId:n.hexItemId||"",itemIndex:o},p=u(n,m),f=null==p?void 0:p.openEvent,h=n.meetingStart,g=n.meetingEnd,v=n.meetingSubject,b=n.meetingLocation,y=n.joinOnlineMeetingUrl,O=n.artifacts,x=Object(lt.b)(h).getDate(),S=ga(h),C=n.responseStatus||"None",j=a.useState(C),k=j[0],E=j[1],w=Ne(),T=hl(w,r),I={startDate:x,startMonth:S,isSmall:r},A=s(h,g),N=Object(L.a)(v)?mo():v,P={meetingItem:n,meetingDayTimeText:A,isSmall:r,showActionsInBody:l,actionCallbacks:p,index:o,hasRelatedEmailArtifacts:c===To.Success&&Object(H.a)(O,function(e){return e.Type===ra.RelatedEmail||e.Type===ra.RelatedFile}).length>0,meetingArtifactsFetchingStatus:c,hasInsights:d},F=Co(n).meetingInfoString,D=So(b,!Object(L.a)(y)),B=Za({meetingName:N,startDate:x.toString(),startMonth:S,meetingDayTimeText:A,meetingLocation:Object(L.a)(D)?"":to({meetingLocation:D}),recurringText:jo(n),attachmentText:ko(n),additionalMeetingInfo:F}),R=i>1,M={meetingItem:n,actionCallbacks:p,index:o,className:T.calendarActionContainer,rsvpResponse:k,setRsvpResponse:E};return p&&(t={heroCalendar:n,actionCallbacks:p,isSmall:r,isMultiEntity:R,index:o,className:T.calendarCommandBar,setRsvpResponse:E,rsvpResponse:k}),a.createElement(a.Fragment,null,a.createElement("div",{className:T.body,role:"listitem",onClick:function(){return null==f?void 0:f(m)},onKeyPress:function(e){e.preventDefault(),we(e,function(){return null==f?void 0:f(m)})},tabIndex:f?0:-1,"aria-label":B,"aria-posinset":o+1,"aria-setsize":i},a.createElement(Sl,Il({},I)),a.createElement("div",{className:T.meetingDetailsWithAction},a.createElement(Tl,Il({},P)),r&&t&&a.createElement(pl,Il({},t))),!d&&r&&a.createElement(Ol,{meetingItem:n,isSmall:r,meetingArtifactsFetchingStatus:c,actionCallbacks:p}),!r&&t&&a.createElement(pl,Il({},t))),!R&&r&&a.createElement(ul,Il({},M)))};Al.displayName="CalendarEntity";var Nl=Object(ye.a)(function(e,t,n){var r,i=e.palette,a=i.neutralLight,o=i.white;return Object(qe.t)({calendarListItem:["ms-search-calendarListItem",{selectors:(r={},r["& .ms-search-calendarBody-ItemContent"]={borderBottom:t?"":"1px solid "+a,padding:"8px "+(n?"12px":"20px"),paddingBottom:"8px"},r["& .ms-search-calendarBody-ItemContent:hover"]={backgroundColor:o},r)}]})}),Pl=Object(ye.a)(function(e,t,n){var r,i=n.palette,a=i.neutralLight,o=i.neutralQuaternaryAlt;return Object(qe.t)({calendarContainer:{selectors:(r={},r["& .ms-search-calender-moredetail-content-classname"]={display:"flex",flexDirection:"column"},r["& .ms-search-meeting-venue-classname"]={marginLeft:"0px"},r["& .ms-search-calendarEntity-calendarActionContainer"]={display:"block"},r["& .ms-search-calender-actionblock-content-classname"]={display:"none"},r["& .ms-search-calendarEntity-calendarCommandBar"]={display:"block"},r["& .ms-search-calendarTile-attachmentIcon"]={display:"none"},r["& .ms-search-calendarEntity-meetingDetailsWithActions"]={display:"flex"},r["& .ms-search-heroTile-headerContainer"]={display:e?void 0:"block"},r["& .ms-search-heroTile-bodyContainer"]={padding:"0px"},r["& .ms-search-tileHeader"]={margin:"0px",padding:"8px "+(t?"12px":"20px")},r["& .ms-search-tileBody"]={margin:"0px",padding:"0px"},r["& .ms-search-calendarTile-rsvpButton-root"]={border:"none",backgroundColor:a,borderRadius:"4px"},r["& .ms-search-calendarTile-rsvpButton-root:hover"]={backgroundColor:o,borderRadius:"4px"},r["& ."+Wo]={borderRadius:"4px"},r["& ."+Wo+":hover"]={borderRadius:"4px"},r["& .ms-search-calendarTile-commandbarButton-root"]={borderRadius:"4px"},r["& .ms-search-calendarTile-commandbarButton-root:hover"]={borderRadius:"4px"},r["& .ms-search-heroCalender-entity-classname"]={margin:"0px"},r["& .ms-search-calendarTile-editButton-root"]={border:"none",borderRadius:"4px",backgroundColor:a},r["& .ms-search-calendarTile-editButton-root:hover"]={backgroundColor:o,borderRadius:"4px"},r["& .ms-search-calendarTile-moreDetailsContainer"]={width:t?void 0:"337px"},r["& .ms-search-calendarTile-insightsIcon"]={display:"inline-block"},r["& .ms-search-calendarInsightsActionBlock"]={display:"flex"},r["& .ms-search-calender-meeting-detail-content-classname"]={marginRight:t?"10px":"0"},r["& .ms-search-meetingDateDayContainer"]={marginRight:t?"12px":"16px"},r)},multiEntityCalendarHeader:["ms-search-CalendarTile-multiEntityHeader",Jt,{fontWeight:"600",fontSize:14}],tileHeaderOverride:["ms-search-tileHeader"],tileBodyOverride:["ms-search-tileBody"]})}),Fl=function(){return(Fl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Dl=function(e){var t=e.meetingList,n=e.meetingItem,r=e.isSmall,i=e.index,o=e.maxMeetingsToDisplay,l=e.showActionsInBody,c=e.meetingArtifactsFetchingStatus,s=e.getMeetingDateTimeText,u=e.useCalendarCallbacks,d=Ne(),m=Vo(d,null==n?void 0:n.isCanceled),p=Nl(d,i===Object(K.a)(t)-1,r),f={meetingItem:n,isSmall:r,index:i,maxMeetingsToDisplay:o,showActionsInBody:l,meetingArtifactsFetchingStatus:c,getMeetingDateTimeText:s,useCalendarCallbacks:u,hasInsights:!0};return a.createElement("div",{className:Je(p.calendarListItem,m.body)},a.createElement(Al,Fl({},f)))};Dl.displayName="CalendarEntityWithInsights";var Ll=function(){return(Ll=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Hl=function(e){var t=e.meetingList,n=e.isSmall,r=e.hasInsights,i=e.meetingArtifactsFetchingStatus,o=e.getMeetingDateTimeText,l=e.useCalendarCallbacks;return a.createElement("div",{role:"list"},Object(V.a)(t,function(e,c){var s={meetingItem:e,isSmall:n,index:c,maxMeetingsToDisplay:t.length,showActionsInBody:!!r&&n,meetingArtifactsFetchingStatus:r?i:To.Failed,getMeetingDateTimeText:o,useCalendarCallbacks:l};return r?a.createElement(Dl,Ll({},s,{meetingList:t,key:c})):a.createElement(Al,Ll({},s,{key:c}))}))};Hl.displayName="CalendarTileBody";var Bl=function(){return(Bl=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Rl=function(e){var t=e.meetingList,n=e.calendarWithInsightsDesignStyles,r=e.headingLevel,i=e.imageUrl,o=e.livePersonaCard,l=e.onOrganizerProfileClick;if(Object(K.a)(t)>1)return a.createElement("div",{className:n.multiEntityCalendarHeader,role:"heading","aria-level":r},la());var c={heroCalendar:t[0],imageUrl:i,livePersonaCard:o,onOrganizerProfileClick:l};return a.createElement(Mo,Bl({},c))};Rl.displayName="CalendarTileHeader";var Ml=function(){return(Ml=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},zl=function(e){var t,n=e.meetingList,r=e.getMeetingDateTimeText,i=e.clientSize,o=e.getClientSizeCallback,l=e.getCalendarAnswerStyleOverrides,c=e.useCalendarCallbacks,s=e.setAnswerHeight,u=e.imageUrl,d=e.onOrganizerProfileClick,m=e.onDismiss,p=e.livePersonaCard,f=e.isDismissible,h=e.className,g=e.hasInsights,v=e.headingLevel,b=e.meetingArtifactsFetchingStatus,y=Ne(),O=e.maxMeetingsToShow||va.b,x=fa(n,O),S=be("HeroMultiEntityCalendarTile",va.q,i,o),C=S[0],j=S[1],k=null===(t=C.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){k&&s&&s(k)},[k]);var E="Small"===j,w=Pl(!!f,E,y),T=void 0;l&&(T=l(y,E).heroTileWrapper);if(Object(L.a)(n))return null;var I,A,N={body:(A={meetingList:x,isSmall:E,hasInsights:g,meetingArtifactsFetchingStatus:b,getMeetingDateTimeText:r,useCalendarCallbacks:c},a.createElement(Hl,Ml({},A))),header:(I={meetingList:n,calendarWithInsightsDesignStyles:w,headingLevel:v,imageUrl:u,livePersonaCard:p,onOrganizerProfileClick:d},a.createElement(Rl,Ml({},I))),isSmall:E,styleOverrides:function(){return{cardStyles:w.calendarContainer,headerStyles:w.tileHeaderOverride,bodyStyles:w.tileBodyOverride}},isDismissible:f,onDismiss:m,className:Je(h,T)};return a.createElement("div",{ref:C},a.createElement(et,Ml({},N)))};zl.displayName="HeroCalendarTileCard";var _l=Object(ye.a)(function(e,t){var n=e.palette.neutralLighterAlt;return Object(qe.t)({resultTypeDescription:[{fontSize:"14px",lineHeight:"20px"},{fontWeight:600,backgroundColor:n,height:"40px",display:"flex",alignItems:"center",paddingLeft:t?"52px":"72px",paddingRight:"12px",marginBottom:"1px"}]})}),Wl=function(e){var t=e.resultType,n=e.className,r=e.isSmall,i=e.headingLevel,o=Ne(),l=_l(o,r).resultTypeDescription;return a.createElement("div",{className:n},a.createElement("div",{className:l,role:"heading","aria-level":i},function(e){switch(e){case"Event":return Me();case"File":return ze();case"People":return _e();default:Object(s.a)(e)}}(t)),e.children)};Wl.displayName="HeroMultiEntityTile";var Ul=function(){return(Ul=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ql=function(e){var t,n=e.meetingList,r=e.getMeetingDateTimeText,i=e.clientSize,o=e.getClientSizeCallback,l=e.getCalendarAnswerStyleOverrides,c=e.useCalendarCallbacks,s=e.setAnswerHeight,u=e.isDismissible,d=e.className,m=e.hasInsights,p=e.headingLevel,f=e.meetingArtifactsFetchingStatus,h=Ne(),g=fa(n,e.maxMeetingsToShow||va.b),v=be("HeroMultiEntityCalendarTile",va.q,i,o),b=v[0],y=v[1],O=null===(t=b.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){O&&s&&s(O)},[O]);var x="Small"===y,S=Pl(!!u,x,h),C=void 0;l&&(C=l(h,x).heroTileWrapper);if(Object(L.a)(n))return null;var j;return a.createElement("div",{ref:b},a.createElement(Wl,{resultType:va.c,isSmall:x,headingLevel:p,className:m?Je(S.calendarContainer,C,d):void 0},(j={meetingList:g,isSmall:x,hasInsights:m,meetingArtifactsFetchingStatus:f,getMeetingDateTimeText:r,useCalendarCallbacks:c},a.createElement(Hl,Ul({},j)))))};ql.displayName="HeroMultiEntityCalendarTile";var Vl=n(392);function Kl(e){var t=Object(u.useSelector)(function(t){return Object(C.a)(t,e)}),n=Object(jn.c)(),r=Object(c.d)()?n||t:void 0;return!(!r||r===Vl.a.TOP)}var Yl=Object(ye.a)(function(e,t){var n,r=e.palette,i=r.neutralSecondary,a=r.neutralLighterAlt,o=r.themeDark,l=r.themeDarker,c=r.neutralDark,s=r.neutralPrimary;return Object(qe.t)({heroTileWrapper:{selectors:(n={},n["& .ms-search-calendarListItem .ms-search-calendarBody-ItemContent"]={padding:"0"},n["& .ms-search-calendarListItem .ms-search-calendarBody-ItemContent:hover"]={backgroundColor:a,cursor:"default"},n["& .ms-search-meeting-venue-classname"]={color:i},n["& ."+Wo]={marginRight:"4px",marginTop:"auto",marginBottom:"auto"},n["& ."+Wo]={margin:"auto 4px auto 0"},n["& ."+Wo+":hover"]={backgroundColor:o},n["& ."+Wo+":active"]={borderRadius:"4px",backgroundColor:l},n["& .ms-search-calendarTile-meetingTitle"]={color:c},n["& .ms-search-calender-meeting-detail-content-classname"]={padding:"12px 12px 12px 0",marginRight:"auto"},n["& .ms-search-meetingDateDayContainer"]={margin:"12px 16px 12px 12px"},n["& .ms-search-calendarTile-meetingTime"]={color:s},n["& .ms-search-calendarTile-moreDetailsContainer"]={width:t?void 0:"285px"},n["& .ms-search-calendarEntity-calendarCommandBar"]={display:t?"flex":"block",marginTop:"auto",marginBottom:"auto"},n)}})}),Ql=function(){return(Ql=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Gl=function(e){var t,n,r=e.className,i=Object(c.a)(),o=Object(c.b)(),l=Object(u.useSelector)(h.k),s=Object(E.a)(),d=Object(c.h)().additionalAnswerConfigs,m=null==i?void 0:i.setAnswerHeight,p=Object(c.i)(),f=null==d?void 0:d.answerBlockId,g=null==i?void 0:i.livePersonaCard,v=function(e){var t=Object(u.useSelector)(Lo.a),n=Object(E.a)(),r=Object(Ri.a)(t,e||Ho);return[a.useMemo(function(){var e=r&&r.filter(function(e){var t=function(e){var t=e.organizer,n=e.meetingStart,r=e.meetingEnd;return t.fullName&&t.email&&n&&r?{isValid:!0}:{isValid:!1,missingFields:(t.fullName?"":"organizer_fullName ")+(t.email?"":"organizer_email ")+(n?"":"meetingStart ")+(r?"":"meetingEnd ")}}(e),r=t.isValid,i=t.missingFields;return!r&&Object(w.e)(n,"Event entity dropped due to missing required fields",i),r});return e&&!Object(L.a)(e)||Object(w.e)(n,"Calendar Answer dropped due to missing required fields"),e},[JSON.stringify(r)]),r]}(),b=v[0],y=v[1],O=null==d?void 0:d.enableDwellStartLogging,x=Kl("Calendar"),S=se(b),C=Object(U.a)(b),j=null==C?void 0:C.organizer,k=(null==C?void 0:C.id)||"",T=(null==C?void 0:C.hexItemId)||"",I=Fo(C,{itemId:k,hexItemId:T},l),A=null==I?void 0:I.getProfilePhotoUrl,N=!!(null==d?void 0:d.enableMultiEntityCalendarAnswer)&&Object(K.a)(b)>1,P=N?"Hero_MeetingList_Impression":"Hero_SingleMeeting_Impression",F=null==d?void 0:d.enableCalendarInsights,D=(null==d?void 0:d.enableCalendarAnswerV2)||x,H=(null==d?void 0:d.enableCalendarAnswerV3)&&!x,B=An({entities:b,domain:"Calendar",isHero:!0,impressionEventId:P,intent:"CalendarEntry",groupReferenceId:f,clickEventId:"CalendarEvent_Organizer_Profile_Click",traceId:l,cardType:"Hero"}),R=(t=Object(u.useSelector)(Do.c),n=Object(u.useSelector)(Do.b),t?To.Pending:n?To.Success:To.Failed),M=Vn(N?void 0:null==j?void 0:j.email,A),z=function(e,t){return function(e,t,n){var r=Po(e,n),i=Po(t,n),a=ta({start:r.toUpperCase(),end:i.toUpperCase()}),o=po(e),l=po(t);return o!==l?ca({startDay:o,endDay:l,startTime:r.toUpperCase(),endTime:i.toUpperCase()}):ea({day:o,time:a})}(e,t,null==i?void 0:i.dateTimeFormatter)};a.useEffect(function(){var e;!S&&b&&C&&(null===(e=null==i?void 0:i.setAnswerBlockRendered)||void 0===e||e.call(i,B.placeholderId),O&&b.forEach(function(e){B.entityActions.onActionClick(e,"Display_Started")}))});if(!y||Object(L.a)(y))return Object(w.h)(s,"Unexpected Empty response received for Calendar"),null;if(!b||Object(L.a)(b)||!C)return null;var _=null==d?void 0:d.isAnswerDismissible,W=null==i?void 0:i.getCurrentClientSize,q=!!D||!!H,Y={meetingList:q?Object(V.a)(b,function(e){return Ql(Ql({},e),{insights:F?e.insights:void 0,artifacts:F?e.artifacts:void 0})}):b,clientSize:o,getMeetingDateTimeText:z,useCalendarCallbacks:function(e,t){return Fo(e,t,l)},headingLevel:p,maxMeetingsToShow:3,imageUrl:M,livePersonaCard:g,getClientSizeCallback:W,setAnswerHeight:m,onOrganizerProfileClick:B.entityActions.onEntityClick,isDismissible:_,className:r,hasInsights:q,meetingArtifactsFetchingStatus:F?R:To.Failed};if(D||H)return H&&Object(K.a)(b)>1?a.createElement(ql,Ql({},Y,{getCalendarAnswerStyleOverrides:Yl})):a.createElement(zl,Ql({},Y,{getCalendarAnswerStyleOverrides:Yl}));if(N)return a.createElement(ql,Ql({},Y));if(!C||!I)return null;var Q={heroCalendar:C,actionCallbacks:I,className:r,getMeetingDateTimeText:z,imageUrl:M,clientSize:o,setAnswerHeight:m,onOrganizerProfileClick:B.entityActions.onEntityClick,isDismissible:_};return a.createElement(tl,Ql({},Q))};Gl.displayName="HeroCalendarTileContainer";function $l(e,t){return e.map(function(n,r){var i,a;t&&e.length+r<t.length&&t[r]&&t[r].body&&t[e.length+r]&&t[e.length+r].body&&(i=t[r].body.getUrl,a=t[e.length+r].body.url);var o,l=n.fileExtension,c=n.fileName,s=n.fileSize,u=n.accessUrl,d=n.spoUniqueId,m=n.id,p=n.modifiedBy,f=n.modifiedByDisplayName,h=n.dateModified,g=n.userRelationshipType,v=n.fileType,b=n.subject,y=n.dateCreated,O=n.dateAccessed,x=n.sender,S=n.propertyHits,C=n.author,j=n.authorEmail,k=n.attachmentId,E=n.conversationId,w=n.itemId,T=n.sharingReferenceType,I=n.itemHexId,A=n.fileSourceType,N=n.sharingReferenceUrl;if(l&&c.toLowerCase().includes(l.toLowerCase())){var P=c.toLowerCase().lastIndexOf(l.toLowerCase())-1;o=c.slice(0,P)}else o=c;return{fileExtension:l,title:o,fileSize:s,accessUrl:u,spoUniqueId:d,id:m,mappingId:Object(Y.c)(n),modifiedBy:p,modifiedByDisplayName:f,dateModified:h,userRelationshipType:g,previewUrl:i,thumbnailUrl:a,fileType:v,subject:b,dateCreated:y,dateAccessed:O,sender:x,propertyHits:S,author:C,authorEmail:j,attachmentId:k,conversationId:E,itemId:w,sharingReferenceType:T,fileName:c,itemHexId:I,fileSourceType:A,sharingReferenceUrl:N}})}function Jl(e,t){var n;if(t)try{n=$l(e,t.responses.sort(function(e,t){return e.id.valueOf()-t.id.valueOf()}))}catch(t){n=$l(e)}else n=$l(e);return n}var Zl=n(302),Xl=3;function ec(e){var t=Object(u.useSelector)(Zl.a),n=Object(E.a)(),r=Object(Ri.a)(t,e||Xl);return[a.useMemo(function(){var e=r&&r.filter(function(e){var t,r,i,a,o=(r=(t=e).accessUrl,i=t.fileName,a=t.fileType,r&&i&&a?{isValid:!0}:{isValid:!1,missingFields:(r?"":"accessUrl ")+(i?"":"fileName ")+(a?"":"fileType ")}),l=o.isValid,c=o.missingFields;return!l&&Object(w.e)(n,"File entity dropped due to missing required fields",c),l});return e&&!Object(L.a)(e)||Object(w.e)(n,"File Answer dropped due to missing required fields"),e},[JSON.stringify(r)]),r]}var tc=function(){return(tc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},nc="Hero";var rc,ic,ac,oc,lc=n(406),cc=n(266),sc=(Object(ye.a)(function(e){var t=e.palette,n=t.blue,r=t.neutralLight;return Object(qe.t)({commandBarItem:{display:"none"},shareButton:{color:n,height:"28px",width:"28px",float:"left",marginRight:"5px",selectors:{":hover":{backgroundColor:r,color:n}}},commandbar:{float:"left"},appLogo:{height:"16px",width:"16px"}})}),Object(ye.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,minWidth:"28px",maxWidth:"28px",height:"28px",border:"none"}})}),Object(ye.a)(function(){return Object(qe.t)({root:{paddingLeft:"10px",paddingRight:"10px",height:"45px"}})}),Object(ye.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,float:"right",paddingRight:"0px",paddingLeft:"0px"}})}),Object(ye.a)(function(e){var t=e.palette.blue;return Object(qe.t)({root:{color:t}})}),Object(ye.a)(function(){return Object(qe.t)({root:{height:"16px",width:"16px"}})}),Object(ye.a)(function(e){var t=e.palette.neutralSecondary;return Object(qe.t)({root:{color:t}})}),Object(ye.a)(function(){return Object(qe.t)({root:{display:"block"}})}),n(264));function uc(e){return e+"?web=1"}function dc(e,t,n,r,i){var a=function(e){i&&e?i(e):window.open(e,"_blank"),r&&r()};return Object(V.a)(e,function(e,r){var i=function(e,t){if(t>e.length)return;return e.slice(0,t+1).join("/")}(t,r+n);return{key:e,text:decodeURIComponent(e),onClick:function(e){null==e||e.stopPropagation(),a(i)},onKeyPress:function(e){null==e||e.stopPropagation(),a(i)}}})}function mc(e,t,n,r,i){void 0===i&&(i=new Date);var a=i.getTime(),o=new Date(t),l=a-o.getTime(),c=Math.floor(l/at.c),s=Object(cc.a)(o,i);if("Link"===e||"Attachment"===e)return Object(it.l)(i,o)?r?Object(sc.s)({name:n}):Object(sc.r)({name:n}):Object(lt.p)(o,i)?r?Object(sc.u)({name:n}):Object(sc.t)({name:n}):c<i.getDay()?r?Object(sc.o)({name:n,day:Object(lc.a)(o.getDay())}):Object(sc.n)({name:n,day:Object(lc.a)(o.getDay())}):c<at.w/at.c+i.getDay()?r?Object(sc.m)({name:n}):Object(sc.l)({name:n}):o.getMonth()===i.getMonth()&&o.getFullYear()===i.getFullYear()?r?Object(sc.q)({name:n}):Object(sc.p)({name:n}):r?Object(sc.o)({name:n,day:s}):Object(sc.n)({name:n,day:s});var u=new Date(t),d=new Date,m=Object(cc.b)(u,d),p=Object(sc.B)(m,n,r);return m?p:yc(p)}function pc(e,t,n,r){var i,a,o,l,c,s,u=e.fileType,d=e.sender,m=e.dateCreated,p=e.modifiedByDisplayName,f=e.dateModified,h=e.modifiedBy,g=e.propertyHits,v=e.author,b=e.authorEmail,y=function(){if(u&&d&&m){var e=d.emailAddress,p=e.name,f=e.address;l=f,c=p,s="Sender",p&&(fc(l,t,n)?(a=yc(a=mc(u,m,Object(sc.fb)(),r)),o=[a]):(a=mc(u,m,i=p,r),o=a.split(i)))}};return Object(D.a)(g,"EmailSenderName")&&d&&m?y():v&&g&&Object(D.a)(g,"Author")?(c=v,s="Author",fc(l=b,t,n)?(a=yc(a=Object(sc.a)({name:Object(sc.fb)()})),o=[a]):(a=Object(sc.a)({name:v}),i=v,o=a.split(i))):("Attachment"===u||"Link"===u)&&d&&m?y():("File"===u||"Folder"===u)&&p&&f&&(l=h,c=p,s="Modifier",fc(h,t,n)?(a=yc(a=mc(u,f,Object(sc.fb)())),o=[a]):(a=mc(u,f,p),o=a.split(p),i=p)),{connectionName:i,headerString:a,headerStringSplits:o,connectionEmail:l,personFullName:c,relation:s}}function fc(e,t,n){return(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase())||(null==n?void 0:n.toLowerCase())===(null==e?void 0:e.toLowerCase())}function hc(e,t,n){return!!n&&("File"===e||"Attachment"===e&&"ClassicAttachment"===t)}function gc(e,t,n){return!!n&&("Link"===e||"File"===e||"Folder"===e||"Attachment"===e&&"ClassicAttachment"!==t)}function vc(e,t){return!!e&&!!t}function bc(e,t,n,r){if(e)switch(e){case"Mail":return function(e,t){if(t)return Object(sc.i)({title:e||Object(sc.D)()});return Object(sc.j)({title:e||Object(sc.D)()})}(t,r);case"Teams":return function(e,t,n){if(e)return n?Object(sc.db)({chat:e}):Object(sc.X)({chat:e});if(t)return n?Object(sc.db)({chat:t}):Object(sc.Y)({name:t});return Object(sc.X)({chat:Object(sc.D)()})}(t,n,r);case"CalendarEvent":return function(e,t){if(e)return t&&Object(sc.C)({title:e}),Object(sc.W)({title:e});return}(t,r);default:return}}function yc(e){var t;return(null===(t=e[0])||void 0===t?void 0:t.toUpperCase())+e.substr(1)}function Oc(e,t,n,r,i,a){var o;if(null==t||t.stopPropagation(),"Attachment"===e.fileType){var l="ClassicAttachment"!==e.fileSourceType;null==r||r({attachmentId:null===(o=e.attachmentId)||void 0===o?void 0:o.id},l)}a?a(e.accessUrl):window.open(e.accessUrl),null==i||i(e,n)}function xc(e,t,n,r,i){null==t||t.stopPropagation();var a=uc(e.accessUrl);null==r||r(a),null==i||i(e,n)}function Sc(e,t,n,r,i,a){var o,l=e.fileType,c=e.sharingReferenceType,s=uc(e.accessUrl);null==t||t.stopPropagation(),"Attachment"===l&&"Mail"===c&&(null==i||i(null===(o=e.attachmentId)||void 0===o?void 0:o.id)),("Link"===l||"File"===l||"Folder"===l||"Teams"===c)&&(null==a||a(s)),null==r||r(e,n)}!function(e){e[e.docx=0]="docx",e[e.doc=1]="doc"}(rc||(rc={})),function(e){e[e.pptx=0]="pptx",e[e.ppt=1]="ppt",e[e.pot=2]="pot",e[e.potx=3]="potx",e[e.potm=4]="potm",e[e.ppam=5]="ppam",e[e.ppsx=6]="ppsx",e[e.ppsm=7]="ppsm",e[e.sldx=8]="sldx",e[e.sldm=9]="sldm",e[e.ppa=10]="ppa",e[e.pps=11]="pps",e[e.pptm=12]="pptm",e[e.powerpoint=13]="powerpoint"}(ic||(ic={})),function(e){e[e.xls=0]="xls",e[e.xlsx=1]="xlsx",e[e.xlb=2]="xlb",e[e.xlc=3]="xlc",e[e.xlsb=4]="xlsb",e[e.xlsm=5]="xlsm",e[e.xlt=6]="xlt",e[e.xltx=7]="xltx",e[e.xltm=8]="xltm",e[e.xlm=9]="xlm",e[e.xla=10]="xla",e[e.xll=11]="xll",e[e.xlam=12]="xlam",e[e.xlw=13]="xlw",e[e.excel=14]="excel",e[e.csv=15]="csv"}(ac||(ac={})),function(e){e[e.one=0]="one",e[e.note=1]="note"}(oc||(oc={}));var Cc=Object(ye.a)(function(){return Object(qe.t)({headerContent:["ms-search-fileTile-headerContent",{fontSize:"14px",lineHeight:"24px",verticalAlign:"middle",display:"flex",flexDirection:"row",overflow:"hidden"}],senderFullName:{fontWeight:"600"},answerTitle:["ms-search-fileTile-answerTitle",Jt,{fontWeight:"400",fontSize:"14px",paddingLeft:"8.75px"}],profilePhoto:{float:"left"}})}),jc=function(){return(jc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},kc=function(e){var t=e.file,n=e.profilePictureUrl,r=e.userEmail,i=e.userUpn,o=e.livePersonaCard,l=e.onProfileClick,c=t.fileType,s=t.sender,u=t.dateCreated,d=t.modifiedByDisplayName,m=t.dateModified,p=a.useState(!1),f=p[0],h=p[1],g=Cc(),v=g.headerContent,b=g.profilePhoto,y=g.answerTitle,O=g.senderFullName,x=Kt(n);if(!(("File"!==c||d&&m)&&("Link"!==c&&"Attachment"!==c||s&&s.emailAddress&&s.emailAddress.name&&u)))return null;var S=pc(t,r,i),C=S.connectionName,j=S.headerString,k=S.headerStringSplits,E=S.connectionEmail,w=S.personFullName,T=S.relation;if(!k)return null;var I={imageUrl:x?n:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(Yt.a)(w,!1),initialsColor:Object(Qt.a)({text:w})},A=Ze(o,w,E),N=a.createElement("div",{className:b,role:o?"button":void 0,onClick:o?function(){return T&&(null==l?void 0:l(T))}:void 0,onKeyPress:o?function(){return T&&(null==l?void 0:l(T))}:void 0},a.createElement(Gt.a,jc({},I))),P=A?a.createElement(A,null,N):N,F=a.createElement("span",{className:O,role:o?"button":void 0,onClick:o?function(){return T&&(null==l?void 0:l(T))}:void 0,onKeyPress:o?function(){return T&&(null==l?void 0:l(T))}:void 0},C),D=A?a.createElement(A,null,F):F;return a.createElement("div",{className:v},P,a.createElement("div",{className:y,title:f?j:void 0,role:"presentation","aria-label":j,onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;h(n!==r)}(e)}},k[0],a.createElement("span",{className:O},D),k[1]))},Ec=Object(ye.a)(function(e){return Object(qe.t)({fileTypeIcon:{flexShrink:0,flexGrow:0,width:e+"px",height:e+"px"}})});function wc(e){if(e)switch(e){case"Folder":case"WebPage":return vl.FileIconType.folder;default:return Object(s.a)(e)}}var Tc=function(e){var t=e.fileExtension,n=e.fileType,r=e.iconSize,o=e.className,l=Object(vl.getFileTypeIconProps)({extension:t,size:r||32,type:wc(n)}),c=Ec(r||32).fileTypeIcon+" "+o;return a.createElement(Mt.a,Object(i.__assign)({role:"presentation"},l,{className:c,"aria-hidden":!0}))},Ic=n(509),Ac=Object(ye.a)(function(e,t,n){var r=e.palette,i=r.neutralDark,a=r.neutralLighter;return Object(qe.t)({breadcrumbContainer:{display:"flex",height:"20px",marginRight:t?"0":"16px"},folderInfoContainer:["ms-search-folderInfoContainer",Jt,{marginRight:t?"0":"16px"}],folderInfo:["ms-search-folderInfo",{color:i,fontWeight:"400",fontSize:14}],breadcrumbSource:{fontSize:14,color:i,height:"20px",paddingRight:"4px"},folder:[Jt,"ms-search-file-breadCrumbFolder",{fontSize:14,color:i,maxWidth:t?"120px":"150px",height:"20px",selectors:{"&:hover":{background:n?void 0:a,textDecoration:"underline"},cursor:"Pointer"}}],overflowIcon:{margin:"-5px 0 0 0",height:"20px"},chevron:{margin:"5px 5px",height:"20px",fontSize:"10px"}})}),Nc=function(e){var t=e.items,n=e.overflowTitle,r=e.isSmall,i=e.fileSourceType,o=e.displayBreadcrumbSource,l=e.showSingleFolderString,c=Ne(),s=Ac(c,r,l),u=s.folder,d=s.overflowIcon,m=s.chevron,p=s.breadcrumbContainer,f=t[0],h=t[t.length-1],g=t.length>2;if(l){var v=function(e,t,n){return"SharepointOnline"===e?n?Object(sc.Z)({folder:t}):Object(sc.A)({folder:t}):"OneDriveForBusiness"===e?n?Object(sc.F)({folder:t}):Object(sc.z)({folder:t}):void 0}(i,h.text,l),b=null==v?void 0:v.split(h.text);return b?a.createElement("div",{className:s.folderInfoContainer,title:v},a.createElement("span",{className:s.folderInfo},b[0]),a.createElement("span",{role:"Link",tabIndex:0,title:h.text,onClick:h.onClick,onKeyPress:h.onKeyPress,className:u},h.text),a.createElement("span",null,b[1])):null}var y="OneDriveForBusiness"===i?Object(sc.E)():Object(sc.V)();return a.createElement("div",{className:p},o&&a.createElement("div",{className:s.breadcrumbSource},y),a.createElement("div",{role:"Link",onClick:f.onClick,onKeyPress:f.onKeyPress,tabIndex:0,title:f.text,className:u},f.text),a.createElement(Mt.a,{iconName:"ChevronRightMed",className:m}),g&&a.createElement(a.Fragment,null,a.createElement("span",{title:n,className:d,role:"presentation",onClick:function(e){e.stopPropagation()}},"..."),a.createElement(Mt.a,{iconName:"ChevronRightMed",className:m})),a.createElement("div",{role:"Link",tabIndex:0,title:h.text,onClick:h.onClick,onKeyPress:h.onKeyPress,className:u},h.text))},Pc=function(e){var t=e.accessUrl,n=e.minFolderPath,r=e.maxFolderPath,i=e.isSmall,o=e.fileSourceType,l=e.showSingleFolderString,c=e.displayBreadcrumbSource,s=e.onMalformedURLError,u=e.onBreadcrumbclick,d=e.openLink,m=a.useRef(null),p=t.split("/");if(p.length<=n+2)return null;var f,h,g=Math.max(n,p.length-(r||p.length+1)-1),v=Object(Ic.a)(p,g,p.length-1);try{f=v.map(function(e){return decodeURIComponent(e)}).join(" > "),h=dc(v,p,g,u,d)}catch(e){return null==s||s("FolderBreadCrumb"),null}return a.createElement("div",{ref:m},a.createElement(Nc,{items:h,isSmall:!!i,overflowTitle:f,fileSourceType:o,displayBreadcrumbSource:c,showSingleFolderString:l}))},Fc=Object(ye.a)(function(e){var t,n=e.palette,r=n.neutralDark,i=n.white,a=n.neutralLight,o=n.neutralSecondary;return Object(qe.t)({actionContainer:{height:"32px",marginTop:"-5px",paddingRight:"8px",borderRadius:"3px",display:"flex",minWidth:"100px"},icon:{height:"20px",width:"20px",margin:"5px 0 10px 12px",color:r,selectors:(t={"&:hover .ms-Button-icon":{color:r,backgroundColor:a,borderRadius:"2px"},"&:active .ms-Button-icon":{color:r}},t["& .ms-Button-icon"]={color:o,fontSize:"16px",margin:"0",padding:"4px"},t["& .ms-ContextualMenu-icon"]={color:o},t)},disabledIcon:{opacity:"40%",selectors:{":hover":{background:i}}}})}),Dc=function(e){var t=e.file,n=e.index,r=e.onFileShareClick,i=e.shareByEmail,o=e.composeEmail,l=e.onFileCopyLinkClick,c=e.onFileDownloadClick,s=e.downloadAttachment,u=e.copyLink,d=e.openLink,m=t.fileType,p=t.fileSourceType,f=Ne();if(!vc(i,o)&&!hc(m,p,s)&&!gc(m,p,u))return null;var h=Fc(f),g=vc(i,o),v=hc(m,p,s),b=gc(m,p,u),y=Je(h.icon,h.disabledIcon);return a.createElement("div",{className:h.actionContainer},a.createElement(Fe.a,{iconProps:{iconName:"Share"},title:g?Object(sc.U)():Object(sc.h)({action:Object(sc.U)()}),onClick:g?function(e){return Sc(t,e,n,r,i,o)}:function(e){return e.stopPropagation()},className:g?h.icon:y}),a.createElement(Fe.a,{iconProps:{iconName:"Download"},title:v?Object(sc.k)():Object(sc.h)({action:Object(sc.k)()}),onClick:v?function(e){return Oc(t,e,n,s,c,d)}:function(e){return e.stopPropagation()},className:v?h.icon:y}),a.createElement(Fe.a,{iconProps:{iconName:"PageLink"},title:b?Object(sc.b)():Object(sc.h)({action:Object(sc.b)()}),onClick:b?function(e){return xc(t,e,n,u,l)}:function(e){return e.stopPropagation()},className:b?h.icon:y}))},Lc=Object(ye.a)(function(e){var t,n=e.palette,r=n.neutralDark,i=n.neutralLight,a=n.neutralSecondary;return Object(qe.t)({commandbar:{marginLeft:"5px",marginTop:"5px",alignItems:"center",float:"right",padding:"0"},iconButton:{height:"36px",minWidth:"20px",selectors:(t={"&:hover .ms-Button-icon":{color:r,backgroundColor:i,borderRadius:"2px"},"&:active .ms-Button-icon":{color:r}},t["& .ms-Button-icon"]={color:a,fontSize:"16px",margin:"0",padding:"4px"},t["& .ms-ContextualMenu-icon"]={color:a},t)}})}),Hc=Object(ye.a)(function(){return Object(qe.t)({root:{padding:"0",minWidth:"30px",height:"40px"}})}),Bc=(Object(ye.a)(function(){return Object(qe.t)({root:{height:"100%",padding:"0"}})}),Object(ye.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,minWidth:"20px",maxWidth:"20px",height:"28px",border:"none"}})}),Object(ye.a)(function(e){var t=e.palette.white;return Object(qe.t)({root:{background:t,float:"right",height:"100%",padding:"0"}})})),Rc=function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e},Mc=function(e){var t=e.file,n=e.index,r=e.onFileShareClick,i=e.shareByEmail,o=e.composeEmail,l=e.onFileCopyLinkClick,c=e.onFileDownloadClick,s=e.downloadAttachment,u=e.copyLink,d=e.openLink,m=t.fileType,p=t.fileSourceType,f=Ne();if(!vc(i,o)&&!hc(m,p,s)&&!gc(m,p,u))return null;var h=Lc(f),g={text:Object(sc.k)(),key:Object(sc.k)(),onClick:function(e){return Oc(t,e,n,s,c,d)},iconProps:{iconName:"Download"},className:h.iconButton},v={text:Object(sc.U)(),key:Object(sc.U)(),onClick:function(e){return Sc(t,e,n,r,i,o)},iconProps:{iconName:"Share"},className:h.iconButton},b={text:Object(sc.b)(),key:Object(sc.b)(),onClick:function(e){return xc(t,e,n,u,l)},iconProps:{iconName:"PageLink"},className:h.iconButton},y=Rc(Rc(Rc([],vc(i,o)?[v]:[]),hc(m,p,s)?[g]:[]),gc(m,p,u)?[b]:[]);return a.createElement(rl.a,{styles:Bc(f),items:[],overflowItems:y,className:h.commandbar,overflowButtonProps:{menuIconProps:{iconName:"MoreVertical"},styles:Hc()}})},zc=Object(ye.a)(function(e,t,n,r,i,a,o,l,c,s){var u=e.palette,d=u.neutralDark,m=u.neutralSecondary,p=u.white,f=u.neutralLight,h=u.neutralLighterAlt,g=u.neutralQuaternaryAlt;return Object(qe.t)({fileContainer:["ms-search-fileTile-fileContainer",{backgroundColor:p,height:t?"auto":"40px",borderBottom:l?void 0:i?"none":"1px solid",borderColor:f,selectors:{"&:hover":{backgroundColor:h,selectors:{".ms-CommandBar-overflowButton":{backgroundColor:h},".ms-CommandBar-overflowButton:hover":{backgroundColor:g}}}}}],fileCard:["ms-search-fileTile-fileCard",{height:t?"auto":"39px",display:t?"flex":"block",padding:t?"8px 0 12px 0":"0",margin:t?l?"0 5px 0 12px":"0 12px":"0 32px",borderBottom:l?i?"none":"1px solid":void 0,borderColor:f}],fileInfoContainer:{width:o?"calc(100% - 75px)":"calc(100% - 40px)",float:"left",height:t?"auto":"30px",display:t?"block":"flex",marginTop:t?"0":"10px"},fileNameContainer:["ms-search-fileTile-fileNameContainer",{height:"20px",float:"left",width:t?"100%":"240px",marginRight:t?"0":"25px"}],titleText:["ms-search-fileTile-titleText",Jt,{color:d,float:"left",width:t?"100%":"240px",fontSize:a?14:17,fontWeight:"600",display:"inline-block",selectors:{"&:hover":{textDecoration:"none",color:d}}}],folderBreadcrumb:{width:n&&t?"calc(100% - 65px)":"100%",float:"left"},emailSubject:["ms-search-fileTile-emailSubject",Jt,{color:d,fontWeight:"400",fontSize:14,display:"flex",height:"20px",float:"left",width:t&&n?"calc(100% - 65px)":"100%",maxWidth:t?void 0:"400px",marginRight:t?"0":"16px"}],sourceSubject:[Jt,{marginLeft:s?"0":"3px",selectors:{":hover":{textDecoration:c?"underline":"none"}}}],fileIcon:[Li,{float:"left",marginRight:"12px",marginTop:t?"0":"4px",height:"auto",selectors:{"> img":{height:"28px",width:"28px",marginTop:"2px"}}}],fileIconContainer:{width:"40px",height:"100%",float:"left"},tertiaryInfo:["ms-search-file-tertiaryInfo",Jt,{fontWeight:"400",maxWidth:s?"300px":void 0,fontSize:14,height:"20px",width:t&&n&&!r?"calc(100% - 65px)":"100%",color:m,float:"left",paddingRight:s&&!t?"10px":void 0}],actionContainer:{width:"55px",float:"left",fontSize:12,display:"inline-block"},sizeInfo:{width:"55px",float:"right",fontSize:12,textAlign:"right",color:m},sizeContainer:{flex:"auto"},sourceContainer:{width:a||t?s&&!t?"calc(100% - 683px)":void 0:"calc(100% - 373px)"}})}),_c=function(){return(_c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Wc=function(e){var t=e.file,n=e.index,r=e.isSmall,i=e.userEmail,o=e.userUpn,l=e.showActions,c=e.numberOfFiles,s=e.showConnection,u=e.showSameLargeView,d=e.showSourceAtBottom,m=e.enableFileSourceClick,p=e.displayBreadcrumbSource,f=e.showShortenedConnection,h=e.onFileShareClick,g=e.onFileSourceClick,v=e.shareByEmail,b=e.composeEmail,y=e.onFileCopyLinkClick,O=e.onFileDownloadClick,x=e.downloadAttachment,S=e.copyLink,C=e.onFileClick,j=e.openAttachmentInClient,k=e.onFolderBreadcrumbClick,E=e.onMalformedURLError,w=e.openLink,T=t.fileExtension,I=t.accessUrl,A=t.title,N=t.subject,P=t.fileType,F=t.attachmentId,D=t.itemId,L=(t.fileSize,t.sharingReferenceType),H=t.itemHexId,B=t.fileName,R=t.sharingReferenceUrl,M=t.sender,z=t.fileSourceType,_=Ne(),W=a.useState(!1),U=W[0],q=W[1],V=a.useState(!1),K=V[0],Y=V[1],Q=function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;Y(n!==r)},G=bc(L,N,null==M?void 0:M.emailAddress.name,m),$=N||("Teams"===L&&(null==M?void 0:M.emailAddress.name)?null==M?void 0:M.emailAddress.name:Object(sc.D)()),J=null==G?void 0:G.split($),Z=!!G||"File"===P,X=!(!l||!r||!(v||b||x||S)),ee=zc(_,r||!!u,!1,Z,n===c-1,1!==c,X,!!l,!!(m&&R),d),te=ee.titleText,ne=ee.fileIcon,re=ee.fileInfoContainer,ie=ee.folderBreadcrumb,ae=ee.fileIconContainer,oe=ee.fileNameContainer,le=ee.tertiaryInfo,ce=ee.emailSubject,se=ee.fileCard,ue=ee.fileContainer,de=(ee.sizeInfo,ee.sizeContainer,uc(I)),me=pc(t,i,o,f).headerString,pe=function(){var e={itemId:null==D?void 0:D.id,accessUrl:de,attachmentId:null==F?void 0:F.id,hexItemId:H,attachmentName:B,fileType:P};j&&F&&D&&"Attachment"===P&&L&&"Mail"===L?j(e):j&&L&&"Mail"===L?j(e):w?w(de):window.open(de),C(t,n)};var fe={accessUrl:I,isSmall:r,minFolderPath:4,fileSourceType:z,displayBreadcrumbSource:p,onBreadcrumbclick:function(){k&&k(t,n)},onMalformedURLError:E,openLink:w},he={file:t,index:0,onFileShareClick:h,shareByEmail:v,composeEmail:b,onFileCopyLinkClick:y,onFileDownloadClick:O,copyLink:S,downloadAttachment:x,openLink:w};function ge(e){R&&m&&(null==e||e.stopPropagation(),w?w(R):window.open(R,"_blank"),null==g||g(t,n,L))}var ve=he,be="Attachment"===P?"button":"link",ye="File"!==P?G:sc.y,Oe=(Object(sc.eb)({type:T})+" "+B+" "+ye+" "+me).substring(0,512);function xe(){return a.createElement("div",{className:le,role:"tooltip",onMouseOver:function(e){return Q(e)},title:K?me:void 0},me)}return a.createElement("div",{className:ue,tabIndex:0,role:"listitem",onKeyPress:function(){return pe()},onClick:pe,"aria-posinset":n+1,"aria-setsize":c},a.createElement("div",{role:be,className:se},a.createElement("div",{className:ae,"aria-label":Oe,"aria-hidden":!1},a.createElement(Tc,{className:ne,fileExtension:T})),a.createElement("div",{className:re},a.createElement("div",{className:oe},a.createElement("div",{className:te,role:"presentation",onMouseOver:function(e){return function(e){var t=e.currentTarget,n=t.clientWidth,r=t.scrollWidth;q(n!==r)}(e)},title:U?A:void 0},A)),me&&d&&s&&xe(),a.createElement("div",{className:ee.sourceContainer},"File"===P&&a.createElement("div",{className:ie},a.createElement(Pc,_c({},fe))),"File"!==P&&G&&Z&&J&&a.createElement("div",{className:ce,role:"Tooltip",title:G},a.createElement("span",null,J[0]),a.createElement("span",{className:ee.sourceSubject,role:m?"link":"tooltip",tabIndex:m?0:-1,onClick:function(e){return ge(e)},onKeyPress:function(e){return we(e,ge)}},$),a.createElement("span",null,J[1])),!1),me&&!d&&s&&xe(),l&&!X&&a.createElement(Dc,_c({},he)),!1),X&&a.createElement(Mc,_c({},ve))))};Wc.displayName="FileEntity";var Uc=Object(ye.a)(function(e,t){var n;return Object(qe.t)({fileContainer:{selectors:(n={},n["& .ms-search-fileTile-fileNameContainer"]={height:"25px"},n["& .ms-search-fileTile-fileCard"]={margin:"0",padding:"0 0 8px 0"},n["& .ms-search-fileTile-fileContainer:hover"]={backgroundColor:e.palette.white,cursor:"pointer"},n)},bodyStyleOverride:{margin:"0",padding:"8px "+(t?12:24)+"px"}})}),qc=function(){return(qc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Vc=function(e){var t,n=e.file,r=e.clientSize,i=e.profilePictureUrl,o=e.userEmail,l=e.userUpn,c=e.className,s=e.isDismissible,u=e.showActions,d=e.showSourceAtBottom,m=e.enableFileSourceClick,p=e.displayBreadcrumbSource,f=e.showShortenedConnection,h=e.onFileClick,g=e.onFileSourceClick,v=e.livePersonaCard,b=e.onMalformedURLError,y=e.openAttachmentInClient,O=e.setAnswerHeight,x=e.openLink,S=e.onFolderBreadcrumbClick,C=e.onProfileClick,j=e.onDismiss,k=e.onFileShareClick,E=e.shareByEmail,w=e.composeEmail,T=e.onFileCopyLinkClick,I=e.onFileDownloadClick,A=e.copyLink,N=e.downloadAttachment,P=n.thumbnailUrl,F=be("HeroFileTile",752,r),D=F[0],L=F[1],H=Ne(),B=null===(t=D.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){B&&O&&O(B)},[B]);var R,M="Small"===L,z={file:n,profilePictureUrl:i,userEmail:o,userUpn:l,livePersonaCard:v,onProfileClick:C},_={headerImageUrl:P,imagePosition:M?void 0:"Right",imageHeight:"100%",imageWidth:"185px"},W=Uc(H,M),U={body:(R={file:n,index:0,isSmall:M,userEmail:o,userUpn:l,numberOfFiles:1,showConnection:!1,showSameLargeView:!u,showActions:u,enableFileSourceClick:m,displayBreadcrumbSource:p,showSourceAtBottom:d,showShortenedConnection:f,onFileShareClick:k,shareByEmail:E,onFileSourceClick:g,composeEmail:w,onFileCopyLinkClick:T,onFileDownloadClick:I,copyLink:A,downloadAttachment:N,onFileClick:h,openAttachmentInClient:y,onFolderBreadcrumbClick:S,onMalformedURLError:b,openLink:x},a.createElement(Wc,qc({key:"File0"},R))),header:a.createElement(kc,qc({},z)),isSmall:M,imageProps:_,styleOverrides:function(){return{cardStyles:M||u?void 0:"ms-search-maxContent",bodyStyles:W.bodyStyleOverride}},className:c,isDismissible:s,onDismiss:j};return a.createElement("div",{className:W.fileContainer,ref:D},a.createElement(et,qc({},U)))};Vc.displayName="HeroFileTile";var Kc=function(){return(Kc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Yc=function(e){var t=e.files,n=e.userEmail,r=e.userUpn,i=e.showActions,o=e.isSmall,l=e.showSourceAtBottom,c=e.enableFileSourceClick,s=e.displayBreadcrumbSource,u=e.showShortenedConnection,d=e.onFileClick,m=e.onFileSourceClick,p=e.onMalformedURLError,f=e.openAttachmentInClient,h=e.onFolderBreadcrumbClick,g=e.openLink,v=e.onFileShareClick,b=e.shareByEmail,y=e.composeEmail,O=e.onFileCopyLinkClick,x=e.onFileDownloadClick,S=e.copyLink,C=e.downloadAttachment;if(!t)return null;var j=t.length;return a.createElement(a.Fragment,null,t.map(function(e,t){var k={file:e,index:t,isSmall:!!o,userEmail:n,userUpn:r,numberOfFiles:j,showActions:i,showSourceAtBottom:l,enableFileSourceClick:c,showConnection:!0,displayBreadcrumbSource:s,showShortenedConnection:u,onFileClick:d,onFileSourceClick:m,openAttachmentInClient:f,onFolderBreadcrumbClick:h,onMalformedURLError:p,openLink:g,onFileShareClick:v,shareByEmail:b,composeEmail:y,onFileCopyLinkClick:O,onFileDownloadClick:x,copyLink:S,downloadAttachment:C};return a.createElement(Wc,Kc({key:"File"+t},k))}))};Yc.displayName="MultiEntityFileBody";var Qc=function(){return(Qc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Gc=function(e){var t,n=e.files,r=e.clientSize,i=e.headingLevel,o=e.className,l=e.getClientSizeCallback,c=e.setAnswerHeight,s=be("HeroMultiEntityFileTile",752,r,l),u=s[0],d=s[1],m=null===(t=u.current)||void 0===t?void 0:t.offsetHeight;if(a.useEffect(function(){m&&c&&c(m)},[m]),!n)return null;var p,f="Small"===d;return a.createElement("div",{ref:u,className:o,role:"list"},a.createElement(Wl,{resultType:"File",isSmall:f,headingLevel:i},(p=e,a.createElement(Yc,Qc({},p,{isSmall:f})))))};Gc.displayName="HeroMultiEntityFileTile";var $c=Object(ye.a)(function(e){var t,n;return Object(qe.t)({tileBodyOverride:["ms-search-tile-body"],tile:{selectors:(t={},t["& .ms-search-tile-body"]={margin:"0",padding:"0"},t)},tileHeader:{padding:0},multiEntityFileHeader:["ms-search-fileTile-multiEntityHeader",Jt,{fontWeight:"600",fontSize:14}],multiEntityFileBody:["ms-search-multiEntityFileBody",{selectors:(n={},n["& .ms-search-fileTile-fileContainer:hover"]={backgroundColor:e.palette.white},n["& .ms-search-fileTile-fileContainer"]={cursor:"pointer"},n["& .ms-search-heroTile-headerContainer"]={margin:"0",padding:"8px 24px"},n)}]})}),Jc=function(){return(Jc=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Zc=function(e){var t,n=e.className,r=e.isDismissible,i=e.headingLevel,o=e.clientSize,l=e.getClientSizeCallback,c=e.onDismiss,s=e.setAnswerHeight,u=be("HeroMultiEntityFileTile",752,o,l),d=u[0],m=u[1],p=null===(t=d.current)||void 0===t?void 0:t.offsetHeight,f="Small"===m;a.useEffect(function(){p&&s&&s(p)},[p]);var h,g=Ne(),v=$c(g),b=$c(g),y={body:(h=e,a.createElement(Yc,Jc({},h,{isSmall:f}))),header:a.createElement("div",{className:v.multiEntityFileHeader,role:"heading","aria-level":i},Object(sc.w)()),isSmall:f,styleOverrides:function(){return{bodyStyles:v.tileBodyOverride,cardStyles:v.tile}},className:Je(n,b.multiEntityFileBody),isDismissible:r,onDismiss:c};return a.createElement("div",{ref:d,role:"list"},a.createElement(et,Jc({},y)))};Zc.displayName="HeroMultiEntityFileTileCard";var Xc=Object(ye.a)(function(e){var t,n=e.palette.neutralLighterAlt;return Object(qe.t)({fileEntityHover:{selectors:(t={},t["&.ms-search-multiEntityFileBody .ms-search-fileTile-fileContainer:hover"]={backgroundColor:n},t["&.ms-search-multiEntityFileBody .ms-search-fileTile-fileContainer"]={cursor:"default"},t)}})}),es=function(){return(es=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ts=function(e){var t=e.className,n=ec(),r=n[0],i=n[1],o=Ne(),l=se(r),s=Object(ie.a)(),u=Object(c.h)().additionalAnswerConfigs,d=s.clientActionCallbacks,m=s.logger,p=Object(c.i)(),f=function(){var e=Object(ie.a)(),t=Object(c.c)(),n=Object(c.h)().additionalAnswerConfigs,r=e.clientActionCallbacks,i=e.logger,o=er(),l=tr(),s=Object(c.b)(),u=ec(),d=u[0],m=(u[1],Jl(d)),p=null==r?void 0:r.openAttachmentInClient,f=null==r?void 0:r.shareByEmail,h=null==r?void 0:r.composeEmail,g=null==r?void 0:r.openLink,v=null==r?void 0:r.downloadAttachment,b=null==r?void 0:r.copyLink,y=null==r?void 0:r.setAnswerHeight,O=!!(null==n?void 0:n.enableMultiEntityFileAnswer)&&Object(K.a)(d)>1?"Hero_MultiEntity_File_Impression":"Hero_File_Impression",x=null==n?void 0:n.answerBlockId,S=null==n?void 0:n.enableDwellStartLogging,C=An({entities:d,domain:"File",isHero:!0,impressionEventId:O,clickEventId:"File_Click",cardType:nc,isFromMainSearch:!0,groupReferenceId:x});return a.useEffect(function(){!Object(L.a)(d)&&S&&d.forEach(function(e){C.entityActions.onActionClick(e,"Display_Started")})},[]),{userUpn:l,userEmail:o,culture:t,clientSize:s,clientLogger:C,onFileClick:function(e,t){C.entityActions.onEntityClick(e,t,{EntityClickDetails:p&&g?"OpenInViewer":void 0},"File_Click")},onMalformedURLError:function(e){Object(w.d)(i,e)},onProfileClick:function(e){var t;if("Author"===e)t="File_Author_Profile_Click";else if("Modifier"===e)t="File_Modifier_Profile_Click";else{if("Sender"!==e)return;t="File_Sender_Profile_Click"}C.entityActions.onActionClick(m[0],t,0)},openAttachmentInClient:p,setAnswerHeight:y,openLink:g,onFolderBreadcrumbClick:function(e,t){return C.entityActions.onActionClick(e,"File_FolderBreadcrumb_Click",t,{RelatedEntityType:"EntityLocationClick"})},onFileShareClick:function(e,t){return C.entityActions.onActionClick(e,"File_Share_Click",t)},shareByEmail:f,composeEmail:h,onFileCopyLinkClick:function(e,t){return C.entityActions.onActionClick(e,"File_CopyLink_Click",t)},onFileDownloadClick:function(e,t){return C.entityActions.onActionClick(e,"File_Download_Click",t)},onFileSourceClick:function(e,t,n){C.entityActions.onActionClick(e,"File_Source_Click",t,tc({},function(e){if(e)switch(e){case"Mail":return{RelatedEntityType:"EmailSource"};case"CalendarEvent":return{RelatedEntityType:"EmailCalendarSource"};case"Teams":return{RelatedEntityType:"TeamsChatSource"};default:return}}(n)))},downloadAttachment:v,copyLink:b}}(),h=Kl("File"),g=!!(null==u?void 0:u.enableMultiEntityFileAnswer)&&Object(K.a)(r)>1,v=(null==u?void 0:u.enableFileAnswerV2)&&!h,b=(null==u?void 0:u.enableFileAnswerV3)&&!h,y=(null==u?void 0:u.enableFileAnswerV4)||h,O=(null==u?void 0:u.enableFileAnswerV5)&&!h,x=(null==u?void 0:u.enableFileAnswerV6)&&!h,S=Je(Xc(o).fileEntityHover,t),C=null==d?void 0:d.livePersonaCard,j=null==d?void 0:d.getCurrentClientSize,k=null==d?void 0:d.getProfilePhotoUrl;a.useEffect(function(){var e;r&&!Object(L.a)(r)&&Object(L.a)(l)&&(null===(e=null==d?void 0:d.setAnswerBlockRendered)||void 0===e||e.call(d,f.clientLogger.placeholderId))},[r,l]);var E=Vn(function(e,t){var n,r;if(e&&!Object(L.a)(e)&&!t){var i=e[0],a=i.fileType,o=i.modifiedBy,l=i.propertyHits,c=i.authorEmail;return l&&Object(D.a)(l,"EmailSenderName")?null===(n=null==i?void 0:i.sender)||void 0===n?void 0:n.emailAddress.address:l&&Object(D.a)(l,"Author")?c:"Attachment"===a||"Link"===a?null===(r=null==i?void 0:i.sender)||void 0===r?void 0:r.emailAddress.address:o}}(r,g),k);if(!i||Object(L.a)(i))return Object(w.h)(m,"Unexpected Empty response received for File"),null;if(!r||Object(L.a)(r))return null;var T=Jl(r),I=v||x,A=O||x,N=O||x,P=O||x,F=O||x,H=es({files:T,headingLevel:p,displayBreadcrumbSource:F,className:y?S:t,showActions:I,showSourceAtBottom:A,showShortenedConnection:N,enableFileSourceClick:P,getClientSizeCallback:j},f);if(g)return v||b||y?a.createElement(Zc,es({},H)):a.createElement(Gc,es({},H));var B=es({profilePictureUrl:E,file:T[0],className:t,displayBreadcrumbSource:F,showActions:I,showShortenedConnection:N,enableFileSourceClick:P,showSourceAtBottom:A,livePersonaCard:C},f);return a.createElement(Vc,es({},B))},ns=n(303),rs=3;var is="Hero";function as(){var e=Object(u.useSelector)(ns.a),t=Object(ie.a)(),n=Object(c.b)(),r=Object(E.a)(),o=er(),l=tr(),s=t.clientActionCallbacks,d=null==s?void 0:s.setAnswerHeight,m=null==s?void 0:s.getProfilePhotoUrl,p=Object(c.h)().additionalAnswerConfigs,f=null==p?void 0:p.enableDwellStartLogging,h=Vn(function(e){return null==e?void 0:e.senderAddress}(e&&e[0]),m),g=Object(c.i)(),v=function(e,t){if(!e||Object(L.a)(e))return Object(w.h)(t,"Unexpected Empty response received for Link"),[];var n=e.filter(function(e){var n=function(e){return!!e.url}(e);return!n&&Object(w.e)(t,"Link entity dropped due to missing required fields (url)"),n});return Object(L.a)(n)&&Object(w.e)(t,"Link answer dropped due to missing required fields (url)"),Object(Ri.a)(n,rs)}(e,r),b=(null==v?void 0:v.length)>1,y=An({entities:v,domain:"Link",isHero:!0,impressionEventId:b?"Hero_MultiEntity_Link_Impression":"Hero_Link_Impression",cardType:is,clickEventId:"Link_Answer_Click"});a.useEffect(function(){var e;Object(L.a)(v)||(null===(e=null==s?void 0:s.setAnswerBlockRendered)||void 0===e||e.call(s,y.placeholderId),f&&v.forEach(function(e){y.entityActions.onActionClick(e,"Display_Started")}))},[]);var O=null==s?void 0:s.livePersonaCard;return{validLinks:v,clientSize:n,userEmail:o,userUpn:l,clientLogger:y,headingLevel:g,profilePictureUrl:h,onProfileClick:function(e){y.entityActions.onEntityClick(e,0,void 0,"Link_Sender_Profile_Click")},livePersonaCard:O,onLinkClick:function(e,t){y.entityActions.onEntityClick(e,t)},onLinkSourceClick:function(e,t,n){y.entityActions.onActionClick(e,"Teams"===n?"Link_TeamsSource_Click":"Link_MailSource_Click",t,Object(i.__assign)({},function(e){if(e)switch(e){case"Outlook":return{RelatedEntityType:"EmailSource"};case"Teams":return{RelatedEntityType:"TeamsChatSource"};default:return}}(n)))},setAnswerHeight:d}}var os=Object(ye.a)(function(e){var t;return Object(qe.t)({multiEntityFileHeader:[Jt,{fontWeight:"600",fontSize:14}],linkContainer:{selectors:(t={},t["& .ms-search-heroTile-bodyContainer"]={padding:"0"},t["& .ms-search-heroTile-headerContainer"]={margin:e?"0":"0px 12px",padding:e?"8px 24px":"8px 0px"},t)}})}),ls=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedOnWeekday")),cs=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedToday")),ss=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedYesterday")),us=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedLastWeek")),ds=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.linkSharedThisMonth")),ms=(Object(De.declareString)("search-components-link.search.links.youText")),ps=(Object(De.declareString)("search-components-link.search.links.sharedInTeams")),fs=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.sharedInEmail")),hs=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.sharedInTeamsChat")),gs=(Object(De.declareStringWithPlaceholders)("search-components-link.search.links.sharedInTeamsChatWith")),vs=(Object(De.declareString)("search-components-link.search.links.linksHeader"));function bs(e,t,n){if(void 0===n&&(n=new Date),e&&t){var r=n.getTime(),i=new Date(e),a=r-i.getTime(),o=Math.floor(a/at.c),l=Object(cc.a)(i,n);return Object(it.l)(n,i)?cs({name:t}):Object(lt.p)(i,n)?ss({name:t}):o<n.getDay()?ls({name:t,day:Object(lc.a)(i.getDay())}):o<at.w/at.c+n.getDay()?us({name:t}):i.getMonth()===n.getMonth()&&i.getFullYear()===n.getFullYear()?ds({name:t}):ls({name:t,day:l})}}function ys(e,t,n){return(null==t?void 0:t.toLowerCase())===(null==e?void 0:e.toLowerCase())||(null==n?void 0:n.toLowerCase())===(null==e?void 0:e.toLowerCase())}function Os(e,t,n,r,i,a){var o,l,c;if(void 0===a&&(a=new Date),t&&e&&n){if(ys(n,r,i)){if(!(l=bs(e,ms(),a)))return;c=[l=(null===(o=l[0])||void 0===o?void 0:o.toUpperCase())+(null==l?void 0:l.substr(1))]}else{if(!(l=bs(e,t,a)))return;c=null==l?void 0:l.split(t)}return c}}function xs(e){var t=e.sharedSource,n=e.subject,r=e.immutableMessageId;if(t)switch(t){case"Outlook":return function(e,t){if(e){var n=fs({title:e}),r=t?"https://outlook.office.com/owa/?viewmodel=ReadMessageItem&ItemID="+t:void 0;return{text:n,splits:n.split(e),sourceSubject:e,sourceUrl:r}}return}(n,r);case"Teams":return function(e){var t=e.subject,n=e.name,r=e.linksInsights,i=e.recipientNames,a=e.messageThreadId,o=e.teamsLinkMessageId,l=void 0;a&&o?l="https://teams.microsoft.com/l/message/"+a+"/"+o+'?context={"contextType":"chat"}':a&&(l="https://teams.microsoft.com/l/chat/"+a+"/conversations");if(t){var c=hs({chat:t});return{text:c,splits:c.split(t),sourceSubject:t,sourceUrl:l}}if((null==r?void 0:r.isSharedOneToOne)&&i&&"X_PrimarySmtpUser"!==i[0]){var s=gs({name:i[0]});return{text:s,splits:s.split(i[0]),sourceSubject:i[0],sourceUrl:l}}if(n){var u=gs({name:n});return{text:u,splits:u.split(n),sourceSubject:n,sourceUrl:l}}return{text:ps()}}(e);default:return}}var Ss=Object(ye.a)(function(){return Object(qe.t)({header:{marginLeft:"5px",fontWeight:"400",fontSize:14},headerContent:{fontSize:14,lineHeight:"24px",verticalAlign:"middle",display:"flex",flexDirection:"row",overflow:"hidden"},senderFullName:{fontWeight:"600"},profilePhoto:{float:"left"},connectionText:[Jt,{fontWeight:"400",fontSize:14,paddingLeft:"8.75px"}]})}),Cs=function(e){var t=e.link,n=e.profilePictureUrl,r=e.userEmail,o=e.userUpn,l=e.livePersonaCard,c=e.onProfileClick,s=t.senderName,u=t.senderAddress,d=t.lastSharedTimeUtc,m=Ss(),p=Os(d,s,u,r,o),f=bs(d,s),h={imageUrl:Kt(n)?n:void 0,size:1,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(Yt.a)(s,!1),initialsColor:Object(Qt.a)({text:s})},g=Ze(l,s,u),v=a.createElement("div",{className:m.profilePhoto,role:"button",onClick:c},a.createElement(Gt.a,Object(i.__assign)({},h))),b=g?a.createElement(g,null,v):v,y=a.createElement("span",{className:m.senderFullName,role:"button",onClick:c},s),O=g?a.createElement(g,null,y):y;return p?a.createElement("div",{className:m.headerContent},b,a.createElement("div",{className:m.connectionText,title:f,role:"presentation","aria-label":f},p[0],!ys(u,r,o)&&a.createElement("span",{className:m.senderFullName},O),p[1])):null},js=Object(ye.a)(function(e,t,n){var r,i,a=e.palette,o=a.neutralDark,l=a.neutralPrimary,c=a.neutralSecondary,s=a.neutralLight,u=a.blue;return Object(qe.t)({linkEntity:{margin:"0 1px",height:t?"auto":"33px",marginTop:"8px",borderBottom:n?"none":"1px solid",display:"flex",borderColor:s,selectors:{"&:hover":{cursor:"pointer"}}},linkIcon:[Li,{float:"left",color:l,width:"40px",height:"100%",marginTop:t?"0":"-4px"}],linkInfoContainer:{width:"calc(100% - 40px)",height:"100%",float:"left",display:"flex",paddingBottom:t?n?"12px":"8px":"0",flexDirection:t?"column":"row"},titleText:[Jt,{fontSize:"14px",lineHeight:"20px"},{color:u,display:"inline-block",height:"20px",width:t?"100%":"240px",minWidth:"240px",marginRight:t?"0":"25px",selectors:(r={},r[qe.d]={color:"LinkText"},r["&:hover"]={color:u,textDecoration:"underline",selectors:(i={},i[qe.d]={color:"LinkText"},i)},r)}],teaser:[Jt,{fontWeight:"400",fontSize:14,height:"20px",float:"left",color:c}],sourceInfo:[Jt,{color:o,fontWeight:"400",fontSize:14,height:"20px",display:"flex",width:t?"100%":"400px",minWidth:"400px",marginRight:t?"0":"16px"}],sourceLink:[Jt,{color:o,textDecoration:"none",selectors:{":hover":{textDecoration:"underline"}}}],tertiaryInfo:[Jt,{fontWeight:"400",fontSize:14,height:"20px",color:c,float:"left"}]})}),ks=function(e){var t=e.link,n=e.isSmall,r=e.showConnection,i=e.index,o=e.numberOfLinks,l=e.userEmail,c=e.userUpn,s=e.onLinkClick,u=e.onLinkSourceClick,d=e.openLink,m=t.url,p=t.title,f=t.subject,h=t.safeUrl,g=t.senderName,v=t.description,b=t.senderAddress,y=t.messageThreadId,O=t.teamsLinkMessageId,x=t.immutableMessageId,S=t.lastSharedTimeUtc,C=t.sharingReferenceType,j=t.linksInsights,k=t.recipientNames,E=Ne(),w=js(E,n,i===o-1);function T(e,t,n,r){e.stopPropagation(),d&&r?d(r):window.open(r,"_blank"),"Teams"===n?u(t,i,n):"Outlook"===n&&u(t,i,n)}var I=Os(S,g,b,l,c),A=I&&ys(b,l,c)?I[0]:bs(S,g),N=xs({sharedSource:C,subject:f,name:g,linksInsights:j,recipientNames:k,messageThreadId:y,immutableMessageId:x,teamsLinkMessageId:O}),P=null==N?void 0:N.text,F=null==N?void 0:N.splits,D=null==N?void 0:N.sourceSubject,L=null==N?void 0:N.sourceUrl,H=F?a.createElement(a.Fragment,null,F[0],a.createElement("div",{className:w.sourceLink,onClick:function(e){return T(e,t,C,L)},onKeyPress:function(e){return T(e,t,C,L)},tabIndex:0,role:"link"},D),F[1]):P,B=h||m;function R(){d?d(B):window.open(B,"_blank"),s(t,i)}return a.createElement("div",{onClick:R,onKeyPress:R,tabIndex:0,className:w.linkEntity,role:"listitem","aria-posinset":i+1,"aria-setsize":o},a.createElement(Mt.a,{className:w.linkIcon,iconName:"Link"}),a.createElement("div",{className:w.linkInfoContainer},a.createElement("div",{className:w.titleText,title:m},p||m),H&&a.createElement("div",{className:w.sourceInfo,title:P+" "+(r?"":A),"aria-label":P+" "+(r?"":A)},H),v&&!r&&(!p||!H)&&a.createElement("div",{className:w.teaser,title:v},v),r&&A&&a.createElement("div",{className:w.tertiaryInfo,title:A},A)))},Es=function(e){var t,n=e.links,r=e.profilePictureUrl,o=e.clientSize,l=e.userEmail,c=e.userUpn,s=e.headingLevel,u=e.livePersonaCard,d=e.onLinkClick,m=e.onLinkSourceClick,p=e.setAnswerHeight,f=e.openLink,h=e.onProfileClick,g=Object(i.__read)(be("HeroLinkTile",752,o),2),v=g[0],b="Small"===g[1],y=null===(t=v.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){y&&p&&p(y)},[y]);var O=n.length>1,x=os(O),S={link:n[0],profilePictureUrl:r,userEmail:l,userUpn:c,livePersonaCard:u,onProfileClick:function(){return null==h?void 0:h(n[0])}};var C=O;var j={body:a.createElement("div",{role:"list"},n.map(function(e,t){var r={link:e,isSmall:b,showConnection:C,index:t,userEmail:l,userUpn:c,numberOfLinks:n.length,onLinkClick:d,onLinkSourceClick:m,openLink:f};return a.createElement(ks,Object(i.__assign)({key:"link"+t},r))})),header:O?a.createElement("div",{className:x.multiEntityFileHeader,role:"heading","aria-level":s},vs()):a.createElement(Cs,Object(i.__assign)({},S)),isSmall:b};return a.createElement("div",{className:x.linkContainer,ref:v},a.createElement(et,Object(i.__assign)({},j)))};Es.displayName="HeroLinkTile";var ws=function(){return(ws=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ts=function(e){var t=e.className,n=as(),r=n.validLinks,i=n.headingLevel,o=n.userEmail,l=n.userUpn,c=n.clientSize,s=n.profilePictureUrl,u=n.onProfileClick,d=n.livePersonaCard,m=n.onLinkClick,p=n.onLinkSourceClick,f=n.setAnswerHeight,h=Object(ie.a)().clientActionCallbacks,g=null==h?void 0:h.openLink;if(!r||Object(L.a)(r))return null;var v={className:t,links:r,clientSize:c,userEmail:o,userUpn:l,headingLevel:i,profilePictureUrl:s,onProfileClick:u,livePersonaCard:d,onLinkClick:m,onLinkSourceClick:p,setAnswerHeight:f,openLink:g};return a.createElement(Es,ws({},v))},Is="Person";var As=n(7);n(347),n(348),n(195),n(138);n(352);n(256),n(173),n(287);n(260);var Ns=n(4),Ps=n(46),Fs=function(e){var t,n,r=null==e?void 0:e.Source;return{id:function(e){if(!e)return Object($e.a)();var t=e.indexOf("@");return e.substring(0,-1!==t?t:e.length)}(null==e?void 0:e.Id),fullName:(null==r?void 0:r.DisplayName)||"",firstName:(null==r?void 0:r.GivenName)||"",lastName:(null==r?void 0:r.Surname)||"",email:(null===(t=null==r?void 0:r.EmailAddresses)||void 0===t?void 0:t[0])||"",userPrincipalName:(null==r?void 0:r.UserPrincipalName)||"",alias:function(e){if(!e)return;var t=e.replace("sip:",""),n=t.indexOf("@");return t.substring(0,-1!==n?n:t.length)}(null==r?void 0:r.ImAddress)||"",department:null==r?void 0:r.Department,jobTitle:null==r?void 0:r.JobTitle,officeLocation:null==r?void 0:r.OfficeLocation,phoneNumbers:null===(n=null==r?void 0:r.Phones)||void 0===n?void 0:n.map(function(e){return e.Number}),mappingId:null==e?void 0:e.ReferenceId,topics:null==r?void 0:r.Topics,tenantId:function(e){if(!e)return"";var t=e.indexOf("@");return e.substring(t+1)}(null==e?void 0:e.Id)}};var Ds=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,l)}c((r=r.apply(e,t||[])).next())})},Ls=function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}};function Hs(e,t){return{key:(e||"")+"_"+t}}var Bs=Object(Ps.a)("SubstrateSearchPersons",function(e,t){var n;return Ds(this,void 0,void 0,function(){return Ls(this,function(r){switch(r.label){case 0:return[4,e.makeQueryRequest(function(e){var t,n,r,i,a,o=null===(i=null===(r=null===(n=null===(t=null==e?void 0:e.parsedBody)||void 0===t?void 0:t.EntitySets)||void 0===n?void 0:n[0])||void 0===r?void 0:r.ResultSets)||void 0===i?void 0:i[0],l=(null==o?void 0:o.Total)||0,c=null==o?void 0:o.Results,s=(null===(a=null==e?void 0:e.parsedBody)||void 0===a?void 0:a.Instrumentation.TraceId)||"";return{results:Object(V.a)(c,function(e){return Fs(e)}),totalEstimatedMatches:l,debug:{traceId:s}}},t.request,null===(n=t.flights)||void 0===n?void 0:n.toString())];case 1:return[2,r.sent()]}})})},!0),Rs=Object(Ns.c)("SubstrateSearchPersonsStore",Bs),Ms=n(13);var zs=Object(Ms.a)("PersonClasses",function(e,t){return Ds(this,void 0,void 0,function(){var n;return Ls(this,function(r){switch(r.label){case 0:return n=e.createRequestUrl("search/classes"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,r.sent()]}})})});Object(Ns.c)("PersonClassesDataStore",zs);var _s=Object(Ms.a)("PersonFiles",function(e,t){return Ds(this,void 0,void 0,function(){var n;return Ls(this,function(r){return n=e.createRequestUrl("search/documents/personal"),[2,e.makeRequest(n,"POST",t)]})})});Object(Ns.c)("PersonFilesDataStore",_s);n(511);var Ws=n(304),Us=n(299),qs=n(112);function Vs(e){return{key:e.userId+(e.isPeersRequest?"-peers":"")}}var Ks=Object(Ms.a)("OrgChart",function(e,t){return Ds(this,void 0,void 0,function(){var n;return Ls(this,function(r){switch(r.label){case 0:return n=e.createRequestUrl("browse/person/org/chart"),[4,e.makeRequest(n,"POST",t)];case 1:return[2,r.sent()]}})})}),Ys=Object(Ns.c)("OrgChartDataStore",Ks),Qs=Object(Ws.a)("OrgChart",Us.a,{debounce:Object(qs.a)()});Object(Ns.c)("LokiOrgChartDataStore",Qs);var Gs=function(){return(Gs=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function $s(e,t,n,r,i){void 0===n&&(n=As.a);var a=tu(e,n,r,i),o=null==a?void 0:a.results;return t?Object(H.a)(o,function(t){return!function(e,t){return Zs(e)===t}(e,t.id)}):o}function Js(e,t,n){if(!Object(R.g)(e,"Person")){var r=function(e){var t=nu(e);return null==t?void 0:t.results}(e),i=$s(e,void 0,t,void 0,n),a=Object(te.c)(e),o="Person"===Object(h.h)(e),l=a?function(e,t,n){var r=Object(p.a)(e,function(e){return e.userPrincipalName===n||e.id===n});r||(r=Object(p.a)(t,function(e){return e.userPrincipalName===n||e.id===n}));r||(r=Object(U.a)(e));return r}(r,i,a):o?void 0:Object(U.a)(r);if(l){var c=function(e,t){var n=Ys.getSelectors(e).getLatestSuccess(Vs({userId:t}));return n&&Object(p.a)(n.reportingChain,function(e){return e.id===t})}(e,l.id);if(c)return eu(l,c)}return l}}function Zs(e){var t=Js(e);return t&&t.id}function Xs(e){var t=Object(h.a)(e,"Person"),n=Object(x.t)(e);return"PersonOrgChart"===t&&n||"PersonEduClasses"===t&&!n?"None":t}var eu=Object(ye.a)(function(e,t){var n=t.aggregatedOrgStructure,r=t.orgStructure,i=t.customAggregatedAttributes,a=t.customAttributes;return Gs(Gs({},e),{aggregatedOrgStructure:n,orgStructure:r,customAggregatedAttributes:i,customAttributes:a})});function tu(e,t,n,r){return void 0===t&&(t=As.a),!1!==r?nu(e):function(e,t,n){void 0===t&&(t=As.a);var r=void 0===n?ru(e):n;return Rs.getSelectors(e).getLatestSuccess(Hs(r,t))}(e,t,n)}function nu(e){return{results:Object(R.b)(e,"Person")}}function ru(e){return Object(h.f)(e,"Person")}function iu(){var e,t=Object(u.useSelector)($s),n=Object(u.useSelector)(Xs),r=Object(E.a)(),i=Object(c.b)(),o=b(),l="Hero",s=Object(c.a)(),d=null==s?void 0:s.livePersonaCard,m=null==s?void 0:s.startPersonSearchRequery,p=null==s?void 0:s.openLink,f=null==s?void 0:s.getProfilePhotoUrl,h=null==s?void 0:s.setAnswerHeight,g=Object(c.h)().additionalAnswerConfigs,v=null==g?void 0:g.isTeamsChatFeatureEnabled,y=null==g?void 0:g.enableDwellStartLogging,O=In({domain:"Person",entity:t?t[0]:void 0,impressionEventId:"Hero_Person_Impression",cardType:l,isHero:!0,clickEventId:"Person_Entity_Click",queryIntent:n}),x=Vn(t?null===(e=t[0])||void 0===e?void 0:e.email:void 0,f);return a.useEffect(function(){var e;t&&!Object(L.a)(t)&&m&&(null===(e=null==s?void 0:s.setAnswerBlockRendered)||void 0===e||e.call(s,O.placeholderId),y&&O.entityActions.onActionClick("Display_Started"))},[]),{people:t,profilePictureUrl:x,index:-1,clientSize:i,isTeamsChatFeatureEnabled:v,openLink:p,startPersonSearchRequery:m,logPersonClick:function(e,t){!function(e,t,n,r,i,a,o){Object(gn.c)(e,"Person_Entity_Click",t,{cardType:r,clientSize:i,eventScope:Is,traceId:a,isHero:o},n)}(r,e,t,l,i,o,!0)},logPersonProfileClick:function(e){!function(e,t,n,r,i){Object(gn.a)(e,"Person_SeeProfile_Click",{eventScope:Is,cardType:t,clientSize:n,traceId:i,isHero:!0},r)}(r,l,i,e,o)},logPersonChatClick:function(e,t){!function(e,t,n,r,i,a,o){Object(gn.c)(e,"Person_SeeTeamsChat_Click",t,{cardType:r,clientSize:i,eventScope:Is,traceId:a,isHero:o},n)}(r,e,t,l,i,o,!0)},livePersonaCard:d,setAnswerHeight:h}}var au=Object(ye.a)(function(e){var t,n=e.palette,r=n.white,i=n.neutralLight;return Object(qe.t)({profilePhoto:{float:"left",height:"40px",margin:"0 12px 0 16px",width:"40px"},personInfoContainer:{paddingRight:"16px",maxWidth:"calc(100% - 68px)"},emailIcon:{fontSize:18,marginTop:"5px",marginRight:"8px"},messageIcon:{fontSize:18,marginTop:"5px",marginRight:"8px",paddingTop:"2px"},personName:[Jt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",fontWeight:"600",paddingRight:"15px"}],viewEmailText:[Jt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",marginTop:"4px",paddingRight:"15px"}],viewMessageText:[Jt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",marginTop:"4px",paddingRight:"15px"}],email:[Jt,{fontSize:"14px",lineHeight:"20px"},{height:"20px",paddingRight:"15px"}],personContainer:{height:"40px",display:"flex",padding:"9px 0 11px 0",backgroundColor:r,width:"100%",borderBottom:"1px solid",borderColor:i},tileBodyOverride:["ms-search-tile-body"],tile:[{selectors:(t={},t["& .ms-search-tile-body"]={margin:"0",padding:"0"},t)}],actionContainer:{paddingLeft:"10px",height:"30px",display:"flex",cursor:"pointer",float:"left"},actionChatContainer:{paddingLeft:"10px",height:"30px",display:"flex",cursor:"pointer"}})}),ou=(Object(De.declareStringWithPlaceholders)("search-components-person.search.person.viewEmailsFrom")),lu=(Object(De.declareString)("search-components-person.search.person.viewEmails")),cu=(Object(De.declareString)("search-components-person.search.person.viewMessages")),su=function(){return(su=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},uu="Mail",du="Chat",mu=function(e){var t,n=e.person,r=e.profilePictureUrl,i=e.clientSize,o=e.startPersonSearchRequery,l=e.openLink,c=e.logPersonClick,s=e.logPersonProfileClick,u=e.logPersonChatClick,d=e.livePersonaCard,m=e.setAnswerHeight,p=e.isTeamsChatFeatureEnabled,f=n.fullName,h=n.email,g=n.nicknames,v=Ne(),b=be("HeroLinkTile",752,i),y=b[0],O="Small"===b[1],x=null===(t=y.current)||void 0===t?void 0:t.offsetHeight;a.useEffect(function(){x&&m&&m(x)},[x]);var S=Kt(r),C=au(v),j=C.personContainer,k=C.actionChatContainer,E=C.actionContainer,w=C.profilePhoto,T=C.personInfoContainer,I=C.personName,A=C.viewEmailText,N={imageUrl:S?r:void 0,size:3,hidePersonaDetails:!0,imageShouldFadeIn:!1,imageShouldStartVisible:!0,showInitialsUntilImageLoads:!0,imageInitials:Object(Yt.a)(f,!1),initialsColor:Object(Qt.a)({text:f})};function P(){u(n,0);var e=function(e,t){var n="";return e&&t?n="https://teams.microsoft.com/l/search/"+e+"?from="+t:n}(f,h);e&&l?l(e):window.open(e,"_blank")}function F(){c(n,0),o(h,f)}var D=function(e){F&&we(e,F)},H=function(e){P&&we(e,P)},B=Ze(d,f,h),R=a.createElement("div",{className:w,role:"button",onClick:function(){return s(n)},onKeyPress:function(){return s(n)}},a.createElement(Gt.a,su({},N))),M=B?a.createElement(B,null,R):R,z=a.createElement("span",{role:"button",onClick:function(){return s(n)},onKeyPress:function(){return s(n)}},f),_=B?a.createElement(B,null,z):z,W=g&&!Object(L.a)(g)&&g[0]?g[0]:f,U=cu(),q=p?lu():ou({name:W});var V={body:function(){var e;return a.createElement("div",null,a.createElement("div",{className:j},M,a.createElement("div",{className:T},a.createElement("div",{className:I},_),a.createElement("div",{className:C.email,title:h},h))),a.createElement("div",{role:"Button",tabIndex:0,className:E,onClick:F,onKeyPress:D},a.createElement(Mt.a,{iconName:uu,className:C.emailIcon}),a.createElement("div",{className:A,title:q},q)),p&&(null===(e=null==n?void 0:n.inferences)||void 0===e?void 0:e.HasReceivedMessagesFrom)&&a.createElement("div",{role:"Button",tabIndex:0,className:k,onClick:P,onKeyPress:H},a.createElement(Mt.a,{iconName:du,className:C.messageIcon}),a.createElement("div",{className:C.viewMessageText,title:U},U)))}(),isSmall:O,styleOverrides:function(){return{bodyStyles:C.tileBodyOverride,cardStyles:C.tile}}};return a.createElement("div",{ref:y},a.createElement(et,su({},V)))};mu.displayName="HeroPersonTile";var pu=function(){return(pu=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},fu=function(e){var t=e.className,n=iu(),r=n.people,i=n.profilePictureUrl,o=n.index,l=n.clientSize,c=n.isTeamsChatFeatureEnabled,s=n.openLink,u=n.startPersonSearchRequery,d=n.logPersonClick,m=n.logPersonProfileClick,p=n.logPersonChatClick,f=n.livePersonaCard,h=n.setAnswerHeight,g=Object(E.a)();if(!r||Object(L.a)(r))return Object(w.h)(g,"Unexpected Empty response received for People"),null;if(!u)return Object(w.b)(g,"startPersonSearchRequery callback undefined"),null;var v={className:t,person:r[0],openLink:s,profilePictureUrl:i,index:o,clientSize:l,startPersonSearchRequery:u,logPersonClick:d,logPersonProfileClick:m,logPersonChatClick:p,livePersonaCard:f,setAnswerHeight:h,isTeamsChatFeatureEnabled:c};return a.createElement(mu,pu({},v))};fu.displayName="HeroPersonTileContainer";var hu=function(e){var t=e.domain,n=e.className,r=Object(c.h)().additionalAnswerConfigs;switch(t){case"Bookmark":return(null==r?void 0:r.bookmarkTriggerControl)?null:a.createElement(Xi,{className:n});case"Calendar":return(null==r?void 0:r.calendarTriggerControl)?null:a.createElement(Gl,{className:n});case"Flight":return(null==r?void 0:r.flightTriggerControl)?null:a.createElement(or,{className:n});case"File":return(null==r?void 0:r.fileTriggerControl)?null:a.createElement(ts,{className:n});case"Link":return(null==r?void 0:r.linkTriggerControl)?null:a.createElement(Ts,{className:n});case"Acronym":return(null==r?void 0:r.acronymTriggerControl)?null:a.createElement(Ui,{className:n});case"Person":return(null==r?void 0:r.personTriggerControl)?null:a.createElement(fu,{className:n});case"TuringQnA":case"PeopleAlsoAsk":case"MeetingRoomProposal":case"Qna":case"FloorPlan":case"Building":case"Group":case"Calendar":case"FileEntity":case"Conversation":case"Message":case"Site":case"PowerBi":case"CalendarAvailability":case"Notification":case"Turing":case"Topic":case"Connectors":case"External":case"EmployeeOffer":case"SharePoint":case"EducationAssignment":case"EducationClass":case"QueryReformulation":case"EnterpriseLearning":return null;default:return Object(s.a)(t)}},gu=Object(u.connect)(function(e){return{topHeroDomain:Object(R.c)(e),shouldShowHeroCard:Object(R.i)(e),rankedConversationProvenances:j(e)}})(function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return M(n,t),n.prototype.render=function(){var t=this.getShownDomains(),n=z({shownDomains:t},this.props);return a.createElement(e,z({},n))},n.prototype.getShownDomains=function(){var e=this.filterConflictedDomains();return this.getEnabledAsyncDomains().forEach(function(t){Object(F.a)(e,function(e){return t===e})||e.push(t)}),Object(D.a)(e,"Turing")||e.push("Turing"),this.sortDomains(e)},n.prototype.getEnabledAsyncDomains=function(){var e=this.props,t=e.domainsFilter,n=e.areConnectorsEnabled,r=e.variantEnabledAsyncDomains,i=Object(L.a)(t)?r:Object(H.a)(r,function(e){return Object(F.a)(t,function(t){return e===Object(B.b)(t)})});return n&&i.push("Connectors"),i},n.prototype.sortDomains=function(e){var t=this.props.heroDomain;return Object(O.a)(e,function(e){return e===t||"External"===t&&"Connectors"===e?-1:Object(P.d)(e)?1:0})},n.prototype.filterConflictedDomains=function(){var e=this.props,t=e.allResultDomains,n=e.heroDomain;return Object(H.a)(t,function(e){return"Calendar"===e?"Calendar"===n:"Person"!==e||"Calendar"!==n})||[]},n}(a.Component);return Object(u.connect)(_)(t)}(function(e){var t,n=e.topHeroDomain,i=e.shouldShowHeroCard,l=e.shownDomains,d=e.rankedConversationProvenances,m=e.entityOverride,p=e.query,f=Object(c.d)()&&m?Object(fe.k)(m):n,g=Object(E.a)(),v=Object(c.f)(),y=Object(u.useSelector)(C.x),O=Object(c.h)(),x=Object(u.useSelector)(h.g),S=b(),j=O.externalLinkDefaultTarget;return function(e){var t=this,n=Object(u.useDispatch)(),r=Object(ie.a)(),i=r.searchOptions,o=se(e),l=Object(u.useSelector)(h.g),c=Object(u.useSelector)(C.A),s=i.useSubstrateUnifiedSearch,d=i.getVerticalConfig,m=i.isTuringMarkerEnabled,p=function(){return ue(t,void 0,void 0,function(){var a,o,l;return de(this,function(c){switch(c.label){case 0:return e?s?[4,Object(ae.a)(d)]:[3,3]:[3,5];case 1:return a=c.sent(),o=Object(ae.b)(a,!0),l=Object(ce.c)(e,i,void 0,void 0,o),[4,n(Object(oe.c)(r,l,o,m))];case 2:return c.sent(),[3,5];case 3:return l=Object(ce.b)(e,i),[4,n(Object(oe.b)(r,l))];case 4:c.sent(),c.label=5;case 5:return[4,ue(t,void 0,void 0,function(){return de(this,function(t){switch(t.label){case 0:return[4,n(Object(le.h)({query:e}))];case 1:return t.sent(),[2]}})})];case 6:return c.sent(),[2]}})})};a.useEffect(function(){e!==o&&e!==l&&!c&&oe.b&&oe.c&&p()},[e,o,l,c,p,i])}(p),X(),t=re(void 0),a.useEffect(function(){return window.addEventListener("beforeunload",t),function(){t(),window.removeEventListener("beforeunload",t)}},[]),a.useEffect(function(){Object(r.a)(l)||Object(me.e)(g,l,d)},[g,l,d]),a.useEffect(function(){f&&pe(g,f)},[g,f]),a.useEffect(function(){if(y&&f&&!function(e,t){if(!t)return!1;switch(e){case"Bookmark":return!!t.bookmarkTriggerControl;case"Calendar":return!!t.calendarTriggerControl;case"Flight":return!!t.flightTriggerControl;case"File":return!!t.fileTriggerControl;case"Link":return!!t.linkTriggerControl;case"Acronym":return!!t.acronymTriggerControl;case"Person":return!!t.personTriggerControl;case"TuringQnA":case"PeopleAlsoAsk":case"MeetingRoomProposal":case"Qna":case"FloorPlan":case"Building":case"Group":case"Calendar":case"FileEntity":case"Conversation":case"Message":case"Site":case"PowerBi":case"CalendarAvailability":case"Notification":case"Turing":case"Topic":case"Connectors":case"External":case"EmployeeOffer":case"SharePoint":case"EducationAssignment":case"EducationClass":case"QueryReformulation":case"EnterpriseLearning":return!1;default:return Object(s.a)(e)}}(f,O.additionalAnswerConfigs)){var e=new Date;p!==x&&Object(w.c)(g,"Rendering previous experience for new query",v&&(e.getTime()-v.getTime()).toString()),v&&(!function(e,t,n,r,i){if(n&&r){var a=i&&Object(G.b)(i),o={name:"PageLoadTime",value:(r.getTime()-n.getTime()).toString(),eventScope:a};Object(Y.C)(e,{eventId:t,properties:o})}}(g,"FullPageLoadTime",v,e,f),Object(Q.e)({logger:g,domain:f,impressionEventId:"Answer_Impression",traceId:S,startTime:v,endTime:e}))}},[v,g,y,f]),f?a.createElement(N,{codeLocation:"HeroCardRouterContainer.Owa."+f},a.createElement(o.Provider,{value:j},i&&a.createElement(hu,{domain:f}))):null}))}}]);