(window.$wj=window.$wj||[]).push([[885],{10203:function(t,e,n){"use strict";var i=n(327);const r="ows/api/beta/PremiumSubscription/Renew";async function o(){return Object(i.e)(r,null)}var a=n(47);const l="ows/api/beta/PremiumSubscription/MDollar",s="ows/api/beta/PremiumSubscription/GetUserSubscriptionInfo";let c;function u(){return c||(c=Object(a.j)("auth-RefreshMdollarSdsDataIfStale")?Object(i.e)(s,null):Object(i.b)(l)),c}const p="ows/api/beta/PremiumSubscription/MDollar";async function d(){return Object(i.e)(p,null)}n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return d}))},10584:function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"e",(function(){return u}));var i=n(20);const r=new i.c(()=>Promise.all([n.e(0),n.e(928)]).then(n.bind(null,14182)));let o=new i.a(r,t=>t.initializeUpsellBarState),a=new i.a(r,t=>t.initializeLeftNavUpsellState),l=new i.b(r,t=>t.ArcStore),s=new i.b(r,t=>t.BizBarArcStore),c=new i.a(r,t=>t.makeImpressionCall),u=new i.a(r,t=>t.makeBeaconCall)},13497:function(t){t.exports=JSON.parse('{"a":"poe"}')},13498:function(t){t.exports=JSON.parse('{"d":"roe","c":"soe","b":"uoe","a":"Doe"}')},15641:function(t,e,n){var i=n(2067);t.exports=function(t,e){var n=i(t),r=Number(e);return n.setDate(n.getDate()+r),n}},15642:function(t,e,n){var i=n(15643);"string"==typeof i&&(i=[[t.i,i,""]]);var r={transform:void 0};n(77)(i,r);i.locals&&(t.exports=i.locals)},15643:function(t,e,n){(e=t.exports=n(76)(!1)).push([t.i,"._2_1jS9rVrPuzoS0TkWEtIk{position:relative;-webkit-appearance:none;cursor:pointer;font-family:inherit;display:block;bottom:0;overflow:hidden;width:100%}html[dir] ._2_1jS9rVrPuzoS0TkWEtIk{border:none;border-radius:0;-webkit-transition:all .3s;transition:all .3s;background-color:transparent}html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk{text-align:left;-webkit-box-shadow:inset -1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -1px 0 transparent;box-shadow:inset -1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -1px 0 transparent;left:0}html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk{text-align:right;-webkit-box-shadow:inset 1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -1px 0 transparent;box-shadow:inset 1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -1px 0 transparent;right:0}html[dir] ._2_1jS9rVrPuzoS0TkWEtIk:hover{background-color:var(--white)}html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk:hover{-webkit-box-shadow:inset -1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -3px 0 var(--headerButtonsBackground);box-shadow:inset -1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -3px 0 var(--headerButtonsBackground)}html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk:hover{-webkit-box-shadow:inset 1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -3px 0 var(--headerButtonsBackground);box-shadow:inset 1px 0 0 var(--neutralLight),inset 0 1px 0 var(--neutralLight),inset 0 -3px 0 var(--headerButtonsBackground)}._2_1jS9rVrPuzoS0TkWEtIk ._2h2qK5GO5251FgEYC-Nzx5{position:absolute;top:14px;width:14px;height:14px}html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk ._2h2qK5GO5251FgEYC-Nzx5{left:17px}html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk ._2h2qK5GO5251FgEYC-Nzx5{right:17px}._2_1jS9rVrPuzoS0TkWEtIk .gK6rGQLZdpazdvO5XzZrm{position:absolute;top:27px;width:15px;height:15px}html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk .gK6rGQLZdpazdvO5XzZrm{left:17px}html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk .gK6rGQLZdpazdvO5XzZrm{right:17px}._2_1jS9rVrPuzoS0TkWEtIk .QTgeKF2rDPsv5WdLK7o9m{display:block;width:100%;height:100%}html[dir] ._2_1jS9rVrPuzoS0TkWEtIk .QTgeKF2rDPsv5WdLK7o9m{-webkit-transition:all .25s;transition:all .25s}._2_1jS9rVrPuzoS0TkWEtIk .QTgeKF2rDPsv5WdLK7o9m ._2-YrXGW4gSYuAQNbk_YcBw{fill:var(--neutralLighter)}html[dir] ._2_1jS9rVrPuzoS0TkWEtIk .QTgeKF2rDPsv5WdLK7o9m ._2-YrXGW4gSYuAQNbk_YcBw{-webkit-transition:all .25s;transition:all .25s}._2_1jS9rVrPuzoS0TkWEtIk .QTgeKF2rDPsv5WdLK7o9m ._3njJCS3PlBIrC_LHLdNNM5{fill:var(--neutralSecondary)}html[dir] ._2_1jS9rVrPuzoS0TkWEtIk .QTgeKF2rDPsv5WdLK7o9m ._3njJCS3PlBIrC_LHLdNNM5{-webkit-transition:all .25s;transition:all .25s}html[dir] ._2_1jS9rVrPuzoS0TkWEtIk:hover .QTgeKF2rDPsv5WdLK7o9m{-webkit-transform:translateY(3%) scale(1.2);transform:translateY(3%) scale(1.2)}._2_1jS9rVrPuzoS0TkWEtIk ._3Uacblvp2eZAxH8DUKwS3I{display:block;width:auto;-webkit-box-sizing:border-box;box-sizing:border-box;height:100%;position:relative}html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk ._3Uacblvp2eZAxH8DUKwS3I{margin-left:42px}html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk ._3Uacblvp2eZAxH8DUKwS3I{margin-right:42px}html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk ._3Uacblvp2eZAxH8DUKwS3I.VihWHazmbgPAUn8J61JYM{margin-left:56px}html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk ._3Uacblvp2eZAxH8DUKwS3I.VihWHazmbgPAUn8J61JYM{margin-right:56px}._2_1jS9rVrPuzoS0TkWEtIk ._32v0LiKcDVqn69Kdf2Qka5,._2_1jS9rVrPuzoS0TkWEtIk ._1llGQvdS01RvvPPTiVIUkj{font-size:.8125rem!important;line-height:1.3;color:var(--neutralPrimary);display:inline-block;max-width:156px!important}html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk ._32v0LiKcDVqn69Kdf2Qka5,html[dir=ltr] ._2_1jS9rVrPuzoS0TkWEtIk ._1llGQvdS01RvvPPTiVIUkj{padding:12px 40px 15px 0}html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk ._32v0LiKcDVqn69Kdf2Qka5,html[dir=rtl] ._2_1jS9rVrPuzoS0TkWEtIk ._1llGQvdS01RvvPPTiVIUkj{padding:12px 0 15px 40px}._2_1jS9rVrPuzoS0TkWEtIk ._32v0LiKcDVqn69Kdf2Qka5{font-size:.6875rem;color:var(--neutralSecondary);top:12px}._2_1jS9rVrPuzoS0TkWEtIk ._1llGQvdS01RvvPPTiVIUkj{top:26px;font-size:.875rem;color:var(--neutralPrimary)}@media (max-height:600px){._2_1jS9rVrPuzoS0TkWEtIk{display:none}}._3mdLprrhvK2EoDta-xyDi-{display:none!important}._28ithXDZzMqSN0YAG2rCVn{display:block}",""]),e.locals={upselllink:"_2_1jS9rVrPuzoS0TkWEtIk",leftnavOrnament:"_2h2qK5GO5251FgEYC-Nzx5",ornament:"gK6rGQLZdpazdvO5XzZrm",leftNavUpsellSvg:"QTgeKF2rDPsv5WdLK7o9m",st0:"_2-YrXGW4gSYuAQNbk_YcBw",st1:"_3njJCS3PlBIrC_LHLdNNM5",prose:"_3Uacblvp2eZAxH8DUKwS3I",horizontalModuleSwitcherPadding:"VihWHazmbgPAUn8J61JYM",prefix:"_32v0LiKcDVqn69Kdf2Qka5",suffix:"_1llGQvdS01RvvPPTiVIUkj",hide:"_3mdLprrhvK2EoDta-xyDi-",display:"_28ithXDZzMqSN0YAG2rCVn"}},19660:function(t,e,n){"use strict";n.r(e);var i,r=n(23),o=n(13497),a=n(13498),l=n(6),s=n(0),c=n(71),u=n(38),p=n(1707),d=n(10203);async function b(){return h.upsellWovenEditButtonSplitTreatment}!function(t){t[t.SvgIcon=0]="SvgIcon",t[t.FabricIcon=1]="FabricIcon",t[t.UrlIcon=2]="UrlIcon"}(i||(i={}));const m="resources/leftNavUpsellIcons/premium-diamond-01.svg",h={upsellWovenEditButtonSplitTreatment:{isHidden:!1,url:"https://go.microsoft.com/fwlink/?linkid=2141325&clcid=0x409",datapointNameShow:"LeftNavPremiumUpsellWovenEditButtonSplitTreatmentDisplayed",datapointNameClicked:"LeftNavPremiumUpsellWovenEditButtonSplitTreatmentClicked",buttonText:Object(l.b)(a.d),buttonTextLine2:Object(l.b)(a.c),buttonIconPath:m,buttonIconType:i.SvgIcon},upsellWovenEditButtonSplitControl:{isHidden:!1,url:"https://go.microsoft.com/fwlink/?linkid=2141326&clcid=0x409",datapointNameShow:"LeftNavPremiumUpsellWovenEditButtonSplitControlDisplayed",datapointNameClicked:"LeftNavPremiumUpsellWovenEditButtonSplitControlClicked",buttonText:Object(l.b)(a.d),buttonTextLine2:Object(l.b)(a.c),buttonIconPath:m,buttonIconType:i.SvgIcon},regularUpsell:{isHidden:!1,url:"https://go.microsoft.com/fwlink/?linkid=2123186&ep=",datapointNameShow:"LeftNavPremiumUpsellDisplayed",datapointNameClicked:"LeftNavPremiumUpsellClicked",buttonText:Object(l.b)(a.d),buttonTextLine2:Object(l.b)(a.c),buttonIconPath:m,buttonIconType:i.SvgIcon},noCCTreatmentRenewUpsell:{isHidden:!1,url:"https://go.microsoft.com/fwlink/?linkid=867712&WT.mc_id=PROD_OL-Web_InApp_LeftNav_NoCCTreatmentRenew&ep=",datapointNameShow:"LeftNavPremiumUpsellRenewNoCCTreatment",datapointNameClicked:"LeftNavPremiumUpsellRenewClickedNoCCTreatment",buttonText:Object(l.b)(o.a),buttonTextLine2:"",buttonIconPath:m,buttonIconType:i.SvgIcon},noCCTreatmentReactivateUpsell:{isHidden:!1,url:"https://go.microsoft.com/fwlink/?linkid=867712&WT.mc_id=PROD_OL-Web_InApp_LeftNav_NoCCTreatmentReactivate&ep=",datapointNameShow:"LeftNavPremiumUpsellReactivateDisplayedNoCCTreatment",datapointNameClicked:"LeftNavPremiumUpsellReactivateClickedNoCCTreatment",buttonText:Object(l.b)(a.b),buttonTextLine2:Object(l.b)(a.c),buttonIconPath:m,buttonIconType:i.SvgIcon}};var v=h,S=n(3),k=Object(S.createStore)("LeftNavUpsellState",{isHidden:!0,url:"",datapointNameShow:"",datapointNameClicked:"",buttonText:"",buttonTextLine2:"",buttonIconPath:"",buttonIconType:i.SvgIcon,irisImpressionUrl:"",irisBeaconUrl:""})(),x=Object(S.mutatorAction)("setUpsellState",(function(t){k.isHidden=t.isHidden,k.url=t.url,k.datapointNameShow=t.datapointNameShow,k.datapointNameClicked=t.datapointNameClicked,k.buttonText=t.buttonText,k.buttonTextLine2=t.buttonTextLine2,k.buttonIconPath=t.buttonIconPath,k.buttonIconType=t.buttonIconType,t.irisImpressionUrl&&(k.irisImpressionUrl=t.irisImpressionUrl),t.irisBeaconUrl&&(k.irisBeaconUrl=t.irisBeaconUrl)})),_=n(15641),I=n.n(_),f=n(47),T=n(20);const g=new T.c(()=>n.e(626).then(n.bind(null,19632)));let P=new T.a(g,t=>t.launchOwaPremiumUpsellModal);var w=n(2093),j=n(2),N=n(334),L=n(10584),U=n(1694),W=n(15642),z=n.n(W),E=n(166);const C=n.n(E).a.bind(z.a);var D=Object(r.a)((function(){s.useEffect(()=>{Object(p.b)()?Object(d.b)().then(t=>{t&&(t.subscriptions&&0==t.subscriptions.length?Object(d.a)().then(t=>{y(t)}):y(t))}):Object(d.b)().then(async t=>{t&&(t.subscriptions&&0==t.subscriptions.length?x(await b()):async function(t){!function(t){const e=new Date;return!!(t.expireDate&&t.expireDate<e&&I()(t.expireDate,10)>e)}(V(t))?x(await b()):x(v.noCCTreatmentReactivateUpsell)}(t)),async function(){if(Object(f.j)("auth-leftNavIrisControl")){await L.d.importAndExecute();let t=await L.a.import();t.message&&(x({isHidden:Object(p.b)(),url:t.userRedirectionUrl,datapointNameShow:"",datapointNameClicked:"",buttonText:t.message,buttonTextLine2:"",buttonIconPath:t.iconUri,buttonIconType:i.UrlIcon,irisImpressionUrl:t.impressionBaseUri,irisBeaconUrl:t.trackingBaseUri}),L.f.importAndExecute(t.impressionBaseUri))}}()})},[]);let t=z.a.display;k.isHidden?t=z.a.hide:Object(c.o)(k.datapointNameShow);let e=k.buttonIconType==i.UrlIcon?k.buttonIconPath:Object(j.I)()+k.buttonIconPath,n=k.buttonIconType==i.SvgIcon||k.buttonIconType==i.UrlIcon?s.createElement("img",{className:z.a.leftNavUpsellSvg,src:e,alt:Object(l.b)(a.a)}):s.createElement(N.a,{iconName:k.buttonIconPath});return s.createElement("div",{onClick:O,className:t},s.createElement("button",{className:z.a.upselllink},s.createElement("div",{className:C(z.a.prose,!Object(w.a)(U.a.Mail)&&z.a.horizontalModuleSwitcherPadding)},s.createElement("span",{className:z.a.suffix},k.buttonText," ",k.buttonTextLine2)),s.createElement("div",{className:z.a.leftnavOrnament},n)))}));function O(t){if(t.stopPropagation(),Object(f.j)("auth-leftNavInAppUpsell"))P.importAndExecute();else if(Object(f.j)("auth-leftNavIrisControl"))k.irisBeaconUrl&&L.e.importAndExecute(k.irisBeaconUrl,"Click"),window.open(k.url,"_blank");else{Object(c.o)(k.datapointNameClicked);const t=k.url+encodeURIComponent(Object(u.a)().SessionSettings.EncryptedUserPuid);window.open(t,"_blank"),k.buttonText==Object(l.b)(o.a)&&(x({isHidden:!0,url:"",datapointNameShow:"",datapointNameClicked:"",buttonText:"",buttonTextLine2:"",buttonIconPath:"",buttonIconType:i.SvgIcon}),Object(d.c)())}}function V(t){var e;const n={expireDate:void 0,isAutoRenew:!1,isActive:!1,isSuppressedOfferId:!1,isWithinResellerRestrictionPeriod:!1};if(null===(e=null==t?void 0:t.subscriptions)||void 0===e?void 0:e.length){t.subscriptions.sort((t,e)=>new Date(e.endDate).getTime()-new Date(t.endDate).getTime());const e=t.subscriptions[0];n.isActive=!0,n.isAutoRenew=e.autoRenew,n.expireDate=new Date(e.endDate),n.isWithinResellerRestrictionPeriod=e.isWithinResellerRestrictionPeriod}return n}function K(t){const e=new Date;return!(!(t.expireDate&&t.isActive&&t.expireDate>e&&I()(t.expireDate,-10)<e)||t.isAutoRenew||t.isWithinResellerRestrictionPeriod)}function y(t){const e=V(t);K(e)?Object(d.a)().then(t=>{K(V(t))&&x(v.noCCTreatmentRenewUpsell)}):null!=e.expireDate&&e.expireDate<new Date&&Object(d.a)()}n.d(e,"LeftnavUpsell",(function(){return D}))}}]);
//# sourceMappingURL=owa.885.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.885.js'] = 1;