(window.$wj=window.$wj||[]).push([[306,28,33,42,58],{10020:function(e){e.exports=JSON.parse('{"a":"FZb"}')},10208:function(e,t,n){"use strict";var r=n(7607),a=n(6),i=n(2036),o=n(4467),c=n(36);var u=e=>{if(!e)return e;if(0===e.indexOf("data:")){const t=";base64,",n=e.indexOf(t);return e.substr(n+t.length)}return e},s=n(71),l=n(10623),d=n(7031),f=n(1713),m=n(3303),b=n(7586),h=n(5663),p=n(10624),O=n(35),g=n(905);var v=n(3205),I=n(10622),S=n(6495),w=n(225),j=n(2614);var y=async(e,t)=>{const n=new s.b("FetchAttachmentContent",{isCore:!0}),r=Object(j.a)(Object.assign({mailboxInfo:Object(w.d)()},e),0);try{const e=await Object(I.a)(`${r}${t?"&asDataUri=true":""}`);return n.end(),e}catch(e){throw c.d(`SmimeTraceError: FetchAttachmentContent failed. URL: ${r}`),n.endWithError("ServerError",e),new S.a(e.message,11)}},C=n(12133),A=n(1928),T=n(1857),P=n(1798),E=n(1732);const x="S/MIME: Unsupported reference attachment",R="S/MIME: Unsupported attachment type";class k{constructor(e,t,n){this.attachmentWellViewState=e,this.parentItemId=t,this.infoBar=n,this.downloadQueue=[],this.downloadFailures=[],this.deleteQueue=[],this.onFinishPromise=new Promise((e,t)=>{this.onFinish=function(t){e(t)}})}enqueueSmimeAttachmentDownload(e,t=null){e.map(e=>{const n={attachmentState:e,attachment:Object(f.a)(e.attachmentId),onAttachmentDownloaded:t};this.downloadQueue.push(n)}),this.startProcessIfNotStarted()}deleteSmimeAttachment(e,t){const n=1===e.attachmentType,r=n?0===e.status:0===e.ongoingAction;n||Object(A.A)(e,3,6),r&&this.currentDownloadItem&&this.currentDownloadItem.attachmentState.attachmentId!==e.attachmentId&&(c.h.info("Attachment: Removing attachment: TempId= "+e.attachmentId+" from S/MIME download queue"),this.removeRelatedItemFromDownloadQueue(e,this.downloadQueue)),this.deleteQueue.push({attachmentState:e,onAttachmentDeleted:t}),this.startProcessIfNotStarted()}startProcessIfNotStarted(){this.isInProgress||(this.datapoint=new s.b("SmimeAttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment())}async processNextAttachment(){var e,t,n;if(0!=this.deleteQueue.length){const{attachmentState:e,onAttachmentDeleted:t}=this.deleteQueue.shift(),n=Object(f.a)(e.attachmentId);Object(m.a)(this.attachmentWellViewState,e),null==t||t(this.parentItemId,n.model.AttachmentId,n.model),this.processNextAttachment()}else if(0!==this.downloadQueue.length){this.currentDownloadItem=this.downloadQueue.shift();const{attachmentState:r,attachment:a,onAttachmentDownloaded:i}=this.currentDownloadItem,o=Object(T.a)(a.model),f=a.model;let m;try{const c=this.getAttachmentId(a.model,this.parentItemId);if(m=Object.assign({},f),2===o){const r=f;if(null===(e=r.Item)||void 0===e?void 0:e.MimeContent)m.MimeContent=Object(b.a)(r.Item.MimeContent.Value);else if(!f.MimeContent){const e=(null==c?void 0:c.Id)?await y(c):await(t={itemId:this.getItemId(a.model)},void 0===t.itemId||t.itemId.__type||(t.itemId=Object(g.a)(t.itemId)),Object(O.a)("GetMime",t,n));m.__type=E.b,m.MimeContent=e,Object(s.o)("SmimeAttachmentDownloadDatapoint",{isMailDownload:!0},{isCore:!0})}}else{if(0!==o)throw 1===o?new Error(x):new Error(R);if(f.Content)m=Object.assign({},f);else{const e=await y(c,!0);m.__type=E.a,m.Content=u(e),Object(s.o)("SmimeAttachmentDownloadDatapoint",{isFileDownload:!0},{isCore:!0})}}let h=f.AttachmentId;Object(P.c)(f)&&Object(d.a)(f,this.parentItemId)||(h=Object.assign(Object.assign({},Object(p.a)({Id:Object(v.e)()})),{mailboxInfo:this.parentItemId.mailboxInfo})),null==i||i(a.model),Object(l.a)(r,h,f,m,this.parentItemId)}catch(e){e.message!==x&&c.d("SmimeTraceError: "+e.message);const{IsInline:t}=this.currentDownloadItem.attachment.model,{attachmentClass:n,type:r}=this.currentDownloadItem.attachment;Object(s.o)("SmimeAttachmentDownloadDatapoint",{attachmentClass:n,type:r,IsInline:t,isError:!0,message:e.message},{isCore:!0});const a={item:this.currentDownloadItem,reason:e.message===x?1:0};this.downloadFailures.push(a)}finally{this.processNextAttachment()}}else this.finishProcess()}finishProcess(){const e=this.currentDownloadItem&&this.currentDownloadItem.attachmentState?this.currentDownloadItem.attachmentState.attachmentId:null;c.h.info("Attachment: SmimeAttachmentQueueManager: finishProcess"),this.isInProgress=!1,this.currentDownloadItem=null,this.onFinish(e),this.datapoint.end(),this.datapoint=null,this.downloadFailures.length&&this.removeFromAttachmentWellAndShowError(this.downloadFailures),this.downloadFailures=[]}removeRelatedItemFromDownloadQueue(e,t){for(let n=0;n<t.length;n++){t[n].attachmentState.attachmentId===e.attachmentId&&t.splice(n,1)}}removeFromAttachmentWellAndShowError(e){const t=[],n=[];e.map(e=>{const r=e.item.attachment&&e.item.attachment.model.Name;1===e.reason?t.push(r):0===e.reason&&n.push(r),Object(m.a)(this.attachmentWellViewState,e.item.attachmentState)}),t.length>0&&Object(i.a)(this.infoBar,"ErrorSmimeHasCloudOrUriAttachments",[Object(a.c)(Object(a.b)(h.a),t.join(", "))]),n.length>3?Object(i.a)(this.infoBar,"ErrorAttachmentDownloadFailedMultipleFiles",[Object(a.c)(Object(a.b)(C.b),n.length)]):n.length>0&&Object(i.a)(this.infoBar,"ErrorAttachmentDownloadFailed",[Object(a.c)(Object(a.b)(C.a),n.join(", "))])}getAttachmentId(e,t){const n=e,r=n.AttachmentIdToAttach&&Object(p.a)({Id:n.AttachmentIdToAttach});let a;switch(e.__type){case E.b:case E.c:a=r;break;default:a=r||e.AttachmentId}return Object.assign(Object.assign({},a),{mailboxInfo:t.mailboxInfo})}getItemId(e){const t=e;return t.Item?t.Item.ItemId:t.ItemId}}n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return F}));const D={};function N(e,t,n,c,u){if(!t)return Object(o.a)(n),Object(i.a)(n,"WarningFilesCanNotBeAttachedGenericError",[Object(a.b)(r.a)]),[];return M(e,t,n).enqueueSmimeAttachmentDownload(c,u)}function F(e,t,n,r,a){M(e,n,r).deleteSmimeAttachment(t,a)}function M(e,t,n){let r=D[t.Id];return r||(c.h.info("Creating SmimeAttachmentQueueManager"),r=function(e,t,n){return new k(e,t,n)}(e,t,n),D[t.Id]=r,r.onFinishPromise.then(()=>{c.h.info("Deleting SmimeAttachmentQueueManager"),delete D[t.Id]})),r}},10213:function(e,t,n){"use strict";var r=n(20),a=n(7208),i=n(4581),o=n(23),c=n(1264),u=n(37),s=n(2031),l=n(36),d=n(0),f=n(8447),m=n(282),b=n(6),h=n(7209),p=n(7628),O=n(9991),g=n(7629);var v=n(8932),I=n(71),S=n(2574),w=n(1928),j=n(7631),y=n(8934),C=n(1713),A=n(2604),T=n(4941),P=n(326),E=n(2803),x=n(935),R=n(40);const k="/"+["mail",...Object(x.a)().split("/").slice(1)].join("/")+"deeplink/saveAndEdit/";var D=n(8448);function N(e,t,n,r){const a=Object(s.k)(r);switch(e){case i.a.addToCalendar:Object(y.a)(t,j.a.SurfaceAction);break;case i.a.download:!async function(e,t){var n,r;const a=Object(C.a)(e.attachmentId);if(!a)return void l.d("AttachmentSurfaceActionButton.downloadAttachment attachmentModel is null");await Object(T.a)(e.attachmentId,e.isCloudy,document.body);const i=Object(A.a)(a);Object(I.o)("AttachmentDownload",{entryPoint:"SurfaceAction",isCloudy:e.isCloudy,isCompose:!e.isReadOnly},{cosmosOnlyData:JSON.stringify({size:a.model.Size,fileType:i,attachmentId:null===(n=a.model.AttachmentId)||void 0===n?void 0:n.Id}),isCore:!0});const o=null==t?void 0:t.Id;S.a.importAndExecute("SavedAttachment",{itemId:o&&await Object(E.a)(o),customProperties:{FileId:null===(r=a.model.AttachmentId)||void 0===r?void 0:r.Id,FileType:i,Destination:"Local",Sender:Object(D.a)(o)}})}(t,n);break;case i.a.saveToCloud:!function(e,t,n){var r;const a=Object(C.a)(e.attachmentId);if(!a)return void l.d("AttachmentSurfaceActionButton.saveToCloud attachmentModel is null");Object(I.o)("AttachmentSaveToCloud",{entryPoint:"SurfaceAction"},{cosmosOnlyData:JSON.stringify({size:a.model.Size,fileType:Object(A.a)(a),attachmentId:null===(r=a.model.AttachmentId)||void 0===r?void 0:r.Id}),isCore:!0}),Object(w.B)(Object(w.p)(e.attachmentId),.1,t=>{Object(w.x)(e,t)},e.attachmentId),Object(w.u)(e,t=>{Object(w.C)(e.attachmentId,t)},"SurfaceAction",t,Object(D.a)(null==t?void 0:t.Id),n)}(t,n,a);break;case i.a.editAndReply:!async function(e,t,n){const r=await T.c.import();Object(I.o)("WovenEditAndReplyFromSurface",{},{isCore:!0});const a={viewState:e,attachmentSelectionSource:s.b.ReadingPane,parentItemId:t,isDraft:!1,isEdit:!0,onBeforePreview:()=>null,createImageGallery:()=>null,instrumentationContext:null,targetWindow:window};r(a)}(t,n);break;case i.a.openNewTabAndSaveToCloud:!function(e,t,n){const r=Object(P.a)();!function(e,t,n){let r=`${k}`;r+=`${encodeURIComponent(null==n?void 0:n.Id)}/${encodeURIComponent(e)}/${encodeURIComponent(t)}/${Object(R.b)().search}`,window.open(r,"_blank")}(e.attachmentId.Id,r,t);const a=new I.b("WovenNewTabSaveToCloud",{isCore:!0});Object(w.B)(4*Object(w.p)(e.attachmentId),.1,t=>{Object(w.x)(e,t)},e.attachmentId),Object(w.D)(e,t=>{Object(w.C)(e.attachmentId,t),t?a.end():a.endWithError("ServerError")},"PencilExperiment",t,r,Object(D.a)(null==t?void 0:t.Id),n)}(t,n,a);break;case i.a.openAndEdit:!function(e){const t=Object(C.a)(e.attachmentId).model.AttachmentOriginalUrl,n=-1===t.indexOf("?")?"?":"&";window.open(t+n+"web=1","_blank"),Object(I.o)("WovenOpenAndEditFromSurface",{},{isCore:!0})}(t);break;default:Object(m.a)(e)}}var F=n(1900),M=n(9992),_=n.n(M),L=n(166);const U=n.n(L).a.bind(_.a);var V=Object(o.a)((function(e){const t=d.useContext(F.a),n=n=>{n.keyCode!==u.a.enter&&n.keyCode!==u.a.space||(l.h.info("AttachmentSurfaceActionButton.keyDown enter|space"),n.stopPropagation(),N(e.action,e.attachmentViewState,e.parentItemId,t))},r=n=>{l.h.info("AttachmentSurfaceActionButton.onclick"),n.stopPropagation(),N(e.action,e.attachmentViewState,e.parentItemId,t)},a=()=>Object(f.b)(e.attachmentViewState,e.isForImageView),o=()=>{e.shouldNotHandleOnBlur||Object(f.a)(e.attachmentViewState,e.isForImageView)},{action:I,attachmentViewState:S,customClassName:w,isForImageView:j,previewState:y}=e;if(Object(v.a)(I,S))return null;{let e;const t=function(e){switch(e){case s.a.Edit:return _.a.edit;case s.a.NotSelectedAndSaving:return _.a.notSelectedAndSaving;case s.a.OtherSaving:return _.a.attachmentView;case s.a.Selected:return _.a.selected;case s.a.SelectedAndPending:return _.a.selectedAndPending;case s.a.SelectedAndSaving:return _.a.selectedAndSaving;default:return _.a.default}}(y);if(j){const t={extraRightPadding:B(I,S)};e=U([_.a.actionButton,_.a.actionButtonForImageView,w,t])}else e=S.isReadOnly?U([_.a.actionButton,t,w]):U([_.a.actionButton,t,_.a.actionButtonForDocViewInCompose,w]);const u=function(e,t){switch(e){case i.a.addToCalendar:return"AddEvent";case i.a.download:return"Download";case i.a.saveToCloud:return"CloudUpload";case i.a.openNewTabAndSaveToCloud:return"Edit";case i.a.editAndReply:return"PencilReply";case i.a.openAndEdit:return Object(g.a)(t)?"CloudEdit":"Cloud";default:return Object(m.a)(e)}}(I,S.attachmentId),l=function(e,t){switch(e){case i.a.addToCalendar:return Object(b.b)(h.a);case i.a.download:return Object(b.b)(p.a);case i.a.saveToCloud:return Object(b.b)(O.d);case i.a.openNewTabAndSaveToCloud:return Object(b.b)(O.c);case i.a.editAndReply:return Object(b.b)(O.a);case i.a.openAndEdit:return Object(g.a)(t)?Object(b.b)(O.b):Object(b.b)(O.e);default:return Object(m.a)(e)}}(I,S.attachmentId);return d.createElement(c.a,{onFocus:a,onBlur:o,onKeyDown:n,ariaLabel:l,title:l,onClick:r,className:e,iconProps:{iconName:u,styles:{root:_.a.icon}}})}}));function B(e,t){return(e===i.a.saveToCloud||e===i.a.editAndReply||e===i.a.openNewTabAndSaveToCloud||e===i.a.openAndEdit)&&!Object(v.a)(i.a.download,t)}var W=n(6754),G=n(4086);n.d(t,"c",(function(){return z})),n.d(t,"h",(function(){return q})),n.d(t,"g",(function(){return a.a})),n.d(t,"f",(function(){return i.a})),n.d(t,"b",(function(){return V})),n.d(t,"a",(function(){return W.a})),n.d(t,"d",(function(){return G.c})),n.d(t,"e",(function(){return G.g}));const H=new r.c(()=>Promise.all([n.e(20),n.e(433)]).then(n.bind(null,19488))),z=Object(r.d)(H,e=>e.AttachmentView),q=new r.b(H,e=>e.getContextMenus)},10297:function(e,t,n){"use strict";var r=n(71),a=n(1798),i=n(225),o=n(47),c=n(1808),u=n(36);async function s(e,t,n=!1){const s=[],l=await a.g.import(),d=await a.j.import(),f=n?await a.m.import():null,m=n?null==e?void 0:e.docViewAttachments:null==e?void 0:e.imageViewAttachments;for(let t=0;t<(null==m?void 0:m.length);t++){const r=m[t],a=l(r.attachmentId);if(n&&!f(a.model))continue;try{await d(r.attachmentId,e.isReadOnly)}catch(e){u.h.warn(`Unable to refresh thumbnail image for ${r.attachmentId}. Got error ${e}`)}const i={downloadUrl:a.download.url,id:r.attachmentId,previewUrl:a.previewImage.url,thumbnailUrl:a.thumbnailImage.url};s.push(i)}let b=0;const h=new r.b("BeautifulImageLinksShownInPreview"),p=(await c.y.import())(t);if((Object(o.j)("doc-deprecateCloudy-preview")||Object(o.j)("doc-deprecateCloudy-preview-thumbnailView"))&&p){const e=await c.z.import(),t=p.linkIds.concat(p.quotedBodyLinkIds),n=await c.C.import();for(let r=0;r<t.length;r++){const a=e(t[r]);if(n(a.fileName,a.providerType)){b++;const e={downloadUrl:a.url,id:{Id:t[r],RootItemId:t[r],mailboxInfo:Object(i.d)()},previewUrl:a.previewUrl,thumbnailUrl:a.thumbnailUrl};e.previewUrl&&s.push(e)}}}return h.addCustomData({countOfImageLinks:b}),h.end(),s}n.d(t,"a",(function(){return s}))},10622:function(e,t,n){"use strict";var r=n(3766),a=n(283);t.a=async e=>{const t={method:"GET"};t.headers=new Headers,t.headers.set(r.c,r.d),t.headers.set("Content-Type","application/json;charset=utf-8");const n=await fetch(e,t);if(!Object(a.a)(n.status))throw new Error(`The data package cannot be retrieved. StatusCode: ${n.status}`);return await n.text()}},10623:function(e,t,n){"use strict";var r=n(1941),a=n(2234),i=n(2887),o=n(7031),c=n(2257),u=n(1784),s=n(2413),l=n(2691),d=n(1713),f=n(702),m=n(1857);t.a=Object(f.action)("updateSmimeAttachment")((function(e,t,n,f,b){Object(o.a)(n,b)&&Object(l.a)(e.attachmentId);const h=Object(m.a)(n);if(n.AttachmentId=t,n.Name=f.Name||n.Name,n.Size=f.Size||n.Size,n.ContentType=f.ContentType||n.ContentType,n.__type=f.__type||n.__type,2===h?n.MimeContent=f.MimeContent:0===h&&(n.Content=f.Content),n.IsInline&&(n.ContentId=f.ContentId||n.ContentId),Object(s.a)([{attachmentId:t,attachment:n}],!1),e.attachmentId=t,Object(c.a)(e))Object(a.a)(e,1);else{const n=Object(d.a)(t);Object(u.h)(e,!1),Object(i.a)(e,0),Object(r.a)(e,n,!1,[])}}))},10624:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"AttachmentId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1087:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(263);function a(e){if(e){const t=Object(r.a)();for(const n of t.tabs)if(n.id==e)return n}return null}},10925:function(e,t,n){"use strict";n.r(t);var r=n(23),a=n(1746),i=n(71),o=n(10213),c=n(1798),u=n(1713),s=n(7335),l=n(3303),d=n(702),f=Object(d.action)("setCanOverrideAllowShowMultipleRows")((function(e,t){e.canOverrideAllowShowMultipleRows=t})),m=Object(d.action)("setDidViewOverflowOneRow")((function(e,t){e.didViewOverflowOneRow=t})),b=n(8329),h=n(4606),p=n(10297),O=n(1742),g=n(6),v=n(1758),I=n(1900),S=n(1e3),w=n(10208),j=n(2031),y=n(2551),C=n(3325),A=n(2713),T=n(2117),P=n(225),E=n(36),x=n(47);const R=500;function k(e,t,n,r,a,o){var c;const s=Object(T.a)(o);if(s.pendingNavigation&&Object(P.e)(s.pendingNavigation.toAttachmentId,e)&&s.pendingNavigation.triggerTime+R>=(new Date).getTime())return C.a.PendingNavigation;if(!Object(y.a)(o))return C.a.None;const l=s.extendedViewState.attachmentId,d=null===(c=s.pendingPreviewOperation)||void 0===c?void 0:c.attachmentId;return Object(P.e)(l,e)?s.editState.mode===A.a.View||s.editState.mode===A.a.EnteringEdit?function(e,t,n,r,a,o){const c=Object(u.a)(e);if(c&&1===c.type){if(Object(x.j)("doc-SxS-jsApi-ODB-BaseNoEditString"))return!1;const e=Object(T.a)(o).viewState.previewPane;return e&&!1===e.readOnly}if(!c){const o=e?e.Id:"UNDEFINED";E.h.warn("AttachmentModel not found in getAttachmentPreviewMode"),Object(i.o)("AttchmentModelMissingInRenderAttachmentWell",{attachmentId:o,composeId:t,isInitialized:n,isReadOnly:r,isGroup:a},{isCore:!0})}return!1}(e,t,n,r,a,o)?C.a.Edit:C.a.Selected:s.editState.mode===A.a.Saving?Object(P.e)(d,e)?C.a.SelectedAndSaving:C.a.NotSelectedAndSaving:C.a.Edit:Object(P.e)(d,e)?C.a.SelectedAndPending:C.a.None}var D=n(6218),N=n(0),F=n(1266),M=n(4054),_=n(1754),L=n(1913),U=n(52),V=n(610);var B=n(17694),W=Object(d.action)("setAllowShowMultipleRows")((function(e,t){e.allowShowMultipleRows=t})),G=n(17695),H=n(12516),z=n(1696);function q(e,t,n){const r=e.docViewAttachments.length+e.imageViewAttachments.length;let a=0;if(!(e.docViewAttachments.some(e=>e.isCloudy)||e.imageViewAttachments.some(e=>e.isCloudy))){const t=function(e,t){const n=Object(u.a)(t.attachmentId);return e+(null==n?void 0:n.model.Size)};a=e.docViewAttachments.reduce(t,0),a=e.imageViewAttachments.reduce(t,a)}const i=t&&!n;if(a>0){const e=i?Object(g.b)(G.c):Object(g.b)(G.a),t=Object(z.i)(a);return Object(g.c)(e,r,t)}{const e=i?Object(g.b)(G.b):Object(g.b)(H.a);return Object(g.c)(e,r)}}function Q(e,t){return e.some(e=>Object(P.e)(e.attachmentId,t))}function J(e,t){return e.canOverrideAllowShowMultipleRows?e.allowShowMultipleRows||function(e,t){return!!t&&(Q(e.docViewAttachments,t)||Q(e.imageViewAttachments,t))}(e,t):e.allowShowMultipleRows}var K=n(131),$=n(12517),X=n.n($),Y=n(166),Z=n.n(Y);const ee=Z.a.bind(X.a);var te=Object(r.a)((function(e){const t=t=>{W(e.attachmentWellViewState,!0)},n=t=>{W(e.attachmentWellViewState,!1),f(e.attachmentWellViewState,!1)},r=e.attachmentWellViewState.didViewOverflowOneRow,i=J(e.attachmentWellViewState,e.attachmentIdBeingPreviewed),o=q(e.attachmentWellViewState,r,i),c={iconProps:{}},u=Object(x.j)("mon-attachment-ux-redesign");function s(e){if(!u)return X.a.barButton;switch(e){case"full":return X.a.barButtonFull;case"medium":return X.a.barButtonMedium;case"compact":return X.a.barButtonCompact;default:return X.a.barButton}}let l,d;return r?(i?(c.onClick=n,c.iconProps.iconName="DoubleChevronUp",d={role:a.a.button,expanded:!0}):(c.onClick=t,c.iconProps.iconName="DoubleChevronDown",d={role:a.a.button,expanded:!1}),c.disabled=!1,l=ee(s(Object(K.e)()),X.a.barButtonHover,X.a.chevronButtonOuter)):(c.disabled=!0,l=ee(s(Object(K.e)()))),N.createElement(N.Fragment,null,N.createElement(F.a,Object.assign({},Object(a.b)(d),{className:l,disabled:c.disabled,iconProps:{iconName:c.iconProps.iconName,styles:{root:ee(function(e){if(!u)return X.a.chevronButton;switch(e){case"full":return X.a.chevronButtonFull;case"medium":return X.a.chevronButtonMedium;case"compact":return X.a.chevronButtonCompact;default:return X.a.chevronButton}}(Object(K.e)()))}},onClick:c.onClick}),o))})),ne=n(17697),re=n(6216),ae=n(17698),ie=n(10020),oe=n(7204),ce=n(12159),ue=n(282),se=n(1784),le=n(5248),de=n(296),fe=n(703);function me(e,t,n){const r=Object(g.b)(ie.a);switch(n){case 1:return Object(de.a)()?Object(g.c)(Object(g.b)(ae.g),Object(se.g)(),r):t?Object(g.b)(ae.f):Object(g.c)(Object(g.b)(ae.h),Object(g.b)(oe.a));case 3:return t?Object(g.b)(ae.b):Object(g.c)(Object(g.b)(ae.c),Object(de.a)()?r:Object(g.b)(oe.a));case 2:if(t)return Object(g.b)(ae.d);let a=function(e){const t=Object(le.c)(e);return t?t.folderName:(Object(le.b)(e),null)}(e);return Object(fe.a)(a)&&(a=Object(g.b)(ce.a)),Object(g.c)(Object(g.b)(ae.e),a);case 4:return Object(g.b)(ae.a);case 0:throw new Error("Unsupported SaveAllToCloudStatus: "+n);default:return Object(ue.a)(n),""}}var be=n(1928),he=n(2896);function pe(e,t){return Oe(e.docViewAttachments,t)||Oe(e.imageViewAttachments,t)}function Oe(e,t){const[n]=e.filter(e=>Object(P.e)(e.attachmentId,t));return n}var ge=n(12123);async function ve(e,t,n,r){return new Promise((a,o)=>{const c=[];let u={operationFailed:!1,error:void 0};const s=new i.b("AttachmentSaveAllToCloud");!function(e,t){const n=e.totalClassicAttachmentSize/256;Ie(e.docViewAttachments,t,n),Ie(e.imageViewAttachments,t,n)}(e,c);const l=Object(ge.b)(c,u,s,e.totalClassicAttachmentSize,t=>pe(e,t),n,r,be.C),d=Object(ge.a)(c,s,e.totalClassicAttachmentSize,t=>pe(e,t),n,r,be.C);Object(he.b)(null,t,r,l,d,(e,t,n)=>{a([e,t,n,c])})})}function Ie(e,t,n){e.forEach(e=>{t.push(e.attachmentId),Object(be.w)(e),Object(be.B)(n,.1,t=>{Object(be.x)(e,t)},e.attachmentId)})}var Se=Object(d.action)("setSaveAllToCloudStatus")((function(e,t){e.saveAllToCloudStatus=t})),we=n(35);function je(e,t){return n={itemId:e},r=t,Object(we.a)("CancelSaveAttachmentsToCloud",n,r);var n,r}var ye=n(1761),Ce=n(704);const Ae=Z.a.bind(X.a);var Te=Object(r.a)((function(e){const t=N.useRef(),n=N.useRef(),r=N.useRef(),a=N.useRef(),o=t=>{Se(e.attachmentWellViewState,t?3:2)},c=e.attachmentWellViewState.imageViewAttachments.concat(e.attachmentWellViewState.docViewAttachments),u=c.length>1,s=c.every(be.t)&&u;const l=Object(x.j)("mon-attachment-ux-redesign"),d={barButton:!l,barButtonFull:l&&"full"===Object(K.e)(),barButtonMedium:l&&"medium"===Object(K.e)(),barButtonCompact:l&&"compact"===Object(K.e)()},f={downloadAllButtonFull:l&&"full"===Object(K.e)(),downloadAllButtonMedium:l&&"medium"===Object(K.e)(),downloadAllButtonCompact:l&&"compact"===Object(K.e)()},m=l?{iconName:"Cloud",styles:{root:Ae(f)}}:{},b=Ae(d,X.a.barButtonHover);return N.createElement("span",null,(t=>{var n;return!!t&&(0==e.attachmentWellViewState.saveAllToCloudStatus&&("GroupMailbox"!=(null===(n=e.parentItemId.mailboxInfo)||void 0===n?void 0:n.type)||!Object(de.a)()))})(s)&&N.createElement(F.a,{iconProps:m,className:b,onClick:async c=>{Se(e.attachmentWellViewState,1),Object(i.o)("AttachmentWellSaveAllToCloud",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize]),[t.current,n.current,r.current,a.current]=await ve(e.attachmentWellViewState,e.parentItemId,o,e.sxsId)}},(()=>{var t;const n="GroupMailbox"===(null===(t=e.parentItemId.mailboxInfo)||void 0===t?void 0:t.type);if(Object(de.a)())return Object(g.b)(ne.b);if(n)return Object(g.b)(ne.a);{const e=Object(g.b)(ne.c);return Object(g.c)(e,Object(se.g)())}})()),(()=>{const t=e.attachmentWellViewState.saveAllToCloudStatus;return 1===t||3===t||2===t||4===t})()&&N.createElement(F.a,{iconProps:m,className:b,disabled:!0},me(e.parentItemId.mailboxInfo.mailboxSmtpAddress,"GroupMailbox"===(null===(h=e.parentItemId.mailboxInfo)||void 0===h?void 0:h.type),e.attachmentWellViewState.saveAllToCloudStatus)),(()=>1===e.attachmentWellViewState.saveAllToCloudStatus)()&&N.createElement(F.a,{iconProps:m,className:b,onClick:o=>{je(e.parentItemId.Id,Object(Ce.a)(e.parentItemId.mailboxInfo)).then(i=>{i&&(ye.k.importAndExecute(n.current,r.current),Object(he.a)(t.current),a.current.forEach(t=>{const n=pe(e.attachmentWellViewState,t);Object(be.A)(n,0,5),Object(be.C)(t,!1)}),Se(e.attachmentWellViewState,4))}),Object(i.o)("AttachmentWellCancelSaveAllToCloud",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize])}},Object(g.b)(re.a)));var h}));var Pe=n(2614);const Ee=Z.a.bind(X.a);var xe=Object(r.a)((function(e){const t=N.useRef(),n=N.useRef(),r=N.useRef(),a=a=>{let o;for(let c=0;c<a.length;c++){o=a[c];const s=Object(u.a)(o.attachmentId);if(s&&s.info&&s.info.allowDownload||(r.current=!1,s||e.isDraft||Object(i.o)("AttachmentBarMissingModel",{id:o.attachmentId.Id})),!r.current)break;o.isCloudy?t.current++:n.current++}},o=e.attachmentWellViewState.imageViewAttachments.length+e.attachmentWellViewState.docViewAttachments.length>1;t.current=0,n.current=0,r.current=!0;const s=e.attachmentWellViewState.docViewAttachments.some(e=>{const t=Object(u.a)(e.attachmentId);return t&&Object(c.c)(t.model)});a(e.attachmentWellViewState.imageViewAttachments),a(e.attachmentWellViewState.docViewAttachments);const l=r.current&&n.current>1&&0===t.current&&!s,d=Object(x.j)("mon-attachment-ux-redesign"),f={barButton:!d,barButtonFull:d&&"full"===Object(K.e)(),barButtonMedium:d&&"medium"===Object(K.e)(),barButtonCompact:d&&"compact"===Object(K.e)()},m={downloadAllButtonFull:d&&"full"===Object(K.e)(),downloadAllButtonMedium:d&&"medium"===Object(K.e)(),downloadAllButtonCompact:d&&"compact"===Object(K.e)()},b={attachmentWellBar:!d,attachmentWellBarDensityFull:d&&"full"===Object(K.e)(),attachmentWellBarDensityMedium:d&&"medium"===Object(K.e)(),attachmentWellBarDensityCompact:d&&"compact"===Object(K.e)()},h=d?{iconName:"Download",styles:{root:Ee(m)}}:{};return N.createElement("span",{className:Ee(b)},o&&N.createElement(te,{attachmentWellViewState:e.attachmentWellViewState,attachmentIdBeingPreviewed:e.attachmentIdBeingPreviewed}),l&&N.createElement(F.a,{className:Ee(f,X.a.barButtonHover),onClick:t=>{let n=null;const r="service.svc/s/GetAllAttachmentsAsZip?id="+encodeURIComponent(e.parentItemId.Id);if(Object(x.j)("doc-attachment-downloadAllFromDownloadDomain"))n=Object(Pe.d)(e.parentItemId,r,!0);else{const e=Object(_.d)()?Object(L.c)()+"/":"";n=`${Object(V.t)("/owa/")}/${e}${r}&X-OWA-CANARY=${Object(U.a)()}`}Object(M.a)(n,!1),Object(i.o)("AttachmentWellDownloadAll",[e.attachmentWellViewState.docViewAttachments.length+e.attachmentWellViewState.imageViewAttachments.length,e.attachmentWellViewState.totalClassicAttachmentSize])},iconProps:h},Object(g.b)(B.a)),!s&&N.createElement(Te,{attachmentWellViewState:e.attachmentWellViewState,parentItemId:e.parentItemId,sxsId:e.sxsId}))}));var Re=n(17699),ke=n(17700),De=n.n(ke);const Ne=Z.a.bind(De.a);var Fe=Object(r.a)((function(e){const t=N.useContext(I.a),n=Object(j.k)(t);let r=!1,d=3;N.useEffect(()=>(setTimeout(()=>{const t=(e.attachmentWellViewState.docViewAttachments||[]).map(e=>e.attachmentId);D.b.importAndExecute(t)},2e3),S.a.importAndExecute(L),()=>{r=!0,S.c.importAndExecute(L)}),[]),N.useEffect(()=>{U()});const b=N.useRef(),O=N.useRef(),y=N.useRef({}),C=t=>{const{attachmentWellViewState:n,parentItemId:r,infoBar:a,onAttachmentDeletedCallback:i,isDeletionDisabled:o}=e,u=n.imageViewAttachments.slice(0),l=n.docViewAttachments.slice(0);if(!o)if(Object(c.b)(t.attachmentId.Id))Object(w.b)(n,t,r,a,i);else{const e=(e,n,r)=>{i(e,n,r),setTimeout(()=>{P(t,u,l)},0)};Object(s.b)(n,t,r,a,e)}},A=(t,n,r,a)=>{Object(h.a)(e.attachmentWellViewState,t,n,r,a)},T=t=>{const n=Object(u.a)(t.attachmentId);e.onAttachmentDeletedCallback(e.parentItemId,t.attachmentId,n.model),Object(l.a)(e.attachmentWellViewState,t)},P=async(t,r,a)=>{var i;const o=r.indexOf(t),c=a.indexOf(t);o>-1&&r.splice(o,1),c>-1&&a.splice(c,1);const u=function(e,t,n,r){return n>-1?0===e.length?t[0]:n<e.length?e[n]:e[n-1]:0===t.length?e[e.length-1]:r<t.length?t[r]:t[r-1]}(r,a,o,c);if(Object(j.o)(t.attachmentId,n)){(await j.u.import())("deleteAttachment",n)}(null===(i=null==u?void 0:u.attachmentId)||void 0===i?void 0:i.Id)&&y.current[u.attachmentId.Id]?y.current[u.attachmentId.Id]():e.onLostFocus&&e.onLostFocus()},E=e=>{b.current=e},R=e=>{O.current=e},F=()=>{f(e.attachmentWellViewState,!0)},M=async()=>{let t;return t=e.linksContainerId?e.linksContainerId:e.parentItemId.Id,Object(p.a)(e.attachmentWellViewState,t)},_=()=>J(e.attachmentWellViewState,Object(j.l)(n).extendedViewState.attachmentId),L=()=>{d=3,U()},U=()=>{setTimeout(()=>{r?Object(i.o)("CheckWhetherWellViewOverflowOneRowWhenUnmouted",{allowedRetryTimes:d}):V()},1+1e3*(3-d))},V=()=>{let t=!1;if(e.attachmentWellViewState.imageViewAttachments.length>0)if(Le(b.current)){if(_e(b.current))return void m(e.attachmentWellViewState,!0)}else t=!0;if(e.attachmentWellViewState.docViewAttachments.length>0)if(Le(O.current)){if(_e(O.current))return void m(e.attachmentWellViewState,!0);t||m(e.attachmentWellViewState,!1)}else t=!0;t&&(--d>=0?(Object(i.o)("AttachmentWellRetryToCheckWhetherViewOverflowOneRow"),U()):Object(i.o)("AttachmentWellRetryToCheckWhetherViewOverflowOneRowFailed"))},B=(e,t)=>{y.current[e]=t},{attachmentWellViewState:W}=e,G={attachmentWellInCompose:!e.attachmentWellViewState.isReadOnly};if(e.attachmentWellViewState.imageViewAttachments.length+e.attachmentWellViewState.docViewAttachments.length===0)return null;{const t=Object(x.j)("mon-attachment-ux-redesign"),r={allowShowMultipleRows:_()},i={oneRowViewImageHeight:!t&&!_(),oneRowViewImageHeightFull:t&&!_()&&"full"===Object(K.e)(),oneRowViewImageHeightMedium:t&&!_()&&"medium"===Object(K.e)(),oneRowViewImageHeightCompact:t&&!_()&&"compact"===Object(K.e)()},c={oneRowViewDocHeight:!t&&!_(),oneRowViewDocHeightFull:t&&!_()&&"full"===Object(K.e)(),oneRowViewDocHeightMedium:t&&!_()&&"medium"===Object(K.e)(),oneRowViewDocHeightCompact:t&&!_()&&"compact"===Object(K.e)()};return N.createElement("div",{tabIndex:-1,className:Ne([De.a.attachmentWell,G,"disableTextSelection",Object(v.a)()&&De.a.unstackedReadingPane]),onClick:Me},W.imageViewAttachments.length>0?N.createElement("div",{role:a.a.listbox,"aria-label":Object(g.b)(Re.a),className:Ne(De.a.oneRowView,r,i),ref:E},W.imageViewAttachments.map(t=>N.createElement(o.c,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:C,onReplaceAttachment:A,onDragStart:Ue,instrumentationContext:e.instrumentationContext,onBeforePreview:F,isImage:!0,parentItemId:e.parentItemId,isDraft:e.isDraft,previewMode:k(t.attachmentId,W.composeId,W.isInitialized,W.isReadOnly,!!W.groupId,n),moveAttachmentToInlineHandler:e.moveAttachmentToInlineHandler,createImageGallery:M,registerFocusFunction:B,onConvertClassicToLink:e.onConvertClassicToLink,deleteAttachmentFromWellHandler:T}))):null,W.docViewAttachments.length>0?N.createElement("div",{role:a.a.listbox,"aria-label":Object(g.b)(Re.a),className:Ne(De.a.oneRowView,r,c),ref:R},e.attachmentWellViewState.docViewAttachments.map(t=>N.createElement(o.c,{key:t.attachmentId.Id,attachmentViewState:t,onDeleteButtonClicked:C,onReplaceAttachment:A,onDragStart:Ue,instrumentationContext:e.instrumentationContext,onBeforePreview:F,isImage:!1,parentItemId:e.parentItemId,isDraft:e.isDraft,previewMode:k(t.attachmentId,W.composeId,W.isInitialized,W.isReadOnly,!!W.groupId,n),createImageGallery:M,registerFocusFunction:B,referenceAttachmentsSupported:e.referenceAttachmentsSupported,onConvertClassicToLink:e.onConvertClassicToLink,deleteAttachmentFromWellHandler:T}))):null,W.isReadOnly&&W.imageViewAttachments.length+W.docViewAttachments.length>0?N.createElement(xe,{attachmentWellViewState:W,parentItemId:e.parentItemId,isDraft:e.isDraft,attachmentIdBeingPreviewed:Object(j.l)(n).extendedViewState.attachmentId,sxsId:n}):null)}}));function Me(e){e.stopPropagation()}function _e(e){return!!e&&e.children.length>0&&e.scrollHeight>2*e.children[0].clientHeight}function Le(e){return!!e&&e.children.length>0}function Ue(e){const t=Object(b.a)(e);return{itemType:O.a.Attachment,attachmentFile:t}}var Ve=n(17702),Be=n.n(Ve);const We="{0}; ";var Ge=n(11884),He=n.n(Ge);var ze=function(e){const{attachmentWellViewState:t}=e;if(t.imageViewAttachments.length+t.docViewAttachments.length===0)return null;{const e=Be.a;return N.createElement("div",{className:He.a.panel},N.createElement("div",null,N.createElement("img",{src:e,className:He.a.attachIcon}),N.createElement("span",{className:He.a.attachmentCountLabel},q(t,!1,!1))),N.createElement("div",{className:He.a.attachmentCollectionContainer},N.createElement("span",{className:He.a.attachmentCollectionLabel},function(e){let t="";return[...e.docViewAttachments,...e.imageViewAttachments].forEach(e=>{const n=Object(u.a)(e.attachmentId);n&&(t+=Object(g.c)(We,n.model.Name))}),t}(t))))}};n.d(t,"AttachmentWellView",(function(){return Fe})),n.d(t,"AttachmentWellPrintView",(function(){return ze}))},11884:function(e,t,n){var r=n(11885);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(77)(r,a);r.locals&&(e.exports=r.locals)},11885:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._2uuSN_W2PUZUCI7j-1hdRM{font-size:12px;font-weight:400}html[dir] ._2uuSN_W2PUZUCI7j-1hdRM{margin-top:20px;margin-bottom:20px}.XD_OxCfYiT_-8jfUrVzYX{vertical-align:middle}._3347b-MJgpuaz5oKXfCTJI{color:var(--neutralSecondary);vertical-align:middle}html[dir=ltr] ._3347b-MJgpuaz5oKXfCTJI{margin-left:7px}html[dir=rtl] ._3347b-MJgpuaz5oKXfCTJI{margin-right:7px}html[dir] ._6isp2U65BClj4lXNx6HmH{margin-top:5px}._2FzwNNMh24XRH7yMo-ab01{color:var(--neutralPrimary)}",""]),t.locals={panel:"_2uuSN_W2PUZUCI7j-1hdRM",attachIcon:"XD_OxCfYiT_-8jfUrVzYX",attachmentCountLabel:"_3347b-MJgpuaz5oKXfCTJI",attachmentCollectionContainer:"_6isp2U65BClj4lXNx6HmH",attachmentCollectionLabel:"_2FzwNNMh24XRH7yMo-ab01"}},12123:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(1959);function a(e,t,n,a,i,o,c,u){return s=>{const l=s.AttachmentId;let d=-1;const f=e.filter((e,t)=>e.Id===l&&(d=t,!0));if(f.length>0){e.splice(d,1);const n=i(f[0]),a=0===s.ResultCode;Object(r.b)(n,a,a?s.Item.Location:null,c),u&&u(f[0],a),0!==s.ResultCode&&(t.operationFailed=!0,s.Exception&&(t.error=s.Exception))}return 0===e.length&&(o(t.operationFailed),n.addCustomData([a,!t.operationFailed,s.ResultCode]),t.error?n.endWithError("ServerError",new Error(t.error)):n.end(),!0)}}function i(e,t,n,a,i,o,c){return(u,s,l)=>{e.forEach(e=>{const t=a(e);Object(r.b)(t,!1,null,o),c&&c(e,!1)}),i(!0),t.addCustomData([n,!1,s]),t.endWithError(l,new Error(u))}}},12133:function(e){e.exports=JSON.parse('{"a":"Dda","b":"Eda"}')},12159:function(e){e.exports=JSON.parse('{"a":"Tqa"}')},12516:function(e){e.exports=JSON.parse('{"a":"MZb"}')},12517:function(e,t,n){var r=n(17696);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(77)(r,a);r.locals&&(e.exports=r.locals)},1675:function(e,t,n){"use strict";var r=n(1866),a=n(1987),i=n(1683),o=n(3),c=n(908),u=Object(o.mutatorAction)("createFocusedOtherDropViewState",(function(){i.a.focusedOtherDropViewState=Object(c.a)()}));function s(){return i.a.focusedOtherDropViewState||u(),i.a.focusedOtherDropViewState}var l,d=n(2229);!function(e){e[e.None=0]="None",e[e.Previous=1]="Previous",e[e.Next=2]="Next"}(l||(l={}));var f=l,m=n(1994),b=n(2003),h=n(2004);function p(e){const t=i.a.tableViews.get(e);switch(null==t?void 0:t.tableQuery.type){case 2:return t.serverFolderId;case 0:return t.tableQuery.folderId;default:return null}}var O=n(1771);function g(){const e=Object(O.a)();return!!e&&1===e.tableQuery.type}var v=n(2633),I=n(2634),S=n(6),w=n(1681),j=n(2635),y=n(2636),C=n(2239),A=n(2240);function T(e,t,n){const{tableQuery:r,virtualSelectAllExclusionList:a,totalRowsInView:i}=t;if(e){if(-1!==n)return 0===n?Object(S.b)(v.a):Object(S.b)(y.a);if(1==r.type)return Object(S.b)(I.a);if(fe(t))return Object(S.c)(Object(S.b)(j.a),fe(t));const e=w.d.folderTable.get(r.folderId);return Object(S.c)(Object(S.b)(j.a),Object(w.h)(e))}if(H(t)){const e=i-a.length;return Object(z.a)(t)?Object(S.c)(Object(S.b)(A.c),e):Object(S.c)(Object(S.b)(C.c),e)}return Object(S.b)(I.a)}function P(e){switch(e.tableQuery.type){case 0:case 2:case 3:return e.tableQuery.sortBy;default:throw new Error("getSortByForTable: Table Query type should be either of type group, or mail folder")}}function E(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 3:case 1:return e.tableQuery.viewFilter;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function x(e){return e&&"Unread"==E(e)}var R=n(2241),k=n(7);function D(e,t){const n=Object(_.a)(e,t);let r=null;return be(i.a.tableViews.get(t).tableQuery.folderId)?r=Object(k.vb)(i.a.inboxPausedDateTime):n&&(r=new Date(n.lastModifiedTimeStamp).toISOString()),{conversationId:n.id,conversationLastSyncTimeStamp:r}}var N=n(36);function F(e,t){switch(t){case 0:case 1:return e.InstanceKey;default:return N.h.warn("listViewType:"+t+" not supported"),null}}var M=n(1831),_=n(1791),L=n(1956),U=n(2242);function V(e,t){const n=[];for(let r=0;r<e.length;r++){const a=t.rowIdToRowKeyMap.get(e[r]);a&&Array.prototype.push.apply(n,a)}return n}var B=n(2012),W=n(2230);function G(e){let t;switch(e){case 0:t="Conversation";break;case 1:t="Message";break;default:t="Unknown"}return t}function H(e){const{isInVirtualSelectAllMode:t,virtualSelectAllExclusionList:n}=e;return t&&n.length>0}var z=n(2167),q=n(1678),Q=n(1679);function J(e){return!!e&&(e.folderId===Object(q.a)(Q.b)||e.folderId===Object(q.a)(Q.i))}var K=n(1823),$=n(282);function X(e){switch(e){case 1:return"Date";case 3:return"From";case 5:return"Importance";case 7:return"Size";case 8:return"Subject";default:return Object($.a)(e)}}function Y(e){switch(e){case"All":case"Flagged":case"HasAttachment":case"ToOrCcMe":case"Unread":case"UserCategory":case"Focused":case"Mentioned":case"HasFile":return e;default:Object($.a)(e)}}function Z(e){switch(e){case-1:return"None";case 0:return"Focused";case 1:return"Other";default:Object($.a)(e)}}function ee(e){switch(e){case 0:return"Conversation";case 1:return"Message";case 2:return"CalendarItems";default:Object($.a)(e)}}function te(e){switch(e){case 0:return"Folder";case 1:return"Search";case 2:return"Group";case 3:return"GroupFolder";default:Object($.a)(e)}}function ne(e,t,n){const a=[];return t.forEach(t=>{const i=r.getItemIds(t,n);"Flagged"==e.FlagStatus?a.push(i[0]):a.push(...i)}),a}function re(e,t,n){return!Object(ae.a)(e)&&(t&&n)}var ae=n(2015),ie=n(2066),oe=n(1885),ce=n(1982);function ue(){return!Object(O.a)().isInCheckedMode&&i.a.expandedConversationViewState.selectedNodeIds.length>0}function se(e){const t=i.a.tableViews.get(e),n=Object(m.a)(t),{tableQuery:r,selectedRowKeys:a}=t,o=Object(b.a)(t);if(o||H(t))return T(o,t,n);const c=ue()?i.a.expandedConversationViewState.selectedNodeIds.length:a.size;return 1==r.listViewType||ue()?0===c?Object(S.b)(C.a):1===c?Object(S.b)(C.b):Object(S.c)(Object(S.b)(C.c),c):0===c?Object(S.b)(A.a):1===c?Object(S.b)(A.b):Object(S.c)(Object(S.b)(A.c),c)}function le(){return i.a.expandedConversationViewState.selectedNodeIds}function de(e,t){return e?-1!==Object(m.a)(e)||"All"!==t&&"UserCategory"!==t:null}function fe(e){return 0===e.tableQuery.type&&"UserCategory"===e.tableQuery.viewFilter?e.tableQuery.categoryName:null}var me=n(1698);function be(e){return i.a.inboxPausedDateTime&&e&&"inbox"===Object(me.a)(e)}var he=n(2243),pe=n(2014);function Oe(e,t){e.currentRowOperation=t,Promise.resolve().then(()=>{e.currentRowOperation=0})}const ge=Object(o.mutatorAction)("clearListViewVirtualization",e=>{e?(i.a.scrollTop=0,i.a.doNotVirtualize=!1):i.a.doNotVirtualize=!0,i.a.rowInfoForVLV.clear()});var ve=n(2023);const Ie=Object(o.mutatorAction)("addNodeAsFork",(e,t)=>{const n=t.shift();if(Object(ve.a)(e)&&n){const e=i.a.expandedConversationViewState.forks,r=e.map(e=>e.id);if((null==r?void 0:r.length)<=1){const n=t.shift();e.unshift({id:n,displayNames:[],ancestorIds:t}),i.a.expandedConversationViewState.selectedNodeIds.push(n)}-1==r.indexOf(n)&&e.unshift({id:n,displayNames:[],ancestorIds:[]})}});n.d(t,"o",(function(){return s})),n.d(t,"q",(function(){return d.a})),n.d(t,"L",(function(){return i.b})),n.d(t,"Z",(function(){return i.a})),n.d(t,"d",(function(){return f})),n.d(t,"n",(function(){return m.a})),n.d(t,"w",(function(){return b.a})),n.d(t,"k",(function(){return h.a})),n.d(t,"l",(function(){return h.b})),n.d(t,"p",(function(){return p})),n.d(t,"y",(function(){return g})),n.d(t,"G",(function(){return T})),n.d(t,"I",(function(){return O.a})),n.d(t,"K",(function(){return P})),n.d(t,"Q",(function(){return E})),n.d(t,"db",(function(){return x})),n.d(t,"m",(function(){return R.a})),n.d(t,"j",(function(){return D})),n.d(t,"E",(function(){return F})),n.d(t,"O",(function(){return M.a})),n.d(t,"M",(function(){return _.a})),n.d(t,"N",(function(){return L.a})),n.d(t,"D",(function(){return U.a})),n.d(t,"F",(function(){return V})),n.d(t,"X",(function(){return B.a})),n.d(t,"i",(function(){return W.a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"C",(function(){return G})),n.d(t,"W",(function(){return H})),n.d(t,"R",(function(){return z.a})),n.d(t,"S",(function(){return J})),n.d(t,"z",(function(){return K.b})),n.d(t,"x",(function(){return K.a})),n.d(t,"t",(function(){return X})),n.d(t,"v",(function(){return Y})),n.d(t,"r",(function(){return Z})),n.d(t,"s",(function(){return ee})),n.d(t,"u",(function(){return te})),n.d(t,"A",(function(){return ne})),n.d(t,"cb",(function(){return re})),n.d(t,"h",(function(){return ae.a})),n.d(t,"f",(function(){return ie.a})),n.d(t,"J",(function(){return oe.a})),n.d(t,"ab",(function(){return ce.a})),n.d(t,"B",(function(){return se})),n.d(t,"Y",(function(){return ue})),n.d(t,"H",(function(){return le})),n.d(t,"U",(function(){return de})),n.d(t,"P",(function(){return fe})),n.d(t,"V",(function(){return be})),n.d(t,"a",(function(){return he.a})),n.d(t,"T",(function(){return pe.a})),n.d(t,"bb",(function(){return Oe})),n.d(t,"g",(function(){return ge})),n.d(t,"e",(function(){return Ie}))},1683:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(16),a=n(3);const i={conversationItems:new r.ObservableMap({}),itemContextMenuState:null,selectedTableViewId:null,tableViewConversationRelations:new r.ObservableMap({}),tableViewItemRelations:new r.ObservableMap({}),tableViews:new r.ObservableMap({}),attachmentViewStates:new r.ObservableMap({}),expandedConversationViewState:{expandedRowKey:null,focusedNodeId:null,selectedNodeIds:[],allNodeIds:[],shouldBeExpanded:!1,busStopStateMap:new r.ObservableMap({}),forks:null},rowAttachmentPreviewWellViews:new r.ObservableMap({}),focusedOtherDropViewState:null,couponPeekPreviews:new r.ObservableMap({}),rowInfoForVLV:new r.ObservableMap({}),meetingMessageItems:new r.ObservableMap({}),offsetHeight:0,scrollTop:0,inboxPausedDateTime:null,inboxPausedLength:null,txpActionButtonData:new r.ObservableMap({}),lastIndexToRender:0,doNotVirtualize:!1};let o=Object(a.createStore)("listview",i);const c=o();t.a=c},1689:function(e,t,n){"use strict";var r=n(1849),a=n(1803),i=n(3);const o=Object(i.action)("INITIALIZE_SCENARIO_STORE",(e,t)=>({scenarioId:e,isUsing3S:t}));Object(i.mutator)(o,e=>{const t=Object(r.a)(e.scenarioId);Object(a.b)().scenarioStores.get(t)||(Object(a.b)().scenarioStores.set(t,Object.assign({},Object(a.a)())),Object(a.b)().scenarioStores.get(t).isUsing3S=e.isUsing3S)});var c=n(1891),u=n(2068);n.d(t,"a",(function(){return c.b})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return r.a})),n.d(t,"e",(function(){return o})),n.d(t,"d",(function(){return u.a}))},1703:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"d",(function(){return h}));var r=n(20);const a=new r.c(()=>n.e(812).then(n.bind(null,3375))),i=new r.b(a,e=>e.clearSearchBox),o=new r.b(a,e=>e.endSearchSession),c=new r.b(a,e=>e.onBackspacePressedSearchInput),u=new r.b(a,e=>e.onDownArrowPressedSearchInput),s=new r.b(a,e=>e.onLeftArrowPressedSearchInput),l=new r.b(a,e=>e.onUpArrowPressedSearchInput),d=new r.b(a,e=>e.removeSuggestionPillFromSearchBox),f=new r.b(a,e=>e.setIsSuggestionsDropdownVisible),m=new r.b(a,e=>e.setShowSearchBoxInCompactMode),b=new r.b(a,e=>e.updateIsSuggestionSetComplete),h=new r.b(a,e=>e.onDismissGhostTextViaKeyboard)},1704:function(e,t,n){"use strict";var r=n(3);const a=Object(r.action)("ADD_SUGGESTION_PILL",(e,t,n)=>({suggestionPill:e,suggestionSelected:t,scenarioId:n})),i=Object(r.action)("ADD_SUGGESTION_PILL_INTERNAL",(e,t)=>({suggestionPill:e,scenarioId:t})),o=Object(r.action)("CHANGE_SELECTED_SUGGESTION_VIA_KEYBOARD",(e,t,n)=>({indexToSelect:e,suggestionToSelect:t,scenarioId:n}));var c=n(2179);const u=Object(r.action)("DOWNLOAD_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n})),s=Object(r.action)("END_SEARCH_CONVERSATION",e=>({scenarioId:e}));var l=n(2180);const d=Object(r.action)("EXIT_SEARCH",(e,t,n=!1)=>({actionSource:e,scenarioId:t,forceExit:n})),f=Object(r.action)("GET_FILE_SUGGESTION_IMMERSIVE_VIEW",e=>({suggestion:e}));var m=n(2069),b=n(1689);const h=Object(r.mutatorAction)("OVERWRITE_EXISTING_SUGGESTION_PILL",(e,t,n)=>{const r=Object(b.d)(n),a=e.ReferenceId;r.suggestionPills.delete(t),r.suggestionPills.set(a,e);const i=r.suggestionPillIds.indexOf(t);r.suggestionPillIds[i]=a});var p=n(2181),O=n(2182);const g=Object(r.action)("ON_ENTER_PRESSED_SEARCH_INPUT",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t})),v=Object(r.action)("ON_ESCAPE_PRESSED_SEARCH_INPUT",e=>({scenarioId:e})),I=Object(r.action)("ON_KEY_DOWN_SEARCH_INPUT",(e,t)=>({evtKeyCode:e,scenarioId:t}));var S=n(2183);const w=Object(r.action)("ON_RESIZE_SUGGESTIONSCALLOUT",(e,t)=>({searchBoxWidth:e,scenarioId:t})),j=Object(r.action)("ON_Right_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}));var y=n(80);const C=Object(r.action)("ON_SEARCH_INPUT_FOCUSED",e=>Object(y.b)({name:"ON_SEARCH_INPUT_FOCUSED"},{scenarioId:e}));var A=n(2209),T=n(2210);const P=Object(r.action)("onSearchScopeUiDismissed",e=>({searchScenarioType:e})),E=Object(r.action)("ON_SEARCH_TEXT_CHANGED",(e,t)=>({searchText:e,scenarioId:t})),x=Object(r.action)("ON_SUGGESTIONS_CALLOUT_POSITIONED",e=>({scenarioId:e})),R=Object(r.action)("ON_SUGGESTIONS_CALLOUT_WILL_UNMOUNT",e=>({scenarioId:e}));var k=n(2184);const D=Object(r.action)("REGISTER_ADDITIONAL_QUICK_ACTIONS",(e,t)=>({scenarioId:e,callback:t}));var N=n(2185);const F=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_STORE",(e,t,n)=>({suggestionPillId:e,suggestionPillIndex:t,scenarioId:n})),M=Object(r.action)("RESET_CURRENT_SUGGESTIONS",e=>({scenarioId:e}));var _=n(2150);const L=Object(r.action)("SEARCH_BOX_BLURRED",e=>({scenarioId:e})),U=Object(r.action)("SEARCH_SESSION_ENDED",(e,t,n,r)=>({searchSessionGuid:e,scenarioId:t,latestTraceId:n,actionSource:r}));var V=n(1988);const B=Object(r.action)("SET_CURRENT_SUGGESTIONS",(e,t,n=null)=>({suggestionSet:e,scenarioId:t,qfRequestId:n})),W=Object(r.action)("SET_DISPLAYED_QF_REQUEST_TIME",(e,t)=>({displayedQFRequestTime:e,scenarioId:t}));var G=n(2186);const H=Object(r.action)("SET_LATEST_TRACE_ID",(e,t,n)=>({latestTraceId:e,scenarioId:t,isQFTraceId:n})),z=Object(r.action)("SET_SEARCH_TEXT",(e,t)=>({searchText:e,scenarioId:t})),q=Object(r.action)("SET_SELECTED_PILL_INDEX",(e,t)=>({selectedPillIndex:e,scenarioId:t})),Q=Object(r.action)("SET_SEARCH_TEXT_FOR_SUGGESTION",(e,t)=>({searchTextForSuggestion:e,scenarioId:t})),J=Object(r.action)("SET_SELECTED_SUGGESTION_INDEX",(e,t)=>({selectedSuggestionIndex:e,scenarioId:t}));var K=n(2187);const $=Object(r.action)("SET_SUGGESTION_PILL_IDS",(e,t)=>({suggestionPillIds:e,scenarioId:t})),X=Object(r.action)("SET_SUGGESTION_PILLS",(e,t)=>({suggestionPills:e,scenarioId:t})),Y=Object(r.action)("SHARE_FILE_SUGGESTION",(e,t,n)=>({attachmentId:e,attachmentType:t,scenarioId:n}));var Z=n(1985);const ee=Object(r.action)("START_SEARCH_SESSION",(e,t,n)=>({actionSource:e,shouldStartSearch:t,scenarioId:n})),te=Object(r.action)("SUGGESTION_SECONDARY_ACTION_SELECTED",(e,t,n,r,a,i)=>({suggestion:e,suggestionIndex:t,actionSource:n,scenarioId:r,suggestionSetTraceId:a,entityActionTakenType:i})),ne=Object(r.action)("SUGGESTION_SELECTED",(e,t,n,r,a)=>({suggestion:e,actionSource:t,scenarioId:n,suggestionSetTraceId:r,index:a}));var re=n(2188);const ae=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE_INTERNAL",(e,t)=>({isComplete:e,scenarioId:t})),ie=Object(r.action)("COMPLETE_GHOST_TEXT",(e,t)=>({scenarioId:e,evt:t})),oe=Object(r.action)("CLEAR_GHOST_TEXT",e=>({scenarioId:e})),ce=Object(r.action)("SET_GHOST_TEXT",(e,t)=>({scenarioId:e,ghostText:t}));var ue=n(2189),se=n(1703);n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c.a})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l.a})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return m.a})),n.d(t,"N",(function(){return h})),n.d(t,"w",(function(){return p.a})),n.d(t,"y",(function(){return O.a})),n.d(t,"z",(function(){return g})),n.d(t,"A",(function(){return v})),n.d(t,"B",(function(){return I})),n.d(t,"C",(function(){return S.a})),n.d(t,"D",(function(){return w})),n.d(t,"E",(function(){return j})),n.d(t,"F",(function(){return C})),n.d(t,"G",(function(){return A.a})),n.d(t,"H",(function(){return T.a})),n.d(t,"I",(function(){return P})),n.d(t,"J",(function(){return E})),n.d(t,"K",(function(){return x})),n.d(t,"L",(function(){return R})),n.d(t,"M",(function(){return k.a})),n.d(t,"O",(function(){return D})),n.d(t,"P",(function(){return N.a})),n.d(t,"Q",(function(){return F})),n.d(t,"R",(function(){return M})),n.d(t,"S",(function(){return _.a})),n.d(t,"T",(function(){return L})),n.d(t,"U",(function(){return U})),n.d(t,"V",(function(){return V.a})),n.d(t,"W",(function(){return B})),n.d(t,"X",(function(){return W})),n.d(t,"Z",(function(){return G.a})),n.d(t,"ab",(function(){return H})),n.d(t,"bb",(function(){return z})),n.d(t,"db",(function(){return q})),n.d(t,"cb",(function(){return Q})),n.d(t,"eb",(function(){return J})),n.d(t,"fb",(function(){return K.a})),n.d(t,"gb",(function(){return $})),n.d(t,"hb",(function(){return X})),n.d(t,"ib",(function(){return Y})),n.d(t,"jb",(function(){return Z.a})),n.d(t,"kb",(function(){return ee})),n.d(t,"lb",(function(){return te})),n.d(t,"mb",(function(){return ne})),n.d(t,"nb",(function(){return re.a})),n.d(t,"ob",(function(){return ae})),n.d(t,"f",(function(){return ie})),n.d(t,"d",(function(){return oe})),n.d(t,"Y",(function(){return ce})),n.d(t,"x",(function(){return ue.a})),n.d(t,"m",(function(){return se.a})),n.d(t,"n",(function(){return se.b})),n.d(t,"o",(function(){return se.c})),n.d(t,"q",(function(){return se.e})),n.d(t,"r",(function(){return se.f})),n.d(t,"s",(function(){return se.g})),n.d(t,"t",(function(){return se.h})),n.d(t,"u",(function(){return se.i})),n.d(t,"v",(function(){return se.k})),n.d(t,"p",(function(){return se.d}))},1713:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1824);function a(e){if(!e)return null;return Object(r.a)().attachments.get(e.Id)}},1735:function(e,t,n){"use strict";var r=n(1743);function a(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function i(e,t,n){t&&(e||n)&&Object(r.b)(t,a(e,n))}function o(e,t){var n;const r=null!=t?t:{},a=(null===(n=r.headers)||void 0===n?void 0:n.set)?new Headers(r.headers):new Headers;return r.datapoint=r.datapoint||{},r.datapoint.mailbox=r.datapoint.mailbox||"Explicit",i(e,a),Object.assign(Object.assign({},r),{headers:a})}var c=n(287),u=n(1744),s=n(59),l=n(307),d=n.n(l);async function f(e){return Object(s.b)().then(async t=>{if(e)if(Object(c.r)(e.userIdentity)){const n=await Object(u.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);d()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=a(e.mailboxSmtpAddress);d()(t,n)}return t})}function m(){return Object(s.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function b(e=null){return Object(c.r)(e)?m().then(t=>{return Object(u.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var h=n(52);function p(e,t,n,r){let a=new Headers;return n&&a.set("X-OWA-CANARY",Object(h.a)()),t&&a.set("X-OWA-ActionName",t),(e||r)&&(r?i(e,a,r):i(e,a)),a}n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return m})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return p}))},1739:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return f}));var r=n(3);const a=Object(r.action)("ADD_SHARING_LINK",(e,t,n,r,a,i,o,c,u,s,l,d,f)=>({linkId:e,url:t,sharingLinkIds:n,response:r,source:a,providerType:i,linksContainerId:o,unwrappedUrl:c,creationDateTime:u,thumbnailUrl:s,previewUrl:l,shareId:d,fromQuotedBody:f})),i=Object(r.action)("SHARING_LINK_REMOVED",(e,t,n,r,a)=>({linkId:e,sharingLinkIds:t,fileName:n,providerType:r,linksContainerId:a})),o=Object(r.action)("DELETE_LINK",(e,t)=>({linkId:e,targetWindow:t})),c=Object(r.action)("CREATE_ATTACHMENT_FROM_LINK",(e,t,n,r)=>({linkId:e,providerId:t,isTryAgain:n,targetWindow:r})),u=Object(r.action)("ON_LINK_HAS_CHANGED",(e,t,n,r)=>({linkId:e,recipientInfos:t,composeId:n,isCalendar:r})),s=Object(r.action)("ADD_SHARING_LINK_TO_CONTAINER",(e,t)=>({linkId:e,linkIdContainer:t})),l=Object(r.action)("REMOVE_SHARING_LINK_FROM_CONTAINER",(e,t)=>({linkId:e,linkIdContainer:t})),d=Object(r.action)("ON_FLUID_LINK_CREATED",(e,t,n,r,a)=>({linkId:e,containerId:t,owaSource:n,url:r,viewStateId:a})),f=Object(r.action)("ON_EXISTING_FLUID_LINK_PROCESSED",(e,t,n,r,a)=>({linkId:e,containerId:t,owaSource:n,url:r,viewStateId:a}))},1742:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r={FavoriteNode:"favoritenode",InboxRule:"inboxrule",MessageRule:"messagerule",LocalFile:"Files",MailFolderNode:"mailfoldernode",MailListItemPart:"maillistitempart",MailListRow:"maillistrow",MultiMailListConversationRows:"multimaillistconversationrows",MultiMailListMessageRows:"multimaillistmessagerows",ReadWriteRecipient:"recipient",RibbonCustomizerButton:"ribboncustomizerbutton",NoteFeedItem:"notefeeditem",Todo:"todo",Attachment:"attachment",CommandBarEditorButton:"commandbareditorbutton",CalendarNode:"calendarnode",CalendarGroupNode:"calendargroupnode",CalendarItem:"calendaritem"}},1746:function(e,t,n){"use strict";const r={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"};let a=0;function i(e="id"){return`${e}${a++}`}function o(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;let t={},n=Object.keys(e);for(let r=0;r<n.length;r++){switch(n[r]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=o(e.controls);break;case"describedBy":t["aria-describedby"]=o(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=o(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=o(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=o(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=o(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=o(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return c}))},1753:function(e,t,n){"use strict";var r=n(2887),a=n(2914),i=n(2915),o=n(702);t.a=Object(o.action)("setOngoingActionAndActionMessage")((function(e,t,n){Object(r.a)(e,t),e.actionMessage=n,Object(i.a)(e)?Object(a.a)(e,!0):Object(a.a)(e,!1)}))},1754:function(e,t,n){"use strict";var r=n(20),a=n(1675),i=n(47);function o(){return c(Object(a.I)())}function c(e){let t=null;return e&&(2===e.tableQuery.type?t=e.tableQuery.folderId:Object(i.j)("grp-loadFolders")&&3===e.tableQuery.type&&(t=e.tableQuery.groupId)),t}function u(){const e=Object(a.I)();return e&&(2==e.tableQuery.type||Object(i.j)("grp-loadFolders")&&3==e.tableQuery.type)}function s(e){return!!e&&(2==e.type||l(e)||Object(i.j)("grp-loadFolders")&&3==e.type)}function l(e){if(!e||1!=e.type)return!1;return"Group"==e.searchScope.kind}function d(e){if(2==e.type)return e.folderId;if(Object(i.j)("grp-loadFolders")&&3==e.type)return e.groupId;if(l(e)){return e.searchScope.groupId}return null}function f(){const e=Object(a.I)();return e&&s(e.tableQuery)}function m(){return Object(i.j)("grp-loadFolders")&&u()}n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return p})),n.d(t,"n",(function(){return O})),n.d(t,"m",(function(){return g})),n.d(t,"k",(function(){return v})),n.d(t,"j",(function(){return I})),n.d(t,"l",(function(){return S})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return m}));const b=new r.c(()=>Promise.all([n.e(19),n.e(48),n.e(61),n.e(452)]).then(n.bind(null,19734))),h=new r.b(b,e=>e.getGroupDisplayName),p=new r.b(b,e=>e.getGroupDisplayNameFromTableView),O=new r.b(b,e=>e.isPrivateUnjoinedGroup),g=new r.b(b,e=>e.isJoinedGroup),v=new r.b(b,e=>e.getRetentionPolicyTagsForGroup),I=new r.b(b,e=>e.getRetentionPolicyTagListForGroupTableQuery),S=new r.b(b,e=>e.isGroupOwner)},1761:function(e,t,n){"use strict";var r=n(20);var a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"j",(function(){return o})),n.d(t,"k",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return a}));const i=new r.c(()=>Promise.all([n.e(0),n.e(543)]).then(n.bind(null,19504))),o=new r.a(i,e=>e.subscribe),c=new r.a(i,e=>e.unsubscribe),u=new r.b(i,e=>e.getChannelId),s=new r.a(i,e=>e.getChannelReady),l=new r.a(i,e=>e.retryDisconnectionWithMinimumReconnectInterval),d=new r.a(i,e=>e.setup),f=new r.a(i,e=>e.handleNotification),m=new r.a(i,e=>e.NotificationManager.stopConnection),b=new r.a(i,e=>e.initializeNotificationManager),h=new r.b(i,e=>e.getNotificationEmitter)},1763:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),a=n(16);const i=Object(r.createStore)("groupsStore",{groups:new a.ObservableMap})},1764:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d}));var r=n(20);const a=new r.c(()=>Promise.all([n.e(0),n.e(28),n.e(643)]).then(n.bind(null,3857)));let i=new r.a(a,e=>e.logLocalContentDataSource),o=new r.a(a,e=>e.logLocalContentLayout),c=new r.a(a,e=>e.clearLocalContentInstrumentationCache),u=new r.b(a,e=>e.getLocalContentId);const s=new r.b(a,e=>e.substrateSearchInitOperation),l=(new r.b(a,e=>e.substrateSearchPostSuggestionsService),new r.b(a,e=>e.deleteSubstrateSearchHistoryService)),d=new r.b(a,e=>e.exportSubstrateSearchHistoryService)},17694:function(e){e.exports=JSON.parse('{"a":"NZb"}')},17695:function(e){e.exports=JSON.parse('{"c":"JZb","a":"KZb","b":"LZb"}')},17696:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._1wWH3mTE8kohMo-I3csgHE{top:-9px;position:relative}._3z1yatsJo55PvlF5pifSys{top:-3px}._3z1yatsJo55PvlF5pifSys,._33jeo7MJqUtmwcqzpuSv_D{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._33jeo7MJqUtmwcqzpuSv_D{top:-5px}._2kFmhCV0AxPjt76UdSIJ4x{top:-7px;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._3T4noM2fKCWxRzS46YXdnR{font-size:11px;font-weight:400;color:var(--neutralSecondary)}html[dir] ._3T4noM2fKCWxRzS46YXdnR{padding:0}html[dir=ltr] ._3T4noM2fKCWxRzS46YXdnR{margin-right:6px}html[dir=rtl] ._3T4noM2fKCWxRzS46YXdnR{margin-left:6px}._3OQpFaK91zn-NpBLpV6iu2{color:var(--neutralSecondary);font-size:12px}html[dir] ._3OQpFaK91zn-NpBLpV6iu2{padding:0}html[dir=ltr] ._3OQpFaK91zn-NpBLpV6iu2{margin-right:6px}html[dir=rtl] ._3OQpFaK91zn-NpBLpV6iu2{margin-left:6px}._2fwIiNLFvkwCTEgngIAWAA,.i021ni6HfkxtEWiGgYCju{color:var(--neutralSecondary);font-size:11px}html[dir] ._2fwIiNLFvkwCTEgngIAWAA,html[dir] .i021ni6HfkxtEWiGgYCju{padding:0}html[dir=ltr] ._2fwIiNLFvkwCTEgngIAWAA,html[dir=ltr] .i021ni6HfkxtEWiGgYCju{margin-right:6px}html[dir=rtl] ._2fwIiNLFvkwCTEgngIAWAA,html[dir=rtl] .i021ni6HfkxtEWiGgYCju{margin-left:6px}._1mQM1aPYhoddEQpRwIRPhH:hover{color:var(--themePrimary)}._2811Q-Z8MUEUhVYY89wy6s{font-size:12px}html[dir=ltr] ._2811Q-Z8MUEUhVYY89wy6s{margin-left:2px}html[dir=rtl] ._2811Q-Z8MUEUhVYY89wy6s{margin-right:2px}._1Hp5-7GsNoVskp5oVDLivX{color:var(--neutralPrimary);font-size:12px}html[dir=ltr] ._1Hp5-7GsNoVskp5oVDLivX{margin-left:2px}html[dir=rtl] ._1Hp5-7GsNoVskp5oVDLivX{margin-right:2px}._6IT2T6QN_uITLhz2fDBMh,.ZmjbSrsbUSihR-OdTEE9V{color:var(--neutralPrimary);font-size:10px}html[dir=ltr] ._6IT2T6QN_uITLhz2fDBMh,html[dir=ltr] .ZmjbSrsbUSihR-OdTEE9V{margin-left:2px}html[dir=rtl] ._6IT2T6QN_uITLhz2fDBMh,html[dir=rtl] .ZmjbSrsbUSihR-OdTEE9V{margin-right:2px}._3SwMid161hF_oYmLFsiNKu{font-size:12px}html[dir=ltr] ._3SwMid161hF_oYmLFsiNKu{margin-left:2px}html[dir=rtl] ._3SwMid161hF_oYmLFsiNKu{margin-right:2px}._3A-8Fr3bU_ZOarlzkR8wVe{color:var(--neutralPrimary);font-size:12px}html[dir=ltr] ._3A-8Fr3bU_ZOarlzkR8wVe{margin-left:2px}html[dir=rtl] ._3A-8Fr3bU_ZOarlzkR8wVe{margin-right:2px}._2hXBJVuDN3-EHKa9H32BuU,._1tb2e53xVfepKqKj3j_hwE{color:var(--neutralPrimary);font-size:10px}html[dir=ltr] ._2hXBJVuDN3-EHKa9H32BuU,html[dir=ltr] ._1tb2e53xVfepKqKj3j_hwE{margin-left:2px}html[dir=rtl] ._2hXBJVuDN3-EHKa9H32BuU,html[dir=rtl] ._1tb2e53xVfepKqKj3j_hwE{margin-right:2px}.Klt6YJQJ-p6k74h2FRRW{font-size:14px;color:var(--themePrimary)}html[dir=ltr] .Klt6YJQJ-p6k74h2FRRW{margin-left:2px}html[dir=rtl] .Klt6YJQJ-p6k74h2FRRW{margin-right:2px}._3bQrNaLRMjX0DorxWdqSXG{color:var(--neutralPrimary);font-size:12px}html[dir=ltr] ._3bQrNaLRMjX0DorxWdqSXG{margin-left:2px}html[dir=rtl] ._3bQrNaLRMjX0DorxWdqSXG{margin-right:2px}._2TOB5Y8tr5L-Nr_cNeRlk_,._2JpmD8krALJGbiWnmczHzB{color:var(--neutralPrimary);font-size:10px}html[dir=ltr] ._2TOB5Y8tr5L-Nr_cNeRlk_,html[dir=ltr] ._2JpmD8krALJGbiWnmczHzB{margin-left:2px}html[dir=rtl] ._2TOB5Y8tr5L-Nr_cNeRlk_,html[dir=rtl] ._2JpmD8krALJGbiWnmczHzB{margin-right:2px}.gVkO0sZ430EYlDDVRFAW{position:relative}",""]),t.locals={attachmentWellBar:"_1wWH3mTE8kohMo-I3csgHE",attachmentWellBarDensityFull:"_3z1yatsJo55PvlF5pifSys",attachmentWellBarDensityMedium:"_33jeo7MJqUtmwcqzpuSv_D",attachmentWellBarDensityCompact:"_2kFmhCV0AxPjt76UdSIJ4x",barButton:"_3T4noM2fKCWxRzS46YXdnR",barButtonFull:"_3OQpFaK91zn-NpBLpV6iu2",barButtonCompact:"_2fwIiNLFvkwCTEgngIAWAA",barButtonMedium:"i021ni6HfkxtEWiGgYCju",barButtonHover:"_1mQM1aPYhoddEQpRwIRPhH",downloadAllButton:"_2811Q-Z8MUEUhVYY89wy6s",downloadAllButtonFull:"_1Hp5-7GsNoVskp5oVDLivX",downloadAllButtonCompact:"_6IT2T6QN_uITLhz2fDBMh",downloadAllButtonMedium:"ZmjbSrsbUSihR-OdTEE9V",saveToCloudButton:"_3SwMid161hF_oYmLFsiNKu",saveToCloudButtonFull:"_3A-8Fr3bU_ZOarlzkR8wVe",saveToCloudButtonCompact:"_2hXBJVuDN3-EHKa9H32BuU",saveToCloudButtonMedium:"_1tb2e53xVfepKqKj3j_hwE",chevronButton:"Klt6YJQJ-p6k74h2FRRW",chevronButtonFull:"_3bQrNaLRMjX0DorxWdqSXG",chevronButtonCompact:"_2TOB5Y8tr5L-Nr_cNeRlk_",chevronButtonMedium:"_2JpmD8krALJGbiWnmczHzB",chevronButtonOuter:"gVkO0sZ430EYlDDVRFAW"}},17697:function(e){e.exports=JSON.parse('{"b":"GZb","a":"HZb","c":"IZb"}')},17698:function(e){e.exports=JSON.parse('{"g":"xZb","f":"yZb","h":"zZb","b":"AZb","c":"BZb","d":"CZb","e":"DZb","a":"EZb"}')},17699:function(e){e.exports=JSON.parse('{"a":"wZb"}')},17700:function(e,t,n){var r=n(17701);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(77)(r,a);r.locals&&(e.exports=r.locals)},17701:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"html[dir] ._1tMXlIxtti272uD_qPCcOA{margin-top:10px}html[dir] ._1tMXlIxtti272uD_qPCcOA._1BODD2GFB3_OzaHOP2r-Ts{margin-top:8px}html[dir] ._2IyrVwrunZPchTaywzD0f2{margin-bottom:10px;border-bottom:1px solid var(--neutralLight)}._1Q4W9BtakAO_4Cq8WsBYjp{width:100%;overflow:hidden}._3u_BJLyKKt7Vl6ErSE-TtK{min-height:133px;max-height:133px}._1nn6ot_jaLn5NmheVnPT0F{min-height:132px;max-height:132px}.LAQ1CmY9BBptOKsh7R_9T{min-height:117px;max-height:117px}._1IiPg4SYIOLWaNfonxCPO6{min-height:102px;max-height:102px}._7PCLH-q_N9UUTGaosYwm2{min-height:65px;max-height:65px}._2ORVGuKvCzSzEDlCK3DZ7U{min-height:59px;max-height:59px}._3MsZa4lsKbcbh-sNe8h9JE{min-height:55px;max-height:55px}._Y1yV9rIl4YRuWz9rijwx{min-height:51px;max-height:51px}.RHawS_GicPjq7xaGO6lQZ{height:auto}",""]),t.locals={attachmentWell:"_1tMXlIxtti272uD_qPCcOA",unstackedReadingPane:"_1BODD2GFB3_OzaHOP2r-Ts",attachmentWellInCompose:"_2IyrVwrunZPchTaywzD0f2",oneRowView:"_1Q4W9BtakAO_4Cq8WsBYjp",oneRowViewImageHeight:"_3u_BJLyKKt7Vl6ErSE-TtK",oneRowViewImageHeightFull:"_1nn6ot_jaLn5NmheVnPT0F",oneRowViewImageHeightMedium:"LAQ1CmY9BBptOKsh7R_9T",oneRowViewImageHeightCompact:"_1IiPg4SYIOLWaNfonxCPO6",oneRowViewDocHeight:"_7PCLH-q_N9UUTGaosYwm2",oneRowViewDocHeightFull:"_2ORVGuKvCzSzEDlCK3DZ7U",oneRowViewDocHeightMedium:"_3MsZa4lsKbcbh-sNe8h9JE",oneRowViewDocHeightCompact:"_Y1yV9rIl4YRuWz9rijwx",allowShowMultipleRows:"RHawS_GicPjq7xaGO6lQZ"}},17702:function(e,t,n){e.exports=n.p+"../resources/images/attach-91ee4c9d6406386b1dcf60138a873730.svg"},1771:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1885),a=n(1683);function i(){return a.a.tableViews.get(Object(r.a)())}},1775:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(57);function a(e){var t;return!!(e&((null===(t=Object(r.g)().ViewStateConfiguration)||void 0===t?void 0:t.ListViewBitFlags)||0))}function i(e,t){a(t)!==e&&Object(r.x)(n=>{!function(e,t,n){var r;if(null==(null===(r=t.ViewStateConfiguration)||void 0===r?void 0:r.ListViewBitFlags))return;e?t.ViewStateConfiguration.ListViewBitFlags|=n:t.ViewStateConfiguration.ListViewBitFlags&=~n}(e,n,t)})}},1782:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return c}))},1784:function(e,t,n){"use strict";var r=n(1931),a=n(1864),i=n(1798),o=n(1857),c=n(2190),u=n(1738);function s(e,t,n,s){if(Object(i.c)(n))return function(e){return 2===Object(o.a)(e)?f():l()}(n);if(3===Object(o.a)(n)&&!s)return d();let m;switch(t){case 2:m={allowEdit:!1,previewMethod:a.a.Image,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 3:m={allowEdit:!1,previewMethod:a.a.NativeView,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 6:m={allowEdit:!1,previewMethod:a.a.GoogleDoc,supportedOpenActions:[r.a.Preview]};break;case 4:m={allowEdit:e.wacEdit,previewMethod:a.a.Wac,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 5:m={allowEdit:!1,previewMethod:a.a.Audio,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 7:m={allowEdit:!1,previewMethod:a.a.PdfJs,supportedOpenActions:[r.a.Preview]};break;case 8:case 9:case 10:m=f();break;case 11:m={allowEdit:!1,previewMethod:a.a.Text,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 12:m={allowEdit:!1,previewMethod:a.a.Video,supportedOpenActions:[r.a.Preview,r.a.Download]};break;case 1:m={allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]};break;case 13:m={allowEdit:!1,previewMethod:a.a.CalendarEvent,supportedOpenActions:[r.a.Preview,r.a.Download]};break;default:m=function(e){return Object(c.a)(e)||Object(u.a)(e)}(n)?d():l()}return m}function l(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.Download]}}function d(){return{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[r.a.OpenInNewTab]}}function f(){return{allowEdit:!1,previewMethod:a.a.ItemAttachment,supportedOpenActions:[r.a.Preview,r.a.Download]}}var m=n(3),b=Object(m.mutatorAction)("setIsPlaceholderAttachment",(function(e,t){e.isPlaceholderAttachment=t})),h=Object(m.mutatorAction)("setThumbnailLoadState",(function(e,t){e.thumbnailLoadState=t}));function p(e,t,n,r,i,o=null){return{attachmentId:e,thumbnailLoadState:0,previewLoaded:!1,isCloudy:n,isReadOnly:t,isPlaceholderAttachment:r,strategy:{allowEdit:!1,previewMethod:a.a.Unsupported,supportedOpenActions:[]},parentItemId:o,fileType:i}}var O,g=n(38);function v(){return Object(g.a)().SessionSettings.CompanyName}function I(e){return e.supportedOpenActions.length&&e.supportedOpenActions[0]||r.a.NoAction}!function(e){e[e.MailList=0]="MailList",e[e.ReadingPane=1]="ReadingPane",e[e.FilesHub=2]="FilesHub",e[e.PhotoHub=3]="PhotoHub",e[e.GroupFilesHub=4]="GroupFilesHub",e[e.ConversationAttachmentWell=5]="ConversationAttachmentWell",e[e.Deeplink=6]="Deeplink",e[e.FileSuggestion=7]="FileSuggestion",e[e.LinkSuggestion=8]="LinkSuggestion",e[e.ComposeDocLink=9]="ComposeDocLink",e[e.ReadingPaneDocLink=10]="ReadingPaneDocLink",e[e.ConsumerGroupFilesHub=11]="ConsumerGroupFilesHub"}(O||(O={})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return I})),n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return r.a})),n.d(t,"c",(function(){return O}))},1786:function(e,t,n){"use strict";var r,a=n(1696),i=n(2144),o=n(38),c=n(1850),u=n(2355),s=n(1857);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));class l{constructor(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPublicComputersEnabled):(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPrivateComputersEnabled),this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}getPolicyInfo(e,t,n,a){e&&(e=e.toLowerCase());let i=this.getFileAccessLevel(e,t),o=!1,s=!1,l=!1;const d=1===a||3===a;if(i!==r.Block&&n){this.isWacViewingEnabled(e)&&(o=!0),!this.directFileAccessEnabled&&d&&(o=!1),s=this.isForceBrowserViewingFirst(o),o&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(l=0===a?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),o||Object(c.b)(e)||Object(u.a)(e)||this.directFileAccessEnabled||(i=r.AccessDisabled)}return{directFileAccessEnabled:this.directFileAccessEnabled,level:i,useWac:o,forceBrowserViewingFirst:s,wacEdit:l}}isPdfPreviewEnabled(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled}getFileAccessLevel(e,t){let n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;const a=this.mimeTypeToPolicyMap[t];return a===r.Block?r.Block:n===r.ForceSave||a===r.ForceSave?r.ForceSave:n===r.Allow||a===r.Allow?r.Allow:this.policyForUnknownTypes}isWacViewingEnabled(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0}isForceBrowserViewingFirst(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)}addPolicyIntoMap(e,t,n){t&&t.forEach(t=>{e[t]=n})}createPolicyMap(e,t,n){const a={};return this.addPolicyIntoMap(a,n,r.Allow),this.addPolicyIntoMap(a,t,r.ForceSave),this.addPolicyIntoMap(a,e,r.Block),a}}let d=null,f=null;function m(){if(!d){const e=Object(o.a)(),t=Object(i.c)(),n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;d=new l(t,n),n&&(f=d)}return d}function b(e,t){const n=Object(a.b)(e.Name),r=e.ContentType;return m().getPolicyInfo(n,r,t,Object(s.a)(e))}function h(e,t){const n=Object(a.b)(e.Name),r=e.ContentType;return function(){if(!f){const e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return m();f=new l(Object(i.c)(),!0)}return f}().getPolicyInfo(n,r,t,Object(s.a)(e))}function p(e,t,n,a,i){if(a||i)return!1;const o=b(e,!0),c=m();return o.level!==r.Block&&c.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return m}))},1791:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1831),a=n(1683);function i(e,t){const n=Object(r.a)(e,t);return a.a.tableViewConversationRelations.get(n)}},1796:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IndexedPageView:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1798:function(e,t,n){"use strict";n.d(t,"d",(function(){return u})),n.d(t,"l",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"e",(function(){return p})),n.d(t,"m",(function(){return O}));var r=n(20),a=n(1905);n.d(t,"n",(function(){return a.a})),n.d(t,"o",(function(){return a.b})),n.d(t,"p",(function(){return a.c}));var i=n(1824);n.d(t,"a",(function(){return i.a}));var o=n(1957);n.d(t,"c",(function(){return o.a})),n.d(t,"b",(function(){return o.b}));const c=new r.c(()=>Promise.all([n.e(0),n.e(24),n.e(35),n.e(108),n.e(519)]).then(n.bind(null,3788))),u=new r.a(c,e=>e.addAndInitializeAttachments),s=new r.a(c,e=>e.setPreviewImageUrl),l=new r.a(c,e=>e.refreshDownloadUrl),d=new r.a(c,e=>e.createAttachmentInfo),f=new r.a(c,e=>e.setAttachmentInfo),m=new r.a(c,e=>e.refreshThumbnailImageUrl),b=new r.a(c,e=>e.refreshPreviewImageUrl),h=new r.b(c,e=>e.getAttachment),p=new r.b(c,e=>e.checkPendingAttachmentOperation),O=new r.b(c,e=>e.shouldShowImageView)},1803:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),a=n(3);const i=()=>({alteredQuery:"",alterationProviderId:null,answerPlaceholderId:null,currentSearchQueryId:null,currentSuggestions:null,displayedQFRequestTime:null,flaggedTokens:[],isAnswerRendered:!1,isLastKeyPressedDeletion:!1,isSuggestionsCalloutClickable:!1,isSuggestionsDropdownVisible:!1,isUsing3S:null,latestQFRequestId:null,latestRenderedQFTraceId:null,latestQFTraceId:null,latestTraceId:null,nextSearchQueryId:null,recourseQuery:"",searchBoxHasFocus:!1,searchBoxWidth:null,searchSessionGuid:null,searchText:"",searchTextForSuggestion:"",selectedPillIndex:-1,selectedSuggestionIndex:-1,showRefiners:!1,showSearchBoxInCompactMode:!1,suggestedSearchTerm:"",suggestedSearchTermReferenceId:"",suggestionPillIds:[],suggestionPills:new r.ObservableMap,queryAlterationType:null,queryActionSource:null,queryAlterationLogicalId:null,alterationDisplayText:"",traceIdToLogicalIdMap:new r.ObservableMap,tableViewId:null,isScopePickerVisible:!1,filters:[],placeholderIdToIsRenderedMap:new r.ObservableMap}),o={scenarioStores:new r.ObservableMap},c=Object(a.createStore)("commonSearchStore",o);t.b=c},1804:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(a||(a={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},1808:function(e,t,n){"use strict";var r,a=n(20),i=n(1739),o=n(1821),c=n(2409);!function(e){e.PasteHtml="PasteHtml",e.InsertLinkFromToolbar="InsertLinkFromToolbar",e.InsertLinkFromAttachMenu="InsertLinkFromAttachMenu",e.InsertLinkFromSonora="InsertLinkFromSonora",e.AutoLink="AutoLink",e.ReplyOrForward="ReplyOrForward",e.LinkContextMenu="LinkContextMenu",e.Undo="Undo",e.EditorLoadedOrDraftOrReply="EditorLoadedOrDraftOrReply",e.RestoreCursor="RestoreCursor",e.ShareLinkCompose="ShareLinkCompose",e.NewFluidFile="NewFluidFile",e.Unknown="Unknown"}(r||(r={}));var u=n(2104),s=n(2424),l=n(2369),d=n(1898),f=n(1912);const m=[r.PasteHtml,r.InsertLinkFromToolbar,r.AutoLink,r.ShareLinkCompose,r.InsertLinkFromAttachMenu];function b(e){const t=Object(f.a)(e);return t&&-1!==m.indexOf(t.source)}var h=n(2349);function p(e){const t=Object(f.a)(e);return t?{id:t.linkId,name:t.fileName,supportsDownsell:!1,currentPermissionLevel:t.permissionLevel,sharingInfo:t.sharingInfo,sharingTipsIgnored:t.sharingTipsIgnored,sharingRecipientsInfo:t.sharingRecipientsInfo,typeOfLink:b(e)?"newLink":"oldLink"}:null}var O=n(2316);function g(){return Object(O.a)().sharingLinks.size}var v=n(2410);n.d(t,"t",(function(){return S})),n.d(t,"D",(function(){return w})),n.d(t,"K",(function(){return j})),n.d(t,"G",(function(){return y})),n.d(t,"E",(function(){return C})),n.d(t,"B",(function(){return A})),n.d(t,"H",(function(){return T})),n.d(t,"I",(function(){return P})),n.d(t,"J",(function(){return E})),n.d(t,"v",(function(){return x})),n.d(t,"s",(function(){return R})),n.d(t,"A",(function(){return k})),n.d(t,"u",(function(){return D})),n.d(t,"F",(function(){return N})),n.d(t,"C",(function(){return F})),n.d(t,"y",(function(){return M})),n.d(t,"x",(function(){return _})),n.d(t,"w",(function(){return L})),n.d(t,"z",(function(){return U})),n.d(t,"P",(function(){return I})),n.d(t,"d",(function(){return i.a})),n.d(t,"e",(function(){return i.b})),n.d(t,"f",(function(){return i.c})),n.d(t,"h",(function(){return i.d})),n.d(t,"R",(function(){return i.h})),n.d(t,"T",(function(){return i.i})),n.d(t,"M",(function(){return i.f})),n.d(t,"N",(function(){return i.g})),n.d(t,"L",(function(){return i.e})),n.d(t,"U",(function(){return o.e})),n.d(t,"V",(function(){return o.f})),n.d(t,"W",(function(){return o.g})),n.d(t,"S",(function(){return o.c})),n.d(t,"g",(function(){return o.b})),n.d(t,"Q",(function(){return c.b})),n.d(t,"a",(function(){return r})),n.d(t,"o",(function(){return u.a})),n.d(t,"q",(function(){return u.b})),n.d(t,"O",(function(){return s.a})),n.d(t,"c",(function(){return l.a})),n.d(t,"i",(function(){return d.a})),n.d(t,"j",(function(){return d.b})),n.d(t,"r",(function(){return d.c})),n.d(t,"p",(function(){return b})),n.d(t,"b",(function(){return h.a})),n.d(t,"m",(function(){return f.a})),n.d(t,"l",(function(){return p})),n.d(t,"k",(function(){return g})),n.d(t,"n",(function(){return v.a}));const I=new a.c(()=>Promise.all([n.e(0),n.e(24),n.e(96),n.e(525)]).then(n.bind(null,19465))),S=new a.b(I,e=>e.addRecipientsIntoLink),w=new a.b(I,e=>e.removeRecipientsFromLink),j=new a.b(I,e=>e.updateRecipientPermissionInfos),y=new a.b(I,e=>e.setGetPermissionInfoFailure),C=new a.b(I,e=>e.resetSharingRecipientsInfo),A=new a.b(I,e=>e.ignoreSharingTip),T=new a.b(I,e=>e.setLinkActionStatus),P=new a.b(I,e=>e.updateLinkContainerIdOfLink),E=new a.b(I,e=>e.updateLinkIds),x=new a.b(I,e=>e.createLinksIdContainer),R=new a.b(I,e=>e.addLinkIdToLinksIdContainer),k=new a.b(I,e=>e.getSharingTipRecipientInfo),D=new a.b(I,e=>e.createCloudFileFromSharingLink),N=new a.b(I,e=>e.retrieveImageUrlsForImageFile),F=new a.b(I,e=>e.imageLinkPreviewCondition),M=new a.b(I,e=>e.getLinksIdContainer),_=new a.b(I,e=>e.getAllLinksContainerIds),L=new a.b(I,e=>e.doesLinksIdContainerExist),U=new a.b(I,e=>e.getSharingLinkInfo)},1809:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1763);function a(e){const t=Object(r.a)().groups.get(e.toLowerCase());return t?t.groupDetails:null}},1821:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l}));var r=n(3);const a=Object(r.action)("UPDATE_SHARING_LINK_FROM_SHARING_DIALOG",(e,t)=>({linkId:e,sharingDialogResponse:t})),i=Object(r.action)("UPDATE_SHAREPOINT_LINK_PERMISSION",(e,t)=>({linkId:e,newPermission:t})),o=Object(r.action)("UPDATE_SHAREPOINT_LINK_URL",(e,t,n,r)=>({linkId:e,newLinkUrl:t,oldLinkUrl:n,expirationDate:r})),c=Object(r.action)("SET_REFRESH_STATUS_FOR_LINK",(e,t)=>({linkId:e,actionStatus:t})),u=Object(r.action)("CREATE_OR_UPDATE_SHARING_LINK",(e,t,n,r,a,i,o,c,u)=>({linkId:e,sharingUrl:t,currentUrl:n,canonicalUrl:r,newPermissionLevel:a,providerType:i,composeId:o,recipientInfos:c,isCalendar:u})),s=Object(r.action)("ADD_SHARING_LINK_INFO",(e,t)=>({linkId:e,linkModel:t})),l=Object(r.action)("TOKEN_UNAVAILABLE",e=>({linkId:e}))},1823:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(7);const a=Object(r.Vb)("UTC",4500,8,1);Object(r.vb)(a).slice(0,-1);function i(e){return c(e.lastDeliveryOrRenewTimeStamp)}function o(e){return c(e.ReceivedOrRenewTime)}function c(e){if(e===u())return!0;return new Date(e).getTime()==Object(r.Cb)(a)}function u(){try{return new Date(Object(r.Cb)(a)).toLocaleString(),Object(r.qc)(a).toString()}catch(e){return null}}},1824:function(e,t,n){"use strict";var r=n(16),a=n(3);const i={attachments:new r.ObservableMap({})},o=Object(a.createStore)("attachment",i);t.a=o},1831:function(e,t,n){"use strict";function r(e,t){return t+e}n.d(t,"a",(function(){return r}))},1832:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Executing=1]="Executing",e[e.Succeed=2]="Succeed",e[e.FailureNotice=3]="FailureNotice",e[e.FailureRetry=4]="FailureRetry"}(r||(r={})),t.a=r},1836:function(e,t,n){"use strict";var r,a,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(i||(i={}))},1843:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),a=n(1903);const i=Object(r.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:a.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1846:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function a(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},1849:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1891);function a(e){switch(e){case r.a.Mail:return"Mail";case r.a.Calendar:return"Calendar";case r.a.FilesHub:return"FilesHub";case r.a.FilesPicker:return"FilesPicker";case r.a.FileSuggestions:return"FileSuggestions";default:throw Error("Unknown SearchScenarioId value!")}}},1854:function(e,t,n){"use strict";var r;!function(e){e[e.ChangePermissions=0]="ChangePermissions",e[e.CopyLink=1]="CopyLink",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab",e[e.Preview=4]="Preview",e[e.SaveToCloud=5]="SaveToCloud",e[e.ViewInProvider=6]="ViewInProvider",e[e.ConvertClassicToCloudy=7]="ConvertClassicToCloudy",e[e.ConvertCloudyToClassic=8]="ConvertCloudyToClassic",e[e.ImportCalendarEventAttachment=9]="ImportCalendarEventAttachment",e[e.MoveAttachmentToInline=10]="MoveAttachmentToInline",e[e.RefreshLink=11]="RefreshLink",e[e.IgnoreExpiration=12]="IgnoreExpiration"}(r||(r={})),t.a=r},1857:function(e,t,n){"use strict";var r=n(1732),a=n(6);const i=e=>e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e);function o(e){const t=e.__type||e.OwsTypeName;switch(t){case r.a:return 0;case r.e:return e.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:const n=e,o=e.EmbeddedItemClass;return o&&i(o)||Object(a.k)(n.AttachmentIdToAttach)?2:0;default:throw new Error(`Invalid type of attachment ${t}`)}}n.d(t,"a",(function(){return o}))},1858:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c}));const r="originalsrc",a="shash",i="data-auth",o="&reserved=0",c="Verified"},1862:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1857);function a(e){return o(e.type)}function i(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},1864:function(e,t,n){"use strict";var r;!function(e){e[e.Unsupported=0]="Unsupported",e[e.Image=1]="Image",e[e.MailItem=2]="MailItem",e[e.CalendarEvent=3]="CalendarEvent",e[e.Wac=4]="Wac",e[e.SuiteExtensions=5]="SuiteExtensions",e[e.Audio=6]="Audio",e[e.Text=7]="Text",e[e.NativeView=8]="NativeView",e[e.GoogleDoc=9]="GoogleDoc",e[e.PdfJs=10]="PdfJs",e[e.ItemAttachment=11]="ItemAttachment",e[e.Video=12]="Video"}(r||(r={})),t.a=r},1866:function(e,t,n){"use strict";n.r(t);var r=n(1683),a=n(1791),i=n(1956),o=n(2012),c=n(1823),u=n(71),s=n(1982),l=n(1692),d=n(2023),f=n(2578),m=n(2013),b=n(1758),h=n(36);function p(e){return function(e,t){return g({isPinned:t,returnTime:e.returnTime,receivedOrRenewedTime:e.lastDeliveryOrRenewTimeStamp,receivedTime:e.lastDeliveryTimeStamp})}(e,Object(c.b)(e))}function O(e){return function(e,t){return g({isPinned:t,returnTime:e.ReturnTime,receivedOrRenewedTime:e.ReceivedOrRenewTime,receivedTime:e.DateTimeReceived})}(e,Object(c.c)(e))}function g(e){const{returnTime:t,receivedOrRenewedTime:n,receivedTime:r,isPinned:a}=e;return!!t||!a&&n&&(i=r,!(new Date(n).setMilliseconds(0)==new Date(i).setMilliseconds(0)));var i}function v(e,t){return Z(e,t,1)}function I(e,t){return Z(e,t,2)}function S(e,t){return Z(e,t,3)}function w(e,t){return Z(e,t,14)}function j(e,t){return Z(e,t,17)}function y(e,t){return Z(e,t,18)}function C(e,t){return Z(e,t,10)}function A(e,t){return Z(e,t,9)}function T(e,t){return Z(e,t,4)}function P(e,t){return Z(e,t,6)}function E(e,t){return Z(e,t,31)}function x(e,t){return Z(e,t,7)}function R(e,t){return Z(e,t,8)}function k(e,t){return Z(e,t,5)}function D(e,t){return Z(e,t,19)}function N(e,t){return Z(e,t,21)}function F(e,t){return Z(e,t,20)}function M(e,t){return Z(e,t,30)}function _(e,t){return Z(e,t,22)}function L(e,t){return Z(e,t,23)}function U(e,t){return Z(e,t,32)}function V(e,t){return Z(e,t,29)}function B(e,t){return Z(e,t,28)}function W(e,t){return Z(e,t,26)}function G(e,t){return Z(e,t,27)}function H(e,t){return Z(e,t,24)}function z(e,t){return Z(e,t,12)}n.d(t,"getCanDelete",(function(){return v})),n.d(t,"getCategories",(function(){return I})),n.d(t,"getConversationId",(function(){return S})),n.d(t,"getIsPinned",(function(){return w})),n.d(t,"getItem",(function(){return j})),n.d(t,"getItemIds",(function(){return y})),n.d(t,"getLatestGlobalItemId",(function(){return C})),n.d(t,"getGlobalItemIds",(function(){return A})),n.d(t,"getDraftItemIds",(function(){return T})),n.d(t,"getExecuteSearchSortOrder",(function(){return P})),n.d(t,"getUniqueSenders",(function(){return E})),n.d(t,"getFlagType",(function(){return x})),n.d(t,"getFlagStatus",(function(){return R})),n.d(t,"getEffectiveMentioned",(function(){return k})),n.d(t,"getLastDeliveryOrRenewTimeStamp",(function(){return D})),n.d(t,"getLastModifiedTimeStamp",(function(){return N})),n.d(t,"getLastDeliveryTimeStamp",(function(){return F})),n.d(t,"getSubject",(function(){return M})),n.d(t,"getLastSenderMailbox",(function(){return _})),n.d(t,"getLastSenderSMTP",(function(){return L})),n.d(t,"getUnreadCount",(function(){return U})),n.d(t,"getSize",(function(){return V})),n.d(t,"getRowIdString",(function(){return B})),n.d(t,"getRowClientItemId",(function(){return W})),n.d(t,"getRowIdToShowInReadingPane",(function(){return G})),n.d(t,"getParentFolderId",(function(){return H})),n.d(t,"getInstrumentationContext",(function(){return z})),n.d(t,"getIsDraft",(function(){return q})),n.d(t,"getIsSubmitted",(function(){return Q})),n.d(t,"getIsSnoozed",(function(){return J})),n.d(t,"getValidCouponIndexes",(function(){return K})),n.d(t,"getImportance",(function(){return $})),n.d(t,"getArchiveTag",(function(){return X})),n.d(t,"getPolicyTag",(function(){return Y})),n.d(t,"getConversationProperty",(function(){return ee}));let q=function(e,t){return Z(e,t,13)},Q=function(e,t){return Z(e,t,16)};function J(e,t){return Z(e,t,15)}function K(e,t){return Z(e,t,33)}function $(e,t){return Z(e,t,11)}function X(e,t){return Z(e,t,0)}function Y(e,t){return Z(e,t,25)}function Z(e,t,n){switch(t.tableQuery.listViewType){case 0:return ee(e,t,n);case 1:return function(e,t,n){var r;const a=Object(i.a)(e,t.id);if(!a)return te("ItemNotInRelations",n),null;const u=a.clientId,s=l.u.items.get(u.Id);if(!s)return te("ItemNotInCache",n),null;const d=Object(o.a)(s)?s:null,f=null===(r=null==d?void 0:d.From)||void 0===r?void 0:r.Mailbox;switch(n){case 28:return u.Id;case 27:case 26:return u;case 3:return d.ConversationId.Id;case 7:return s.Flag;case 8:return s.Flag?s.Flag.FlagStatus:null;case 14:return c.c(s);case 17:return s;case 18:return[u.Id];case 10:return u.Id;case 9:return[u.Id];case 19:return s.ReceivedOrRenewTime;case 20:return s.DateTimeReceived;case 21:return s.LastModifiedTime;case 32:return d&&!d.IsRead?1:0;case 22:return f;case 23:return null==f?void 0:f.EmailAddress;case 31:return f?[f.Name]:null;case 6:return a.executeSearchSortOrder;case 24:return s.ParentFolderId.Id;case 30:return s.Subject;case 29:return s.Size;case 5:return s.MentionedMe;case 13:return s.IsDraft;case 4:return s.IsDraft?[u.Id]:[];case 16:return s.IsSubmitted;case 12:return a.instrumentationContext;case 2:return s.Categories;case 1:return s.CanDelete;case 33:return s.validCouponIndexes;case 11:return s.Importance;case 0:return s.ArchiveTag;case 25:return s.PolicyTag;case 15:return O(s);default:return null}}(e,t,n);default:return null}}function ee(e,t,n){var i;const o=Object(a.a)(e,t.id);if(!o)return te("ConversationNotInCache",n),null;const u=o.id,h=Object(s.a)(u),O=l.u.conversations.get(u);let g=void 0;switch((null==O?void 0:O.conversationNodeIds)&&O.conversationNodeIds.length>0&&(g=Object(m.b)(O.conversationNodeIds[0])),n){case 28:return u;case 26:return null==h?void 0:h.clientId;case 27:if(Object(b.a)()){const t=Object(r.b)().expandedConversationViewState;let n=null;if(t.expandedRowKey==e&&(n=t.selectedNodeIds),!n||n.length<=0)return{Id:o.itemIds[0],mailboxInfo:null==h?void 0:h.clientId.mailboxInfo};if(1==n.length)return{Id:Object(f.a)(n[0],Object(d.a)(e)),mailboxInfo:null==h?void 0:h.clientId.mailboxInfo}}return null==h?void 0:h.clientId;case 3:return u;case 7:return null==g?void 0:g.Flag;case 8:return o.flagStatus;case 14:return c.b(o);case 17:return g;case 18:return o.itemIds;case 10:return h.globalItemIds[0];case 9:return h.globalItemIds||[];case 4:return o.draftItemIds||[];case 19:return o.lastDeliveryOrRenewTimeStamp;case 20:return o.lastDeliveryTimeStamp;case 21:return o.lastModifiedTimeStamp;case 32:return o.unreadCount;case 22:return null===(i=o.lastSender)||void 0===i?void 0:i.Mailbox;case 23:return o.lastSender&&o.lastSender.Mailbox.EmailAddress;case 6:return o.executeSearchSortOrder;case 24:return 1===t.tableQuery.type?o.parentFolderId:t.tableQuery.folderId;case 30:return h.subject;case 31:return o.uniqueSenders;case 29:return h.size;case 5:return o.effectiveMentioned;case 12:return o.instrumentationContext;case 2:return o.categories;case 1:return null==O?void 0:O.canDelete;case 33:return h.validCouponIndexes;case 11:return o.importance;case 0:return null==g?void 0:g.ArchiveTag;case 25:return null==g?void 0:g.PolicyTag;case 15:return p(o);case 16:case 13:default:return null}}function te(e,t){const n=Object(u.q)();let r=e+" PropertyType:"+t;n&&(r+=" Scenario:"+n.eventName),h.h.warn(r),Object(u.o)(e,{Scenario:null==n?void 0:n.eventName,propertyType:t})}},1885:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1683);function a(){return r.a.selectedTableViewId}},1891:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Mail=1]="Mail",e[e.Calendar=2]="Calendar",e[e.FilesHub=3]="FilesHub",e[e.FilesPicker=4]="FilesPicker",e[e.FileSuggestions=5]="FileSuggestions"}(r||(r={})),t.b=r},1892:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},1896:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),a=n(16);const i=Object(r.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new a.ObservableMap})},1898:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(47);const a="_ODSPPSL";function i(e){return Object(r.j)("doc-link-savePermission")&&e&&-1!==e.indexOf(a)?e.substring(0,e.length-a.length):e}function o(e){return!!Object(r.j)("doc-link-savePermission")&&e.lastIndexOf(a)===e.length-a.length}function c(e,t){return!Object(r.j)("doc-link-savePermission")||2!==t&&1!==t?e:e+a}},1903:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Private=0]="Private",e[e.Public=1]="Public"}(r||(r={}))},1905:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o}));var r=n(3);const a=Object(r.action)("REFRESH_SHARING_TIPS_FOR_ATTACHMENT",e=>({attachmentId:e})),i=Object(r.action)("SET_ATTACHMENT_CONTENTID",(e,t)=>({attachmentId:e,attachmentContentId:t})),o=Object(r.action)("SET_ATTACHMENT_ISINLINE",(e,t)=>({attachmentId:e,isInline:t}))},1912:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2316),a=n(1898);function i(e){const t=Object(r.a)(),n=Object(a.b)(e);return t.sharingLinks.get(n)}},1913:function(e,t,n){"use strict";var r=n(3),a=n(16);Object(r.createStore)("personaPhotoStore",{personaPhotoUrls:new a.ObservableMap})();n(2115),n(1903);var i=n(1763),o=n(1843),c=n(1809);function u(e){const t=Object(i.a)().groups.get(e.toLowerCase());return!!t&&!t.groupDetailsError}var s=n(1960),l=n(2219),d=n(1896);const f=Object(r.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(e,t,n,r){if(2==t){const t=Object(c.a)(e);Object(s.a)(t,"Site")[0].Url=n,Object(s.a)(t,"Files")[0].Url=r}}));var m=n(2135);function b(e){return e=e.toLocaleLowerCase(),Object(d.a)().groupSiteStatus.has(e)?Object(d.a)().groupSiteStatus.get(e):0}const h=e=>{const t="string"==typeof e?Object(c.a)(e):e;return t?t.ExternalDirectoryObjectId:null};n(1832),n(2106),n(2080),n(2116),n(2107);var p=n(2600),O=n(2601),g=n(2644),v=n(2602),I=n(2603),S=n(6);function w(e){const t=e.groupDetails?e.groupDetails.AccessType:e.basicInformation?e.basicInformation.AccessType:null;if(t){if(1===t)return Object(S.b)(v.a);if(3===t)return Object(S.b)(I.a)}return""}function j(e){const t=e.groupDetails?e.groupDetails.AccessType:e.basicInformation?e.basicInformation.AccessType:null;if(t){if(1===t)return Object(S.b)(g.b);if(3===t)return Object(S.b)(g.c)}return""}function y(e){let t=0;return e.members?t=e.members.totalCount:e.groupDetails&&(t=e.groupDetails.MemberCount),t?t>1?Object(S.c)(Object(S.b)(O.a),t.toString()):Object(S.c)(Object(S.b)(p.a),t.toString()):Object(S.b)(g.a)}n.d(t,"j",(function(){return i.a})),n.d(t,"l",(function(){return o.a})),n.d(t,"d",(function(){return c.a})),n.d(t,"m",(function(){return u})),n.d(t,"f",(function(){return s.a})),n.d(t,"g",(function(){return s.b})),n.d(t,"c",(function(){return l.a})),n.d(t,"i",(function(){return d.a})),n.d(t,"o",(function(){return f})),n.d(t,"n",(function(){return m.b})),n.d(t,"h",(function(){return b})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return j})),n.d(t,"k",(function(){return y}))},1914:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"v",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"h",(function(){return b})),n.d(t,"e",(function(){return h})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return O})),n.d(t,"k",(function(){return g})),n.d(t,"m",(function(){return v})),n.d(t,"p",(function(){return I})),n.d(t,"q",(function(){return S})),n.d(t,"n",(function(){return w})),n.d(t,"u",(function(){return j})),n.d(t,"a",(function(){return y})),n.d(t,"s",(function(){return C})),n.d(t,"t",(function(){return A}));var r=n(20);const a=new r.c(()=>n.e(1009).then(n.bind(null,3021)));let i=new r.a(a,e=>e.logEntityClicked);const o=new r.a(a,e=>e.logResponseReceived);let c=new r.a(a,e=>e.logSessionEnd),u=new r.a(a,e=>e.logResponseRendered);const s=new r.a(a,e=>e.logSearchBoxStateChanged);let l=new r.a(a,e=>e.logSearchResultInteraction),d=new r.a(a,e=>e.logResponseNeverRendered);const f=new r.a(a,e=>e.flushNonRenderedResponseReceivedItemsFromCache),m=new r.a(a,e=>e.logCachedContentRendered);let b=new r.a(a,e=>e.logFeedback);const h=new r.a(a,e=>e.logClientLayout),p=new r.a(a,e=>e.logClientDataSource),O=new r.a(a,e=>e.logEntitiesFromFilePicker),g=new r.a(a,e=>e.logResponseRecievedV2),v=new r.a(a,e=>e.logResultsRendered),I=new r.a(a,e=>e.logSearchEntityActions),S=new r.a(a,e=>e.logSearchFeedbackActions),w=new r.a(a,e=>e.logSearchActions);let j=new r.a(a,e=>e.logSecondaryEntityActionClicked);const y=new r.a(a,e=>e.clearProcessedTraceIds),C=new r.a(a,e=>e.logSearchSuggestionsClientLayoutEvent),A=new r.a(a,e=>e.logSearchSuggestionsResultsRenderedEvent)},1920:function(e,t,n){"use strict";n.d(t,"g",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return d}));var r=n(3);const a=Object(r.action)("onSxSReadingPaneChange",(e,t)=>({readingPaneState:e,sxsId:t})),i=Object(r.action)("onBeforeSxSReadingPaneChange",e=>({id:e})),o=Object(r.action)("onSxSChangeOrClose",(e,t)=>({selectedLinkId:e,isSelectedLinkReadOnly:t})),c=Object(r.action)("showSxS",(e,t,n,r,a,i)=>({customization:e,extendedViewState:t,editState:n,selectedLinkId:r,sxsId:a,sigsInfo:i})),u=Object(r.action)("closeSxS"),s=Object(r.action)("onComposeStateChange",(e,t)=>({composeId:e,sxsId:t})),l=Object(r.action)("cloneSxSStore",(e,t)=>({sxsId:e,newSxSId:t})),d=Object(r.action)("onCustomizationChange",(e,t)=>({customization:e,sxsId:t}))},1925:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1928:function(e,t,n){"use strict";var r=n(3016),a=n(2245),i=n(1753);const o={};class c{constructor(e,t,n){this.estimatedTimeToCompleteInMS=e,this.updateIntervalInPercent=t,this.updatePropertyHandler=n,this.start=()=>{this.currentTimePercent+=this.updateIntervalInPercent;const e=this.getActionCompletePercent();e<=this.maxPercent?(this.updatePropertyHandler(e),this.nextUpdateTimer=setTimeout(this.start,this.estimatedTimeToCompleteInMS*this.updateIntervalInPercent)):this.nextUpdateTimer=null},this.currentTimePercent=0,this.maxPercent=1-this.updateIntervalInPercent}complete(){this.clearUpdateTimer(),this.updatePropertyHandler(1),setTimeout(()=>this.updatePropertyHandler(1.1),500)}abort(){this.clearUpdateTimer(),this.updatePropertyHandler(0)}clearUpdateTimer(){this.nextUpdateTimer&&(clearTimeout(this.nextUpdateTimer),this.nextUpdateTimer=null)}getActionCompletePercent(){return Math.sqrt(2*this.currentTimePercent-this.currentTimePercent*this.currentTimePercent)}}function u(e,t){const n=o[e.Id];n&&(t?n.complete():n.abort(),delete o[e.Id])}function s(e,t,n,r){const a=new c(e,t,n);o[r.Id]=a,a.start()}var l=n(3026),d=n(3);Object(d.orchestrator)(r.a,async e=>{let t;!function(e){Object(i.a)(e,7,13)}(e.attachment);try{t=await Object(l.a)(null,null,null,e.attachment.attachmentId.Id)}catch(e){}const n=t?14:15;!function(e,t,n,r,o){u(e,!0),Object(a.a)(n,o),Object(i.a)(n,r,t)}(e.attachment.attachmentId,n,e.attachment,0,7)});var f=n(1854),m=n(2506),b=n(36);function h(e){return Object.assign({__type:"ConvertLocalToRefAttachmentRequest:#Exchange"},e)}var p=n(35);function O(e,t,n,r,a){const i=function(e,t,n,r,a){return h({ewsAttachmentId:{RootItemChangeKey:t.ChangeKey,RootItemId:t.Id,Id:e},itemId:e,subscriptionId:n,channelId:r,cancellationId:a})}(e,t,n,r,a);return void 0===(o={requestObject:i}).requestObject||o.requestObject.__type||(o.requestObject=h(o.requestObject)),Object(p.a)("ConvertLocalToRefAttachment",o,c);var o,c}var g=n(71),v=n(1713),I=n(2051),S=n(2118),w=n(47),j=n(1761),y=n(702);const C={};var A=Object(y.action)("convertClassicToCloudy")((function e(t,n,r,a=!0){const o=new g.b("AttachmentConvertClassicToCloudy");!function(e){Object(i.a)(e,5,8)}(t);return async function(e,t,n,r){const[a,i,o,c]=await Object(I.a)(n);C[e.Id]=a;try{await O(e.Id,t,a,c,a)}catch(e){r(e.message),j.k.importAndExecute(i,o)}}(t.attachmentId,n,i=>{if(T(t,i.ResultCode),P(o,t.attachmentId,i.ResultCode,i.Exception),0===i.ResultCode&&i.Response&&i.Response.ResponseMessages&&i.Response.ResponseMessages.Items&&i.Response.ResponseMessages.Items.length>0&&"NoError"===i.Response.ResponseMessages.Items[0].ResponseCode){const e=i.Response.ResponseMessages.Items[0];r(!0,e.Attachments[0])}else if(Object(w.j)("doc-authcontextStage2")&&25===i.ResultCode&&!a){const a=i.ClaimsChallenge;a?(async()=>{let i=!1;try{const e=await S.a.import();await e(a)}catch(e){i=!0}i?(b.h.info("convertClassicToCloud remediateAuth failed"),r(!1,null)):(b.h.info("Retry convertClassicToCloud after remediateAuth"),e(t,n,r,!0))})():r(!1,null)}else r(!1,null);return!0},e=>{T(t,1),r(!1,null),P(o,t.attachmentId,1,e)})}));function T(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,9)}delete C[e.attachmentId.Id]}function P(e,t,n,r){const a=Object(v.a)(t);e.addCosmosOnlyData(JSON.stringify({size:a.model.Size})),e.addCustomData([n]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}function E(e){return Object.assign({__type:"CancelConvertLocalToRefAttachmentRequest:#Exchange"},e)}function x(e){const t=function(e){return E({cancellationId:e})}(e);return void 0===(n=t)||n.__type||(n=E(n)),Object(p.a)("CancelConvertLocalToRefAttachment",n,r);var n,r}var R=Object(g.r)({name:"CancelConvertClassicToCloudy"},(function(e){const t=(n=e.attachmentId.Id,C[n]);var n;if(!t)throw new Error("Failed to find the cancellationId of ConvertClassicToCloudy");Object(i.a)(e,5,10),x(t)})),k=n(1959),D=Object(d.mutatorAction)("setActionCompletePercent",(function(e,t){e.actionCompletePercent=t})),N=n(2256),F=n(2234),M=n(1784),_=n(2413),L=n(2691),U=n(2692),V=n(1862),B=n(2257),W=n(1941),G=Object(y.action)("updateAttachment")((function(e,t,n,r,a){Object(L.a)(e.attachmentId);const o=Object.assign(Object.assign({},r.AttachmentId),{mailboxInfo:t.mailboxInfo});if(n.AttachmentId=o,r.Name&&(n.Name=r.Name),r.Size&&(n.Size=r.Size),r.ContentType&&(n.ContentType=r.ContentType),r.__type&&(n.__type=r.__type),n.IsInline&&(n.ContentId=r.ContentId),Object(V.b)(r)){const e=n;e.AttachLongPathName=r.AttachLongPathName,e.PermissionType=r.PermissionType,e.ProviderType=r.ProviderType,e.AttachmentThumbnailUrl=r.AttachmentThumbnailUrl,e.AttachmentPreviewUrl=r.AttachmentPreviewUrl}if(Object(_.a)([{attachmentId:o,attachment:n,permissionInfo:a}],!1),e.attachmentId=o,Object(B.a)(e))Object(F.a)(e,1);else{Object(M.h)(e,!1),setTimeout(()=>{D(e,1.1)},500),Object(i.a)(e,0,0),Object(N.a)(e,!1);const t=Object(v.a)(o);Object(W.a)(e,t,!1,e.strategy.supportedMenuActions),t.download.url||Object(U.a)(o,e.isReadOnly,!0)}}));function H(e){return Object.assign({__type:"ConvertRefToLocalAttachmentRequest:#Exchange"},e)}function z(e,t,n,r,a,i,o,c){const u=function(e,t,n,r,a,i,o,c){return H({ewsAttachmentId:e,emailId:t,subscriptionId:n,channelId:r,cancellationId:a,fullPathLocation:i,attachmentDataProviderId:c,PermissionLevel:o})}(e,t,n,r,a,i,o,c);return void 0===(s={requestObject:u}).requestObject||s.requestObject.__type||(s.requestObject=H(s.requestObject)),Object(p.a)("ConvertRefToLocalAttachment",s,l);var s,l}function q(e){return X(Object(v.a)(e).model.Size)}function Q(e){return 2856+.00145*e}function J(e){return 4*X(e)}function K(e){return 4*X(e)}function $(e){return 2*X(e)}function X(e){return Math.round(e/256)}var Y=n(2890);const Z={},ee=Object(d.action)("convertCloudyToClassic",(e,t,n,r,a,i)=>({attachment:e,parentItemId:t,fullPathLocation:n,permissionLevel:r,replaceAttachmentHandler:a,source:i}));var te=ee;function ne(e,t){switch(t){case 0:break;case 11:Object(i.a)(e,0,0);break;default:Object(i.a)(e,0,12)}delete Z[e.attachmentId.Id]}function re(e,t,n,r,a){var i;const o=Object(v.a)(t);e.addCosmosOnlyData(JSON.stringify({size:o.model.Size,attachmentId:null===(i=o.model.AttachmentId)||void 0===i?void 0:i.Id})),e.addCustomData([n,a]),0===n||11===n?e.end():e.endWithError("ServerError",new Error(r))}Object(d.orchestrator)(ee,e=>{const t=e.attachment;!async function(e,t,n,r,a,o){const c=new g.b("AttachmentConvertCloudyToClassic");!function(e){Object(i.a)(e,6,11)}(e);await async function(e,t,n,r,a,i){const[o,c,u,s]=await Object(I.a)(a);Z[e.Id]=o;try{await z(e.Id,t,o,s,o,n,r)}catch(e){i(e.message),j.k.importAndExecute(c,u)}}(e.attachmentId,t,n,r,t=>{if(ne(e,t.ResultCode),re(c,e.attachmentId,t.ResultCode,t.Exception,o),0===t.ResultCode){const e=Object(Y.a)({Name:t.Item.Name,Size:t.Item.Size,AttachmentId:t.NewAttachmentId});a(!0,e)}else a(!1,null);return!0},t=>{ne(e,1),a(!1,null),re(c,e.attachmentId,1,t,o)})}(t,e.parentItemId,e.fullPathLocation,e.permissionLevel,(n,r)=>{n?e.replaceAttachmentHandler(t,r,!1,!0):u(t.attachmentId,n)},e.source),s(q(t.attachmentId),.1,e=>{D(t,e)},t.attachmentId)});var ae={name:"CancelConvertCloudyToClassic"};function ie(e){return Object.assign({__type:"CancelConvertRefToLocalAttachmentRequest:#Exchange"},e)}function oe(e){const t=function(e){return ie({cancellationId:e})}(e);return void 0===(n=t)||n.__type||(n=ie(n)),Object(p.a)("CancelConvertRefToLocalAttachment",n,r);var n,r}var ce=n(80);const ue=Object(d.action)("cancel_ConvertCloudyToClassic",e=>Object(ce.b)(ae,{attachmentViewState:e}));var se=ue;Object(d.orchestrator)(ue,e=>{const t=function(e){return Z[e]}(e.attachmentViewState.attachmentId.Id);if(!t)throw new Error("Failed to find the cancellationId of ConvertCloudyToClassic");Object(i.a)(e.attachmentViewState,6,10),oe(t)});var le=n(1798),de=n(1786),fe=n(2490),me=n(2142),be=n(1778);async function he(e){const t=await me.h.import(),n=e.model;n.ProviderType===be.d.ONE_DRIVE_PRO&&t(n.AttachLongPathName,fe.a.OneDrivePro,!1).then(async t=>{if(!t||0!==t.ResultCode)return;const n=Object(de.b)(e.model,!0),r=await le.f.importAndExecute(n,e.attachmentClass,e.model,!0,e.model.ProviderType,t);le.k.importAndExecute(e.id,r),Object(le.n)(e.id)})}var pe=n(1696);function Oe(e,t,n){if(e&&t===be.d.ONE_DRIVE_PRO&&(Object(w.j)("doc-SxS-jsApi-ODB-Base")||Object(w.j)("doc-SxS-jsApi-ODB-BaseNoEditString")||Object(w.j)("doc-SxS-jsApi-ODB-Readonly"))){const e=n&&n.substring(n.lastIndexOf("."));switch(Object(pe.f)(e)){case pe.a.Word:return Object(w.j)("doc-SxS-jsApi-ODB-Word");case pe.a.Excel:return Object(w.j)("doc-SxS-jsApi-ODB-Excel");case pe.a.PowerPoint:return!Object(w.j)("doc-SxS-jsApi-ODB-Readonly")&&Object(w.j)("doc-SxS-jsApi-ODB-PowerPoint")}}return!1}var ge=n(2255),ve=n(1777);function Ie(e,t,n=!1,r=0,a=!1){return{attachmentType:1,attachmentId:e,isInline:!0,isHiddenInline:n,placeholderId:t,status:r,fileType:ve.a.Inline,skipProcessInlineImage:a}}function Se(e){return!!e.strategy.isSaveToCloudSupported&&-1===e.completedActions.indexOf(2)}var we=n(2254);n.d(t,"a",(function(){return f.a})),n.d(t,"h",(function(){return m.a})),n.d(t,"c",(function(){return R})),n.d(t,"e",(function(){return A})),n.d(t,"u",(function(){return k.a})),n.d(t,"w",(function(){return k.c})),n.d(t,"v",(function(){return k.b})),n.d(t,"D",(function(){return k.d})),n.d(t,"x",(function(){return D})),n.d(t,"y",(function(){return N.a})),n.d(t,"z",(function(){return F.a})),n.d(t,"A",(function(){return i.a})),n.d(t,"E",(function(){return G})),n.d(t,"r",(function(){return W.a})),n.d(t,"o",(function(){return W.b})),n.d(t,"d",(function(){return se})),n.d(t,"f",(function(){return te})),n.d(t,"m",(function(){return he})),n.d(t,"b",(function(){return Oe})),n.d(t,"B",(function(){return s})),n.d(t,"C",(function(){return u})),n.d(t,"k",(function(){return Q})),n.d(t,"l",(function(){return K})),n.d(t,"q",(function(){return J})),n.d(t,"j",(function(){return $})),n.d(t,"g",(function(){return ge.a})),n.d(t,"i",(function(){return Ie})),n.d(t,"p",(function(){return q})),n.d(t,"t",(function(){return Se})),n.d(t,"s",(function(){return B.a})),n.d(t,"n",(function(){return we.a}))},1931:function(e,t,n){"use strict";var r;!function(e){e[e.NoAction=0]="NoAction",e[e.Preview=1]="Preview",e[e.Download=2]="Download",e[e.OpenInNewTab=3]="OpenInNewTab"}(r||(r={})),t.a=r},1934:function(e,t,n){"use strict";var r=n(1799),a=n(611);function i(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function o(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var c=n(1925),u=n(1698);var s=n(1678),l=n(1782),d=n(1679),f=n(1767);n.d(t,"a",(function(){return I})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return w}));const m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(l.b)({folderId:Object(s.a)(d.k),kind:"PrimaryMailbox"}));const t=Object(f.b)("UserMailbox");for(let n of t)e.push(Object(l.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(a.a)({Id:e.folderId}),[(i={FolderScope:o({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},i))];var i}},b={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(l.a)({folderId:Object(s.a)(d.d),kind:"ArchiveMailbox"})),e.push(Object(l.a)({folderId:Object(s.a)(d.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(a.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(c={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},c))]:[i({FolderScope:o({BaseFolderId:n})})];var c}},h={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},p={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(c.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},O={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v=e=>{switch(e.kind){case"PrimaryMailbox":return m;case"ArchiveMailbox":return b;case"SharedFolders":return h;case"Group":return p;case"Calendar":return O;case"PublicFolder":return g;default:throw new Error("Unregistered search scope")}},I=e=>v(e).getKey(e),S=e=>v(e).getSearchScopeList(),w=e=>v(e).getSearchScopeType(e)},1941:function(e,t,n){"use strict";var r=n(2493),a=n(6),i=n(2245),o=n(1753);var c=n(1854),u=n(1862),s=n(1786),l=n(1798),d=n(1857),f=n(702);n.d(t,"b",(function(){return b}));let m=null;function b(){return m||(m=Object.keys(c.a).reduce((e,t)=>{const n=c.a[t];return Number.isInteger(n)&&e.push(n),e},[])),m}t.a=Object(f.action)("initializeAttachmentFullViewState")((function(e,t,n,f,m,h){var p;f&&0!==f.length||(p=t.model,f=Object(l.c)(p)?function(e){return 2===Object(d.a)(e)?[c.a.Preview,c.a.Download]:[c.a.Download]}(p):b());const O=Object(s.b)(t.model,!0),g=Object(s.e)(),v=Object(u.a)(t),I=Object(r.a)(g,O,t.attachmentClass,t.model,v?t.model.ProviderType:null,t.model.AttachmentOriginalUrl,t.info.allowDownload,f,e.isReadOnly,n,m,h);e.strategy=I,function(e,t,n){n&&!Object(a.k)(t.model.AttachmentOriginalUrl)&&(Object(i.a)(e,2),Object(o.a)(e,0,2))}(e,t,e.strategy.isSaveToCloudSupported)}))},1943:function(e,t,n){"use strict";var r=n(2435),a=n(2488),i=n(282);const{getDataProviderInfo:o,getDefaultDataProviderInfo:c}=Object(r.a)((function(e){switch(e){case 0:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:(e,t)=>t,supportedPermissionLevels:[2,1]});case 3:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 2:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:(e,t)=>!1});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:e=>Object(a.a)(e),supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(i.a)(e)}}));t.a=o},1953:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(282);function a(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1956:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1831),a=n(1683);function i(e,t){const n=Object(r.a)(e,t);return a.a.tableViewItemRelations.get(n)}},1957:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.AttachmentId)&&a(e.AttachmentId.Id)}function a(e){return e&&-1!==e.indexOf("smime-")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}))},1959:function(e,t,n){"use strict";var r=n(36),a=n(71),i=n(2574),o=n(2975),c=n(1713),u=n(2604),s=n(2896),l=n(2118),d=n(47),f=n(2803),m=n(702),b=n(3018),h=n(2245),p=n(2493),O=n(1753),g=Object(m.action)("updateIsViewingInProviderSupported")((function(e,t){e.strategy.isViewingInProviderSupported=t}));n.d(t,"d",(function(){return v})),n.d(t,"c",(function(){return w})),n.d(t,"b",(function(){return j}));t.a=Object(m.action)("saveToCloud")((function e(t,n,r,a,i,o,c=!0){const[u,l]=I(t,n,r,a,!1,i,o,c,()=>{e(t,n,r,a,i,o,!0)});Object(s.b)(t.attachmentId,null,o,u,l)}));function v(e,t,n,r,a,i,o){const[c,u]=I(e,t,n,r,!0,i,o,!0,null);Object(s.c)(e.attachmentId,c,u,a,o)}function I(e,t,n,i,o,c,u,s,f){const m=new a.b("AttachmentSaveToCloud");b.a.run(2,e.attachmentId,u),w(e,o);return[a=>{const o=0===a.ResultCode;if(Object(d.j)("doc-authcontextStage2")&&25===a.ResultCode&&!s&&f){const s=a.ClaimsChallenge;if(s)return S(m,e.attachmentId,a.ResultCode,"ServerError",a.Exception,n,i,c),(async()=>{let n=!1;try{const e=await l.a.import();await e(s)}catch(e){n=!0}n?(r.h.info("saveToCloud remediateAuth failed"),j(e,o,o?a.Item.Location:null,u),t(o)):(r.h.info("saveToCloud retry after remediateAuth"),f())})(),!0}return j(e,o,o?a.Item.Location:null,u),t(o),S(m,e.attachmentId,a.ResultCode,"ServerError",a.Exception,n,i,c),!0},(r,a,o,u)=>{j(e,!1,null,u),t(!1),S(m,e.attachmentId,a,o,r,n,i,c)}]}function S(e,t,n,r,a,o,s,l){const d=Object(c.a)(t);e.addCustomData({entryPoint:o,result:n});const m=Object(u.a)(d);e.addCosmosOnlyData(JSON.stringify({size:d.model.Size,fileType:m})),0===n?e.end():e.endWithError(r,new Error(a)),Object(f.a)(null==s?void 0:s.Id).then(e=>{i.a.importAndExecute("SavedAttachment",{itemId:e,customProperties:{FileId:t.Id,FileType:m,Destination:"Cloud",Sender:l}})})}function w(e,t=!1){const n=t?18:1;Object(O.a)(e,2,n)}function j(e,t,n,r){if(t){Object(h.a)(e,2),Object(o.a)(e.attachmentId,n),b.a.run(3,e.attachmentId,r);const t=Object(p.b)(!1,!1,n);g(e,t)}else b.a.run(4,e.attachmentId,r);Object(O.a)(e,0,t?3:4)}},1960:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(1809);const a=(e,t)=>{const n="string"==typeof e?Object(r.a)(e):e;if(!n||!n.GroupResources)return null;const a=n.GroupResources.filter(e=>e.Name===t);return!a||a.length<1?null:a},i=(e,t)=>{const n=a(e,t);return n&&0!=n.length?n[0].Url:null}},1961:function(e,t,n){"use strict";var r=n(3),a=n(2853);const i=Object(r.createStore)("fileProviderStore",Object(a.a)());t.a=i},1969:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o}));var r=n(3);const a=Object(r.action)("FILE_PROVIDER_ADDED",e=>({providerViewState:e})),i=Object(r.action)("FILE_PROVIDER_REMOVED",e=>({providerType:e})),o=Object(r.action)("PROVIDERS_LOADED",e=>({providers:e}))},1971:function(e,t,n){"use strict";n.d(t,"l",(function(){return b})),n.d(t,"n",(function(){return h})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return O}));var r=n(20),a=n(2368);n.d(t,"b",(function(){return a.a}));var i=n(2328);n.d(t,"i",(function(){return i.a}));n(1961);var o=n(1969);n.d(t,"d",(function(){return o.a})),n.d(t,"e",(function(){return o.b})),n.d(t,"o",(function(){return o.c}));var c=n(2314);n.d(t,"a",(function(){return c.b}));var u=n(2102);n.d(t,"g",(function(){return u.a})),n.d(t,"h",(function(){return u.b}));var s=n(2315);n.d(t,"j",(function(){return s.a}));var l=n(2136);n.d(t,"c",(function(){return l.a}));var d=n(2291);n.d(t,"f",(function(){return d.b}));var f=n(910);const m=new r.c(()=>Promise.all([n.e(0),n.e(680)]).then(n.bind(null,4090))),b=new r.b(m,e=>e.loadProviders),h=new r.b(m,e=>e.removeFileProvider),p=new r.b(m,e=>e.addFileProvider),O=new r.b(m,e=>e.removeAndAddFileProvider);Object(r.f)(f.a,m,e=>e.resetFileProviderStoreOrchestrator)},1981:function(e,t,n){"use strict";var r=n(2645),a=n(2125),i=n(327),o=n(2265),c=n(36),u=n(610);function s(e,t,n,r,s,l,d,f){const m={cvid:n,query:e,textdecorations:"1",scenario:s,entityTypes:r};return d&&(m.logicalId=d),f&&(null==e?void 0:e.length)>0&&(m.setflight=f),t?Object(i.b)(Object(u.v)(Object(a.a)("suggestions"),Object(o.a)(m)),void 0,!0,l,void 0,!1).then(e=>e).catch(e=>(c.h.warn(e),null)):Promise.resolve(null)}var l=n(2124),d=n(1934),f=n(1764),m=n(2582);function b(e,t,n,r){const a=[];if(r===n){const n={Range:{[r]:{gte:t,lte:e}}};a.push(n)}else{const i={Range:{[r]:{gte:t}}};a.push(i);const o={Range:{[n]:{lte:e}}};a.push(o)}return a}var h=n(1678),p=n(1698),O=n(1679);function g(e,t,n,r=null){const a=[];0===e.length&&0===t.length&&null!=r&&e.push(Object(h.a)(r));for(const e of t)a.push({Term:{DistinguishedFolderName:e}});for(const t of e){if(t&&Object(p.a)(t)==O.d)return[];a.push({Term:{FolderId:t}})}n&&a.push({Term:{DistinguishedFolderName:"DeletedItems"}});const i=[],o={Or:a};return i.push(o),a.length>0?i:null}function v(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.TimeZoneContext)||void 0===t?void 0:t.TimeZoneDefinition)||void 0===n?void 0:n.Id)?e.TimeZoneContext.TimeZoneDefinition.Id:"UTC"}function I(e){var t,n,r;return(null===(r=null===(n=null===(t=null==e?void 0:e.EntitySets)||void 0===t?void 0:t[0])||void 0===n?void 0:n.ResultSets)||void 0===r?void 0:r[0])?e.EntitySets[0].ResultSets[0]:null}function S(e){return e?{Id:e.Id,ChangeKey:null}:null}function w(e,t){let n=null;if(null==t?void 0:t.TimeZone){n=new Date(e).toISOString()}return n}function j(e){return(null==e?void 0:e.EmailAddress)?{Mailbox:{EmailAddress:e.EmailAddress.Address,Name:e.EmailAddress.Name,RoutingType:"SMTP"}}:null}function y(e){return e?{__typename:"FolderId",Id:e.Id}:null}function C(e){switch(e){case"DateTime":return"DateTime";case"Hybrid":return"Hybrid";case"Relevance":return"Relevance";default:return null}}function A(e){if(null===e||0===e.length)return null;const t=[];for(let n=0;n<e.length;n++)t[n]=S(e[n]);return t}function T(e){var t;return(null===(t=null==e?void 0:e.QueryId)||void 0===t?void 0:t.Id)?{Id:e.QueryId.Id}:null}var P=n(38);const E="IPM.Appointment";function x(e){var t;const n=j(e.Organizer);return{CalendarItemType:e.CalendarItemType.toString(),Categories:e.Categories,CharmId:e.Charm,DisplayTo:e.DisplayTo,End:e.End,Start:e.Start,HasAttachments:e.HasAttachments,IsAllDayEvent:e.IsAllDayEvent,IsMeeting:e.IsMeeting,IsMeetingPollEvent:e.IsMeetingPollEvent,ItemClass:e.ItemClass?e.ItemClass:E,FreeBusyType:e.LegacyFreeBusyStatus?e.LegacyFreeBusyStatus.toString():null,Location:{DisplayName:e.Location},Sensitivity:e.Sensitivity,SeriesId:e.SeriesMasterItemId?e.SeriesMasterItemId.Id:null,Subject:e.Subject,Organizer:n,UID:e.UID,ItemId:S(e.ItemId),ParentFolderId:y(e.ParentFolderId),SerializedImmutableId:e.ImmutableId,SortOrderSource:C(e.SortOrderSource),Preview:e.Preview,IsOrganizer:e.IsOrganizer&&Object(P.a)().SessionSettings.UserEmailAddress===(null===(t=null==n?void 0:n.Mailbox)||void 0===t?void 0:t.EmailAddress),IsCancelled:e.IsCancelled,ResponseType:e.MyResponseType}}function R(e,t){var n;return{__typename:"ConversationType",Categories:e.Categories,ConversationId:S(e.ConversationId),ConversationTopic:e.ConversationTopic,FlagStatus:e.FlagStatus,From:j(e.From),GlobalItemIds:A(e.GlobalItemIds),GlobalMessageCount:e.GlobalMessageCount,GlobalUnreadCount:e.GlobalUnreadCount,HasAttachments:e.HasAttachments,HasIrm:e.HasIrm,HasProcessedSharepointLink:e.HasProcessedSharepointLink,Importance:e.Importance,ItemClasses:e.ItemClasses,ItemIds:A(e.ItemIds),LastDeliveryOrRenewTime:w(null!==(n=e.LastDeliveryOrRenewTime)&&void 0!==n?n:e.LastDeliveryTime,t),LastDeliveryTime:w(e.LastDeliveryTime,t),LastModifiedTime:w(e.LastModifiedTime,t),MessageCount:e.MessageCount,ParentFolderId:y(e.ParentFolderId),Preview:e.Preview,SortOrderSource:C(e.SortOrderSource),UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,UnreadCount:e.UnreadCount}}var k=n(47),D=n(1846);function N(e,t){var n;const r=function(e){if(!e)return e;const t=e.indexOf(":");return t>0&&t<6&&t+1<e.length?e.substring(t+1).trim():e}(e.Subject),a=Object(k.j)("fwk-immutable-ids")&&e.ImmutableId?{Id:Object(D.b)(e.ImmutableId),ChangeKey:null}:e.ItemId;return{Categories:e.Categories,ConversationId:S(e.ConversationId),ConversationIndex:e.ConversationIndex,ConversationThreadId:{Id:e.ConversationThreadId,ChangeKey:null},ConversationTopic:r,DateTimeReceived:w(e.DateTimeReceived,t),DateTimeSent:e.DateTimeSent&&w(e.DateTimeSent,t),LastModifiedTime:w(e.DateTimeLastModified,t),DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:(i=e.Flag,i?{FlagStatus:i.FlagStatus,CompleteDate:i.CompleteDate,DueDate:i.DueDate,StartDate:i.StartDate}:null),From:j(e.From),HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,IconIndex:e.IconIndex,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:a,MailboxGuids:e.MailboxGuids,ParentFolderId:y(e.ParentFolderId),Preview:e.Preview,Sender:j(e.Sender),SenderSMTPAddress:e.SenderSMTPAddress,Sensitivity:e.Sensitivity,SerializedImmutableId:e.ImmutableId,SortOrderSource:C(e.SortOrderSource),Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,ExtendedProperty:[{ExtendedFieldURI:{DistinguishedPropertySetId:"Common",PropertyId:3613,PropertyType:"String"},Value:r}]};var i}function F(e,t){var n,r,a,i,o,c,u,s,l;let d,f,m,b;if((null==t?void 0:t.length)>0){let e,n,r,a,i;t.sort((e,t)=>e.Timestamp&&t.Timestamp?t.Timestamp.localeCompare(e.Timestamp):0).forEach(t=>{"Modified"!=t.Type||n?"Created"!=t.Type||e?"Shared"!=t.Type||r?"Read"!=t.Type||a?"Trending"!=t.Type||i||(i=!0):a=!0:r=!0:(e=!0,d=t.User,f=t.Timestamp):(n=!0,m=t.User,b=t.Timestamp)})}const h=null!==(i=null!==(a=null!==(r=null!==(n=e.LinkingUrl)&&void 0!==n?n:e.ServerRedirectedURL)&&void 0!==r?r:e.OriginalPath)&&void 0!==a?a:e.ClassicAttachmentVisualizationUrl)&&void 0!==i?i:"";return{ItemId:null!==(u=null!==(c=null!==(o=e.UniqueId)&&void 0!==o?o:e.Id)&&void 0!==c?c:e.DocId)&&void 0!==u?u:"",FileName:null!==(s=e.FileName)&&void 0!==s?s:e.Filename,Title:e.Title,FileExtension:e.FileExtension,LinkingUrl:h,Author:(null==d?void 0:d.DisplayName)?[d.DisplayName]:e.Author,AuthorUpn:(null==d?void 0:d.Upn)||"",Created:null!=f?f:e.Created,ModifiedBy:null!==(l=null==m?void 0:m.DisplayName)&&void 0!==l?l:e.ModifiedBy,ModifiedByUpn:(null==m?void 0:m.Upn)||"",LastModifiedTime:null!=b?b:e.LastModifiedTime}}function M(){return{SearchResults:{MoreResultsAvailable:!1,TotalResultsCount:0,SearchResultsCount:0,TDQueryId:T(null)}}}function _(e){return 0===(e?e.length:0)?null:e.map(e=>({RefinerString:e.RefinerQuery}))}function L(e){if(!e)return"MailItems";switch(e){case"CalendarItems":return"Event";case"MailConversations":return"Conversation";case"MessageItems":return"Email";case"Files":return"File";case"MailItems":default:return"Message"}}var U,V,B=n(1782),W=n(2326),G=n(2152);!function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(U||(U={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData"}(V||(V={}));var H=n(2583),z=n(1892),q=n(1836);n.d(t,"J",(function(){return r.a})),n.d(t,"K",(function(){return s})),n.d(t,"g",(function(){return l.a})),n.d(t,"r",(function(){return d.a})),n.d(t,"y",(function(){return d.b})),n.d(t,"D",(function(){return f.e})),n.d(t,"E",(function(){return f.g})),n.d(t,"B",(function(){return f.b})),n.d(t,"C",(function(){return f.c})),n.d(t,"z",(function(){return a.a})),n.d(t,"w",(function(){return m.a})),n.d(t,"o",(function(){return b})),n.d(t,"q",(function(){return g})),n.d(t,"A",(function(){return v})),n.d(t,"x",(function(){return I})),n.d(t,"l",(function(){return x})),n.d(t,"k",(function(){return R})),n.d(t,"n",(function(){return N})),n.d(t,"m",(function(){return F})),n.d(t,"j",(function(){return T})),n.d(t,"p",(function(){return M})),n.d(t,"h",(function(){return _})),n.d(t,"i",(function(){return L})),n.d(t,"F",(function(){return B.b})),n.d(t,"e",(function(){return B.a})),n.d(t,"H",(function(){return B.d})),n.d(t,"I",(function(){return B.e})),n.d(t,"G",(function(){return B.c})),n.d(t,"s",(function(){return W.a})),n.d(t,"u",(function(){return G.b})),n.d(t,"t",(function(){return G.a})),n.d(t,"v",(function(){return G.c})),n.d(t,"f",(function(){return H.a})),n.d(t,"c",(function(){return z.b})),n.d(t,"b",(function(){return q.b})),n.d(t,"d",(function(){return q.c})),n.d(t,"a",(function(){return q.a}))},1982:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1683);function a(e){return r.a.conversationItems.get(e)}},1985:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("START_SEARCH",(e,t,n=!1,r=[],a,i="All")=>({actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r,searchProvider:a,filter:i}))},1987:function(e,t,n){"use strict";n.r(t),n.d(t,"DESCENDING_SORT_DIR",(function(){return a})),n.d(t,"ASCENDING_SORT_DIR",(function(){return i})),n.d(t,"DEFAULT_SORT_COLUMN",(function(){return o})),n.d(t,"getSortBySupportingPin",(function(){return c})),n.d(t,"getSupportedSortColumns",(function(){return u})),n.d(t,"getDefaultSortDirectionForSortColumn",(function(){return s})),n.d(t,"getDefaultSortBy",(function(){return l})),n.d(t,"isTableMultiValueSort",(function(){return d}));var r=n(1678);const a="Descending",i="Ascending",o=1;function c(){return{sortColumn:1,sortDirection:a}}function u(e){return Object(r.a)("sentitems")==e||Object(r.a)("drafts")==e?[1,7]:[1,3,7,5,8]}function s(e){switch(e){case 1:case 7:case 5:return a;case 3:case 8:return i;default:throw new Error("getDefaultSortDirectionForSortColumn: sortColumn not supported")}}function l(){return{sortColumn:o,sortDirection:s(o)}}function d(e){const t=0==e.type&&e.sortBy.sortColumn;return t&&0==e.listViewType&&3==t}},1988:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("SEARCH_SESSION_STARTED",(e,t,n)=>({actionSource:e,shouldStartSearch:t,scenarioId:n}))},1990:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1994:function(e,t,n){"use strict";function r(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 3:return e.tableQuery.focusedViewFilter;case 1:return-1;default:throw new Error("Table Query should be either of type search, mail folder or group")}}n.d(t,"a",(function(){return r}))},2003:function(e,t,n){"use strict";function r(e){const{isInVirtualSelectAllMode:t,virtualSelectAllExclusionList:n,selectedRowKeys:r,rowKeys:a,totalRowsInView:i,tableQuery:o,isInCheckedMode:c}=e;return t?0===n.length:(a.length==i||1==o.type)&&(c&&r.size==a.length)}n.d(t,"a",(function(){return r}))},2004:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(1799),a=n(611),i=n(47);function o(e,t){return e.serverFolderId?e.serverFolderId==e.tableQuery.folderId?t?null:c(e.tableQuery):u(e.serverFolderId):null}function c(e){return 2==e.type?(t=e.folderId,Object(r.a)({Id:Object(i.j)("grp-junkemailitems")?"junkemail":"inbox",Mailbox:{MailboxType:"GroupMailbox",EmailAddress:t}})):u(e.folderId);var t}function u(e){return Object(a.a)({Id:e})}},2007:function(e,t,n){"use strict";var r;function a(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),function(e){e.noPermissionToShare="WarningNoPermissionToShare",e.getSharingInfoFailed="WarningGetSharingInfoFailed",e.linkHasExpired="WarningLinksHasExpired",e.linkWillExpire="WarningLinksWillExpire",e.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",e.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",e.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",e.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},2012:function(e,t,n){"use strict";function r(e){return!(null==e?void 0:e.ItemClass)||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.AddMemberRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")||-1!==e.ItemClass.indexOf("IPM.Outlook.Recall")}n.d(t,"a",(function(){return r}))},2013:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(1747),a=n(38),i=n(1895),o=n(1693),c=n(1942);function u(e){const t=(null==e?void 0:e.itemIds)?e.itemIds.length:0;if(0==t)return[null,!1,!1];let n=null,a=2==Object(r.c)().type||!Object(r.b)(),u=!1;if(1==t){if(n=o.a.items.get(e.itemIds[0]),!n)return[null,!1,!1];a=a||n.ParentFolderId&&n.ParentFolderId.Id==Object(r.b)()}else{let t=null;for(const c of e.itemIds){const e=o.a.items.get(c);if(!e)return[null,!1,!1];if(e.ParentFolderId&&e.ParentFolderId.Id==Object(r.b)()){n=e,a=!0;break}Object(i.a)(e.ParentFolderId.Id,"sentitems")&&(t=e)}n||(n=t||o.a.items.get(e.itemIds[0]))}return u=Object(c.a)(n.ParentFolderId.Id),[n,a,u]}function s(e,t,n){var r;const i=Object(a.a)(),o=null===(r=null==i?void 0:i.UserOptions)||void 0===r?void 0:r.HideDeletedItems;return e&&!((e.IsDraft||o)&&t&&!n)}function l(e){const t=o.a.conversationNodes.get(e),[n,r,a]=u(t);return s(n,a,r)?n:null}},2014:function(e,t,n){"use strict";function r(e){return"persona"===e||"privatedistributionlist"===e||"category"===e}n.d(t,"a",(function(){return r}))},2015:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1675),a=n(1775);function i(e){return"Unread"!==Object(r.Q)(e)||Object(a.a)(64)}},2017:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.createStore)("currentGroupInformationStore",{smtpAddress:"",groupId:"",tenantId:""})},2023:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var r=n(1683),a=n(1758);function i(e){return Object(a.a)()&&u(e)&&!!r.a.expandedConversationViewState.forks}function o(e){return Object(a.a)()?u(e)&&!r.a.expandedConversationViewState.forks:u(e)}function c(e){const t=r.a.expandedConversationViewState,n=t.expandedRowKey==e&&t.shouldBeExpanded;return Object(a.a)()&&n&&!t.forks}function u(e){return r.a.expandedConversationViewState.expandedRowKey==e&&!r.a.expandedConversationViewState.shouldBeExpanded}},2031:function(e,t,n){"use strict";var r=n(3118),a=n(20),i=n(1920),o=n(2117),c=n(806),u=n(4112);function s(e){return e===window?Object(c.d)().sxsId:Object(u.a)(e)}var l=n(2551);function d(){const e=Object(c.d)().sxsId;return Object(o.a)(e).shouldShow}n(3323);var f=n(2379),m=n(3324),b=n(2713),h=n(3325),p=n(1784);n.d(t,"G",(function(){return g})),n.d(t,"p",(function(){return v})),n.d(t,"q",(function(){return I})),n.d(t,"r",(function(){return S})),n.d(t,"s",(function(){return w})),n.d(t,"t",(function(){return j})),n.d(t,"u",(function(){return y})),n.d(t,"v",(function(){return C})),n.d(t,"D",(function(){return A})),n.d(t,"w",(function(){return T})),n.d(t,"x",(function(){return P})),n.d(t,"y",(function(){return E})),n.d(t,"z",(function(){return x})),n.d(t,"A",(function(){return R})),n.d(t,"B",(function(){return k})),n.d(t,"C",(function(){return D})),n.d(t,"F",(function(){return N})),n.d(t,"H",(function(){return F})),n.d(t,"E",(function(){return M})),n.d(t,"i",(function(){return i.a})),n.d(t,"L",(function(){return i.f})),n.d(t,"N",(function(){return i.h})),n.d(t,"j",(function(){return i.b})),n.d(t,"M",(function(){return i.g})),n.d(t,"I",(function(){return i.c})),n.d(t,"J",(function(){return i.d})),n.d(t,"K",(function(){return i.e})),n.d(t,"l",(function(){return o.a})),n.d(t,"g",(function(){return r})),n.d(t,"k",(function(){return s})),n.d(t,"n",(function(){return l.a})),n.d(t,"o",(function(){return l.b})),n.d(t,"m",(function(){return d})),n.d(t,"f",(function(){return f.c})),n.d(t,"d",(function(){return f.a})),n.d(t,"e",(function(){return f.b})),n.d(t,"h",(function(){return m.a})),n.d(t,"c",(function(){return b.a})),n.d(t,"a",(function(){return h.a})),n.d(t,"b",(function(){return p.c}));const O=new a.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(332)]).then(n.bind(null,19456))),g=new a.b(O,e=>e),v=new a.b(O,e=>e.canCloseSxS),I=new a.b(O,e=>e.closeComposeInSxS),S=new a.b(O,e=>e.createImageGalleryFromAttachmentViewStateIds),w=new a.b(O,e=>e.editAndReply),j=new a.b(O,e=>e.editInDraft),y=new a.b(O,e=>e.forceCloseSxS),C=new a.a(O,e=>e.logUsageWithSxSCustomData),A=new a.a(O,e=>e.removeSxSViewFromDOM),T=new a.b(O,e=>e.onBeforeImageGalleryItemSelected),P=new a.b(O,e=>e.onChangeByImageGallery),E=new a.b(O,e=>e.onPendingNavigation),x=new a.b(O,e=>e.onPreviewOperationFinished),R=new a.b(O,e=>e.onPreviewOperationStart),k=new a.b(O,e=>e.openComposeInSxS),D=new a.b(O,e=>e.reloadTextPreview),N=new a.b(O,e=>e.showSxS),F=new a.a(O,e=>e.tryCloseSxS),M=(new a.b(O,e=>e.tryExitSxSEditMode),new a.b(O,e=>e.saveToCloudFromSxS))},2035:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return a})),n.d(t,"s",(function(){return i})),n.d(t,"q",(function(){return o})),n.d(t,"a",(function(){return c})),n.d(t,"n",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"d",(function(){return h})),n.d(t,"i",(function(){return p})),n.d(t,"p",(function(){return O})),n.d(t,"m",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"o",(function(){return I})),n.d(t,"l",(function(){return S}));const r="multipart/signed",a="application/pkcs7-mime",i="application/x-pkcs7-mime",o=".p7m",c="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",l="0800",d=57,f=78,m="IPM.Note.SMIME.MultipartSigned",b="smime-",h="image",p="OwaToSmime",O="SmimeToOwa",g="en-US",v=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],I="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",S="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},2048:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(6),a=n(296),i=n(52),o=n(2270),c=n(99),u=n(2),s=n(32),l=n(2050),d=n(2049);function f(e,t,n,f=!1,m=null){if(!e||!e.Id||!e.mailboxInfo)return null;const b=Object(l.b)(e.mailboxInfo),h=null==b?void 0:b.downloadUrlBase,p=Object(d.a)(e.mailboxInfo);if(m=m||Object(r.c)(t,encodeURIComponent(e.Id)),!h||f&&"Firefox"===Object(c.a)().browser){const e=o.e+m+"&X-OWA-CANARY="+Object(i.a)();return Object(s.a)(e)}let O="{0}{1}/{2}";Object(a.a)()&&(O+="&isc=1");let g=Object(r.c)(O,h,p,m);return n&&(g+="&token="+(null==b?void 0:b.downloadToken),g+="&X-OWA-CANARY="+Object(i.a)()),g+="&owa="+window.location.hostname,g+="&scriptVer="+Object(u.u)()||!1,g}},2049:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225),a=n(287);function i(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const t=e.userIdentity&&Object(a.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2050:function(e,t,n){"use strict";var r=n(287);const a={};function i(e){return a[e]}function o(e,t){const n=a[e];a[e]=Object.assign(Object.assign({},n),t)}var c=n(57),u=n(614),s=n(71),l=n(912),d=n(811),f=n(35);var m=n(36),b=n(1744),h=n(1743);const p=Object(d.b)({timeBetweenRetryInMS:()=>3e4});async function O(e){const t=async()=>{try{let t={};return Object(u.b)()?t={sourceId:Object(l.a)(null==e?void 0:e.userIdentity)}:Object(r.r)(e.userIdentity)&&(t=await async function(e){let t={};t.headers=new Headers;const n=await Object(b.a)(e);return Object(h.b)(t.headers,n),t}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(t)}catch(e){throw m.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},n=i(e.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){o(e.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:r}=p(async()=>{n++;const r=await t();m.h.info("update new token"),o(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),a=new s.c("AttachmentRefreshDownloadToken");try{await r(),a.addCustomData([n]),a.end()}catch(t){m.h.warn(`Retry to refresh token failed: ${t}`),a.addCustomData([n]),a.endWithError("ServerError",t),o(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function g(e){const t=Object(r.r)(e.userIdentity)?Object(c.h)(e.userIdentity):Object(c.g)(),n=null==t?void 0:t.ApplicationSettings;if(n){const t=n.DownloadUrlBase;o(e.userIdentity,{downloadUrlBase:t,downloadToken:n.FirstDownloadToken}),t&&function(e,t){t=t<1?1:t,Object(u.b)()&&O(e),setInterval(()=>{O(e)},6e4*t)}(e,n.DownloadTokenRefreshMinutes)}}var v=n(282);function I(e){const t=Object(r.j)(null==e?void 0:e.userIdentity),n=i(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Office365":case"Outlook":g(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(v.a)(t)}const a=i(e.userIdentity);return a||(Object(s.o)("FilesUrlDataNotFound",{accountProviderType:t}),m.h.warn("Unable to get the url data")),a}function S(e){if(!e)return null;const t=I(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return S}))},2051:function(e,t,n){"use strict";var r=n(326),a=n(1761);async function i(e,t){const n=t||Object(r.a)(),i={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null,noSubscriptionFailureReload:!0},o=t=>{e(t)&&a.k.importAndExecute(i,o)};(await a.j.import())(i,o);const c=(await a.b.import())();return[n,i,o,c]}n.d(t,"a",(function(){return i}))},2066:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2015),a=n(1675);function i(e){return"Unread"==Object(a.Q)(e)&&Object(r.a)(e)}},2067:function(e,t,n){var r=n(2074),a=36e5,i=6e4,o=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,l=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],d=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],m=/^-(\d{2})$/,b=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,p=/^-?W(\d{2})$/,O=/^-?W(\d{2})-?(\d{1})$/,g=/^(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,S=/([Z+-].*)$/,w=/^(Z)$/,j=/^([+-])(\d{2})$/,y=/^([+-])(\d{2}):?(\d{2})$/;function C(e,t,n){t=t||0,n=n||0;var r=new Date(0);r.setUTCFullYear(e,0,4);var a=7*t+n+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+a),r}e.exports=function(e,t){if(r(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var n=(t||{}).additionalDigits;n=null==n?o:Number(n);var A=function(e){var t,n={},r=e.split(c);u.test(r[0])?(n.date=null,t=r[0]):(n.date=r[0],t=r[1]);if(t){var a=S.exec(t);a?(n.time=t.replace(a[1],""),n.timezone=a[1]):n.time=t}return n}(e),T=function(e,t){var n,r=l[t],a=f[t];if(n=d.exec(e)||a.exec(e)){var i=n[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(n=s.exec(e)||r.exec(e)){var o=n[1];return{year:100*parseInt(o,10),restDateString:e.slice(o.length)}}return{year:null}}(A.date,n),P=T.year,E=function(e,t){if(null===t)return null;var n,r,a,i;if(0===e.length)return(r=new Date(0)).setUTCFullYear(t),r;if(n=m.exec(e))return r=new Date(0),a=parseInt(n[1],10)-1,r.setUTCFullYear(t,a),r;if(n=b.exec(e)){r=new Date(0);var o=parseInt(n[1],10);return r.setUTCFullYear(t,0,o),r}if(n=h.exec(e)){r=new Date(0),a=parseInt(n[1],10)-1;var c=parseInt(n[2],10);return r.setUTCFullYear(t,a,c),r}if(n=p.exec(e))return i=parseInt(n[1],10)-1,C(t,i);if(n=O.exec(e)){i=parseInt(n[1],10)-1;var u=parseInt(n[2],10)-1;return C(t,i,u)}return null}(T.restDateString,P);if(E){var x,R=E.getTime(),k=0;return A.time&&(k=function(e){var t,n,r;if(t=g.exec(e))return(n=parseFloat(t[1].replace(",",".")))%24*a;if(t=v.exec(e))return n=parseInt(t[1],10),r=parseFloat(t[2].replace(",",".")),n%24*a+r*i;if(t=I.exec(e)){n=parseInt(t[1],10),r=parseInt(t[2],10);var o=parseFloat(t[3].replace(",","."));return n%24*a+r*i+1e3*o}return null}(A.time)),A.timezone?x=function(e){var t,n;if(t=w.exec(e))return 0;if(t=j.exec(e))return n=60*parseInt(t[2],10),"+"===t[1]?-n:n;if(t=y.exec(e))return n=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-n:n;return 0}(A.timezone):(x=new Date(R+k).getTimezoneOffset(),x=new Date(R+k+x*i).getTimezoneOffset()),new Date(R+k+x*i)}return new Date(e)}},2068:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1849),a=n(1803);function i(e){return Object(a.b)().scenarioStores.get(Object(r.a)(e))||Object(a.a)()}},2069:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),a=n(80);const i=Object(r.action)("GET_SUGGESTIONS",e=>Object(a.b)({name:"Search_SuggestionsE2E"},{scenarioId:e}))},2074:function(e,t){e.exports=function(e){return e instanceof Date}},2080:function(e,t,n){"use strict";var r=n(3),a=n(2251);const i=Object(r.mutatorAction)("setJoinButtonState",(function(e,t){a.a.groupActionState.set(e.toLowerCase(),t)}));t.a=i},2102:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(1961);const a=()=>[...Object(r.a)().providers.values()],i=e=>Object(r.a)().providers.get(e)||null},2104:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(1709),a=n(47);function i(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(a.j)("cmp-prague")&&(".fluid"===t||".note"===t))}function o(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(a.j)("cmp-prague")&&".note"===t)}},2106:function(e,t,n){"use strict";var r=n(3),a=n(2250);const i=Object(r.mutatorAction)("setFollowButtonState",(function(e,t){a.a.groupActionState.set(e.toLowerCase(),t)}));t.a=i},2107:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1832),a=n(2251);function i(e){e=e.toLowerCase();const t=a.a.groupActionState;return t.has(e)?t.get(e):r.a.None}},2115:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var r=n(47),a=n(1843),i=n(57);function o(){return(Object(r.j)("grp-shareable-crud")||Object(a.a)().isSensitivityLabelsEnabled)&&!Object(i.r)()}function c(){return Object(r.j)("grp-shareable-crud-smtpEdit")&&Object(r.j)("grp-cardReloadAfterEditingSmtp")}},2116:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1832),a=n(2250);function i(e){e=e.toLowerCase();const t=a.a.groupActionState;return t.has(e)?t.get(e):r.a.None}},2117:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}));var r=n(1784),a=n(2406),i=n(3905),o=n(3),c=n(2713),u=n(2379);const s={sxsStoreMapping:new(n(16).ObservableMap)({})},l=Object(o.createStore)("sxsStore",s);function d(e){if(e=e||u.a,!l().sxsStoreMapping.has(e)){const t=function(){const e={shouldShow:!1,viewState:Object(i.a)(),extendedViewState:{previewMode:r.b.Unsupported,attachmentId:null,selectionSource:r.c.MailList,isCloudy:!1,saveToCloudStatus:0,textPreviewReadMode:0},editState:{mode:c.a.View,editAllowed:!1,itemId:null,isDraft:!1},customPreviewState:null,eventManager:new a.a,pendingPreviewOperation:null,pendingNavigation:null,readingPaneState:null,composeId:null,customization:null,isInvisible:!0,shouldUseFakeRightHandSide:!1,isUsingFakeRightHandSide:!1,attachmentViewStateIdFromListView:null,sessionPreviewCount:0,sessionStartTime:0,meetingMessageAddToCalendarStatus:1,sigsInfo:null};return e.viewState.previewPane=null,e}();l().sxsStoreMapping.set(e,t)}return l().sxsStoreMapping.get(e)}},2124:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1934);function a(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},2125:function(e,t,n){"use strict";function r(e,t){return`search/api/${2===t?"v2":"v1"}/${e}`}n.d(t,"a",(function(){return r}))},2130:function(e,t,n){"use strict";var r=n(1774);function a(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var i=n(1953),o=n(1738);function c(){return a()}function u(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(o.a)(e)}(e))}(e)?a():[]).map(i.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}))},2135:function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var r=n(3),a=n(1896);const i=Object(r.mutatorAction)("setGroupSiteStatus",(function(e,t){e=e.toLocaleLowerCase(),Object(a.a)().groupSiteStatus.has(e)&&t==Object(a.a)().groupSiteStatus.get(e)||Object(a.a)().groupSiteStatus.set(e,t)}));t.a=i},2136:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},2142:function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"m",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"g",(function(){return h})),n.d(t,"j",(function(){return p})),n.d(t,"l",(function(){return O}));var r=n(20),a=n(2283);n.d(t,"n",(function(){return a.a}));var i=n(2269);n.d(t,"a",(function(){return i.a}));var o=n(2007);n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return o.a}));var c=n(2284);n.d(t,"b",(function(){return c.a}));const u=new r.c(()=>Promise.all([n.e(0),n.e(24),n.e(96),n.e(608)]).then(n.bind(null,3852))),s=new r.b(u,e=>e.getSharingInformation),l=new r.b(u,e=>e.getSharingIssuesForSharingData),d=new r.b(u,e=>e.getInfoBarCreator),f=new r.b(u,e=>e.hasLargeDLRecipient),m=new r.b(u,e=>e.hasRecipientExpansionFailure),b=new r.b(u,e=>e.getGroupsAndSmallDLs),h=new r.b(u,e=>e.getInvididualRecipients),p=new r.b(u,e=>e.hasGetRecipientPermissionFailed),O=new r.b(u,e=>e.logSharingTipChangesForLinkRemoval)},2144:function(e,t,n){"use strict";var r=n(20);const a=[0,1];var i=n(2518),o=n(2500),c=n(6),u=n(282),s=n(1804);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(o.a),messageParts:[Object(c.b)(o.a),d()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(c.b)(i.b),messageParts:[Object(c.b)(i.b),d()],color:s.a.Red};default:return Object(u.a)(e)}}function d(){return{text:Object(c.b)(i.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2130),m=n(1953),b=n(47),h=n(1774);function p(){const e=Object(h.a)();if(Object(b.j)("fwk-devTools")){if(Object(b.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(b.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){const e=p();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return v})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return m.a})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return p}));const g=new r.c(()=>n.e(1929).then(n.bind(null,19270))),v=new r.b(g,e=>e.getAccessIssuesForAttachments)},2150:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("RESET_SEARCH_STORE",e=>({scenarioId:e}))},2152:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o}));const r=[{resultRowOffset:0,resultRowCount:25,pageNumber:0},{resultRowOffset:25,resultRowCount:50,pageNumber:1},{resultRowOffset:75,resultRowCount:75,pageNumber:2},{resultRowOffset:150,resultRowCount:100,pageNumber:3},{resultRowOffset:250,resultRowCount:200,pageNumber:4},{resultRowOffset:450,resultRowCount:200,pageNumber:5},{resultRowOffset:650,resultRowCount:200,pageNumber:6},{resultRowOffset:850,resultRowCount:200,pageNumber:7}];let a=function(e,t={pageContexts:r}){if(e<0||e>=t.pageContexts.length)throw new Error("The pageNumber for execute search is invalid:"+e);return t.pageContexts[e]},i=function(e,t,n,i={pageContexts:r}){const o=e.pageNumber+1,c="PrimaryMailbox"===n?2:4;return t.MoreResultsAvailable&&o<c?a(o,i):null};const o=e=>{switch(e){case 74:return r[2];case 149:return r[3];case 249:return r[4];case 449:return r[5];case 649:return r[6];case 849:return r[7];default:return null}}},2167:function(e,t,n){"use strict";function r(e){return 0===e.tableQuery.listViewType}n.d(t,"a",(function(){return r}))},2179:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("CLEAR_SEARCH_BOX",e=>({scenarioId:e}))},2180:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("END_SEARCH_SESSION",(e,t)=>({scenarioId:e,actionSource:t}))},2181:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_BACKSPACE_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2182:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_DOWN_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2183:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_LEFT_ARROW_PRESSED_SEARCH_INPUT",(e,t)=>({cursorPosition:e,scenarioId:t}))},2184:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_UP_ARROW_PRESSED_SEARCH_INPUT",e=>({scenarioId:e}))},2185:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("REMOVE_SUGGESTION_PILL_FROM_SEARCHBOX",(e,t,n)=>({suggestionPillId:e,scenarioId:t,actionSource:n}))},2186:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("SET_IS_SUGGESTIONS_DROPDOWN_VISIBLE",(e,t)=>({isSuggestionsDropdownVisible:e,scenarioId:t}))},2187:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("setShowSearchBoxInCompactMode",(function(e,t){return{scenarioId:e,showSearchBoxInCompactMode:t}}))},2188:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("UPDATE_IS_SUGGESTION_SET_COMPLETE",(e,t)=>({isComplete:e,scenarioId:t}))},2189:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("ON_DISMISS_GHOST_TEXT_VIA_KEYBOARD",e=>({scenarioId:e}))},2190:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.d}},2209:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),a=n(80);const i=Object(r.action)("onSearchScopeButtonClicked",(e,t)=>Object(a.b)({name:"Search_ScopeButtonClicked",customData:{isFolderScopeVisible:e,searchScenarioType:t}},{isScopeVisible:e,searchScenarioType:t}))},2210:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("onSearchScopeOptionSelected",(e,t)=>({selectedSearchScope:e,searchScenarioType:t}))},2219:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2017);const a=()=>Object(r.a)().smtpAddress},2229:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2579),a=n(2580),i=n(2594),o=n(6),c=n(1675);function u(e,t,n){if(1===e)return Object(o.b)(i.a);if(t){if(Object(c.P)(t))return Object(c.P)(t);switch(Object(c.n)(t)){case 0:return Object(o.b)(a.a);case 1:return Object(o.b)(r.a)}}return n}},2230:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1791);function a(e,t,n,a){const i=[],o=new Map;for(let c=0;c<e.length;c++){const u=e[c],s=Object(r.a)(u,t),l=s.id;!o.get(l)&&n(s,a)&&(i.push(u),o.set(l,!0))}return i}},2234:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setInlineAttachmentStatus")((function(e,t){e.status=t}))},2238:function(e,t,n){"use strict";var r=n(282),a=n(2614),i=n(52),o=n(2712);function c(e,t,n,i,c=!0){var u;const{Name:s,OriginalPermissionType:l,PermissionType:d}=t,f=Object(o.a)(t),m="GroupMailbox"===(null===(u=null==e?void 0:e.mailboxInfo)||void 0===u?void 0:u.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return a.b(e,f,n,i,d,l,c,s,m);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:a.b(e,f,1,i,d,l,c,s,m);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function u(e,t,n=!1,r=!0){return a.a(e,t,n,r)}function s(e,t,n,r,o=!1){const s=n?c(e,t,1,r,!1):u(e,1,o,!1);if(n)return{url:s,init:{credentials:"include",headers:new Headers}};{const t=a.c(e.mailboxInfo),n=new Headers;return n.set("X-Token",t),n.set("X-OWA-CANARY",Object(i.a)()),{url:s,init:{headers:n}}}}function l(e,t,n,r,a,i=!1){return r?c(e,t,n,a):u(e,n,i)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}))},2239:function(e){e.exports=JSON.parse('{"a":"I6b","b":"J6b","c":"K6b"}')},2240:function(e){e.exports=JSON.parse('{"a":"F6b","b":"G6b","c":"H6b"}')},2241:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2014);function a(e,t){switch(e.tableQuery.type){case 0:const n=e.tableQuery.scenarioType;return t&&!Object(r.a)(n)?e.tableQuery.folderId:e.serverFolderId;case 1:case 2:default:return null}}},2242:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1683),a=n(1866);function i(e,t){const n=r.a.tableViews.get(t),i=e.map(e=>Object(a.getRowIdString)(e,n)).filter(e=>e);return i.filter((e,t)=>i.indexOf(e)==t)}},2243:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.BusStart=1]="BusStart",e[e.BusEnd=2]="BusEnd",e[e.BusStop=3]="BusStop",e[e.NoStop=4]="NoStop",e[e.CheckMark=5]="CheckMark"}(r||(r={})),t.a=r},2245:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("addCompletedAction")((function(e,t){e.completedActions.push(t)}))},2250:function(e,t,n){"use strict";var r=n(3),a=n(16);t.a=Object(r.createStore)("followButtonStore",{groupActionState:new a.ObservableMap})()},2251:function(e,t,n){"use strict";var r=n(3),a=n(16);t.a=Object(r.createStore)("joinButtonStore",{groupActionState:new a.ObservableMap})()},2254:function(e,t,n){"use strict";n.d(t,"b",(function(){return c}));var r=n(282),a=n(2435),i=n(296);const{getDataProviderInfo:o,getDefaultDataProviderInfo:c}=Object(a.a)((function(e){switch(e){case 0:return function(){const e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object.assign(Object.assign({},e),{supportViewInProvider:!0,supportConvertCloudyToClassic:!0})}();case 1:return function(){const e={supportViewInProvider:!1,supportConvertCloudyToClassic:!1};return Object.assign(Object.assign({},e),{supportConvertCloudyToClassic:Object(i.a)()})}();case 3:case 2:case 6:case 5:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};case 7:case 8:case 9:case 4:case 10:return{supportViewInProvider:!1,supportConvertCloudyToClassic:!1};default:return Object(r.a)(e)}}));t.a=o},2255:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1784),a=n(1777);function i(e,t,n,i,o=a.a.Unknown,c=!1,u=null){const s=Object(r.d)(e,t,i,c,o,u),l=s.strategy;return Object.assign(Object.assign({},s),{attachmentType:0,strategy:Object.assign(Object.assign({},l),{isSaveToCloudSupported:!1,isViewingInProviderSupported:!1,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]}),shouldShowContextMenu:!1,shouldShowImageOverlay:!1,shouldShowActionsContainer:!1,ongoingAction:n?0:1,completedActions:[],actionMessage:0,actionCompletePercent:n?1.1:.01})}},2256:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setAttachmentShouldShowContextMenu")((function(e,t){e.shouldShowContextMenu=t}))},2257:function(e,t,n){"use strict";function r(e){return 1===e.attachmentType}n.d(t,"a",(function(){return r}))},2264:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];const n=[];if(0===t){const t=e;t.CanShareInternally&&(n.push(2),n.push(1)),t.CanCreateOrganizationEditLink&&n.push(6),t.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function a(e,t,n){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return n?t?2:1:0;default:return 0}}var i=n(2933),o=n(6);const c="OneDrivePro";var u=n(282),s=n(38);function l(e,t){switch(e){case 3:return Object(o.b)(i.b);case 4:return Object(o.b)(i.a);case 6:return Object(o.b)(i.d);case 5:return Object(o.b)(i.e);case 1:return t===c?Object(o.b)(i.g):Object(o.b)(i.b);case 2:return t===c?Object(o.b)(i.f):Object(o.b)(i.a);case 0:return Object(o.b)(i.c);default:return Object(u.a)(e)}}function d(e,t){return 0===t?function(e){var t;const n=null===(t=Object(s.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(o.b)(i.i);case 4:return Object(o.b)(i.h);case 6:return Object(o.c)(Object(o.b)(i.j),n);case 5:return Object(o.c)(Object(o.b)(i.k),n);case 1:return Object(o.b)(i.g);case 2:return Object(o.b)(i.f);case 0:return Object(o.b)(i.c);default:return Object(u.a)(e)}}(e):l(e,null)}function f(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f}))},2265:function(e,t,n){"use strict";var r=n(132);var a=n(47),i=n(5);n.d(t,"a",(function(){return c}));const o="searchtesthook";function c(e={}){const t=function(e,...t){const n={};for(const r of t)for(const t of Object.keys(r))e.includes(t)&&n.hasOwnProperty(t)?n[t]=n[t]+","+r[t]:n[t]=r[t];return n}(["setflight"],e,function(){let e={};const t=Object(i.c)(o),n=decodeURIComponent(t||"").trim();if(Object(a.j)("sea-debugHook")&&n.length>0){e=n.split("&").reduce((e,t)=>{const[n,r]=t.split("=");return e[n]=r,e},{})}return e}(),Object(r.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(t).filter(e=>null!==t[e]).reduce((e,n)=>Object.assign(Object.assign({},e),{[n]:t[n]}),{})}},2268:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),a=n(1990);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},2269:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.InProgress=0]="InProgress",e[e.Failed=1]="Failed",e[e.Succeeded=2]="Succeeded"}(r||(r={}))},2270:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return l}));const r="/owa/",a="service.svc/s/GetFileAttachment?id={0}",i="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",o="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",u="service.svc/s/GetAttachmentThumbnail?id={0}",s="pdfprint.aspx?id={0}",l="pdfprint.aspx?id={0}&location={1}"},2271:function(e,t,n){"use strict";var r=n(282),a=n(6),i=n(52),o=n(2270);const c=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var u=n(2048),s=n(32);function l(e,t,n,l,d=0,f=0,m=!0,b=null,h=null){let p;switch(n){case 0:p=o.f;break;case 3:p=o.h;break;case 1:if(!function(e){if(!e)return!1;let t=null;const n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&c.indexOf(t.toLowerCase())>=0}(b))return null;p=o.g;break;default:Object(r.a)(n)}let O=l?f:d;!O&&d&&(O=d);let g=Object(a.c)("{0}&permissionLevel={1}",Object(a.c)(p,encodeURIComponent(e.Id),encodeURIComponent(t)),O);const v=Object(u.a)(e,p,!0,3===n,g);if(v)return v;let I=Object(a.c)("{0}{1}{2}",o.e,h,g);if(m){I=`${I}&X-OWA-CANARY=${Object(i.a)()}`}return Object(s.a)(I)}function d(e,t,n=!1,i=!0){let c;switch(t){case 0:c=o.a;break;case 1:c=o.b;break;case 2:c=o.d;break;case 3:c=o.c;break;default:return Object(r.a)(t)}if(!Object(a.k)(c)){const r=Object(u.a)(e,c,i,3===t);return Object(a.c)("{0}{1}{2}",r,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}))},2283:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("REFRESH_EXPIRATION_DATE",e=>({id:e}))},2284:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ignore=0]="ignore",e[e.refreshExpiration=1]="refreshExpiration",e[e.changePermission=2]="changePermission",e[e.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2291:function(e,t,n){"use strict";var r=n(35);function a(e){return Object.assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function i(e){const t=a({ProviderType:e});return void 0===(n=t)||n.__type||(n=a(n)),Object(r.a)("GetNewAttachmentDataProviderCreationInfo",n,i);var n,i}function o(e){return Object.assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function c(e){const t=o({ProviderType:e});return void 0===(n=t)||n.__type||(n=o(n)),Object(r.a)("GetAttachmentDataProviderCreator",n,a);var n,a}var u=n(2834),s=n(2715);n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v}));const l="code",d=3e3,f=3;function m(e){return{state:e}}function b(e){return e.state}function h(e){return e.code}function p(e,t,n,r,a){const o={providerType:e,getAuthUrlInfo:null,getCSRFToken:b,getOAuthCode:h};return async function e(t,n,r,a,o,s,l){try{let e;if(7===t||9===t||8===t){const n=await c(t);e=n.AttachmentDataProviderCreator.ProviderAppKey,r=n.AttachmentDataProviderCreator.AuthorizationUri}else{e=(await i(t)).ProviderAppKey}n.getAuthUrlInfo=Object(u.d)(t,r,a,e,o,s)}catch(i){l>0&&setTimeout(()=>e(t,n,r,a,o,s,--l),d)}}(e,o,t,n,r,a,f),o}let O=null;function g(){if(!O){if(O={},Object(s.a)(3)&&(O[3]=p(3,"https://app.box.com/api/oauth2/authorize",Object(u.c)(3),l,m)),Object(s.a)(2)&&(O[2]=p(2,"https://www.dropbox.com/oauth2/authorize",Object(u.b)(2),l,m)),Object(s.a)(5)){const e=p(5,"https://accounts.google.com/o/oauth2/auth",`${u.a}/ADPRedirect.aspx`,l,e=>{const t={state:e,provider:5..toString(),url:Object(u.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});e.getCSRFToken=e=>{return JSON.parse(e.state).state},O[5]=e}Object(s.a)(1)&&(O[1]=p(1,"https://login.live.com/oauth20_authorize.srf",Object(u.c)(1),l,e=>({state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}))),Object(s.a)(7)&&(O[7]=p(7,"",Object(u.c)(7),l,m)),Object(s.a)(8)&&(O[8]=p(8,"",Object(u.c)(8),l,m)),Object(s.a)(9)&&(O[9]=p(9,"",Object(u.c)(9),l,m))}return O}function v(e){const t=g();return e in t?t[e]:null}},2314:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));const a=Object.freeze([1,3,2,6,5,7,8,9]),i=Object.freeze([...a,0,4,10])},2315:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1961);function a(){return Object(r.a)().loadState}},2316:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(16),a=n(3);const i={sharingLinks:new r.ObservableMap({}),linksIdContainerMap:new r.ObservableMap({})},o=Object(a.createStore)("sharingLinkStore",i);t.a=o},2322:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="IPM.Note.SMIME"},2326:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(7);function a(){return Object(r.qc)().toString()}},2328:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(2874),a=n(2795),i=n(2852),o=n(6),c=n(282);function u(e,t=!1){if(t)return"";switch(e){case 0:return Object(o.b)(i.b);case 1:return Object(o.b)(i.a);case 2:case 9:return Object(o.b)(r.b);case 3:case 7:return Object(o.b)(r.a);case 5:return Object(o.b)(r.e);case 6:return Object(o.b)(r.d);case 4:return Object(o.b)(r.f);case 10:return Object(o.b)(a.b);case 8:return Object(o.b)(r.c);default:return Object(c.a)(e)}}},2329:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(35);function a(e,t){return Object(r.a)("GetWacAttachmentInfo",e,t)}},2338:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(20);const a=new r.c(()=>n.e(1160).then(n.bind(null,3350))),i=new r.b(a,e=>e.extractFileUrlFromOfficeSharePointLink),o=new r.b(a,e=>e.isLinkPrefixedWithBaseUrl),c=new r.b(a,e=>e.isSharePointLink),u=new r.b(a,e=>e.isSharePointServiceGeneratedLink),s=new r.b(a,e=>e.isOfficeSharePointLink),l=new r.b(a,e=>e.getParsedQueryStringFromUrl)},2339:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OneDrivePro=0]="OneDrivePro",e[e.OneDriveConsumer=1]="OneDriveConsumer",e[e.Dropbox=2]="Dropbox",e[e.Box=3]="Box",e[e.GDrive=5]="GDrive",e[e.OfficeOneDrivePro=31]="OfficeOneDrivePro"}(r||(r={}))},2349:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.none=0]="none",e[e.refreshing=1]="refreshing",e[e.refreshFailed=2]="refreshFailed",e[e.refreshSucceeded=3]="refreshSucceeded",e[e.attachingAsACopy=4]="attachingAsACopy",e[e.pendingAttachAsACopy=5]="pendingAttachAsACopy"}(r||(r={}))},2355:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(1709);const a=[".txt",".xml",".log"];function i(e){return o(Object(r.a)(e))}function o(e){return!!e&&a.indexOf(e.toLowerCase())>=0}},2368:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},2369:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.linkIds=0]="linkIds",e[e.quotedBodyLinkIds=1]="quotedBodyLinkIds"}(r||(r={}))},2379:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));const r="sxsIdMainWindow",a="owaSxSV2";var i;!function(e){e[e.Mail=0]="Mail",e[e.FilesHub=1]="FilesHub",e[e.DeepLink=2]="DeepLink",e[e.GroupFilesHub=3]="GroupFilesHub",e[e.PopOut=4]="PopOut"}(i||(i={}))},2406:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));class r{constructor(){this.eventDictionary={}}on(e,t,n){return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:t,callbackThis:n}),this}emit(e,...t){return(this.eventDictionary[e]||[]).slice().forEach(e=>e.callback.apply(e.callbackThis,t)),this}off(e,t){let n=this.eventDictionary[e];if(n){let r=n.filter(e=>e.callback!==t);r.length?this.eventDictionary[e]=r:delete this.eventDictionary[e]}return this}once(e,t,n){const r=this,a=(...i)=>(r.off(e,a),t.apply(n,i));return(this.eventDictionary[e]||(this.eventDictionary[e]=[])).push({callback:a,callbackThis:n}),this}}},2409:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients}function a(e){return void 0!==e.length}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},2410:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2338),a=n(703),i=n(227);async function o(e){return function(e){if(!Object(a.a)(null==e?void 0:e.nav)){const t={nav:e.nav};return Object(i.stringify)(t)}return null}((await r.b.import())(e))}},2413:function(e,t,n){"use strict";var r=n(47),a=n(6),i=n(2945),o=n(3020),c=n(1943),u=n(2998),s=n(2533),l=n(2426),d=n(2916),f=n(1862),m=n(2802),b=n(1786),h=n(36),p=n(702),O=n(1824);var g=n(1857),v=n(1738);t.a=Object(p.action)("addAndInitializeAttachments")((function(e,t,n=!1,I=!1){const S=Object(O.a)();n||(e=e.filter(e=>!S.attachments.has(e.attachment.AttachmentId.Id))),e.map(e=>{const{attachmentId:n,attachment:S,permissionInfo:w,modelInitializationValues:j}=e,y=function(e,t){const n={id:e,type:Object(g.a)(t),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:t};if(1===n.type&&Object(v.a)(t)){return Object.assign(Object.assign({},n),{type:1,openUrl:null,originalUrl:null,isFolder:t.AttachmentIsFolder,requiresFetchingSharingInformation:!1})}return n}(n,S);return I||function(e,t,n){const g=Object(f.a)(e),v=Object(b.b)(e.model,!0),I=Object(o.a)(v,e.model);e.attachmentClass=I,e.info=Object(i.a)(v,I,e.model,g,g?e.model.ProviderType:null,t),e.info.allowDownload&&(e.download.url=Object(l.a)(e.id,e.model,!0,!0)),g&&(e.openUrl=Object(d.a)(e.model)),(g&&Object(r.j)("doc-unwrap-safelinks")?Object(s.a)(e.model):Promise.resolve(void 0)).then(t=>{if(t&&(e.originalUrl=t),g&&!n){const t=e.model,n=Object(c.a)(t.ProviderType);(null==n?void 0:n.requiresFetchingSharingInformation)&&!Object(a.k)(t.AttachLongPathName)&&(e.requiresFetchingSharingInformation=!0)}if(Object(m.a)(e.model)){const t=e.id.Id;Object(u.a)(e.id,e.model,g).then(Object(p.action)("updateAttachmentThumbnailUrl")((function(e){Object(O.a)().attachments.has(t)&&(Object(O.a)().attachments.get(t).thumbnailImage.url=e)})),e=>{h.h.warn(e)})}})}(y,w,t),function(e,t){t=t||{},Object.keys(t).forEach(n=>{t[n]&&(e[n]=t[n])})}(y,j||{}),y}).forEach(e=>{var t;const n=e.model;if(n&&!n.AttachmentOriginalUrl){const r=S.attachments.get(e.id.Id);(null===(t=null==r?void 0:r.model)||void 0===t?void 0:t.AttachmentOriginalUrl)&&(n.AttachmentOriginalUrl=r.model.AttachmentOriginalUrl)}if(n&&Object(f.b)(n)){const t=n;if(!t.AttachLongPathName){const n=S.attachments.get(e.id.Id),r=null==n?void 0:n.model;(null==r?void 0:r.AttachLongPathName)&&(t.AttachLongPathName=r.AttachLongPathName)}}S.attachments.set(e.id.Id,e)})}))},2424:function(e){e.exports=JSON.parse('{"a":"uca"}')},2425:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.a}},2426:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1778),a=n(1862),i=n(2238);function o(e,t,n,o=!1){if(Object(a.b)(t))switch(t.ProviderType){case r.b:return function(e){const t=e.AttachLongPathName,n=t.lastIndexOf("?");return`${t.substring(0,n)}?dl=1`}(t)}return Object(i.a)(e,t,0,Object(a.b)(t),n,o)}},2435:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1778),a=n(1777);const i=[0,1,3,2,6,5,7,8,4];function o(e){let t=null;const n=function(n){const r=Object(a.b)(n);return null===r?null:function(){if(!t){t={};for(const n of i)t[n]=e(n)}return t}()[r]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?r.h:r.i)}}}},247:function(e,t,n){"use strict";var r=n(711),a="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||a||Function("return this")();t.a=i},2488:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function a(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},2490:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n(20),a=n(2339);n.d(t,"a",(function(){return a.a}));const i=new r.c(()=>Promise.all([n.e(0),n.e(24),n.e(96),n.e(711)]).then(n.bind(null,4091))),o=new r.b(i,e=>e.createGetSharingInfoResponse),c=new r.b(i,e=>e.checkSharingLinkUrlDomain),u=new r.b(i,e=>e.getLinkProviderType),s=new r.b(i,e=>e.isOneDriveProRelatedLink),l=new r.b(i,e=>e.convertToAttachmentDataProviderType),d=new r.b(i,e=>e.convertToLinkProviderType)},2493:function(e,t,n){"use strict";var r=n(6),a=n(1786),i=n(1854),o=n(282),c=n(1784);function u(e){switch(e){case i.a.Download:return c.a.Download;case i.a.OpenInNewTab:return c.a.OpenInNewTab;case i.a.Preview:return c.a.Preview;case i.a.ImportCalendarEventAttachment:case i.a.ChangePermissions:case i.a.CopyLink:case i.a.SaveToCloud:case i.a.ViewInProvider:case i.a.ConvertClassicToCloudy:case i.a.ConvertCloudyToClassic:case i.a.MoveAttachmentToInline:case i.a.RefreshLink:case i.a.IgnoreExpiration:return null;default:return Object(o.a)(e)}}function s(e){switch(e){case c.a.Download:return i.a.Download;case c.a.OpenInNewTab:return i.a.OpenInNewTab;case c.a.Preview:return i.a.Preview;case c.a.NoAction:return null;default:return Object(o.a)(e)}}var l=n(2254);var d=n(296),f=n(2144),m=n(1738),b=n(2190);function h(e,t,n,r,o,d,h,O,g,v,I,S){const w=Object(c.e)(t,n,r,v);S&&(O=O.filter(e=>e!==i.a.Download)),function(e,t){const n=Object(f.d)();0===n?e.supportedOpenActions=e.supportedOpenActions.filter(e=>e!==c.a.Download):1===n&&(e.supportedOpenActions=e.supportedOpenActions.filter(e=>e!==c.a.Download&&e!==c.a.Preview));const r=function(e,t,n=!1){let r=e.filter(e=>-1!==t.indexOf(e));return n&&(r=r.filter((e,t,n)=>n.indexOf(e)===t)),r}(e.supportedOpenActions.map(s).filter(e=>!!e),t);e.supportedOpenActions=r.map(u)}(w,O);const j=Object(m.a)(r),y=v&&Object(b.a)(r),C=Object(a.d)(r,j||y,g,I,S),A=j,T=p(j,y,d),P=function(e,t,n){return e.convertClassicToCloudyEnabled&&!t&&!n}(e,j||y,g),E=function(e,t,n,r,a){if(e.convertCloudyToClassicEnabled&&t&&!n&&r){const e=Object(l.a)(a);return(null==e?void 0:e.supportConvertCloudyToClassic)||!1}return!1}(e,j,g,h,o),x=function(e,t,n,r){return 2===e&&!t&&!n&&!r}(n,j,y,g);let R;switch(n){case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 12:case 13:R=function(e,t,n,r,a,i,o,c){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:t,isOpeningByLinkSupported:n,isOpeningInProviderSupported:r,isViewingInProviderSupported:a,isConvertClassicToCloudySupported:i,isConvertCloudyToClassicSupported:o,isMoveAttachmentToInlineSupported:c,showActionsMenu:!0,supportedMenuActions:[]})}(w,C,j||y,A,T,P,E,x);break;case 1:R=function(e){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!1,isOpeningInProviderSupported:!1,isViewingInProviderSupported:!1,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!1,supportedMenuActions:[]})}(w);break;default:R=j?function(e,t,n,r){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:!1,isOpeningByLinkSupported:!0,isOpeningInProviderSupported:t,isViewingInProviderSupported:n,isConvertClassicToCloudySupported:!1,isConvertCloudyToClassicSupported:r,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(w,A,T,E):function(e,t,n,r){return Object.assign(Object.assign({},e),{isSaveToCloudSupported:t,isViewingInProviderSupported:n,isOpeningInProviderSupported:!1,isOpeningByLinkSupported:!1,isConvertClassicToCloudySupported:r,isConvertCloudyToClassicSupported:!1,isMoveAttachmentToInlineSupported:!1,showActionsMenu:!0,supportedMenuActions:[]})}(w,C,T,P)}return R.supportedMenuActions=O,R}function p(e,t,n){if(e||t)return!1;{const e=Object(d.a)(),t=Object(l.b)(e);return!Object(r.k)(n)&&(e||(null==t?void 0:t.supportViewInProvider))}}n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return p}))},2500:function(e){e.exports=JSON.parse('{"a":"rda"}')},2506:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(1941),a=n(3065),i=n(3066),o=n(2255),c=n(1777),u=n(1928),s=n(2413),l=n(1713);function d(e,t,n,d,f,m,b,h=null,p,O=!1){Object(s.a)([{attachmentId:e,attachment:t}],n,f);const g=Object(l.a)(e),v=Object(o.a)(e,n,d,1===g.type,c.a.Unknown,!1,h);if(Object(r.a)(v,g,!1,p,m,b),O){const e=g.model.ProviderType;Object(u.b)(v.isCloudy,e,g.model.Name)?Object(i.a)(g,v):Object(a.a)(v)}return v}},2518:function(e){e.exports=JSON.parse('{"a":"pda","b":"qda"}')},252:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},2521:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.c}},2533:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2652);async function a(e){let t,n;return(n=await r.f.import())&&(t=await n(e.AttachLongPathName)),t}},2551:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(2117),a=n(225);function i(e){return Object(r.a)(e).shouldShow}function o(e,t){return i(t)&&Object(a.e)(e,Object(r.a)(t).extendedViewState.attachmentId)}function c(e,t){return i(t)&&(e&&e.composeId===Object(r.a)(t).composeId||!e&&Object(r.a)(t).composeId)}},2552:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Constant:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2553:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FieldURIOrConstantType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2554:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"RestrictionType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2560:function(e,t,n){"use strict";var r=n(1931),a=n(1864),i=n(3);t.a=Object(i.mutatorAction)("disableWacPreview",(function(e){e.previewMethod===a.a.Wac&&(e.previewMethod=a.a.Unsupported,e.supportedOpenActions=e.supportedOpenActions.filter(e=>e!==r.a.Preview))}))},2574:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4);const a=new r.d(()=>n.e(1152).then(n.bind(null,4096))),i=new r.a(a,e=>e.logSigsDatapoint)},2578:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2013);function a(e,t){var n;return t?e:null===(n=Object(r.b)(e))||void 0===n?void 0:n.ItemId.Id}},2579:function(e){e.exports=JSON.parse('{"a":"P6b"}')},2580:function(e){e.exports=JSON.parse('{"a":"R6b"}')},2582:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2873),a=n(2552),i=n(2553),o=n(3146),c=n(3083),u=n(1701),s=n(2554),l=n(7);const d="DateTimeReceived";function f(e,t,n,f){if(e||t){const m=[];m.push(Object(c.a)({FieldURIOrConstant:Object(i.a)({Item:Object(a.a)({Value:Object(l.ub)(t||l.b)})}),Item:Object(u.a)({FieldURI:n||d})})),m.push(Object(o.a)({FieldURIOrConstant:Object(i.a)({Item:Object(a.a)({Value:Object(l.ub)(e||l.d)})}),Item:Object(u.a)({FieldURI:f||d})}));const b=Object(r.a)({Items:m});return Object(s.a)({Item:b})}return null}},2583:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return O}));var r=n(326),a=n(327),i=n(10),o=n(156),c=n(142),u=n(36),s=n(2);const l="ows/beta/substratesearch/query",d=2048;function f(e,t,n,r,a,i){return b(e,t,n,r,p,a,i)}function m(e,t,n,r,a,i){return b(e,t,n,r,h,a,i)}function b(e,t,n,r,a,i,c){return Object(o.a)().then(o=>{const u=o.headers;i&&u.append("X-OWA-ActionSource",i);const s=a("ExecuteSearch",t,e,n,o,c);let l=0,d=0;return r&&(l=r.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then(()=>{d=r.addCheckmark("ClientJSRequestThread")})),s?s.then(e=>{const t=e[0],n=e[1],r=[t,n,e[2]];return n.ClientJSPreRequestTime=l,n.ClientJSRequestThreadTime=d,r}):Promise.reject(new Error("Client-side issue prevented request from being sent"))})}function h(e,t,n,a,o,u){const l=JSON.stringify(n),f=encodeURIComponent(l);let m=!1;const b=o.headers;b.append("Content-Type","application/json; charset=utf-8"),o.returnFullResponseOnSuccess=!0,f.length>d?o.body=l:(m=!0,b.append("X-OWA-UrlPostData",f),o.body=null);const h=function(e,t){const n=Object(i.a)();let a=(n.baseUrl?`${n.baseUrl}/service.svc?action=`:"/owa/service.svc?action=")+e+`&app=${Object(s.m)()}`;t&&(a+="&EP=1");return a+="&id="+Object(r.a)(),a}(e,m),p=new Date;return Object(c.a)("ExecuteSearch",h,1,o).then(async e=>{const r=await e.json();return[r,O(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"ExecuteSearch",p,new Date,a,o.headers,t,u),e.url]})}function p(e,t,n,i,o,c){if(!i)return u.d("SearchQueryId must be specified when calling makeExecuteSearchRequest!"),null;const s={};o.headers.forEach((e,t)=>{s[t]=e}),s["X-Search-Griffin-Version"]="GWSv2";const d=new Date;return n.Body.SearchSessionId=i,n.Body.Scenario=c,Object(a.e)(l,n,Object(r.a)(),!0,s).then(async e=>{const r=await e.json();return[r,O(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"SubstrateSearch",d,new Date,i,o.headers,t,c),e.url]}).catch(e=>(u.h.warn(e),null))}const O=(e,t,n,r,a,i,o,c,u,l)=>{const d=e.headers||new Headers;return{ClientSearchProvider:r,PageNumber:u,ClientNetworkTime:i.getTime()-a.getTime(),ClientJSEndToEndTime:0,ClientJSPreRequestTime:0,ClientJSRequestThreadTime:0,ClientResponseProcessTime:0,ClientJSRenderingTime:0,SearchDateTime:d.get("date"),SearchBETarget:d.get("x-calculatedbetarget"),SearchFETarget:d.get("x-calculatedfetarget"),SearchBEHttpStatus:d.get("x-backendhttpstatus"),SearchMsEdgeRef:d.get("x-msedge-ref"),SearchErrorContent:n,SearchTraceID:d.get("request-id"),SearchQueryId:o,ClientBuildNumber:Object(s.u)(),ClientTimeSentUTC:a,ClientTimeFinishedUTC:i,ClientHttpStatus:e.status||-1,SearchClientRequestID:c.get("client-request-id"),SearchClientSessionID:Object(s.t)(),ClientName:l,DiagnosticsCheckpoints:d.get("x-ms-diagnostics-checkpoints"),ResourceTimingEntry:null,PIIData:{queryText:t}}}},2594:function(e){e.exports=JSON.parse('{"a":"Q6b"}')},2600:function(e){e.exports=JSON.parse('{"a":"L8a"}')},2601:function(e){e.exports=JSON.parse('{"a":"R8a"}')},2602:function(e){e.exports=JSON.parse('{"a":"N8a"}')},2603:function(e){e.exports=JSON.parse('{"a":"M8a"}')},2604:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1696);function a(e){var t;return(null===(t=function(e){let t="";return(null==e?void 0:e.model)&&(t=Object(r.c)(e.model.Name||"")||e.model.ContentType||""),t}(e))||void 0===t?void 0:t.substring(0,4))||""}},2614:function(e,t,n){"use strict";var r=n(2271);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var a=n(2050);n.d(t,"c",(function(){return a.a}));var i=n(2049);n.d(t,"e",(function(){return i.a}));var o=n(2048);n.d(t,"d",(function(){return o.a}))},2633:function(e){e.exports=JSON.parse('{"a":"O6b"}')},2634:function(e){e.exports=JSON.parse('{"a":"N6b"}')},2635:function(e){e.exports=JSON.parse('{"a":"M6b"}')},2636:function(e){e.exports=JSON.parse('{"a":"L6b"}')},2644:function(e){e.exports=JSON.parse('{"b":"O8a","c":"P8a","a":"Q8a"}')},2645:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2265),a=n(2326),i=n(2125),o=n(326),c=n(327),u=n(59),s=n(6),l=n(36),d=n(610);function f(e,t,n,f,b,h){const p=function(e,t,n,r,i){const c=Object(u.b)().bestEffort;c["client-session-id"]=t,c["client-request-id"]=Object(o.a)(),c["x-client-localtime"]=Object(a.a)(),c["X-Search-Griffin-Version"]="GWSv2",c["Accept-Language"]=Object(s.e)(),r&&r.length>0&&(c["x-anchormailbox"]=r[0].mailboxSmtpAddress,c.authorization=r[0].tokenString);n&&(c["X-Client-Flights"]=n);c.scenariotag=function(e){const t=e.EntityRequests.length>1,n=e.EntityRequests[0],r=[];t&&r.push("ErrMER");0==n.From&&r.push("1stPg");const a=m[n.EntityType];return r.push(a||"Unknown"),r.join("_")}(e),i&&Object.keys(i).forEach(e=>{c[e]=i[e]});return c}(e,t,n,f,b);return Object(c.e)(Object(d.v)(Object(i.a)("query",h),Object(r.a)()),e,null,!0,p,void 0,void 0,!1).then(e=>[e,p]).catch(e=>(l.h.warn(e),[e]))}const m={Event:"ev",Conversation:"cv",Email:"em",Message:"mg",MailItems:"mi",CalendarItems:"ci",MailConversations:"mc",MessageItems:"gi"}},2652:function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u}));var r=n(20),a=n(1858);n.d(t,"b",(function(){return a.b})),n.d(t,"d",(function(){return a.d})),n.d(t,"a",(function(){return a.a})),n.d(t,"c",(function(){return a.c})),n.d(t,"e",(function(){return a.e}));const i=new r.c(()=>n.e(1159).then(n.bind(null,4221))),o=new r.b(i,e=>e.evaluateSafeLink),c=(new r.b(i,e=>e.evaluateSafeLinks),new r.b(i,e=>e.isSafeLink)),u=new r.b(i,e=>e.isSafeLinkUrl)},2691:function(e,t,n){"use strict";var r=n(1824),a=n(702);t.a=Object(a.action)("deleteAttachment")((function(e){Object(r.a)().attachments.delete(e.Id)}))},2692:function(e,t,n){"use strict";var r=n(1713),a=n(2426),i=n(702);t.a=Object(i.action)("refreshDownloadUrl")((function(e,t,n=!1){const i=Object(r.a)(e),o=Object(a.a)(e,i.model,t,n);i.download.url=o}))},2712:function(e,t,n){"use strict";function r(e){let t=null;return t=e.AttachLongPathName,t||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},2713:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.View=0]="View",e[e.EnteringEdit=1]="EnteringEdit",e[e.Edit=2]="Edit",e[e.Saving=3]="Saving"}(r||(r={}))},2715:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1774),a=n(296),i=n(282),o=n(47);function c(e){const t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-dropbox");case 6:return!1;case 1:return!!Object(a.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(o.j)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(o.j)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2775:function(e,t,n){"use strict";function r(e,t){t&&e&&(e.addCustomData({httpStatusCode:t.status}),function(e,t){t&&e&&e.addCustomData({frontendServer:t.get("x-feserver"),requestId:t.get("request-id"),backendServer:t.get("x-beserver"),backendHttpStatus:t.get("x-backendhttpstatus"),serverVersion:t.get("x-owa-version")})}(e,t.headers))}function a(e){return e&&void 0!==e.fetchErrorType}function i(e,t){e.addCustomProperty("ErrorInformation",t)}function o(e,t){let n="";n=t?"Empty response from server":"Null response from server",i(e,n)}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o}))},2776:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1732);function a(e){return(e.__type||e.OwsTypeName)===r.b}},2793:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return u})),n.d(t,"p",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"n",(function(){return h})),n.d(t,"r",(function(){return p})),n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"f",(function(){return I})),n.d(t,"i",(function(){return S})),n.d(t,"a",(function(){return w}));var r=n(20);const a=new r.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(308)]).then(n.bind(null,4953))),i=new r.a(a,e=>e.onSmimeItemAttachmentOpened),o=new r.a(a,e=>e.mergeSmimeDecodedMessageProperties),c=(new r.b(a,e=>e.fetchAndDecodeSmimeMessage),new r.b(a,e=>e.setSmimePropertiesInDraftMessage)),u=new r.b(a,e=>e.trySetSmimeProperties),s=new r.b(a,e=>e.tryAddSmimeProperties),l=new r.b(a,e=>e.createMailResponseBodyContent),d=new r.b(a,e=>e.downloadSmimeAttachment),f=new r.b(a,e=>e.getMergedSmimeViewState),m=new r.b(a,e=>e.getMergedSmimeViewStateForDraft),b=new r.b(a,e=>e.isSmimeItemDecoding),h=new r.b(a,e=>e.previewSmimeAttachment),p=new r.b(a,e=>e.updateSmimeAttachmentIds),O=new r.b(a,e=>e.createSmimeAttachmentsFromFiles),g=new r.b(a,e=>e.createSmimeAttachmentsViaSmimeQueueManager),v=new r.b(a,e=>e.initializeAttachmentStateForSmimeAttachments),I=new r.b(a,e=>e.getAttachmentsForSmimeResponse),S=new r.b(a,e=>e.getSmimeAttachmentsForRequest),w=Object(r.d)(a,e=>e.SignatureDetails)},2795:function(e){e.exports=JSON.parse('{"a":"Lca","b":"Mca"}')},2802:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(1943),a=n(1957),i=n(1786),o=n(1696),c=n(1738),u=n(2425),s=n(2521);function l(e){if(!Object(i.b)(e,!0).directFileAccessEnabled&&!e.IsInline||Object(a.b)(e.AttachmentId.Id))return!1;if(e.Thumbnail)return!0;const t=Object(o.g)(e.Name,e.ContentType,!1),n=Object(o.h)(e.Name);if((Object(u.a)(e)||Object(s.a)(e))&&(t||n))return!0;if(Object(c.a)(e)){const n=Object(r.a)(e.ProviderType);if(e.AttachmentThumbnailUrl||t&&n&&n.supportImageThumbnail)return!0}return!1}},2803:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(467),a=n(954),i=n(905),o=n(707),c=n(955),u=n(261),s=n(36);const l="0xe0b",d=Object(r.a)({PropertyTag:l,PropertyType:"Binary"});async function f(e){var t;let n=null;const r=Object(o.a)({BaseShape:"IdOnly",AdditionalProperties:[d]}),f=await function(e,t){const n=Object(u.b)(),r=e.map(e=>Object(i.a)({Id:e}));return Object(c.a)({Header:n,Body:Object(a.a)({ItemShape:t,ItemIds:r})}).then(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}).catch(e=>(s.h.warn("GetItem:"+e.message),null))}([e],r);if("Success"===(null===(t=null==f?void 0:f[0])||void 0===t?void 0:t.ResponseClass)){n=function(e,t){var n;if(e){const r=e.ExtendedProperty;if(r){const e=r.length;for(let a=0;a<e;a++){const e=r[a];if((null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t)return e}}}return null}(f[0].Items[0],l)}return n?n.Value:(s.h.info("[getImmutableEntryId] extendedProperty could not be retrieved"),null)}},2834:function(e,t,n){"use strict";var r=n(610),a=n(2);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?`${e}&${t}=${n}`:`${e}?${t}=${n}`}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return s}));const o=Object(a.S)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){const t=e?encodeURIComponent(`?provider=${e}`):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return`${Object(r.n)()}/mail/${n}${t}`}function u(e){const t=`${Object(r.n)()}/mail/AddFileProvider.html`,n=encodeURIComponent(`provider=${e}&url=${t}`);return`${o}/ADPRedirect.aspx?${n}`}function s(e,t,n,r,a,o){return()=>{const e=function(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[];for(let r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}();let c=i(t,"client_id",r);if(c=i(c,"redirect_uri",n),c=i(c,"response_type",a),o){const t=o(e);c=Object.keys(t).reduce((e,n)=>i(e,n,t[n]),c)}return{authUrl:c,redirectUrl:n,csrfToken:e}}}},2852:function(e){e.exports=JSON.parse('{"b":"Yca","a":"Zca"}')},2853:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),a=n(2136);function i(){return{providers:new r.ObservableMap,loadState:a.a.NotLoaded,removalPending:new r.ObservableMap}}},2873:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"And:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2874:function(e){e.exports=JSON.parse('{"b":"Rca","a":"Sca","e":"Tca","d":"Uca","f":"Vca","c":"Wca"}')},2887:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setOngoingAction")((function(e,t){e.ongoingAction=t}))},2888:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(71),a=n(1990),i=n(2268),o=n(36);async function c(e,t,n,c,u){const s=new r.b("getWacInfoForOneDriveJsApi",{isCore:!0});c&&s.addCustomData({redeemSharingLinkIfNecessary:c});try{const r="u!"+btoa(t).replace(/^\=+|\=+$/g,"").replace("/","_").replace("+","-"),o=`${new RegExp(/.+?\:\/\/.+?(\/)/g).exec(t)[0]}_api/v2.0/shares/${r}/root?select=openWith/wac,officeBundle,@content.downloadUrl,webDavUrl,name,size,currentUserRole,sensitivityLabel&action=${n?"Open":"View"}`,l=new Object;c&&(l.prefer="redeemSharingLinkIfNecessary");const d=Object(a.a)({ProviderType:e,Url:o,Headers:JSON.stringify(l)}),f=(new Date).getTime(),m=await Object(i.a)(d);if(200===m.Status&&m.Body){const e=(new Date).getTime(),t=JSON.parse(m.Body);return t.fetchStartTime=f,t.responseStartTime=e,!t.openWith.wac&&u||(t.openWith.wac.fileGetUrl=t["@content.downloadUrl"],t.openWith.wac.accessTokenExpiry&&(t.openWith.wac.accessTokenExpiry=new Date(Number(t.openWith.wac.accessTokenExpiry))),!n&&t.currentUserRole&&(t.currentUserRole.readOnly=!0)),s.end(),t}{s.addCustomData({StatusCode:m.Status});const e=m.Headers;if(e){const t=JSON.parse(e);t&&s.addCustomData({SharePointError:t.SharePointError,SPClientServiceRequestDuration:t.SPClientServiceRequestDuration,SPRequestGuid:t.SPRequestGuid})}throw new Error(`Result status is: ${m.Status} or empty response body.`)}}catch(e){s.endWithError("ServerError",e),o.h.warn(`Something went wrong while calling fetchDataProviderResourceOperation: ${e}`)}return null}},2889:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2199),a=n(2974);async function i(e){var t;const n=Object(a.a)(e.AttachLongPathName);return(null===(t=(await Object(r.j)(n)).result)||void 0===t?void 0:t.thumbnailLink)||null}},2890:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FileAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2896:function(e,t,n){"use strict";var r=n(1798),a=n(71);const i={},o=5e3,c=12;function u(e,t,n,u,l){const d=new a.b("SaveToCloudProgressManager"),f=setInterval(()=>{!async function(e,t,n,a,i,o,c){const u=c[e];if(!u)return;if(u.counter++,u.counter>o)return s(e,c),u.datapoint.addCustomData({operationId:e,counter:u.counter}),u.datapoint.endWithError("Timeout"),void(i&&i());(await r.e.import())(t,n,e,0,e=>{a&&a(e.NotificationPayloads)})}(n,e,t,u,l,c,i)},o);i[n]={timer:f,counter:0,datapoint:d}}function s(e,t=null){t||(t=i);const n=t[e];if(!n)return;clearInterval(n.timer);const r=n.datapoint;r.addCustomData({operationId:e,counter:n.counter}),r.end(),delete t[e]}var l=n(3);var d=Object(l.action)("cancelSaveAttachmentsToCloud",e=>({operationId:e}));Object(l.orchestrator)(d,e=>{s(e.operationId)});var f=Object(l.action)("saveAttachmentsToCloud",(function(e,t,n,r,a,i,o,c,u,s){return{attachmentId:e,itemId:t,sxsId:n,notificationHandler:r,serviceCallFailureCallback:a,operationCreatedCallback:i,folderId:o,attachmentIds:c,showProgressBar:u,subscriptionId:s}}));function m(e){return Object.assign({__type:"SaveAttachmentsToCloudRequest:#Exchange"},e)}var b=n(35);var h=n(704);function p(e,t,n,r,a,i,o){const c=function(e,t,n,r,a,i,o){return m({ewsAttachmentId:e,itemId:t,subscriptionId:n,groupSmtpAddress:a,channelId:r,folderItemId:i,attachmentIds:o})}(e,t,n,r,"GroupMailbox"===(null==a?void 0:a.type)?a.mailboxSmtpAddress:null,i,o);return u={requestObject:c},s=Object(h.a)(a),void 0===u.requestObject||u.requestObject.__type||(u.requestObject=m(u.requestObject)),Object(b.a)("SaveAttachmentsToCloud",u,s);var u,s}var O=n(2051),g=n(1761);Object(l.orchestrator)(f,async e=>{let t=!1!==e.showProgressBar,n=e.attachmentId||e.itemId;!n&&e.attachmentIds.length>0&&(n=e.attachmentIds[0]);const r=r=>{if(!r||"Reload"===r.EventType)return!1;if(23===r.ResultCode)return!1;const a=e.notificationHandler(r);return t&&a&&(s(n.Id),t=!1),a},a=e.subscriptionId,[i,o,c,l]=await Object(O.a)(r,a);!async function(e,t,n,r,a,i,o,c,u,s){try{await p(e?e.Id:null,t?t.Id:null,n,i,function(e,t,n){return e?e.mailboxInfo:t?t.mailboxInfo:n[0].mailboxInfo}(t,e,s),u,s?s.map(e=>e.Id):null)}catch(e){return c(e,1,"ServerError",o),g.k.importAndExecute(r,a),null}}(e.attachmentId,e.itemId,i,o,c,l,e.sxsId,e.serviceCallFailureCallback,e.folderId,e.attachmentIds),t&&u(e.attachmentId,e.itemId,n.Id,e=>{e.forEach(e=>{r(e)})},()=>{e.serviceCallFailureCallback("Progress manager timeout. OperationId = "+n,3,"Timeout",e.sxsId)}),e.operationCreatedCallback&&e.operationCreatedCallback(n.Id,o,c)});async function v(e,t,n,r,a){const i=n=>{if(!n||"Reload"===n.EventType)return!1;if(23===n.ResultCode)return!1;const r=t(n);return r&&s(e.Id),r};await Object(O.a)(i,r),u(e,null,e.Id,e=>{e.forEach(e=>{i(e)})},()=>{n("Progress manager timeout. OperationId = "+e.Id,3,"Timeout",a)})}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return v}))},2914:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setShouldShowImageOverlay")((function(e,t){e.shouldShowImageOverlay=t}))},2915:function(e,t,n){"use strict";function r(e){return 0!==e.actionMessage}n.d(t,"a",(function(){return r}))},2916:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6),a=n(1778),i=n(2264),o=n(38);function c(e){return Object(r.k)(e)?null:("/"!=(e=e.trim())[e.length-1]&&(e+="/"),e)}function u(e){let t=e.AttachLongPathName;if(Object(i.e)(e.PermissionType)||e.ProviderType!==a.i)return t;const n=Object(o.a)(),r=n.ApplicationSettings;if(null!==t&&null!==r){let e;e=c(r.VDirIsPublicProperty||n.PublicComputersDetectionEnabled&&n.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL),null!==e&&(t=function(e,t){const n=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),r=n.exec(e),a=n.exec(t);let i,o,c;return r&&a&&r.length>=5&&a.length>=5&&(a[1]&&a[2]&&(c=a[1]+"://"+a[2],i=!0),a[3]&&(c+=a[3]),r[4]&&(o=!0,c+=r[4])),i&&o?c:null}(t,e))}return null!==t?t:e.AttachLongPathName}},2933:function(e){e.exports=JSON.parse('{"b":"bda","a":"cda","d":"dda","e":"eda","g":"fda","f":"gda","c":"hda","i":"ida","h":"jda","j":"kda","k":"lda"}')},2945:function(e,t,n){"use strict";var r=n(2264),a=n(1696),i=n(7),o=n(47);var c=n(2956),u=n(1943);function s(e,t,n,s,l,d=null){if(1===t)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};const f=Object(a.b)(n.Name),m=Object(c.a)(e,n,f),b=function(e,t,n){if(!e)return null;if(n&&n.length>0)return n;const r=Object(u.a)(t);return null==r?void 0:r.supportedPermissionLevels}(s,l,Object(r.a)(d,0)),h=(p=d)&&0===p.ResultCode?(Object(o.j)("doc-attachment-referenceAttachmentExpiration")||(p.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:p.BlocksDownload,canonicalUrl:p.CanonicalUrl,canShareInternally:p.CanShareInternally,canShareExternally:p.CanShareExternally,expirationDate:p.ExpirationDate?Object(i.qc)(p.ExpirationDate):null,canRefresh:!1,shareId:p.ShareId,siteUrl:p.SiteUrl,linkType:p.Type,itemUniqueId:p.ItemUniqueId,mimeType:p.MimeType}):null;var p;return s?function(e,t,n){return{allowDownload:e,supportedPermissionLevels:t,sharingInfo:n}}(m,b,h):function(e){return{allowDownload:e,supportedPermissionLevels:null,sharingInfo:null}}(m)}n.d(t,"a",(function(){return s}))},2955:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(99);function a(e,t){return r.d()||r.e()||r.h()?function(e){const t=["Chrome PDF Viewer","Microsoft Edge PDF Viewer","WebKit built-in PDF"];e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins);try{return"function"==typeof(null==e?void 0:e.namedItem)&&t.some(t=>null!==e.namedItem(t))}catch(e){}return!1}(t):(r.f(),!1)}},2956:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(1738),a=n(1943),i=n(1786),o=n(47);function c(e,t,n){let c=e.level!==i.a.Block&&e.directFileAccessEnabled;return c&&Object(r.a)(t)&&(c=function(e,t){if(e.AttachLongPathName){const t=document.createElement("a");if(t.href=e.AttachLongPathName,!Object(o.j)("doc-unwrap-safelinks")&&t.host.indexOf(u,0)>0||t.search.indexOf(s,0)>0)return!1}if(function(e){const t=Object(a.a)(e);return null==t?void 0:t.supportDownload}(e.ProviderType)&&!e.AttachmentIsFolder)return".fluid"!==t&&!function(e,t){return!(e||t&&"application/onenote"!==t&&"image/png"!==t)}(t,e.ContentType);return!1}(t,n)),c}const u="safelinks.protection.outlook.com",s="b7780972f918485c8cfc32b1ba7438eb"},2974:function(e,t,n){"use strict";function r(e){const t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},2975:function(e,t,n){"use strict";var r=n(1713),a=n(702);t.a=Object(a.action)("setAttachmentOriginalUrl")((function(e,t){Object(r.a)(e).model.AttachmentOriginalUrl=t}))},2997:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(71),a=n(2775),i=n(3017),o=n(704);const c={},u={},s=[];let l=0;const d=2;async function f(e,t,n,a){const i=new r.b("InitializeWacUrl");n&&i.addCustomProperty("actionSource",n);const o=b(e,t,i);return o||new Promise((r,o)=>{const c={attachmentId:e,isEdit:t,actionSource:n,datapoint:i,resolve:r,reject:o};a?m(c):(s.push(c),async function e(){if(!s.length)return;if(l>=d)return;const t=s.shift();l++;try{await m(t)}finally{l--,e()}}())})}async function m(e){var t;const{attachmentId:n,isEdit:r,actionSource:s,datapoint:l,resolve:d,reject:f}=e,m=b(n,r,l);if(m)return void d(m);let h;l.addCustomProperty("ReturnFromCache",!1);try{if(h=await Object(i.a)(n.Id,r,null,Object(o.a)(n.mailboxInfo),s),0===h.Status){(r?u:c)[n.Id]={expireTime:(new Date).getTime()+36e5,value:h}}h.WacUrl||l.addCustomProperty("WacUrlIsEmpty",!0),l.addCustomProperty("WacAttachmentResponseStatus",null===(t=h.Status)||void 0===t?void 0:t.toString()),l.end(),d(h)}catch(e){Object(a.a)(e)&&Object(a.c)(l,e.response),Object(a.d)(l,e.toString()),l.endWithError("ServerError"),f(e)}}function b(e,t,n){const r=t?u:c,a=r[e.Id];if(a){if(a.expireTime>=(new Date).getTime())return n.addCustomProperty("ReturnFromCache",!0),n.end(),a.value;delete r[e.Id]}return null}},2998:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1778),a=n(2889),i=n(2238);async function o(e,t,n){if(!n)return Object(i.a)(e,t,2,n,!0);const o=t;return o.ProviderType===r.e&&o.AttachLongPathName?Object(a.a)(o):o.AttachmentThumbnailUrl||null}},3016:function(e,t,n){"use strict";var r=n(3),a=n(80);const i=Object(r.action)("addCalendarEventsAttachment",(e,t)=>Object(a.b)({name:"AttachmentAddCalendarEvent",customData:{addToCalendarSource:t}},{attachment:e}));t.a=i},3017:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2329);function a(e,t,n,a,i){if(i){const e="getWacAttachmentInfo"+i;(a=a||{}).headers=a.headers||new Headers,a.headers.set("X-OWA-ActionName",e)}return Object(r.a)({attachmentId:e,isEdit:t,draftId:n,appId:null},a)}},3018:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));let r=null;const a={register:e=>{r=e},run:(e,t,n)=>{r&&r(e,t,n)}}},3020:function(e,t,n){"use strict";var r=n(1943),a=n(1696);function i(e){const t=Object(a.b)(e.Name);return t&&".pdf"===t.toLowerCase()}const o=[".mp3"];const c=[".ics",".ical",".ifb",".icalendar"];const u=[".eml",".msg"];var s=n(2488),l=n(1738);const d=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(a.g)(e.Name)||!Object(l.a)(e)&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var m=n(2955),b=n(1786);function h(e,t){if(i(e)&&Object(m.a)()){if(t)return!0;{const t=Object(b.c)(e,!0);return Object(b.b)(e,!0).directFileAccessEnabled&&t.directFileAccessEnabled}}return!1}var p=n(2355);const O=[".mp4"],g=[".mov"];var v=n(296),I=n(2425),S=n(2521),w=n(2776),j=n(2190);function y(e,t){let n;if(Object(l.a)(t)||Object(j.a)(t)){n=function(e){const t=Object(r.a)(e.ProviderType);return t&&t.supportPreview(e,Object(v.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(s.a)(t)?6:h(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0}else n=Object(I.a)(t)?e.level===b.a.Block?1:e.level===b.a.AccessDisabled?0:f(t)?2:i(t)?function(e,t){if(!Object(b.e)().isPdfPreviewEnabled())return 1;if(h(t,!1))return 3;if(function(e){return i(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){const t=Object(a.b)(e.Name);return!!t&&o.indexOf(t.toLowerCase())>=0}(t)?5:function(e){const t=Object(a.b)(e.Name);return!!t&&u.indexOf(t.toLowerCase())>=0}(t)?10:Object(p.b)(t.Name)?11:function(e,t){var n;const r=Object(a.b)(e.Name);if(r){const e=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),a=-1!==e.indexOf("Safari")&&-1===e.indexOf("Chrome");return O.indexOf(r.toLowerCase())>=0||a&&g.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){const t=Object(a.b)(e.Name);return!!t&&-1!==c.indexOf(t.toLowerCase())}(t)?13:0:Object(w.a)(t)?8:Object(S.a)(t)?9:0;return n}n.d(t,"a",(function(){return y}))},3026:function(e,t,n){"use strict";var r=n(705);const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ImportEventsFromIcsFile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fileContent"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"calendarId"}},type:{kind:"NamedType",name:{kind:"Name",value:"CalendarIdInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"importEventsFromIcsFile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"fileContent"},value:{kind:"Variable",name:{kind:"Name",value:"fileContent"}}},{kind:"ObjectField",name:{kind:"Name",value:"attachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}},{kind:"ObjectField",name:{kind:"Name",value:"calendarId"},value:{kind:"Variable",name:{kind:"Name",value:"calendarId"}}},{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"numberOfEventsImported"}}]}}]}}]};async function i(e,t,n,i,o){var c;const u=Object(r.a)(),s={fileContent:e,folderId:t,calendarId:n?{id:n.id,changeKey:n.changeKey,mailboxInfo:n.mailboxInfo}:null,mailboxInfo:o,attachmentId:i},l=await u.mutate({variables:s,mutation:a});return null===(c=null==l?void 0:l.data)||void 0===c?void 0:c.importEventsFromIcsFile}n.d(t,"a",(function(){return i}))},306:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},3065:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2560),a=n(1864),i=n(2997);async function o(e){if(e.strategy.previewMethod===a.a.Wac){const t=await Object(i.a)(e.attachmentId,!1);9!==t.Status&&6!==t.Status||Object(r.a)(e.strategy)}}},3066:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2560),a=n(2533),i=n(2888),o=n(47);async function c(e,t){const n=e,c=Object(o.j)("doc-unwrap-safelinks")?await Object(a.a)(e.model):n.openUrl;await Object(i.a)(0,c,!1,!1,!0)||Object(r.a)(t.strategy)}},3083:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsLessThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3118:function(e,t,n){"use strict";n.r(t),n.d(t,"EnteredEditModeEvent",(function(){return r})),n.d(t,"ExitedEditModeEvent",(function(){return a})),n.d(t,"PreviewLoadEvent",(function(){return i})),n.d(t,"PreviewErrorEvent",(function(){return o})),n.d(t,"PreviewLoadOrErrorEvent",(function(){return c})),n.d(t,"CloseEvent",(function(){return u})),n.d(t,"AnimationEndEvent",(function(){return s}));const r="EnteredEditMode",a="ExitedEditMode",i="PreviewLoad",o="PreviewError",c="PreviewLoadOrError",u="Close",s="AnimationEnd"},3145:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Initial=0]="Initial",e[e.Adaptive=1]="Adaptive",e[e.Show=2]="Show",e[e.Hide=3]="Hide",e[e.AlwaysHide=4]="AlwaysHide"}(r||(r={}))},3146:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsGreaterThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3204:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Blank=0]="Blank",e[e.Loading=1]="Loading",e[e.Error=2]="Error",e[e.Custom=3]="Custom",e[e.Image=4]="Image",e[e.Wac=5]="Wac",e[e.Audio=6]="Audio",e[e.Video=7]="Video",e[e.Text=8]="Text",e[e.NativePdf=9]="NativePdf",e[e.PdfJs=10]="PdfJs",e[e.IFrame=11]="IFrame"}(r||(r={}))},3205:function(e,t,n){"use strict";n.d(t,"n",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return f})),n.d(t,"k",(function(){return m})),n.d(t,"f",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return p})),n.d(t,"g",(function(){return O})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"e",(function(){return S})),n.d(t,"l",(function(){return w})),n.d(t,"b",(function(){return j}));var r=n(3591),a=n(99),i=n(2035),o=n(2322),c=n(3245),u=n(132);function s(){return Object(a.d)()||Object(a.e)()}function l(e){return function(e){if(e.length<2)return!1;const t=e[0]-parseInt(i.b),n=e[1]-parseInt(i.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map(e=>parseInt(e)):[])}function d(e){const t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=i.b}function f(){return Object(r.a)()&&Object(u.a)("smimeExtension")}function m(e){return 0!==e}function b(e){const t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);const n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function h(e){let t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function p(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function O(e,t){const n=Object(c.a)().ClearSign;return t||e&&!n?o.a:i.e}function g(e){return btoa(unescape(encodeURIComponent(e)))}function v(e,t){const n=Object(c.a)();return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function I(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function S(e){return i.k+(e||I()+I()+I()+I())}function w(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function j(){return i.d+I()+"@"+I()+"."+I()}},3245:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(66);function a(){var e;return null===(e=r.a.userConfiguration)||void 0===e?void 0:e.SmimeAdminSettings}},328:function(e,t,n){"use strict";var r,a=n(565),i=n(247).a["__core-js_shared__"],o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var c=function(e){return!!o&&o in e},u=n(252),s=n(434),l=/^\[object .+?Constructor\]$/,d=Function.prototype,f=Object.prototype,m=d.toString,b=f.hasOwnProperty,h=RegExp("^"+m.call(b).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var p=function(e){return!(!Object(u.a)(e)||c(e))&&(Object(a.a)(e)?h:l).test(Object(s.a)(e))};var O=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=O(e,t);return p(n)?n:void 0}},3303:function(e,t,n){"use strict";var r=n(3342),a=n(2691),i=n(1713),o=n(702);t.a=Object(o.action)("removeAttachmentFromWell")((function(e,t,n=!0,o=!0){const c=Object(i.a)(t.attachmentId);if(!c)return;let u,s=!1;1===t.attachmentType?(u=e.inlineAttachments,s=!0):u=e.imageViewAttachments.some(e=>e.attachmentId===t.attachmentId)?e.imageViewAttachments:e.docViewAttachments;let l=!1;for(let e=0;e<u.length;e++)if(u[e].attachmentId===t.attachmentId){u.splice(e,1),l=!0;break}n&&l&&(s||!t.isCloudy)&&Object(r.a)(e,-1*c.model.Size),o&&Object(a.a)(t.attachmentId)}))},3323:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2117);function a(e){const t=Object(r.b)().sxsStoreMapping;for(const n of t.keys()){if(t.get(n).composeId===e)return n}return null}},3324:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ConversationReadingPane=0]="ConversationReadingPane",e[e.ItemReadingPane=1]="ItemReadingPane"}(r||(r={}))},3325:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Edit=1]="Edit",e[e.Selected=2]="Selected",e[e.SelectedAndPending=3]="SelectedAndPending",e[e.SelectedAndSaving=4]="SelectedAndSaving",e[e.NotSelectedAndSaving=5]="NotSelectedAndSaving",e[e.OtherSaving=6]="OtherSaving",e[e.PendingNavigation=7]="PendingNavigation"}(r||(r={})),t.a=r},3342:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.mutatorAction)("changeTotalClassicAttachmentSize",(function(e,t){e.totalClassicAttachmentSize+=t}))},3448:function(e,t,n){"use strict";var r=n(1689),a=n(3);t.a=Object(a.mutatorAction)("setNextSearchQueryId",(e,t)=>{Object(r.d)(t).nextSearchQueryId=e})},347:function(e,t,n){"use strict";var r=n(366),a=Object.prototype,i=a.hasOwnProperty,o=a.toString,c=r.a?r.a.toStringTag:void 0;var u=function(e){var t=i.call(e,c),n=e[c];try{e[c]=void 0;var r=!0}catch(e){}var a=o.call(e);return r&&(t?e[c]=n:delete e[c]),a},s=Object.prototype.toString;var l=function(e){return s.call(e)},d="[object Null]",f="[object Undefined]",m=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:d:m&&m in Object(e)?u(e):l(e)}},3556:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1979);function a(e){const t=Object(r.a)(e);return t?t.tabId:null}},3561:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("__DIAGNOSTICS_ADD_E2E_TIME_TO_DIAGNOSTICS_STORE",(e,t)=>({jsEndToEndTime:e,jsRenderingTime:t}))},3591:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(99),a=n(2035);function i(){return Object(r.d)()&&Object(r.m)([a.f])||Object(r.e)()&&Object(r.m)([a.g])}},366:function(e,t,n){"use strict";var r=n(247).a.Symbol;t.a=r},3742:function(e,t,n){"use strict";function r(e,t){(t||window).open(e,"_blank")}n.d(t,"a",(function(){return r}))},3766:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));const r="X-OWA-SmimeInstalled",a="1",i="SmimeWithoutActiveX",o="message/rfc822",c="ErrorSmimeSendCancelled"},3905:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2406),a=n(3204),i=n(3145);function o(){return{previewPane:{downloadUrl:null,mode:a.a.Blank},didAutoHideRightPane:!1,hideRightPane:!1,rightPaneSize:0,leftPaneSizePixels:0,rightPaneSizePixels:0,rightPaneDisplay:i.a.Initial,eventManager:new r.a}}},402:function(e,t,n){"use strict";var r=n(565),a=n(570);t.a=function(e){return null!=e&&Object(a.a)(e.length)&&!Object(r.a)(e)}},4053:function(e,t,n){"use strict";function r(e,t){return-1!==t.strategy.supportedMenuActions.indexOf(e)}n.d(t,"a",(function(){return r}))},4054:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3742),a=n(71);const i=e=>{e.stopPropagation()};function o(e,t,n,o){var c;if(Object(a.o)("downloadFileFromUrl",{urlLength:e.length}),t)Object(r.a)(e);else{const t=document.createElement("a");t.style.display="none",t.href=e,t.download=o||"",t.referrerPolicy="origin",n||(n=(null===(c=document.activeElement)||void 0===c?void 0:c.parentElement)||document.body),n.appendChild(t),t.addEventListener("click",i),t.click(),t.removeEventListener("click",i),n.removeChild(t)}}},4086:function(e){e.exports=JSON.parse('{"h":"SZb","c":"TZb","g":"UZb","f":"VZb","e":"WZb","d":"XZb","i":"YZb","b":"ZZb","a":"_Zb","j":"$Zb"}')},4112:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3556),a=n(1087);function i(e){const t=Object(r.a)(e),n=Object(a.a)(t);return(null==n?void 0:n.sxsId)||null}},4188:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));const r=1024,a=1048576,i="Not support special characters"},434:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},4463:function(e,t,n){"use strict";var r=n(3561),a=n(20);const i=new a.c(()=>Promise.all([n.e(15),n.e(40),n.e(48),n.e(132),n.e(399)]).then(n.bind(null,19926))),o=new a.b(i,e=>e.addSearchRequestInstrumentation),c=new a.b(i,e=>e.addResourceTimingEntry),u=new a.b(i,e=>e.searchDiagnostics),s=()=>{const e=u.tryImportForRender(),t=e?e.getIfInitialized():null;return t?t.searchInstrumentationList:[]};n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c}))},4467:function(e,t,n){"use strict";var r=n(2101);const a=["ErrorTooLargeForLocalAttachmentSingle","ErrorTooLargeForLocalAttachmentMultiple","WarningFilesCanNotBeAttachedGenericError","WarningEmptyFilesCanNotBeAttached","WarningFilesCanNotBeAttachedWithNamesGenericError","WarningFilesCannotBeAttachedFromOtherMailboxes","WarningSeveralFilesCanNotBeAttachedGenericError","WarningInlineImageTypeNotSupported","WarningAttachmentsCanNotBeDeleted","InfoIncludeMostRecentAttachmentsMessage","ErrorSmimeHasCloudOrUriAttachments","ErrorAttachmentDownloadFailed","ErrorAttachmentDownloadFailedMultipleFiles","WarningSpecialCharactersAreNotSupported"];function i(e){e&&Object(r.a)(e,a)}n.d(t,"a",(function(){return i}))},4574:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4054),a=n(614),i=n(1798),o=n(2692),c=n(1713),u=n(2793);async function s(e,t,n){const s=Object(c.a)(e);if(s)if(Object(a.b)()&&Object(o.a)(s.id,!0,!0),Object(i.c)(s.model))(await u.e.import())(s.model);else{const e=s.download.url;e&&Object(r.a)(e,t,n)}}},4581:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.saveToCloud=0]="saveToCloud",e[e.download=1]="download",e[e.addToCalendar=2]="addToCalendar",e[e.editAndReply=3]="editAndReply",e[e.openNewTabAndSaveToCloud=4]="openNewTabAndSaveToCloud",e[e.openAndEdit=5]="openAndEdit"}(r||(r={}))},4606:function(e,t,n){"use strict";var r=n(3342),a=n(3303),i=n(1798),o=n(36),c=n(702),u=Object(c.action)("replaceAttachmentInWell")((function(e,t,n,c){let u=e.docViewAttachments.indexOf(t);u>-1?(Object(a.a)(e,t),e.docViewAttachments.splice(u,0,n)):(u=e.imageViewAttachments.indexOf(t))>-1?(Object(a.a)(e,t),e.imageViewAttachments.splice(u,0,n)):o.d("Can't find the oldAttachment when invoking replaceAttachmentInWell"),n.isCloudy||Object(r.a)(e,c),Object(i.n)(n.attachmentId)})),s=n(1928);function l(e,t,n,r,a){const i=Object(s.h)(Object.assign(Object.assign({},n.AttachmentId),{mailboxInfo:t.attachmentId.mailboxInfo}),n,r,a,!0,!1,!1,null,null,!1);u(e,t,i,n.Size)}n.d(t,"a",(function(){return l}))},4940:function(e,t,n){"use strict";t.a={AttachmentCreationClassicFromLocalFile:{name:"AttachmentCreationClassicFromLocalFile",customData:(e,t,n,r,a)=>r?[r.size]:[0]},AttachmentCreationFromRecentAttachment:{name:"AttachmentCreationFromRecentAttachment",customData:(e,t,n,r,a,i)=>[(null==r?void 0:r.size)||0,null==r?void 0:r.fileType]},AttachmentCreationCloudyFromLocalFile:{name:"AttachmentCreationCloudyFromLocalFile"},AttachmentDeletionAction:{name:"AttachmentDeletionAction",customData:(e,t,n,r)=>({generatedAttachmentId:t.attachmentId.Id}),cosmosOnlyData:(e,t,n,r)=>JSON.stringify({attachmentId:t.attachmentId.Id,fileType:r}),options:{isCore:!0}}}},4941:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(20),a=n(4574);n.d(t,"a",(function(){return a.a}));const i=new r.c(()=>n.e(747).then(n.bind(null,8580))),o=new r.a(i,e=>e.clickAttachment).importAndExecute,c=new r.a(i,e=>e.previewAttachment)},5248:function(e,t,n){"use strict";var r=n(3);const a={uploadFolders:new(n(16).ObservableMap)},i=Object(r.createStore)("attachmentsUploadFolderStore",a);var o,c=n(57);!function(e){e.User="User",e.Group="Group"}(o||(o={}));const u=Object(r.action)("preloadUploadFolder",(e=Object(c.g)().SessionSettings.UserEmailAddress,t=o.User)=>({mailboxId:e,uploadFolderMailboxType:t})),s=Object(r.action)("uploadFolderLoaded",(e,t)=>({mailboxId:e,uploadFolder:t}));Object(r.mutator)(s,e=>{const{mailboxId:t,uploadFolder:n}=e;i().uploadFolders.set(t,n)});var l=n(5697),d=n(6),f=n(282),m=n(703);const b="Email attachments";function h(e){switch(e){case o.Group:return b;case o.User:return Object(d.b)(l.a);default:return Object(f.a)(e)}}var p=n(35);var O=n(1735);function g(e,t){switch(t){case o.Group:const n=new Headers;return Object(O.f)(e,n),n;case o.User:return null;default:return Object(f.a)(t)}}function v(e=Object(c.g)().SessionSettings.UserEmailAddress){return i().uploadFolders.get(e)||null}var I=n(36);async function S(e=null,t=o.User){e=e||Object(c.g)().SessionSettings.UserEmailAddress;try{const a=v(e);if(a)return a;const i=function(e,t,n){return{mailboxId:e,folderId:n.FolderId,folderName:Object(m.a)(n.FolderName)?h(t):n.FolderName}}(e,t,await(n={},r={headers:g(e,t)},Object(p.a)("GetAttachmentDataProviderUploadFolderProps",n,r)));return s(e,i),i}catch(n){return I.h.warn("fetchUploadFolder got error: "+n.message),function(e,t){return{mailboxId:e,folderId:null,folderName:h(t)}}(e,t)}var n,r}Object(r.orchestrator)(u,async e=>{const{mailboxId:t,uploadFolderMailboxType:n}=e;v(t)||await S(t,n)}),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return o}))},5521:function(e,t,n){"use strict";function r(e){switch(e){case"csv":case"ods":case"xls":case"xlsb":case"xlsm":case"xlsx":return"Excel";case"odp":case"pot":case"potm":case"potx":case"pps":case"ppsm":case"ppsx":case"ppt":case"pptm":case"pptx":return"PowerPoint";case"vsd":case"vsdm":case"vsdx":return"Visio";case"doc":case"docm":case"docx":case"dot":case"dotm":case"dotx":case"odt":case"rtf":return"Word";default:return""}}n.d(t,"a",(function(){return r}))},565:function(e,t,n){"use strict";var r=n(347),a=n(252),i="[object AsyncFunction]",o="[object Function]",c="[object GeneratorFunction]",u="[object Proxy]";t.a=function(e){if(!Object(a.a)(e))return!1;var t=Object(r.a)(e);return t==o||t==c||t==i||t==u}},5663:function(e){e.exports=JSON.parse('{"a":"Uda"}')},568:function(e,t,n){"use strict";t.a=function(e){return e}},5697:function(e){e.exports=JSON.parse('{"a":"Eca"}')},570:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},5705:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("updateChangeKeyOnItemId")((function(e,t){e.ChangeKey=t}))},578:function(e,t,n){"use strict";var r=n(328),a=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=a},5887:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"CreateAttachmentJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},5936:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}));const r="application/octet-stream",a=1024,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},5940:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(71);function a(e){const t=e.maxTotalClassicAttachmentSize-e.totalClassicAttachmentSize;return t<0?(Object(r.o)("AttachmentSizeReachedMax",{},{isCore:!0}),0):t}},5981:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"AttachmentItemsPagingDetails:#Exchange"},e)}var a=n(1796),i=n(35);function o(e){return Object.assign({__type:"SearchAttachmentDataProviderItemsRequest:#Exchange"},e)}var c=n(36);function u(e,t,n,r){return e?n(e):(c.h.warn(null==t?void 0:t.statusText),404===(null==t?void 0:t.status)?r(4):401===(null==t?void 0:t.status)||403===(null==t?void 0:t.status)?r(2):r(1))}const s=Object.freeze({SortColumn:2,SortOrder:1}),l="maxResults=1000&fields=nextPageToken,files(id,mimeType,name,size,modifiedTime,thumbnailLink,webViewLink,webContentLink,createdTime,fileExtension)",d="GDriveDataProviderItem:#Exchange",f="FileAttachmentDataProviderItem:#Exchange",m="FolderAttachmentDataProviderItem:#Exchange",b="OneDriveProScope:#Exchange",h="OneDriveItemSkipTokenPagingMetadata:#Client",p="OneDriveConsumerScope:#Exchange",O="oneNote",g="application/onenote";var v=n(2199);function I(e,t){return{TotalItemCount:e.length,ResultCode:0,Items:e.map(e=>t(e))}}function S(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}const w="application/vnd.google-apps.folder";function j(e){return{__type:d,Name:e.name,Size:parseInt(e.size),Thumbnail:{Url:e.thumbnailLink},Preview:{Url:e.thumbnailLink+"2"},CreatedTime:e.createdTime,DownloadUrl:e.webContentLink,WebViewLink:e.webViewLink,FileExtension:e.fileExtension,Modified:e.modifiedTime,MimeType:e.mimeType,Location:e.id,Id:e.id,AttachmentProviderId:null,ProviderType:5,Type:e.mimeType===w?1:0}}function y(e){return Object.assign(Object.assign({},I(e.files,j)),{NextPageToken:e.nextPageToken})}function C(e){return Object.assign(Object.assign({},S(e)),{NextPageToken:null})}async function A(e,t=!1){const{errorResponse:n,result:r}=await Object(v.k)(e,t);return r?u(r,null,y,C):u(null,n,y,C)}var T=n(6283),P=n(3448);function E(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.Name:null}function x(e){return{__type:e.__type,Id:e.ItemId.Id,AttachmentProviderId:null,ProviderType:10,Type:0,Size:e.Size,From:E(e),Subject:e.Subject,ReceivedDate:e.DateTimeSent,MessagePreview:e.Preview,IsRead:e.IsRead}}const R=e=>I(e,x);var k=n(326),D=n(261),N=n(1704),F=n(1689),M=n(4463),_=n(1981),L=n(1914);const U=200;async function V(e){if(0==e.length)throw new Error("FilePicker - Mail Messages: StartSearch should not be called with an empty search!!");const t=Object(F.d)(F.a.FilesPicker);Object(T.a)(t.nextSearchQueryId,F.a.FilesPicker),Object(P.a)(Object(k.a)(),F.a.FilesPicker);const n=Object(D.b)(),r={Cvid:Object(k.a)(),Scenario:{Name:_.c.MailEmailAttachmentPicker},TimeZone:Object(_.A)(n),TextDecorations:"Off",EntityRequests:B(e)},a=new Date,i=await Object(_.J)(r,t.searchSessionGuid);if(!i||2!=i.length){return c.h.warn("3S Response for search mail messages failed"),u(null,{body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:"Get mail message items error",type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null},R,S)}const o=i[0].status==U,s=o?null:i[0].statusText,l=function(e,t,n,r,a,i,o){if(!e||2!=e.length)return null;const c=Object(_.f)(e[0],t,n,"SubstrateSearch",r,new Date,a.currentSearchQueryId,new Headers(e[1]),0,_.c.MailEmailAttachmentPicker);return c.ClientJSPreRequestTime=i,c.ClientJSRequestThreadTime=o,Object(N.ab)(c.SearchTraceID,F.a.FilesPicker,!1),M.d.import().then(e=>e(c)),L.j.importAndExecute(c.SearchTraceID,c.ClientNetworkTime,c.ClientHttpStatus,new Date),c}(i,e,s,a,t,0,0);if(o){const e=await i[0].json(),t=function(e,t){if(e&&e.Results&&0!==e.Results.length){const n=[],r=e.Results;for(const e of r){const r=Object(_.n)(e.Source,t);r.InstanceKey=e.ReferenceId,n.push(r)}return n}return[]}(Object(_.x)(e),r);return L.l.importAndExecute(l.SearchTraceID,new Date,_.c.MailEmailAttachmentPicker),u(t,null,R,S)}{c.h.warn(`3S Response for search mail messages failed with ${s}`);const e={body:null,headers:null,ok:!1,redirected:!1,status:1,statusText:s,type:null,url:null,clone:null,bodyUsed:null,arrayBuffer:null,blob:null,formData:null,json:null,text:null};return L.i.importAndExecute(l.SearchTraceID,_.c.MailEmailAttachmentPicker),u(null,e,R,S)}}function B(e){return[{EntityType:"Message",Filter:null,From:0,PropertySet:"ProvenanceOptimized",Provenances:["Exchange"],Query:{QueryString:e},RefiningQueries:null,Size:50,Sort:[{Field:"Time",SortDirection:"Desc"}]}]}function W(e,t,n,c,u,d=null,f){if(5===e)return async function(e,t=""){let n=`${l}&q=mimeType!='application/octet-stream' and trashed=false and fullText contains '${e}'`;return t&&(n=`${n} and '${t}' in parents`),A(n)}(n,u);if(10===e)return V(n);const m=o({AttachmentDataProviderId:t,Query:n,Paging:r({Sort:f||(b=s,Object.assign({__type:"AttachmentItemsSort:#Exchange"},b)),FolderId:c,Location:u,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:100}),PagingMetadata:d})});var b,h,p;return void 0===(h={request:m}).request||h.request.__type||(h.request=o(h.request)),Object(i.a)("SearchAttachmentDataProviderItems",h,p)}var G=n(71),H=n(2118),z=n(47),q=n(6);function Q(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"GetAttachmentDataProviderItemsRequest:#Exchange"},n))),Object(i.a)("GetAttachmentDataProviderItems",e,t)}var J=n(2279);function K(e){return null!==e&&e.__type===b}function $(e){return e&&e.__type===h}function X(e,t){return 1===e&&t&&function(e){return null!==e&&e.__type===p}(t)?t.Type:null}function Y(e,t){return 0===e&&t&&K(t)?t.Type:null}async function Z(e,t){const n=[e];try{const r=await Object(J.c)(e,!1,t);return!Object(q.k)(r)||(Object(G.o)("FPAccessTokenUnavailable",n),!1)}catch(e){return Object(G.o)("FPAccessTokenUnavailable",n),!1}}async function ee(e,t,n){switch(e){case 3:case 2:case 6:return Z(e,void 0);case 5:case 10:return!0;case 0:return(0===Y(e,n)||4===Y(e,n))&&Z(e,t);case 1:return 4===X(e,n)||Object(z.j)("doc-odcgetitems");default:return!1}}function te(e){return e.__type===m||1===e.Type}function ne(e){const t=e.filter(te),n=e.filter(e=>!te(e));return t.concat(n)}var re=n(282);function ae(e,t,n){let r=null,a=null;switch(e){case"asc":[r,a]=[t,n];break;case"desc":[r,a]=[n,t];break;default:Object(re.a)(e)}return r<a?-1:r>a?1:0}function ie(e,t,n){switch(t){case 2:e.sort((e,t)=>{const r=e.Modified,a=t.Modified,i=r?new Date(r):new Date(0),o=a?new Date(a):new Date(0);return ae(0===n?"asc":"desc",i,o)});break;case 1:e.sort((e,t)=>{const r=e.Size||0,a=t.Size||0;return 0===n?r-a:a-r});break;default:e.sort((e,t)=>{const r=e.Name.toLowerCase(),a=t.Name.toLowerCase();return ae(0===n?"asc":"desc",r,a)})}}function oe(e){return{__type:Object(v.q)(e)?m:f,Id:e.id,AttachmentProviderId:null,Location:`${t=e.path_collection,`/${(t.entries||[]).map(e=>e.name).join("/")}`}/${e.name}`,Modified:e.modified_at,ModifiedBy:e.modified_by?e.modified_by.name:null,Name:e.name,ProviderType:3,Size:e.size,Type:Object(v.q)(e)?1:0};var t}const ce=e=>I(e,oe);function ue(e){return{__type:Object(v.t)(e)?m:f,Id:Object(v.r)(e)?null:e.id,AttachmentProviderId:null,Location:Object(v.r)(e)?"":e.path_lower,Modified:Object(v.s)(e)?e.server_modified:"",Name:e.name,ProviderType:2,Size:Object(v.s)(e)?e.size:0,Type:Object(v.t)(e)?1:0}}const se=e=>I(e,ue);function le(e){return e.file?e.file.mimeType:e.package&&e.package.type===O?g:null}function de(e){return{TotalItemCount:0,ResultCode:e,Items:[]}}function fe(e,t){return 1===t?e.parentReference?`${e.parentReference.path}/${e.name}`:null:e.webDavUrl}function me(e,t,n,r,a,i){let o=void 0;if(a)switch(r){case 0:o=be(e,a,i);break;case 1:if(Object(z.j)("doc-odcgetitems")){o=be(e,a,i);break}throw new Error("We do not support skip token based paging for OneDriveConsumer");default:Object(re.a)(r)}let c=e.length;return a&&o?c=o.totalItemsFetched+1:o&&(c=o.totalItemsFetched),{TotalItemCount:c,ResultCode:0,Items:e.map(e=>(function(e,t,n,r){var a,i,o;const[c,u,s,l,d]=e.folder?[m,null,e.folder.childCount,1,0]:[f,le(e),0,0,e.size];return{__type:c,Id:e.id,Name:e.name,Size:d,Thumbnail:{Url:(null===(i=null===(a=e.thumbnails)||void 0===a?void 0:a[0])||void 0===i?void 0:i.medium)?e.thumbnails[0].medium.url:null},Modified:e.lastModifiedDateTime,ModifiedBy:(null===(o=e.lastModifiedBy)||void 0===o?void 0:o.user)?e.lastModifiedBy.user.displayName:null,MimeType:u,Location:fe(e,r),ProviderEndpointUrl:t,ChildCount:s,AttachmentProviderId:n,ProviderType:r,Type:l}})(e,t,n,r)),PagingMetadata:o}}function be(e,t,n){const r=n?n.totalItemsFetched+e.length:e.length;return a={skipToken:t,totalItemsFetched:r},Object.assign(Object.assign({},a),{__type:"OneDriveItemSkipTokenPagingMetadata:#Client"});var a}async function he(e,t,n,r,a,i,o,c=null){const s=c?{maxEntries:c.maxEntries,skipToken:c.metadata?c.metadata.skipToken:null}:null,{errorResponse:l,result:{items:d,skipToken:f}}=await Object(v.m)(t,n,a,i,o,void 0,s);return function(e,t,n,r,a,i,o){return t?u(t,null,e=>me(e,n,r,a,i,o),de):u(null,e,e=>me(e,n,r,a,i,o),de)}(l,d,e,r,n,f,c?c.metadata:null)}const pe="maxResults=1000&fields=files(id,mimeType,name,size,modifiedTime,thumbnailLink)";var Oe=n(1709),ge=n(296);async function ve(e,t,n,r=!1){const{errorResponse:a,result:i}=await Object(v.n)(e,n,r);return i?u(i.value,null,r=>Ie(r,e,t,n),de):u(null,a,r=>Ie(r,e,t,n),de)}function Ie(e,t,n,r){const a=function(e,t,n,r){const a=[];return e.forEach(e=>{const i=function(e,t,n,r){var a,i,o;if(!Object(ge.a)()&&".fluid"===Object(Oe.a)(e.name))return null;return{__type:f,Id:e.remoteItem.id?e.remoteItem.id:e.id,Name:e.name,Size:e.remoteItem.size,Modified:null===(a=e.remoteItem.fileSystemInfo)||void 0===a?void 0:a.lastAccessedDateTime,ModifiedBy:null===(o=null===(i=e.remoteItem.lastModifiedBy)||void 0===i?void 0:i.user)||void 0===o?void 0:o.displayName,MimeType:Se(e),Location:e.remoteItem.webDavUrl,ProviderEndpointUrl:ye(e)?null:t,ChildCount:0,AttachmentProviderId:n,ProviderType:r,Type:0}}(e,t,n,r);i&&a.push(i)}),a}(e,t,n,r);return{TotalItemCount:a.length,ResultCode:0,Items:a,PagingMetadata:null}}function Se(e){var t;return e.remoteItem.file?e.remoteItem.file.mimeType:(null===(t=e.package)||void 0===t?void 0:t.type)===O?g:null}const we=(e,t)=>e.substring(0,t.length)===t,je="https://";function ye(e){return!!e.remoteItem.webDavUrl&&!!we(e.remoteItem.webDavUrl.toLowerCase(),je)}const Ce=(Ae={Type:0,DisplayName:"Files",AriaLabel:"Files"},Object.assign({__type:"OneDriveProScope:#Exchange"},Ae));var Ae;async function Te(e,t,n,i,o=null,l=null,d,f,m=null,b,h=null,p=!1){try{const c=await ee(e,l,o);let O,g=!1;if(c)if(1===e){if(4===X(e,o)){g=!0;try{O=await ve(l,t,e)}catch(e){Object(G.o)("OneDriveConsumerMRUError",{info:e.message})}}else if(Object(z.j)("doc-odcgetitems")&&0===X(e,o)){if(m&&!$(m))throw new Error("The paging metadata is not of type OneDriveItemsSkipTokenPagingMetadata");g=c;try{O=await async function(e,t,n,r,a=null){return he(v.d,v.d,1,e,t,n,r,a)}(t,b?b.SortColumn:s.SortColumn,b?b.SortOrder:s.SortOrder,d,{metadata:m,maxEntries:100})}catch(e){}}}else if(5===e)g=!0,O=await A(function(e,t){let n="modifiedTime";t&&0===t.SortColumn?n="name":t&&1===t.SortColumn&&(n="quotaBytesUsed");const r=t&&0===t.SortOrder?"asc":"desc";return`${pe}&orderBy=folder,${n} ${r}&q=mimeType!="application/octet-stream" and trashed=false and "${e||"root"}" in parents`}(f,b));else if(2===e){const e=b?b.SortColumn:s.SortColumn,t=b?b.SortOrder:s.SortOrder;g=!0;try{O=await async function(e,t,n){const{errorResponse:r,result:a}=await Object(v.i)({path:e});if(a){const e=u(a,null,se,S);return ie(e.Items,t,n),e.Items=ne(e.Items),e}return u(null,r,se,S)}(f,e,t)}catch(e){}}else if(3===e){const e=b?b.SortColumn:s.SortColumn,t=b?b.SortOrder:s.SortOrder;g=!0;try{O=await async function(e,t,n){const{errorResponse:r,result:a}=await Object(v.g)(e);if(a){const e=u(a,null,ce,S);return ie(e.Items,t,n),e.Items=ne(e.Items),e}return u(null,r,ce,S)}(d,e,t)}catch(e){}}else 10===e&&(g=!0,O=await async function(e,t){const{errorResponse:n,result:r}=await Object(v.l)(e,t);return r?u(r,null,R,S):u(null,n,R,S)}(d,n));if(0===Y(e,o)){if(m&&!$(m))throw new Error("The paging metadata is not of type OneDriveItemsSkipTokenPagingMetadata");g=c;try{O=await async function(e,t,n,r,a,i=null){const o=new URL(e);return he(e,`${o.protocol}//${o.host}`,0,t,n,r,a,i)}(l,t,b?b.SortColumn:s.SortColumn,b?b.SortOrder:s.SortOrder,d,{metadata:m,maxEntries:100})}catch(e){}}if(4===Y(e,o)){g=!0;try{O=await ve(l,t,e,p)}catch(e){Object(G.o)("OneDriveProMRUError",{info:e.message})}}if(O&&0===O.ResultCode)return Object(G.o)("FPgetItemsClientCall",[!0,e]),O;g&&Object(G.o)("FPgetItemsClientCall",[!1,e]);let I=null,w=function(e,t){if(4===Y(e,t)||4===X(e,t)){const e=new G.b("getOneDriveMRUItemsDataProvider");return e.addCustomData({IsViaServer:!0}),e}return null}(e,o);try{return I=await async function e(t,n,i,o,c,u,l,d,f,m){const b={AttachmentDataProviderId:t,Paging:r({Sort:m||s,FolderId:c||"",Location:l||"",ItemsEndpointUrl:u||"",FilterBy:i,RequestedData:Object(a.a)({BasePoint:"Beginning",Offset:n,MaxEntriesReturned:100}),PagingMetadata:f}),Scope:null==d?Ce:d};let h=await Q({request:b});if(Object(z.j)("doc-authContext")&&!o&&h&&!Object(q.k)(h.ClaimsChallenge)){try{const e=await H.a.import();await e(h.ClaimsChallenge)}catch(e){return h}h=await e(t,n,i,!0,c,u,l,d,f,m);const r=h&&Object(q.k)(h.ClaimsChallenge);return Object(G.o)("getFileProviderItemsAfterReAuth",{isSuccess:r}),h}return h}(t,n,i,p,d,h,f,o,m,b),w&&w.end(),I}catch(e){throw w&&w.endWithError("ClientError"),e}}catch(e){throw c.h.warn("FilePicker: getFileProviderItems got error: "+e.message),e}}n.d(t,"f",(function(){return W})),n.d(t,"b",(function(){return Te})),n.d(t,"a",(function(){return ee})),n.d(t,"e",(function(){return K})),n.d(t,"d",(function(){return $})),n.d(t,"c",(function(){return le}))},6053:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"CreateAttachmentRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6083:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Item:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6097:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemIdAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},618:function(e,t,n){"use strict";function r(e,t){for(var n,r=/\r\n|[\n\r]/g,a=1,i=t+1;(n=r.exec(e.body))&&n.index<t;)a+=1,i=t+1-(n.index+n[0].length);return{line:a,column:i}}n.d(t,"a",(function(){return r}))},6216:function(e){e.exports=JSON.parse('{"a":"Sra"}')},6218:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var r=n(20);const a=new r.c(()=>n.e(1981).then(n.bind(null,9009))),i=new r.a(a,e=>e.prefetchAllWacResources),o=new r.a(a,e=>e.prefetchWacResourcesForAttachments),c=new r.a(a,e=>e.prefetchWacResourcesForFiles)},6283:function(e,t,n){"use strict";var r=n(3),a=n(1689);t.a=Object(r.mutatorAction)("setCurrentSearchQueryId",(e,t)=>{Object(a.d)(t).currentSearchQueryId=e})},6458:function(e){e.exports=JSON.parse('{"a":"lfa"}')},6461:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3);const a=Object(r.action)("setAnnouncedComponentMessage",(e,t)=>({attachmentWell:e,message:t}))},6468:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ReferenceAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6472:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1713),a=n(1857);function i(e){const t=Object(r.a)(e),n=Object(a.a)(null==t?void 0:t.model);return 3===n}},6495:function(e,t,n){"use strict";class r extends Error{constructor(e,t,n){super(e),this.errorCode=t,this.errorContext=n}}t.a=r},6597:function(e,t,n){"use strict";var r=n(71),a=n(4940),i=n(3303),o=n(5705),c=n(705);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DeleteAttachmentFromDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AttachmentIdInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteAttachmentFromDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"AttachmentId"},value:{kind:"Variable",name:{kind:"Name",value:"attachmentId"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"RootItemId"}}]}}]}}]};n.d(t,"b",(function(){return l}));t.a=Object(r.r)(a.a.AttachmentDeletionAction,(async function(e,t,n,r){const a=await s(t.attachmentId,n);Object(i.a)(e,t),Object(o.a)(n,a.RootItemId.RootItemChangeKey)}));const s=async function(e,t,n){var r;const a=Object(c.a)(),i=await a.mutate({variables:{attachmentId:{Id:e.Id,mailboxInfo:e.mailboxInfo,RootItemId:e.RootItemId||t.Id,RootItemChangeKey:e.RootItemChangeKey}},context:{requestOptions:n},mutation:u});return null===(r=null==i?void 0:i.data)||void 0===r?void 0:r.deleteAttachmentFromDraft},l={invokeDeleteAttachmentFromDraftMutation:s}},6742:function(e,t,n){"use strict";var r=n(1905),a=n(1713),i=n(2916),o=n(47),c=n(702);t.a=Object(c.action)("setAttachmentPermissionLevel")((function(e,t,n,c){const u=Object(a.a)(e),s=u.model;s.PermissionType=t,n&&(s.AttachLongPathName=n,u.openUrl=Object(i.a)(s)),Object(o.j)("doc-attachment-referenceAttachmentExpiration")&&u.info&&u.info.sharingInfo&&(u.info.sharingInfo.expirationDate=c),Object(r.a)(e)}))},6754:function(e,t,n){"use strict";var r=n(0),a=n(690),i=n(336),o=n(1561),c=n(23),u=n(4086),s=n(6),l=n(9994),d=n.n(l),f=n(166);const m=n.n(f).a.bind(d.a);t.a=Object(c.a)((function(e){const t=e.isAlreadySaved?Object(s.b)(u.j):Object(s.b)(u.a);return r.createElement(r.Fragment,null,r.createElement(a.a,{className:d.a.menuIcon,imageProps:e.iconProps}),r.createElement("span",{className:d.a.menuText},e.itemText),r.createElement(o.a,{content:e.shouldShowDiamond?null:t},r.createElement(i.a,{className:m(d.a.menuIcon,d.a.icon),iconName:e.shouldShowDiamond?"Diamond":"Info"})))}))},7031:function(e,t,n){"use strict";function r(e,t){var n;const r=null===(n=null==e?void 0:e.AttachmentId)||void 0===n?void 0:n.RootItemId;return r&&t&&r===t.Id}n.d(t,"a",(function(){return r}))},705:function(e,t,n){"use strict";var r=n(567),a=n(964),i=n(953);let o=!0;const c=()=>{o=!1},u=()=>({Query:{fields:{userConfiguration:{read(e,{args:t,toReference:n}){if(e)return e;if(o){const e=!0;return n(Object(i.a)(null==t?void 0:t.id),e)}return n({__typename:"UserConfiguration",id:t.id})}}}},UserConfiguration:{fields:{ApplicationSettings:{merge:!0},AttachmentPolicy:{merge:!0},Favorites:{merge:!0},MasterCategoryList:{merge:!0},PolicySettings:{merge:!0},PrimeSettings:{merge:!0},SafetyUserOptions:{merge:!0},SegmentationSettings:{merge:!0},SessionSettings:{merge:!0},SmimeAdminSettings:{merge:!0},TenantThemeData:{merge:!0},UserOptions:{merge:!0},ViewStateConfiguration:{merge:!0}}}});var s=n(921);var l=n(71);const d="ApolloNotInitialized";let f=null,m=null;function b(){if(!f){const e=new Error(d);throw e.addQueue=!0,e}return f}function h(e){if(!f)return Object(l.o)(d,{s:e,cs:(new Error).stack}),m}function p({lazyLinks:e,context:t}){return m=e.then(e=>(f=function({links:e,context:t}){const n={watchQuery:{fetchPolicy:"no-cache"},query:{fetchPolicy:"no-cache"}},i=u(),o=new r.ApolloClient({cache:new r.InMemoryCache({possibleTypes:a.a,typePolicies:Object(s.a)(i)}),defaultOptions:n});return t.client=o,o.setLink(r.ApolloLink.from(e)),o}({links:e,context:t}),f)),m}var O=n(0);function g(e){return()=>O.createElement(r.ApolloProvider,{client:b()},e())}n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return c}))},709:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},711:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(190))},713:function(e,t,n){"use strict";var r=n(718),a=n.n(r);let i,o;async function c(){try{i||(i=fetch(a.a));const e=await i;return o||(o=e.text()),o}catch(e){throw i=void 0,o=void 0,e}}function u(e){return e}n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return"DefaultUserConfig"})),n.d(t,"b",(function(){return c}))},714:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i}));var r="function"==typeof Symbol&&null!=Symbol.iterator?Symbol.iterator:"@@iterator",a="function"==typeof Symbol&&null!=Symbol.asyncIterator?Symbol.asyncIterator:"@@asyncIterator",i="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag"},7150:function(e,t,n){"use strict";var r=n(3342),a=n(2413),i=n(2802),o=n(702),c=n(1928);t.a=Object(o.action)("addAttachmentIntoWellBeforeUpload")((function(e,t,n,o,u=null){let s;n.AttachmentId=o,Object(a.a)([{attachmentId:Object.assign(Object.assign({},n.AttachmentId),{mailboxInfo:o.mailboxInfo}),attachment:n,modelInitializationValues:u}],!1,!0,!0),Object(c.s)(e)?(t.inlineAttachments.push(e),s=!0):(e.isPlaceholderAttachment=!0,Object(i.a)(n)?t.imageViewAttachments.push(e):t.docViewAttachments.push(e)),!s&&e.isCloudy||Object(r.a)(t,n.Size)}))},7151:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(7152),a=n(6),i=n(36),o=n(4188),c=n(5940),u=n(2036);function s(e,t,n){let s=0;for(let t,n=0;t=e[n];n++)s+=t.size;const l=Object(c.a)(t);if(s>l){const t=Math.floor(l/o.b);let i,c;return e.length>1?(c="ErrorTooLargeForLocalAttachmentMultiple",i=Object(a.c)(Object(a.b)(r.a),t)):(c="ErrorTooLargeForLocalAttachmentSingle",i=Object(a.c)(Object(a.b)(r.b),t)),Object(u.a)(n,c,[i]),!0}return i.h.info("Attachment: TotalSize = "+Math.floor(t.totalClassicAttachmentSize/1048576)),!1}},7152:function(e){e.exports=JSON.parse('{"a":"pea","b":"qea"}')},7153:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(282),a=n(2199),i=n(1971),o=n(296);function c(e,t,n,r){const c=Object(o.a)()?1:0,s=Object(i.h)(),[l]=s.filter(e=>e.type===c);if(!l)throw new Error("Unable to upload file as couldnt find OneDrive provider");const{model:{EndPointUrl:d}}=l,f={fileToUpload:{fileName:e,fileBlob:t},conflictBehavior:"rename",folderInfo:u(n),onProgress:r};return[1===c?Object(a.u)(1,a.d,f):Object(a.u)(0,d,f),l]}function u(e){const{identifierType:t,identifier:n}=e;switch(t){case 0:return{type:0,identifier:n};case 1:return{type:1,identifier:n};default:return Object(r.a)(t)}}},718:function(e,t,n){e.exports=n.p+"../resources/graphql/schema.all.min-bceb7e9db1d7169983b4eed839783dbc.graphql"},7204:function(e){e.exports=JSON.parse('{"a":"l4a"}')},7208:function(e,t,n){"use strict";t.a={OnClick:{name:"AttachmentOnClick",customData:e=>[e]}}},7209:function(e){e.exports=JSON.parse('{"a":"q0b"}')},7335:function(e,t,n){"use strict";var r=n(7607),a=n(6),i=n(2377),o=n(2378),c=n(4467),u=n(71),s=n(282),l=n(1713),d=n(1696),f=n(8326),m=n(7151);var b=n(7150),h=n(1928),p=n(36),O=n(702),g=n(1761),v=n(1798),I=n(6742),S=n(2264);var w=n(3303),j=n(6461),y=n(5705),C=n(9891);function A(e,t,n,r,i,o,c){Object(j.a)(c,Object(a.b)(C.a)),Object(h.E)(e,t,n,r,o),Object(y.a)(i,r.AttachmentId.RootItemChangeKey),function(e,t,n){n&&0===n.ResultCode&&0===e.attachmentType&&(n.CanShareInternally||Object(S.e)(t.PermissionType)||(Object(u.o)("AttachmentsCanNotShareInternally"),Object(I.a)(e.attachmentId,0)),Object(v.n)(t.AttachmentId))}(e,n,o)}function T(e,t,n,r){let a=!0;1===e.attachmentType&&(Object(h.z)(e,2),a=!1),t&&Object(w.a)(t,e,a),n&&r&&g.k.importAndExecute(n,r)}var P=Object(O.action)("handleCreateAttachmentNotification")((function(e,t,n,r,a,i,o,c){const u=e;try{if(0!==u.ResultCode)throw new Error(`ResultCode:${u.ResultCode}, Id:${u.Id}, Exception: ${u.Exception}`);{const e=u.Response.ResponseMessages.Items[0];if(e&&e.Attachments.length>0)return Object(h.C)(a.attachmentId,!0),i(e.Attachments[0]),void A(a,n,r,e.Attachments[0],t,u.Response.SharingInformation,c.attachmentWellViewState)}}catch(e){p.d("Error handling the create attachment notification: "+e)}Object(h.C)(a.attachmentId,!1),o(new Error(u.Exception)),T(a,c.attachmentWellViewState,null,null)})),E=n(326);async function x(e,t){const n=Object(E.a)(),r={subscriptionId:n,requiresExplicitSubscribe:!1,subscriptionParameters:null},a=e=>{t(e),g.k.importAndExecute(r,a)};(await g.j.import())(r,a);const i=(await g.b.import())();e(n,r,i,a)}var R=n(35),k=n(905);var D=n(704);function N(e,t,n,r,a,i){const o=Object(D.a)(e.mailboxInfo)||{};return c={itemId:e,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",subscriptionId:r,channelId:a,dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:t,isInline:i},u=o,void 0===c.itemId||c.itemId.__type||(c.itemId=Object(k.a)(c.itemId)),Object(R.a)("CreateAttachmentFromAttachmentDataProvider",c,u);var c,u}var F=n(4188),M=Object(O.action)("createAttachmentFromAttachmentDataProvider")((function(e,t,n,r,a,i,o,c,s){const l=new u.b("AttachmentCreationClassicFromAttachmentDataProvider");l.addCustomData([a.providerType]);const d=e=>{o(e),l.end()},f=e=>{c(),l.endWithError("ServerError",e)};x(async(t,n,o,u)=>{try{if(0===a.providerType){if(function(e){return-1!==e.indexOf("%")||-1!==e.indexOf("#")}(a.name))throw new Error(F.c)}if(0===i.attachmentType&&Object(h.B)(Object(h.k)(a.size),.05,e=>{Object(h.x)(i,e)},i.attachmentId),!await N(e,r,a,t,o,!1))throw new Error("Empty response for createAttachmentFromAttachmentDataProvider request")}catch(e){return Object(h.C)(i.attachmentId,!1),c(e),void T(i,s.attachmentWellViewState,n,u)}},r=>{P(r,e,t,n,i,d,f,s)})}));var _=n(4940),L=n(1735);function U(e,t,n,r,a,i){return new Promise(async(o,c)=>{const u=new XMLHttpRequest;u.onreadystatechange=function(){if(4===u.readyState)if(200===u.status){let e;try{e=JSON.parse(u.responseText)}catch(e){p.d("Attachment: Deserialize response failed with error: "+e.Message),p.d("Attachment: Deserialize response Failure Stack Trace: "+e.stack),c(e)}o(e)}else c(new Error("Request failed with status "+u.status+". Message: "+u.responseText))},u.ontimeout=function(){c(new Error("Request timed out"))},i&&(u.upload.onprogress=i),u.open("POST",e,!0),u.setRequestHeader("X-OWA-Action",n);const s=await Object(L.d)(r);s&&Object.keys(s).forEach(e=>{u.setRequestHeader(e,s[e])});const l=JSON.stringify(t);a?(u.setRequestHeader("X-OWA-UrlPostData",encodeURI(l)),u.send(a)):u.send(l)})}var V=n(10);function B(e){const t=Object(V.a)();return t.baseUrl?`${t.baseUrl}${e}`:`/owa${e}`}var W=n(5887),G=n(6053),H=n(261),z=n(705);const q={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"AddAttachmentToDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AddAttachmentToDraftOptions"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"addAttachmentToDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"attachment"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwsTypeName"}},{kind:"Field",name:{kind:"Name",value:"AttachmentId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"RootItemId"}},{kind:"Field",name:{kind:"Name",value:"RootItemChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"IsInline"}},{kind:"Field",name:{kind:"Name",value:"ContentId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReferenceAttachment"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ProviderType"}},{kind:"Field",name:{kind:"Name",value:"WebUrl"}},{kind:"Field",name:{kind:"Name",value:"AttachLongPathName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}}]}}]}}]};var Q=n(47);const J=B("/service.svc/CreateAttachmentFromLocalFile");async function K(e,t,n,r,a,i){if(p.h.info(`Attachment: createAttachment Id: ${e.Id}, ChangeKey: ${e.ChangeKey}`),Object(Q.j)("mon-cmp-graphQLAttachments")){const a=function(e){const t=Object.assign(Object.assign({},e),{OwsTypeName:e.__type});delete t.__type,t.AttachmentId&&delete t.AttachmentId.__typename;return t}(t),o=Object(z.a)(),c=(await o.mutate({variables:{options:{ParentItemId:e,Attachment:a,CancellationId:n,attachmentType:"LocalFile",fileBlob:r,mailboxInfo:e.mailboxInfo,isInline:t.IsInline,sliceInformation:i}},mutation:q})).data.addAttachmentToDraft;return{ResponseMessages:{Items:[{Attachments:[Object.assign(Object.assign({},c.attachment),{__type:c.attachment.OwsTypeName})],IsCancelled:c.isCancelled,ResponseClass:"Success",ResponseCode:"NoError"}]}}}{const o=Object(G.a)({ParentItemId:e,Attachments:[t],RequireImageType:t.IsInline,IncludeContentIdInResponse:t.IsInline,ClientSupportsIrm:!0,CancellationId:n});i&&(o.SliceNumber=i.sliceNumber,o.TotalSlices=i.totalSlices);const c=Object(W.a)({Header:Object(H.b)(),Body:o}),u=t;return(await U(J,c,"CreateAttachmentFromLocalFile",e.mailboxInfo,u&&r?r:null,a)).Body}}function $(e,t){let n="Attachment: createAttachment failed",r=null!=t?t:"genericError";return(null==e?void 0:e.MessageText)&&(n+=` with MessageText: ${e.MessageText}`),p.h.warn(n),(null==e?void 0:e.ResponseCode)&&(r=e.ResponseCode),{errorMessage:n,errorCode:r}}function X(e){const t=Object.assign({},e);return Object.keys(t).forEach((function(e,n){null===t[e]&&(t[e]=void 0)})),t}var Y=Object(u.r)(_.a.AttachmentCreationClassicFromLocalFile,(async function(e,t,n,r,a){let i=null;0===a.attachmentType&&(i=function(e){const t=e.loaded/e.total;Object(h.x)(a,t)});const o=X(t),c=(await K(e,o,n,r,i)).ResponseMessages.Items[0];if(c&&c.Attachments.length>0&&c.Attachments[0]){return{attachment:c.Attachments[0],sharingInfo:null}}throw $(c)})),Z=n(6097),ee=Object(u.r)(_.a.AttachmentCreationFromRecentAttachment,(async function(e,t,n,r,a,i){let o=null;0===a.attachmentType&&(o=function(e){const t=e.loaded/e.total;Object(h.x)(a,t)});let c=X(t);if(i){c=function(e,t){return Object(Z.a)({AttachmentId:e.AttachmentId,AttachmentIdToAttach:t,ContentType:e.ContentType,Name:e.Name,Size:e.Size,Thumbnail:e.Thumbnail,ThumbnailMimeType:e.ThumbnailMimeType,CreateAttachmentInlineType:2})}(c,r.fileId)}const u=await K(e,c,n,null,o),s=u.ResponseMessages.Items[0];if(s&&s.Attachments.length>0&&s.Attachments[0]){return{attachment:s.Attachments[0],sharingInfo:u.SharingInformation}}throw $(s)}));function te(e,t,n,r,a,i){const o=Object(D.a)(e.mailboxInfo)||{};return u=o,void 0===(c={itemId:e,uri:t,name:n,subscriptionId:r,isInline:a,contentId:i}).itemId||c.itemId.__type||(c.itemId=Object(k.a)(c.itemId)),Object(R.a)("CreateAttachmentFromUri",c,u);var c,u}var ne=Object(O.action)("createAttachmentFromUri")((function(e,t,n,r,a,i,o,c,s){const l=new u.b("AttachmentCreationFromUri");l.addCustomData({size:a?a.size:0});const d=e=>{o(e),l.end()},f=e=>{c(),l.endWithError("ServerError",e)};x(async(t,r,o,u)=>{try{if(0===i.attachmentType&&Object(h.B)(Object(h.l)(a.size),.05,e=>{Object(h.x)(i,e)},i.attachmentId),!await te(e,a.uri,a.name,t,n.IsInline,null))throw new Error("Empty response for createAttachmentFromUriProvider request")}catch(e){Object(h.C)(i.attachmentId,!1),c(),T(i,s.attachmentWellViewState,r,u)}},r=>{P(r,e,t,n,i,d,f,s)})})),re=n(8328);function ae(e,t,n){const r=Object(D.a)(e.mailboxInfo)||{};return Object(re.a)({itemId:e,attachmentDataProviderId:n.providerId,location:n.location,attachmentId:n.fileId||"",dataProviderParentItemId:n.fileParentId||"",providerEndpointUrl:n.providerEndpointUrl,cancellationId:t,thumbnailUrl:n.thumbnailUrl,previewUrl:n.previewUrl,isFolder:n.isFolder,mimeType:n.type},r)}var ie=n(2118),oe=Object(u.r)({name:"AttachmentCreationCloudyFromAttachmentDataProvider",customData:(e,t,n,r,a)=>[n.providerType,n.fileType]},(async function e(t,n,r,i,o){return 0===i.attachmentType&&Object(h.B)(4e3,.05,e=>{Object(h.x)(i,e)},i.attachmentId),ae(t,n,r).then(async c=>{const u=c.ResponseMessages.Items.length>0?c.ResponseMessages.Items[0]:null;if(u&&u.Attachments.length>0){return Object(h.C)(i.attachmentId,!0),{attachment:u.Attachments[0],sharingInfo:c.SharingInformation}}if(Object(h.C)(i.attachmentId,!1),Object(Q.j)("doc-authContext")&&!o&&c.SharingInformation&&!Object(a.k)(c.SharingInformation.ClaimsChallenge)){const o=c.SharingInformation.ClaimsChallenge;if(!Object(a.k)(o)){try{const e=await ie.a.import();await e(o)}catch(e){throw $(u,c.SharingInformation.ResultCode.toString())}return e(t,n,r,i,!0)}}throw $(u)})}));const ce=B("/service.svc/CreateReferenceAttachmentFromLocalFile");async function ue(e,t,n,r,a,i,o,c,u,s){var l;const d={requestObject:(l={ParentItemId:e,FileName:t.Name,SubscriptionId:a,ChannelId:i,FileSizeInBytes:t.Size,SliceNumber:o,TotalSlices:c,CancellationId:n,FileContentToUpload:"",GroupSmtpAddress:u,UploadFolderId:s},Object.assign({__type:"CreateReferenceAttachmentFromLocalFileRequest:#Exchange"},l))};return await U(ce,d,"CreateReferenceAttachmentFromLocalFile",e.mailboxInfo,r,void 0)}var se=n(5248);var le=Object(u.r)(_.a.AttachmentCreationCloudyFromLocalFile,(function(e,t,n,r,a,i,o,c,u){x((t,o,s,l)=>{!async function(e,t,n,r,a,i,o,c,u,s,l,d){var f;const m=Math.ceil(r.size/s);Object(h.B)(Object(h.q)(r.size),.05,e=>{Object(h.x)(a,e)},a.attachmentId);let b=null;const p=null===(f=null==d?void 0:d.attachmentWellViewState)||void 0===f?void 0:f.groupId;if(p&&(b=Object(se.c)(p)?Object(se.c)(p).folderId:null,!b)){const e=await Object(se.b)(p,se.a.Group);e&&(b=e.folderId)}for(let f=0;f<m;f++){const O=0+f*s,g=Math.min(O+s,r.size),v=r.slice(O,g);try{if(!await ue(e,t,n,v,i,c,f,m,p,b))throw new Error("Empty response for createReferenceAttachmentFromLocalFile request")}catch(e){return Object(h.C)(a.attachmentId,!1),l(),void T(a,d.attachmentWellViewState,o,u)}}}(e,n,r,a,i,t,o,s,l,10485760,c,u)},r=>{P(r,e,t,n,i,o,c,u)})}));var de=n(1777),fe=n(5981),me=n(290),be=n(7153);function he(e,t,n,r,a,i,o,c){const s=new u.b("UploadLocalFileAndCreateCloudyAttachment",{timeout:3e5}),[{uploadPromise:l,cancel:d},f]=Object(be.a)(n.Name,i,a,({loaded:e,total:t})=>{const n=e/t;Object(h.x)(o,n)}),{model:{Id:m,EndPointUrl:b,Type:p}}=f;let O=!1;return{onCompletePromise:(async()=>{let a=null;try{const{errorResponse:i,result:d}=await l;if(i){const e=await i.text();throw new Error(`Unable to upload file with status code: ${i.status}; response: ${e}`)}const f=function(e,t,n,r){return{fileType:de.a.Cloud,name:e.name,size:e.size,providerId:t,providerType:n,location:pe(e,n),providerEndpointUrl:r,isFolder:!1,fileId:e.id,fileParentId:e.parentReference.id,thumbnailUrl:"",previewUrl:"",type:Object(fe.c)(e)}}(d,m,p,b),O=await ae(e,r,f),g=O.ResponseMessages.Items[0];if(g&&g.Attachments.length>0){Object(h.C)(o.attachmentId,!0);const r=g.Attachments[0];return A(o,t,n,r,e,O.SharingInformation,c.attachmentWellViewState),r}throw new Error(g.MessageText)}catch(e){if(Object(h.C)(o.attachmentId,!1),T(o,c.attachmentWellViewState),O)return null;throw a=e,e}finally{a?(new u.b("UploadLocalFileAndCreateCloudyAttachmentError",{isCore:!0}).endWithError(a),s.endWithError(a)):s.end()}})(),cancel:()=>{O=!0,d()}}}function pe(e,t){return 1===t?`${e.parentReference.path}/${e.name}`:Object(me.parse)(e.webUrl).path}var Oe=n(2917);const ge=14680064;function ve(e,t,n,r){e.addCustomData([t]),n?e.end():e.endWithError("ServerError",r)}function Ie(e,t,n,r,a,i={}){i.sliceSizeInBytes=i.sliceSizeInBytes||ge;const o=new u.b("AttachmentCreationClassicFromLocalFileSliced",{timeout:3e5}),{action:c,getLastResponseMessage:l}=function(e,t,n,r,a){let i=null,o=null;return{action:async(c,u,s)=>{o||(o=function(e){const t=[];for(let n=0;n<e;n++)t[n]=0;return t}(s));let l=null;0===a.attachmentType&&(l=function(e){o[u]=e.loaded;const t=o.reduce((e,t)=>e+t,0)/r.size;Object(h.x)(a,t)});const d=X(t),f=await K(e,d,n,c,l,{sliceNumber:u,totalSlices:s});if(i=f.ResponseMessages.Items[0],!function(e){return e&&e.Attachments.length>0&&e.Attachments[0]}(i))throw $(i);t=Object.assign(Object.assign({},t),{AttachmentId:i.Attachments[0].AttachmentId})},getLastResponseMessage:()=>i}}(e,t,n,r,a),{onCompletePromise:d,cancel:f}=Object(Oe.a)(r,c,{sliceSize:i.sliceSizeInBytes,numberOfSlicesToParallelize:1});let m=!1;return{onCompletePromise:d.then(e=>{switch(e){case 0:return ve(o,r.size,!0),{status:0,attachment:l().Attachments[0]};case 1:return{status:1};default:return Object(s.a)(e)}}).catch(e=>{if(m)return{status:1};throw ve(o,r.size,!1,e),e}),cancel:()=>{m=!0,f()}}}function Se(e,t,n,r,a,i,o={shouldShare:!1}){const c=r&&(r.fileType===de.a.Cloud||r.fileType===de.a.CloudSuggestion||r.fileType===de.a.ContextualSuggestion);let u=null;const l=Object.assign(Object.assign({},t.AttachmentId),{mailboxInfo:e.mailboxInfo}),{shouldShare:d}=o;let f=()=>{};if((m=r).fileType===de.a.AttachmentItem||m.fileType===de.a.AttachmentItemSuggestion||(m.fileType===de.a.Cloud||m.fileType===de.a.CloudSuggestion||m.fileType===de.a.ContextualSuggestion)&&4===m.providerType)u=ee(e,t,n,r,a,c).then(e=>e);else if(d||c){if(!d&&c){return{createAttachmentPromise:new Promise((o,c)=>{M(e,l,t,n,r,a,o,c,i)}),cancelCreateAttachment:f}}if(!d||!c){if(o.shouldShare&&o.shareProperties&&!o.shareProperties.groupMailboxId){const{onCompletePromise:c,cancel:u}=he(e,l,t,n,o.shareProperties.folderInfo,r.fileObject,a,i);return{createAttachmentPromise:c,cancelCreateAttachment:u}}return{createAttachmentPromise:new Promise((o,c)=>(le(e,l,t,n,r.fileObject,a,o,c,i),t)),cancelCreateAttachment:f}}u=oe(e,n,r,a)}else if(r&&r.fileType===de.a.Local&&r.fileObject){const{onCompletePromise:i,cancel:o}=Ie(e,t,n,r.fileObject,a);f=o,u=i.then(e=>{switch(e.status){case 0:return{attachment:e.attachment,sharingInfo:null};case 1:return null;default:return Object(s.a)(e)}})}else{if(r&&r.fileType===de.a.Uri){return{createAttachmentPromise:new Promise((o,c)=>{ne(e,l,t,n,r,a,o,c,i)}),cancelCreateAttachment:f}}u=Y(e,t,n,r&&r.fileType===de.a.Local?r.fileObject:null,a)}var m;return function(e,t,n,r,a,i,o){return{createAttachmentPromise:i.then(i=>i?(A(r,t,n,i.attachment,e,i.sharingInfo,a.attachmentWellViewState),i.attachment):null).catch(e=>{throw T(r,a.attachmentWellViewState,null,null),e}),cancelCreateAttachment:o}}(e,l,t,a,i,u,f)}var we=n(6597);function je(e){return t={cancellationId:e},Object(R.a)("CancelAttachment",t,n);var t,n}const ye="ErrorNonExistentMailbox";var Ce=n(1778);function Ae(e){if(null==e)return null;switch(e){case 0:return Ce.i;case 5:return Ce.e;case 1:return Ce.h;case 2:return Ce.b;case 3:return Ce.a;case 7:return Ce.j;case 9:return Ce.k;case 8:return Ce.l;case 4:return Ce.f;case 6:return Ce.c;case 10:return Ce.g;default:return Object(s.a)(e)}}var Te=n(2890),Pe=n(6083),Ee=n(7608),xe=n(7609),Re=n(6468),ke=n(6458),De=n(2036);function Ne(e,t){const n=Object(l.a)(e.item.attachmentId);if(n){!function(e,t,n){Object(De.a)(n,e,[t])}("WarningAttachmentsCanNotBeDeleted",Object(a.c)(Object(a.b)(ke.a),n.model.Name),t)}}var Fe=n(1804),Me=n(9892);const _e=4;function Le(e,t,n){Object(De.a)(n,e,[t])}function Ue(e,t){const n=(r=e=>e.reason,e.reduce((e,t)=>{const n=r(t);return e[n]?e[n].push(t):e[n]=[t],e},{}));var r;Object.keys(n).forEach(e=>{const r=n[e];switch(parseInt(e)){case 0:!function(e,t){let n=null,r=null;if(1===e.length&&null!==e[0].item.tryAgainCallback){const n=e[0],r=n.item.file.name,i=Object(a.c)(Object(a.b)(Me.e),r),o={key:"WarningFilesCanNotBeAttachedWithNamesGenericError",source:Fe.c.Compose,rank:Fe.b.Info,message:i,messageParts:[i]},c={text:Object(a.b)(Me.a),action:()=>n.item.tryAgainCallback()};return o.messageParts.push(c),void Object(De.a)(t,"WarningFilesCanNotBeAttachedWithNamesGenericError",e=>o)}if(e.length<_e){const t=e.map(e=>e.item.file.name).join(", ");r="WarningFilesCanNotBeAttachedWithNamesGenericError",n=Object(a.c)(Object(a.b)(Me.b),t)}else r="WarningSeveralFilesCanNotBeAttachedGenericError",n=Object(a.c)(Object(a.b)(Me.d),e.length);Le(r,n,t)}(r,t);break;case 1:!function(e,t){Le("WarningFilesCannotBeAttachedFromOtherMailboxes",Object(a.b)(Me.c),t)}(0,t);break;case 2:!function(e,t){Le("WarningSpecialCharactersAreNotSupported",Object(a.b)(Me.f),t)}(0,t)}})}class Ve{constructor(e,t,n,r=null,a=null){this.attachmentWellViewState=e,this.parentItemId=t,this.infoBar=n,this.onAnyAttachmentCreatedInParentItemCallback=r,this.onAnyAttachmentDeletedInParentItemCallback=a,this.uploadQueue=[],this.deleteQueue=[],this.uploadFailures=[],this.onFinishPromise=new Promise((e,t)=>{this.onFinish=function(t){e(t)}})}enqueueAttachmentCreation(e,t,n=null,r=null,a=null){const{isInline:i,shouldShare:o,isHiddenInline:s,skipProcessInlineImage:l}=t;if(Object(c.a)(this.infoBar),!o&&Object(m.a)(e,this.attachmentWellViewState,this.infoBar))return i&&Object(u.o)("InlineImageFailure",{reason:"OverSizeLimit"}),[];e=Object(f.a)(e,i,this.infoBar);for(let c,u=0;c=e[u];u++){let e,u=null;const d={Name:null,ContentType:null,ContentId:null,ContentLocation:null,AttachmentOriginalUrl:null,Size:0,LastModifiedTime:null,IsInline:!1,IsInlineToUniqueBody:!1,IsInlineToNormalBody:!1,ThumbnailMimeType:null,Thumbnail:null};if(o){const t=c;e=Object(Re.a)(Object.assign(Object.assign({},d),{Name:t.name,Size:t.size,ContentType:t.type,ProviderType:Ae(t.providerType),AttachmentIsFolder:t.isFolder,IsInline:!1,PermissionType:0,AttachLongPathName:null,ProviderEndpointUrl:null,AttachmentThumbnailUrl:null,AttachmentPreviewUrl:null,OriginalPermissionType:0})),0===t.providerType&&(e.AttachmentOriginalUrl=t.location)}else if(c.fileType===de.a.Base64InlineImage){const t=c;e=Object(Te.a)(Object.assign(Object.assign({},d),{Name:t.name,Size:t.size,ContentType:t.type,IsInline:!0,Content:t.dataUri,IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),u=t.tempId}else if(c.fileType===de.a.MailItem){const t=c;if(t.mimeContent)e=Object(Ee.a)(Object.assign(Object.assign({},d),{Name:c.name,Size:c.size,IsInline:!1,Item:Object(Pe.a)({MimeContent:Object(xe.a)({Value:t.mimeContent})}),ContentType:"message/rfc822"}));else{const n=Object(k.a)({Id:t.itemId});e=Object(Z.a)(Object.assign(Object.assign({},d),{Name:c.name,IsInline:!1,ItemId:n,Size:c.size,AttachmentIdToAttach:null,CreateAttachmentInlineType:0}))}}else if(c.fileType===de.a.AttachmentItem||c.fileType===de.a.AttachmentItemSuggestion){const t=c;e=Object(Z.a)(Object.assign(Object.assign({},d),{Name:t.name,AttachmentIdToAttach:t.attachmentItemId,__type:t.type,Size:c.size,ItemId:null,CreateAttachmentInlineType:0}))}else c.fileType===de.a.Uri?e=Object(Te.a)(Object.assign(Object.assign({},d),{Name:c.name,AttachmentOriginalUrl:c.uri,Size:c.size,ContentType:c.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})):(e=Object(Te.a)(Object.assign(Object.assign({},d),{Name:c.name,Size:c.size,ContentType:c.type,IsInline:i,Content:"",IsContactPhoto:!1,ImageThumbnailSalientRegions:null,ImageThumbnailHeight:0,ImageThumbnailWidth:0})),u=c.tempId);const f={Id:u||Object(E.a)(),mailboxInfo:this.parentItemId.mailboxInfo};let m;i?m=Object(h.i)(f,f.Id,s,0,l):(m=Object(h.g)(f,!1,!1,o,c.fileType,!0),t.isAddedFromSmartDoc&&(m.fileType=de.a.SmartDoc),t.isAddedFromSonora&&(m.fileType=de.a.Sonora),this.attachmentWellViewState.supportedMenuActions&&(m.strategy.supportedMenuActions=this.attachmentWellViewState.supportedMenuActions),t.downsellFromLink&&Object(h.A)(m,6,11)),Object(b.a)(m,this.attachmentWellViewState,e,f);const O={attachmentState:m,file:c,attachment:e,shouldShareInfo:t,cancelPendingUpload:()=>{},onAttachmentCreatedCallback:n,onAttachmentCanceledOrFailedCallback:r,tryAgainCallback:a};p.h.info("Attachment: UploadQueue enqueue attachment: Name="+c.name),this.uploadQueue.push(O)}return this.startProcessIfNotStarted(),e}deleteAttachment(e,t=null){Object(c.a)(this.infoBar);const n=1===e.attachmentType,r=n?0===e.status:e.actionCompletePercent<=1;if(n||Object(h.A)(e,3,r?10:6),r&&this.currentUploadItem)if(this.currentUploadItem.attachmentState.attachmentId===e.attachmentId){p.h.info("Attachment: Cancelling attachment: TempId="+e.attachmentId);const n=this.currentUploadItem;if(n.cancelPendingUpload(),0===e.attachmentType&&e.isCloudy){if(p.h.info(`Attachment: Put attachment: Id= ${e.attachmentId} into deleteQueue`),0===this.deleteQueue.filter(t=>t.attachmentState.attachmentId===e.attachmentId).length){const n={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(n)}this.startProcessIfNotStarted()}else this.isCancelling||(this.isCancelling=!0,je(e.attachmentId.Id).then(t=>{this.isCancelling=!1,t?(Object(w.a)(this.attachmentWellViewState,e),n.onAttachmentCanceledOrFailedCallback&&n.onAttachmentCanceledOrFailedCallback(!0)):this.onAttachmentDeleteFailure(e)}))}else p.h.info("Attachment: Removing attachment: TempId= "+e.attachmentId+" from queue"),function(e,t){for(let n=0;n<t.length;n++){const r=t[n];r.attachmentState.attachmentId===e.attachmentId&&(r.onAttachmentCanceledOrFailedCallback&&r.onAttachmentCanceledOrFailedCallback(!0),t.splice(n,1))}}(e,this.uploadQueue),Object(w.a)(this.attachmentWellViewState,e);else{if(p.h.info(`Attachment: Put attachment: Id= ${e.attachmentId} into deleteQueue`),0===this.deleteQueue.filter(t=>t.attachmentState.attachmentId===e.attachmentId).length){const n={attachmentState:e,onAttachmentDeletedCallback:t};this.deleteQueue.push(n)}this.startProcessIfNotStarted()}}onAttachmentDeleteFailure(e){var t,n;t={item:e,reason:0},(n=this.infoBar)&&(Object(c.a)(n),Ne(t,n)),1!==e.attachmentType&&Object(h.A)(e,0,0),p.h.warn("Attachment: Failed to cancel attachment: TempId="+e.attachmentId)}startProcessIfNotStarted(){this.isInProgress||(this.datapoint=new u.b("AttachmentQueueManager"),this.isInProgress=!0,this.processNextAttachment("NewProcess"))}processNextAttachment(e){if(p.h.info("Attachment: Invoking processNextAttachment from: "+e),0!==this.deleteQueue.length){const{attachmentState:e,onAttachmentDeletedCallback:t}=this.deleteQueue[0],n=Object(l.a)(e.attachmentId);p.h.info("Attachment: Deleting attachment: Id= "+e.attachmentId),Object(we.a)(this.attachmentWellViewState,e,this.parentItemId,e.fileType).then(()=>{this.deleteQueue.shift(),Be(t,this.parentItemId,e.attachmentId,n.model),Be(this.onAnyAttachmentDeletedInParentItemCallback,this.parentItemId,e.attachmentId,n.model),this.processNextAttachment("DeleteAttachmentFinish")}).catch(t=>{this.deleteQueue.shift(),this.onAttachmentDeleteFailure(e),this.logDeletionFailure(t.message,e),this.processNextAttachment("DeleteAttachmentFinish")})}else if(0!==this.uploadQueue.length){this.currentUploadItem=this.uploadQueue.shift();const e=this.currentUploadItem.onAttachmentCreatedCallback,t={attachmentWellViewState:this.attachmentWellViewState,parentItemId:this.parentItemId,infoBar:this.infoBar},{createAttachmentPromise:n,cancelCreateAttachment:r}=Se(this.parentItemId,this.currentUploadItem.attachment,this.currentUploadItem.attachmentState.attachmentId.Id,this.currentUploadItem.file,this.currentUploadItem.attachmentState,t,this.currentUploadItem.shouldShareInfo);this.currentUploadItem.cancelPendingUpload=r,n.then(t=>{if(t){const n=Object.assign(Object.assign({},t.AttachmentId),{mailboxInfo:this.parentItemId.mailboxInfo});Be(e,this.parentItemId,n,t),Be(this.onAnyAttachmentCreatedInParentItemCallback,this.parentItemId,n,t)}this.processNextAttachment("CreateAttachmentFinish")}).catch(e=>{let t=0;(null==e?void 0:e.message)===F.c&&(t=2),e&&e.errorCode===ye&&(t=1),this.uploadFailures.push({item:this.currentUploadItem,reason:t}),this.currentUploadItem.onAttachmentCanceledOrFailedCallback&&this.currentUploadItem.onAttachmentCanceledOrFailedCallback(!1),this.logCreationFailure(),this.processNextAttachment("CreateAttachmentFinish")})}else this.finishProcess()}finishProcess(){p.h.info("Attachment: AttachmentQueueManager: finishProcess"),this.isInProgress=!1;const e=this.currentUploadItem&&this.currentUploadItem.attachmentState?this.currentUploadItem.attachmentState.attachmentId:null;this.currentUploadItem=null,this.onFinish(e),this.datapoint.end(),this.datapoint=null,Ue(this.uploadFailures,this.infoBar),this.uploadFailures=[]}logCreationFailure(){Object(u.o)("AttachmentCreationFailure")}logDeletionFailure(e,t){Object(u.o)("AttachmentDeletionFailure",[e],{cosmosOnlyData:JSON.stringify({attachmentId:t.attachmentId.Id})})}}function Be(e,t,n,r){e&&e(t,n,r)}n.d(t,"a",(function(){return Ge})),n.d(t,"b",(function(){return He}));const We={};function Ge(e,t,n,i,o={isInline:!1,isHiddenInline:!1,shouldShare:!1,skipProcessInlineImage:!1},s,l,f,m,b){if(!t)return Object(c.a)(i),Object(De.a)(i,"WarningFilesCanNotBeAttachedGenericError",[Object(a.b)(r.a)]),[];const h=ze(e,t,i,s),{isInline:p,shouldShare:O}=o;return function(e,t,n,r){for(let a=0;a<e.length;a++){const i=e[a];Object(u.o)("AttachmentCreation",[n,r],{cosmosOnlyData:JSON.stringify({fileType:i.fileType,size:i.size,ext:Object(d.d)(i.name)||"",logTraceId:t})})}}(n,b,p,O),h.enqueueAttachmentCreation(n,o,l,f,m)}function He(e,t,n,r,a){const i=ze(e,n,r);!function(e){const t=e.attachmentType;switch(t){case 1:Object(u.o)("AttachmentDeletion",[!0,!1,0]);break;case 0:const n=Object(l.a)(e.attachmentId);Object(u.o)("AttachmentDeletion",[!1,e.isCloudy],{cosmosOnlyData:JSON.stringify({size:n.model.Size})});break;default:Object(s.a)(t)}}(t),i.deleteAttachment(t,a)}function ze(e,t,n,r){let a=We[t.Id];return a||(a=function(e,t,n,r=null,a=null){return new Ve(e,t,n,r,a)}(e,t,n,i.a,o.a),We[t.Id]=a,a.onFinishPromise.then(e=>{delete We[t.Id],r&&r(e)})),a}},7586:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(5936);function a(e){if(!e)return e;const t=e.toLowerCase().charCodeAt(0);if(t>=97&&t<=122&&-1===e.indexOf("#")&&-1===e.indexOf("-"))try{return atob(e)}catch(e){}let n="",a=0;const i=()=>{const t=e.charAt(a++);switch(t){case"\r":case"\n":return i();default:return t}};for(;a<e.length;){const e=r.a.indexOf(i()),t=r.a.indexOf(i()),a=r.a.indexOf(i()),o=r.a.indexOf(i()),c=e<<2|t>>4,u=(15&t)<<4|a>>2,s=(3&a)<<6|o;n+=String.fromCharCode(c),64!=a&&(n+=String.fromCharCode(u)),64!=o&&(n+=String.fromCharCode(s))}return n}},7607:function(e){e.exports=JSON.parse('{"a":"Cda"}')},7608:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemAttachment:#Exchange"},e)}n.d(t,"a",(function(){return r}))},7609:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"MimeContentType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},7628:function(e){e.exports=JSON.parse('{"a":"k0b"}')},7629:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1713),a=n(1696),i=n(5521);function o(e){const t=Object(r.a)(e),n=Object(a.c)(t.model.Name||"");return""!==Object(i.a)(n)&&"Visio"!==Object(i.a)(n)}},7630:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(624),a=n(47);function i(){return Object(a.j)("woven-newTabExperiment")&&Object(r.d)()}},7631:function(e,t,n){"use strict";t.a={SurfaceAction:"Surface action",ContextMenu:"Context menu"}},811:function(e,t,n){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:t,timeBetweenRetryInMS:n}=e;return e=>{let r=0,a=!1;const i=(o,c)=>{a?c(new Error("The function retry was cancelled")):(r++,e().then(e=>o(e)).catch(e=>{t&&r>=t?c(e):setTimeout(()=>i(o,c),n(r))}))};return{retriableFunc:()=>new Promise((e,t)=>i(e,t)),cancel:()=>a=!0}}}function a(e){return t=>Math.pow(2,t)*e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}))},817:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(618);function a(e){return i(e.source,Object(r.a)(e.source,e.start))}function i(e,t){var n=e.locationOffset.column-1,r=c(n)+e.body,a=t.line-1,i=e.locationOffset.line-1,u=t.line+i,s=1===t.line?n:0,l=t.column+s,d="".concat(e.name,":").concat(u,":").concat(l,"\n"),f=r.split(/\r\n|[\n\r]/g),m=f[a];if(m.length>120){for(var b=Math.floor(l/80),h=l%80,p=[],O=0;O<m.length;O+=80)p.push(m.slice(O,O+80));return d+o([["".concat(u),p[0]]].concat(p.slice(1,b+1).map((function(e){return["",e]})),[[" ",c(h-1)+"^"],["",p[b+1]]]))}return d+o([["".concat(u-1),f[a-1]],["".concat(u),m],["",c(l-1)+"^"],["".concat(u+1),f[a+1]]])}function o(e){var t=e.filter((function(e){e[0];return void 0!==e[1]})),n=Math.max.apply(Math,t.map((function(e){return e[0].length})));return t.map((function(e){var t,r=e[0],a=e[1];return c(n-(t=r).length)+t+(a?" | "+a:" |")})).join("\n")}function c(e){return Array(e+1).join(" ")}},8326:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(8327),a=n(2036),i=n(6),o=n(4467),c=n(1777),u=n(1696);function s(e,t,n,r){const i=[],o=[];if(e.forEach(e=>{n(e)?i.push(e):o.push(e)}),t&&o.length>0){const e=o.map(e=>e.name).join(", "),{messageId:n,message:i}=r(e);Object(a.a)(t,n,[i])}return i}function l(e,t,n){Object(o.a)(n);let a=[];for(let t=0;t<e.length;t++)a.push(e[t]);return a=function(e,t){return s(e,t,e=>!(e.fileType===c.a.Local&&0===e.size),(function(e){return{messageId:"WarningEmptyFilesCanNotBeAttached",message:Object(i.c)(Object(i.b)(r.a),e)}}))}(a,n),t&&(a=function(e,t){return s(e,t,e=>Object(u.g)(e.name,e.type),(function(e){return{messageId:"WarningInlineImageTypeNotSupported",message:Object(i.c)(Object(i.b)(r.b),e)}}))}(a,n)),a}},8327:function(e){e.exports=JSON.parse('{"a":"tea","b":"uea"}')},8328:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),a=n(905);function i(e,t){return void 0===e.itemId||e.itemId.__type||(e.itemId=Object(a.a)(e.itemId)),Object(r.a)("CreateReferenceAttachmentFromAttachmentDataProvider",e,t)}},8329:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1777),a=n(1738),i=n(1732);function o(e){if(Object(a.a)(e)){const t=e;return{fileType:r.a.Cloud,name:t.Name,size:t.Size,providerId:"",providerType:4,location:t.AttachLongPathName,providerEndpointUrl:"",isFolder:!1,thumbnailUrl:t.AttachmentThumbnailUrl,previewUrl:t.AttachmentPreviewUrl,fileId:t.AttachmentId.Id,fileParentId:"",type:t.ContentType}}return{attachmentItemId:e.AttachmentId.Id,name:e.Name,size:e.Size,fileType:r.a.AttachmentItem,type:i.c,EmbeddedItemClass:e.EmbeddedItemClass,ContentType:e.ContentType}}},8447:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n(8931),a=n(2914),i=n(2915);const o={};let c=null;function u(e,t){o[e.attachmentId.Id]&&(clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=null),c=e.attachmentId.Id,Object(r.a)(e,!0),t&&!Object(i.a)(e)&&Object(a.a)(e,!0)}function s(e,t){o[e.attachmentId.Id]&&clearTimeout(o[e.attachmentId.Id]),o[e.attachmentId.Id]=setTimeout(()=>{Object(r.a)(e,!1),t&&!Object(i.a)(e)&&Object(a.a)(e,!1),e.attachmentId.Id===c&&(c=null),o[e.attachmentId.Id]=null},40)}function l(e,t){Object(r.a)(e,!0),t&&!Object(i.a)(e)&&Object(a.a)(e,!0)}function d(e,t){e.attachmentId.Id!==c&&(Object(r.a)(e,!1),t&&!Object(i.a)(e)&&Object(a.a)(e,!1))}},8448:function(e,t,n){"use strict";var r=n(1692);t.a=function(e){var t,n;const a=e&&Object(r.v)(e);return null===(n=null===(t=(null==a?void 0:a.From)||(null==a?void 0:a.Sender))||void 0===t?void 0:t.Mailbox)||void 0===n?void 0:n.EmailAddress}},8931:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setShouldShowActionsContainer")((function(e,t){e.shouldShowActionsContainer=t}))},8932:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(282),a=n(1928),i=n(8933),o=n(47),c=n(296),u=n(4581),s=n(4053),l=n(7629),d=n(7630);function f(e,t){if(0!==t.ongoingAction||!t.strategy.showActionsMenu)return!0;switch(e){case u.a.addToCalendar:return!1;case u.a.download:return!Object(s.a)(a.a.Download,t)||!Object(i.a)(t);case u.a.saveToCloud:case u.a.openNewTabAndSaveToCloud:return!t.isReadOnly||!function(e,t){var n;const r=Object(c.a)()&&"GroupMailbox"===(null===(n=e.attachmentId.mailboxInfo)||void 0===n?void 0:n.type);let i=!1;i=t===u.a.openNewTabAndSaveToCloud?Object(d.a)()&&Object(l.a)(e.attachmentId):Object(o.j)("woven-saveToCloud2-viewInOneDrive")||Object(o.j)("woven-saveToCloud2-editInOneDrive")||Object(o.j)("woven-saveToCloud2-editInApp")||Object(o.j)("woven-saveToCloud2-editOnline")||Object(o.j)("woven-saveToCloud2-openFolder")||Object(d.a)();return i&&Object(s.a)(a.a.SaveToCloud,e)&&Object(a.t)(e)&&!r}(t,e);case u.a.editAndReply:return!t.isReadOnly||!Object(l.a)(t.attachmentId);case u.a.openAndEdit:return!t.isReadOnly||2!==t.actionMessage&&3!==t.actionMessage;default:return Object(r.a)(e)}}},8933:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1798),a=n(1713),i=n(6472);function o(e){var t;const n=Object(a.a)(e.attachmentId);return!!n&&(!!Object(r.c)(n.model)||n.download.url&&(null===(t=n.info)||void 0===t?void 0:t.allowDownload)&&!Object(i.a)(e.attachmentId))}},8934:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var r=n(7209),a=n(6),i=n(71),o=n(1928),c=n(3016),u=n(1753),s=n(7631),l=n(1713),d=n(2604),f=n(4053);function m(e,t){const n=Object(l.a)(e.attachmentId),r=Object(d.a)(n);Object(i.o)("AddToCalendar",[t],{cosmosOnlyData:JSON.stringify({size:n.model.Size,fileType:r})}),n.model.Size>10485760||!e.attachmentId||!e.attachmentId.Id?Object(u.a)(e,0,15):(Object(o.B)(Object(o.j)(n.model.Size),.1,t=>{Object(o.x)(e,t)},e.attachmentId),Object(c.a)(e,0))}function b(e){const t=Object(l.a)(e.attachmentId);return Object(f.a)(o.a.ImportCalendarEventAttachment,e)&&t&&13===t.attachmentClass?{name:Object(a.b)(r.a),key:"AddToCalendar",iconProps:{iconName:"AddEvent"},onClick:()=>{m(e,s.a.ContextMenu)}}:null}},908:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},919:function(e,t,n){"use strict";var r=n(931),a=n(940);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,c=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,c&&Object(a.a)(n[0],n[1],c)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var u=n[r];u&&e(t,u,r,o)}return t}))}},920:function(e){e.exports=JSON.parse('{"a":{"AccountEntry":["AccountLocalFile","AccountMailbox","AccountSource"],"AppendOnSend":[],"Attachment":["BasicAttachment","ReferenceAttachment"],"AttachmentTypeUnion":["BasicAttachment","ReferenceAttachment"],"CalendarEntry":["LinkedCalendarEntry","LocalCacheForRemoteCalendarEntry","LocalCalendarEntry"],"Connection":["ConversationRowConnection","ConversationToConversationNodesConnection","ItemRowConnection"],"ConversationNodeItem":["Item","Message","MeetingMessage","MeetingResponseMessage","MeetingRequestMessage","MeetingCancellationMessage"],"ConversationRowByIdResult":["ConversationType","NotFound"],"CopyMoveGroupFolderResult":["CopyMoveGroupFolderResponse","ErrorMessage"],"CreateAccountResult":["AccountSource","AccountCreationFailure"],"CreateFolderResult":["FolderId","AccessDenied"],"CreateGroupFolderResult":["CreateGroupFolderResponse","ErrorMessage"],"DeleteGroupFolderResult":["DeleteGroupFolderResponse","ErrorMessage"],"Edge":["ConversationConversationNodesEdge","ConversationRowEdge","ItemRowEdge"],"GenericItem":["CalendarItem","Item","MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"GenericMeetingMessage":["MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage"],"GenericMessage":["MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"GetItemResponseType":["Item","Message","MeetingMessage","MeetingResponseMessage","MeetingRequestMessage","MeetingCancellationMessage"],"IntervalRecurrencePatternBase":["AbsoluteMonthlyRecurrence","DailyRecurrence","RegeneratingPatternBaseType","RelativeMonthlyRecurrence","WeeklyRecurrence"],"M365Application":["M365HubApplication","M365PlatformApplication"],"M365ApplicationBadge":["M365ApplicationNumericBadge"],"M365ApplicationIcon":["InternalIcon","RemoteImage"],"MailFolderPermissions":["MailFolder"],"Node":["CalendarEvent","CalendarItem","Conversation","ConversationNode","ConversationType","Draft","Item","ItemRow","MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"NotificationPayload":["GroupFolderHierarchyNotificationPayload","HierarchyNotificationPayload","RowNotificationChangePayload","RowNotificationDeletePayload","UnreadItemNotificationPayload"],"PropertyPath":["BuiltInPropertyUri","ExtendedPropertyUri"],"RecurrencePatternType":["AbsoluteYearlyRecurrence","AbsoluteMonthlyRecurrence","DailyRecurrence","RegeneratingPatternBaseType","RelativeYearlyRecurrence","RelativeMonthlyRecurrence","WeeklyRecurrence"],"RecurrenceRangeBase":["EndDateRecurrence","NoEndRecurrence","NumberedRecurrence"],"RecurrenceRangeType":["EndDateRecurrence","NoEndRecurrence","NumberedRecurrence"],"RenameGroupFolderResult":["RenameGroupFolderResponse","ErrorMessage"],"RowNotificationPayload":["RowNotificationChangePayload","RowNotificationDeletePayload"],"UndoableActionResult":["CategorizeConversationResult","CategorizeItemResult","DeleteConversationResult","DeleteItemResult","MarkItemAsJunkResult","MoveConversationResult","MoveItemResult","ScheduleConversationResult"],"calendarsUnionType":["LocalCalendarEntry","LinkedCalendarEntry","LocalCacheForRemoteCalendarEntry"]}}')},921:function(e,t,n){"use strict";var r=n(471),a=n(575),i=n(406);var o=function(e,t,n){(void 0===n||Object(i.a)(e[t],n))&&(void 0!==n||t in e)||Object(a.a)(e,t,n)},c=n(939),u=n(948),s=n(949),l=n(947),d=n(951),f=n(520),m=n(262),b=n(934),h=n(518),p=n(565),O=n(252),g=n(950),v=n(574);var I=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},S=n(909),w=n(708);var j=function(e){return Object(S.a)(e,Object(w.a)(e))};var y=function(e,t,n,r,a,i,c){var S=I(e,n),w=I(t,n),y=c.get(w);if(y)o(e,n,y);else{var C=i?i(S,w,n+"",e,t,c):void 0,A=void 0===C;if(A){var T=Object(m.a)(w),P=!T&&Object(h.a)(w),E=!T&&!P&&Object(v.a)(w);C=w,T||P||E?Object(m.a)(S)?C=S:Object(b.a)(S)?C=Object(l.a)(S):P?(A=!1,C=Object(u.a)(w,!0)):E?(A=!1,C=Object(s.a)(w,!0)):C=[]:Object(g.a)(w)||Object(f.a)(w)?(C=S,Object(f.a)(S)?C=j(S):Object(O.a)(S)&&!Object(p.a)(S)||(C=Object(d.a)(w))):A=!1}A&&(c.set(w,C),a(C,w,r,i,c),c.delete(w)),o(e,n,C)}};var C=function e(t,n,a,i,u){t!==n&&Object(c.a)(n,(function(c,s){if(u||(u=new r.a),Object(O.a)(c))y(t,n,s,a,e,i,u);else{var l=i?i(I(t,s),c,s+"",t,n,u):void 0;void 0===l&&(l=c),o(t,s,l)}}),w.a)},A=n(919),T=Object(A.a)((function(e,t,n){C(e,t,n)}));t.a=T},931:function(e,t,n){"use strict";var r=n(568),a=n(943),i=n(941);t.a=function(e,t){return Object(i.a)(Object(a.a)(e,t,r.a),e+"")}},934:function(e,t,n){"use strict";var r=n(402),a=n(306);t.a=function(e){return Object(a.a)(e)&&Object(r.a)(e)}},938:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return"object"==r(e)&&null!==e}n.d(t,"a",(function(){return a}))},939:function(e,t,n){"use strict";var r=function(e){return function(t,n,r){for(var a=-1,i=Object(t),o=r(t),c=o.length;c--;){var u=o[e?c:++a];if(!1===n(i[u],u,i))break}return t}}();t.a=r},940:function(e,t,n){"use strict";var r=n(406),a=n(402),i=n(577),o=n(252);t.a=function(e,t,n){if(!Object(o.a)(n))return!1;var c=typeof t;return!!("number"==c?Object(a.a)(n)&&Object(i.a)(t,n.length):"string"==c&&t in n)&&Object(r.a)(n[t],e)}},941:function(e,t,n){"use strict";var r=function(e){return function(){return e}},a=n(578),i=n(568),o=a.a?function(e,t){return Object(a.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i.a,c=800,u=16,s=Date.now;var l=function(e){var t=0,n=0;return function(){var r=s(),a=u-(r-n);if(n=r,a>0){if(++t>=c)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(o);t.a=l},943:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},a=Math.max;t.a=function(e,t,n){return t=a(void 0===t?e.length-1:t,0),function(){for(var i=arguments,o=-1,c=a(i.length-t,0),u=Array(c);++o<c;)u[o]=i[t+o];o=-1;for(var s=Array(t+1);++o<t;)s[o]=i[o];return s[t]=n(u),r(e,this,s)}}},946:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return O}));var r=n(938),a=n(714),i=n(618),o=n(817);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,h(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b(r,e)})(e)}function f(e,t,n){return(f=m()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&b(a,n.prototype),a}).apply(null,arguments)}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(p,e);var t,n,o,c,d,f=(t=p,n=m(),function(){var e,r=h(t);if(n){var a=h(this).constructor;e=Reflect.construct(r,arguments,a)}else e=r.apply(this,arguments);return s(this,e)});function p(e,t,n,a,o,c,u){var d,m,b,h,O;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),O=f.call(this,e);var g,v=Array.isArray(t)?0!==t.length?t:void 0:t?[t]:void 0,I=n;!I&&v&&(I=null===(g=v[0].loc)||void 0===g?void 0:g.source);var S,w=a;!w&&v&&(w=v.reduce((function(e,t){return t.loc&&e.push(t.loc.start),e}),[])),w&&0===w.length&&(w=void 0),a&&n?S=a.map((function(e){return Object(i.a)(n,e)})):v&&(S=v.reduce((function(e,t){return t.loc&&e.push(Object(i.a)(t.loc.source,t.loc.start)),e}),[]));var j=u;if(null==j&&null!=c){var y=c.extensions;Object(r.a)(y)&&(j=y)}return Object.defineProperties(l(O),{name:{value:"GraphQLError"},message:{value:e,enumerable:!0,writable:!0},locations:{value:null!==(d=S)&&void 0!==d?d:void 0,enumerable:null!=S},path:{value:null!=o?o:void 0,enumerable:null!=o},nodes:{value:null!=v?v:void 0},source:{value:null!==(m=I)&&void 0!==m?m:void 0},positions:{value:null!==(b=w)&&void 0!==b?b:void 0},originalError:{value:c},extensions:{value:null!==(h=j)&&void 0!==h?h:void 0,enumerable:null!=j}}),null!=c&&c.stack?(Object.defineProperty(l(O),"stack",{value:c.stack,writable:!0,configurable:!0}),s(O)):(Error.captureStackTrace?Error.captureStackTrace(l(O),p):Object.defineProperty(l(O),"stack",{value:Error().stack,writable:!0,configurable:!0}),O)}return o=p,(c=[{key:"toString",value:function(){return O(this)}},{key:a.c,get:function(){return"Object"}}])&&u(o.prototype,c),d&&u(o,d),p}(d(Error));function O(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var a=r[n];a.loc&&(t+="\n\n"+Object(o.a)(a.loc))}else if(e.source&&e.locations)for(var i=0,c=e.locations;i<c.length;i++){var u=c[i];t+="\n\n"+Object(o.b)(e.source,u)}return t}},950:function(e,t,n){"use strict";var r=n(347),a=n(712),i=n(306),o="[object Object]",c=Function.prototype,u=Object.prototype,s=c.toString,l=u.hasOwnProperty,d=s.call(Object);t.a=function(e){if(!Object(i.a)(e)||Object(r.a)(e)!=o)return!1;var t=Object(a.a)(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&s.call(n)==d}},953:function(e,t,n){"use strict";var r=n(713),a=n(36);function i(e){var t;const n={};return null===(t=null==e?void 0:e.Items)||void 0===t||t.forEach(e=>{e.Id&&(n[e.Id]=e.Value)}),n}const o=e=>{switch(e){case 0:return"Business";case 1:return"ExoConsumer";case 2:return"GMail";default:return null}},c=e=>{switch(e){case 1:return"Disabled";case 2:return"Enabled";case 0:return"FirstRun";default:return null}},u=e=>{switch(e){case 1:return"Celsius";case 0:return"Default";case 2:return"Fahrenheit";default:return null}},s=e=>{switch(e){case 1:return"Disabled";case 2:return"Enabled";case 0:return"FirstRun";default:return null}},l=e=>{switch(e){case 2:return"EmailToast";case 8:return"FaxToast";case 0:return"None";case 1:return"Sound";case 4:return"VoiceMailToast";default:return null}},d=e=>{switch(e){case 7:return"All";case 1:return"Bold";case 2:return"Italic";case 0:return"Normal";case 4:return"Underline";default:return null}},f=e=>{switch(e){case 3:return"Gmail";case 0:return"Hotmail";case 1:return"Off";case 4:return"Owa";case 2:return"Yahoo";default:return null}},m=e=>{switch(e){case 2:return"CalendarItems";case 0:return"Conversation";case 1:return"Message";default:return null}},b=e=>{switch(e){case 1:return"Jsmvvm";case 0:return"None";case 2:return"React";default:return null}},h=e=>{switch(e){case 2:return"Archive";case 1:return"Delete";case 0:return"None";case 5:return"ToggleFlag";case 3:return"TogglePin";case 4:return"ToggleRead";default:return null}},p=e=>{switch(e){case 0:return"None";case 1:return"ExternalLink";case 2:return"DeleteFlaggedMessage";case 4:return"DeleteFlaggedContacts";case 8:return"DeleteFlaggedItems";case 16:return"DeleteOutlookDisabledRules";case 32:return"DisabledRulesLeft";case 64:return"DeleteConversation";case 128:return"IgnoreConversation";case 256:return"CancelIgnoreConversation";case 512:return"FilteredByUnread";case 1024:return"DeleteAllClutter";case 2048:return"ShowFirstRunModalDialog";case 4096:return"StopShowConsumerPromotion";case 8192:return"ShowAdsEdgePromotionMiddle";case 16384:return"UseUCMALegacyChat";case 32768:return"DonotShowAds";case 65536:return"FocusedInboxFirstRunExperience";case 131072:return"ShowGroupsAppUpsellBanner";case 262144:return"HideUpNextAgendaButtonLabel";case 524288:return"FocusedInboxFeedback";case 1048576:return"NotO365HomesubscribedUser";case 2097152:return"SweepGreyEmails";case 4194304:return"ReactDefaultSettingsOverride";case 8388608:return"AdsExperiments";case 16777216:return"AdsDisplayOn";case 33554432:return"AdsNativeOn";case 67108864:return"AdsFocusOnOnly";case 134217728:return"ShowGetStartedPane";case 268435456:return"GdprAdsPrefNotSet";case 536870912:return"GetStartedEnabledViaNewUserPath";case 1073741824:return"OneNoteFeedEverInitialized";case 2147483647:return"All";default:return null}},O=e=>{switch(e){case 2:return"Archive";case 1:return"Delete";case 0:return"None";case 5:return"FlagUnflag";case 6:return"Move";case 3:return"PinUnpin";case 4:return"ReadUnread"}},g=e=>{switch(e){case 0:return"All";case 4:return"DistributionGroups";case 2:return"ExcludeFavorites";case 5:return"FamilyGroup";case 1:return"Favorites";case 3:return"PublicOnly";default:return null}},v=e=>{switch(e){case 0:return"MemberOfUnifiedGroups";case 1:return"OwnerOfDeletedUnifiedGroups";default:return null}},I=e=>{switch(e){case 3:return"DeleteAndAllowRecovery";case 5:return"MarkAsPastRetentionLimit";case 6:return"MoveToArchive";case 1:return"MoveToDeletedItems";case 2:return"MoveToFolder";case 0:return"None";case 4:return"PermanentlyDelete";default:return null}},S=e=>{switch(e){case 1:return"Calendar";case 2:return"Contacts";case 3:return"DeletedItems";case 4:return"Drafts";case 5:return"Inbox";case 6:return"JunkEmail";case 7:return"Journal";case 8:return"Notes";case 9:return"Outbox";case 10:return"SentItems";case 11:return"Tasks";case 12:return"All";case 13:return"ManagedCustomFolder";case 14:return"RssSubscriptions";case 15:return"SyncIssues";case 16:return"ConversationHistory";case 17:return"Personal";case 18:return"RecoverableItems";case 19:return"NonIpmRoot";default:return null}},w=e=>e?e.map(O):null,j=e=>Object.assign(Object.assign({},e),{FilterType:g(null==e?void 0:e.FilterType),GroupsSetType:v(null==e?void 0:e.GroupsSetType)}),y=e=>e?e.map(j):null,C=e=>Object.assign(Object.assign({},e),{WebSessionType:o(null==e?void 0:e.WebSessionType)}),A=e=>Object.assign(Object.assign({},e),{WeatherEnabled:c(null==e?void 0:e.WeatherEnabled),WeatherUnit:u(null==e?void 0:e.WeatherUnit),LocalEventsEnabled:s(null==e?void 0:e.LocalEventsEnabled),NewItemNotify:l(null==e?void 0:e.NewItemNotify),ComposeFontFlags:d(null==e?void 0:e.ComposeFontFlags),NewEnabledPonts:p(null==e?void 0:e.NewEnabledPonts),KeyboardShortcutsMode:f(null==e?void 0:e.KeyboardShortcutsMode),GlobalListViewTypeReact:m(null==e?void 0:e.GlobalListViewTypeReact),ClientTypeOptInState:b(null==e?void 0:e.ClientTypeOptInState),TasksClientTypeOptInState:b(null==e?void 0:e.TasksClientTypeOptInState)}),T=e=>Object.assign(Object.assign({},e),{TemperatureUnit:u(null==e?void 0:e.TemperatureUnit),MailLeftSwipeAction:h(null==e?void 0:e.MailLeftSwipeAction),MailRightSwipeAction:h(null==e?void 0:e.MailRightSwipeAction),MailTriageOnHoverActions:w(null==e?void 0:e.MailTriageOnHoverActions)}),P=e=>({UnifiedGroupsSets:y(null==e?void 0:e.UnifiedGroupsSets)}),E=e=>Object.assign(Object.assign({},e),{Type:S(e.Type),RetentionAction:I(e.RetentionAction)}),x=e=>e?e.map(E):null;var R=n(921);const k=new Map;function D(e,t,n){t=t||r.a;try{if(e){const r=function(e,t){return Object.assign(Object.assign({__typename:"UserConfiguration",id:t},e),{PrimeSettings:i(e.PrimeSettings),UserOptions:A(e.UserOptions),SessionSettings:C(e.SessionSettings),ViewStateConfiguration:T(e.ViewStateConfiguration),GroupsSets:P(e.GroupsSets),RetentionPolicyTags:x(e.RetentionPolicyTags)})}(JSON.parse(JSON.stringify(e)),t);n?F(t,r):k[t]=r}}catch(e){a.d("User configuration cache set failed: "+e)}}function N(e){return e=e||r.a,k[e]||{id:e}}function F(e,t){if(t){e=e||r.a;const n=k[e]||{};k[e]=Object(R.a)(n,t)}}n.d(t,"a",(function(){return N})),n.d(t,"b",(function(){return D})),n.d(t,"c",(function(){return F}))},960:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FindItemJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},962:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},964:function(e,t,n){"use strict";var r=n(920);n.d(t,"a",(function(){return r.a}))},970:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),a=n(960);function i(e,t){return void 0===e||e.__type||(e=Object(a.a)(e)),Object(r.a)("FindItem",e,t)}},973:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FindItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},9891:function(e){e.exports=JSON.parse('{"a":"Ifa"}')},9892:function(e){e.exports=JSON.parse('{"b":"ffa","d":"gfa","e":"hfa","c":"ifa","f":"jfa","a":"kfa"}')},9991:function(e){e.exports=JSON.parse('{"a":"V0b","c":"W0b","d":"X0b","b":"Y0b","e":"Z0b"}')},9992:function(e,t,n){var r=n(9993);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(77)(r,a);r.locals&&(e.exports=r.locals)},9993:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._1nM9lHOADRhr_c6SVOADHO{font-size:14px;color:var(--neutralSecondary);height:25px;width:28px}html[dir] ._1nM9lHOADRhr_c6SVOADHO{padding:4px;text-align:center}._1nM9lHOADRhr_c6SVOADHO:focus,._1nM9lHOADRhr_c6SVOADHO:hover{color:var(--neutralSecondary)}.SyP9uy9POMtEKSqcjz56r{display:block;color:var(--neutralSecondary)}._2PEQBliXdsvC09cN2WpJ7R{bottom:0;position:absolute;color:var(--white)}html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R{right:28px}html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R{left:28px}._2PEQBliXdsvC09cN2WpJ7R:focus,._2PEQBliXdsvC09cN2WpJ7R:hover{color:var(--white)}html[dir] ._2PEQBliXdsvC09cN2WpJ7R:focus,html[dir] ._2PEQBliXdsvC09cN2WpJ7R:hover{background:var(--blackTranslucent40)}html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R:focus,html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R:hover{border-bottom-right-radius:2px}html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R:focus,html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R:hover{border-bottom-left-radius:2px}html[dir=ltr] ._2PEQBliXdsvC09cN2WpJ7R._3pwyFskFhtIASENu2YzJ6F{right:56px}html[dir=rtl] ._2PEQBliXdsvC09cN2WpJ7R._3pwyFskFhtIASENu2YzJ6F{left:56px}._2XToIfXPoECB97QGfA0s1Q{font-size:14px}html[dir] ._2XToIfXPoECB97QGfA0s1Q{margin:0}html[dir] ._2kScRvSuNbnd5hCZYWqYip:focus,html[dir] ._2kScRvSuNbnd5hCZYWqYip:hover{background:var(--neutralTertiaryAlt)}html[dir] ._3HS9-955Oq1kGT8wyRH6Ir,html[dir] ._3t4jrRbyvuBZ1rgucJZBiu,html[dir] .SsUJhwmZuhmKa45ZUDwCn,html[dir] .aMt_ivi_4A4j3WUs2Hwux,html[dir] ._2-fi4WdfG0r2tX1K4MuHZd,html[dir] .lOPdU79axYwebv9-YKmI8{margin:0;background-color:var(--themeLight)}html[dir] ._3HS9-955Oq1kGT8wyRH6Ir:focus,html[dir] ._3HS9-955Oq1kGT8wyRH6Ir:hover,html[dir] ._3t4jrRbyvuBZ1rgucJZBiu:focus,html[dir] ._3t4jrRbyvuBZ1rgucJZBiu:hover,html[dir] .SsUJhwmZuhmKa45ZUDwCn:focus,html[dir] .SsUJhwmZuhmKa45ZUDwCn:hover,html[dir] .aMt_ivi_4A4j3WUs2Hwux:focus,html[dir] .aMt_ivi_4A4j3WUs2Hwux:hover,html[dir] ._2-fi4WdfG0r2tX1K4MuHZd:focus,html[dir] ._2-fi4WdfG0r2tX1K4MuHZd:hover,html[dir] .lOPdU79axYwebv9-YKmI8:focus,html[dir] .lOPdU79axYwebv9-YKmI8:hover{background:var(--themeTertiary)}html[dir] ._3HS9-955Oq1kGT8wyRH6Ir{background-color:var(--themeLighterAlt)}",""]),t.locals={actionButton:"_1nM9lHOADRhr_c6SVOADHO",actionButtonForDocViewInCompose:"SyP9uy9POMtEKSqcjz56r",actionButtonForImageView:"_2PEQBliXdsvC09cN2WpJ7R",extraRightPadding:"_3pwyFskFhtIASENu2YzJ6F",icon:"_2XToIfXPoECB97QGfA0s1Q",default:"_2kScRvSuNbnd5hCZYWqYip",edit:"_3HS9-955Oq1kGT8wyRH6Ir",notSelectedAndSaving:"_3t4jrRbyvuBZ1rgucJZBiu",selected:"SsUJhwmZuhmKa45ZUDwCn",selectedAndPending:"aMt_ivi_4A4j3WUs2Hwux",selectedAndSaving:"_2-fi4WdfG0r2tX1K4MuHZd",thematic:"lOPdU79axYwebv9-YKmI8"}},9994:function(e,t,n){var r=n(9995);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(77)(r,a);r.locals&&(e.exports=r.locals)},9995:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._2YdUjL_vLVrfkSyZPlmHA8{color:var(--themePrimary);min-height:1px;max-height:36px;font-size:16px;width:16px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0}html[dir] ._2YdUjL_vLVrfkSyZPlmHA8{margin:0 4px}._2WFO1wEm7Y9bzzhpYArO5m{vertical-align:middle;display:inline-block;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}html[dir] ._2WFO1wEm7Y9bzzhpYArO5m{margin:0 4px}html[dir=ltr] ._1i9P9-sdCflkDykV4qfBhd{margin:0 0 0 12px;float:right}html[dir=rtl] ._1i9P9-sdCflkDykV4qfBhd{margin:0 12px 0 0;float:left}",""]),t.locals={menuIcon:"_2YdUjL_vLVrfkSyZPlmHA8",menuText:"_2WFO1wEm7Y9bzzhpYArO5m",icon:"_1i9P9-sdCflkDykV4qfBhd"}}}]);
//# sourceMappingURL=owa.306.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.306.js'] = 1;