(window.$wj=window.$wj||[]).push([[807],{11907:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(1983),r=n(1868);function i(e,t){const n=e[e.length-1],i=t.rowKeys.indexOf(n);i<t.rowKeys.length-1?Object(o.q)(t,t.rowKeys[i+1],!1,r.a.RowRemoval):Object(o.i)(t,r.a.Reset)}},13029:function(e,t,n){"use strict";n.r(t);var o=n(1800),r=n(2222),i=n(2589),a=n(36),s=n(2128);async function c(e,t){const n=t.tableQuery;if(1===n.listViewType){const t={Id:e,mailboxInfo:Object(o.d)(n)};return await i.f.importAndExecute(t,"LoadNudgedItem")}return async function(e,t){const n=t.tableQuery,i=Object(o.d)(n);return r.i.importAndExecute(e,n.folderId,n.sortBy,Object(s.l)(n),n.requestShapeName,i).then(e=>e).catch(e=>(a.h.warn("loadNudgedConversation throws an exception"+e.message),null))}(e,t)}var u=n(47),d=n(296),l=n(404),f=n(226);const w="https://outlook.office.com/FocusedInboxB2",b="https://outlook.office.com/M365.Access";async function m(e,t){const n=await async function(e,t){if(!Object(d.a)()){let[n,o]=Object(l.getAccessTokenforResourceAsLazy)(w,t,e);return n||(n=await o),n}if(Object(u.j)("tri-nudge-consumer"))return Object(l.getDelegationTokenForOwa)(b,t,e);return null}(e,t);if(n){const e=new Headers;return e.authorization=Object(f.a)(n),e}return null}var I=n(327),g=n(283),O=n(54),y=n(165);function N(e){const t=parseInt(e)||-1;return-1!=t&&Object(y.a)(t)||503==t||-1==t}const v="FocusedInboxB2/api/v1/Nudges/GetNudges",p=1500;function h(e){return async function e(t,n,o){if(n>2)return o;if(N((o=await async function(e){const t=await m(e,"getNudge");if(!t)return{getNudgesResponse:null,errorOrStatus:"Token Failure"};let n;try{n=await Object(I.b)(v,e,!0,t,!0,!1,"GetNudges")}catch(e){return{errorDetails:e.message,errorOrStatus:"RequestNotComplete"}}try{if(Object(g.a)(n.status)){const e=await n.json();if(e.Nudges)return{getNudgesResponse:e,errorOrStatus:n.status};return{errorOrStatus:"No Nudges",errorDetails:await n.text()}}{let e=await n.text();return(null==e?void 0:e.toLowerCase().indexOf("html"))>-1&&(e=""),{errorOrStatus:n.status,errorDetails:e}}}catch(e){return{errorOrStatus:"Parse Error"}}}(t)).errorOrStatus))return await Object(O.a)(p),e(t,n+1,o);return o.retryAttempt=n,o}(e,1,null)}var j=n(1675),R=n(5),T=n(1678);var S=n(3552),E=n(3290),_=n(9790),C=n(11907),K=n(2397),L=n(2411);function D(e,t){const n=t.rowKeys.indexOf(e);if(-1==n)return;const o=j.b.getLastDeliveryOrRenewTimeStamp(e,t);if(!Object(L.a)(e,t.id,o))return;let r=Object(_.a)(o,j.b.getLastDeliveryTimeStamp(e,t),t,n+1);-1==r?Object(E.a)([e],t,"NotNudgeAnymore"):(Object(C.a)([e],t),K.a.updateRowPosition(--r,e,t))}var A=n(71),V=n(20),x=n(326),M=n(3402),P=n(1693),U=n(7);function F(e,t,n){Object(A.o)("Nudge_RowRemove",{owa_1:t,owa_2:n,rKey:e},{isCore:!0})}var k=n(6643),G=n(1698),B=n(132);function W(e){var t;const n=(null!==(t=e.IconIndex)&&void 0!==t?t:"").toString().toLowerCase();return n.indexOf("replied")>-1||n.indexOf("forwarded")>-1}function z(e,t,n,o,r,i,s,c,u,d,l){const f=s?"inbox":"sentitems";Object(A.o)("Nudge_Discarded",{owa_1:e,owa_2:r,owa_3:i,owa_4:f,owa_5:u,rt:c,itemId:t,cId:n,crId:o,nIt:l,lGId:d},{isCore:!0}),a.h.warn("Nudge Discarded - isConversationView: "+r+" itemId: "+t+" conversationId: "+n+" folderId: "+f+" isNudgeFromOtherTable: "+i)}function Q(e,t,n,o,r,i,a,s=!0,c,u){let d,l;j.b.getIsPinned(i,o)&&(d="RowPinned");const f=Object(j.R)(o),w=j.b.getLastDeliveryOrRenewTimeStamp(i,o);if(!d&&f){l=j.b.getLatestGlobalItemId(i,o);const t=j.b.getDraftItemIds(i,o);if(i&&-1==t.indexOf(l)&&l!=e){const e=new Date(w),t=new Date(c);d=(r?0==u:1==u)&&e.getTime()<t.getTime()?"ItemNotUpToDate":"NotLatestItemInRow"}}else{const t=Object(P.b)().items.get(e);t&&W(t)&&(d="NotLatestItemInRow")}return d?(s&&z(d,e,t,n,f,!1,r,w,a,l,c),d):null}var q=n(2);let H,J,X=!1,Y={};const $=36e5,Z=18e5,ee=Object(V.e)(k.a,"getNudgesOnNudgeOptionChangeClone",e=>{re(!0,"SettingChange")}),te=Object(V.e)(M.a,"clone_onSelectFolderComplete",e=>{const{selectedFolderId:t,previousFolderId:n,isExitingSearch:o}=e;t==n||o||re(!1,"FolderSwitch")}),ne=Object(V.e)(L.i,"clone_getNudgesOnNudgeRemoved",e=>{Object(u.j)("tri-nudgePolling")&&(J=setTimeout(()=>re(!0,"NudgeRemoval"),9e5))});function oe(e,t){"visible"===document.visibilityState&&re(e,t)}function re(e,t){if(X||!Object(S.b)())return;const n=Object(u.j)("tri-nudgePolling");!H&&n&&(H=!0,document.addEventListener("visibilitychange",()=>oe(!1,"VisibilityChange")));const o=Object(j.I)(),r=o.tableQuery.folderId;if(Object(S.a)(r)){if(n){if(!e&&Date.now()-Y[r]<=Z)return;J&&(clearTimeout(J),J=null),J=setTimeout(()=>oe(!1,"Timer"),$)}!async function(e,t,n){var o;X=!0;const r=Object(x.a)(),i=Date.now(),c=await h(r),u=[],d=c,l=Date.now()-i;if(null===(o=null==d?void 0:d.getNudgesResponse)||void 0===o?void 0:o.Nudges){const o=d.getNudgesResponse.Nudges;let i=0;const a=[],s=[],c="sentitems"==Object(G.a)(e);for(let d=0;d<o.length;d++){const l=o[d],f=l.FolderId.Id,w=ie(l);if(a.push(w),c&&f!=e)continue;const b=await ae(l,t,r,!c,n);b&&(u.push(b),s.push(w)),i++}se(o.length,i,u.length,n,r,a.join(","),l,s.join(","),d.errorOrStatus,"",d.retryAttempt)}else se(0,0,0,n,r,"",l,"",d.errorOrStatus,Object(q.U)(d.errorDetails),d.retryAttempt);const f=Object(R.c)("testOldNudge");if(0!=decodeURIComponent(f||"").trim().length){u.push({rowKey:"testNudgeRowKey",itemId:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId=",conversationId:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId=",tableViewId:t.id,reason:0,daysAgo:7,nudgeItemTime:"2020-08-31T17:00:00-07:00",entryId:"testEntryId"});const e={ConversationId:{__type:"ItemId:#Exchange",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId="},ConversationTopic:"This is a test Nudge Email that is older than the loaded rows",UniqueSenders:["Sayali Shah"],LastDeliveryTime:"2019-10-01T15:30:58-07:00",HasAttachments:!1,MessageCount:1,GlobalMessageCount:1,UnreadCount:1,GlobalUnreadCount:1,Size:1234,ItemClasses:["IPM.Note"],Importance:null,ItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],GlobalItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],LastModifiedTime:"2019-10-29T15:30:59-07:00",InstanceKey:"testNudgeRowKey",Preview:"Test nudge email for row that is not loaded",HasIrm:!1,IsLocked:!1,FamilyId:{__type:"ItemId:#Exchange",Id:"AAQkAGZjM2NmMGY1LTkzMzgtNGNhMy04ODg5LWQwMjJjMDc0YjJlMAAQAH9+ZbR0rbRFncY81mWHT1E="},LastDeliveryOrRenewTime:"2019-10-01T15:30:58-07:00",HasAttachmentPreviews:!1,LastSender:{Mailbox:{Name:"Sayali Shah",EmailAddress:"sayalis@microsoft.com",RoutingType:"SMTP"}}};if(t.rowKeys.indexOf("testNudgeRowKey")<0){const n=Object(s.f)(t,0);K.a.addRow(n,e,t)}}u.push(...function(e){const t=Object(R.c)("testNudge");if(0==decodeURIComponent(t||"").trim().length)return[];const n=[];if(e.rowKeys.length>0){const t=e.tableQuery.folderId===Object(T.a)("sentitems")?1:0,o={rowKey:e.rowKeys[4],itemId:j.b.getItemIds(e.rowKeys[0],e)[0],conversationId:j.b.getConversationId(e.rowKeys[4],e),tableViewId:e.id,reason:t,daysAgo:1};if(n.push(o),e.rowKeys.length>3){const o={rowKey:e.rowKeys[6],itemId:j.b.getItemIds(e.rowKeys[3],e)[0],conversationId:j.b.getConversationId(e.rowKeys[6],e),tableViewId:e.id,reason:t,daysAgo:0};n.push(o)}if(e.rowKeys.length>10&&1===Math.floor(2*Math.random())){const o={rowKey:e.rowKeys[10],itemId:j.b.getItemIds(e.rowKeys[10],e)[0],conversationId:j.b.getConversationId(e.rowKeys[10],e),tableViewId:e.id,reason:t,daysAgo:3};n.push(o)}}return n}(t)),Object(L.f)().nudgedRows.forEach(e=>{const n=e.rowKey;e.tableViewId!=t.id||u.some(t=>t.rowKey===n&&t.tableViewId===e.tableViewId)||(D(n,t),F(n,"NotReceivedAsNudgeAnyMore",e.reason)),e.tableViewId!=t.id&&u.push(e)}),Object(L.h)(u,t),a.h.info("Nudge: onSelectFolderCompleteOrchestrator new nudges length: "+u.length),X=!1}(r,o,t),Y[r]=Date.now()}}function ie(e){return Object(u.j)("fwk-immutable-ids")||Object(B.a)("native")?e.ImmutableId.Id:e.ItemId.Id}async function ae(e,t,n,r,u){try{let d,l;const f=ie(e),w=e.ConversationId.Id,b=e.NudgeReason.Reason,m=Object(j.R)(t),I=m?w:f,g=Object(j.F)([I],t),O=r?"Sent"==b:"Received"==b,y=function(e){switch(e){case"Received":return 0;case"Sent":return 1;default:return a.h.warn("No nudge reason returned in GetNudge server response"),0}}(e.NudgeReason.Reason);if(0===g.length){const o=await c(I,t);if(l=function(e,t,n,o,r,i,a,s,c,u){var d;let l,f,w;if(e||(l=s?"ItemFromOtherTable":"RowNotFound"),!l){let t;t=r?e.LastDeliveryOrRenewTime:e.ReceivedOrRenewTime,Object(j.x)(t)&&(l="RowPinned")}if(!l)if(r){const n=e;if(w=n.LastDeliveryOrRenewTime,f=n.GlobalItemIds[0].Id,0==(n.DraftItemIds||[]).filter(e=>e.Id==f).length&&f!=t){const e=new Date(w),t=new Date(u);l=e.getTime()<t.getTime()?"ItemNotUpToDate":"NotLatestItemInRow"}}else{const t=e;w=t.ReceivedOrRenewTime,W(t)?l="NotLatestItemInRow":(null===(d=t.ParentFolderId)||void 0===d?void 0:d.Id)!=i.tableQuery.folderId&&(l="ItemFromOtherTable")}return l?(z(l,t,n,o,r,s,a,w,c,f,u),l):null}(o,f,w,n,m,t,r,O,u,e.MessageReceivedOrSentTimeUTC),d=null==o?void 0:o.InstanceKey,!l&&t.rowKeys.indexOf(d)<0){const e=Object(s.f)(t,0);K.a.addRow(e,o,t)}}else l=Q(f,w,n,t,r,g[0],u,!0,e.MessageReceivedOrSentTimeUTC,y),d=g[0];if(!l&&d){!function(e,t){if(1===e.listViewType){const n=Object(P.b)().items.get(t);n&&n.NormalizedBody||i.f.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedItem")}else Object(P.b)().conversations.get(t)||i.e.importAndExecute({Id:t,mailboxInfo:Object(o.d)(e)},"LoadNudgedConversation")}(t.tableQuery,I);const n=e.MessageReceivedOrSentTimeUTC||j.b.getLastDeliveryTimeStamp(d,t),r=Object(U.s)(Object(U.qc)(),Object(U.qc)(n));return{rowKey:d,itemId:f,conversationId:w,tableViewId:t.id,reason:y,daysAgo:r,nudgeItemTime:e.MessageReceivedOrSentTimeUTC,entryId:e.ItemId.Id}}return null}catch(e){return a.h.warn("Nudge: processNudgeResponse throws an exception"+e.message),null}}function se(e,t,n,o,r,i,a,s,c,u,d){Object(A.o)("Nudge_GetNudge",{owa_1:e,owa_2:t,owa_3:n,owa_4:o,cId:r,itemId:i,latency:a,validItemId:s,error:null==c?void 0:c.toString(),errorMessage:u,retryAttempt:d})}const ce="FocusedInboxB2/api/v1/Nudges/UpdateNudge",ue=1500;function de(e,t,n,o){const r=Object(x.a)();let i;try{i={ItemId:{Id:e},NudgeAction:t}}catch(e){le(null==i?void 0:i.NudgeAction,n,o,null==i?void 0:i.ItemId.Id,e.message,"RequestPayloadError",null,0,r,i)}return async function e(t,n,o,r,i,a){if(r>3)return;const s=null==t?void 0:t.NudgeAction,c=await async function(e,t){const n=await m(t,"updateNudge");if(!n)return{errorMessage:"Token Failure"};let o;try{o=await Object(I.e)(ce,e,t,!0,n,!0,!1,!1,"UpdateNudges",null)}catch(e){return{errorDetails:e.message,errorMessage:"RequestNotComplete"}}try{const e=o.status;if(Object(g.a)(e))return{status:e,errorMessage:"No error",errorDetails:""};let t=await o.text();return(null==t?void 0:t.toLowerCase().indexOf("html"))>-1&&(t=""),{status:e,errorMessage:e,errorDetails:t}}catch(e){return{errorMessage:"Parse Error"}}}(t,a);le(s,n,o,null==t?void 0:t.ItemId.Id,c.errorMessage,c.errorDetails,c.status,r,a,t),N(c.status.toString())&&(await Object(O.a)(i),e(t,n,o,r+1,2*i,a))}(i,n,o,1,ue,r)}function le(e,t,n,o,r,i,a,s,c,u){Object(A.o)("Nudge_Update",{owa_1:e,owa_2:t,owa_3:n,owa_4:r,owa_5:a,itemId:o,errorDetails:Object(q.U)(i),rA:s,crId:c,rp:!!u},{isCore:!0})}var fe=n(2477),we=n(3553),be=n(3554),me=n(4896),Ie=n(6874),ge=n(7412),Oe=n(3320),ye=n(7411);let Ne,ve;const pe=Object(V.e)(ge.b,"clone_onNudgeInfoBarClicked",e=>{const t=e.response===ge.a.MarkComplete?"MarkedComplete":"DismissedOnView";Le(e.rowKey,e.itemId,t,"ReadingPane")}),he=Object(V.e)(Ie.a,"clone_onDismissNudgeClicked",e=>{Object(L.f)().nudgedRows.filter(t=>t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId).forEach(t=>{Le(e.rowKey,t.itemId,"Dismissed",e.actionSource)})}),je=Object(V.e)(be.a,"clone_markItemsAsPinnedStoreUpdate",e=>{Ke(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)}),Re=Object(V.e)(we.a,"clone_markConversationsAsPinnedStoreUpdate",e=>{Ke(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned)}),Te=Object(V.e)(fe.a,"clone_deleteItemsStoreUpdate",e=>{e.itemContexts.map(e=>e.itemId).forEach(t=>{const n=Object(L.e)(t);n&&(Object(L.i)(n),F(n,e.actionType,Ae(n)))})}),Se=Object(V.e)(E.a,"clone_removeRowsFromListViewStore",e=>{De(e.rowKeys,e.tableView.id,e.actionType)}),Ee=Object(V.e)(me.a,"clone_onSendMessageSucceeded",e=>{const t=e.operation;if(1!==t&&2!==t&&3!==t)return;e.referenceItemId||a.h.warn("Nudge: referenceItemId should not be null for r/R/f operations");const n=e.referenceItemId.Id,o=e.conversationId;let r,i=Object(L.e)(n);i||(i=Object(L.d)(o)),i?(D(i,Object(j.I)()),r=Ae(i),Object(L.i)(i)):Ne==n&&(i=ve),i&&Object(A.o)("Nudge_Reply",{owa_1:t,owa_2:r,refId:n,cId:o,rKey:i},{isCore:!0})}),_e=Object(V.e)(ye.a,"clone_removeNudgeUponRowUpdate",e=>{const t=Object(L.f)().nudgedRows.filter(t=>t.rowKey===e.rowKey);if(t.length>0){const n=Q(t[0].itemId,t[0].conversationId,null,e.tableView,"inbox"==Object(G.a)(e.tableView.tableQuery.folderId),e.rowKey,"RowRemove",!1,t[0].nudgeItemTime,t[0].reason);n&&(Ne=t[0].itemId,ve=e.rowKey,D(e.rowKey,e.tableView),De([e.rowKey],e.tableView.id,n))}}),Ce=Object(V.e)(k.a,"updateNudgesOnNudgeOptionChangeClone",e=>{if(Object(Oe.a)(32)){const e=Object(L.f)().nudgedRows.map(e=>e.rowKey),t=Object(j.I)();e.forEach(e=>{D(e,t),De([e],t.id,"NudgeDisabled")})}});function Ke(e,t,n){const o=n?"Pinned":"Unpinned";e.forEach(e=>{Object(L.f)().nudgedRows.filter(n=>n.rowKey===e&&n.tableViewId===t).forEach(e=>{de(e.itemId,o,"PinUnpin",e.reason)})}),De(e,t,"PinUnpin")}function Le(e,t,n,o){de(t,n,o,Ae(e)),D(e,Object(j.I)()),Object(L.i)(e)}function De(e,t,n){e.forEach(e=>{if(Object(L.g)(e,t)){const t=Ae(e);Object(L.i)(e),F(e,n,t)}})}function Ae(e){const t=Object(L.f)().nudgedRows.filter(t=>t.rowKey===e);return t.length>0?t[0].reason:null}var Ve=n(3);function xe(e,t,n){if(e.tableViewId!=t.id)return;let o,r="Nudge_Render";const{rowKey:i,conversationId:c,itemId:u}=e;Object(L.a)(i,t.id,j.b.getLastDeliveryOrRenewTimeStamp(i,t))?(o=Object(s.f)(t,0),K.a.updateRowPosition(o,i,t),a.h.info("Nudge: "+n+" updateNudgedRowPosition - row is inserted at "+o)):(r="Nudge_NotRender",a.h.info("Nudge: "+n+" updateNudgedRowPosition - row is pinned")),Object(A.o)(r,{owa_1:n,rKey:i,iId:u,cId:c,index:o},{isCore:!0})}Object(Ve.orchestrator)(L.h,e=>{e.nudgedRows.forEach(t=>xe(t,e.tableView,"onGetNudge"))}),Object(Ve.orchestrator)(s.i,e=>{const t=Object(L.f)().nudgedRows,n=e.tableView;t.filter(e=>e.tableViewId==n.id).forEach(t=>xe(t,e.tableView,"onMerge"))});var Me=n(57);function Pe(){Object(Oe.b)(!0,32),Me.u.importAndExecute([{key:"FocusedInboxBitFlags",valuetype:"Integer32",value:[`${Object(Me.g)().ViewStateConfiguration.FocusedInboxBitFlags}`]}],"OWA.ViewStateConfiguration"),Object(A.o)("TnS_SaveNudgeOption",[!1,"InlineFeedback"]),Object(k.a)()}n.d(t,"getNudgesOnSelectFolderComplete",(function(){return te})),n.d(t,"getNudgesOnNudgeOptionChange",(function(){return ee})),n.d(t,"getNudgesOnNudgeRemoved",(function(){return ne})),n.d(t,"removeNudgeOnInfoBarClickedOrchestrator",(function(){return pe})),n.d(t,"removeNudgeOnDismissNudgeClickedOrchestrator",(function(){return he})),n.d(t,"removeNudgeOnItemDeleteStoreUpdateOrchestrator",(function(){return Te})),n.d(t,"removeNudgeOnRowsDeleteStoreUpdateOrchestrator",(function(){return Se})),n.d(t,"removeNudgeOnItemsPinnedStoreUpdateOrchestrator",(function(){return je})),n.d(t,"removeNudgeOnConversationsPinnedStoreUpdateOrchestrator",(function(){return Re})),n.d(t,"removeNudgeOnReplyOrReplyAllOrForwardOrchestrator",(function(){return Ee})),n.d(t,"updateNudgesOnNudgeOptionChange",(function(){return Ce})),n.d(t,"removeNudgeUponRowUpdate",(function(){return _e})),n.d(t,"disableNudgeOption",(function(){return Pe}))},188:function(e,t,n){"use strict";function o(){var e=Object.create(null),t=0,n=0,o=0,r=!1;function i(t){o--,delete e[t]}this.put=function(t,n,r,a){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):o++;var c={value:n,expire:r+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),r)),e[t]=c,n},this.del=function(t){var n=!0,o=e[t];return o?(clearTimeout(o.timeout),!isNaN(o.expire)&&o.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);o=0,e=Object.create(null),r&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return r&&t++,a.value;r&&n++,o--,delete e[i]}else r&&n++;return null},this.size=function(){return o},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var o=e[n];t[n]={value:o.value,expire:o.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var o=JSON.parse(t),r=Date.now(),i=n&&n.skipDuplicates;for(var a in o)if(o.hasOwnProperty(a)){if(i)if(e[a])continue;var s=o[a],c=s.expire-r;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,s.value,c)}return this.size()}}e.exports=new o,e.exports.Cache=o},1964:function(e,t,n){"use strict";function o(e,t){const n=Math.pow(2,32);if(e>=n||t>=n){const o=e%n,r=t%n;return(((e-=o)/n&(t-=r)/n)>>>0)*n+((o&r)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return o}))},1983:function(e,t,n){"use strict";n.d(t,"q",(function(){return u})),n.d(t,"t",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"o",(function(){return w})),n.d(t,"a",(function(){return b})),n.d(t,"l",(function(){return m})),n.d(t,"e",(function(){return I})),n.d(t,"p",(function(){return g})),n.d(t,"s",(function(){return O})),n.d(t,"r",(function(){return y})),n.d(t,"f",(function(){return N})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return p})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return j})),n.d(t,"c",(function(){return R})),n.d(t,"b",(function(){return T})),n.d(t,"g",(function(){return S})),n.d(t,"k",(function(){return E}));var o=n(80),r=n(1675),i=n(1692),a=n(3),s=n(1729),c=n(38);const u=Object(a.action)("SINGLE_SELECT_ROW",(e,t,n,r)=>Object(o.b)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})),d=Object(a.action)("TOGGLE_SELECT_ROW",(e,t,n,r)=>Object(o.b)(_(r,e,t),{tableView:e,rowKey:t,isUserNavigation:n,mailListItemSelectionSource:r})),l=Object(a.action)("ON_AFTER_SELECTION_CHANGED",(e,t,n,o,r)=>({rowKey:e,tableView:t,mailListItemSelectionSource:n,listViewType:o,sxsId:r})),f=Object(a.action)("RESET_LIST_VIEW_EXPANSION_VIEW_STATE"),w=Object(a.action)("SET_SECOND_LEVEL_LIST_VIEW_EXPANSION",e=>({rowKey:e})),b=Object(a.action)("ITEM_PART_SELECTED",(e,t,n,o,r)=>({nodeId:e,itemId:t,allNodeIds:n,tableView:o,mailListItemSelectionSource:r})),m=Object(a.action)("SELECT_NEXT_ITEM_PART",(e,t)=>({rowKey:e,tableView:t})),I=Object(a.action)("ON_ITEM_PART_CONTEXT_MENU",(e,t,n)=>({contextMenuAnchor:e,nodeId:t,tableViewId:n})),g=Object(a.action)("SINGLE_SELECT_ITEM_PART",(e,t,n,o,r)=>({rowKey:e,nodeIdToSelect:t,allNodeIds:n,tableViewId:o,currentSelectedNodeIds:r})),O=Object(a.action)("TOGGLE_SELECT_ITEM_PART",e=>({nodeId:e})),y=Object(a.action)("TOGGLE_SELECT_ALL_ROWS",e=>({tableView:e})),N=Object(a.action)("RANGE_SELECT_ROW",(e,t,n,o)=>({tableView:e,targetRowKey:t,mailListItemSelectionSource:n,isCtrlOrCmdKeyDown:o})),v=Object(a.action)("RESET_SELECTION",(e,t,n)=>({tableView:e,mailListItemSelectionSource:t,isUserNavigation:n})),p=Object(a.action)("RESET_SELECTION",e=>({tableView:e})),h=Object(a.action)("SELECT_ROW_IN_DIRECTION",(e,t,n)=>Object(o.b)(_(n,e,void 0,t),{tableView:e,selectionDirection:t,mailListItemSelectionSource:n})),j=Object(a.action)("SET_EXPANSION_FOR_ROW",(e,t)=>({rowKey:e,mailListItemSelectionSource:t})),R=Object(a.action)("KEYBOARD_MULTI_SELECT_ROW",(e,t,n,o)=>({tableView:e,mailListItemSelectionSource:t,selectionDirection:n,isCtrlOrCmdKeyDown:o})),T=Object(a.action)("KEYBOARD_COLLAPSE_CONVERSATION",e=>({rowKey:e})),S=Object(a.action)("RESET_BUS_STOP_STATE_MAP"),E=Object(a.action)("SELECT_NEW_ITEM_UPON_ROW_REMOVAL",(e,t,n)=>({tableView:e,lastSelectedRowIndex:t,lastSelectedRowWasPinned:n}));function _(e,t,n,o){return{name:function(e,t,n,o){return!(function(e){return e===i.b.MailListItemRichPreview||e===i.b.KeyboardShiftEnter||e===i.b.MailListItemBodyDoubleClick}(e)||Object(s.d)()&&!function(e){var t;return e===i.b.KeyboardEnter||e===i.b.MailListItemBody||e===i.b.RouteHandler||e===i.b.CommandBarArrows||e===i.b.ImmersiveReadingPaneDelete&&"ReturnToView"!==(null===(t=Object(c.a)().UserOptions)||void 0===t?void 0:t.NextSelection)}(e)||function(e,t,n,o){if(Object(s.d)())return!1;if(e===i.b.KeyboardUpDown){const e=t.rowKeys.indexOf(t.selectionAnchorRowKey);if(-1!==e&&1===t.selectedRowKeys.size){const n=t.rowKeys.indexOf([...t.selectedRowKeys.keys()][0]);return o===r.d.Next?n===e+1||n===t.rowKeys.length-1&&e===t.rowKeys.length-1:n===e-1||0===n&&0===e}return!1}return n&&t.selectedRowKeys.has(n)&&1===t.selectedRowKeys.size}(e,t,n,o))}(e,t,n,o)?"SelectMailItem":"SelectMailItemNonCritical",options:{timeout:9e4}}}},213:function(e,t,n){"use strict";var o=n(36);let r;function i(){return null==r&&(r="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),r}var a=n(113);const s=500,c=[],u=[],d=[];let l=!0;function f(e,t){Object(o.g)((e,t,n,r)=>{l&&(t==o.b.Error&&u.push({message:e,error:r}),c.push({message:e,level:t}))}),e(b),t(b),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(s):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(s))}function w(e){const t=Object(a.a)(e);return l=!1,{traces:c,errors:u,network:d,usage:t}}function b(){l&&d.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return w})),n.d(t,"d",(function(){return a.b})),n.d(t,"c",(function(){return i}))},226:function(e,t,n){"use strict";function o(e){var t,n;if((null==e?void 0:e.length)>0){const o=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(n=e[1])||void 0===n?void 0:n.length)>0?o:void 0}}const r="bearer",i="msauth1.0",a=3600,s=86400,c=6e4,u=1e3;function d(e){if(e){const t=e.split(" ");return o(t)==r?t[1]:e}}function l(e,t){if(e){const n=o(e.split(" "));if(n){if(t){return(1e3*t-Date.now()-c)/u}return n==i?s:a}}}function f(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}))},2307:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return r}));const o=1,r=16},283:function(e,t,n){"use strict";var o=n(907);n.d(t,"a",(function(){return o.a}))},291:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(135),r=n(100),i=n(2);let a;function s(e){a=e}async function c(e){var t,n;if(Object(i.Q)())return r.f.importAndExecute(Object(o.a)());const s=a&&await a(void 0,e);if(s&&s.length>0){if("bearer"===(null===(t=null==s?void 0:s.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return s.split(" ")[1];if("msauth1.0"===(null===(n=null==s?void 0:s.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return s}}},907:function(e,t,n){"use strict";function o(e){return e>=200&&e<300}n.d(t,"a",(function(){return o}))},9790:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var o=n(2411),r=n(1675),i=n(2128);function a(e,t,n,o){const a=new Date(r.b.getLastDeliveryTimeStamp(n,o)).getTime()-new Date(t).getTime();if(Object(i.l)(o.tableQuery)){const t=new Date(r.b.getLastDeliveryOrRenewTimeStamp(n,o)).getTime()-new Date(e).getTime();return 0!=t?t:a}return a}function s(e,t,n,r,a){return Object(o.a)(a,n.id,e)?Object(i.f)(n,0):c(e,t,n,r)}function c(e,t,n,i){const s=n.rowKeys.length;if(0==s)return 0;const c=Object(r.K)(n).sortDirection==r.c.DESCENDING_SORT_DIR;let u;for(u=i;u<s;u++){const r=n.rowKeys[u];if(Object(o.a)(r,n.id,e))continue;const i=a(e,t,r,n);if(c?i<=0:i>0)return u}return s==n.totalRowsInView?s:-1}}}]);
//# sourceMappingURL=owa.807.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.807.js'] = 1;