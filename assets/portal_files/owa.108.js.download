(window.$wj=window.$wj||[]).push([[108],{1696:function(e,t,n){"use strict";var r=n(1709),i=n(2213),c=n(6);function o(e){let t;return e>=1073741824?(e/=1073741824,t=Object(c.b)(i.b)):e>=1048576?(e/=1048576,t=Object(c.b)(i.d)):e>=1024?(e/=1024,t=Object(c.b)(i.c)):t=Object(c.b)(i.a),Object(c.c)(t,Math.round(e))}var a=n(1850),u=n(47);const s=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(u.j)("doc-attachment-documentThumbnail"))return!1;const t=Object(r.a)(e);return!!t&&s.indexOf(t.toLowerCase())>=0}var d;function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return d.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return d.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return d.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(d||(d={}));var b=n(1816);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return o})),n.d(t,"g",(function(){return a.a})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return b.b})),n.d(t,"a",(function(){return d}))},1709:function(e,t,n){"use strict";function r(e){if(!e)return null;const t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function i(e){const t=r(e);return t?t.replace(".",""):null}function c(e){var t;return(null===(t=i(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c}))},1713:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1824);function i(e){if(!e)return null;return Object(r.a)().attachments.get(e.Id)}},1728:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage",e[e.Sonora=18]="Sonora"}(r||(r={}))},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1732);function i(e){return(e.__type||e.OwsTypeName)===r.e}},1774:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(332);function i(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1777:function(e,t,n){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function i(e){let t=null;const n=r.exec(e);if(n){const e=n[1],r=n[2];let i=null;try{i=atob(r)}catch(e){}if(i){const n=new ArrayBuffer(i.length),r=new Uint8Array(n);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);t=new File([n],"image.png",{type:e})}}return t}var c=n(1728),o=n(1696);function a(e){return e.map(e=>({fileType:c.a.Uri,name:e.name,type:Object(o.b)(e.url)||"",size:0,uri:e.url}))}var u=n(36);function s(e,t,n){if(e.length!=t.length)return u.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let i=0;i<e.length;i++){const o={fileType:c.a.MailItem,name:e[i],size:(null==n?void 0:n[i])||0,itemId:t[i]};r.push(o)}return r}function l(e,t,n){const r=[],i={fileType:c.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(i),r}function d(e){if(!e)return null;let t=[];for(var n=0;n<e.length;n++){const r=e[n],i={fileType:c.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(i)}return t}function f(e){if(!e)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n],i={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(i)}return t}function b(e){var t,n;if(null===e)return null;return{fileType:c.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function p(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:c.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var m=n(1778);function h(e){switch(e?e.toLowerCase():null){case m.d.ONE_DRIVE_PRO.toLowerCase():return 0;case m.d.GDRIVE.toLowerCase():return 5;case m.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case m.d.DROPBOX.toLowerCase():return 2;case m.d.BOX.toLowerCase():return 3;case m.d.WOPI_BOX.toLowerCase():return 7;case m.d.WOPI_EGNYTE.toLowerCase():return 8;case m.d.MAILBOX.toLowerCase():return 4;case m.d.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"a",(function(){return c.a}))},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"d",(function(){return p}));const r="Box",i="Dropbox",c="Facebook",o="GDrive",a="Mailbox",u="MailMessage",s="OneDriveConsumer",l="OneDrivePro",d="WopiBox",f="WopiDropbox",b="WopiEgnyte",p={BOX:r,DROPBOX:i,FACEBOOK:c,GDRIVE:o,MAILBOX:a,ONE_DRIVE_CONSUMER:s,ONE_DRIVE_PRO:l,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:d,WOPI_EGNYTE:b}},1786:function(e,t,n){"use strict";var r,i=n(1696),c=n(2144),o=n(38),a=n(1850),u=n(2355),s=n(1857);!function(e){e[e.Undefined=0]="Undefined",e[e.Block=1]="Block",e[e.ForceSave=2]="ForceSave",e[e.Allow=3]="Allow",e[e.AccessDisabled=4]="AccessDisabled"}(r||(r={}));class l{constructor(e,t){this.attachmentPolicy=e,this.shouldTreatAsPublicLogon=t,this.shouldTreatAsPublicLogon?(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPublicComputersEnabled):(this.directFileAccessEnabled=this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled,this.linkPreviewEnabled=this.attachmentPolicy.WacViewingOnPrivateComputersEnabled),this.saveAttachmentsToCloudEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.SaveAttachmentsToCloudEnabled,this.convertClassicToCloudyEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ReferenceAttachmentsEnabled,this.convertCloudyToClassicEnabled=this.attachmentPolicy.AttachmentDataProviderAvailable&&this.attachmentPolicy.ClassicAttachmentsEnabled,this.fileTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedFileTypes,this.attachmentPolicy.ForceSaveFileTypes,this.attachmentPolicy.AllowedFileTypes),this.mimeTypeToPolicyMap=this.createPolicyMap(this.attachmentPolicy.BlockedMimeTypes,this.attachmentPolicy.ForceSaveMimeTypes,this.attachmentPolicy.AllowedMimeTypes),this.policyForUnknownTypes=r[this.attachmentPolicy.ActionForUnknownFileAndMIMETypes],this.printWithoutDownloadEnabled=this.attachmentPolicy.PrintWithoutDownloadEnabled}getPolicyInfo(e,t,n,i){e&&(e=e.toLowerCase());let c=this.getFileAccessLevel(e,t),o=!1,s=!1,l=!1;const d=1===i||3===i;if(c!==r.Block&&n){this.isWacViewingEnabled(e)&&(o=!0),!this.directFileAccessEnabled&&d&&(o=!1),s=this.isForceBrowserViewingFirst(o),o&&null!=this.attachmentPolicy.WacEditableFileTypes&&null!=e&&(l=0===i?this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0||this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)>=0:this.attachmentPolicy.WacEditableFileTypes.indexOf(e)>=0&&-1===this.attachmentPolicy.WacConvertibleFileTypes.indexOf(e)),o||Object(a.b)(e)||Object(u.a)(e)||this.directFileAccessEnabled||(c=r.AccessDisabled)}return{directFileAccessEnabled:this.directFileAccessEnabled,level:c,useWac:o,forceBrowserViewingFirst:s,wacEdit:l}}isPdfPreviewEnabled(){return this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled||this.attachmentPolicy.DirectFileAccessOnPrivateComputersEnabled}getFileAccessLevel(e,t){let n=this.fileTypeToPolicyMap[e];if(n||(n=r.Undefined),n===r.Block)return r.Block;const i=this.mimeTypeToPolicyMap[t];return i===r.Block?r.Block:n===r.ForceSave||i===r.ForceSave?r.ForceSave:n===r.Allow||i===r.Allow?r.Allow:this.policyForUnknownTypes}isWacViewingEnabled(e){return(this.shouldTreatAsPublicLogon?this.attachmentPolicy.WacViewingOnPublicComputersEnabled:this.attachmentPolicy.WacViewingOnPrivateComputersEnabled)&&this.attachmentPolicy.WacViewableFileTypes&&this.attachmentPolicy.WacViewableFileTypes.indexOf(e)>=0}isForceBrowserViewingFirst(e){return!!e&&(this.shouldTreatAsPublicLogon?this.attachmentPolicy.ForceWacViewingFirstOnPublicComputers:this.attachmentPolicy.ForceWacViewingFirstOnPrivateComputers)}addPolicyIntoMap(e,t,n){t&&t.forEach(t=>{e[t]=n})}createPolicyMap(e,t,n){const i={};return this.addPolicyIntoMap(i,n,r.Allow),this.addPolicyIntoMap(i,t,r.ForceSave),this.addPolicyIntoMap(i,e,r.Block),i}}let d=null,f=null;function b(){if(!d){const e=Object(o.a)(),t=Object(c.c)(),n=e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession;d=new l(t,n),n&&(f=d)}return d}function p(e,t){const n=Object(i.b)(e.Name),r=e.ContentType;return b().getPolicyInfo(n,r,t,Object(s.a)(e))}function m(e,t){const n=Object(i.b)(e.Name),r=e.ContentType;return function(){if(!f){const e=Object(o.a)();if(e.SessionSettings.IsPublicLogon||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession)return b();f=new l(Object(c.c)(),!0)}return f}().getPolicyInfo(n,r,t,Object(s.a)(e))}function h(e,t,n,i,c){if(i||c)return!1;const o=p(e,!0),a=b();return o.level!==r.Block&&a.saveAttachmentsToCloudEnabled&&!t&&n}n.d(t,"d",(function(){return h})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return b}))},1804:function(e,t,n){"use strict";var r,i,c;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(i||(i={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(c||(c={}))},1816:function(e,t,n){"use strict";function r(e){return function(e){const t=c.exec(e);return t&&t.length>1&&i[t[1].toLowerCase()]}(e||"")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const i={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},c=/^\s*([^;\s]*)(?:;|\s|$)/;function o(e){let t="";return Object.entries(i).forEach(n=>{n[1]===e&&(t=n[0])}),t}},1850:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var r=n(1709),i=n(1816),c=n(175);const o=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],a=[".tiff",".tif"];function u(e,t,n=!0){return s(Object(r.a)(e)||Object(i.a)(t),n)}function s(e,t=!0){return!!e&&(o.indexOf(e.toLowerCase())>=0||t&&a.indexOf(e.toLowerCase())>=0&&(Object(c.c)()||Object(c.f)()))}},1857:function(e,t,n){"use strict";var r=n(1732),i=n(6);const c=e=>e&&["IPM.Note","IPM.Schedule.Meeting","IPM.GroupMailbox.JoinRequest","IPM.Post"].includes(e);function o(e){const t=e.__type||e.OwsTypeName;switch(t){case r.a:return 0;case r.e:return e.IsLink?3:1;case r.d:return 3;case r.b:return 2;case r.c:const n=e,o=e.EmbeddedItemClass;return o&&c(o)||Object(i.k)(n.AttachmentIdToAttach)?2:0;default:throw new Error(`Invalid type of attachment ${t}`)}}n.d(t,"a",(function(){return o}))},1862:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var r=n(1857);function i(e){return o(e.type)}function c(e){return o(Object(r.a)(e))}function o(e){return 1===e||3===e}},188:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,i=!1;function c(t){r--,delete e[t]}this.put=function(t,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){c(t),o&&o(t,n)}.bind(this),i)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&c(t),n},this.clear=function(){for(var c in e)clearTimeout(e[c].timeout);r=0,e=Object.create(null),i&&(t=0,n=0)},this.get=function(c){var o=e[c];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&t++,o.value;i&&n++,r--,delete e[c]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){i=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),i=Date.now(),c=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(c)if(e[o])continue;var a=r[o],u=a.expire-i;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,a.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1943:function(e,t,n){"use strict";var r=n(2435),i=n(2488),c=n(282);const{getDataProviderInfo:o,getDefaultDataProviderInfo:a}=Object(r.a)((function(e){switch(e){case 0:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportedPermissionLevels:[2,1],requiresFetchingSharingInformation:!0});case 1:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportImageThumbnail:!0,supportPreview:(e,t)=>t,supportedPermissionLevels:[2,1]});case 3:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 2:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportPreview:(e,t)=>!1});case 6:return{supportDownload:!1,supportImageThumbnail:!0,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};case 5:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportImageThumbnail:!1,supportPreview:e=>Object(i.a)(e),supportedPermissionLevels:[4,3]});case 7:case 8:case 9:return Object.assign(Object.assign({},{supportDownload:!0,supportImageThumbnail:!1,supportPreview:(e,t)=>!0,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1}),{supportDownload:!1,supportPreview:(e,t)=>!1});case 4:case 10:return{supportDownload:!1,supportImageThumbnail:!1,supportPreview:(e,t)=>!1,supportedPermissionLevels:[],requiresFetchingSharingInformation:!1};default:return Object(c.a)(e)}}));t.a=o},1953:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(282);function i(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(r.a)(e)}}},1990:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FetchDataProviderResourceRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2048:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(6),i=n(296),c=n(52),o=n(2270),a=n(99),u=n(2),s=n(32),l=n(2050),d=n(2049);function f(e,t,n,f=!1,b=null){if(!e||!e.Id||!e.mailboxInfo)return null;const p=Object(l.b)(e.mailboxInfo),m=null==p?void 0:p.downloadUrlBase,h=Object(d.a)(e.mailboxInfo);if(b=b||Object(r.c)(t,encodeURIComponent(e.Id)),!m||f&&"Firefox"===Object(a.a)().browser){const e=o.e+b+"&X-OWA-CANARY="+Object(c.a)();return Object(s.a)(e)}let O="{0}{1}/{2}";Object(i.a)()&&(O+="&isc=1");let v=Object(r.c)(O,m,h,b);return n&&(v+="&token="+(null==p?void 0:p.downloadToken),v+="&X-OWA-CANARY="+Object(c.a)()),v+="&owa="+window.location.hostname,v+="&scriptVer="+Object(u.u)()||!1,v}},2049:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(225),i=n(287);function c(e){if("ArchiveMailbox"==e.type)return Object(r.a)();const t=e.userIdentity&&Object(i.r)(e.userIdentity),n="GroupMailbox"===e.type;return t&&!n?Object(r.b)(e.mailboxSmtpAddress)+e.userIdentity:"UserMailbox"===e.type?Object(r.a)():e.mailboxSmtpAddress}},2050:function(e,t,n){"use strict";var r=n(287);const i={};function c(e){return i[e]}function o(e,t){const n=i[e];i[e]=Object.assign(Object.assign({},n),t)}var a=n(57),u=n(614),s=n(71),l=n(912),d=n(811),f=n(35);var b=n(36),p=n(1744),m=n(1743);const h=Object(d.b)({timeBetweenRetryInMS:()=>3e4});async function O(e){const t=async()=>{try{let t={};return Object(u.b)()?t={sourceId:Object(l.a)(null==e?void 0:e.userIdentity)}:Object(r.r)(e.userIdentity)&&(t=await async function(e){let t={};t.headers=new Headers;const n=await Object(p.a)(e);return Object(m.b)(t.headers,n),t}(e.userIdentity)),function(e){return Object(f.a)("GetAttachmentDownloadToken",{},e)}(t)}catch(e){throw b.h.warn(`Unable to get the download token ${e}`),e.networkError=!0,e}},n=c(e.userIdentity);if(!(null==n?void 0:n.isRefreshingDownloadToken)){o(e.userIdentity,{isRefreshingDownloadToken:!0});let n=0;const{retriableFunc:r}=h(async()=>{n++;const r=await t();b.h.info("update new token"),o(e.userIdentity,{downloadToken:r,isRefreshingDownloadToken:!1})}),i=new s.c("AttachmentRefreshDownloadToken");try{await r(),i.addCustomData([n]),i.end()}catch(t){b.h.warn(`Retry to refresh token failed: ${t}`),i.addCustomData([n]),i.endWithError("ServerError",t),o(e.userIdentity,{isRefreshingDownloadToken:!1})}}}function v(e){const t=Object(r.r)(e.userIdentity)?Object(a.h)(e.userIdentity):Object(a.g)(),n=null==t?void 0:t.ApplicationSettings;if(n){const t=n.DownloadUrlBase;o(e.userIdentity,{downloadUrlBase:t,downloadToken:n.FirstDownloadToken}),t&&function(e,t){t=t<1?1:t,Object(u.b)()&&O(e),setInterval(()=>{O(e)},6e4*t)}(e,n.DownloadTokenRefreshMinutes)}}var w=n(282);function g(e){const t=Object(r.j)(null==e?void 0:e.userIdentity),n=c(null==e?void 0:e.userIdentity);if((null==n?void 0:n.downloadToken)&&(null==n?void 0:n.downloadUrlBase))return n;switch(t){case null:case"Office365":case"Outlook":v(e);break;case"Google":case"Yahoo":case"ICloud":break;default:Object(w.a)(t)}const i=c(e.userIdentity);return i||(Object(s.o)("FilesUrlDataNotFound",{accountProviderType:t}),b.h.warn("Unable to get the url data")),i}function y(e){if(!e)return null;const t=g(e);return null==t?void 0:t.downloadToken}n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return y}))},213:function(e,t,n){"use strict";var r=n(36);let i;function c(){return null==i&&(i="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),i}var o=n(113);const a=500,u=[],s=[],l=[];let d=!0;function f(e,t){Object(r.g)((e,t,n,i)=>{d&&(t==r.b.Error&&s.push({message:e,error:i}),u.push({message:e,level:t}))}),e(p),t(p),c()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function b(e){const t=Object(o.a)(e);return d=!1,{traces:u,errors:s,network:l,usage:t}}function p(){d&&l.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return o.b})),n.d(t,"c",(function(){return c}))},2130:function(e,t,n){"use strict";var r=n(1774);function i(){const e=Object(r.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var c=n(1953),o=n(1738);function a(){return i()}function u(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(o.a)(e)}(e))}(e)?i():[]).map(c.a)}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return u}))},2144:function(e,t,n){"use strict";var r=n(20);const i=[0,1];var c=n(2518),o=n(2500),a=n(6),u=n(282),s=n(1804);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:s.c.Compose,rank:s.b.Error,message:Object(a.b)(o.a),messageParts:[Object(a.b)(o.a),d()],color:s.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:s.c.Compose,rank:s.b.Error,message:Object(a.b)(c.b),messageParts:[Object(a.b)(c.b),d()],color:s.a.Red};default:return Object(u.a)(e)}}function d(){return{text:Object(a.b)(c.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var f=n(2130),b=n(1953),p=n(47),m=n(1774);function h(){const e=Object(m.a)();if(Object(p.j)("fwk-devTools")){if(Object(p.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(p.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function O(){const e=h();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return w})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return f.a})),n.d(t,"e",(function(){return b.a})),n.d(t,"d",(function(){return O})),n.d(t,"c",(function(){return h}));const v=new r.c(()=>n.e(1929).then(n.bind(null,19270))),w=new r.b(v,e=>e.getAccessIssuesForAttachments)},2190:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1732);function i(e){return(e.__type||e.OwsTypeName)===r.d}},2213:function(e){e.exports=JSON.parse('{"b":"Haa","d":"Iaa","c":"Jaa","a":"Kaa"}')},2238:function(e,t,n){"use strict";var r=n(282),i=n(2614),c=n(52),o=n(2712);function a(e,t,n,c,a=!0){var u;const{Name:s,OriginalPermissionType:l,PermissionType:d}=t,f=Object(o.a)(t),b="GroupMailbox"===(null===(u=null==e?void 0:e.mailboxInfo)||void 0===u?void 0:u.type)?e.mailboxInfo.mailboxSmtpAddress+"/":null;switch(n){case 0:case 3:return i.b(e,f,n,c,d,l,a,s,b);case 1:return t.AttachmentPreviewUrl?t.AttachmentPreviewUrl:i.b(e,f,1,c,d,l,a,s,b);case 2:return t.AttachmentThumbnailUrl;default:return Object(r.a)(n)}}function u(e,t,n=!1,r=!0){return i.a(e,t,n,r)}function s(e,t,n,r,o=!1){const s=n?a(e,t,1,r,!1):u(e,1,o,!1);if(n)return{url:s,init:{credentials:"include",headers:new Headers}};{const t=i.c(e.mailboxInfo),n=new Headers;return n.set("X-Token",t),n.set("X-OWA-CANARY",Object(c.a)()),{url:s,init:{headers:n}}}}function l(e,t,n,r,i,c=!1){return r?a(e,t,n,i):u(e,n,c)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return s}))},226:function(e,t,n){"use strict";function r(e){var t,n;if((null==e?void 0:e.length)>0){const r=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(n=e[1])||void 0===n?void 0:n.length)>0?r:void 0}}const i="bearer",c="msauth1.0",o=3600,a=86400,u=6e4,s=1e3;function l(e){if(e){const t=e.split(" ");return r(t)==i?t[1]:e}}function d(e,t){if(e){const n=r(e.split(" "));if(n){if(t){return(1e3*t-Date.now()-u)/s}return n==c?a:o}}}function f(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}))},2264:function(e,t,n){"use strict";function r(e,t){if(null===e)return[];const n=[];if(0===t){const t=e;t.CanShareInternally&&(n.push(2),n.push(1)),t.CanCreateOrganizationEditLink&&n.push(6),t.CanCreateOrganizationViewLink&&n.push(5)}return e.CanCreateAnonymousEditLink&&n.push(4),e.CanCreateAnonymousViewLink&&n.push(3),n.length>0?n:[]}function i(e,t,n){switch(e){case 5:return 4;case 4:return 3;case 3:return 6;case 2:return 5;case 6:return n?t?2:1:0;default:return 0}}var c=n(2933),o=n(6);const a="OneDrivePro";var u=n(282),s=n(38);function l(e,t){switch(e){case 3:return Object(o.b)(c.b);case 4:return Object(o.b)(c.a);case 6:return Object(o.b)(c.d);case 5:return Object(o.b)(c.e);case 1:return t===a?Object(o.b)(c.g):Object(o.b)(c.b);case 2:return t===a?Object(o.b)(c.f):Object(o.b)(c.a);case 0:return Object(o.b)(c.c);default:return Object(u.a)(e)}}function d(e,t){return 0===t?function(e){var t;const n=null===(t=Object(s.a)().SessionSettings)||void 0===t?void 0:t.CompanyName;switch(e){case 3:return Object(o.b)(c.i);case 4:return Object(o.b)(c.h);case 6:return Object(o.c)(Object(o.b)(c.j),n);case 5:return Object(o.c)(Object(o.b)(c.k),n);case 1:return Object(o.b)(c.g);case 2:return Object(o.b)(c.f);case 0:return Object(o.b)(c.c);default:return Object(u.a)(e)}}(e):l(e,null)}function f(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return f}))},2268:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(35),i=n(1990);function c(e,t){return void 0===e||e.__type||(e=Object(i.a)(e)),Object(r.a)("FetchDataProviderResource",e,t)}},2270:function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return l}));const r="/owa/",i="service.svc/s/GetFileAttachment?id={0}",c="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}",o="service.svc/s/GetAttachmentThumbnail?id={0}&thumbnailType=2",a="service.svc/s/GetReferenceAttachment?attachmentId={0}&location={1}&isImagePreview=True",u="service.svc/s/GetAttachmentThumbnail?id={0}",s="pdfprint.aspx?id={0}",l="pdfprint.aspx?id={0}&location={1}"},2271:function(e,t,n){"use strict";var r=n(282),i=n(6),c=n(52),o=n(2270);const a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd",".tiff",".tif"];var u=n(2048),s=n(32);function l(e,t,n,l,d=0,f=0,b=!0,p=null,m=null){let h;switch(n){case 0:h=o.f;break;case 3:h=o.h;break;case 1:if(!function(e){if(!e)return!1;let t=null;const n=e.lastIndexOf(".");return n>0&&(t=e.substr(n).toLowerCase()),!!t&&a.indexOf(t.toLowerCase())>=0}(p))return null;h=o.g;break;default:Object(r.a)(n)}let O=l?f:d;!O&&d&&(O=d);let v=Object(i.c)("{0}&permissionLevel={1}",Object(i.c)(h,encodeURIComponent(e.Id),encodeURIComponent(t)),O);const w=Object(u.a)(e,h,!0,3===n,v);if(w)return w;let g=Object(i.c)("{0}{1}{2}",o.e,m,v);if(b){g=`${g}&X-OWA-CANARY=${Object(c.a)()}`}return Object(s.a)(g)}function d(e,t,n=!1,c=!0){let a;switch(t){case 0:a=o.a;break;case 1:a=o.b;break;case 2:a=o.d;break;case 3:a=o.c;break;default:return Object(r.a)(t)}if(!Object(i.k)(a)){const r=Object(u.a)(e,a,c,3===t);return Object(i.c)("{0}{1}{2}",r,n?"&isDownload=true":"","&animation=true")}return null}n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}))},2355:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return o}));var r=n(1709);const i=[".txt",".xml",".log"];function c(e){return o(Object(r.a)(e))}function o(e){return!!e&&i.indexOf(e.toLowerCase())>=0}},2425:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1732);function i(e){return(e.__type||e.OwsTypeName)===r.a}},2435:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1778),i=n(1777);const c=[0,1,3,2,6,5,7,8,4];function o(e){let t=null;const n=function(n){const r=Object(i.b)(n);return null===r?null:function(){if(!t){t={};for(const n of c)t[n]=e(n)}return t}()[r]};return{getDataProviderInfo:n,getDefaultDataProviderInfo:function(e){return n(e?r.h:r.i)}}}},2488:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r=["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"];function i(e){return!!e.ContentType&&r.indexOf(e.ContentType.toLowerCase())>-1}},2500:function(e){e.exports=JSON.parse('{"a":"rda"}')},2518:function(e){e.exports=JSON.parse('{"a":"pda","b":"qda"}')},2521:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1732);function i(e){return(e.__type||e.OwsTypeName)===r.c}},2614:function(e,t,n){"use strict";var r=n(2271);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}));var i=n(2050);n.d(t,"c",(function(){return i.a}));var c=n(2049);n.d(t,"e",(function(){return c.a}));var o=n(2048);n.d(t,"d",(function(){return o.a}))},2712:function(e,t,n){"use strict";function r(e){let t=null;return t=e.AttachLongPathName,t||(t=e.WebUrl),t}n.d(t,"a",(function(){return r}))},2776:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1732);function i(e){return(e.__type||e.OwsTypeName)===r.b}},283:function(e,t,n){"use strict";var r=n(907);n.d(t,"a",(function(){return r.a}))},2889:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2199),i=n(2974);async function c(e){var t;const n=Object(i.a)(e.AttachLongPathName);return(null===(t=(await Object(r.j)(n)).result)||void 0===t?void 0:t.thumbnailLink)||null}},291:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(135),i=n(100),c=n(2);let o;function a(e){o=e}async function u(e){var t,n;if(Object(c.Q)())return i.f.importAndExecute(Object(r.a)());const a=o&&await o(void 0,e);if(a&&a.length>0){if("bearer"===(null===(t=null==a?void 0:a.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return a.split(" ")[1];if("msauth1.0"===(null===(n=null==a?void 0:a.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return a}}},2933:function(e){e.exports=JSON.parse('{"b":"bda","a":"cda","d":"dda","e":"eda","g":"fda","f":"gda","c":"hda","i":"ida","h":"jda","j":"kda","k":"lda"}')},2955:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(99);function i(e,t){return r.d()||r.e()||r.h()?function(e){const t=["Chrome PDF Viewer","Microsoft Edge PDF Viewer","WebKit built-in PDF"];e=e||(null===navigator||void 0===navigator?void 0:navigator.plugins);try{return"function"==typeof(null==e?void 0:e.namedItem)&&t.some(t=>null!==e.namedItem(t))}catch(e){}return!1}(t):(r.f(),!1)}},2974:function(e,t,n){"use strict";function r(e){const t=e.indexOf("/d/");return e.substring(t+3,e.indexOf("/",t+3))}n.d(t,"a",(function(){return r}))},3020:function(e,t,n){"use strict";var r=n(1943),i=n(1696);function c(e){const t=Object(i.b)(e.Name);return t&&".pdf"===t.toLowerCase()}const o=[".mp3"];const a=[".ics",".ical",".ifb",".icalendar"];const u=[".eml",".msg"];var s=n(2488),l=n(1738);const d=["image/jpeg","image/png","image/gif","image/bmp"];function f(e){return Object(i.g)(e.Name)||!Object(l.a)(e)&&function(e){if(e)return d.indexOf(e.toLowerCase())>=0;return!1}(e.ContentType)}var b=n(2955),p=n(1786);function m(e,t){if(c(e)&&Object(b.a)()){if(t)return!0;{const t=Object(p.c)(e,!0);return Object(p.b)(e,!0).directFileAccessEnabled&&t.directFileAccessEnabled}}return!1}var h=n(2355);const O=[".mp4"],v=[".mov"];var w=n(296),g=n(2425),y=n(2521),j=n(2776),P=n(2190);function I(e,t){let n;if(Object(l.a)(t)||Object(P.a)(t)){n=function(e){const t=Object(r.a)(e.ProviderType);return t&&t.supportPreview(e,Object(w.a)())}(t)?f(t)?e.directFileAccessEnabled?2:0:Object(s.a)(t)?6:m(t,!0)?e.directFileAccessEnabled?3:0:e.useWac?4:0:0}else n=Object(g.a)(t)?e.level===p.a.Block?1:e.level===p.a.AccessDisabled?0:f(t)?2:c(t)?function(e,t){if(!Object(p.e)().isPdfPreviewEnabled())return 1;if(m(t,!1))return 3;if(function(e){return c(e)}(t))return 7;if(e.useWac)return 4;return 0}(e,t):e.useWac?4:function(e){const t=Object(i.b)(e.Name);return!!t&&o.indexOf(t.toLowerCase())>=0}(t)?5:function(e){const t=Object(i.b)(e.Name);return!!t&&u.indexOf(t.toLowerCase())>=0}(t)?10:Object(h.b)(t.Name)?11:function(e,t){var n;const r=Object(i.b)(e.Name);if(r){const e=t||((null===(n=null===window||void 0===window?void 0:window.navigator)||void 0===n?void 0:n.userAgent)?window.navigator.userAgent:""),i=-1!==e.indexOf("Safari")&&-1===e.indexOf("Chrome");return O.indexOf(r.toLowerCase())>=0||i&&v.indexOf(r.toLowerCase())>=0}return!1}(t)?12:function(e){const t=Object(i.b)(e.Name);return!!t&&-1!==a.indexOf(t.toLowerCase())}(t)?13:0:Object(j.a)(t)?8:Object(y.a)(t)?9:0;return n}n.d(t,"a",(function(){return I}))},811:function(e,t,n){"use strict";function r(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:t,timeBetweenRetryInMS:n}=e;return e=>{let r=0,i=!1;const c=(o,a)=>{i?a(new Error("The function retry was cancelled")):(r++,e().then(e=>o(e)).catch(e=>{t&&r>=t?a(e):setTimeout(()=>c(o,a),n(r))}))};return{retriableFunc:()=>new Promise((e,t)=>c(e,t)),cancel:()=>i=!0}}}function i(e){return t=>Math.pow(2,t)*e}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}))},9063:function(e,t,n){"use strict";var r=n(1713),i=n(1778),c=n(2889),o=n(1862),a=n(3),u=Object(a.mutatorAction)("updateAttachmentThumbnailImageUrl",(e,t)=>{e.thumbnailImage.url=t}),s=n(2238);async function l(e,t,n=!1){const a=Object(r.a)(e);if(Object(o.b)(a.model))switch(a.model.ProviderType){case i.e:try{const e=await Object(c.a)(a.model);u(a,e)}catch(e){u(a,null)}break;case i.h:case i.i:if(!a.thumbnailImage.url){const e=a.model;e.AttachmentThumbnailUrl&&u(a,e.AttachmentThumbnailUrl)}}else{const r=Object(s.a)(e,a.model,2,Object(o.b)(a.model),t,n);u(a,r)}}n.d(t,"a",(function(){return l}))},907:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.108.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.108.js'] = 1;