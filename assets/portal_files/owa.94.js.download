(window.$wj=window.$wj||[]).push([[94],{1989:function(e,n,i){"use strict";function a(e){return Object.assign({__type:"BodyContentType:#Exchange"},e)}i.d(n,"a",(function(){return a}))},2212:function(e,n,i){"use strict";var a;i.d(n,"a",(function(){return a})),function(e){e.Get="GET",e.Post="POST",e.Put="PUT",e.Delete="DELETE",e.AuthorizationTag="Authorization",e.BearerTokenHeader="Bearer ",e.Patch="PATCH",e.ContentTypeHeader="Content-type",e.ContentTypeValue="application/json",e.PreferTag="Prefer",e.XAnchorMailbox="X-AnchorMailbox",e.PreferValueExchangeBehaviorTag="exchange.behavior",e.PreferValueGroupMembers="GroupMembers",e.PreferValueGroupDetailsExtended="GroupDetailsExtended",e.PreferValueUpdateGroup="UpdateGroup",e.PreferValueUpdateGroupV2="UpdateGroupV2",e.GenerateRWCToken="GenerateReadWriteConsistencyToken",e.RWCTokenResponseHeader="ReadWriteConsistencyToken",e.OIDPrefix="OID:"}(a||(a={}))},2329:function(e,n,i){"use strict";i.d(n,"a",(function(){return t}));var a=i(35);function t(e,n){return Object(a.a)("GetWacAttachmentInfo",e,n)}},2376:function(e,n,i){"use strict";var a,t,r,o,s;i.d(n,"d",(function(){return a})),i.d(n,"a",(function(){return t})),i.d(n,"c",(function(){return r})),i.d(n,"b",(function(){return s})),function(e){e.Beta="/api/beta/",e.V1="/api/V1.0/",e.V2="/api/V2.0/"}(a||(a={})),function(e){e.Mail="MailFolders/inbox/"}(t||(t={})),function(e){e.Groups="groups/",e.AddMembers="/addmembers",e.Members="members/",e.MailFolders="mailfolders",e.ChildFolders="childfolders",e.MessageRules="messagerules/",e.CopyFolder="copy",e.MoveFolder="move"}(r||(r={})),function(e){e.Me="me/"}(o||(o={})),function(e){e.Count="@odata.count"}(s||(s={}))},2662:function(e,n,i){"use strict";i.d(n,"a",(function(){return r}));var a=i(38),t=i(47);function r(){var e;return(null===(e=Object(a.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(t.j)("cmp-proxy-address")}},3049:function(e,n,i){"use strict";function a(e,n,i){var a,t,r,o,s;const l=e.groups.get(n.toLowerCase());if(l||(i.unreadMessageCount=null,i.groupDetailsError=i.groupDetailsError||!1),!i.groupDetailsError||l&&l.basicInformation||(i.basicInformation={SmtpAddress:n,DisplayName:n}),i.groupDetails){const e=i.groupDetails;l&&l.basicInformation&&!l.groupDetailsError||(i.basicInformation={SmtpAddress:e.SmtpAddress,DisplayName:e.DisplayName,AccessType:e.AccessType,LegacyDN:e.LegacyDN,MailboxGuid:e.MailboxGuid}),i.groupDetails.UserGroupRelationship={SubscriptionType:(null===(a=e.UserGroupRelationship)||void 0===a?void 0:a.SubscriptionType)||0,IsSubscribed:(null===(t=e.UserGroupRelationship)||void 0===t?void 0:t.IsSubscribed)||!1,ShouldIgnoreReply:(null===(r=e.UserGroupRelationship)||void 0===r?void 0:r.ShouldIgnoreReply)||!1,IsMember:(null===(o=e.UserGroupRelationship)||void 0===o?void 0:o.IsMember)||!1,IsOwner:(null===(s=e.UserGroupRelationship)||void 0===s?void 0:s.IsOwner)||!1}}return i}var t=i(702),r=i(2017);const o=Object(t.action)("addOrUpdateGroup")((e,n,i,t,o)=>{var s;n=n.toLowerCase();const l=void 0!==t&&""!==t;if(l&&(t=t.toLowerCase(),n=i.groupDetails.SmtpAddress),i=a(e,l?t:n,i),e.groups.has(n)||l&&e.groups.has(t)){const a=e.groups.has(n)?e.groups.get(n):e.groups.get(t);i.basicInformation&&(a.basicInformation=i.basicInformation),i.groupDetails&&((null===(s=a.groupDetails)||void 0===s?void 0:s.MailboxSettings)&&!i.groupDetails.MailboxSettings&&(i.groupDetails.MailboxSettings=a.groupDetails.MailboxSettings),a.groupDetails=i.groupDetails),i.members&&(a.members=i.members),null!=i.groupDetailsError&&(a.groupDetailsError=i.groupDetailsError),l&&n!==t&&(void 0!==o&&o(n,t),e.groups.set(n,a),e.groups.delete(t),Object(r.a)().smtpAddress=n)}else e.groups.set(n,i)});n.a=o},4006:function(e,n,i){"use strict";var a=i(702),t=i(1954),r=i(2305),o=i(1913),s=i(3049),l=i(2135),d=i(1960);var u=function(e,n){const i=Object(d.b)(n,"Site");i?!function(e){return-1==e.indexOf("_layouts/groupstatus.aspx")}(i)?Object(l.a)(e,1):Object(l.a)(e,2):Object(l.a)(e,0)},c=i(3);const m=Object(c.action)("beforeGetGroupDetailsStartAction",e=>({groupSmtpAddress:e}));Object(c.orchestrator)(m,e=>{3==Object(o.h)(e.groupSmtpAddress)&&Object(o.n)(e.groupSmtpAddress,1)});var p=m,v=i(2017),b=Object(c.mutatorAction)("updateCurrentGroupIdAndTenantIdAction",(e,n)=>{Object(v.a)().groupId=e,Object(v.a)().tenantId=n});const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"GroupDetails"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"loadFullDetails"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupDetails"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mailboxSmtpAddress"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}}},{kind:"Argument",name:{kind:"Name",value:"loadFullDetails"},value:{kind:"Variable",name:{kind:"Name",value:"loadFullDetails"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AccessType"}},{kind:"Field",name:{kind:"Name",value:"GroupId"}},{kind:"Field",name:{kind:"Name",value:"Kind"}},{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"SmtpAddress"}},{kind:"Field",name:{kind:"Name",value:"TenantId"}},{kind:"Field",name:{kind:"Name",value:"Details"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"AllowExternalSenders"}},{kind:"Field",name:{kind:"Name",value:"AutoSubscribeNewMembers"}},{kind:"Field",name:{kind:"Name",value:"Classification"}},{kind:"Field",name:{kind:"Name",value:"Culture"}},{kind:"Field",name:{kind:"Name",value:"Description"}},{kind:"Field",name:{kind:"Name",value:"HasGuests"}},{kind:"Field",name:{kind:"Name",value:"IsJoinRequestPendingApproval"}},{kind:"Field",name:{kind:"Name",value:"IsMembershipHidden"}},{kind:"Field",name:{kind:"Name",value:"IsMembershipDynamic"}},{kind:"Field",name:{kind:"Name",value:"IsMember"}},{kind:"Field",name:{kind:"Name",value:"IsOwner"}},{kind:"Field",name:{kind:"Name",value:"IsSubscribedByMail"}},{kind:"Field",name:{kind:"Name",value:"MemberCount"}},{kind:"Field",name:{kind:"Name",value:"OwnerCount"}},{kind:"Field",name:{kind:"Name",value:"ProxyAddresses"}},{kind:"Field",name:{kind:"Name",value:"Resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Url"}}]}},{kind:"Field",name:{kind:"Name",value:"RetentionPolicyTags"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Description"}},{kind:"Field",name:{kind:"Name",value:"DisplayName"}},{kind:"Field",name:{kind:"Name",value:"IsArchive"}},{kind:"Field",name:{kind:"Name",value:"IsVisible"}},{kind:"Field",name:{kind:"Name",value:"OptedInto"}},{kind:"Field",name:{kind:"Name",value:"ParentLabelIdentity"}},{kind:"Field",name:{kind:"Name",value:"Priority"}},{kind:"Field",name:{kind:"Name",value:"RetentionAction"}},{kind:"Field",name:{kind:"Name",value:"RetentionId"}},{kind:"Field",name:{kind:"Name",value:"RetentionPeriod"}},{kind:"Field",name:{kind:"Name",value:"Type"}}]}},{kind:"Field",name:{kind:"Name",value:"SendAsPermission"}},{kind:"Field",name:{kind:"Name",value:"SubscriptionType"}},{kind:"Field",name:{kind:"Name",value:"SubscriptionTypeAllowedValues"}}]}}]}}]}}]};var D=i(705),g=i(47);function y(e){switch(e){case"None":return 0;case"MoveToDeletedItems":return 1;case"MoveToFolder":return 2;case"DeleteAndAllowRecovery":return 3;case"PermanentlyDelete":return 4;case"MarkAsPastRetentionLimit":return 5;case"MoveToArchive":return 6;default:return}}function f(e){switch(e){case"Calendar":return 1;case"Contacts":return 2;case"DeletedItems":return 3;case"Drafts":return 4;case"Inbox":return 5;case"JunkEmail":return 6;case"Journal":return 7;case"Notes":return 8;case"Outbox":return 9;case"SentItems":return 10;case"Tasks":return 11;case"All":return 12;case"ManagedCustomFolder":return 13;case"RssSubscriptions":return 14;case"SyncIssues":return 15;case"ConversationHistory":return 16;case"Personal":return 17;case"RecoverableItems":return 18;case"NonIpmRoot":return 19;default:return}}function N(e){return Object.assign(Object.assign({},e),{Type:f(e.Type),RetentionAction:y(e.RetentionAction)})}var S=i(2263);function A(e){var n,i,a,t;let r=void 0;switch(null===(n=e.Details)||void 0===n?void 0:n.SubscriptionType){case"None":r=0;break;case"ReplyOnly":r=1;break;case"ReplyAndCalendar":r=2;break;case"All":r=3}return{IsMember:null===(i=e.Details)||void 0===i?void 0:i.IsMember,IsOwner:null===(a=e.Details)||void 0===a?void 0:a.IsOwner,IsSubscribed:null===(t=e.Details)||void 0===t?void 0:t.IsSubscribedByMail,SubscriptionType:r}}function I(e){var n,i,a,t,r;return{ExternalSendersEnabled:null===(n=e.Details)||void 0===n?void 0:n.AllowExternalSenders,AutoSubscribeNewMembers:null===(i=e.Details)||void 0===i?void 0:i.AutoSubscribeNewMembers,MailboxCultureName:null===(a=e.Details)||void 0===a?void 0:a.Culture,RetentionPolicyTags:(r=null===(t=e.Details)||void 0===t?void 0:t.RetentionPolicyTags,r?r.map(N):null)}}function F(e){var n,i,a,t,r;return{ExternalMemberCount:(null===(n=e.Details)||void 0===n?void 0:n.HasGuests)?1:0,IsMembershipDynamic:null===(i=e.Details)||void 0===i?void 0:i.IsMembershipDynamic,IsGroupMembershipHidden:null===(a=e.Details)||void 0===a?void 0:a.IsMembershipHidden,IsJoinRequestPendingApproval:null===(t=e.Details)||void 0===t?void 0:t.IsJoinRequestPendingApproval,SendAsPermission:null===(r=e.Details)||void 0===r?void 0:r.SendAsPermission}}function O(e){var n,i;return{SubscriptionType:{AllowedValues:null===(i=null===(n=e.Details)||void 0===n?void 0:n.SubscriptionTypeAllowedValues)||void 0===i?void 0:i.map(e=>{switch(e){case"ReplyOnly":return"Message";case"ReplyAndCalendar":return"Calendar";default:return e}})}}}const M=(e,n,i,a)=>{const t=e;t&&void 0!==t?(Object(s.a)(Object(o.j)(),t.SmtpAddress,{basicInformation:null,groupDetails:t,members:null,groupDetailsError:!1}),b(t.ExternalDirectoryObjectId,t.ExternalDirectoryOrganizationId),u(n,t),i&&i()):T(n,a)},T=(e,n)=>{Object(s.a)(Object(o.j)(),e,{basicInformation:null,groupDetails:null,members:null,groupDetailsError:!0}),Object(o.n)(e,0),n&&n()},h=Object(a.action)("getGroupDetailsAction")((async function(e,n,i,a){var o;if(p(e),Object(g.j)("grp-groupDetails-gql")){const t=Object(D.a)();try{const r=null===(o=(await t.query({query:k,variables:{mailboxSmtpAddress:e,loadFullDetails:n}})).data)||void 0===o?void 0:o.groupDetails,s=r?function(e){var n,i,a,t,r,o;return{SmtpAddress:e.SmtpAddress,DisplayName:e.Name,AccessType:Object(S.o)(e.AccessType),ProxyAddresses:null===(n=e.Details)||void 0===n?void 0:n.ProxyAddresses,ExternalDirectoryOrganizationId:e.TenantId,Kind:e.Kind,UserGroupRelationship:A(e),GroupResources:null===(i=e.Details)||void 0===i?void 0:i.Resources,MailboxSettings:I(e),OwnerCount:null===(a=e.Details)||void 0===a?void 0:a.OwnerCount,Description:null===(t=e.Details)||void 0===t?void 0:t.Description,ExternalDirectoryObjectId:e.GroupId,AdditionalProperties:F(e),Classification:null===(r=e.Details)||void 0===r?void 0:r.Classification,MemberCount:null===(o=e.Details)||void 0===o?void 0:o.MemberCount,EditProperties:O(e)}}(r):void 0;M(s,e,i,a)}catch(n){T(e,a)}}else{(t.g||r.j)(e,n).then(n=>{n&&n.Body&&Object(r.n)(n.Body)?M(n.Body.GroupDetails,e,i,a):T(e,a)}).catch(n=>{T(e,a)})}}));n.a=h}}]);
//# sourceMappingURL=owa.94.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.94.js'] = 1;