(window.$wj=window.$wj||[]).push([[901],{1565:function(e,t,n){"use strict";n.r(t);var r=n(3538);function o(e,t,n,o){return Object(r.g)(n,t,o,e)}n.d(t,"makeOwsPrimeRequest",(function(){return r.g})),n.d(t,"makePostRequest",(function(){return r.e})),n.d(t,"makePatchRequest",(function(){return r.d})),n.d(t,"makePutRequest",(function(){return r.f})),n.d(t,"makeGetRequest",(function(){return r.b})),n.d(t,"makeDeleteRequest",(function(){return r.a})),n.d(t,"makeGraphRequest",(function(){return r.c})),n.d(t,"sendOwsPrimeRequest",(function(){return o}))},188:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,u){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),u&&u(t,n)}.bind(this),o)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var u=e[i];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return o&&t++,u.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var u in r)if(r.hasOwnProperty(u)){if(i)if(e[u])continue;var s=r[u],c=s.expire-o;if(c<=0){this.del(u);continue}c=c>0?c:void 0,this.put(u,s.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},226:function(e,t,n){"use strict";function r(e){var t,n;if((null==e?void 0:e.length)>0){const r=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(n=e[1])||void 0===n?void 0:n.length)>0?r:void 0}}const o="bearer",i="msauth1.0",u=3600,s=86400,c=6e4,a=1e3;function l(e){if(e){const t=e.split(" ");return r(t)==o?t[1]:e}}function d(e,t){if(e){const n=r(e.split(" "));if(n){if(t){return(1e3*t-Date.now()-c)/a}return n==i?s:u}}}function f(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}))},283:function(e,t,n){"use strict";var r=n(907);n.d(t,"a",(function(){return r.a}))},291:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(135),o=n(100),i=n(2);let u;function s(e){u=e}async function c(e){var t,n;if(Object(i.Q)())return o.f.importAndExecute(Object(r.a)());const s=u&&await u(void 0,e);if(s&&s.length>0){if("bearer"===(null===(t=null==s?void 0:s.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return s.split(" ")[1];if("msauth1.0"===(null===(n=null==s?void 0:s.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return s}}},3164:function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return s}));var r=n(2),o=n(40),i=n(57);function u(){let e=Object(r.v)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.v)(t)}function s(){let e=function(){let e="",t=Object(o.b)().pathname.split("/").filter(e=>e.length);return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}();if(0===e.length){let t=Object(i.g)();if(null==t?void 0:t.SessionSettings){let n=t.SessionSettings.ExternalDirectoryTenantGuid,r=t.SessionSettings.UserPuid;r&&n&&(e=`PUID:${r}@${n}`)}}return 0===e.length&&(e=u()),e}},3538:function(e,t,n){"use strict";var r=n(47),o=n(283),i=n(5),u=n(610),s=n(3164),c=n(52),a=n(159),l=n(158),d=n(404),f=n(36),p=n(83),h=n(638);const v="owsserver",b="owsapi";var O=n(2),m=n(160),w=n(161),j=n(10);n.d(t,"g",(function(){return S})),n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return P})),n.d(t,"f",(function(){return A})),n.d(t,"b",(function(){return N})),n.d(t,"a",(function(){return R}));const g=2048;var y=null;function S(e,t,n,o,i,s,c,a,l){const f="object"==typeof n&&n.customHeaders||c,p=f?Object.keys(f).reduce((e,t)=>(e[t.toLowerCase()]=f[t],e),{}):void 0;let h="object"==typeof n?Object.assign(Object.assign({},n),{customHeaders:p}):{returnFullResponse:n,correlationId:i,requestObject:s,customHeaders:p,throwServiceError:a,includeCredentials:l};if(!h.customHeaders||!h.customHeaders.authorization){void 0===h.includeCredentials&&(h.includeCredentials=!Object(r.j)("auth-authzHeaderNoCookies"));let n=Object(u.n)(),[i,s]=Object(d.getAccessTokenforResourceAsLazy)(n,"OwsGateway");return i?k(e,t,h,o,i):s.then(n=>k(e,t,h,o,n))}return k(e,t,h,o)}function k(e,t,n,d,S){var k;const{returnFullResponse:C,correlationId:x,requestObject:P,customHeaders:A,throwServiceError:N,sendPayloadAsBody:R,includeCredentials:T}=n;let q=new Headers;q.append("X-OWA-CANARY",Object(c.a)()),q.append("X-MS-AppName","owa-react"+Object(u.r)()),q.set("X-OWA-SessionId",Object(O.N)());const E={n:Object(a.a)().toString()};x&&(q.append("client-request-id",x),E.cri=x),A&&Object.keys(A).forEach(e=>{q.append(e,A[e])});const I=Object(p.b)();if(I&&(q.append(p.a,I),E.cv=I),S){const e="Authorization";if(S.length>0&&"msauth1.0"===(null===(k=null==S?void 0:S.split(" ")[0])||void 0===k?void 0:k.toLowerCase()))q.append(e,S);else{if(Object(r.j)("fwk-devTools")){var H=S.split(".");3==H.length&&0!==H[2].length||f.d(`BearerTokenIncomplete ${H.length}`)}q.append(e,`Bearer  ${S}`)}}let D={method:t,credentials:!1!==T?"same-origin":"omit",body:n.requestBody,headers:q};if(P){q.append("Content-Type","application/json");const n=JSON.stringify(P),o=e.search(/ows\/|owa\//i)>=0;if(Object(r.j)("fwk-emptyPost")&&o&&"POST"==t&&!R){const e=encodeURIComponent(n);e.length<g?q.append("X-OWA-UrlPostData",e):D.body=n}else D.body=n}Object(m.a)(q),Object(w.a)(q);const $=function(e){const t=new RegExp(/\bows\//,"i");if(e.match(t)){let t=e.split("/");if(t.length>3&&"api"==t[1]||t.length>2){let e="api"==t[1]?t[3]:t[2];return e=null==e?void 0:e.split("?")[0],e}}return null}(e);if(null!=$){const t=Object(r.j)("fwk-owsprimecosmic-everything")||function(e){const t=["ActivityFeed","AdsTargetingOptOutController","Amp","AsgSmsProxy","CalendarIcons","CloudCacheConfig","FloodGateSurvey","getstarted","linkedin","OutlookOptions","outlookfavorites","ScenarioSettings","SchoolCalendars","webpushsubscriptions"];if(Object(r.j)("fwk-owsprimecosmic-selectedApis"))return t.indexOf(e)>-1;return!1}($);if(t){const t=new RegExp(/\bows\//,"i");e=e.replace(t,"owsprime/")}null==d&&(d=t?"OWSPrimeCosmic"+$:"OWSPrime"+$)}let L=async function(e,t){if(!t||!t["x-anchormailbox"]){let t=Object(j.a)().getAnchorMailbox?await Object(j.a)().getAnchorMailbox():Object(s.a)();t&&t.length>0&&(e.headers.append("x-anchormailbox",t),e.headers.append("X-RoutingParameter-SessionKey",t))}return e}(D,A);const G=function(e,t){var n=function(e,t){var n=Object(u.x)(e,t),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(u.g)(r[0]),n=r.join("/"));return Object(u.a)(n)}(Object(r.j)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",e),o=Object(u.n)()+n;if(Object(r.j)("fwk-devTools")&&Object(i.f)(v)&&(Object(i.c)(b)==e||!Object(i.f)(b))&&(null==y&&(y=confirm(`A query param '${v}' is set to redirect some of calls to '${Object(i.c)(v)}'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.`)),y)){var s=e.split("/");s.length>0&&("ows"==s.shift()||"owsprime"==s.shift())&&(e=s.join("/")),o=Object(i.c)(v)+"/"+e}return Object(u.v)(o,t)}(e,E),F=Object(l.a)(G,L);return Object(h.a)(D,n,F,d,G),F.then(n=>{if(C)return n;if(Object(o.a)(n.status))return n.text().then(e=>e?JSON.parse(e):{});throw new Error(`${t} request to ${e} failed, http error:${n.status}`)}).catch(e=>{if(f.h.warn(e),N){throw{stack:e.stack,message:e.message,correlationVector:I,correlationId:n.correlationId,networkError:!0}}return[]})}function C(e,t){var n,r;let o="OWSGateway";try{let e=null===(r=null===(n=JSON.parse(t))||void 0===n?void 0:n[0])||void 0===r?void 0:r.operationName;null!=e&&(o=o+"."+e)}catch(e){}return S(e,"POST",{requestBody:t,customHeaders:{"Content-Type":"application/json"},returnFullResponse:!0},o)}function x(e,t,n,r,o,i,u,s,c,a){return S(e,"POST",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:o,throwServiceError:i,sendPayloadAsBody:u,includeCredentials:s,datapoint:a},c)}function P(e,t,n,r,o,i,u,s){return S(e,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:o,throwServiceError:i,includeCredentials:u},s)}function A(e,t,n,r,o,i,u,s){return S(e,"PUT",r,u,n,t,o,i,s)}function N(e,t,n,r,o,i,u){return S(e,"GET",n,u,t,void 0,r,o,i)}function R(e,t,n,r,o,i,u,s){return S(e,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:o,throwServiceError:i,includeCredentials:u},s)}},907:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.901.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.901.js'] = 1;