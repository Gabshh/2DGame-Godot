(window.$wj=window.$wj||[]).push([[28],{1981:function(e,t,n){"use strict";var r=n(2645),i=n(2125),s=n(327),u=n(2265),o=n(36),a=n(610);function c(e,t,n,r,c,l,d,f){const m={cvid:n,query:e,textdecorations:"1",scenario:c,entityTypes:r};return d&&(m.logicalId=d),f&&(null==e?void 0:e.length)>0&&(m.setflight=f),t?Object(s.b)(Object(a.v)(Object(i.a)("suggestions"),Object(u.a)(m)),void 0,!0,l,void 0,!1).then(e=>e).catch(e=>(o.h.warn(e),null)):Promise.resolve(null)}var l=n(2124),d=n(1934),f=n(1764),m=n(2582);function g(e,t,n,r){const i=[];if(r===n){const n={Range:{[r]:{gte:t,lte:e}}};i.push(n)}else{const s={Range:{[r]:{gte:t}}};i.push(s);const u={Range:{[n]:{lte:e}}};i.push(u)}return i}var I=n(1678),h=n(1698),p=n(1679);function v(e,t,n,r=null){const i=[];0===e.length&&0===t.length&&null!=r&&e.push(Object(I.a)(r));for(const e of t)i.push({Term:{DistinguishedFolderName:e}});for(const t of e){if(t&&Object(h.a)(t)==p.d)return[];i.push({Term:{FolderId:t}})}n&&i.push({Term:{DistinguishedFolderName:"DeletedItems"}});const s=[],u={Or:i};return s.push(u),i.length>0?s:null}function b(e){var t,n;return(null===(n=null===(t=null==e?void 0:e.TimeZoneContext)||void 0===t?void 0:t.TimeZoneDefinition)||void 0===n?void 0:n.Id)?e.TimeZoneContext.TimeZoneDefinition.Id:"UTC"}function S(e){var t,n,r;return(null===(r=null===(n=null===(t=null==e?void 0:e.EntitySets)||void 0===t?void 0:t[0])||void 0===n?void 0:n.ResultSets)||void 0===r?void 0:r[0])?e.EntitySets[0].ResultSets[0]:null}function C(e){return e?{Id:e.Id,ChangeKey:null}:null}function y(e,t){let n=null;if(null==t?void 0:t.TimeZone){n=new Date(e).toISOString()}return n}function T(e){return(null==e?void 0:e.EmailAddress)?{Mailbox:{EmailAddress:e.EmailAddress.Address,Name:e.EmailAddress.Name,RoutingType:"SMTP"}}:null}function O(e){return e?{__typename:"FolderId",Id:e.Id}:null}function R(e){switch(e){case"DateTime":return"DateTime";case"Hybrid":return"Hybrid";case"Relevance":return"Relevance";default:return null}}function j(e){if(null===e||0===e.length)return null;const t=[];for(let n=0;n<e.length;n++)t[n]=C(e[n]);return t}function D(e){var t;return(null===(t=null==e?void 0:e.QueryId)||void 0===t?void 0:t.Id)?{Id:e.QueryId.Id}:null}var E=n(38);const w="IPM.Appointment";function M(e){var t;const n=T(e.Organizer);return{CalendarItemType:e.CalendarItemType.toString(),Categories:e.Categories,CharmId:e.Charm,DisplayTo:e.DisplayTo,End:e.End,Start:e.Start,HasAttachments:e.HasAttachments,IsAllDayEvent:e.IsAllDayEvent,IsMeeting:e.IsMeeting,IsMeetingPollEvent:e.IsMeetingPollEvent,ItemClass:e.ItemClass?e.ItemClass:w,FreeBusyType:e.LegacyFreeBusyStatus?e.LegacyFreeBusyStatus.toString():null,Location:{DisplayName:e.Location},Sensitivity:e.Sensitivity,SeriesId:e.SeriesMasterItemId?e.SeriesMasterItemId.Id:null,Subject:e.Subject,Organizer:n,UID:e.UID,ItemId:C(e.ItemId),ParentFolderId:O(e.ParentFolderId),SerializedImmutableId:e.ImmutableId,SortOrderSource:R(e.SortOrderSource),Preview:e.Preview,IsOrganizer:e.IsOrganizer&&Object(E.a)().SessionSettings.UserEmailAddress===(null===(t=null==n?void 0:n.Mailbox)||void 0===t?void 0:t.EmailAddress),IsCancelled:e.IsCancelled,ResponseType:e.MyResponseType}}function x(e,t){var n;return{__typename:"ConversationType",Categories:e.Categories,ConversationId:C(e.ConversationId),ConversationTopic:e.ConversationTopic,FlagStatus:e.FlagStatus,From:T(e.From),GlobalItemIds:j(e.GlobalItemIds),GlobalMessageCount:e.GlobalMessageCount,GlobalUnreadCount:e.GlobalUnreadCount,HasAttachments:e.HasAttachments,HasIrm:e.HasIrm,HasProcessedSharepointLink:e.HasProcessedSharepointLink,Importance:e.Importance,ItemClasses:e.ItemClasses,ItemIds:j(e.ItemIds),LastDeliveryOrRenewTime:y(null!==(n=e.LastDeliveryOrRenewTime)&&void 0!==n?n:e.LastDeliveryTime,t),LastDeliveryTime:y(e.LastDeliveryTime,t),LastModifiedTime:y(e.LastModifiedTime,t),MessageCount:e.MessageCount,ParentFolderId:O(e.ParentFolderId),Preview:e.Preview,SortOrderSource:R(e.SortOrderSource),UniqueRecipients:e.UniqueRecipients,UniqueSenders:e.UniqueSenders,UnreadCount:e.UnreadCount}}var F=n(47),P=n(1846);function U(e,t){var n;const r=function(e){if(!e)return e;const t=e.indexOf(":");return t>0&&t<6&&t+1<e.length?e.substring(t+1).trim():e}(e.Subject),i=Object(F.j)("fwk-immutable-ids")&&e.ImmutableId?{Id:Object(P.b)(e.ImmutableId),ChangeKey:null}:e.ItemId;return{Categories:e.Categories,ConversationId:C(e.ConversationId),ConversationIndex:e.ConversationIndex,ConversationThreadId:{Id:e.ConversationThreadId,ChangeKey:null},ConversationTopic:r,DateTimeReceived:y(e.DateTimeReceived,t),DateTimeSent:e.DateTimeSent&&y(e.DateTimeSent,t),LastModifiedTime:y(e.DateTimeLastModified,t),DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:(s=e.Flag,s?{FlagStatus:s.FlagStatus,CompleteDate:s.CompleteDate,DueDate:s.DueDate,StartDate:s.StartDate}:null),From:T(e.From),HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,IconIndex:e.IconIndex,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:i,MailboxGuids:e.MailboxGuids,ParentFolderId:O(e.ParentFolderId),Preview:e.Preview,Sender:T(e.Sender),SenderSMTPAddress:e.SenderSMTPAddress,Sensitivity:e.Sensitivity,SerializedImmutableId:e.ImmutableId,SortOrderSource:R(e.SortOrderSource),Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,ExtendedProperty:[{ExtendedFieldURI:{DistinguishedPropertySetId:"Common",PropertyId:3613,PropertyType:"String"},Value:r}]};var s}function A(e,t){var n,r,i,s,u,o,a,c,l;let d,f,m,g;if((null==t?void 0:t.length)>0){let e,n,r,i,s;t.sort((e,t)=>e.Timestamp&&t.Timestamp?t.Timestamp.localeCompare(e.Timestamp):0).forEach(t=>{"Modified"!=t.Type||n?"Created"!=t.Type||e?"Shared"!=t.Type||r?"Read"!=t.Type||i?"Trending"!=t.Type||s||(s=!0):i=!0:r=!0:(e=!0,d=t.User,f=t.Timestamp):(n=!0,m=t.User,g=t.Timestamp)})}const I=null!==(s=null!==(i=null!==(r=null!==(n=e.LinkingUrl)&&void 0!==n?n:e.ServerRedirectedURL)&&void 0!==r?r:e.OriginalPath)&&void 0!==i?i:e.ClassicAttachmentVisualizationUrl)&&void 0!==s?s:"";return{ItemId:null!==(a=null!==(o=null!==(u=e.UniqueId)&&void 0!==u?u:e.Id)&&void 0!==o?o:e.DocId)&&void 0!==a?a:"",FileName:null!==(c=e.FileName)&&void 0!==c?c:e.Filename,Title:e.Title,FileExtension:e.FileExtension,LinkingUrl:I,Author:(null==d?void 0:d.DisplayName)?[d.DisplayName]:e.Author,AuthorUpn:(null==d?void 0:d.Upn)||"",Created:null!=f?f:e.Created,ModifiedBy:null!==(l=null==m?void 0:m.DisplayName)&&void 0!==l?l:e.ModifiedBy,ModifiedByUpn:(null==m?void 0:m.Upn)||"",LastModifiedTime:null!=g?g:e.LastModifiedTime}}function N(){return{SearchResults:{MoreResultsAvailable:!1,TotalResultsCount:0,SearchResultsCount:0,TDQueryId:D(null)}}}function q(e){return 0===(e?e.length:0)?null:e.map(e=>({RefinerString:e.RefinerQuery}))}function k(e){if(!e)return"MailItems";switch(e){case"CalendarItems":return"Event";case"MailConversations":return"Conversation";case"MessageItems":return"Email";case"Files":return"File";case"MailItems":default:return"Message"}}var L,B,H=n(1782),_=n(2326),G=n(2152);!function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster"}(L||(L={})),function(e){e[e.Free=0]="Free",e[e.Tentative=1]="Tentative",e[e.Busy=2]="Busy",e[e.Oof=3]="Oof",e[e.WorkingElsewhere=4]="WorkingElsewhere",e[e.NoData=5]="NoData"}(B||(B={}));var J=n(2583),z=n(1892),Q=n(1836);n.d(t,"J",(function(){return r.a})),n.d(t,"K",(function(){return c})),n.d(t,"g",(function(){return l.a})),n.d(t,"r",(function(){return d.a})),n.d(t,"y",(function(){return d.b})),n.d(t,"D",(function(){return f.e})),n.d(t,"E",(function(){return f.g})),n.d(t,"B",(function(){return f.b})),n.d(t,"C",(function(){return f.c})),n.d(t,"z",(function(){return i.a})),n.d(t,"w",(function(){return m.a})),n.d(t,"o",(function(){return g})),n.d(t,"q",(function(){return v})),n.d(t,"A",(function(){return b})),n.d(t,"x",(function(){return S})),n.d(t,"l",(function(){return M})),n.d(t,"k",(function(){return x})),n.d(t,"n",(function(){return U})),n.d(t,"m",(function(){return A})),n.d(t,"j",(function(){return D})),n.d(t,"p",(function(){return N})),n.d(t,"h",(function(){return q})),n.d(t,"i",(function(){return k})),n.d(t,"F",(function(){return H.b})),n.d(t,"e",(function(){return H.a})),n.d(t,"H",(function(){return H.d})),n.d(t,"I",(function(){return H.e})),n.d(t,"G",(function(){return H.c})),n.d(t,"s",(function(){return _.a})),n.d(t,"u",(function(){return G.b})),n.d(t,"t",(function(){return G.a})),n.d(t,"v",(function(){return G.c})),n.d(t,"f",(function(){return J.a})),n.d(t,"c",(function(){return z.b})),n.d(t,"b",(function(){return Q.b})),n.d(t,"d",(function(){return Q.c})),n.d(t,"a",(function(){return Q.a}))},2125:function(e,t,n){"use strict";function r(e,t){return`search/api/${2===t?"v2":"v1"}/${e}`}n.d(t,"a",(function(){return r}))},2152:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return u}));const r=[{resultRowOffset:0,resultRowCount:25,pageNumber:0},{resultRowOffset:25,resultRowCount:50,pageNumber:1},{resultRowOffset:75,resultRowCount:75,pageNumber:2},{resultRowOffset:150,resultRowCount:100,pageNumber:3},{resultRowOffset:250,resultRowCount:200,pageNumber:4},{resultRowOffset:450,resultRowCount:200,pageNumber:5},{resultRowOffset:650,resultRowCount:200,pageNumber:6},{resultRowOffset:850,resultRowCount:200,pageNumber:7}];let i=function(e,t={pageContexts:r}){if(e<0||e>=t.pageContexts.length)throw new Error("The pageNumber for execute search is invalid:"+e);return t.pageContexts[e]},s=function(e,t,n,s={pageContexts:r}){const u=e.pageNumber+1,o="PrimaryMailbox"===n?2:4;return t.MoreResultsAvailable&&u<o?i(u,s):null};const u=e=>{switch(e){case 74:return r[2];case 149:return r[3];case 249:return r[4];case 449:return r[5];case 649:return r[6];case 849:return r[7];default:return null}}},2265:function(e,t,n){"use strict";var r=n(132);var i=n(47),s=n(5);n.d(t,"a",(function(){return o}));const u="searchtesthook";function o(e={}){const t=function(e,...t){const n={};for(const r of t)for(const t of Object.keys(r))e.includes(t)&&n.hasOwnProperty(t)?n[t]=n[t]+","+r[t]:n[t]=r[t];return n}(["setflight"],e,function(){let e={};const t=Object(s.c)(u),n=decodeURIComponent(t||"").trim();if(Object(i.j)("sea-debugHook")&&n.length>0){e=n.split("&").reduce((e,t)=>{const[n,r]=t.split("=");return e[n]=r,e},{})}return e}(),Object(r.a)("includePartnerIn3SRequest")?{partner:"exchangeshared"}:{});return Object.keys(t).filter(e=>null!==t[e]).reduce((e,n)=>Object.assign(Object.assign({},e),{[n]:t[n]}),{})}},2326:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7);function i(){return Object(r.qc)().toString()}},2552:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Constant:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2553:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FieldURIOrConstantType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2554:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"RestrictionType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2582:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2873),i=n(2552),s=n(2553),u=n(3146),o=n(3083),a=n(1701),c=n(2554),l=n(7);const d="DateTimeReceived";function f(e,t,n,f){if(e||t){const m=[];m.push(Object(o.a)({FieldURIOrConstant:Object(s.a)({Item:Object(i.a)({Value:Object(l.ub)(t||l.b)})}),Item:Object(a.a)({FieldURI:n||d})})),m.push(Object(u.a)({FieldURIOrConstant:Object(s.a)({Item:Object(i.a)({Value:Object(l.ub)(e||l.d)})}),Item:Object(a.a)({FieldURI:f||d})}));const g=Object(r.a)({Items:m});return Object(c.a)({Item:g})}return null}},2583:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return p}));var r=n(326),i=n(327),s=n(10),u=n(156),o=n(142),a=n(36),c=n(2);const l="ows/beta/substratesearch/query",d=2048;function f(e,t,n,r,i,s){return g(e,t,n,r,h,i,s)}function m(e,t,n,r,i,s){return g(e,t,n,r,I,i,s)}function g(e,t,n,r,i,s,o){return Object(u.a)().then(u=>{const a=u.headers;s&&a.append("X-OWA-ActionSource",s);const c=i("ExecuteSearch",t,e,n,u,o);let l=0,d=0;return r&&(l=r.addCheckmark("ClientJSPreRequestTime"),Promise.resolve().then(()=>{d=r.addCheckmark("ClientJSRequestThread")})),c?c.then(e=>{const t=e[0],n=e[1],r=[t,n,e[2]];return n.ClientJSPreRequestTime=l,n.ClientJSRequestThreadTime=d,r}):Promise.reject(new Error("Client-side issue prevented request from being sent"))})}function I(e,t,n,i,u,a){const l=JSON.stringify(n),f=encodeURIComponent(l);let m=!1;const g=u.headers;g.append("Content-Type","application/json; charset=utf-8"),u.returnFullResponseOnSuccess=!0,f.length>d?u.body=l:(m=!0,g.append("X-OWA-UrlPostData",f),u.body=null);const I=function(e,t){const n=Object(s.a)();let i=(n.baseUrl?`${n.baseUrl}/service.svc?action=`:"/owa/service.svc?action=")+e+`&app=${Object(c.m)()}`;t&&(i+="&EP=1");return i+="&id="+Object(r.a)(),i}(e,m),h=new Date;return Object(o.a)("ExecuteSearch",I,1,u).then(async e=>{const r=await e.json();return[r,p(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"ExecuteSearch",h,new Date,i,u.headers,t,a),e.url]})}function h(e,t,n,s,u,o){if(!s)return a.d("SearchQueryId must be specified when calling makeExecuteSearchRequest!"),null;const c={};u.headers.forEach((e,t)=>{c[t]=e}),c["X-Search-Griffin-Version"]="GWSv2";const d=new Date;return n.Body.SearchSessionId=s,n.Body.Scenario=o,Object(i.e)(l,n,Object(r.a)(),!0,c).then(async e=>{const r=await e.json();return[r,p(e,n.Body.Query,200==e.status?null:r?JSON.stringify(r.Body):null,"SubstrateSearch",d,new Date,s,u.headers,t,o),e.url]}).catch(e=>(a.h.warn(e),null))}const p=(e,t,n,r,i,s,u,o,a,l)=>{const d=e.headers||new Headers;return{ClientSearchProvider:r,PageNumber:a,ClientNetworkTime:s.getTime()-i.getTime(),ClientJSEndToEndTime:0,ClientJSPreRequestTime:0,ClientJSRequestThreadTime:0,ClientResponseProcessTime:0,ClientJSRenderingTime:0,SearchDateTime:d.get("date"),SearchBETarget:d.get("x-calculatedbetarget"),SearchFETarget:d.get("x-calculatedfetarget"),SearchBEHttpStatus:d.get("x-backendhttpstatus"),SearchMsEdgeRef:d.get("x-msedge-ref"),SearchErrorContent:n,SearchTraceID:d.get("request-id"),SearchQueryId:u,ClientBuildNumber:Object(c.u)(),ClientTimeSentUTC:i,ClientTimeFinishedUTC:s,ClientHttpStatus:e.status||-1,SearchClientRequestID:o.get("client-request-id"),SearchClientSessionID:Object(c.t)(),ClientName:l,DiagnosticsCheckpoints:d.get("x-ms-diagnostics-checkpoints"),ResourceTimingEntry:null,PIIData:{queryText:t}}}},2645:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2265),i=n(2326),s=n(2125),u=n(326),o=n(327),a=n(59),c=n(6),l=n(36),d=n(610);function f(e,t,n,f,g,I){const h=function(e,t,n,r,s){const o=Object(a.b)().bestEffort;o["client-session-id"]=t,o["client-request-id"]=Object(u.a)(),o["x-client-localtime"]=Object(i.a)(),o["X-Search-Griffin-Version"]="GWSv2",o["Accept-Language"]=Object(c.e)(),r&&r.length>0&&(o["x-anchormailbox"]=r[0].mailboxSmtpAddress,o.authorization=r[0].tokenString);n&&(o["X-Client-Flights"]=n);o.scenariotag=function(e){const t=e.EntityRequests.length>1,n=e.EntityRequests[0],r=[];t&&r.push("ErrMER");0==n.From&&r.push("1stPg");const i=m[n.EntityType];return r.push(i||"Unknown"),r.join("_")}(e),s&&Object.keys(s).forEach(e=>{o[e]=s[e]});return o}(e,t,n,f,g);return Object(o.e)(Object(d.v)(Object(s.a)("query",I),Object(r.a)()),e,null,!0,h,void 0,void 0,!1).then(e=>[e,h]).catch(e=>(l.h.warn(e),[e]))}const m={Event:"ev",Conversation:"cv",Email:"em",Message:"mg",MailItems:"mi",CalendarItems:"ci",MailConversations:"mc",MessageItems:"gi"}},2873:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"And:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3083:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsLessThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3146:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"IsGreaterThanOrEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.28.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.28.js'] = 1;