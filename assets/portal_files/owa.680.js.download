(window.$wj=window.$wj||[]).push([[680],{16694:function(e){e.exports=JSON.parse('{"a":"Jca"}')},16695:function(e){e.exports=JSON.parse('{"a":"Ica"}')},16696:function(e){e.exports=JSON.parse('{"b":"Gca","a":"Hca"}')},16697:function(e){e.exports=JSON.parse('{"a":"Fca"}')},16698:function(e){e.exports=JSON.parse('{"a":"Xca"}')},188:function(e,t,r){"use strict";function n(){var e=Object.create(null),t=0,r=0,n=0,o=!1;function i(t){n--,delete e[t]}this.put=function(t,r,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):n++;var u={value:r,expire:o+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),a&&a(t,r)}.bind(this),o)),e[t]=u,r},this.del=function(t){var r=!0,n=e[t];return n?(clearTimeout(n.timeout),!isNaN(n.expire)&&n.expire<Date.now()&&(r=!1)):r=!1,r&&i(t),r},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);n=0,e=Object.create(null),o&&(t=0,r=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&t++,a.value;o&&r++,n--,delete e[i]}else o&&r++;return null},this.size=function(){return n},this.memsize=function(){var t,r=0;for(t in e)r++;return r},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return r},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var r in e){var n=e[r];t[r]={value:n.value,expire:n.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,r){var n=JSON.parse(t),o=Date.now(),i=r&&r.skipDuplicates;for(var a in n)if(n.hasOwnProperty(a)){if(i)if(e[a])continue;var c=n[a],u=c.expire-o;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}e.exports=new n,e.exports.Cache=n},2067:function(e,t,r){var n=r(2074),o=36e5,i=6e4,a=2,c=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],v=/^-(\d{2})$/,p=/^-?(\d{3})$/,b=/^-?(\d{2})-?(\d{2})$/,O=/^-?W(\d{2})$/,m=/^-?W(\d{2})-?(\d{1})$/,w=/^(\d{2}([.,]\d*)?)$/,h=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,j=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,g=/([Z+-].*)$/,y=/^(Z)$/,T=/^([+-])(\d{2})$/,P=/^([+-])(\d{2}):?(\d{2})$/;function D(e,t,r){t=t||0,r=r||0;var n=new Date(0);n.setUTCFullYear(e,0,4);var o=7*t+r+1-(n.getUTCDay()||7);return n.setUTCDate(n.getUTCDate()+o),n}e.exports=function(e,t){if(n(e))return new Date(e.getTime());if("string"!=typeof e)return new Date(e);var r=(t||{}).additionalDigits;r=null==r?a:Number(r);var A=function(e){var t,r={},n=e.split(c);u.test(n[0])?(r.date=null,t=n[0]):(r.date=n[0],t=n[1]);if(t){var o=g.exec(t);o?(r.time=t.replace(o[1],""),r.timezone=o[1]):r.time=t}return r}(e),S=function(e,t){var r,n=d[t],o=f[t];if(r=l.exec(e)||o.exec(e)){var i=r[1];return{year:parseInt(i,10),restDateString:e.slice(i.length)}}if(r=s.exec(e)||n.exec(e)){var a=r[1];return{year:100*parseInt(a,10),restDateString:e.slice(a.length)}}return{year:null}}(A.date,r),x=S.year,k=function(e,t){if(null===t)return null;var r,n,o,i;if(0===e.length)return(n=new Date(0)).setUTCFullYear(t),n;if(r=v.exec(e))return n=new Date(0),o=parseInt(r[1],10)-1,n.setUTCFullYear(t,o),n;if(r=p.exec(e)){n=new Date(0);var a=parseInt(r[1],10);return n.setUTCFullYear(t,0,a),n}if(r=b.exec(e)){n=new Date(0),o=parseInt(r[1],10)-1;var c=parseInt(r[2],10);return n.setUTCFullYear(t,o,c),n}if(r=O.exec(e))return i=parseInt(r[1],10)-1,D(t,i);if(r=m.exec(e)){i=parseInt(r[1],10)-1;var u=parseInt(r[2],10)-1;return D(t,i,u)}return null}(S.restDateString,x);if(k){var F,E=k.getTime(),R=0;return A.time&&(R=function(e){var t,r,n;if(t=w.exec(e))return(r=parseFloat(t[1].replace(",",".")))%24*o;if(t=h.exec(e))return r=parseInt(t[1],10),n=parseFloat(t[2].replace(",",".")),r%24*o+n*i;if(t=j.exec(e)){r=parseInt(t[1],10),n=parseInt(t[2],10);var a=parseFloat(t[3].replace(",","."));return r%24*o+n*i+1e3*a}return null}(A.time)),A.timezone?F=function(e){var t,r;if(t=y.exec(e))return 0;if(t=T.exec(e))return r=60*parseInt(t[2],10),"+"===t[1]?-r:r;if(t=P.exec(e))return r=60*parseInt(t[2],10)+parseInt(t[3],10),"+"===t[1]?-r:r;return 0}(A.timezone):(F=new Date(E+R).getTimezoneOffset(),F=new Date(E+R+F*i).getTimezoneOffset()),new Date(E+R+F*i)}return new Date(e)}},2074:function(e,t){e.exports=function(e){return e instanceof Date}},213:function(e,t,r){"use strict";var n=r(36);let o;function i(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var a=r(113);const c=500,u=[],s=[],d=[];let l=!0;function f(e,t){Object(n.g)((e,t,r,o)=>{l&&(t==n.b.Error&&s.push({message:e,error:o}),u.push({message:e,level:t}))}),e(p),t(p),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function v(e){const t=Object(a.a)(e);return l=!1,{traces:u,errors:s,network:d,usage:t}}function p(){l&&d.push(arguments)}r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return v})),r.d(t,"d",(function(){return a.b})),r.d(t,"c",(function(){return i}))},226:function(e,t,r){"use strict";function n(e){var t,r;if((null==e?void 0:e.length)>0){const n=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(r=e[1])||void 0===r?void 0:r.length)>0?n:void 0}}const o="bearer",i="msauth1.0",a=3600,c=86400,u=6e4,s=1e3;function d(e){if(e){const t=e.split(" ");return n(t)==o?t[1]:e}}function l(e,t){if(e){const r=n(e.split(" "));if(r){if(t){return(1e3*t-Date.now()-u)/s}return r==i?c:a}}}function f(e){var t;const r=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==r||"bearer"==r?e:`Bearer ${e}`}r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return f}))},2279:function(e,t,r){"use strict";var n=r(2772),o=r.n(n),i=r(6),a=r(296),c=r(404),u=r(35);function s(e){return Object.assign({__type:"GetAccessTokenForDataProviderRequest:#Exchange"},e)}async function d(e,t,r,n){const o=s({DataProviderType:e,ResourceUrl:t,IsGroupRequest:!1,ClaimsChallenge:n?atob(n):null});let i;i=r?"getAccessTokenForDataProvider_"+r:"getAccessTokenForDataProvider";let a=new Headers;a.append("X-OWA-ActionName",i);const c={headers:a,datapoint:{customData:{actionSource:r},headersCustomData:e=>({tokenResultDetails:e.get("x-tokenresult")}),jsonCustomData:e=>({tokenStatus:e.TokenResultCode.toString()})},returnFullResponseOnSuccess:!0},d=await function(e,t){return void 0===e||e.__type||(e=s(e)),Object(u.a)("GetAccessTokenforDataProvider",e,t)}(o,c);return{token:await d.json(),response:d}}const l="onedrive_implicit.access",f="Bearer ";var v=r(47),p=r(71);const b=(e,t,r)=>Object.assign({resultCode:t,isAdalException:r,_typeSpec:"TokenRetrievalError"},e),O=e=>"TokenRetrievalError"===e._typeSpec;let m=[];const w={},h=1,j=30,g="",y="Microsoft.IdentityModel.Clients.ActiveDirectory.AdalServiceException";function T(e){w[e]=null}async function P(e,t,r,n){const o=await d(e,t,r,n);return function(e,t,r){m=m.filter(e=>e!==t);const n=r.token;if(0!==n.TokenResultCode||!n.AccessToken||""===n.AccessToken){const t=`Access token request failed for token key ${e} with response code ${n.TokenResultCode}`,o=r.response.headers.get("x-tokenresult"),i=null!=o&&o.indexOf(y)>0;throw b(new Error(t),n.TokenResultCode,i)}{const r=w[e]||{};r[t]=n,w[e]=r}}(e,t,o),o.token}async function D(e,t,r,n){let o=g;if(0===e&&r){const e=new URL(r);o=Object(i.c)("{0}//{1}/",e.protocol,e.hostname)}return Object(v.j)("doc-attachment-testAuthFallback")?"":S(e,o,t,null,n)}async function A(e,t,r){return S(0,e,t,r)}async function S(e,t,r,n,a){if(0===e&&!Object(i.k)(t)){const e=await Object(c.getAccessTokenforResource)(t);if(e)return e;Object(p.o)("getFileProviderAccessTokenForResource_emptyTokenFrom_getAccessTokenforResource")}if(!r&&function(e,t){const r=w[e];if(!r)return!1;const n=r[t];if(!n||!n.AccessTokenExpiry)return!1;const i=new Date(n.AccessTokenExpiry),a=o()(new Date(Date.now()),h);return null!=i&&a<i}(e,t)){const r=w[e][t];return o()(new Date(Date.now()),j)>new Date(r.AccessTokenExpiry)&&-1===m.indexOf(t)&&(m.push(t),P(e,t,n)),r.AccessToken}return(await P(e,t,n,a)).AccessToken}async function x(e,t,r,n){let o;return o=Object(a.a)()&&1===e?await Object(c.getDelegationTokenForOwa)(l):await D(e,t,r,n),f+o}r.d(t,"d",(function(){return x})),r.d(t,"c",(function(){return D})),r.d(t,"e",(function(){return A})),r.d(t,"b",(function(){return T})),r.d(t,"f",(function(){return O})),r.d(t,"a",(function(){return f}))},2721:function(e,t,r){var n=r(2067);e.exports=function(e,t){var r=n(e).getTime(),o=Number(t);return new Date(r+o)}},2772:function(e,t,r){var n=r(2721),o=6e4;e.exports=function(e,t){var r=Number(t);return n(e,r*o)}},291:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n=r(135),o=r(100),i=r(2);let a;function c(e){a=e}async function u(e){var t,r;if(Object(i.Q)())return o.f.importAndExecute(Object(n.a)());const c=a&&await a(void 0,e);if(c&&c.length>0){if("bearer"===(null===(t=null==c?void 0:c.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return c.split(" ")[1];if("msauth1.0"===(null===(r=null==c?void 0:c.split(" ")[0])||void 0===r?void 0:r.toLowerCase()))return c}}},4090:function(e,t,r){"use strict";r.r(t);var n=r(1961),o=r(3);const i=Object(o.action)("ADD",e=>({providerViewState:e})),a=Object(o.action)("LOAD",e=>({providers:e})),c=Object(o.action)("REMOVE",e=>({providerType:e})),u=Object(o.action)("ADD_TO_REMOVING",e=>({providerType:e})),s=Object(o.action)("SET_LOAD_STATE",e=>({loadState:e})),d=Object(o.action)("REMOVE_FROM_REMOVING",e=>({providerType:e}));function l(e){Object(n.a)().providers.set(e.viewType.toString(),e)}Object(o.mutator)(i,e=>l(e.providerViewState)),Object(o.mutator)(u,e=>{Object(n.a)().removalPending.set(e.providerType.toString(),"")}),Object(o.mutator)(c,e=>{Object(n.a)().providers.delete(e.providerType.toString()),Object(n.a)().removalPending.delete(e.providerType.toString())}),Object(o.mutator)(a,e=>e.providers.forEach(l)),Object(o.mutator)(s,e=>{Object(n.a)().loadState=e.loadState}),Object(o.mutator)(d,e=>{Object(n.a)().removalPending.delete(e.providerType.toString())});var f=r(16694),v=r(2795),p=r(6),b=r(2328),O=r(2314);const m="file provider is not addable";function w(e){return O.a.indexOf(e)>-1}const h=Object(o.action)("ADD_FILE_PROVIDER",(e,t,r)=>({providerType:e,getAddableFileProviderInfoCustom:t,updateProvider:r})),j=Object(o.action)("LOAD_PROVIDERS",(e,t)=>({onLoaded:e,onError:t})),g=Object(o.action)("REMOVE_AND_ADD_FILE_PROVIDER",e=>({providerType:e})),y=Object(o.action)("REMOVE_FILE_PROVIDER",e=>({providerType:e}));var T=r(564);function P(e){if(O.c.indexOf(e.Type)<-1)return null;const t=e.Type;try{const r=5===t?e.Scopes.filter(e=>"Photos"!==e.DisplayName):e.Scopes;return{name:e.DisplayName,providerAccountIdentifier:e.AssociatedDataProviderAccountId||"",isPrimaryProvider:!e.IsThirdPartyProvider,type:t,allowFolderSharing:e.AllowFolderSharing,model:e,scopes:r||[],viewType:t,associatedWithPrimaryProvider:!1,usesGroupsViewAtTopLevel:!1}}catch(e){return null}}var D=r(1969),A=r(71),S=r(36),x=r(7613);async function k(e,t,r){if(!w(e))throw new Error(m);let n;try{n=await function(e,t,r){return Object(A.o)("FPAddDataProviderAuthWindowOpened",[e]),new Promise((n,o)=>{const i=(t=t||x.b)(e),{authUrl:a,redirectUrl:c,csrfToken:u}=i.getAuthUrlInfo(),s={info:{redirectUrl:c,csrfToken:u,updateProvider:r},onProviderAdded:e=>n(e),onErrorAddingProvider:e=>o(e),getAddableFileProviderInfo:t};Object(x.a)(e),Object(x.d)(e,s),function(e,t,r){const n=(window.screen.width-t)/2,o=(window.screen.height-r)/2,i=`width=${t}, height=${r}, top=${o}, left=${n}, menubar=no, toolbar=no`;window.open(e,"_blank",i)}(a,600,600)})}(e,t,r)}catch(t){return void function(e,t){throw S.h.warn(`Error in adding file provider ${e.toString()}`),function(e){Object(T.b)(Object(p.b)(v.a),Object(p.c)(Object(p.b)(f.a),e),!1,{hideCancelButton:!0})}(Object(b.a)(t)),e}(t,e)}const o=P(n);i(o),Object(D.a)(o)}Object(o.orchestrator)(h,e=>{k(e.providerType,e.getAddableFileProviderInfoCustom,e.updateProvider)});var F=r(16695),E=r(16696),R=r(2279),I=r(2102);function _(e){return Object.assign({__type:"RemoveAttachmentDataProviderRequest:#Exchange"},e)}var C=r(35);function N(e){const t=_({DataProviderId:e});return void 0===(r=t)||r.__type||(r=_(r)),Object(C.a)("RemoveAttachmentDataProvider",r,n);var r,n}async function $(e){const t=Object(I.a)(e.toString());if(!t||!w(e))return L("Unable to remove the provider as the provider does not exist in the store or is not addable.",e),void Object(A.o)("FPRemoveFileProvider",{message:"Provider does not exist in the store or is not addable.",fileProviderType:e.toString()});u(e);try{(await N(t.model.Id)).RemovedSuccessfuly?(c(e),Object(D.b)(e),Object(R.b)(t.type),Object(A.o)("FPRemoveFileProvider",{message:"Successfully removed file provider",fileProviderType:e.toString()})):(d(e),L("Unable to remove the provider",t.type),Object(A.o)("FPRemoveFileProvider",{message:"Unable to remove the provider",fileProviderType:e.toString()}))}catch(t){d(e)}}function L(e,t){var r;S.h.warn(`Error in removing file provider ${e}`),r=Object(b.a)(t),Object(T.b)(Object(p.b)(E.b),Object(p.c)(Object(p.b)(E.a),r),!1,{hideCancelButton:!0})}Object(o.orchestrator)(y,e=>{$(e.providerType)}),Object(o.orchestrator)(g,e=>{!async function(e){const t=Object(b.a)(e);try{await $(e),await function(e){return Object(T.b)(Object(p.b)(v.a),Object(p.c)(Object(p.b)(F.a),e),!1)}(t)===T.a.ok&&await k(e)}catch(e){}}(e.providerType)});var U=r(16697),M=r(2315);function V(e){return Object.assign({__type:"GetAttachmentDataProvidersRequest:#Exchange"},e)}function z(e=0){const t=V({ClientVersion:2,RequestOrigin:e});return void 0===(r=t)||r.__type||(r=V(r)),Object(C.a)("GetAllAttachmentDataProviders",r,n);var r,n}var G=r(2136),J=r(16698),B=r(47);var W=r(9903),q=r(296);Object(o.orchestrator)(j,e=>{!async function(e,t){if(Object(M.a)()===G.a.NotLoaded){s(G.a.Loading);const n=new A.b("LoadAttachmentDataProviders");let o;try{o=await z();const e=null==o?void 0:o.some(e=>e.IsThirdPartyProvider);n.addCustomData({hasThirdPartyProviders:e}),n.end()}catch(e){return++H<Y?s(G.a.NotLoaded):s(G.a.Throttled),null==t||t(e),void n.endWithError("ServerError",e)}const i=function(){const e={__type:"MailMessage",DisplayName:Object(p.b)(J.a),AriaLabel:Object(p.b)(J.a)};return{__type:"MailMessageAttachmentDataProvider",Id:"MailMessage",Type:10,DisplayName:Object(p.b)(v.b),AssociatedDataProviderAccountId:null,Scopes:[e],DefaultScopeIndex:0,AllowFolderSharing:!1,DefaultPermissionType:6,IsSearchSupported:Object(B.j)("doc-filePicker-mailMessageSearch"),IsThirdPartyProvider:!1}}();o.push(i);let c=function(e){return e.map(P).filter(e=>null!==e)}(o.filter(e=>O.c.indexOf(e.Type)>-1&&Object(W.a)(e.Type)));c&&!Object(q.a)()&&c.splice(0,0,(r=c[0],Object.assign(Object.assign({},r),{scopes:[{__type:"OneDriveProScope:#Exchange",Type:3,DisplayName:""}],isPrimaryProvider:!1,viewType:O.b.Groups,name:Object(p.b)(U.a),associatedWithPrimaryProvider:!0,usesGroupsViewAtTopLevel:!0}))),a(c),s(G.a.Loaded),null==e||e(c),Object(D.c)(c)}var r}(e.onLoaded,e.onError)});const Y=3;let H=0;var X=r(614),Z=r(20),Q=r(910),K=r(2853);const ee=Object(Z.e)(Q.a,"clone_onSelectedAccountChanged",e=>{if(!Object(X.b)())throw new Error(`Reset FileProvider store for account selection change is called when multi accounts is turned off. ${e.selectedEmailAddress}`);te(Object(K.a)())}),te=Object(o.mutatorAction)("resetStoreForAccountSelectionChange",e=>{const t=Object(n.a)();t.providers=e.providers,t.loadState=e.loadState,t.removalPending=e.removalPending});r.d(t,"removeFileProvider",(function(){return y})),r.d(t,"removeAndAddFileProvider",(function(){return g})),r.d(t,"loadProviders",(function(){return j})),r.d(t,"addFileProvider",(function(){return h})),r.d(t,"resetFileProviderStoreOrchestrator",(function(){return ee}))},564:function(e,t,r){"use strict";r.d(t,"b",(function(){return c}));var n=r(20),o=r(916);r.d(t,"a",(function(){return o.a}));const i=new n.c(()=>Promise.all([r.e(1),r.e(2),r.e(3),r.e(4),r.e(534)]).then(r.bind(null,1566)));let a=new n.b(i,e=>e.confirmAction);function c(e,t,r,n){return a.import().then(o=>o(e,t,r,n))}},5949:function(e,t,r){"use strict";r.d(t,"c",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return a}));const n={};function o(e,t){n[e]=t}function i(e){return e in n?n[e]:null}function a(e){n[e]=null}},614:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(132),o=r(13);function i(){return Object(n.a)("acctmonaccounts")&&Object(o.i)("acctmonaccounts")}function a(){return i()||!Object(n.a)("acctmonaccounts")&&Object(o.i)("accountsapi")}},7613:function(e,t,r){"use strict";var n=r(20),o=r(5949);r.d(t,"a",(function(){return o.a})),r.d(t,"d",(function(){return o.c}));var i=r(2291);r.d(t,"b",(function(){return i.b}));var a=r(2715);r.d(t,"c",(function(){return a.a}));const c=new n.c(()=>r.e(871).then(r.bind(null,13065))),u=new n.a(c,e=>e.addFileProviderAfterAuthFinished);"undefined"!=typeof window&&void 0!==window.Owa&&(window.Owa.lazyAddFileProviderAfterAuthFinished=u);new n.b(c,e=>e.getAddableFileProviderInfo),new n.b(c,e=>e.addFileProvider),new n.b(c,e=>e.createAddableFileProviderInfo),new n.b(c,e=>e.getAuthRedirectPageUrl)},916:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(n||(n={}))},9903:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(7613);function o(e){return Object(n.c)(e)}}}]);
//# sourceMappingURL=owa.680.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.680.js'] = 1;