(window.$wj=window.$wj||[]).push([[506],{11906:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1845),o=n(3732);function i(){const e=Object(o.a)();return Object(r.c)(e)}},15611:function(e){e.exports=JSON.parse('{"g":"s1b","a":"t1b","b":"u1b","c":"v1b","e":"w1b","j":"x1b","d":"y1b","f":"z1b","h":"A1b","i":"B1b"}')},1754:function(e,t,n){"use strict";var r=n(20),o=n(1675),i=n(47);function c(){return a(Object(o.I)())}function a(e){let t=null;return e&&(2===e.tableQuery.type?t=e.tableQuery.folderId:Object(i.j)("grp-loadFolders")&&3===e.tableQuery.type&&(t=e.tableQuery.groupId)),t}function u(){const e=Object(o.I)();return e&&(2==e.tableQuery.type||Object(i.j)("grp-loadFolders")&&3==e.tableQuery.type)}function s(e){return!!e&&(2==e.type||d(e)||Object(i.j)("grp-loadFolders")&&3==e.type)}function d(e){if(!e||1!=e.type)return!1;return"Group"==e.searchScope.kind}function l(e){if(2==e.type)return e.folderId;if(Object(i.j)("grp-loadFolders")&&3==e.type)return e.groupId;if(d(e)){return e.searchScope.groupId}return null}function f(){const e=Object(o.I)();return e&&s(e.tableQuery)}function g(){return Object(i.j)("grp-loadFolders")&&u()}n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"n",(function(){return h})),n.d(t,"m",(function(){return I})),n.d(t,"k",(function(){return v})),n.d(t,"j",(function(){return w})),n.d(t,"l",(function(){return y})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return g}));const m=new r.c(()=>Promise.all([n.e(19),n.e(48),n.e(61),n.e(452)]).then(n.bind(null,19734))),p=new r.b(m,e=>e.getGroupDisplayName),b=new r.b(m,e=>e.getGroupDisplayNameFromTableView),h=new r.b(m,e=>e.isPrivateUnjoinedGroup),I=new r.b(m,e=>e.isJoinedGroup),v=new r.b(m,e=>e.getRetentionPolicyTagsForGroup),w=new r.b(m,e=>e.getRetentionPolicyTagListForGroupTableQuery),y=new r.b(m,e=>e.isGroupOwner)},1764:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return l}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(0),n.e(28),n.e(643)]).then(n.bind(null,3857)));let i=new r.a(o,e=>e.logLocalContentDataSource),c=new r.a(o,e=>e.logLocalContentLayout),a=new r.a(o,e=>e.clearLocalContentInstrumentationCache),u=new r.b(o,e=>e.getLocalContentId);const s=new r.b(o,e=>e.substrateSearchInitOperation),d=(new r.b(o,e=>e.substrateSearchPostSuggestionsService),new r.b(o,e=>e.deleteSubstrateSearchHistoryService)),l=new r.b(o,e=>e.exportSubstrateSearchHistoryService)},1782:function(e,t,n){"use strict";function r(e){return Object.assign({},e)}function o(e){return Object.assign({},e)}function i(e){return Object.assign({},e)}function c(e){return Object.assign({},e)}function a(e){return Object.assign({},e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return a}))},1800:function(e,t,n){"use strict";var r=n(1974),o=n(1675);function i(){return Object(r.a)(Object(o.I)())}n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"c",(function(){return r.b})),n.d(t,"e",(function(){return r.d})),n.d(t,"a",(function(){return i}))},1836:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Keywords=0]="Keywords",e[e.People=1]="People",e[e.PrivateDistributionList=2]="PrivateDistributionList",e[e.File=3]="File",e[e.Category=4]="Category",e[e.Message=5]="Message",e[e.Event=6]="Event",e[e.TrySuggestion=7]="TrySuggestion",e[e.Setting=8]="Setting"}(r||(r={})),function(e){e.ODSPFile="ODSP file",e.CloudyAttachment="Cloudy attachment",e.ClassicAttachment="Classic attachment",e.LinkAttachment="Link attachment",e.Unknown="Unknown"}(o||(o={})),function(e){e[e.Unknown=0]="Unknown",e[e.Checking=1]="Checking",e[e.NotSupported=2]="NotSupported",e[e.Supported=3]="Supported"}(i||(i={}))},1846:function(e,t,n){"use strict";function r(e){if(!e)return e;let t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-"),t}function o(e){if(!e)return e;let t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/"),t}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},188:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,c){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var u={value:n,expire:o+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),c&&c(t,n)}.bind(this),o)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var c=e[i];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return o&&t++,c.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(i)if(e[c])continue;var a=r[c],u=a.expire-o;if(u<=0){this.del(c);continue}u=u>0?u:void 0,this.put(c,a.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},1892:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Mail="owa.react",e.MailCompose="owa.react.compose",e.Calendar="owa.react.calendar",e.FilesHub="owa.react.filesHub",e.MailSubject="owa.react.mail.subject",e.MailEmailAttachmentPicker="owa.react.mail.emailPicker",e.SuggestedAttachments="suggestedattachments",e.MeetingPrep="MeetingPrep",e.MeetingPrepPrefetch="MeetingPrep.Prefetch",e.MeetingPrepPeek="MeetingPrep.Peek",e.MeetingPrepReminder="MeetingPrep.Reminder",e.MeetingPrepAgenda="MeetingPrep.AgendaView",e.MeetingPrepMailCalendarCard="MeetingPrep.MailCalendarCard",e.MeetingPrepDesktop="OutlookDesktopOPX.MeetingPrep",e.MeetingPrepShell="ShellOPX.MeetingPrep",e.ContextualInsights="ContextualInsights",e.FileSuggestions="owa.react.filepicker",e.SonoraFilePicker="outlook.inlinefilepicker",e.SonoraHoneybee="owa.honeybee"}(r||(r={})),t.b=r},1914:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"j",(function(){return c})),n.d(t,"v",(function(){return a})),n.d(t,"l",(function(){return u})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return d})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"f",(function(){return h})),n.d(t,"k",(function(){return I})),n.d(t,"m",(function(){return v})),n.d(t,"p",(function(){return w})),n.d(t,"q",(function(){return y})),n.d(t,"n",(function(){return S})),n.d(t,"u",(function(){return O})),n.d(t,"a",(function(){return j})),n.d(t,"s",(function(){return C})),n.d(t,"t",(function(){return T}));var r=n(20);const o=new r.c(()=>n.e(1009).then(n.bind(null,3021)));let i=new r.a(o,e=>e.logEntityClicked);const c=new r.a(o,e=>e.logResponseReceived);let a=new r.a(o,e=>e.logSessionEnd),u=new r.a(o,e=>e.logResponseRendered);const s=new r.a(o,e=>e.logSearchBoxStateChanged);let d=new r.a(o,e=>e.logSearchResultInteraction),l=new r.a(o,e=>e.logResponseNeverRendered);const f=new r.a(o,e=>e.flushNonRenderedResponseReceivedItemsFromCache),g=new r.a(o,e=>e.logCachedContentRendered);let m=new r.a(o,e=>e.logFeedback);const p=new r.a(o,e=>e.logClientLayout),b=new r.a(o,e=>e.logClientDataSource),h=new r.a(o,e=>e.logEntitiesFromFilePicker),I=new r.a(o,e=>e.logResponseRecievedV2),v=new r.a(o,e=>e.logResultsRendered),w=new r.a(o,e=>e.logSearchEntityActions),y=new r.a(o,e=>e.logSearchFeedbackActions),S=new r.a(o,e=>e.logSearchActions);let O=new r.a(o,e=>e.logSecondaryEntityActionClicked);const j=new r.a(o,e=>e.clearProcessedTraceIds),C=new r.a(o,e=>e.logSearchSuggestionsClientLayoutEvent),T=new r.a(o,e=>e.logSearchSuggestionsResultsRenderedEvent)},1925:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UnifiedGroupIdentity:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1934:function(e,t,n){"use strict";var r=n(1799),o=n(611);function i(e){return Object.assign({__type:"SingleLargeArchiveSearchScopeType:#Exchange"},e)}function c(e){return Object.assign({__type:"SearchFolderScopeType:#Exchange"},e)}var a=n(1925),u=n(1698);var s=n(1678),d=n(1782),l=n(1679),f=n(1767);n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return S}));const g={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];e.push(Object(d.b)({folderId:Object(s.a)(l.k),kind:"PrimaryMailbox"}));const t=Object(f.b)("UserMailbox");for(let n of t)e.push(Object(d.b)({folderId:n,kind:"PrimaryMailbox"}));return e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(o.a)({Id:e.folderId}),[(i={FolderScope:c({BaseFolderId:n}),IsDeepTraversal:!0},Object.assign({__type:"PrimaryMailboxSearchScopeType:#Exchange"},i))];var i}},m={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){const e=[];return e.push(Object(d.a)({folderId:Object(s.a)(l.d),kind:"ArchiveMailbox"})),e.push(Object(d.a)({folderId:Object(s.a)(l.a),kind:"ArchiveMailbox"})),e},getSearchScopeType:function(e){const t=Object(u.a)(e.folderId);let n;return n="none"!=t?Object(r.a)({Id:t}):Object(o.a)({Id:e.folderId}),"archivemsgfolderroot"==t?[(a={ArchiveTypes:16777215},Object.assign({__type:"LargeArchiveSearchScopeType:#Exchange"},a))]:[i({FolderScope:c({BaseFolderId:n})})];var a}},p={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},b={getKey:function(e){return e.kind+"-"+e.groupId.toLowerCase()},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return[(t={GroupIdentity:Object(a.a)({Type:0,Value:e.groupId})},Object.assign({__type:"SingleGroupSearchScopeType:#Exchange"},t))];var t}},h={getKey:function(e){return e.kind+"-"+e.calendarFolderId?e.calendarFolderId.toLowerCase():""},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},I={getKey:function(e){return e.kind+"-"+e.folderId},getSearchScopeList:function(){return[]},getSearchScopeType:function(e){return null}},v=e=>{switch(e.kind){case"PrimaryMailbox":return g;case"ArchiveMailbox":return m;case"SharedFolders":return p;case"Group":return b;case"Calendar":return h;case"PublicFolder":return I;default:throw new Error("Unregistered search scope")}},w=e=>v(e).getKey(e),y=e=>v(e).getSearchScopeList(),S=e=>v(e).getSearchScopeType(e)},19478:function(e,t,n){"use strict";n.r(t);var r=n(3),o=Object(r.action)("onCacheUpdated",(e,t)=>({interactionType:e,triageContext:t})),i=Object(r.action)("onNudgedSpotlightItemRemoved",e=>({rowKey:e})),c=Object(r.action)("onSpotlightDismissedFromRP",e=>({rowKey:e}));const a=Object(r.action)("onSpotlightDismissedFromRPProcessed",e=>({rowKey:e}));var u,s=Object(r.action)("onSpotlightItemsFetched",(e,t,n)=>({spotlightItems:e,isConversationView:t,requestStartTime:n})),d=n(2762);!function(e){e[e.Unknown=0]="Unknown",e[e.Weak=1]="Weak",e[e.Strong=2]="Strong"}(u||(u={}));var l=e=>{switch(e){case"CreateRule":case"MarkAsRead":case"MarkAsReadImplicit":case"MarkAsUnread":case"Snooze":return u.Weak;case"Block":case"Categorize":case"Delete":case"Flag":case"FlagCleared":case"FlagComplete":case"Forward":case"Ignore":case"Like":case"MarkAsJunk":case"MarkAsPhishing":case"Move":case"Pin":case"Reaction":case"Reply":case"ReplyAll":case"ReportAbuse":case"Unpin":return u.Strong;default:return u.Unknown}},f=n(3029),g=n(71),m=n(1914),p=n(1981),b=n(38);const h=[],I=e=>{const{UserPuid:t,ExternalDirectoryTenantGuid:n}=Object(b.a)().SessionSettings;m.p.importAndExecute(p.c.ContextualInsights,t,n,Object(d.a)().logicalId,null,Object(f.a)(e).referenceId,"EntityClicked"),Object(g.o)("Spotlight_ItemClicked")},v=()=>{const{logicalId:e,requestStartTime:t,spotlightItems:n}=Object(d.a)();-1===h.indexOf(e)&&(h.push(e),m.m.importAndExecute(p.c.ContextualInsights,e,null,Date.now()-t),Object(g.o)("Spotlight_SetRendered",{hasSpotlightItems:n.length>0,logicalId:e}))};var w=n(3030),y=n(7),S=n(326),O=n(1675),j=n(8587),C=n(5);var T,A=n(9);!function(e){e[e.Acknowledged=0]="Acknowledged",e[e.Dismissed=1]="Dismissed"}(T||(T={}));const k=(e,t)=>{const n=R(e);for(const e of t)n.push(e);Object(A.e)(window,P(e),JSON.stringify(n))},x=e=>{const{spotlightCacheType:t,itemId:n,conversationId:r,rowKey:o}=e,i=R(t);for(const e of i)if(n&&e.itemId===n||r&&e.conversationId===r||o&&e.rowKey===o)return!0;return!1},M=(e,t)=>{const n=R(e),r=[];for(const e of n){const{itemId:n,conversationId:o,rowKey:i}=e;for(const e of t){const{itemId:t,conversationId:c,rowKey:a}=e;if(n&&n===t||o&&o===c||i&&i===a){r.push(e);break}}}Object(A.e)(window,P(e),JSON.stringify(r))},R=e=>{const t=Object(A.a)(window,P(e));return t?JSON.parse(t):[]},P=e=>e===T.Acknowledged?"acknowledgedSpotlightItems":"dismissedSpotlightItems";Object(r.mutator)(s,e=>{const{spotlightItems:t,isConversationView:n,requestStartTime:r}=e,o=D(),i=t.concat(o),c=[],a=i.concat(o).filter(e=>{const t=n?e.conversationId:e.itemId;return!(c.indexOf(t)>-1)&&(c.push(t),!0)});(e=>{M(T.Acknowledged,e),M(T.Dismissed,e)})(a);const u=a.filter(e=>!e.isDismissed);Object(d.a)().spotlightItems=u,Object(d.a)().logicalId=Object(S.a)(),Object(d.a)().requestStartTime=r,0===u.length&&v()}),Object(r.mutator)(a,e=>{const t=e.rowKey,n=Object(d.a)().spotlightItems;for(let e=0;e<n.length;e++){if(n[e].rowKey===t){n.splice(e,1);break}}}),Object(r.mutator)(o,e=>{if(!Object(w.a)())return;const{triageContext:t={},interactionType:n}=e;let{itemIds:r=[],conversationIds:o=[],rowKeys:i=[]}=t;if(r=r.filter(e=>!!e),o=o.filter(e=>!!e),i=i.filter(e=>!!e),0!==r.length||0!==o.length||0!==i.length)switch(l(n)){case u.Weak:F({itemIds:r,conversationIds:o,rowKeys:i,actionCategory:u.Weak});break;case u.Strong:F({itemIds:r,conversationIds:o,rowKeys:i,actionCategory:u.Strong});break;case u.Unknown:}}),Object(r.mutator)(j.a,()=>{Object(d.a)().spotlightItems=[]}),Object(r.mutator)(i,e=>{const{rowKey:t}=e,n=Object(d.a)().spotlightItems;for(let e=0;e<n.length;e++)if(n[e].rowKey===t){n.splice(e,1);break}});const F=e=>{const{itemIds:t,conversationIds:n,rowKeys:r,actionCategory:o}=e,i=Object(d.a)().spotlightItems;i.map((e,c)=>{(t.indexOf(e.itemId)>-1||n.indexOf(e.conversationId)>-1||r.indexOf(e.rowKey)>-1)&&(o===u.Weak?e.isAcknowledged=!0:o===u.Strong&&i.splice(c,1))})},D=()=>{const e=[],t=Object(C.c)("testSpotlight");if(t){const n=Object(O.I)(),r=parseInt(t);for(let t=0;t<r;t++){const r=n.rowKeys[t],o=O.b.getItemIds(r,n)[0],i=O.b.getConversationId(r,n);r&&e.push({rowKey:r,itemId:o,conversationId:i,isAcknowledged:x({spotlightCacheType:T.Acknowledged,itemId:o,conversationId:i,rowKey:r}),isDismissed:x({spotlightCacheType:T.Dismissed,itemId:o,conversationId:i,rowKey:r}),reason:0,senderName:O.b.getLastSenderMailbox(r,n).Name,referenceId:"00000000-0000-0000-0000-000000000000",dateTimeReceived:Object(y.Vb)(O.b.getLastDeliveryTimeStamp(r,n))})}}return e};var E=Object(r.action)("onSpotlightFilterLoaded",e=>({actionSource:e}));Object(r.mutator)(E,()=>{Object(d.a)().spotlightItems.map(e=>e.isAcknowledged=!0)});var K=n(3290),L=n(1845);function N(e){const{spotlightTableQuery:t}=Object(d.a)();t&&Object(K.a)([e],Object(L.c)(t),"Spotlight",!1)}var U=n(2411);Object(r.orchestrator)(U.h,e=>{const{nudgedRows:t}=e,n=Object(d.a)().spotlightItems;t.map(e=>{n.map(t=>{t.rowKey!==e.rowKey&&t.itemId!==e.itemId&&t.conversationId!==e.conversationId||(N(e.rowKey),i(e.rowKey))})})});var _=n(1892);function B(e){const{itemId:t,conversationId:n,rowKey:r}=e,o=Object(d.a)().spotlightItems.filter(e=>t&&e.itemId===t||n&&e.conversationId===n||r&&e.rowKey===r);return o.length>0?o[0]:null}Object(r.orchestrator)(c,e=>{const{rowKey:t}=e;k(T.Dismissed,[{rowKey:t}]);const{conversationId:n,itemId:r,referenceId:o}=Object(f.a)(t),i=Object(b.a)().SessionSettings;m.p.importAndExecute(_.b.ContextualInsights,i.UserPuid,i.ExternalDirectoryTenantGuid,Object(d.a)().logicalId,null,o,"SpotlightDismissed");const c=Object(O.I)();c&&Object(g.o)("Spotlight_ItemDismissed",{isImportantFilter:"spotlight"===c.tableQuery.scenarioType,conversationId:Object(O.R)(c)?n:null,itemId:Object(O.R)(c)?null:r}),N(t),a(t)}),Object(r.orchestrator)(E,e=>{Object(g.o)("Spotlight_FilterLoaded",[e.actionSource])});var G=n(3304);Object(r.orchestrator)(G.d,e=>{if(!Object(w.a)())return;const{triageContext:t={},interactionType:n}=e;let{itemIds:r=[],conversationIds:i=[],rowKeys:c=[]}=t;if(r=r.filter(e=>!!e),i=i.filter(e=>!!e),c=c.filter(e=>!!e),0===r.length&&0===i.length&&0===c.length)return;const a=[],s=l(n)===u.Strong?T.Dismissed:T.Acknowledged;r.map(e=>{const t=B({itemId:e});t&&!x({spotlightCacheType:s,itemId:e,rowKey:t.rowKey})&&(k(s,[{itemId:e,rowKey:t.rowKey}]),Q(a,t.referenceId,n))}),i.map(e=>{const t=B({conversationId:e});t&&!x({spotlightCacheType:s,conversationId:e,rowKey:t.rowKey})&&(k(s,[{conversationId:e,rowKey:t.rowKey}]),Q(a,t.referenceId,n))}),c.map(e=>{const t=B({rowKey:e});t&&!x({spotlightCacheType:s,rowKey:e})&&(k(s,[{rowKey:e}]),Q(a,t.referenceId,n))}),o(n,t)}),Object(r.orchestrator)(E,()=>{H()});const H=()=>{const e=Object(d.a)().spotlightItems.map(e=>{const{itemId:t,conversationId:n,rowKey:r}=e;return{itemId:t,conversationId:n,rowKey:r}});k(T.Acknowledged,e)},Q=(e,t,n)=>{t&&-1===e.indexOf(t)&&(((e,t)=>{if(!e)return;const{UserPuid:n,ExternalDirectoryTenantGuid:r}=Object(b.a)().SessionSettings;m.p.importAndExecute(p.c.ContextualInsights,n,r,Object(d.a)().logicalId,null,e,t),Object(g.o)("Spotlight_ItemInteraction",{interactionType:t})})(t,n),e.push(t))};function z(e,t){var n,r,o,i,c;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationTopic:e.Subject,FlagStatus:null===(n=e.Flag)||void 0===n?void 0:n.FlagStatus,FolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},GlobalItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],GlobalMessageCount:1,GlobalUnreadCount:e.IsRead?0:1,HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,HasIrm:null,Importance:e.Importance,ItemClasses:e.ItemClasses||["IPM.Note"],ItemIds:[{Id:e.ItemId.Id,ChangeKey:null}],LastDeliveryOrRenewTime:e.DateTimeReceived,LastDeliveryTime:e.DateTimeReceived,LastModifiedTime:e.DateTimeLastModified,MessageCount:1,ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,SenderSMTPAddress:null===(o=null===(r=e.Sender)||void 0===r?void 0:r.EmailAddress)||void 0===o?void 0:o.Address,UniqueSenders:[null===(c=null===(i=e.Sender)||void 0===i?void 0:i.EmailAddress)||void 0===c?void 0:c.Name],UnreadCount:e.IsRead?0:1,InstanceKey:t}}function V(e,t){var n;return{Categories:e.Categories,ConversationId:e.ConversationId&&{Id:e.ConversationId.Id,ChangeKey:null},ConversationIndex:e.ConversationIndex,DateTimeReceived:e.DateTimeReceived,DateTimeSent:e.DateTimeSent,LastModifiedTime:e.DateTimeLastModified,DisplayBcc:e.DisplayBcc,DisplayCc:e.DisplayCc,DisplayTo:e.DisplayTo,Flag:e.Flag&&{FlagStatus:e.Flag.FlagStatus,CompleteDate:e.Flag.CompleteDate,DueDate:e.Flag.DueDate,StartDate:e.Flag.StartDate},From:e.From&&{Mailbox:{EmailAddress:e.From.EmailAddress.Address,Name:e.From.EmailAddress.Name,RoutingType:"SMTP"}},HasAttachments:e.HasAttachments,Hashtags:e.Hashtags,Importance:e.Importance,IsDraft:e.IsDraft,IsRead:e.IsRead,ItemClass:e.ItemClass||"IPM.Note",ItemId:{Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey},ParentFolderId:e.ParentFolderId&&{Id:e.ParentFolderId.Id},Preview:e.Preview,Sender:e.Sender&&{Mailbox:{EmailAddress:e.Sender.EmailAddress.Address,Name:e.Sender.EmailAddress.Name,RoutingType:"SMTP"}},Sensitivity:e.Sensitivity,Subject:e.Subject,MentionedMe:null===(n=e.MentionsPreview)||void 0===n?void 0:n.IsMentioned,InstanceKey:t}}var W=Object(r.mutatorAction)("onSpotlightRowsAppendedToTable",e=>{Object(d.a)().spotlightTableQuery=e}),q=n(311),J=n(2128),$=n(2654),X=n(2386),Y=n(47),Z=n(132),ee=n(225);const te=(e,t)=>{const n=Object(O.F)([e],t);return n.length>0?n[0]:null},ne=e=>{if(!e||0===e.length)return 0;for(const t of e)if(t.Id.indexOf("SpotlightReason")>-1)switch(t.Value){case"ActionRequired":return 1;case"AffectsSchedule":return 2;case"AtMentioned":return 4;case"ReplyRequired":return 8;case"NewMeetingCreated":return 64;case"UpcomingMeetingTimeChanged":return 128;case"MeetingCanceled":return 256;case"NewMeetingTimeProposed":return 512;case"UltraFocused":return 1024;case"ReplyToYourEmail":return 2048;default:return 0}return 0};var re=n(3164),oe=n(2265),ie=n(1678),ce=n(404),ae=n(610),ue=n(226);const se=async()=>{let[e,t]=Object(ce.getAccessTokenforResourceAsLazy)(window.location.origin,"OwaMailSpotlight");return e||(e=await t),e||""},de=(e,t,n)=>{const r={method:"POST"};r.headers=new Headers,r.headers.set("Authorization",Object(ue.a)(t)),r.headers.set("Content-Type","application/json;charset=utf-8"),r.headers.set("X-Client-LocalTime",(new Date).toISOString()),r.headers.set("client-request-id",e);const o=Object(re.b)();o&&r.headers.append("X-AnchorMailbox",o);const i={EntityRequests:[{EntityType:"Message",Context:{EntityContext:[{"@type":"Microsoft.OutlookServices.MailFolder",id:Object(ie.a)("inbox")}]}}],Scenario:{Name:"ContextualInsights"}};return r.body=JSON.stringify(i),r};var le=async e=>{const t=await se(),n=de(Object(S.a)(),t,Object(O.R)(e));return await fetch(Object(ae.v)("/search/api/v1/recommendations",Object(oe.a)()),n)},fe=n(11906),ge=n(958);let me=null;const pe=async e=>{const t=Object(fe.a)(),n=new g.b("SpotlightService",{sessionSampleRate:20}),r=Date.now(),o=await le(t);n.end();const i=await async function(e,t,n,r){var o,i,c,a,u,s,d,l,f;const g=[],b=[],h=Object(O.R)(t),I=[],v=await e.json(),w=(null===(a=null===(c=null===(i=null===(o=null==v?void 0:v.EntitySets)||void 0===o?void 0:o[0])||void 0===i?void 0:i.ResultSets)||void 0===c?void 0:c[0])||void 0===a?void 0:a.Results)||[];m.k.importAndExecute(p.c.ContextualInsights,null===(u=null==v?void 0:v.Instrumentation)||void 0===u?void 0:u.TraceId,n.getData(q.a.e2eTimeElapsed),e.status);let S=!1,j=[];if(Object(Y.j)("fwk-immutable-ids")||Object(Z.a)("native")){const e=w.map(e=>{var t;return null===(t=e.Source.ItemId)||void 0===t?void 0:t.Id}),t=Object(ee.d)().userIdentity;Object(X.c)(e,t)&&(j=await Object($.b)(e,Object(X.b)(t),t,$.a.Spotlight),j.length===w.length&&(S=!0))}let C=0;for(const e of w){const n=null===(s=e.Source.ConversationId)||void 0===s?void 0:s.Id,r=S?j[C++]:null===(d=e.Source.ItemId)||void 0===d?void 0:d.Id,o=te(h?n:r,t);if(o){if(h){if(I.indexOf(n)>-1)continue;I.push(n)}Object(U.g)(o,t.id)||(x({spotlightCacheType:T.Dismissed,itemId:r,conversationId:n,rowKey:o})||(h?b.push(z(e.Source,o)):b.push(V(e.Source,o))),g.push({conversationId:n,itemId:r,rowKey:o,isAcknowledged:x({spotlightCacheType:T.Acknowledged,itemId:r,conversationId:n,rowKey:o}),isDismissed:x({spotlightCacheType:T.Dismissed,itemId:r,conversationId:n,rowKey:o}),reason:ne(e.Source.SingleValueExtendedProperties),senderName:null===(f=null===(l=e.Source.Sender)||void 0===l?void 0:l.EmailAddress)||void 0===f?void 0:f.Name,referenceId:e.ReferenceId,dateTimeReceived:Object(y.Vb)(e.DateTimeReceived),isTeachingMomentTarget:!1}))}}let A=null,k=null;for(let e=0;e<g.length;e++){const t=g[e];(!A||t.dateTimeReceived>A.dateTimeReceived)&&(A=t,k=e)}null!==k&&(g[k].isTeachingMomentTarget=!0);const M=Object.assign(Object.assign({},t.tableQuery),{scenarioType:"spotlight"});return Object(J.c)(Object(L.c)(M),b,b.length,"SpotlightLoad",null,null,!0),W(M),r&&r(Object(L.c)(M),!0,e.status.toString(),!1),g}(o,t,n,e);s(i,Object(O.R)(t),r)},be=Object(ge.a)(pe,1e4,{maxWait:2e4,trailing:!0});var he=e=>{Object(w.a)()&&(me?be(e):(pe(e),me=setInterval(()=>{pe(e)},36e5)))};function Ie(){return Object(d.a)().logicalId}function ve(){return Object(d.a)().spotlightItems.filter(e=>!e.isAcknowledged).length}function we(){return Object(d.a)().spotlightItems.length}var ye=n(1693);function Se(e){var t,n;const r=Object(f.a)(e);if(!r)return null;const o=Object(ye.b)().items.get(r.itemId);return o?JSON.stringify({messageBody:(null===(t=o.UniqueBody)||void 0===t?void 0:t.Value)||(null===(n=o.NormalizedBody)||void 0===n?void 0:n.Value)||"",itemId:o.ItemId.Id}):null}var Oe=n(15611),je=n(6);function Ce(e){switch(e){case 1:return Object(je.b)(Oe.a);case 2:return Object(je.b)(Oe.b);case 4:return Object(je.b)(Oe.c);case 64:return Object(je.b)(Oe.e);case 128:return Object(je.b)(Oe.j);case 256:return Object(je.b)(Oe.d);case 512:return Object(je.b)(Oe.f);case 1024:return Object(je.b)(Oe.i);case 2048:return Object(je.b)(Oe.h);case 8:case 0:case 16:default:return Object(je.b)(Oe.g)}}function Te(e){Ae(),E(e)}const Ae=()=>{const{spotlightTableQuery:e}=Object(d.a)();if(!e)return;const t=Object(L.c)(e),n=R(T.Dismissed).map(e=>e.rowKey).filter(e=>t.rowKeys.includes(e));n.length>0&&Object(K.a)(n,t,"Spotlight",!1)};n.d(t,"fetchSpotlightItems",(function(){return he})),n.d(t,"onSpotlightDismissedFromRP",(function(){return c})),n.d(t,"getSpotlightLogicalId",(function(){return Ie})),n.d(t,"getSpotlightItem",(function(){return B})),n.d(t,"getUnacknowledgedSpotlightCount",(function(){return ve})),n.d(t,"getSpotlightCount",(function(){return we})),n.d(t,"getSpotlightDonationJson",(function(){return Se})),n.d(t,"getSpotlightReasonString",(function(){return Ce})),n.d(t,"loadImportantTable",(function(){return Te})),n.d(t,"logSpotlightItemClicked",(function(){return I})),n.d(t,"logSpotlightResultsRendered",(function(){return v}))},1964:function(e,t,n){"use strict";function r(e,t){const n=Math.pow(2,32);if(e>=n||t>=n){const r=e%n,o=t%n;return(((e-=r)/n&(t-=o)/n)>>>0)*n+((r&o)>>>0)}return(e&t)>>>0}n.d(t,"a",(function(){return r}))},1974:function(e,t,n){"use strict";var r=n(225),o=n(1681);const i=new Map;var c=n(2058),a=n(1754),u=n(3070);function s(e){return e?d(e.tableQuery):Object(r.d)()}function d(e){const t=Object(a.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(c.a)(t):l(n)}function l(e){return Object(o.G)(e)?Object(u.a)(e):function(e){if(!e)return Object(r.d)();if(!i.has(e)){let t=Object(o.t)(e,!0);i.set(e,t)}return i.get(e)}(e)}function f(e){return{mailboxInfo:d(e)}}n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return f}))},2035:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"s",(function(){return i})),n.d(t,"q",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"n",(function(){return u})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"k",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"i",(function(){return b})),n.d(t,"p",(function(){return h})),n.d(t,"m",(function(){return I})),n.d(t,"r",(function(){return v})),n.d(t,"o",(function(){return w})),n.d(t,"l",(function(){return y}));const r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",c=".p7m",a="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",u="CLASSID",s="4",d="0800",l=57,f=78,g="IPM.Note.SMIME.MultipartSigned",m="smime-",p="image",b="OwaToSmime",h="SmimeToOwa",I="en-US",v=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],w="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",y="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},2042:function(e,t,n){"use strict";function r(){return{isBeingDragged:!1}}n.d(t,"a",(function(){return r}))},2058:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);const o={};function i(e){const t=e.toLocaleLowerCase();if(!o[t]){const n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};o[t]=n}return o[t]}},2124:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1934);function o(e,t){return!(!e||!t)&&Object(r.a)(e)===Object(r.a)(t)}},213:function(e,t,n){"use strict";var r=n(36);let o;function i(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var c=n(113);const a=500,u=[],s=[],d=[];let l=!0;function f(e,t){Object(r.g)((e,t,n,o)=>{l&&(t==r.b.Error&&s.push({message:e,error:o}),u.push({message:e,level:t}))}),e(m),t(m),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function g(e){const t=Object(c.a)(e);return l=!1,{traces:u,errors:s,network:d,usage:t}}function m(){l&&d.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"d",(function(){return c.b})),n.d(t,"c",(function(){return i}))},2148:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2637);function o(e){return e&&Object(r.b)(e.ItemClass)}},2231:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r=350,o=270},226:function(e,t,n){"use strict";function r(e){var t,n;if((null==e?void 0:e.length)>0){const r=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(n=e[1])||void 0===n?void 0:n.length)>0?r:void 0}}const o="bearer",i="msauth1.0",c=3600,a=86400,u=6e4,s=1e3;function d(e){if(e){const t=e.split(" ");return r(t)==o?t[1]:e}}function l(e,t){if(e){const n=r(e.split(" "));if(n){if(t){return(1e3*t-Date.now()-u)/s}return n==i?a:c}}}function f(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return f}))},227:function(e,t,n){"use strict";t.decode=t.parse=n(380),t.encode=t.stringify=n(381)},2287:function(e,t,n){"use strict";var r=n(16),o=n(3);let i={folderTable:new r.ObservableMap,rootFolder:null},c=Object(o.createStore)("publicFolderFavoriteStore",i)();t.a=c},2307:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));const r=1,o=16},2322:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="IPM.Note.SMIME"},2386:function(e,t,n){"use strict";var r;!function(e){e.EwsId="ews",e.EwsImmutableId="ewsimmutable"}(r||(r={}));var o=n(47),i=n(3),c=Object(i.createStore)("immutableId",{IsImmutableIdFeatureOnForConnectedAccount:!1});var a=n(287);function u(e){return Object(a.r)(e)?c().IsImmutableIdFeatureOnForConnectedAccount?r.EwsImmutableId:r.EwsId:Object(o.j)("fwk-immutable-ids")?r.EwsImmutableId:r.EwsId}function s(e){return!!e&&e.length<90}function d(e){const t=[],n=[],r=[];return null==e||e.forEach((e,o)=>{"string"==typeof e&&(e.indexOf("@")>-1?r.push({id:e,idx:o}):s(e)?t.push({id:e,idx:o}):n.push({id:e,idx:o}))}),[t,n,r]}function l(e,t){const[n,o]=d(e),i=u(t);return i===r.EwsImmutableId&&o.length>0||i===r.EwsId&&n.length>0}const f=Object(i.mutatorAction)("setIsImmutableIdFeatureOnForConnectedAccount",e=>{c().IsImmutableIdFeatureOnForConnectedAccount=e});n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return f})),n.d(t,"a",(function(){return r}))},2388:function(e,t,n){"use strict";var r=n(20),o=n(1675),i=n(1800),c=n(1692),a=n(1698),u=n(2322);var s=n(2148),d=n(47);function l(e,t){if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;const n=c.u.items.get(e.ItemId.Id);return!(Object(s.a)(e)||(null==n?void 0:n.RightsManagementLicenseData))&&(!(null==n||!n.shouldShowAttachmentPreviews)||!!(e.HasAttachments||Object(d.j)("doc-linkDiscovery-shadowCalling")&&e.HasProcessedSharepointLink)&&(p.importAndExecute(Object(i.d)(t),e.ConversationId,e.ItemId.Id),!0))}let f=function(e,t,n={listViewStore:o.Z}){const r=1==t.type,c=e.ConversationId,s=n.listViewStore.conversationItems.get(c.Id),l=Object(d.j)("doc-linkDiscovery-shadowCalling")&&e.HasProcessedSharepointLink;if(t.folderId&&"junkemail"==Object(a.a)(t.folderId))return!1;if((null==(f=e)?void 0:f.ItemClasses)&&f.ItemClasses.length>0&&f.ItemClasses.some(e=>0===e.indexOf(u.a))||e.HasIrm)return!1;var f;let g,m;if(r){if(null==s?void 0:s.shouldShowAttachmentPreviews)return!0;m=!!e.HasAttachments||l,g=m}else{if(!e.HasAttachmentPreviews&&!l)return!1;s&&!l?(g=s.globalItemIds.length!=e.GlobalItemIds.length,m=s.shouldShowAttachmentPreviews):(g=!0,m=!0)}return g&&p.importAndExecute(Object(i.d)(t),e.ConversationId,null),m};n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return l}));const g=new r.c(()=>n.e(810).then(n.bind(null,19663))),m=new r.a(g,e=>e.getPreviews),p=new r.a(g,e=>e.add),b=new r.a(g,e=>e.getAttachmentsForConversationWell),h=new r.a(g,e=>e.removeAttachmentPreviewsForRow)},2417:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Framework=0]="Framework",e[e.Notifications=1]="Notifications",e[e.SuiteHeader=2]="SuiteHeader",e[e.Inbox=3]="Inbox",e[e.Compose=4]="Compose",e[e.Analytics=5]="Analytics",e[e.Messages=6]="Messages",e[e.Default=10]="Default"}(r||(r={}))},2419:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("MARK_ALL_AS_READ_STORE_UPDATE",(e,t,n)=>({tableView:e,markAsRead:t,rowIdsToExclude:n}))},2481:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("meetingMessageAddToCalendarStatusChanged",(e,t)=>({status:e,sxsId:t})),i=n(2681),c=n(2596);function a(e){return e.match(/^ipm\.schedule\.meeting\.resp/i)}function u(e){return e.match(/^ipm\.schedule\.meeting\.canceled/i)}function s(e){const t=e;return"RecurringMaster"===t.CalendarItemType&&!t.RecurrenceId}function d(e){const t=e;return"Single"===t.CalendarItemType&&!t.RecurrenceId}function l(e){return!!e.RecurrenceId}n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return i.a})),n.d(t,"f",(function(){return c.a})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l}))},2548:function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u}));var r=n(20),o=n(2417);n.d(t,"a",(function(){return o.a}));const i=new r.c(()=>n.e(965).then(n.bind(null,4201))),c=new r.a(i,e=>e.tti),a=new r.a(i,e=>e.govern),u=new r.a(i,e=>e.enableGovernReport)},2568:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(e,t)=>({itemIdToRemove:e,removeItemSource:t}))},2596:function(e,t,n){"use strict";function r(e){return e.match(/^ipm\.schedule\.meeting\.request/i)}n.d(t,"a",(function(){return r}))},2620:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(225);function o(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},2637:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(2035),o=n(2322);function i(e){return e&&0===e.indexOf(r.e)}function c(e){return e&&0===e.indexOf(o.a)&&!i(e)}function a(e){return e&&0===e.indexOf(o.a)}function u(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},2654:function(e,t,n){"use strict";var r,o=n(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(r||(r={})),n.d(t,"b",(function(){return a})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return r}));const i=new o.d(()=>n.e(872).then(n.bind(null,19655))),c=(e,t)=>{const n=new o.a(e,t);return(...e)=>n.importAndExecute(...e)},a=c(i,e=>e.convertIdsToTargetFormat),u=c(i,e=>e.translateRestImmutableIdsToEwsIds),s=c(i,e=>e.translateEwsIdsToEwsImmutableIds),d=c(i,e=>e.translateEwsIdsToRestImmutableIds);c(i,e=>e.translateEwsImmutableIdsToEwsIds)},2680:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1681);function o(e){return Object(r.C)(e,"SharedMailbox")}},2681:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.ItemClass)&&e.ItemClass.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}n.d(t,"a",(function(){return r}))},291:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(135),o=n(100),i=n(2);let c;function a(e){c=e}async function u(e){var t,n;if(Object(i.Q)())return o.f.importAndExecute(Object(r.a)());const a=c&&await c(void 0,e);if(a&&a.length>0){if("bearer"===(null===(t=null==a?void 0:a.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return a.split(" ")[1];if("msauth1.0"===(null===(n=null==a?void 0:a.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return a}}},2976:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);let o=Object(r.action)("USERMAIL_INTERACTION",(e,t,n)=>({interactionType:e,instrumentationContexts:t,triageContext:n}))},3070:function(e,t,n){"use strict";var r=n(1675),o=n(1681);function i(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)}function c(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var a=n(3),u=n(2287),s=n(2620),d=n(16);var l=Object(a.createStore)("publicFolderUtilsStore",new d.ObservableMap),f=n(57);function g(e){if(!l().has(e)){const t=u.a.folderTable.get(e),n=null!=t.replicaList?t.replicaList[0]:Object(f.g)().SessionSettings.DefaultPublicFolderMailbox,r=Object(s.a)(n);m(e,r)}return l().get(e)}const m=Object(a.mutatorAction)("addPublicFolderMailboxInfoToStore",(e,t)=>{l().set(e,t)});n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return g}))},3164:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a}));var r=n(2),o=n(40),i=n(57);function c(){let e=Object(r.v)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.v)(t)}function a(){let e=function(){let e="",t=Object(o.b)().pathname.split("/").filter(e=>e.length);return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}();if(0===e.length){let t=Object(i.g)();if(null==t?void 0:t.SessionSettings){let n=t.SessionSettings.ExternalDirectoryTenantGuid,r=t.SessionSettings.UserPuid;r&&n&&(e=`PUID:${r}@${n}`)}}return 0===e.length&&(e=c()),e}},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function c(e){return r.test(e)}},3304:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(20),o=n(2976);n.d(t,"d",(function(){return o.a}));const i=new r.c(()=>n.e(1060).then(n.bind(null,5971)));let c=new r.a(i,e=>e.onKeyboardUpDown),a=new r.a(i,e=>e.onOpenEmail),u=new r.a(i,e=>e.onKeyboardToggleSelect)},380:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var c={};if("string"!=typeof e||0===e.length)return c;var a=/\+/g;e=e.split(t);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var s=e.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var l,f,g,m,p=e[d].replace(a,"%20"),b=p.indexOf(n);b>=0?(l=p.substr(0,b),f=p.substr(b+1)):(l=p,f=""),g=decodeURIComponent(l),m=decodeURIComponent(f),r(c,g)?o(c[g])?c[g].push(m):c[g]=[c[g],m]:c[g]=m}return c};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},381:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(c(e),(function(c){var a=encodeURIComponent(r(c))+n;return o(e[c])?i(e[c],(function(e){return a+encodeURIComponent(r(e))})).join(t):a+encodeURIComponent(r(e[c]))})).join(t):a?encodeURIComponent(r(a))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var c=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},473:function(e,t,n){"use strict";var r=n(347),o=n(306),i="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(o.a)(e)&&Object(r.a)(e)==i}},629:function(e,t,n){"use strict";var r=/\s/;var o=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},i=/^\s+/;var c=function(e){return e?e.slice(0,o(e)+1).replace(i,""):e},a=n(252),u=n(473),s=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,f=/^0o[0-7]+$/i,g=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return s;if(Object(a.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(a.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=c(e);var n=l.test(e);return n||f.test(e)?g(e.slice(2),n?2:8):d.test(e)?s:+e}},8587:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("onSpotlightDisabled");n.d(t,"a",(function(){return o}))},958:function(e,t,n){"use strict";var r=n(252),o=n(247),i=function(){return o.a.Date.now()},c=n(629),a="Expected a function",u=Math.max,s=Math.min;t.a=function(e,t,n){var o,d,l,f,g,m,p=0,b=!1,h=!1,I=!0;if("function"!=typeof e)throw new TypeError(a);function v(t){var n=o,r=d;return o=d=void 0,p=t,f=e.apply(r,n)}function w(e){var n=e-m;return void 0===m||n>=t||n<0||h&&e-p>=l}function y(){var e=i();if(w(e))return S(e);g=setTimeout(y,function(e){var n=t-(e-m);return h?s(n,l-(e-p)):n}(e))}function S(e){return g=void 0,I&&o?v(e):(o=d=void 0,f)}function O(){var e=i(),n=w(e);if(o=arguments,d=this,m=e,n){if(void 0===g)return function(e){return p=e,g=setTimeout(y,t),b?v(e):f}(m);if(h)return clearTimeout(g),g=setTimeout(y,t),v(m)}return void 0===g&&(g=setTimeout(y,t)),f}return t=Object(c.a)(t)||0,Object(r.a)(n)&&(b=!!n.leading,l=(h="maxWait"in n)?u(Object(c.a)(n.maxWait)||0,t):l,I="trailing"in n?!!n.trailing:I),O.cancel=function(){void 0!==g&&clearTimeout(g),p=0,o=m=d=g=void 0},O.flush=function(){return void 0===g?f:S(i())},O}}}]);
//# sourceMappingURL=owa.506.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.506.js'] = 1;