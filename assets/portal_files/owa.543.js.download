(window.$wj=window.$wj||[]).push([[543,97],{132:function(t,e,n){"use strict";var i=n(2);const o={showOwaBranding:{default:!0,native:!1},includePartnerIn3SRequest:{default:!1},loadThemeFromHostApp:{default:!1,opx:!0},loadCultureFromHostApp:{default:!1,opx:!0},opxDeeplink:{default:!1,opx:!0},authRedirectOnSessionTimeout:{default:!0,native:!1,opx:!1},opxComponentLifecycle:{default:!1,native:!1,opx:!0},opxServiceWorker:{default:!1,opx:!0},routeOptionsStaticUrl:{default:!1,opx:!0},scenarioData:{default:!1,opx:!0},macA11y:{default:!1,macoutlook:!0},joinTeamsMeetingHandler:{default:!1,hub:!0,opx:!0},use3SPeopleSuggestions:{default:!0,macoutlook:!1},defaultCalendarColor:{default:!1,opx:!0},roomAddedHandler:{default:!1,opx:!0},roomFinderFreeBusyStyles:{default:!1,macoutlook:!0,outlookdesktop:!0},defaultSelectCalendarItemSvg:{default:!0,opx:!1},opxInboxRules:{default:!1,opx:!0},moduleNameFromWindow:{default:!0,opx:!1},showArchiveUnreadCount:{default:!1,native:!0},ribbonFeedback:{default:!1,hub:!0},composeFrom:{default:!1,opx:!0},groupDiscoverCloseButton:{default:!1,opx:!0},updateModalProps:{default:!1,opx:!0},modalOpenedHandler:{default:!1,opx:!0},defaultOutlookThemeColor:{default:!0,opx:!1},yammerDailyDigest:{default:!1,outlookdesktop:!0},yammerDirectFollower:{default:!1,outlookdesktop:!0},yammerDiscovery:{default:!1,outlookdesktop:!0},yammerHostClientType:{default:!1,native:!0,opx:!0},linkClicked:{default:!1,outlookdesktop:!0},showMinimumThreeInsights:{default:!1,opx:!0},groupCreatedHandler:{default:!1,opx:!0},groupDeletedHandler:{default:!1,opx:!0},updateSearchAnswerOnQueryChange:{default:!1,opx:!0},insightsCountUpdatedHandler:{default:!1,opx:!0},processMeetingInsightsHandler:{default:!1,opx:!0},processEmptyYammerPublishersHandler:{default:!1,opx:!0},focusZoneCicularNavigation:{default:!1,opx:!0},componentTokenProvider:{default:!1,opx:!0,native:!0,hub:!0},hideCalendarLeftNav:{default:!1,teamshub:!0},hideAppSuiteHeader:{default:!1,hub:!0},metaOSTest:{default:!1,hub:!0},hideOfficeRail:{default:!1,hub:!0},openMailInHub:{default:!1,win32outlookhub:!0},openComposeMailInHub:{default:!1,win32outlookhub:!0},settings:{default:!0,opx:!1,hub:!1},multiAccounts:{default:!0,teams:!1,outlookdesktop:!1,widget:!1,native:!1,hub:!1},nativeDiagnostics:{default:!1,native:!0},nativeQsp:{default:!1,native:!0},moduleSwitch:{default:!1,native:!0},diagInAppSupport:{default:!1,native:!0},diagFeedbackJs:{default:!1,native:!0},diagFeedbackEmailGroup:{default:!1,native:!0},diagFeedbackNoAttachSR:{default:!1,native:!0},diagFeatureCrew:{default:!1,native:!0},diagThrottleFeedbackEmail:{default:!1,native:!0},diagToggleFeedback:{default:!1,native:!0},newOutlookToggle:{default:!1,native:!0},monarchErrorMessage:{default:!1,native:!0},noteFeedSidePanel:{default:!0,native:!1},whatsNew:{default:!0,native:!1},owaBrandingCharm:{default:!0,native:!1},appLauncher:{default:!0,native:!1},incorrectNativeEntryPoint:{default:!1,native:!0},metaOSFeedback:{default:!1,hub:!0},monarchFeedback:{default:!1,native:!0},native:{default:!1,native:!0},managedQueryLink:{default:!1,native:!0},wrongIndex:{default:!1,native:!0},outlookSuiteHeaderStrategy:{default:!1,native:!0},pauseInbox:{default:!0,native:!1},nativeServiceWorker:{default:!1,native:!0},nativeHostAttachmentHijack:{default:!1,native:!0},useNativeConversationOptions:{default:!1,native:!0},reboot:{default:!1,native:!0},calendarFoldersFromSessionData:{default:!1,native:!0},skipAwaitLpcConfig:{default:!1,opx:!0},workloadScenarioSettings:{default:!0,opx:!1},ribbonDefaultToSLR:{default:!1,native:!0},ribbonPersistDefault:{default:!1,native:!0},updateHostAppIcon:{default:!1,native:!0},projectionCustomTitlebar:{default:!1,native:!0},toDoNewTab:{default:!1,native:!0},floodgate:{default:!0,opx:!1},meControlAccountSwitching:{default:!0,native:!1},smimeExtension:{default:!0,native:!1},platformAppSdk:{default:!1,hub:!0},resourceTokenFromHost:{default:!1,native:!0,opx:!0},useBaseTheme:{default:!1,win32outlookhub:!0,hub:!1},acctmonaccounts:{default:!1,native:!0},showOWAMailtoBanner:{default:!0,native:!1},copyLinkUsingClipboardApi:{default:!1,native:!0},editInBrowserReuseSameWindow:{default:!0,native:!1},outlookDesktopToMonarchPreferenceMigration:{default:!1,native:!0},nativeMessaging:{default:!1,native:!0,widget:!0},disableAppModuleKeys:{default:!1,hub:!0},nativeReactions:{default:!1,native:!0},promptRebootNativeHost:{default:!1,native:!0},openEventsInNewWindow:{default:!1,native:!0,win32outlookhub:!0},nativeFriendlyKeyboarding:{default:!1,native:!0,win32outlookhub:!0},altForKeytips:{default:!1,native:!0,win32outlookhub:!0},msalTokenFetch:{default:!0,native:!1,teams:!1,opx:!1,hub:!1},outlookNpsDialogMonarch:{default:!1,native:!0},multipleAccountSignalR:{default:!1,native:!0}};var r=n(136),a=n(146);const c=t=>{const e=(t=>o[t])(t);if(e){if(Object(r.a)()&&i.e in e)return e[i.e];if(Object(a.b)()&&i.h in e)return e[i.h];let t=Object(i.A)();if(t&&t in e)return e[t];if(t&&(t===i.i||t===i.k)&&i.b in e)return e[i.b];const n=Object(i.F)();return n&&n in e?e[n]:n&&(n===i.g||n===i.d||n===i.c||n===i.a||n===i.h||n===i.f||n===i.j)&&"opx"in e?e.opx:e.default}return!1};n.d(e,"a",(function(){return c}))},135:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r}));var i=n(40);function o(){let t=Object(i.b)(),e=t.origin;return e||(e=t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")),e}function r(){return o()+"/"}},137:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return r}));let i={};function o(t){i=t}function r(){return i}},146:function(t,e,n){"use strict";var i=n(153),o=n(2),r=n(11),a=n(5);function c(){return!!Object(a.f)("hostApp",Object(r.a)().location)&&Object(a.c)("hostApp").toLowerCase()==o.h}n.d(e,"a",(function(){return i.a})),n.d(e,"c",(function(){return i.b})),n.d(e,"b",(function(){return c}))},153:function(t,e,n){"use strict";let i;function o(){if(!i)throw new Error("OpxHostApi has not been initialized yet.");return i}function r(){return!!i}function a(t){i=t}n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a}))},174:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return s}));var i=n(280),o=n(9),r=n(137);const a="featureOverrides";function c(){const t=Object(o.a)(self,a);return t?Object(i.a)(t):{}}function u(){Object(o.d)(self,a)}function s(t){const e=Object(o.a)(self,a);let n=e?e.split(","):[];for(const e of t){const t=e.name.toLowerCase(),i=e.isEnabled?t:`-${t}`,o=Object(r.a)()[t],a=e.isEnabled===!o,c=new RegExp(`^-?${t}$`,"i");n=n.filter(t=>!c.test(t)),a&&n.push(i)}Object(o.e)(self,a,n.join(","))}},188:function(t,e,n){"use strict";function i(){var t=Object.create(null),e=0,n=0,i=0,o=!1;function r(e){i--,delete t[e]}this.put=function(e,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var c=t[e];c?clearTimeout(c.timeout):i++;var u={value:n,expire:o+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){r(e),a&&a(e,n)}.bind(this),o)),t[e]=u,n},this.del=function(e){var n=!0,i=t[e];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&r(e),n},this.clear=function(){for(var r in t)clearTimeout(t[r].timeout);i=0,t=Object.create(null),o&&(e=0,n=0)},this.get=function(r){var a=t[r];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&e++,a.value;o&&n++,i--,delete t[r]}else o&&n++;return null},this.size=function(){return i},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){o=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var i=t[n];e[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var i=JSON.parse(e),o=Date.now(),r=n&&n.skipDuplicates;for(var a in i)if(i.hasOwnProperty(a)){if(r)if(t[a])continue;var c=i[a],u=c.expire-o;if(u<=0){this.del(a);continue}u=u>0?u:void 0,this.put(a,c.value,u)}return this.size()}}t.exports=new i,t.exports.Cache=i},19504:function(t,e,n){"use strict";n.r(e);let i=[],o=!1;const r=()=>i,a=t=>i.push(t),c=()=>i=[],u=t=>o=t,s=()=>o;var d=n(2406);var l={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};let f,b;function h(){return f||(f=new d.a),f}function p(t){h().emit(l.ChannelData,t)}function g(t){h().emit(l.TraceWarn,t)}let m=!1;function v(){return m||j(),Object.keys(b).map(t=>b[t].refs[0].subscription)}function S(t){return m||j(),w(t)?b[t].refs:[]}function O(t){return b[t]}function w(t){return t in b}function j(){b={},m=!0}function C(t){try{t()}catch(t){e=t,h().emit(l.TraceError,e)}var e}var k=n(35);function y(t){return Object.assign({__type:"SubscriptionData:#Exchange"},t)}function I(t,e){var n;if(void 0===t.request||t.request.__type||(t.request=(n=t.request,Object.assign({__type:"NotificationSubscribeJsonRequest:#Exchange"},n))),void 0!==t.subscriptionData)for(var i=0;i<t.subscriptionData.length;i++)void 0===t.subscriptionData[i]||t.subscriptionData[i].__type||(t.subscriptionData[i]=y(t.subscriptionData[i]));return Object(k.a)("SubscribeToNotification",t,e)}var T=n(261);const R="Reload";function E(t){h().emit(l.NotificationData,t);let e=S(t.id).map(t=>t.callback);for(let n of e)C(()=>{n(t)})}function x(t){return{id:t,EventType:R}}function N(){let t=v();for(let e of t){E(x(e.subscriptionId))}}var A=n(132),D=n(47),_=n(255);const M=3,F=8,L=3e5,H=500;async function U(t){t.requiresExplicitSubscribe&&(w(t.subscriptionId)||(h().emit(l.SubscriptionRemoved,t),await async function(t){try{await function(t,e){if(void 0!==t.subscriptionData)for(var n=0;n<t.subscriptionData.length;n++)void 0===t.subscriptionData[n]||t.subscriptionData[n].__type||(t.subscriptionData[n]=y(t.subscriptionData[n]));return Object(k.a)("UnsubscribeToNotification",t,e)}({subscriptionData:[{SubscriptionId:t.subscriptionId,Parameters:t.subscriptionParameters}]})}catch(t){g(`Subscription unsubscribe failed: ${t.message}`)}}(t)))}function P(t){let e=O(t.subscriptionId);0!==e.pendingRetryHandle&&(window.clearTimeout(e.pendingRetryHandle),e.pendingRetryHandle=0),e.status=2,q(t,e),a(t),s()||(window.setTimeout(async()=>{let t=r();c(),u(!1),await async function(t){try{if(Object(A.a)("multipleAccountSignalR")&&Object(D.j)("auth-SignalRRoutingHint")){let e=t.filter(t=>t.subscribeForAllMailboxes),n=t.filter(t=>!t.subscribeForAllMailboxes);if(e.length>0){const t=function(){if(Object(A.a)("multipleAccountSignalR")){return Object(_.g)().sources.map(t=>({id:t.sourceId,displayName:t.displayName}))}return}().map(t=>G(t.id,t.displayName,e));await Promise.all(t)}if(n.length>0){const t=Object(_.j)();await G(t.sourceId,t.displayName,n)}}else await G(void 0,void 0,t)}catch(e){W(t,(t,n)=>{z(n,t,e)})}}(t)},H),u(!0))}async function G(t,e,n){let i={sourceId:t,customBaseUrlSubPath:e},o=await I({request:{Header:Object(T.b)()},subscriptionData:n.map(t=>({SubscriptionId:t.subscriptionId,Parameters:t.subscriptionParameters}))},i);W(n,(t,e)=>{let n=o.filter(t=>t.SubscriptionId===e.subscriptionId);0!==n.length?function(t,e,n){if(t.SuccessfullyCreated){if(n.retries>0){let t=S(e.subscriptionId);for(let e=0;e<t.length;e++){let n=t[e];n.subscription.onReconnected&&C(n.subscription.onReconnected)}}n.retries=0,n.pendingRetryHandle=0,n.status=3,q(e,n,"")}else B(e,n,t.ErrorInfo)}(n[0],e,t):z(e,t,new Error(`${e.subscriptionId} not in subscription responses`))})}function z(t,e,n){B(t,e,n.message)}function B(t,e,n){if(function(t){let e=x(t),n=S(t);for(let t of n)!0!==t.subscription.noSubscriptionFailureReload&&C(()=>{t.callback(e)})}(t.subscriptionId),0===e.retries){let e=S(t.subscriptionId);for(let t=0;t<e.length;t++){let i=e[t];i.subscription.onDisconnected&&C(()=>{i.subscription.onDisconnected(n)})}}e.retries+=1,e.status=1,e.retries<M?P(t):e.retries<F&&(e.pendingRetryHandle=window.setTimeout(()=>{e.pendingRetryHandle=0,P(t)},L)),q(t,e,n)}function W(t,e){t.map(t=>{let n=O(t.subscriptionId);n&&e(n,t)})}function q(t,e,n){h().emit(l.SubscriptionUpdated,t,e,n)}var Q=n(71);function V(t,e){!function(t,e){m||j(),w(t.subscriptionId)||(b[t.subscriptionId]={refs:[],status:0,retries:0,pendingRetryHandle:0}),b[t.subscriptionId].refs.push({subscription:t,callback:e})}(t,e),function(t){if(!t.requiresExplicitSubscribe)return;let e=O(t.subscriptionId);0===e.status?(h().emit(l.SubscriptionAdded,t),P(t)):q(t,e)}(t),Object(Q.o)("SignalRNotification",{SubscriptionId:t.subscriptionId,Action:"Subscribe"})}function Y(t,e){!function(t,e){if(!w(t.subscriptionId))return void g(`Tried to remove ${t.subscriptionId} from the subscription tracker when it didn't exist`);let n=b[t.subscriptionId].refs;for(let t=0;t<n.length;t++)if(n[t].callback===e){n.splice(t,1);break}0===n.length&&(0!==b[t.subscriptionId].pendingRetryHandle&&window.clearTimeout(b[t.subscriptionId].pendingRetryHandle),delete b[t.subscriptionId])}(t,e),U(t),Object(Q.o)("SignalRNotification",{SubscriptionId:t.subscriptionId,Action:"Unsubscribe"})}var J=n(326);let K,Z,X;const tt=()=>(K||(K=Object(J.a)()),K),et=()=>{void 0===Z&&(Z=new Promise(t=>{X=t}))},nt=()=>(et(),Z),it=()=>{et(),X()};var ot=n(52);function rt(t,e){var n;return void 0===t||t.__type||(n=t,t=Object.assign({__type:"ChannelRoundTripNotificationRequest:#Exchange"},n)),Object(k.a)("SendChannelRoundTripNotification",t,e)}const at=-1,ct=6e4,ut=3e5,st=9e5;let dt,lt=!1,ft=at,bt=at;function ht(){if(!Object(D.j)("auth-SignalRActivityTimer"))return;bt!==at&&window.clearTimeout(bt),ft!==at&&window.clearTimeout(ft);let t=Math.floor(Math.random()*(st-ut+1)+ut);bt=window.setInterval(mt,t)}function pt(){bt!==at&&window.clearTimeout(bt),ft!==at&&window.clearTimeout(ft)}function gt(){dt()}function mt(){p("Channel inactive, starting liveness round-trip check"),rt({}),ft=window.setTimeout(gt,ct)}function vt(){p("Received liveness round-trip payload, channel still live"),window.clearTimeout(ft),ht()}class St{constructor(t,e,n,i){this.PENDING_GET_ID="pg",this.RELOAD_ALL_ID="ReloadAllNotification",this.NO_TIMER=-1,this.RECONNECT_FAILOVER_STAGGER_RANGE=6e4,this.RECONNECT_RECYCLE_STAGGER_RANGE=3e4,this.connection=t,this.connectionOptions=e,this.managerStore=n,this.managerConfig=i}getConnectionState(){return this.connection.state}setConnectionCallbacks(){this.connection.received(this.connectionMessageReceivedHandler.bind(this)),this.connection.error(this.connectionErrorHandler.bind(this)),this.connection.disconnected(this.connectionDisconnectedHandler.bind(this)),this.connection.stateChanged(this.connectionStateChangedHandler.bind(this))}async setConnectionQueryParameters(){this.connection.qs=Object.assign({UA:"0",cid:this.managerStore.channelId,"X-OWA-CANARY":Object(ot.a)(),app:this.managerConfig.appName},this.managerConfig.getNotificationToken&&this.managerConfig.getNotificationToken.bind(this)&&{access_token:await this.getNotificationToken()})}setConnectionQueryParametersSync(){this.connection.qs=Object.assign({UA:"0",cid:this.managerStore.channelId,"X-OWA-CANARY":Object(ot.a)(),app:this.managerConfig.appName},this.managerConfig.getNotificationToken&&this.managerConfig.getNotificationToken.bind(this)&&{access_token:this.getNotificationTokenFromCache()})}startConnection(){this.managerStore.giveUpReconnecting=!1,this.managerStore.reconnectScheduled=!1,this.connection.start(this.connectionOptions)}connectionMessageReceivedHandler(t){ht();let e=t;for(let t of e)t.id===this.PENDING_GET_ID?this.handlePendingGetNotification(t):t.id===this.RELOAD_ALL_ID?(N(),p("reload all"),this.managerStore.mark++):(E(t),this.managerStore.mark++)}handlePendingGetNotification(t){switch("update"!==t.data&&p(t.data),t.data){case"alive1":this.handleAliveNotification(t);break;case"reinitSubscriptions":v().map(t=>{P(t)}),p("reinit subscriptions");break;case"validateSubscriptions":p(`validate subscriptions:${function(t){let e=[];if(null!=t){let n={};for(let e=0;e<t.length;++e)null!=t[e]&&(n[t[e]]=!0);let i=v();for(let t=0;t<i.length;++t){3!=O(i[t].subscriptionId).status||n[i[t].subscriptionId]||(e.push(i[t].subscriptionId),P(i[t]))}}return e}(t.subscriptionIds).join("|")}`);break;case"update":this.checkMarksAndHandleMismatch(t);break;case"backendConnectionDropped":this.handleBackendConnectionDropped(),p("backend connection dropped");break;case"diagnostic":p(`diagnostic: ${t.message}`)}}handleAliveNotification(t){2===this.managerStore.state&&p("alive1 when channel was already ready"),p(`channel ids: local ${this.managerStore.channelId} server ${t.cid}`),p(`client mark: ${this.managerStore.mark}, server mark: ${t.mark}`),this.managerStore.channelId=t.cid,this.managerStore.state=2,this.setConnectionQueryParametersSync(),this.checkMarksAndHandleMismatch(t),this.managerStore.mark=0,it()}checkMarksAndHandleMismatch(t){t.mark!==this.managerStore.mark&&(p(`mark mismatch local: ${this.managerStore.mark}, server: ${t.mark}`),N(),this.managerStore.mark=t.mark)}connectionErrorHandler(t){pt(),t.context&&(401===t.context.status||440===t.context.status?(p("session timed out"),this.managerStore.giveUpReconnecting=!0,this.managerConfig.handleSessionTimeout&&this.managerConfig.handleSessionTimeout.bind(this)&&this.managerConfig.handleSessionTimeout(),Object(A.a)("componentTokenProvider")&&(this.managerStore.giveUpReconnecting=!1,this.setConnectionQueryParametersSync())):449===t.context.status&&(p("Canary cookie expiration"),this.setConnectionQueryParametersSync()))}stopConnection(){this.managerStore?(p("connection stopped"),pt(),this.managerStore.state=3,this.managerStore.giveUpReconnecting=!0,this.connection.stop()):p("attempting to stop connection before initialization")}handleBackendConnectionDropped(){this.stopConnection(),this.managerStore.reconnectTimeout=this.managerConfig.backoffMaximum,this.retryConnectionWithBackOff("ChannelReconnectConnectionDropped",this.RECONNECT_FAILOVER_STAGGER_RANGE)}connectionDisconnectedHandler(t=!1){pt(),1==this.managerStore.state?this.managerStore.state=0:2!=this.managerStore.state&&4!=this.managerStore.state||(this.managerStore.state=3),t&&(this.managerStore.reconnectTimeout=Math.abs(this.managerConfig.minimumReconnectInterval)),!0!==this.managerStore.giveUpReconnecting&&this.retryConnectionWithBackOff("ChannelReconnectConnectionDisconnected",t?0:this.RECONNECT_RECYCLE_STAGGER_RANGE)}connectionStateChangedHandler(t){switch(t.newState){case 1:0===this.managerStore.state?(this.managerStore.state=1,p("channel initialized")):3===this.managerStore.state&&(this.managerStore.state=4,p("channel reconnecting")),this.managerStore.reconnectTimeout=Math.abs(this.managerConfig.minimumReconnectInterval),this.startChannelReadyTimer();break;case 4:case 2:pt(),1===this.managerStore.state?(this.managerStore.state=0,p("channel uninitialized")):2===this.managerStore.state&&(this.managerStore.state=4,p("channel reconnecting")),this.stopChannelReadyTimer()}}retryConnectionWithBackOff(t,e){let n=Math.abs(this.managerStore.reconnectTimeout);n+=Math.floor(Math.random()*e),p(`retrying connection with backoff ${n}`),Object(D.j)("auth-notificationChannelTelemetry")&&Object(Q.o)(t,{domain:window.location.hostname,delay:n},{isCore:!0}),window.setTimeout(this.startConnection.bind(this),n),this.managerStore.reconnectTimeout=Math.min(2*Math.abs(this.managerStore.reconnectTimeout),Math.abs(this.managerConfig.backoffMaximum)),this.managerStore.reconnectScheduled=!0}startChannelReadyTimer(){this.managerStore.checkReadyTimer=window.setTimeout(this.checkIfChannelIsReady.bind(this),this.managerConfig.readyCheckTimeout)}stopChannelReadyTimer(){this.managerStore.checkReadyTimer!==this.NO_TIMER&&(window.clearTimeout(this.managerStore.checkReadyTimer),this.managerStore.checkReadyTimer=this.NO_TIMER)}checkIfChannelIsReady(){2!==this.managerStore.state&&(p("ready check timer expired"),this.stopConnection(),this.retryConnectionWithBackOff("ChannelReconnectNotReady",0))}reloadHandlers(){N()}handleLivenessFailure(){N(),Object(Q.o)("ChannelLivenessFailure",{domain:window.location.hostname},{isCore:!0}),p("restarting channel due to liveness check failure"),this.stopConnection(),this.startConnection(),ht()}getNotificationTokenFromCache(){let[t]=this.managerConfig.getNotificationToken(this.managerConfig.sourceId,this.managerConfig.email);return t}async getNotificationToken(){let[t,e]=this.managerConfig.getNotificationToken(this.managerConfig.sourceId,this.managerConfig.email);return t||(t=await e),t}retryDisconnection(){this.managerStore&&(this.managerStore.giveUpReconnecting=!1,this.managerStore.reconnectScheduled=!1,this.connectionDisconnectedHandler(!0))}async init(){this.managerStore.channelId=tt(),this.setConnectionCallbacks(),await this.setConnectionQueryParameters();let t=this.connection.stop.bind(this.connection);var e;this.connection.stop=(e,n)=>{t(!0,n)},e=this.handleLivenessFailure.bind(this),lt||(lt=!0,dt=e,V({subscriptionId:"RoundTrip",requiresExplicitSubscribe:!1,subscriptionParameters:{},noSubscriptionFailureReload:!0},vt)),$.signalR.ajaxDefaults.timeout=6e4,$.signalR.transports.serverSentEvents.timeOut=6e4,Object(D.j)("auth-notificationChannelTelemetry")&&Object(Q.o)("ChannelInitialization",{domain:window.location.hostname},{isCore:!0}),this.startConnection()}}class Ot{static getSourceId(){return Object(A.a)("native")?Object(_.j)().sourceId:"OWADefault"}static async initializeSignalR(t,e,n,i){let o=i.sourceId?i.sourceId:Ot.getSourceId();if(Ot.connectionInstances.has(o)){let t=Ot.connectionInstances.get(o);4===t.getConnectionState()&&(await t.init(),N())}else{let r=new St(t,e,n,i);await r.init(),Ot.connectionInstances.set(o,r),N()}}static stopConnection(){let t=Ot.getSourceId();if(Ot.connectionInstances.has(t)){Ot.connectionInstances.get(t).stopConnection()}}static retryDisconnection(){let t=Ot.getSourceId();if(Ot.connectionInstances.has(t)){Ot.connectionInstances.get(t).retryDisconnection()}}}Ot.connectionInstances=new Map;var wt=n(404),jt=n(610),Ct=n(2);async function kt(t){window.owaLogSignalRError=(t,e)=>{Object(D.j)("auth-reportSignalRError")&&Object(Q.o)("ChannelInitNetworkFailure",e,{isCore:!0})};const e=(await n.e(1917).then(n.t.bind(null,19300,7))).default;window.$=e,window.jQuery=e,await n.e(1965).then(n.bind(null,19301)),Object(A.a)("componentTokenProvider")&&null==t.getNotificationToken&&(t.getNotificationToken=(t,e)=>(function(t,e){let n=Object(jt.n)()+Object(jt.t)("/owa")+"/notificationchannel/";e&&Object(D.j)("auth-SignalRRoutingHint")&&(n=Object(jt.n)()+Object(jt.t)("/owa")+"/"+e+"/notificationchannel/");return Object(wt.getAccessTokenforResourceAsLazy)(n,"OwaNotifications",void 0,void 0,void 0,void 0,void 0,t)})(t,e)),null==t.appName&&(t.appName=Object(Ct.m)());let i={state:0,channelId:null,mark:0,reconnectTimeout:t.minimumReconnectInterval,reconnectScheduled:!1,giveUpReconnecting:!1,checkReadyTimer:-1,notificationInactivityTimer:-1},o=$.signalR.transports._logic.getUrl;$.signalR.transports._logic.getUrl=(t,e,n,i,r)=>(t.appRelativeUrl=t.url,o(t,e,n,i,r));let r=$.connection(t.channelEndpoint),a={transport:[$.signalR.transports.serverSentEvents.name,$.signalR.transports.foreverFrame.name],pingInterval:t.pingInterval};await Ot.initializeSignalR(r,a,i,t)}function yt(){Ot.retryDisconnection()}function It(){window.owaNotification={subscribe:V,unsubscribe:Y,getChannelId:tt},window.dispatchEvent(new Event("owaNotificationLoaded"))}n.d(e,"setup",(function(){return It})),n.d(e,"subscribe",(function(){return V})),n.d(e,"unsubscribe",(function(){return Y})),n.d(e,"getChannelId",(function(){return tt})),n.d(e,"getChannelReady",(function(){return nt})),n.d(e,"NotificationEventType",(function(){return l})),n.d(e,"initializeNotificationManager",(function(){return kt})),n.d(e,"retryDisconnectionWithMinimumReconnectInterval",(function(){return yt})),n.d(e,"getNotificationEmitter",(function(){return h})),n.d(e,"handleNotification",(function(){return E})),n.d(e,"NotificationManager",(function(){return Ot}))},201:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(91),o=n(278),r=n(36);function a(t,e){if(!Object(o.a)()){if(e)return!1;r.d(`Attempted to read ${t} before feature flags were initialized.`)}return Object(i.a)().featureFlags.get(t.toLowerCase())||!1}},202:function(t,e,n){"use strict";var i=n(22);e.a=(t,e)=>new Date(+t+e*i.h)},213:function(t,e,n){"use strict";var i=n(36);let o;function r(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var a=n(113);const c=500,u=[],s=[],d=[];let l=!0;function f(t,e){Object(i.g)((t,e,n,o)=>{l&&(e==i.b.Error&&s.push({message:t,error:o}),u.push({message:t,level:e}))}),t(h),e(h),r()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function b(t){const e=Object(a.a)(t);return l=!1,{traces:u,errors:s,network:d,usage:e}}function h(){l&&d.push(arguments)}n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return b})),n.d(e,"d",(function(){return a.b})),n.d(e,"c",(function(){return r}))},218:function(t,e,n){"use strict";n.d(e,"b",(function(){return o}));var i=n(3);const o={loadState:n(514).b.Loading,selectedSourceId:"",globalSettingsSourceId:"",sources:[]},r=Object(i.createStore)("AccountSourceList",o);e.a=r},22:function(t,e,n){"use strict";n.d(e,"i",(function(){return i})),n.d(e,"e",(function(){return o})),n.d(e,"f",(function(){return r})),n.d(e,"g",(function(){return a})),n.d(e,"h",(function(){return c})),n.d(e,"l",(function(){return u})),n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return d})),n.d(e,"j",(function(){return l})),n.d(e,"c",(function(){return f})),n.d(e,"k",(function(){return b})),n.d(e,"d",(function(){return h}));const i=6048e5,o=864e5,r=36e5,a=6e4,c=1e3,u=12,s=30,d=365,l=-864e13,f=864e13,b=Date.UTC(1601,0,1),h=Date.UTC(4501,0,1)},226:function(t,e,n){"use strict";function i(t){var e,n;if((null==t?void 0:t.length)>0){const i=null===(e=t[0])||void 0===e?void 0:e.toLowerCase();return(null===(n=t[1])||void 0===n?void 0:n.length)>0?i:void 0}}const o="bearer",r="msauth1.0",a=3600,c=86400,u=6e4,s=1e3;function d(t){if(t){const e=t.split(" ");return i(e)==o?e[1]:t}}function l(t,e){if(t){const n=i(t.split(" "));if(n){if(e){return(1e3*e-Date.now()-u)/s}return n==r?c:a}}}function f(t){var e;const n=null===(e=null==t?void 0:t.split(" "))||void 0===e?void 0:e[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?t:`Bearer ${t}`}n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return f}))},227:function(t,e,n){"use strict";e.decode=e.parse=n(380),e.encode=e.stringify=n(381)},229:function(t,e,n){"use strict";var i=n(22);e.a=(t,e)=>new Date(+t+e*i.g)},2406:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));class i{constructor(){this.eventDictionary={}}on(t,e,n){return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:e,callbackThis:n}),this}emit(t,...e){return(this.eventDictionary[t]||[]).slice().forEach(t=>t.callback.apply(t.callbackThis,e)),this}off(t,e){let n=this.eventDictionary[t];if(n){let i=n.filter(t=>t.callback!==e);i.length?this.eventDictionary[t]=i:delete this.eventDictionary[t]}return this}once(t,e,n){const i=this,o=(...r)=>(i.off(t,o),e.apply(n,r));return(this.eventDictionary[t]||(this.eventDictionary[t]=[])).push({callback:o,callbackThis:n}),this}}},255:function(t,e,n){"use strict";var i=n(3),o=Object(i.action)("ADD_ACCOUNT",t=>({accountSource:t})),r=n(910),a=Object(i.action)("REMOVE_ACCOUNT_BY_ID",t=>({accountSourceId:t})),c=Object(i.action)("SET_GLOBAL_SETTINGS_ACCOUNT",t=>({globalSettingsSourceId:t})),u=Object(i.action)("SET_LOAD_STATE",t=>({loadState:t})),s=Object(i.action)("SET_SELECTED_ACCOUNT",t=>({selectedSourceId:t})),d=Object(i.action)("SET_SHARED_SOURCES",(t,e)=>({sourceId:t,SharedAccountInfo:e})),l=Object(i.action)("UPDATE_ACCOUNT",t=>({accountSource:t})),f=n(376),b=n(218);function h(){const t=Object(f.a)(Object(b.a)().globalSettingsSourceId);if(!t)throw new Error("AccountSourceListStore is not initialized");return t}var p=n(968);function g(){return Object(b.a)().sources.filter(t=>t.characteristics.supportsMail)}var m=n(514);Object(i.mutator)(o,t=>{const e=Object(b.a)();if(Object(f.a)(t.accountSource.sourceId))throw new Error("Found duplicated account in the store.");e.sources.push(t.accountSource),e.selectedSourceId||(e.selectedSourceId=t.accountSource.sourceId),e.globalSettingsSourceId||(e.globalSettingsSourceId=t.accountSource.sourceId)}),Object(i.mutator)(a,t=>{const e=Object(b.a)();e.sources=e.sources.filter(e=>e.sourceId!==t.accountSourceId),t.accountSourceId==e.selectedSourceId&&(e.selectedSourceId=e.sources.length>0?e.sources[0].sourceId:b.b.selectedSourceId),t.accountSourceId==e.globalSettingsSourceId&&(e.globalSettingsSourceId=e.sources.length>0?e.sources[0].sourceId:b.b.globalSettingsSourceId)}),Object(i.mutator)(c,t=>{const e=Object(b.a)();if(0===e.sources.filter(e=>e.sourceId==t.globalSettingsSourceId).length)throw new Error("Source not found");e.globalSettingsSourceId=t.globalSettingsSourceId}),Object(i.mutator)(u,t=>{Object(b.a)().loadState=t.loadState}),Object(i.mutator)(s,t=>{const e=Object(b.a)();e.sources.filter(e=>e.sourceId==t.selectedSourceId).length>0&&(e.selectedSourceId=t.selectedSourceId)}),Object(i.mutator)(d,t=>{t.SharedAccountInfo.sources.forEach(e=>{const n=Object(f.b)(e.sourceId);if(n&&n.hostingSourceId!==t.sourceId)throw new Error("Found duplicated account in the store.")});const e=Object(f.a)(t.sourceId);e&&(e.sharedSources=t.SharedAccountInfo)}),Object(i.mutator)(l,t=>{const e=Object(b.a)();e.sources=e.sources.map(e=>e.sourceId===t.accountSource.sourceId?t.accountSource:e)});n.d(e,"e",(function(){return o})),n.d(e,"k",(function(){return r.a})),n.d(e,"l",(function(){return a})),n.d(e,"m",(function(){return u})),n.d(e,"n",(function(){return s})),n.d(e,"o",(function(){return d})),n.d(e,"p",(function(){return l})),n.d(e,"f",(function(){return f.a})),n.d(e,"h",(function(){return h})),n.d(e,"j",(function(){return p.a})),n.d(e,"g",(function(){return b.a})),n.d(e,"i",(function(){return g})),n.d(e,"a",(function(){return m.a})),n.d(e,"b",(function(){return m.b})),n.d(e,"c",(function(){return m.c})),n.d(e,"d",(function(){return m.d}))},261:function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return s}));var i=n(382),o=n(479),r=n(477),a=n(467),c=n(10);function u(t){return t||(t=Object(c.a)().timezone),t?Object(i.a)({RequestServerVersion:"V2018_01_08",TimeZoneContext:Object(o.a)({TimeZoneDefinition:Object(r.a)({Id:t})})}):Object(i.a)({RequestServerVersion:"V2018_01_08"})}function s(t,e,n){return Object(a.a)({PropertySetId:t,PropertyName:e,PropertyType:n})}},278:function(t,e,n){"use strict";var i=n(91),o=n(3),r=n(16),a=n(280),c=n(5);var u=n(111),s=n(201);var d=n(174),l=n(137),f=n(313);n.d(e,"a",(function(){return h}));let b=!1;function h(){return b}const p=Object(o.action)("initializeFeatureFlags",t=>{const e=(t||[]).reduce((t,e)=>(t[e.toLowerCase()]=!0,t),{}),n=function(t=s.a){return t("ring-dogfood")?"Dogfood":t("ring-microsoft")?"Microsoft":t("ring-firstrelease")?"FirstRelease":t("ring-ww")?"WW":"Unknown"}(t=>e[t]);return g(e,function(t){return Object.keys(f.a).reduce((e,n)=>(e[n.toLowerCase()]=f.a[n].ring.indexOf(t)>-1,e),{})}(n)),Object(u.b)(n),Object(l.b)(function(t){let e={};for(let n of Object.keys(t))e[n]=t[n];return e}(e)),"Dogfood"==n&&g(e,Object(d.b)()),e["fwk-devtools"]&&g(e,function(t){for(const[e,n]of Object.entries(Object(c.d)()))if(e.toLowerCase()===t.toLowerCase())return Object(a.a)(n);return{}}("features")),e});function g(t,e){for(let n of Object.keys(e))t[n.toLowerCase()]=e[n]}Object(o.mutator)(p,t=>{Object(i.a)().featureFlags=new r.ObservableMap(t),b=!0});e.b=p},280:function(t,e,n){"use strict";function i(t){let e={};return t.split(",").forEach(t=>{let n=!0;0===t.indexOf("-")&&(n=!1,t=t.slice(1,t.length)),e[t.toLowerCase()]=n}),e}n.d(e,"a",(function(){return i}))},291:function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var i=n(135),o=n(100),r=n(2);let a;function c(t){a=t}async function u(t){var e,n;if(Object(r.Q)())return o.f.importAndExecute(Object(i.a)());const c=a&&await a(void 0,t);if(c&&c.length>0){if("bearer"===(null===(e=null==c?void 0:c.split(" ")[0])||void 0===e?void 0:e.toLowerCase()))return c.split(" ")[1];if("msauth1.0"===(null===(n=null==c?void 0:c.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return c}}},313:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));const i={"fwk-betterDiagnostics-panel":{ring:["Dogfood"]},"fwk-betterDiagnostics-service":{ring:["Dogfood"]},"fwk-feedbackCharm":{ring:["Dogfood","Microsoft"]}}},326:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a}));const i=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function r(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function a(t){return i.test(t)}},376:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return r}));var i=n(218);function o(t){const e=[];if(Object(i.a)().sources.forEach(n=>{n.sourceId===t?e.push({source:n}):n.sharedSources&&n.sharedSources.sources.forEach(i=>{i.sourceId===t&&e.push({source:i,hostingSourceId:n.sourceId})})}),e.length>1)throw new Error("Duplicate account found");return e[0]}function r(t){var e;return null===(e=o(t))||void 0===e?void 0:e.source}},38:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(66);function o(){return i.a.userConfiguration}},380:function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,r){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var c=/\+/g;t=t.split(e);var u=1e3;r&&"number"==typeof r.maxKeys&&(u=r.maxKeys);var s=t.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var l,f,b,h,p=t[d].replace(c,"%20"),g=p.indexOf(n);g>=0?(l=p.substr(0,g),f=p.substr(g+1)):(l=p,f=""),b=decodeURIComponent(l),h=decodeURIComponent(f),i(a,b)?o(a[b])?a[b].push(h):a[b]=[a[b],h]:a[b]=h}return a};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},381:function(t,e,n){"use strict";var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,c){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(a(t),(function(a){var c=encodeURIComponent(i(a))+n;return o(t[a])?r(t[a],(function(t){return c+encodeURIComponent(i(t))})).join(e):c+encodeURIComponent(i(t[a]))})).join(e):c?encodeURIComponent(i(c))+n+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function r(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},382:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"JsonRequestHeaders:#Exchange"},t)}n.d(e,"a",(function(){return i}))},411:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(74);function o(t){return Object(i.a)(t,[i.c])}},467:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"ExtendedPropertyUri:#Exchange"},t)}n.d(e,"a",(function(){return i}))},47:function(t,e,n){"use strict";var i=n(91),o=n(3);var r=Object(o.action)("UPDATE_ACTIVE_FLIGHTS",t=>({featureOverrides:t}));function a(t){if(!t)return[];let e=[];return["addin","an","auth","cal","cmp","doc","eventify","fms","fwk","getstarted","grp","gsx","help","honeybee","inline","iris","lightning","lpc","mc","notes","nps","peo","people","mc","platform","playMyEmails","rp","sea","sxs","todo","tra","tri","sig","mon","usv","woven"].forEach(n=>{Object.keys(t[n]||{}).forEach(i=>{!0===t[n][i]&&e.push(`${n}-${i}`)})}),e}Object(o.mutator)(r,t=>{for(const e of t.featureOverrides)Object(i.a)().featureFlags.set(e.name.toLowerCase(),e.isEnabled)});var c=n(16),u=n(201);function s(t,e){if(Object(u.a)(t))e();else{let n=Object(c.autorun)(()=>{Object(u.a)(t)&&(e(),n())})}}var d=n(278),l=n(174);let f=Object(o.action)("setFeatureFlag<T>",(t,e)=>({feature:t,isOn:e}));Object(o.mutator)(f,(function(t){Object(i.a)().featureFlags.set(t.feature.toLowerCase(),t.isOn)})),Object(o.orchestrator)(f,(function(t){let e=t.feature,n=t.isOn;Object(l.c)([{name:e.toLowerCase(),isEnabled:n}])}));var b=f,h=n(137);function p(){const t=Object(h.a)();for(let e of Object(i.a)().featureFlags.keys())b(e,!!t[e]);Object(l.a)()}function g(){return Object.keys(Object(h.a)())}const m="fwk-uberflag",v="fwk-consumer",S="fwk-business";function O(){return C().includes(m)?1:0}function w(t){const e=C();return t&&e.includes(v)&&!e.includes(S)||!t&&e.includes(S)&&!e.includes(v)?1:0}let j;function C(){return j||(j=g().filter(t=>t===m||t===v||t===S)),j}function k(t){const e=Object(i.a)().featureFlags;return[...e.keys()].filter(n=>0==n.indexOf(t)&&e.get(n.toLowerCase()))}n.d(e,"d",(function(){return y})),n.d(e,"c",(function(){return a})),n.d(e,"h",(function(){return s})),n.d(e,"i",(function(){return d.b})),n.d(e,"j",(function(){return u.a})),n.d(e,"l",(function(){return b})),n.d(e,"k",(function(){return p})),n.d(e,"n",(function(){return l.c})),n.d(e,"m",(function(){return r})),n.d(e,"e",(function(){return g})),n.d(e,"a",(function(){return O})),n.d(e,"b",(function(){return w})),n.d(e,"f",(function(){return h.a})),n.d(e,"g",(function(){return k}));let y=Object(i.a)().featureFlags},477:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"TimeZoneDefinitionType:#Exchange"},t)}n.d(e,"a",(function(){return i}))},479:function(t,e,n){"use strict";function i(t){return Object.assign({__type:"TimeZoneContext:#Exchange"},t)}n.d(e,"a",(function(){return i}))},514:function(t,e,n){"use strict";var i,o,r,a;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return r})),n.d(e,"a",(function(){return a})),function(t){t[t.NotStarted=0]="NotStarted",t[t.Loading=1]="Loading",t[t.Loaded=2]="Loaded",t[t.Error=3]="Error"}(i||(i={})),function(t){t[t.AAD=0]="AAD",t[t.MSA=1]="MSA"}(o||(o={})),function(t){t.UserMailbox="UserMailbox",t.GroupMailbox="GroupMailbox",t.TeamsMailbox="TeamsMailbox",t.PublicMailbox="PublicMailbox",t.SharedMailbox="SharedMailbox",t.ArchiveMailbox="ArchiveMailbox"}(r||(r={})),function(t){t.Office365="Office365",t.OutlookDotCom="Outlook",t.Google="Google",t.ICloud="ICloud",t.Yahoo="Yahoo"}(a||(a={}))},610:function(t,e,n){"use strict";var i=n(411),o=n(32),r=n(74);function a(t){return Object(r.a)(t,[r.b])}var c=n(33),u=n(58);function s(t){return Object(c.b)(Object(c.c)(Object(c.a)(Object(u.a)()||"",t)))}var d=n(911),l=n(924),f=n(181);let b,h,p;function g(){return b||(b=Object(o.a)("/calendar")+"/"),b}function m(){return h||(h=Object(o.a)("/mail")+"/"),h}function v(){return p||(p=Object(o.a)("/files")+"/"),p}var S=n(929);let O,w,j;function C(t){return O&&w===t||(w=t,O=t?Object(o.a)("/people/group/owner")+"/":Object(o.a)("/people/group/member")+"/"),O}function k(){return j||(j=Object(o.a)("/people/group/deleted")+"/"),j}function y(t){return window.location.origin+g()+"showPeek/item/"+encodeURIComponent(t)}var I=n(935),T=n(5),R=n(716);const E=Object(I.a)().split("/").slice(1).join("/")+"deeplink/";function x(t,e,n,i){n&&((i=i||{}).minus="");let o="";if(i){const t=Object(T.d)();Object(R.a)(t),Object.keys(i).filter(t=>t).forEach(e=>t[e]=i[e]),o="?"+Object(T.i)(t)}return`${`/${t}/${E}`}${e}${o}`}var N=n(182),A=n(38);const D="https://to-do.microsoft.com";function _(t,e){var n,i;const o=Object(A.a)(),r=o.UserOptions,a=null===(n=o.SessionSettings)||void 0===n?void 0:n.UserPrincipalName;let c=D,u={};if(null===(i=null==r?void 0:r.ReactOptinSettings)||void 0===i?void 0:i.TasksRedirectUrl){let t="";[c,t]=r.ReactOptinSettings.TasksRedirectUrl.split("?"),u=Object(T.g)(t),a&&(u.auth_upn=a)}return t&&(u.utm_source=t),e&&delete u.fromOwa,Object.keys(u).length>0?Object(f.a)(c,u):c}let M;function F(){return M||(M=Object(o.a)("/eventify")+"?entryPoint=owa"),M}var L=n(135);let H;function U(){return H||(H=Object(o.a)("/host")+"/"),H}n(40);n.d(e,"k",(function(){return i.a})),n.d(e,"t",(function(){return o.a})),n.d(e,"g",(function(){return a})),n.d(e,"m",(function(){return s})),n.d(e,"s",(function(){return d.a})),n.d(e,"x",(function(){return c.a})),n.d(e,"a",(function(){return c.b})),n.d(e,"b",(function(){return c.c})),n.d(e,"o",(function(){return l.a})),n.d(e,"v",(function(){return f.a})),n.d(e,"e",(function(){return g})),n.d(e,"l",(function(){return m})),n.d(e,"h",(function(){return v})),n.d(e,"p",(function(){return S.a})),n.d(e,"j",(function(){return C})),n.d(e,"i",(function(){return k})),n.d(e,"d",(function(){return y})),n.d(e,"q",(function(){return x})),n.d(e,"w",(function(){return N.a})),n.d(e,"u",(function(){return _})),n.d(e,"f",(function(){return F})),n.d(e,"n",(function(){return L.a})),n.d(e,"r",(function(){return u.a})),n.d(e,"c",(function(){return U}))},66:function(t,e,n){"use strict";var i=n(3),o=n(16);const r={userConfiguration:{},connectedAccountsUserConfigurationMap:new o.ObservableMap({}),defaultFolderNameToIdMap:new o.ObservableMap({}),defaultFolderIdToNameMap:new o.ObservableMap({})},a=i.createStore("owaSessionStore",r)();e.a=a},716:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));const i=["hostApp","isanonymous","cspoff","frameName","opxInstanceId","hxVersion"];function o(t){t&&Object.keys(t).forEach(e=>{i.includes(e)&&delete t[e]})}},91:function(t,e,n){"use strict";var i=n(3);let o={featureFlags:new(n(16).ObservableMap)};e.a=Object(i.createStore)("featureFlags",o)},910:function(t,e,n){"use strict";var i=n(3);e.a=Object(i.action)("ON_SELECTED_ACCOUNT_CHANGED",(t,e,n)=>({selectedAccountSourceId:t,selectedEmailAddress:e,oldSourceId:n}))},911:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(5),o=n(716);function r(){const t=Object(i.d)();Object(o.a)(t);const e=Object(i.i)(t);return e.length>0?"?"+e:""}},924:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(40),o=n(32),r=n(135);function a(t){let e=Object(i.b)(),n=Object(r.a)()+Object(o.a)("/owa")+"/",a=e.search&&e.search.length>0;n+=a?e.search:"?";let c=Object.keys(t),u=a;for(let e=0;e<c.length;e++)u?n+="&":u=!0,n+=c[e]+"="+t[c[e]];return n}},929:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(32);let o;function r(){return o||(o=Object(i.a)("/people")+"/"),o}},935:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(58),o=n(32);function r(t){return(Object(o.a)("/"+(t||Object(i.a)()))+"/").replace(/^\//,"")}},968:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(218),o=n(376);function r(){return Object(o.a)(Object(i.a)().selectedSourceId)}}}]);
//# sourceMappingURL=owa.543.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.543.js'] = 1;