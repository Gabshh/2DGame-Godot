(window.$wj=window.$wj||[]).push([[110],{1763:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(3),o=r(16);const i=Object(n.createStore)("groupsStore",{groups:new o.ObservableMap})},1809:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(1763);function o(t){const e=Object(n.a)().groups.get(t.toLowerCase());return e?e.groupDetails:null}},1832:function(t,e,r){"use strict";var n;!function(t){t[t.None=0]="None",t[t.Executing=1]="Executing",t[t.Succeed=2]="Succeed",t[t.FailureNotice=3]="FailureNotice",t[t.FailureRetry=4]="FailureRetry"}(n||(n={})),e.a=n},1843:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(3),o=r(1903);const i=Object(n.createStore)("unifiedGroupsSettingsStore",{supportedClassifications:[],defaultClassification:"",namingPolicySettings:{},groupsGuidelinesLink:"",orgAllowAddGuests:!1,defaultGroupAccessType:o.a.Private,groupCreationEnabled:!1,isSensitivityLabelsEnabled:!1})},1896:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(3),o=r(16);const i=Object(n.createStore)("getGroupSiteStatusStore",{groupSiteStatus:new o.ObservableMap})},1903:function(t,e,r){"use strict";var n;r.d(e,"a",(function(){return n})),function(t){t[t.Private=0]="Private",t[t.Public=1]="Public"}(n||(n={}))},1913:function(t,e,r){"use strict";var n=r(3),o=r(16);Object(n.createStore)("personaPhotoStore",{personaPhotoUrls:new o.ObservableMap})();r(2115),r(1903);var i=r(1763),u=r(1843),a=r(1809);function s(t){const e=Object(i.a)().groups.get(t.toLowerCase());return!!e&&!e.groupDetailsError}var c=r(1960),d=r(2219),l=r(1896);const p=Object(n.mutatorAction)("updateGroupSiteAndDocumentUrl",(function(t,e,r,n){if(2==e){const e=Object(a.a)(t);Object(c.a)(e,"Site")[0].Url=r,Object(c.a)(e,"Files")[0].Url=n}}));var f=r(2135);function b(t){return t=t.toLocaleLowerCase(),Object(l.a)().groupSiteStatus.has(t)?Object(l.a)().groupSiteStatus.get(t):0}const g=t=>{const e="string"==typeof t?Object(a.a)(t):t;return e?e.ExternalDirectoryObjectId:null};r(1832),r(2106),r(2080),r(2116),r(2107);var h=r(2600),m=r(2601),v=r(2644),O=r(2602),j=r(2603),C=r(6);function N(t){const e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(C.b)(O.a);if(3===e)return Object(C.b)(j.a)}return""}function S(t){const e=t.groupDetails?t.groupDetails.AccessType:t.basicInformation?t.basicInformation.AccessType:null;if(e){if(1===e)return Object(C.b)(v.b);if(3===e)return Object(C.b)(v.c)}return""}function w(t){let e=0;return t.members?e=t.members.totalCount:t.groupDetails&&(e=t.groupDetails.MemberCount),e?e>1?Object(C.c)(Object(C.b)(m.a),e.toString()):Object(C.c)(Object(C.b)(h.a),e.toString()):Object(C.b)(v.a)}r.d(e,"j",(function(){return i.a})),r.d(e,"l",(function(){return u.a})),r.d(e,"d",(function(){return a.a})),r.d(e,"m",(function(){return s})),r.d(e,"f",(function(){return c.a})),r.d(e,"g",(function(){return c.b})),r.d(e,"c",(function(){return d.a})),r.d(e,"i",(function(){return l.a})),r.d(e,"o",(function(){return p})),r.d(e,"n",(function(){return f.b})),r.d(e,"h",(function(){return b})),r.d(e,"e",(function(){return g})),r.d(e,"a",(function(){return N})),r.d(e,"b",(function(){return S})),r.d(e,"k",(function(){return w}))},1954:function(t,e,r){"use strict";var n,o;let i,u,a,s,c,d,l,p;var f;let b,g;let h,m;var v;r(6),r(487);function O(t,e){e,v=t}function j(){return v}r.d(e,"o",(function(){return n})),r.d(e,"n",(function(){return o})),r.d(e,"c",(function(){return i})),r.d(e,"a",(function(){return u})),r.d(e,"b",(function(){return a})),r.d(e,"g",(function(){return s})),r.d(e,"d",(function(){return c})),r.d(e,"f",(function(){return d})),r.d(e,"l",(function(){return l})),r.d(e,"m",(function(){return p})),r.d(e,"q",(function(){return f})),r.d(e,"r",(function(){return b})),r.d(e,"h",(function(){return g})),r.d(e,"j",(function(){return h})),r.d(e,"e",(function(){return m})),r.d(e,"p",(function(){})),r.d(e,"k",(function(){return O})),r.d(e,"i",(function(){return j}))},1960:function(t,e,r){"use strict";r.d(e,"a",(function(){return o})),r.d(e,"b",(function(){return i}));var n=r(1809);const o=(t,e)=>{const r="string"==typeof t?Object(n.a)(t):t;if(!r||!r.GroupResources)return null;const o=r.GroupResources.filter(t=>t.Name===e);return!o||o.length<1?null:o},i=(t,e)=>{const r=o(t,e);return r&&0!=r.length?r[0].Url:null}},2080:function(t,e,r){"use strict";var n=r(3),o=r(2251);const i=Object(n.mutatorAction)("setJoinButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},2106:function(t,e,r){"use strict";var n=r(3),o=r(2250);const i=Object(n.mutatorAction)("setFollowButtonState",(function(t,e){o.a.groupActionState.set(t.toLowerCase(),e)}));e.a=i},2107:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(1832),o=r(2251);function i(t){t=t.toLowerCase();const e=o.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},2115:function(t,e,r){"use strict";r.d(e,"b",(function(){return u})),r.d(e,"a",(function(){return a}));var n=r(47),o=r(1843),i=r(57);function u(){return(Object(n.j)("grp-shareable-crud")||Object(o.a)().isSensitivityLabelsEnabled)&&!Object(i.r)()}function a(){return Object(n.j)("grp-shareable-crud-smtpEdit")&&Object(n.j)("grp-cardReloadAfterEditingSmtp")}},2116:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(1832),o=r(2250);function i(t){t=t.toLowerCase();const e=o.a.groupActionState;return e.has(t)?e.get(t):n.a.None}},2135:function(t,e,r){"use strict";r.d(e,"b",(function(){return i}));var n=r(3),o=r(1896);const i=Object(n.mutatorAction)("setGroupSiteStatus",(function(t,e){t=t.toLocaleLowerCase(),Object(o.a)().groupSiteStatus.has(t)&&e==Object(o.a)().groupSiteStatus.get(t)||Object(o.a)().groupSiteStatus.set(t,e)}));e.a=i},2219:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(2017);const o=()=>Object(n.a)().smtpAddress},2250:function(t,e,r){"use strict";var n=r(3),o=r(16);e.a=Object(n.createStore)("followButtonStore",{groupActionState:new o.ObservableMap})()},2251:function(t,e,r){"use strict";var n=r(3),o=r(16);e.a=Object(n.createStore)("joinButtonStore",{groupActionState:new o.ObservableMap})()},2600:function(t){t.exports=JSON.parse('{"a":"L8a"}')},2601:function(t){t.exports=JSON.parse('{"a":"R8a"}')},2602:function(t){t.exports=JSON.parse('{"a":"N8a"}')},2603:function(t){t.exports=JSON.parse('{"a":"M8a"}')},2644:function(t){t.exports=JSON.parse('{"b":"O8a","c":"P8a","a":"Q8a"}')},3647:function(t,e,r){"use strict";var n=r(2158),o=r(3),i=Object(o.mutatorAction)("toggleIsShowingAllGroups",(function(){Object(n.b)().shouldShowAllGroups=!Object(n.b)().shouldShowAllGroups})),u=r(23),a=r(1746),s=r(614),c=r(71),Droppable=r(1840),d=r(908),l=r(1913),p=r(6),f=r(2515),b=r(0),g=r(4134),h=r(4359),m=r(1),v=r(205),O=r(906),j=r(1742),C=r(1721),N=r(47),S=r(4227),w=r(4639);let I=class extends b.Component{constructor(){super(...arguments),this.onContextMenu=(t,e)=>{const{onContextMenu:r,groupId:n}=this.props;if(r){t.stopPropagation(),t.preventDefault();const e=n.toLowerCase(),o=Object(l.j)().groups;if(o.has(e)){r(t,o.get(e))}}},this.onDrop=t=>{this.props.onListNodeDrop&&this.props.onListNodeDrop(t,this.props.groupId)},this.renderGroupFolderChildren=()=>this.props.renderGroupFolderChildren?this.props.renderGroupFolderChildren(this.props.groupId):null,this.getChevronProps=()=>{if(this.props.groupListNodeChevronProps)return this.props.groupListNodeChevronProps(this.props.groupId)}}shouldComponentUpdate(t,e){return!Object(v.e)(this.props,t)}render(){const t=Object(S.a)(this.props.groupId);return b.createElement(Droppable.b,{dropViewState:t.drop,onDrop:this.onDrop,canDrop:this.props.canDropOnListNode},b.createElement(w.a,{selectGroup:this.props.selectGroup,isSelected:this.props.isSelected,renderRightCharm:this.props.renderRightCharm,renderRightCharmHover:this.props.renderRightCharmHover,chevronProps:Object(N.j)("grp-loadFolders")?this.getChevronProps():null,customIcon:Object(N.j)("grp-groupsIconChange-leftNav")||Object(N.j)("grp-loadFolders")?"Group":null,displayName:this.props.displayName,groupId:this.props.groupId,isDroppedOver:t.drop.isDragOver,onContextMenu:this.onContextMenu,renderCustomTreeNodeDisplay:null,customData:this.props.customData,showHoverStateOnDroppedOver:t.drop.draggableItemType==j.a.MailListRow||t.drop.draggableItemType==j.a.MultiMailListMessageRows,isFavorited:Object(s.b)()&&Object(C.isGroupInFavorites)(this.props.groupId)}),Object(N.j)("grp-loadFolders")&&this.renderGroupFolderChildren())}};I=Object(m.__decorate)([O.observer],I);var k=I;const y=Object(l.j)(),G=Object(n.b)();var D=Object(u.a)((function(t){var e,r,o;const u=b.useRef(!1),l=e=>b.createElement(k,{selectGroup:t.selectGroup,isSelected:t.isSelected,renderRightCharm:t.renderRightCharm,renderRightCharmHover:t.renderRightCharmHover,displayName:e.DisplayName,groupId:e.SmtpAddress,key:e.SmtpAddress,onContextMenu:t.onChildNodeContextMenuOpened,customData:t.customData,onListNodeDrop:t.onListNodeDrop,canDropOnListNode:t.canDropOnListNode,renderGroupFolderChildren:t.renderGroupFolderChildren,groupListNodeChevronProps:t.groupListNodeChevronProps}),m=e=>{e.stopPropagation(),t.toggleGroupTreeExpansion()},v=!Object(s.b)(),O=e=>{const{onRootNodeContextMenuOpened:r}=t;r&&(e.stopPropagation(),e.preventDefault(),r(e))},j=e=>!(G.shouldShowAllGroups||!t.canDropOnListNode)&&t.canDropOnListNode(e),C=t=>{u.current=!0,setTimeout(()=>{u.current&&!Object(n.b)().shouldShowAllGroups&&w()},1e3)},N=()=>{u.current=!1},S=t=>{t.stopPropagation(),w()},w=()=>{const e=G.myOrgGroups.length;Object(c.o)("GroupList_ToggleShouldShowAllGroups",{isShowMore:!G.shouldShowAllGroups,joinedGroupCount:e>=21?"21+":e}),t.onShowMoreEvent&&t.onShowMoreEvent(),i()},I=G.myOrgGroups,D={role:a.a.tree},A=t.isGroupsTreeCollapsed;return b.createElement("div",Object.assign({style:t.style,className:t.className},Object(a.b)(D)),(e=>{const r={isExpanded:!e,onClick:m};return b.createElement(f.a,{chevronProps:r,depth:0,displayName:Object(p.b)(h.a),isRootNode:v,key:"Groups_root",onClick:r.onClick,onContextMenu:O,renderRightCharm:t.renderRootNodeRightCharm,renderRightCharmHover:t.renderRootNodeRightCharmHover,setSize:t.setSize,positionInSet:t.positionInSet})})(A),((t,e)=>{const r=[];if(e)return r;if(G.shouldShowAllGroups){const e=[];t.forEach(t=>{const r=y.groups.get(t);e.push(r)}),e.sort((t,e)=>t.basicInformation.DisplayName.localeCompare(e.basicInformation.DisplayName)).forEach(t=>{r.push(l(t.basicInformation))})}else t.slice(0,g.a).forEach(t=>{const e=y.groups.get(t);r.push(l(e.basicInformation))});return r})(I,A),G.withContextMenuGroup&&(G.withContextMenuGroup.isRootNode?null===(e=t.renderRootNodeContextMenu)||void 0===e?void 0:e.call(t,G.withContextMenuGroup):null===(r=t.renderChildNodeContextMenu)||void 0===r?void 0:r.call(t,G.withContextMenuGroup)),I.length>g.a&&(e=>{if(e)return null;const r=G.shouldShowAllGroups?Object(p.b)(h.b):Object(p.b)(h.c),n=Object(d.a)();return b.createElement(Droppable.b,{dropViewState:n,onDrop:E,canDrop:j,onDragOver:C,onDragLeave:N},b.createElement(f.a,{displayName:r,isCustomActionNode:!0,isRootNode:!1,key:"groupsCollapseExpandNode",onClick:S,onContextMenu:L,onMouseEnter:t.onMouseEnterShowMoreButton}))})(A),null===(o=t.renderGroupListCustomNodes)||void 0===o?void 0:o.call(t))}));function E(){}function L(t){t.stopPropagation(),t.preventDefault()}r.d(e,"c",(function(){return n.a})),r.d(e,"b",(function(){return n.b})),r.d(e,"a",(function(){return D}))},4134:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return o}));const n=5,o=100},4207:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(702),o=r(2145);let i=Object(n.action)("updateGroupFolderHierarchy")((function(t,e){var r;const n=function(t){return{__type:"GroupFolder",OdataId:t.OdataId,Id:t.FolderId,ParentFolderId:t.ParentFolderId,DisplayName:t.DisplayName,UnreadItemCount:t.UnreadItemCount,TotalItemCount:t.TotalItemCount,ChildFolderCount:t.ChildFolderCount,WellKnownName:t.WellKnownName,IsHidden:t.IsHidden,SizeInBytes:t.SizeInBytes,ChildFolderIds:[]}}(e),i=null===(r=Object(o.n)().folderTable.get(t.toLowerCase()))||void 0===r?void 0:r.folderHierarchy,u=n.ParentFolderId;if(i){if(i.has(n.Id))return;for(const t of i.values())t.ParentFolderId===n.Id&&n.ChildFolderIds.push(t.Id);if(i.set(e.FolderId,n),i.has(u)){const t=i.get(u);t&&t.ChildFolderIds.push(n.Id)}}}))},4208:function(t,e,r){"use strict";var n=r(702),o=r(2145);e.a=Object(n.action)("setGroupFolderViewState")((function(t,e,r){var n;null===(n=Object(o.l)().groupListNodesViewStates.get(t.toLowerCase()))||void 0===n||n.groupFolderNodeViewStates.set(e,r)}))},4227:function(t,e,r){"use strict";var n=r(2158),o=r(2042),i=r(908),u=r(3),a=Object(u.mutatorAction)("setGroupNodeViewStateMutator",(function(t,e){Object(n.b)().groupNodeViewStates.set(t,e)}));function s(t){return Object(n.b)().groupNodeViewStates.has(t)||a(t,{drag:Object(o.a)(),drop:Object(i.a)(),isDroppingMessage:!1}),Object(n.b)().groupNodeViewStates.get(t)}r.d(e,"a",(function(){return s}))},4276:function(t,e,r){"use strict";var n=r(3),o=r(2145);e.a=Object(n.mutatorAction)("setGroupFolderViewExpanded",(function(t,e){t=t.toLowerCase();const r=Object(o.l)().groupListNodesViewStates.get(t);if(r){r.isExpanded=!0;const t=r.groupFolderNodeViewStates.get(e);t&&(t.isExpanded=!0)}}))},4277:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=r(3);const o=Object(n.action)("SET_LOADING_STATE_FOR_GROUP_FOLDER_TREE",(t,e)=>({groupId:t,loadingState:e}))},4278:function(t,e,r){"use strict";var n=r(702),o=r(2145);e.a=Object(n.action)("setGroupListNodeViewState")((function(t,e){Object(o.l)().groupListNodesViewStates.set(t.toLowerCase(),e)}))},4359:function(t){t.exports=JSON.parse('{"a":"S8a","b":"T8a","c":"U8a"}')},4396:function(t,e,r){"use strict";var n=r(20),o=r(702),i=r(2145),u=Object(o.action)("toggleGroupFolderNodeExpansion")((function(t,e){var r;const n=null===(r=Object(i.l)().groupListNodesViewStates.get(t.toLowerCase()))||void 0===r?void 0:r.groupFolderNodeViewStates.get(e);n&&(n.isExpanded=!n.isExpanded)})),a=r(4276),s=r(4277),c=r(4207),d=r(4208),l=r(4278);r.d(e,"c",(function(){return f})),r.d(e,"e",(function(){return b})),r.d(e,"a",(function(){return g})),r.d(e,"b",(function(){return h})),r.d(e,"d",(function(){return m})),r.d(e,"j",(function(){return u})),r.d(e,"f",(function(){return a.a})),r.d(e,"i",(function(){return s.a})),r.d(e,"k",(function(){return c.a})),r.d(e,"g",(function(){return d.a})),r.d(e,"h",(function(){return l.a}));const p=new n.c(()=>Promise.all([r.e(0),r.e(748)]).then(r.bind(null,19590)));let f=new n.a(p,t=>t.loadGroupFolders),b=new n.a(p,t=>t.toggleGroupListNodeExpansion);const g=new n.a(p,t=>t.createNewGroupFolder),h=new n.a(p,t=>t.deleteGroupFolder),m=new n.a(p,t=>t.renameGroupFolder);new n.a(p,t=>t.moveGroupFolder)},4788:function(t,e,r){"use strict";function n(t){return Object.assign({__type:"SubscriptionParameters:#Exchange"},t)}r.d(e,"a",(function(){return n}))},487:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return u}));const n="en",o={en:{dir:"ltr"},af:{dir:"ltr"},am:{dir:"ltr"},ar:{dir:"rtl"},"as-IN":{dir:"ltr"},"az-Latn-AZ":{dir:"ltr"},bg:{dir:"ltr"},"bn-IN":{dir:"ltr"},"bs-Latn-BA":{dir:"ltr"},ca:{dir:"ltr"},"ca-Es-VALENCIA":{dir:"ltr"},cs:{dir:"ltr"},cy:{dir:"ltr"},da:{dir:"ltr"},de:{dir:"ltr"},el:{dir:"ltr"},"en-GB":{dir:"ltr"},es:{dir:"ltr"},"es-MX":{dir:"ltr"},et:{dir:"ltr"},eu:{dir:"ltr"},fa:{dir:"rtl"},fi:{dir:"ltr"},fil:{dir:"ltr"},fr:{dir:"ltr"},"fr-CA":{dir:"ltr"},"ga-IE":{dir:"ltr"},"gd-gb":{dir:"ltr"},gl:{dir:"ltr"},gu:{dir:"ltr"},he:{dir:"rtl"},hi:{dir:"ltr"},hr:{dir:"ltr"},hu:{dir:"ltr"},hy:{dir:"ltr"},id:{dir:"ltr"},is:{dir:"ltr"},it:{dir:"ltr"},ja:{dir:"ltr"},ka:{dir:"ltr"},kk:{dir:"ltr"},"km-KH":{dir:"ltr"},kn:{dir:"ltr"},ko:{dir:"ltr"},kok:{dir:"ltr"},"lb-LU":{dir:"ltr"},"lo-LA":{dir:"ltr"},lt:{dir:"ltr"},lv:{dir:"ltr"},"mi-NZ":{dir:"ltr"},mk:{dir:"ltr"},ml:{dir:"ltr"},mr:{dir:"ltr"},ms:{dir:"ltr"},"mt-MT":{dir:"ltr"},"ne-NP":{dir:"ltr"},nl:{dir:"ltr"},"nn-NO":{dir:"ltr"},no:{dir:"ltr"},or:{dir:"ltr"},"pa-IN":{dir:"ltr"},pl:{dir:"ltr"},pt:{dir:"ltr"},"pt-PT":{dir:"ltr"},"quz-PE":{dir:"ltr"},ro:{dir:"ltr"},ru:{dir:"ltr"},sk:{dir:"ltr"},sl:{dir:"ltr"},sq:{dir:"ltr"},sr:{dir:"ltr"},"sr-Cyrl":{dir:"ltr"},"sr-Cyrl-BA":{dir:"ltr"},sv:{dir:"ltr"},ta:{dir:"ltr"},te:{dir:"ltr"},th:{dir:"ltr"},tr:{dir:"ltr"},tt:{dir:"ltr"},"ug-CN":{dir:"rtl"},uk:{dir:"ltr"},ur:{dir:"rtl"},uz:{dir:"ltr"},vi:{dir:"ltr"},"zh-Hans":{dir:"ltr"},"zh-Hant":{dir:"ltr"}},i={"en-us":"en","nb-no":"no","ne-ne":"ne-NP","quz-bo":"quz-PE","quz-ec":"quz-PE","zh-cn":"zh-Hans","zh-hk":"zh-Hant","zh-mo":"zh-Hant","zh-sg":"zh-Hans","zh-tw":"zh-Hant"};function u(t){let e=t.toLowerCase().split("-");for(;e.length>0;){let t=e.join("-"),r=i[t];if(r)return s(r);for(const e of Object.keys(o))if(a(e,t))return s(e);e.pop()}return Object.assign(Object.assign({},s(n)),{localeNotFound:!0})}function a(t,e){try{return!t.localeCompare(e,[],{sensitivity:"base"})}catch(t){return!1}}function s(t){return Object.assign({locale:t},o[t])}},5318:function(t,e,r){"use strict";r.d(e,"a",(function(){return i})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return a}));var n=r(20);const o=new n.c(()=>r.e(1147).then(r.bind(null,10016)));let i=new n.b(o,t=>t.addMarkAsReadDiagnostics),u=new n.b(o,t=>t.addUnreadCountNotificationDiagnostics),a=new n.b(o,t=>t.addUnreadCountSubscriptionDiagnostics)},6602:function(t,e,r){"use strict";var n=r(71),o=r(2),i=r(567),u=r(36);const a=10;function s(t,e,r){let s,c=0;const d={next:t=>{var r;return null===(r=e.next)||void 0===r?void 0:r.call(e,t)},complete:()=>{var t;return null===(t=e.complete)||void 0===t?void 0:t.call(e)},error:l=>{var p;Object(n.o)("GraphqlSubscriptionError",{owa_1:r,owa_2:Object(o.U)(null==l?void 0:l.toString()),owa_3:Object(o.U)(null==l?void 0:l.stack),owa_4:c},{isCore:!0}),Object(i.isApolloError)(l)&&(c++<a?(null==s||s.unsubscribe(),s=t().subscribe(d)):Object(u.d)(`${r}: too many apollo errors`)),null===(p=e.error)||void 0===p||p.call(e,l)}};return s=t().subscribe(d),{closed:!s||s.closed,unsubscribe:()=>null==s?void 0:s.unsubscribe()}}r.d(e,"a",(function(){return s}))},7560:function(t,e,r){"use strict";var n=r(3),o=r(1763);e.a=Object(n.mutatorAction)("UPDATE_GROUP_UNREAD_COUNT",(function(t,e){let r=Object(o.a)().groups.get(t.toLowerCase());r&&(r.unreadMessageCount=e)}))},8541:function(t,e,r){"use strict";var n=r(705);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToUnreadCountNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToUnreadCountNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxSmtpAddress"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxSmtpAddress"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"EventType"}},{kind:"Field",name:{kind:"Name",value:"NotificationId"}},{kind:"Field",name:{kind:"Name",value:"UnreadCount"}},{kind:"Field",name:{kind:"Name",value:"BrokerSubscriptionId"}}]}}]}}]};var i=r(7560),u=r(5318);var a=r(36),s=r(1761),c=r(4788),d=r(71),l=r(47),p=r(6602);r.d(e,"a",(function(){return g})),r.d(e,"b",(function(){return h}));const f={},b={};async function g(t){const e=(await s.b.import())(),r=Object(c.a)({NotificationType:"UnreadCountNotification",ChannelId:e,MailboxId:t}),g={subscriptionId:m(t),requiresExplicitSubscribe:!0,subscriptionParameters:r};if(function(t){return!f[t]}(t)){const e=Object(n.a)(),r=()=>e.subscribe({query:o,variables:{subscriptionId:m(t),mailboxSmtpAddress:t}}),s={notificationSubscription:g,firstNotificationReceived:!1,unreadCountDataPoint:new d.b("UnreadCountNotification",{logEvery:Object(l.j)("ring-dogfood")?1:20})};f[t]=s,u.c.import().then(e=>e(t,g,!1));const c=Object(p.a)(r,{next:t=>(function(t,e){if("QueryResultChanged"===t.EventType){const r=t.id.replace("UnreadCountNotification_","");Object(i.a)(r.toLowerCase(),t.UnreadCount),e&&(e.firstNotificationReceived||(e.unreadCountDataPoint.end(),e.unreadCountDataPoint=null,e.firstNotificationReceived=!0)),u.b.import().then(e=>e(r,t))}})(t.data.subscribeToUnreadCountNotifications,f[function(t){return t.replace("UnreadCountNotification_","")}(t.data.subscribeToUnreadCountNotifications.id)]),error:t=>{a.h.info(`unread count notification error ${t}`)}},"GroupUnreadCountNotifications");return b[t]=c,c}return b[t]}function h(t){t=t.toLowerCase();const e=b[t];if(e){const r=f[t];e.unsubscribe(),delete b[t],delete f[t],u.c.import().then(e=>e(t,r.notificationSubscription,!0))}}function m(t){return"UnreadCountNotification_"+t}},9796:function(t,e,r){"use strict";r.d(e,"b",(function(){return g})),r.d(e,"a",(function(){return h})),r.d(e,"c",(function(){return v}));var n=r(5318),o=r(4788),i=r(1761),u=r(71),a=r(1721),s=r(47),c=r(3647),d=r(4134),l=r(7560),p=r(8541);const f={};function b(t){const e=t.id.replace("UnreadCountNotification_","");if(n.b.import().then(r=>r(e,t)),"0"==t.EventType.toString()){const r=f[e];r&&(Object(l.a)(e.toLowerCase(),t.UnreadCount),r.firstNotificationReceived||(r.unreadCountDataPoint.end(),r.unreadCountDataPoint=null,r.firstNotificationReceived=!0))}}function g(){Object(s.j)("grp-unreadCountTop5AndFavorites")?Object(s.j)("grp-groupunreadcountnotification-gql")?c.c.myOrgGroups.filter((t,e)=>e<d.a||Object(a.isGroupInFavorites)(t)).forEach(t=>{Object(p.a)(t)}):c.c.myOrgGroups.filter((t,e)=>e<d.a||Object(a.isGroupInFavorites)(t)).forEach(t=>{m(t)}):h()}function h(){c.c.myOrgGroups.forEach(t=>{m(t)})}function m(t){(function(t){return!f[t]})(t=t.toLowerCase())&&i.b.import().then(e=>{const r=Object(o.a)({NotificationType:"UnreadCountNotification",ChannelId:e(),MailboxId:t}),a={subscriptionId:O(t),requiresExplicitSubscribe:!0,subscriptionParameters:r};i.j.importAndExecute(a,b);const c={notificationSubscription:a,firstNotificationReceived:!1,unreadCountDataPoint:new u.b("UnreadCountNotification",{logEvery:Object(s.j)("ring-dogfood")?1:20})};f[t]=c,n.c.import().then(e=>e(t,a,!1))})}function v(t){t=t.toLowerCase();const e=f[t];if(e){const r=e.notificationSubscription;r&&(i.k.importAndExecute(r,b),delete f[t],n.c.import().then(e=>e(t,r,!0)))}}function O(t){return"UnreadCountNotification_"+t}}}]);
//# sourceMappingURL=owa.110.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.110.js'] = 1;