(window.$wj=window.$wj||[]).push([[638],{1057:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("setFirstRenderCompleted",e=>({tabId:e}))},1761:function(e,t,n){"use strict";var i=n(20);var a={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};n.d(t,"j",(function(){return r})),n.d(t,"k",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"a",(function(){return a}));const o=new i.c(()=>Promise.all([n.e(0),n.e(543)]).then(n.bind(null,19504))),r=new i.a(o,e=>e.subscribe),d=new i.a(o,e=>e.unsubscribe),c=new i.b(o,e=>e.getChannelId),l=new i.a(o,e=>e.getChannelReady),s=new i.a(o,e=>e.retryDisconnectionWithMinimumReconnectInterval),u=new i.a(o,e=>e.setup),b=new i.a(o,e=>e.handleNotification),f=new i.a(o,e=>e.NotificationManager.stopConnection),m=new i.a(o,e=>e.initializeNotificationManager),p=new i.b(o,e=>e.getNotificationEmitter)},1902:function(e,t,n){"use strict";n.d(t,"b",(function(){return d}));var i=n(16),a=n(1937),o=n(3);const r={loadedItemReadingPaneViewStates:new i.ObservableMap({}),loadedConversationReadingPaneViewStates:new i.ObservableMap({}),itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null,loadingProjectionIds:[]};let d=Object(o.createStore)("readingpane",r);const c=d();a.a.registerReference(()=>[...c.loadedConversationReadingPaneViewStates.keys()]),t.a=c},19589:function(e,t,n){"use strict";n.r(t);var i=n(8871),a=n(7),o=n(3290),r=n(7411),d=n(3179),c=n(1675),l=n(702),s=Object(l.action)("updateRollupOnAddOrUpdateRowNotification")((function(e){const t=Object(c.I)();if(null==t)return;const n=Object(c.n)(e),i=Object(c.n)(t);(0==n&&1==i||1==n&&0==i)&&Object(d.b)(e.tableQuery)})),u=n(2128),b=n(2397),f=n(3812),m=n(9790),p=n(1692),y=n(47),v=n(3001);var k=Object(l.action)("rowNotificationHandler.onAddOrUpdateRow")((function(e,t){const n=e.InstanceKey;if(!n)throw new Error("onAddOrUpdateNotification: Row instanceKey should not be null");if(!Object(u.k)(e,t))return;const{lastDeliveryOrRenewTimeStamp:d,lastDeliveryTimeStamp:l}=Object(u.e)(e,t.tableQuery.listViewType);let k=Object(m.b)(d,l,t,0,n);const O=Object(i.a)(n,t),w=O>=0;-1!=k?Object(c.V)(t.tableQuery.folderId)&&Object(a.Hb)(Object(a.qc)(l),c.Z.inboxPausedDateTime)||(!function(e,t){if(Object(y.j)("tri-spotlight2")){let n;if(1===t.tableQuery.listViewType){const i=c.b.getRowClientItemId(e.InstanceKey,t),a=p.u.items.get(null==i?void 0:i.Id);n=null==a?void 0:a.SpotlightIsVisible}else{const i=Object(c.M)(e.InstanceKey,t.id);n=null==i?void 0:i.spotlightIsVisible}(e.SpotlightIsVisible&&!n||!e.SpotlightIsVisible&&n)&&v.c.importAndExecute()}}(e,t),w?(O<k&&k--,function(e,t,n){Object(u.g)(e,t)?(b.a.updateRowData(e,t),Object(c.bb)(t,4)):(b.a.updateRow(n,e,t,"RowUpdateNotification"),Object(c.bb)(t,2)),Object(r.a)(e.InstanceKey,t)}(e,t,k)):function(e,t,n){b.a.addRow(n,e,t,"RowAddNotification"),Object(c.bb)(t,1),t.currentLoadedIndex++}(e,t,k),f.d.importAndExecute(n,t,!0),-1!=Object(c.n)(t)&&s(t),Object(u.d)(t)):w&&Object(o.a)([n],t,"UpdateNotification")})),O=n(6603),w=n(3),j=Object(w.action)("TRY_REMOVE_ITEM_NORMALIZED_BODY",e=>({item:e})),I=n(1967),N=n(1937),T=n(2779),h=n(1683),S=n(71),g=n(36),R=n(1698);let V=Object(l.action)("handleRowNotification")((function(e,t={tableView:h.a.tableViews.get(e.id)}){Object(y.j)("auth-signalrChannelLogging")&&Object(S.o)("SignalRNotification",{NotificationType:e.id,EventType:e.EventType});const n=t.tableView;if(!n)return void g.h.info("Received row notification for a deleted folder");if(!n.isInitialLoadComplete)return void g.h.info("Ignore row notifications as table has not loaded");let i;switch(e.EventType){case"RowAdded":i=C(e,n),F(i,n),"inbox"==Object(R.a)(n.tableQuery.folderId)&&Object(S.o)("SubscribeRowNotification_RowAddedNotification");break;case"RowModified":i=C(e,n),P(i,n);break;case"RowDeleted":i=C(e,n),D(i,n);break;case"QueryResultChanged":case"Reload":E(n);break;default:return}}));function C(e,t){switch(t.tableQuery.listViewType){case 0:return e.Conversation?e.Conversation:(g.d("Conversation should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);case 1:return e.Item?e.Item:(g.d("Item should not be undefined or empty in notification payload."+e.EventType+", "+e.id),null);default:return g.d("rowNotificationStrategy: unsupported listViewType: "+t.tableQuery.listViewType),null}}let F=Object(l.action)("rowNotificationHandler.onAddRow")((function(e,t){Object(c.V)(t.tableQuery.folderId)||t.totalRowsInView++,k(e,t)})),P=Object(l.action)("rowNotificationHandler.onUpdateRow")((function(e,t){k(e,t)})),D=Object(l.action)("rowNotificationHandler.onDeleteRow")((function(e,t){const n=e.InstanceKey;if(!n)throw new Error("onDeleteNotification: Row instanceKey should not be null");t.totalRowsInView--,Object(u.j)(e,t)&&Object(i.a)(n,t)>=0&&(Object(o.a)([n],t,"DeleteNotification"),Object(c.bb)(t,3))})),E=Object(l.action)("rowNotificationHandler.onReload")((function(e,t={conversations:N.a,items:p.u.items}){!function(e,t){switch(e.tableQuery.listViewType){case 0:t.conversations.clear();const n=t.conversations.getItemIds();for(let i=0,a=n.length;i<a;i++){const a=n[i];if(t.conversations.has(a)){const n=t.conversations.get(a);f.c.importAndExecute(n.conversationId,e)}}break;case 1:for(const n of e.rowKeys){const i=c.b.getRowClientItemId(n,e),a=t.items.get(i.Id);j(a),t.items.get(i.Id).NormalizedBody&&f.c.importAndExecute(i,e)}}}(e,t),Object(O.a)(e),I.a.clearMapForFolder(e.serverFolderId)}));Object(w.mutator)(j,e=>{const t=e.item;Object(T.d)(t.ConversationId.Id,0)||Object(T.e)(t.ItemId.Id,0)||(t.NormalizedBody=void 0)});var A=n(1681),Q=n(2595),x=n(1701),M=n(2699);var _=n(3442),L=n(1761),B=n(3583),U=n(3660);const K={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"subscribeToRowNotifications"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"folderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"listViewType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ReactListViewType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TableQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"categoryName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"FocusedViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ViewFilter"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"sortBy"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"SortByInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"shapeName"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"subscribeToRowNotifications"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"subscriptionId"},value:{kind:"Variable",name:{kind:"Name",value:"subscriptionId"}}},{kind:"ObjectField",name:{kind:"Name",value:"listViewType"},value:{kind:"Variable",name:{kind:"Name",value:"listViewType"}}},{kind:"ObjectField",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"ObjectField",name:{kind:"Name",value:"categoryName"},value:{kind:"Variable",name:{kind:"Name",value:"categoryName"}}},{kind:"ObjectField",name:{kind:"Name",value:"focusedViewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"focusedViewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"viewFilter"},value:{kind:"Variable",name:{kind:"Name",value:"viewFilter"}}},{kind:"ObjectField",name:{kind:"Name",value:"commonRowsOptions"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"folderId"},value:{kind:"Variable",name:{kind:"Name",value:"folderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"sortBy"},value:{kind:"Variable",name:{kind:"Name",value:"sortBy"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}]}},{kind:"ObjectField",name:{kind:"Name",value:"shape"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"ShapeName"},value:{kind:"Variable",name:{kind:"Name",value:"shapeName"}}},{kind:"ObjectField",name:{kind:"Name",value:"IsScheduledFolder"},value:{kind:"Variable",name:{kind:"Name",value:"isScheduledFolder"}}}]}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NotificationPayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"EventType"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationChangePayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ConversationTypeFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"Item"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ItemRowFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RowNotificationDeletePayload"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Conversation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"}}]}},{kind:"Field",name:{kind:"Name",value:"Item"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"InstanceKey"}}]}}]}}]}}]}},...B.a.definitions,...U.a.definitions]};var q=n(705),G=n(1800),H=n(6602);var z=n(20);const W=new z.c(()=>n.e(1956).then(n.bind(null,19835))),Y=new z.a(W,e=>e.subscribeToChannelReadyNotification),$={};function Z(e){const t=$[e];if(t){te(Object(c.L)().tableViews.get(e))?function(e){e.unsubscribe()}(t):L.k.importAndExecute(t,V),delete $[e]}}function J(e){if($[e.id])return;if(0!==e.tableQuery.type&&2!==e.tableQuery.type&&3!==e.tableQuery.type)throw new Error("subscribeToRowNotifications should only be called for Folder, Group or GroupFolder table type");const t=e.tableQuery;1!=t.sortBy.sortColumn||Object(p.m)(e.tableQuery.folderId)||Object(A.C)(e.tableQuery.folderId,"SharedMailbox")||"spotlight"!==t.scenarioType&&(te(e)?(Y.importAndExecute(),async function(e){const t=e.tableQuery,n=Object(q.a)();return Object(H.a)(()=>n.subscribe({query:K,variables:{subscriptionId:e.id,folderId:e.tableQuery.folderId,listViewType:Object(c.s)(t.listViewType),type:Object(c.u)(e.tableQuery.type),categoryName:t.categoryName,focusedViewFilter:Object(c.r)(t.focusedViewFilter),viewFilter:Object(c.v)(t.viewFilter),sortBy:{sortColumn:Object(c.t)(t.sortBy.sortColumn),sortDirection:t.sortBy.sortDirection,canSortByRenewTime:Object(u.l)(t)},shapeName:Q.c(e.tableQuery.folderId,Object(c.T)(t.scenarioType)),isScheduledFolder:"scheduled"==Object(R.a)(e.tableQuery.folderId),mailboxInfo:Object(G.d)(t)}}),{next:e=>V(e.data.subscribeToRowNotifications),error:t=>{V({id:e.id,EventType:"Reload"})}},"RowNotifications")}(e).then(t=>{$[e.id]=t})):L.b.import().then(n=>{const i={NotificationType:"RowNotification",FolderId:X(e),FocusedViewFilter:t.focusedViewFilter,IsConversation:0==t.listViewType,CategoryFilter:t.categoryName,Filter:t.viewFilter,ChannelId:n(),MailboxId:ee(e)};!0===i.IsConversation?(i.ConversationShapeName=Q.c(e.tableQuery.folderId,Object(c.T)(t.scenarioType)),i.ConversationResponseShape=Q.b(e.tableQuery.folderId),i.SortBy=function(e){const t=e.sortBy;let n;switch(e.sortBy.sortColumn){case 1:Object(u.l)(e)&&(n="ConversationLastDeliveryOrRenewTime");break;case 3:n="ConversationUniqueSenders";break;case 7:n="ConversationSize";break;case 8:n="ConversationTopic";break;case 5:n="ConversationImportance";break;default:throw new Error("getConversationSortByProperty: sort column is not supported "+t.sortColumn)}const i=[];n&&i.push(Object(M.a)({Order:t.sortDirection,Path:Object(x.a)({FieldURI:n})}));const a=1==e.sortBy.sortColumn?e.sortBy.sortDirection:c.c.DESCENDING_SORT_DIR;return i.push(Object(M.a)({Order:a,Path:Object(x.a)({FieldURI:"ConversationLastDeliveryTime"})})),i}(t)):i.SortBy=Object(_.a)(t);const a={subscriptionId:e.id,requiresExplicitSubscribe:!0,subscriptionParameters:i};L.j.importAndExecute(a,V),$[e.id]=a}))}function X(e){return 0===e.tableQuery.type?e.tableQuery.folderId:3===e.tableQuery.type?null==(t=e.tableQuery.folderId)?void 0:t.split("/").join("-").split("+").join("_"):null;var t}function ee(e){return 2===e.tableQuery.type?e.tableQuery.folderId:3===e.tableQuery.type?e.tableQuery.groupId:null}function te(e){return e&&(0==e.tableQuery.listViewType||1==e.tableQuery.listViewType&&Object(y.j)("mon-messageList-useGqlForFindItem"))}n.d(t,"subscribeToRowNotifications",(function(){return J})),n.d(t,"unsubscribeToRowNotifications",(function(){return Z}))},2111:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1902),a=n(3055);function o(e){return Object(i.b)().loadedConversationReadingPaneViewStates.get(e||Object(i.b)().sxsItemId||Object(a.a)())}},263:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return d}));var i=n(289),a=n(3);const o={tabs:[{id:"primaryTab",type:i.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1,isTabBarAvailable:!1};let r=Object(a.createStore)("tab",o);r();const d=r().tabs[0]},2709:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1902),a=n(3055);function o(e){return Object(i.b)().loadedItemReadingPaneViewStates.get(e||Object(a.a)())}},2779:function(e,t,n){"use strict";var i=n(20),a=n(3551),o=n(2639),r=n(2477),d=n(2419),c=n(2839),l=n(2840),s=n(3140),u=n(3400),b=n(3319),f=n(1902),m=n(1693);function p(e,t){return!!e&&(1!==t&&!!m.a.conversations.get(e))}function y(e,t){return 2!=t&&f.a.loadedItemReadingPaneViewStates.has(e)}var v=n(2949),k=n(2950),O=n(2709),w=n(2111);n.d(t,"l",(function(){return I})),n.d(t,"p",(function(){return N})),n.d(t,"m",(function(){return T})),n.d(t,"q",(function(){return h})),n.d(t,"s",(function(){return S})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return R})),n.d(t,"i",(function(){return V})),n.d(t,"j",(function(){return C})),n.d(t,"k",(function(){return F})),n.d(t,"g",(function(){return P})),n.d(t,"r",(function(){return D})),n.d(t,"h",(function(){return E})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return y})),n.d(t,"f",(function(){return v.a})),n.d(t,"a",(function(){return k.a})),n.d(t,"t",(function(){return f.a})),n.d(t,"c",(function(){return O.a})),n.d(t,"b",(function(){return w.a}));const j=new i.c(()=>Promise.all([n.e(0),n.e(7),n.e(9),n.e(11),n.e(200)]).then(n.bind(null,19448)));let I=new i.a(j,e=>e.loadConversationReadingPane),N=new i.a(j,e=>e.moveReadingPaneToTab),T=new i.a(j,e=>e.loadConversationReadingPaneForSingleMailItemSelected),h=new i.a(j,e=>e.print),S=new i.a(j,e=>e.setItemIdToScrollTo),g=new i.a(j,e=>e.loadItemReadingPane),R=new i.a(j,e=>e.loadItemReadingPaneForSingleMailItemSelected),V=new i.a(j,e=>e.expandCollapseAllItemParts);Object(i.f)(r.a,j,e=>e.deleteItemsStoreUpdateOrchestrator),Object(i.f)(c.a,j,e=>e.markConversationsAsReadStoreUpdateOrchestrator),Object(i.f)(l.a,j,e=>e.markItemsAsReadStoreUpdateOrchestrator),Object(i.f)(d.a,j,e=>e.markAllAsReadOrchestrator),Object(i.f)(a.a,j,e=>e.applyConversationFlagStateStoreUpdateOrchestrator),Object(i.f)(o.a,j,e=>e.deleteConversationStoreUpdateOrchestrator),Object(i.f)(b.a,j,e=>e.conversationReadyToLoadOrchestrator),Object(i.f)(b.b,j,e=>e.updateAttachmentsOrchestrator),Object(i.f)(b.c,j,e=>e.updateItemMandatoryPropertiesOrchestrator),Object(i.f)(s.a,j,e=>e.updateInternetMessageIdOrchestrator),Object(i.f)(u.a,j,e=>e.initializeExtendedCardForItemReadingPaneOrchestrator);new i.b(j,e=>e.getLastestNonDraftItemId);let C=new i.b(j,e=>e.getLatestNonDraftItemIdFromConversation),F=new i.b(j,e=>e.isUnsupportedItem),P=new i.a(j,e=>e.clearReadingPaneStore),D=new i.a(j,e=>e.replyByMeeting),E=new i.a(j,e=>e.ensureSecondaryReadingPaneTabHandler)},289:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.MailCompose=3]="MailCompose",e[e.SxS=4]="SxS",e[e.CalendarCompose=5]="CalendarCompose",e[e.CalendarReadingPane=6]="CalendarReadingPane"}(i||(i={}))},2949:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(47);function a(){return Object(i.j)("rp-linkedInViewProfile")||Object(i.j)("rp-linkedInViewProfileV1_1")}},2950:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i="displaylinkedindataprebind"},3055:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(806),a=n(3195);function o(){const e=Object(i.d)();switch(e.type){case i.a.SecondaryReadingPane:return e.data.id.Id;case i.a.Primary:default:return Object(a.a)()}}},3140:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("updateInternetMessageId",(e,t,n)=>({conversationId:e,itemId:t,internetMessageId:n}))},3195:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(1902),a=n(610);function o(){var e,t;return Object(a.w)()?null===(e=Object(i.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(i.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},3319:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return r}));var i=n(3);const a=Object(i.action)("CONVERSATION_READY_TO_LOAD",(e,t)=>({conversationId:e,nodeIdCollectionChange:t})),o=Object(i.action)("UPDATE_ATTACHMENTS"),r=Object(i.action)("UPDATE_ITEM_MANDATORY_PROPERTIES",(e,t)=>({conversationId:e,nodeIdCollectionWithItemMandatoryPropertiesChanged:t}))},3400:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("initializeExtendedCardForItemReadingPane",(e,t)=>({itemReadingPaneViewState:e,loadedItem:t}))},3551:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("APPLY_CONVERSATION_FLAG_STATE_STORE_UPDATE",(e,t,n)=>({conversationIds:e,flagType:t,tableViewId:n}))},456:function(e,t,n){"use strict";class i{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return i}))},6602:function(e,t,n){"use strict";var i=n(71),a=n(2),o=n(567),r=n(36);const d=10;function c(e,t,n){let c,l=0;const s={next:e=>{var n;return null===(n=t.next)||void 0===n?void 0:n.call(t,e)},complete:()=>{var e;return null===(e=t.complete)||void 0===e?void 0:e.call(t)},error:u=>{var b;Object(i.o)("GraphqlSubscriptionError",{owa_1:n,owa_2:Object(a.U)(null==u?void 0:u.toString()),owa_3:Object(a.U)(null==u?void 0:u.stack),owa_4:l},{isCore:!0}),Object(o.isApolloError)(u)&&(l++<d?(null==c||c.unsubscribe(),c=e().subscribe(s)):Object(r.d)(`${n}: too many apollo errors`)),null===(b=t.error)||void 0===b||b.call(t,u)}};return c=e().subscribe(s),{closed:!c||c.closed,unsubscribe:()=>null==c?void 0:c.unsubscribe()}}n.d(t,"a",(function(){return c}))},6603:function(e,t,n){"use strict";var i=n(71),a=n(2128),o=n(702);let r=Object(o.action)("onReloadTableSucceeded")((function(e,t,n){Object(a.h)(t,e,n,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),d=Object(o.action)("onReloadTableFailed")((function(e){Object(i.o)("TnS_ReloadError",[e])}));var c=n(2870),l=n(47),s=n(3193),u=n(2222),b=n(1845),f=n(3442),m=n(456),p=n(1675),y=n(1800);const v=new m.a(1,(async function(e){const t=e.tableViewId,n=Object(p.L)().tableViews.get(t);if(!n)return Promise.resolve();const o=Math.max(n.currentLoadedIndex,b.a);switch(n.tableQuery.listViewType){case 0:await function(e,t){var n;const i=e.tableQuery,o=Object(p.l)(e,!0),l=null===(n=o)||void 0===n?void 0:n.Id;return Object(u.d)(i.folderId,t,i.viewFilter,i.sortBy,Object(a.l)(i),i.focusedViewFilter,i.requestShapeName,Object(y.d)(i),void 0,i.categoryName,l).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalConversationRowsInView)}).catch(e=>{const t=Object(c.a)(e);d(t)})}(n,o);break;case 1:await function(e,t){const n=e.tableQuery;return Object(l.j)("mon-messageList-useGqlForFindItem")?Object(u.h)(Object(p.k)(n),t,n.viewFilter,n.sortBy,Object(a.l)(n),n.focusedViewFilter,n.requestShapeName,Object(y.d)(n),void 0,Object(y.e)(n),n.categoryName,Object(p.l)(e,!0)).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),r(e,n,t.totalItemRowsInView)}).catch(e=>{const t=Object(c.a)(e);d(t)}):Object(u.c)(Object(p.k)(n),0,t,n.viewFilter,Object(f.a)(n),n.focusedViewFilter,n.requestShapeName,void 0,Object(y.e)(n),n.categoryName,Object(p.l)(e,!0)).then(t=>{"Success"==t.ResponseClass?r(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView):d(t.ResponseCode)}).catch(e=>{d()})}(n,o)}0==n.tableQuery.type&&Object(s.a)(n.tableQuery.folderId);return Object(i.o)("ReloadTable",[o],{sessionSampleRate:10}),Promise.resolve()}),150);t.a=Object(o.action)("reloadMailListTableAction")((function(e){1===e.tableQuery.type||Object(p.V)(e.tableQuery.folderId)||v.add({tableViewId:e.id})}))},7411:function(e,t,n){"use strict";var i=n(3);t.a=Object(i.action)("ROW_UPDATED",(e,t)=>({rowKey:e,tableView:t}))},806:function(e,t,n){"use strict";var i=n(20),a=n(263),o=n(966),r=n(289);function d(e){const t=Object(a.a)();for(const n of t.tabs)if(n.type!==r.a.Primary&&n.type!==r.a.SxS&&n.data==e)return n;return null}function c(e){const t=Object(a.a)();for(const n of t.tabs)if(n.sxsId===e)return n.id;return null}function l(e){var t,n;const i=Object(a.a)();for(const a of i.tabs)if(a.type!==r.a.Primary&&a.type!==r.a.SxS&&(null===(n=null===(t=a.data)||void 0===t?void 0:t.id)||void 0===n?void 0:n.Id)==e)return!0;return!1}function s(e,t){var n,i;const o=Object(a.a)();for(const a of o.tabs)if(a.type!==r.a.Primary&&a.type!==r.a.SxS&&(null===(i=null===(n=a.data)||void 0===n?void 0:n.id)||void 0===i?void 0:i.Id)==e&&a.id!=t)return!0;return!1}function u(e){switch(e.type){case r.a.SecondaryReadingPane:return e.data.subject;default:return null}}var b=n(967);n(989);function f(e){for(const t of Object(a.a)().tabs)if(t.id===e)return t.firstRibbonRenderCompleted;return!1}var m=n(3),p=n(1057);Object(m.mutator)(p.a,e=>{for(const t of Object(a.a)().tabs)t.id===e.tabId&&(t.firstRibbonRenderCompleted=!0)}),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return k})),n.d(t,"j",(function(){return O})),n.d(t,"n",(function(){return w})),n.d(t,"l",(function(){return j})),n.d(t,"m",(function(){return I})),n.d(t,"k",(function(){return N})),n.d(t,"f",(function(){return a.a})),n.d(t,"p",(function(){return a.b})),n.d(t,"d",(function(){return o.a})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return c})),n.d(t,"r",(function(){return l})),n.d(t,"o",(function(){return s})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return r.a})),n.d(t,"q",(function(){return b.b})),n.d(t,"e",(function(){return f}));const y=new i.c(()=>n.e(766).then(n.bind(null,19806)));let v=new i.a(y,e=>e.activateTab),k=new i.a(y,e=>e.addTab),O=new i.a(y,e=>e.closeTab),w=new i.a(y,e=>e.setTabIsShown),j=new i.a(y,e=>e.reloadSecondaryTabAsDeeplink),I=new i.a(y,e=>e.setFirstRenderCompleted),N=new i.b(y,e=>e.getTabById)},8871:function(e,t,n){"use strict";function i(e,t){return t.rowKeys.indexOf(e)}n.d(t,"a",(function(){return i}))},966:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var i=n(263),a=n(36);function o(){const e=Object(i.a)();for(const t of e.tabs)if(2==t.state)return t;return a.d("There is no active tab. Something went very wrong."),null}},967:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return r}));var i=n(289);const a={};function o(e,t){a[i.a[e]]=t}function r(e){return a[i.a[e]]}},9790:function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return c}));var i=n(2411),a=n(1675),o=n(2128);function r(e,t,n,i){const r=new Date(a.b.getLastDeliveryTimeStamp(n,i)).getTime()-new Date(t).getTime();if(Object(o.l)(i.tableQuery)){const t=new Date(a.b.getLastDeliveryOrRenewTimeStamp(n,i)).getTime()-new Date(e).getTime();return 0!=t?t:r}return r}function d(e,t,n,a,r){return Object(i.a)(r,n.id,e)?Object(o.f)(n,0):c(e,t,n,a)}function c(e,t,n,o){const d=n.rowKeys.length;if(0==d)return 0;const c=Object(a.K)(n).sortDirection==a.c.DESCENDING_SORT_DIR;let l;for(l=o;l<d;l++){const a=n.rowKeys[l];if(Object(i.a)(a,n.id,e))continue;const o=r(e,t,a,n);if(c?o<=0:o>0)return l}return d==n.totalRowsInView?d:-1}},989:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(263);function a(){return Object(i.a)().tabs.filter(e=>3===e.state)}}}]);
//# sourceMappingURL=owa.638.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.638.js'] = 1;