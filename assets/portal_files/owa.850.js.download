(window.$wj=window.$wj||[]).push([[850,97],{1569:function(t,e,c){"use strict";c.r(e);var o=c(542),n=c(71);function r(t,e,c){const r={sourceType:o.d.Mailbox,authProviderType:o.c.OutlookDotCom,displayName:t,characteristics:{supportsCalendar:!0,supportsContacts:!1,supportsMail:!1,supportsSettings:!1},mailbox:{type:"UserMailbox",name:t,displayName:t,emailAddress:t,loginAddress:null!=t?t:"",userIdentity:t,accountUniqueId:e,routingHint:"",alternateId:"",imageUrl:"",profileUrl:""},accountState:{connectedAccountState:c}},u=!Object(o.j)(t,!0);u&&Object(o.e)(r),Object(n.o)("addConnectedAccountToAccountSourceList",{noAccountForUserIdentity:u})}var u=c(255),i=c(57);function a(){const t=Object(i.g)().SessionSettings,e=Object(i.c)(),c=t.UserPrincipalName||t.UserEmailAddress||e,n={sourceType:o.d.Mailbox,authProviderType:Object(i.r)()?o.c.OutlookDotCom:o.c.Microsoft365,displayName:c,characteristics:{supportsCalendar:!0,supportsContacts:!0,supportsMail:!0,supportsSettings:!0},mailbox:{type:"UserMailbox",name:c,displayName:c,emailAddress:t.UserEmailAddress||e,loginAddress:t.LogonEmailAddress||e,userIdentity:t.LogonEmailAddress||e,routingHint:"",alternateId:"",accountUniqueId:"",imageUrl:"",profileUrl:""}};Object(o.e)(n),Object(u.m)(u.b.Loaded)}function s(t){const e=Object(o.j)(t,!0);e&&Object(u.l)(e);const c=""!=e;Object(n.o)("removeConnectedAccountFromAccountSourceList",{accountFound:c})}function d(t,e){const c=Object(o.j)(t,!0),r=""!==c;let i=!1;if(c){const t=Object(u.f)(c);t&&(i=!0,t.accountState={connectedAccountState:e},Object(u.p)(t))}Object(n.o)("updateConnectedAccountStateForAccountSourceList",{sourceIdFound:r,accountFound:i})}c.d(e,"addConnectedAccount",(function(){return r})),c.d(e,"initOwaAccountSourceListStore",(function(){return a})),c.d(e,"removeConnectedAccount",(function(){return s})),c.d(e,"updateConnectedAccountState",(function(){return d}))},218:function(t,e,c){"use strict";c.d(e,"b",(function(){return n}));var o=c(3);const n={loadState:c(514).b.Loading,selectedSourceId:"",globalSettingsSourceId:"",sources:[]},r=Object(o.createStore)("AccountSourceList",n);e.a=r},255:function(t,e,c){"use strict";var o=c(3),n=Object(o.action)("ADD_ACCOUNT",t=>({accountSource:t})),r=c(910),u=Object(o.action)("REMOVE_ACCOUNT_BY_ID",t=>({accountSourceId:t})),i=Object(o.action)("SET_GLOBAL_SETTINGS_ACCOUNT",t=>({globalSettingsSourceId:t})),a=Object(o.action)("SET_LOAD_STATE",t=>({loadState:t})),s=Object(o.action)("SET_SELECTED_ACCOUNT",t=>({selectedSourceId:t})),d=Object(o.action)("SET_SHARED_SOURCES",(t,e)=>({sourceId:t,SharedAccountInfo:e})),l=Object(o.action)("UPDATE_ACCOUNT",t=>({accountSource:t})),b=c(376),f=c(218);function O(){const t=Object(b.a)(Object(f.a)().globalSettingsSourceId);if(!t)throw new Error("AccountSourceListStore is not initialized");return t}var S=c(968);function j(){return Object(f.a)().sources.filter(t=>t.characteristics.supportsMail)}var A=c(514);Object(o.mutator)(n,t=>{const e=Object(f.a)();if(Object(b.a)(t.accountSource.sourceId))throw new Error("Found duplicated account in the store.");e.sources.push(t.accountSource),e.selectedSourceId||(e.selectedSourceId=t.accountSource.sourceId),e.globalSettingsSourceId||(e.globalSettingsSourceId=t.accountSource.sourceId)}),Object(o.mutator)(u,t=>{const e=Object(f.a)();e.sources=e.sources.filter(e=>e.sourceId!==t.accountSourceId),t.accountSourceId==e.selectedSourceId&&(e.selectedSourceId=e.sources.length>0?e.sources[0].sourceId:f.b.selectedSourceId),t.accountSourceId==e.globalSettingsSourceId&&(e.globalSettingsSourceId=e.sources.length>0?e.sources[0].sourceId:f.b.globalSettingsSourceId)}),Object(o.mutator)(i,t=>{const e=Object(f.a)();if(0===e.sources.filter(e=>e.sourceId==t.globalSettingsSourceId).length)throw new Error("Source not found");e.globalSettingsSourceId=t.globalSettingsSourceId}),Object(o.mutator)(a,t=>{Object(f.a)().loadState=t.loadState}),Object(o.mutator)(s,t=>{const e=Object(f.a)();e.sources.filter(e=>e.sourceId==t.selectedSourceId).length>0&&(e.selectedSourceId=t.selectedSourceId)}),Object(o.mutator)(d,t=>{t.SharedAccountInfo.sources.forEach(e=>{const c=Object(b.b)(e.sourceId);if(c&&c.hostingSourceId!==t.sourceId)throw new Error("Found duplicated account in the store.")});const e=Object(b.a)(t.sourceId);e&&(e.sharedSources=t.SharedAccountInfo)}),Object(o.mutator)(l,t=>{const e=Object(f.a)();e.sources=e.sources.map(e=>e.sourceId===t.accountSource.sourceId?t.accountSource:e)});c.d(e,"e",(function(){return n})),c.d(e,"k",(function(){return r.a})),c.d(e,"l",(function(){return u})),c.d(e,"m",(function(){return a})),c.d(e,"n",(function(){return s})),c.d(e,"o",(function(){return d})),c.d(e,"p",(function(){return l})),c.d(e,"f",(function(){return b.a})),c.d(e,"h",(function(){return O})),c.d(e,"j",(function(){return S.a})),c.d(e,"g",(function(){return f.a})),c.d(e,"i",(function(){return j})),c.d(e,"a",(function(){return A.a})),c.d(e,"b",(function(){return A.b})),c.d(e,"c",(function(){return A.c})),c.d(e,"d",(function(){return A.d}))},376:function(t,e,c){"use strict";c.d(e,"b",(function(){return n})),c.d(e,"a",(function(){return r}));var o=c(218);function n(t){const e=[];if(Object(o.a)().sources.forEach(c=>{c.sourceId===t?e.push({source:c}):c.sharedSources&&c.sharedSources.sources.forEach(o=>{o.sourceId===t&&e.push({source:o,hostingSourceId:c.sourceId})})}),e.length>1)throw new Error("Duplicate account found");return e[0]}function r(t){var e;return null===(e=n(t))||void 0===e?void 0:e.source}},514:function(t,e,c){"use strict";var o,n,r,u;c.d(e,"b",(function(){return o})),c.d(e,"c",(function(){return n})),c.d(e,"d",(function(){return r})),c.d(e,"a",(function(){return u})),function(t){t[t.NotStarted=0]="NotStarted",t[t.Loading=1]="Loading",t[t.Loaded=2]="Loaded",t[t.Error=3]="Error"}(o||(o={})),function(t){t[t.AAD=0]="AAD",t[t.MSA=1]="MSA"}(n||(n={})),function(t){t.UserMailbox="UserMailbox",t.GroupMailbox="GroupMailbox",t.TeamsMailbox="TeamsMailbox",t.PublicMailbox="PublicMailbox",t.SharedMailbox="SharedMailbox",t.ArchiveMailbox="ArchiveMailbox"}(r||(r={})),function(t){t.Office365="Office365",t.OutlookDotCom="Outlook",t.Google="Google",t.ICloud="ICloud",t.Yahoo="Yahoo"}(u||(u={}))},542:function(t,e,c){"use strict";c(614);var o=c(255),n=c(36);function r(t,e){if(t){const c=Object(o.g)().sources.filter(e=>{var c;return(null===(c=null==e?void 0:e.m365mailbox)||void 0===c?void 0:c.userIdentity)===t});if(0===c.length){if(e)return"";Object(n.e)("SourceIdNotFoundForUserIdentity")}return c[0].sourceId}const c=Object(o.j)();return c||Object(n.e)("NoSelectedAccountForDefaultUserIdentity"),c.sourceId}c(13);let u={};function i(t){u=Object.assign(Object.assign({},u),t)}async function a(t){return u.addM365Account||Object(n.e)("NoPluggableMethodAddM365Account"),u.addM365Account(t)}async function s(t){return u.addOutlookDotComAccount||Object(n.e)("NoPluggableMethodAddOutlookDotComAccount"),u.addOutlookDotComAccount(t)}async function d(t){return u.removeAccount||Object(n.e)("NoPluggableMethodRemoveAccount"),u.removeAccount(t)}function l(){let t=Object(o.j)();return t||Object(n.e)("NoAccountSelected"),t.sourceId}async function b(t){Object(o.f)(t)||Object(n.e)("SelectedAccountNotFound"),await async function(t){if(u.preSelectAccount)return u.preSelectAccount(t)}(t),Object(o.n)(t)}var f=c(20);const O=new f.c(()=>c.e(1135).then(c.bind(null,19168))),S=new f.a(O,t=>t.ensureSharedMailboxData);async function j(t){return S.importAndExecute(t)}var A,I,m,g;!function(t){t.Mailbox="MAILBOX"}(A||(A={})),function(t){t.Microsoft365="MICROSOFT365",t.OutlookDotCom="OUTLOOKDOTCOM"}(I||(I={})),function(t){t.GetAuthTokenFailed="INVALIDCREDENTIALS",t.CouldNotConnect="CONNECTFAILED",t.DuplicateAccount="DUPLICATE"}(m||(m={})),function(t){t.AccountNotFound="NOT_FOUND"}(g||(g={}));var p=c(545);function h(t){const e=Object(o.f)(t);return e?{type:e.m365mailbox.type,userIdentity:e.m365mailbox.userIdentity,mailboxSmtpAddress:e.m365mailbox.emailAddress}:void 0}function C(t,e){const c=Object.assign(Object.assign({},e.characteristics),{isMicrosoft365Hosted:!0}),n=e.mailbox?Object.assign(Object.assign({},e.mailbox),{type:o.d.UserMailbox,logonEmailAddress:e.mailbox.loginAddress,authProviderType:e.authProviderType===I.Microsoft365?o.c.AAD:o.c.MSA}):void 0;return{sourceId:t,sourceType:e.authProviderType===I.Microsoft365?o.a.Office365:o.a.OutlookDotCom,displayName:e.displayName,characteristics:c,m365mailbox:n,accountState:e.accountState}}function E(t){const e=Object(p.a)(p.b,p.c,t.mailbox.userIdentity);return Object(o.f)(e)||Object(o.e)(C(e,t)),e}function M(t){const e=Object(p.a)(p.b,p.c,t.mailbox.userIdentity);return Object(o.f)(e)&&Object(o.p)(C(e,t)),e}c.d(e,"j",(function(){return r})),c.d(e,"o",(function(){return i})),c.d(e,"f",(function(){return a})),c.d(e,"g",(function(){return s})),c.d(e,"l",(function(){return d})),c.d(e,"i",(function(){return l})),c.d(e,"m",(function(){return b})),c.d(e,"k",(function(){return j})),c.d(e,"e",(function(){return E})),c.d(e,"h",(function(){return h})),c.d(e,"n",(function(){return M})),c.d(e,"a",(function(){return m})),c.d(e,"b",(function(){return g})),c.d(e,"d",(function(){return A})),c.d(e,"c",(function(){return I}))},545:function(t,e,c){"use strict";c.d(e,"b",(function(){return o})),c.d(e,"c",(function(){return n})),c.d(e,"a",(function(){return u}));const o="main",n="m365",r=":";function u(t,e,c,o){return(o?[t,e,o,c]:[t,e,c]).join(r)}},614:function(t,e,c){"use strict";c.d(e,"a",(function(){return r})),c.d(e,"b",(function(){return u}));var o=c(132),n=c(13);function r(){return Object(o.a)("acctmonaccounts")&&Object(n.i)("acctmonaccounts")}function u(){return r()||!Object(o.a)("acctmonaccounts")&&Object(n.i)("accountsapi")}},910:function(t,e,c){"use strict";var o=c(3);e.a=Object(o.action)("ON_SELECTED_ACCOUNT_CHANGED",(t,e,c)=>({selectedAccountSourceId:t,selectedEmailAddress:e,oldSourceId:c}))},968:function(t,e,c){"use strict";c.d(e,"a",(function(){return r}));var o=c(218),n=c(376);function r(){return Object(n.a)(Object(o.a)().selectedSourceId)}}}]);
//# sourceMappingURL=owa.850.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.850.js'] = 1;