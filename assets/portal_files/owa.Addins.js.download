(window.$wj=window.$wj||[]).push([[157,7,8,9,10,13,19,33,35,43,45,48,56,58,75,87,97,142,149],{1e3:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(20);const o=new r.c(()=>n.e(1145).then(n.bind(null,1582)));let i=new r.a(o,e=>e.subscribe),a=new r.a(o,e=>e.unsubscribe),s=new r.a(o,e=>e.trigger);new r.a(o,e=>e.removeResizeEventEmitter)},10063:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(2036),o=n(2101);const i=e=>(t,n)=>{Object(r.a)(e,t,n)},a=e=>t=>{Object(o.a)(e,t)},s=e=>()=>e.infoBarIds},1009:function(e,t,n){"use strict";var r=n(47),o=n(917),i=n(1011),a=n(36);const s=e=>{const t=void 0!==e.EmailAddress;return t||a.h.warn("Recipient cache contained a persona that had no EmailAddress"),t};function c(e){if(Object(r.j)("cmp-resolveRecipsFromCache")&&"SMTP"===e.RoutingType&&e.EmailAddress){const t=Object(i.a)(e.EmailAddress);if(t&&s(t))return Object(o.b)(t)}return null}n.d(t,"a",(function(){return c}))},1011:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(914);const o=e=>{const t=Object(r.c)(t=>"SMTP"===t.EmailAddress.RoutingType&&t.EmailAddress.EmailAddress&&t.EmailAddress.EmailAddress.toLowerCase()===e.toLowerCase(),1);return t.length?t[0]:null}},1012:function(e,t,n){"use strict";t.a=function(){return!1}},1014:function(e,t,n){"use strict";function r(){return{isSuggesting:!1,bufferZone:0,targetPoint:null}}n.d(t,"a",(function(){return r}))},1017:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Failed=2]="Failed",e[e.SucceededWithDLOrGroupMembers=3]="SucceededWithDLOrGroupMembers",e[e.SucceededWithoutDLOrGroupMembers=4]="SucceededWithoutDLOrGroupMembers"}(r||(r={})),t.b=r},10199:function(e,t,n){"use strict";var r=n(0),o=n(23),i=n(11820),a=n(6),s=n(123),c=n.n(s),u=n(6451),l=n(11821),d=n(334),f=n(11822),p=n.n(f),m=Object(o.a)((function(e){const t=function(e){switch(e){case 1:return{title:Object(a.b)(l.d),description:Object(a.b)(l.e)};case 2:return{title:Object(a.b)(u.d),description:Object(a.b)(u.e)};case 3:return{title:Object(a.b)(l.a),description:Object(a.b)(l.b)};case 4:return{title:Object(a.b)(l.a),description:Object(a.b)(l.c)};default:return{title:null,description:null}}}(e.errorType);return r.createElement("div",{className:p.a.errorContainer},r.createElement("div",{className:p.a.errorContent},r.createElement(d.a,{className:p.a.errorIcon,iconName:"OfficeAddinsLogo"}),r.createElement("span",{className:c()([p.a.errorTextCommon,p.a.errorTextTitle])},t.title),r.createElement("span",{className:c()([p.a.errorTextCommon,p.a.errorTextDescription])},t.description)))}));var h=n(11824),g=n(379),v=n(56),y=n(335),b=n(8228),O=n.n(b),S=Object(o.a)((function(e){const[t,n]=r.useState(!1);return t?r.createElement(d.a,{iconName:"Photo2",iconType:g.a.default,className:c()([O.a.fallbackIcon,e.className])}):r.createElement(y.a,{onLoadingStateChange:e=>{e==v.c.error?n(!0):n(!1)},src:e.src,width:e.width,height:e.height,imageFit:v.b.contain,className:e.className})})),C=n(1264),A=Object(o.a)((function(e){const t=(()=>e.isPersisted?"Pinned":"Pin")(),n=(()=>{const t=e.isPersisted?Object(a.b)(u.g):Object(a.b)(u.f);return Object(a.c)(t,e.displayName)})(),o=e.isDarkTheme?O.a.persistIconDark:O.a.persistIcon;return r.createElement(C.a,{className:o,onClick:e.togglePersist,title:n,ariaLabel:n,iconProps:{iconName:t}})})),_=n(5767),I=n(131),x=Object(o.a)((function(e,t){const n=r.useRef();r.useImperativeHandle(t,()=>({focusCloseButton(){n.current&&n.current.focus()}}),[]);const{isCalendar:o}=e,i=Object(I.g)(),s=i?c()(O.a.addinPaneHeaderDark,o&&O.a.addinPaneHeaderCalendarDark):c()(O.a.addinPaneHeader,o&&O.a.addinPaneHeaderCalendar),u=c()([i?O.a.addinPaneLabelTextDark:O.a.addinPaneLabelText,O.a.ellipsis]),l=i?O.a.closeButtonDark:O.a.closeButton;return r.createElement("div",{className:s},r.createElement(S,{src:e.iconUrl,width:32,height:32,className:O.a.addinPaneIcon}),r.createElement("div",{className:u},e.displayName),r.createElement("div",{className:O.a.rightButtons},Object(_.b)()&&e.isPersistable&&!o&&r.createElement(A,{displayName:e.displayName,isPersisted:e.isPersisted,isDarkTheme:i,togglePersist:e.togglePersist}),r.createElement(C.a,{componentRef:e=>n.current=e,className:l,onClick:e.closeOnClick,ariaLabel:Object(a.b)(h.a),iconProps:{iconName:"Cancel"}})))}),{forwardRef:!0}),E=n(6573),T=n(1558),w=n(1592),M=n(933),k=n(1900),j=n(11826),P=n.n(j);const R=e=>{const t=r.useContext(k.a),n=c()(P.a.taskPane,t!==window&&P.a.taskPaneInPopout,e.isDeepLink&&P.a.taskPaneNoHeader,{isShyHeaderMode:Object(M.b)()});return e.renderInPanel?r.createElement(w.a,{focusTrapZoneProps:{forceFocusInsideTrap:!1,disableFirstFocus:e.disableFirstFocus,isClickableOutsideFocusTrap:!0},hasCloseButton:!1,isOpen:!0,onDismiss:e.onDismiss,className:n,isBlocking:!1,isFooterAtBottom:!0,isLightDismiss:!0},e.children):r.createElement(T.a,{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,className:P.a.taskPane},e.children)};var N=n(5241),D=n(1797),F=n(610),L=n(7011),U=(n(3572),n(1810)),B=n(4956),H=n(5929),V=n(11828),z=n.n(V),W=Object(o.a)((function(e){const t=r.useContext(k.a),n=r.useRef(),o=()=>{n.current&&n.current.focusCloseButton()},s=()=>e.instance.mode===D.a.AppointmentAttendee||e.instance.mode===D.a.AppointmentOrganizer,u=()=>"Persistent"===e.type,l=()=>{const{errorType:t}=e.instance;return 0!==t},d=()=>{const{mode:t,controlId:n}=e.instance;u()&&Object(B.h)(t,null),Object(N.d)(n)},{instance:f}=e,p=void 0===e.renderInPanel||e.renderInPanel;if(!f)return r.createElement("div",{className:z.a.divContainer});const{addinCommand:h}=f;return r.createElement(R,{renderInPanel:p,onDismiss:d,isDeepLink:Object(F.w)(),disableFirstFocus:u()},r.createElement(x,{iconUrl:h.get_IconUrl(),displayName:h.get_ExtensionDisplayName(),closeOnClick:d,ref:n,isCalendar:s(),isPersistable:(()=>Object(B.a)(e.instance.addinCommand))(),isPersisted:u(),togglePersist:()=>{const n=u()?null:Object(B.b)(e.instance.addinCommand);Object(B.h)(e.instance.mode,n),"Persistent"==e.type?Object(H.b)():t===window&&Object(H.c)({hostItemIndex:e.instance.hostItemIndex,mode:e.instance.mode}),Object(U.kb)(e.type,e.instance.addinCommand.get_ExtensionId())}}),r.createElement("div",{className:c()(z.a.extensionContainer,s()&&z.a.extensionContainerCalendar),"aria-label":Object(a.c)(Object(a.b)(i.a),h.get_ExtensionDisplayName()),role:"complementary"},(()=>{const{errorType:t}=e.instance;return l()&&r.createElement(m,{errorType:t})})(),(()=>{const{hostItemIndex:t,controlId:n,addinCommand:i}=e.instance,a={};return a[15]=o,a[14]=o,a[13]=o,r.createElement(L.a,{addinCommand:i,controlId:n,className:c()([z.a.extensionHost,l()&&z.a.hide]),hostItemIndex:t,manifestCacheProvider:E.a,notifyHostActions:a})})()))})),G=n(9692),q=n(2),K=n(1979),X=n(3435),Q=n(6452);t.a=Object(o.a)((function(e){const t=r.useContext(k.a),{taskPanes:n,frameworkComponentHostItemIndexMap:o}=Object(U.u)(),i=Object(Q.a)(t),a=o.get(i),s=a?a.hostItemIndex:null,c=n=>{const o=Object(U.E)(n,s,t);return o&&r.createElement(W,{key:o.controlId,type:n,instance:o,renderInPanel:e.renderTaskPaneInPanel})};(()=>{if("Mail"===Object(q.m)()){const e=Object(K.a)(t),r=e?e.tabId:t===window?"Main":null,o=null==e?void 0:e.underlay,i=n.get(r),a=Object(X.a)(o);!a&&(null==i?void 0:i.size)?Object(G.b)(o):a&&!(null==i?void 0:i.size)&&Object(G.a)(o)}})();const u=Object(_.b)()&&c("Persistent"),l=c("NonPersistent");return r.createElement(r.Fragment,null,[u,l])}))},10287:function(e,t,n){"use strict";var r=n(225),o=n(2654),i=n(2386);function a(e){let t=null;return async()=>{var n,a,s,c;if(null==t){const[u,l,d,...f]=await Object(o.b)([null===(n=e.ItemId)||void 0===n?void 0:n.Id,e.SeriesId,null===(a=e.ConversationId)||void 0===a?void 0:a.Id].concat((null===(s=e.Attachments)||void 0===s?void 0:s.map(e=>{var t;return null===(t=e.AttachmentId)||void 0===t?void 0:t.Id}))||[]).concat((null===(c=e.Attachments)||void 0===c?void 0:c.map(e=>{var t;return null===(t=e.AttachmentId)||void 0===t?void 0:t.RootItemId}))||[]),i.a.EwsId,Object(r.d)().userIdentity,o.a.Addins);if(t=Object.assign({},e),u&&(t.ItemId={Id:u}),l&&(t.SeriesId=l),d&&(t.ConversationId=Object.assign({},e.ConversationId),t.ConversationId.Id=d),f.length){t.Attachments=e.Attachments.map(e=>{const t=Object.assign({},e);return t.AttachmentId&&(t.AttachmentId=Object.assign({},t.AttachmentId)),t});for(let e=0;e<f.length/2;e++){let n=f[e];n&&(t.Attachments[e].AttachmentId.Id=n)}for(let e=f.length/2;e<f.length;e++){let n=f[e];n&&(t.Attachments[e].AttachmentId.RootItemId=n)}}}return t}}n.d(t,"a",(function(){return a}))},10288:function(e,t,n){"use strict";var r;!function(e){e.MailRead="MailRead",e.MailCompose="MailCompose",e.NoEndpoint=""}(r||(r={}));var o=r,i=n(1797);function a(e){switch(e){case i.a.MessageRead:case i.a.MeetingRequest:return o.MailRead;case i.a.MessageCompose:return o.MailCompose;default:return o.NoEndpoint}}n.d(t,"a",(function(){return a}))},1034:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="TagFilled";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M2.54 7.33L7.29 2.6c.38-.37.89-.58 1.42-.59L11.97 2A2 2 0 0114 4.01l-.03 3.38a2 2 0 01-.59 1.4L8.7 13.44c-.78.78-2.06.78-2.84 0l-3.31-3.28a2 2 0 010-2.83zm7.72-1.67c.3.3.8.3 1.1 0 .3-.3.3-.78 0-1.08a.77.77 0 00-1.1 0c-.3.3-.3.78 0 1.08z"})),displayName:"TagFilled"});Object(o.registerIcons)({icons:{TagFilled:r.createElement(a,null)}})},1038:function(e,t,n){var r=n(1274);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},10527:function(e,t,n){"use strict";var r=n(20),o=n(4743),i=n(7684);n.d(t,"a",(function(){return i.a}));const a=new r.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(157)]).then(n.bind(null,14274)));Object(r.f)(o.e,a,e=>e.moduleChangeOrchestrator)},10528:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(1785),o=n(3);const i=Object(o.action)("onComposeClose",e=>({hostItemIndex:e}));function a(e,t){Object(r.c)(e).close(),i(e)}},10529:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1810);function o(e,t){const n=Object(r.z)();Object(r.Y)(n,e,t)}},10530:function(e,t,n){"use strict";var r=n(0),o=n(379),i=n(334),a=n(56),s=n(11835),c=n.n(s);t.a=e=>({iconType:o.a.Image,imageProps:{src:e,width:16,height:16,imageFit:a.b.contain,shouldFadeIn:!1},styles:{root:{width:"16px !important",height:"16px !important"}},imageErrorAs:e=>r.createElement(i.a,{className:c.a.fallbackIcon,iconName:"Photo2",iconType:o.a.Default})})},10531:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(11837),o=n(6),i=n(2374),a=n(379),s=n(138);function c(){return{key:"AddinMarketplace",name:Object(o.b)(r.a),title:Object(o.b)(r.a),ariaLabel:Object(o.b)(r.a),iconProps:{iconName:"AddIn",iconType:a.a.default},itemType:s.a.Normal,onClick:()=>{Object(i.a)()}}}function u(){return{key:"AddinMarketplaceDivider",displayName:"-",itemType:s.a.Divider,iconProps:{iconName:"AddIn",iconType:a.a.default},onClick:null}}},1055:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="CalendarLtrRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M5.25 9a.75.75 0 100-1.5.75.75 0 000 1.5zM6 10.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM8 9a.75.75 0 100-1.5A.75.75 0 008 9zm.75 1.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm2-1.75a.75.75 0 100-1.5.75.75 0 000 1.5zM14 4.5A2.5 2.5 0 0011.5 2h-7A2.5 2.5 0 002 4.5v7A2.5 2.5 0 004.5 14h7a2.5 2.5 0 002.5-2.5v-7zM3 6h10v5.5c0 .83-.67 1.5-1.5 1.5h-7A1.5 1.5 0 013 11.5V6zm1.5-3h7c.83 0 1.5.67 1.5 1.5V5H3v-.5C3 3.67 3.67 3 4.5 3z"})),displayName:"CalendarLtrRegular"});Object(o.registerIcons)({icons:{CalendarLtrRegular:r.createElement(a,null)}})},1056:function(e,t,n){"use strict";function r(e,t){if(!Boolean(e))throw new Error(null!=t?t:"Unexpected invariant triggered.")}n.d(t,"a",(function(){return r}))},1057:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("setFirstRenderCompleted",e=>({tabId:e}))},1058:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1078),o=n(1061),i=n(16),a=n(991);function s(e,t,n,r){let a=Object(o.a)(e,n);if(r&&(a.recipients=Object(i.toJS)(r)),t)for(let e of t)a.recipients.push(c(e));return a}function c(e){const t=Object(r.a)(e);return Object.assign(Object.assign({},t),{isValid:Object(a.a)(e)})}},1061:function(e,t,n){"use strict";var r=n(908),o=n(563),i=n(1014);function a(e){return Object.assign(Object.assign({},Object(i.a)()),{queryString:"",wordBeforeCursor:"",findResultSet:[],isSearching:!1,directorySearchType:o.a.None,selectedRecipientIndex:-1,selectedHeaderIndex:-1,selectedFooterIndex:-1,findResultType:o.b.None,findPeopleFeedbackManager:e,currentRenderedQueryString:"",numberOfCacheResults:0})}let s=0;function c(e){return{editorId:(s++).toString(),recipientPickerPluginViewState:a(e)}}n.d(t,"a",(function(){return l}));let u=0;function l(e,t){return{userIdentity:t,recipientWellId:`rw-${++u}`,queryString:"",recipients:[],isDirty:!1,shouldShowContactPicker:!1,findResultSet:[],findResultType:o.b.None,isSearching:!1,directorySearchType:o.a.None,dropViewState:Object(r.a)(),findPeopleFeedbackManager:e,numberOfCacheResults:0,recipientEditorViewState:c(e)}}},1068:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(68),o=function(e){if(!e&&"undefined"==typeof fetch)throw new r.a(22)}},1069:function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;if("function"==typeof n)if(n.observable)t=n.observable;else{t="function"==typeof n.for?n.for("https://github.com/benlesh/symbol-observable"):n("https://github.com/benlesh/symbol-observable");try{n.observable=t}catch(e){}}else t="@@observable";return t}n.d(t,"a",(function(){return r}))},1070:function(e,t,n){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,o=t.cmp&&(n=t.cmp,function(e){return function(t,r){var o={key:t,value:e[t]},i={key:r,value:e[r]};return n(o,i)}}),i=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,a;if(Array.isArray(t)){for(a="[",n=0;n<t.length;n++)n&&(a+=","),a+=e(t[n])||"null";return a+"]"}if(null===t)return"null";if(-1!==i.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=i.push(t)-1,c=Object.keys(t).sort(o&&o(t));for(a="",n=0;n<c.length;n++){var u=c[n],l=e(t[u]);l&&(a&&(a+=","),a+=JSON.stringify(u)+":"+l)}return i.splice(s,1),"{"+a+"}"}}(e)}},1071:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){var n=e.getContext().uri;return n||("function"==typeof t?t(e):t||"/graphql")}},1072:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){if("undefined"==typeof AbortController)return{controller:!1,signal:!1};var e=new AbortController;return{controller:e,signal:e.signal}}},1073:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(838),o=Object.prototype.hasOwnProperty;function i(e){return function(t){return t.text().then((function(e){try{return JSON.parse(e)}catch(r){var n=r;throw n.name="ServerParseError",n.response=t,n.statusCode=t.status,n.bodyText=e,n}})).then((function(n){return t.status>=300&&Object(r.a)(t,n,"Response not successful: Received status code "+t.status),Array.isArray(n)||o.call(n,"data")||o.call(n,"errors")||Object(r.a)(t,n,"Server response was missing for query '"+(Array.isArray(e)?e.map((function(e){return e.operationName})):e.operationName)+"'."),n}))}}},1074:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(439);function o(e){function t(t){Object.defineProperty(e,t,{value:r.a})}return"function"==typeof Symbol&&Symbol.species&&t(Symbol.species),t("@@species"),e}},1078:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(726),o=n(1009);function i(e){const t=Object(o.a)(e);if(t)return t;const n=Object(r.b)(e);return Object.assign(Object.assign({},n),{isPendingResolution:!0,persona:{EmailAddress:e,PersonaId:e.ItemId}})}},1080:function(e,t,n){"use strict";t.a=function(e,t){return e instanceof t}},1081:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"})},1113:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r="function"==typeof WeakMap&&!("object"==typeof navigator&&"ReactNative"===navigator.product)},1130:function(e,t,n){"use strict";function r(e){throw new Error("Unexpected object: "+e)}n.d(t,"a",(function(){return r}))},11812:function(e,t,n){var r=n(11813);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11813:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._1D3SjAfUzJsGtFv085pot8{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;max-width:510px}html[dir] ._1D3SjAfUzJsGtFv085pot8{margin:30px}",""]),t.locals={divContainer:"_1D3SjAfUzJsGtFv085pot8"}},11814:function(e){e.exports=JSON.parse('{"b":"ooa","l":"poa","c":"qoa","d":"roa","e":"soa","f":"toa","g":"uoa","k":"voa","h":"woa","i":"xoa","j":"yoa","m":"zoa","n":"Aoa","o":"Boa","a":"Coa"}')},11815:function(e,t,n){var r=n(11816);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11816:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._3F7No5-vgOr_1gVShb8FKf{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._3F7No5-vgOr_1gVShb8FKf{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3F7No5-vgOr_1gVShb8FKf .ms-Callout-main{overflow:hidden!important}._1y-0qwR5zgpuliA8JB6xM7{height:32px!important;color:inherit}html[dir] ._1y-0qwR5zgpuliA8JB6xM7{background-color:transparent}._1y-0qwR5zgpuliA8JB6xM7 .ms-Button{height:32px}._1y-0qwR5zgpuliA8JB6xM7 .is-expanded .ms-CommandBarItem-overflow,._33_xr0gXDD45Clv45d4qXQ .ms-Button-label{color:var(--themePrimary)!important}._3adRMmoaOLq8VLnPxe75se{color:var(--neutralTertiaryAlt)}html[dir] ._3adRMmoaOLq8VLnPxe75se{padding:8px}html[dir=ltr] ._3adRMmoaOLq8VLnPxe75se{float:left}html[dir=rtl] ._3adRMmoaOLq8VLnPxe75se{float:right}._3iCwtve60L8WT0WX--k1rG{height:16px;width:0}html[dir] ._3iCwtve60L8WT0WX--k1rG{padding:0 0 0 0;margin:8px 0;border-color:var(--neutralTertiaryAlt)!important}html[dir=ltr] ._3iCwtve60L8WT0WX--k1rG{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._3iCwtve60L8WT0WX--k1rG{border-left-width:1px;border-left-style:solid;float:right}._1k-Sj8yLsi3Z__DAJ9f2tI{width:570px;max-height:450px;min-height:32px}html[dir] ._1k-Sj8yLsi3Z__DAJ9f2tI{border-top-style:solid;border-top-width:1px;border-top-color:var(--neutralTertiaryAlt)}",""]),t.locals={divContainer:"_3F7No5-vgOr_1gVShb8FKf",contextualBar:"_1y-0qwR5zgpuliA8JB6xM7",selected:"_33_xr0gXDD45Clv45d4qXQ",appIcon:"_3adRMmoaOLq8VLnPxe75se",divider:"_3iCwtve60L8WT0WX--k1rG",contextualAddinFrame:"_1k-Sj8yLsi3Z__DAJ9f2tI"}},11817:function(e){e.exports=JSON.parse('{"a":"Apa"}')},11818:function(e,t,n){var r=n(11819);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11819:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._3106Csizi8Xl1uC4Cp6qZt{display:none}._3J20lApaq2RoI8AHAsB2a0{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none!important}html[dir] ._3J20lApaq2RoI8AHAsB2a0{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}",""]),t.locals={divContainer:"_3106Csizi8Xl1uC4Cp6qZt",dialogContainer:"_3J20lApaq2RoI8AHAsB2a0"}},11820:function(e){e.exports=JSON.parse('{"a":"Mna"}')},11821:function(e){e.exports=JSON.parse('{"d":"Nna","e":"Ona","a":"Pna","b":"Qna","c":"Rna"}')},11822:function(e,t,n){var r=n(11823);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11823:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._3hYVPKdL_gDWF2UwqSUbU3{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);height:100%;width:100%}html[dir] ._3hYVPKdL_gDWF2UwqSUbU3{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3-pDRLCXdBlXCkUNsVyCZ9{position:relative;top:25%}html[dir] ._3-pDRLCXdBlXCkUNsVyCZ9{text-align:center}._26iRE2rK2g3F3YXIuFvOFT{display:inline-block;font-size:80px;line-height:1;color:var(--themePrimary)}html[dir] ._26iRE2rK2g3F3YXIuFvOFT{text-align:center}.GAGCQ5XxN4Hn-8HZ01wvL{display:block;max-width:70%}html[dir] .GAGCQ5XxN4Hn-8HZ01wvL{margin:auto}._1_wc-D2kxoazOJ_Zo5UJCe{font-size:17px;font-weight:300;color:var(--neutralPrimary)}html[dir] ._1_wc-D2kxoazOJ_Zo5UJCe{padding-top:25px}._11JgUHpziPmZoOVeGG_-_o{font-size:12px;font-weight:400;color:var(--neutralSecondary)}html[dir] ._11JgUHpziPmZoOVeGG_-_o{padding-top:10px}",""]),t.locals={errorContainer:"_3hYVPKdL_gDWF2UwqSUbU3",errorContent:"_3-pDRLCXdBlXCkUNsVyCZ9",errorIcon:"_26iRE2rK2g3F3YXIuFvOFT",errorTextCommon:"GAGCQ5XxN4Hn-8HZ01wvL",errorTextTitle:"_1_wc-D2kxoazOJ_Zo5UJCe",errorTextDescription:"_11JgUHpziPmZoOVeGG_-_o"}},11824:function(e){e.exports=JSON.parse('{"a":"Zna"}')},11825:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._3bNB13myuKmraFS5CxX3G0,._2-vlK3DWF1SjScpxRhaDs6{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:70px}html[dir] ._3bNB13myuKmraFS5CxX3G0,html[dir] ._2-vlK3DWF1SjScpxRhaDs6{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white);padding:0 22px;padding-top:10px}._2-vlK3DWF1SjScpxRhaDs6{color:var(--white)}html[dir] ._2-vlK3DWF1SjScpxRhaDs6{background:var(--neutralPrimary)}._1okc9KHuDuunbb8xQaFCbM,._3HFwdH4W6Gzo_w9dGYIuFH{height:60px}html[dir] ._1okc9KHuDuunbb8xQaFCbM,html[dir] ._3HFwdH4W6Gzo_w9dGYIuFH{padding:0 32px;padding-top:10px}html[dir=ltr] ._1okc9KHuDuunbb8xQaFCbM,html[dir=ltr] ._3HFwdH4W6Gzo_w9dGYIuFH{padding-right:36px}html[dir=rtl] ._1okc9KHuDuunbb8xQaFCbM,html[dir=rtl] ._3HFwdH4W6Gzo_w9dGYIuFH{padding-left:36px}._3HFwdH4W6Gzo_w9dGYIuFH{color:var(--white)}html[dir] ._3HFwdH4W6Gzo_w9dGYIuFH{background:var(--neutralPrimary)}._1oECeTmItnfogBj-yeamnv,.VpPctziEkQJJeabd5mGn{position:static}html[dir=ltr] ._1oECeTmItnfogBj-yeamnv,html[dir=ltr] .VpPctziEkQJJeabd5mGn{margin-right:-10px;right:0}html[dir=rtl] ._1oECeTmItnfogBj-yeamnv,html[dir=rtl] .VpPctziEkQJJeabd5mGn{margin-left:-10px;left:0}.VpPctziEkQJJeabd5mGn,.VpPctziEkQJJeabd5mGn:hover{color:var(--neutralLight)}html[dir] .VpPctziEkQJJeabd5mGn:hover{background:var(--neutralSecondary)}._3groudcYC8jcSiZw5Ad4-1{font-size:32px;color:var(--neutralSecondary);width:32px;height:32px;min-width:32px}html[dir] ._3groudcYC8jcSiZw5Ad4-1{border:0;padding:0}html[dir=ltr] ._3groudcYC8jcSiZw5Ad4-1{float:left}html[dir=rtl] ._3groudcYC8jcSiZw5Ad4-1{float:right}._2JAfeDTkavnLRUWy3nA90H{color:var(--neutralTertiary)}._2wZg4lA-VTvN83vMcMQVky,._20CPc1b3rVkHhLtqZKlKYs{font-size:21px;font-weight:100;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:var(--neutralPrimary);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}html[dir=ltr] ._2wZg4lA-VTvN83vMcMQVky,html[dir=ltr] ._20CPc1b3rVkHhLtqZKlKYs{float:left;margin-left:8px}html[dir=rtl] ._2wZg4lA-VTvN83vMcMQVky,html[dir=rtl] ._20CPc1b3rVkHhLtqZKlKYs{float:right;margin-right:8px}._20CPc1b3rVkHhLtqZKlKYs{color:var(--neutralLight)}._25rcFFfuMbIvWlirsmK0ZL{text-overflow:ellipsis;overflow:hidden}._25rcFFfuMbIvWlirsmK0ZL,._2XiW2-N55kgJX4EDoCWOdV{white-space:nowrap}._3fyIyYEC-iB4hg32utLYh9{color:var(--neutralPrimary)}._3bTu0t8s5COM9ycP8QT4Dd,._3bTu0t8s5COM9ycP8QT4Dd:hover{color:var(--neutralLight)}html[dir] ._3bTu0t8s5COM9ycP8QT4Dd:hover{background:var(--neutralSecondary)}",""]),t.locals={addinPaneHeader:"_3bNB13myuKmraFS5CxX3G0",addinPaneHeaderDark:"_2-vlK3DWF1SjScpxRhaDs6",addinPaneHeaderCalendar:"_1okc9KHuDuunbb8xQaFCbM",addinPaneHeaderCalendarDark:"_3HFwdH4W6Gzo_w9dGYIuFH",closeButton:"_1oECeTmItnfogBj-yeamnv",closeButtonDark:"VpPctziEkQJJeabd5mGn",addinPaneIcon:"_3groudcYC8jcSiZw5Ad4-1",fallbackIcon:"_2JAfeDTkavnLRUWy3nA90H",addinPaneLabelText:"_2wZg4lA-VTvN83vMcMQVky",addinPaneLabelTextDark:"_20CPc1b3rVkHhLtqZKlKYs",ellipsis:"_25rcFFfuMbIvWlirsmK0ZL",rightButtons:"_2XiW2-N55kgJX4EDoCWOdV",persistIcon:"_3fyIyYEC-iB4hg32utLYh9",persistIconDark:"_3bTu0t8s5COM9ycP8QT4Dd"}},11826:function(e,t,n){var r=n(11827);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11827:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._1hfoY-_uFq-uQcU0EMOsGs,._3tVhwpMqDADdBtTK3uErKd{height:100%;overflow-y:hidden}._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-content,._3tVhwpMqDADdBtTK3uErKd .ms-Panel-content{height:calc(100vh - 50px);overflow-y:hidden}html[dir] ._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-content,html[dir] ._3tVhwpMqDADdBtTK3uErKd .ms-Panel-content{padding:0}html[dir] ._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-commands,html[dir] ._3tVhwpMqDADdBtTK3uErKd .ms-Panel-commands{margin-top:0!important;padding-top:0!important}._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-main,._3tVhwpMqDADdBtTK3uErKd .ms-Panel-main{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);top:48px;height:calc(100% - 48px);width:320px!important}html[dir] ._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-main,html[dir] ._3tVhwpMqDADdBtTK3uErKd .ms-Panel-main{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}html[dir=ltr] ._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-main,html[dir=ltr] ._3tVhwpMqDADdBtTK3uErKd .ms-Panel-main{left:calc(100vw - 322px)!important}html[dir=rtl] ._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-main,html[dir=rtl] ._3tVhwpMqDADdBtTK3uErKd .ms-Panel-main{right:calc(100vw - 322px)!important}._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-contentInner,._3tVhwpMqDADdBtTK3uErKd .ms-Panel-contentInner{height:100%}._3tVhwpMqDADdBtTK3uErKd .ms-Panel-content{height:calc(100vh - 2px)}._3tVhwpMqDADdBtTK3uErKd .ms-Panel-main{top:0;height:100%}.isShyHeaderMode._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-main,.isShyHeaderMode._3tVhwpMqDADdBtTK3uErKd .ms-Panel-main{top:8px;height:calc(100% - 8px)}.isShyHeaderMode._1hfoY-_uFq-uQcU0EMOsGs .ms-Panel-content,.isShyHeaderMode._3tVhwpMqDADdBtTK3uErKd .ms-Panel-content{height:calc(100vh - 10px)}._8eUzNEjNgK4VlLerns607 .ms-Panel-main{top:0;height:100%}",""]),t.locals={taskPane:"_1hfoY-_uFq-uQcU0EMOsGs",taskPaneInPopout:"_3tVhwpMqDADdBtTK3uErKd",taskPaneNoHeader:"_8eUzNEjNgK4VlLerns607"}},11828:function(e,t,n){var r=n(11829);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11829:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,".Pfd-IvGRjtMQLiG8ATORo{display:none}._1vjgJBU6asEidnh7Z9Gko9{width:100%;height:calc(100% - 80px)}._1zA5fXc39QLnP4XU_bgU8K{height:calc(100% - 70px)}._1fEzf3V7tGXXcDKQ3neR4r{display:block;top:0;width:100%;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box}._1fEzf3V7tGXXcDKQ3neR4r iframe{max-height:100%}._3C8lHSTTf5JcDtS9Vfmtft{display:none}",""]),t.locals={divContainer:"Pfd-IvGRjtMQLiG8ATORo",extensionContainer:"_1vjgJBU6asEidnh7Z9Gko9",extensionContainerCalendar:"_1zA5fXc39QLnP4XU_bgU8K",extensionHost:"_1fEzf3V7tGXXcDKQ3neR4r",hide:"_3C8lHSTTf5JcDtS9Vfmtft"}},11830:function(e,t,n){var r=n(11831);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11831:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,".VPu8CogSssJ9QIoV0gKGh{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);max-width:none}html[dir] .VPu8CogSssJ9QIoV0gKGh{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._3sqo8vPSIJMY1WssnZbfdA{height:190px}.yZO3zhyWOTV8cHVWiRgZ7{width:550px;height:400px}.PY1B1VhrGREKpsXHZ5fnS{display:none!important}",""]),t.locals={dialogContainer:"VPu8CogSssJ9QIoV0gKGh",uiLessContainer:"_3sqo8vPSIJMY1WssnZbfdA",consentContainer:"yZO3zhyWOTV8cHVWiRgZ7",hiddenContainer:"PY1B1VhrGREKpsXHZ5fnS"}},11832:function(e){e.exports=JSON.parse('{"b":"moa","a":"noa"}')},11833:function(e,t,n){var r=n(11834);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11834:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._12OR13Wyw32TWqVGoUFpTt{width:100%;height:100%}",""]),t.locals={uiLessContainer:"_12OR13Wyw32TWqVGoUFpTt"}},11835:function(e,t,n){var r=n(11836);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},11836:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,".ms-ContextualMenu-icon ._2QKC1FC0iB3iR4DOxwVSRM{position:relative;top:-8px}",""]),t.locals={fallbackIcon:"_2QKC1FC0iB3iR4DOxwVSRM"}},11837:function(e){e.exports=JSON.parse('{"a":"dna"}')},11862:function(e,t,n){"use strict";var r=n(1058),o=n(3);t.a=Object(o.mutatorAction)("showBccWell",e=>{e.bccRecipientWell||(e.bccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))})},11864:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.mutatorAction)("updateSubjectSelectionRange",(e,t,n)=>{e.selectionStart=t,e.selectionEnd=n})},11865:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("updateSubject")((function(e,t){e.subject=t,e.isDirty=!0}))},11867:function(e){e.exports=JSON.parse('{"a":"ama"}')},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"})},123:function(e,t,n){var r;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r)){if(r.length){var a=o.apply(null,r);a&&e.push(a)}}else if("object"===i)if(r.toString===Object.prototype.toString)for(var s in r)n.call(r,s)&&r[s]&&e.push(s);else e.push(r.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},1261:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,".w_jrWE2b2u-icz2udikRM{display:inline-block;vertical-align:middle;width:1em;height:1em}._9fiU2J67uJPVP0DBdOFMW{height:100%;width:100%;fill:currentColor;vertical-align:top}",""]),t.locals={root:"w_jrWE2b2u-icz2udikRM",svg:"_9fiU2J67uJPVP0DBdOFMW"}},1264:function(e,t,n){"use strict";var r=n(1),o=n(0),i=n(298),a=n(398),s=n(507),c=n(8),u=n(127),l=n(297),d=n(365),f=Object(u.c)((function(e,t){var n,r=Object(l.a)(e),o=Object(d.a)(e),i=e.palette,a={root:{padding:"0 4px",width:"32px",height:"32px",backgroundColor:"transparent",border:"none",color:e.semanticColors.link},rootHovered:{color:i.themeDarkAlt,backgroundColor:i.neutralLighter,selectors:(n={},n[c.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},n)},rootHasMenu:{width:"auto"},rootPressed:{color:i.themeDark,backgroundColor:i.neutralLight},rootExpanded:{color:i.themeDark,backgroundColor:i.neutralLight},rootChecked:{color:i.themeDark,backgroundColor:i.neutralLight},rootCheckedHovered:{color:i.themeDark,backgroundColor:i.neutralQuaternaryAlt},rootDisabled:{color:i.neutralTertiaryAlt}};return Object(c.concatStyleSets)(r,a,o,t)}));n.d(t,"a",(function(){return p}));var p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:"ms-Button--icon",styles:f(n,t),onRenderText:a.b,onRenderDescription:a.b}))},t=Object(r.__decorate)([Object(s.a)("IconButton",["theme","styles"],!0)],t)}(o.Component)},1273:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._25ze_o-znWjnejUUg1ACjA,._19iPqSlL3Vjrsp-9gP2AKO{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:18px;white-space:nowrap;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._25ze_o-znWjnejUUg1ACjA,html[dir] ._19iPqSlL3Vjrsp-9gP2AKO{border-radius:2px;border-style:solid;border-width:1px}._1h-t7MyMsB55cSlMlxzQd_{max-width:120px}.ezQ406xK8pzbng1ctlarI{max-width:140px}._3kxVariWON2BfY9cuXI9DZ{width:20px;height:18px;font-size:12px}html[dir=ltr] ._25ze_o-znWjnejUUg1ACjA{margin-right:4px}html[dir=rtl] ._25ze_o-znWjnejUUg1ACjA{margin-left:4px}html[dir=ltr] ._19iPqSlL3Vjrsp-9gP2AKO{margin-right:0}html[dir=rtl] ._19iPqSlL3Vjrsp-9gP2AKO{margin-left:0}._38cj5c1v7cfJEtyTG1y7h5{font-size:12px;font-weight:400;max-width:120px;overflow:hidden;line-height:17px;display:inline-block;text-overflow:ellipsis}html[dir] ._38cj5c1v7cfJEtyTG1y7h5{text-align:center;padding-bottom:1px}html[dir=ltr] ._38cj5c1v7cfJEtyTG1y7h5,html[dir=rtl] ._38cj5c1v7cfJEtyTG1y7h5{padding-right:4px;padding-left:4px}._38cj5c1v7cfJEtyTG1y7h5._3p7BYdc2gA26GB9CVqIfNs{font-size:12px}._38cj5c1v7cfJEtyTG1y7h5._2wVQtKgpf9u4-693Hi1GmQ,._38cj5c1v7cfJEtyTG1y7h5._1txDAred1dB6GvsrY8sF9z{font-size:11px}",""]),t.locals={categoryContainer:"_25ze_o-znWjnejUUg1ACjA",lastCategoryContainer:"_19iPqSlL3Vjrsp-9gP2AKO",categoryMaxWidth:"_1h-t7MyMsB55cSlMlxzQd_",categoryMaxWidthWithButton:"ezQ406xK8pzbng1ctlarI",removeCategoryButton:"_3kxVariWON2BfY9cuXI9DZ",categoryName:"_38cj5c1v7cfJEtyTG1y7h5",full:"_3p7BYdc2gA26GB9CVqIfNs",compact:"_2wVQtKgpf9u4-693Hi1GmQ",medium:"_1txDAred1dB6GvsrY8sF9z"}},1274:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._2rOmvPZ6n7ldyvn70IZAOa{max-height:436px}",""]),t.locals={categoryMenu:"_2rOmvPZ6n7ldyvn70IZAOa"}},1275:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._3IVidJ3ki9zBNjZWIt61cG._2hf4-VuN5x5_JjBPdVwf_G{font-size:20px}._3IVidJ3ki9zBNjZWIt61cG._1UpjFqJSNQPnBkilWyzpo-,._3IVidJ3ki9zBNjZWIt61cG._2Zl6MwQ_YLBxAw_4tBB9Sh{font-size:16px}",""]),t.locals={categorySize:"_3IVidJ3ki9zBNjZWIt61cG",full:"_2hf4-VuN5x5_JjBPdVwf_G",compact:"_1UpjFqJSNQPnBkilWyzpo-",medium:"_2Zl6MwQ_YLBxAw_4tBB9Sh"}},128:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(5),o=n(120),i=n(11);function a(){const e=Object(o.a)("DefaultAnchorMailbox");return null==e||0==e.trim().length||function(){const e=Object(r.d)(Object(i.a)().location);return Object.keys(e).indexOf("anonRetry")>=0}()}function s(){const e=Object(r.d)(Object(i.a)().location);return Object.keys(e).indexOf("anonymous")>=0}},1285:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.Observable=void 0;var a=function(){return"function"==typeof Symbol},s=function(e){return a()&&Boolean(Symbol[e])},c=function(e){return s(e)?Symbol[e]:"@@"+e};a()&&!s("observable")&&(Symbol.observable=Symbol("observable"));var u=c("iterator"),l=c("observable"),d=c("species");function f(e,t){var n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function p(e){var t=e.constructor;return void 0!==t&&null===(t=t[d])&&(t=void 0),void 0!==t?t:A}function m(e){return e instanceof A}function h(e){h.log?h.log(e):setTimeout((function(){throw e}))}function g(e){Promise.resolve().then((function(){try{e()}catch(e){h(e)}}))}function v(e){var t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{var n=f(t,"unsubscribe");n&&n.call(t)}}catch(e){h(e)}}function y(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function b(e,t,n){e._state="running";var r=e._observer;try{var o=f(r,t);switch(t){case"next":o&&o.call(r,n);break;case"error":if(y(e),!o)throw n;o.call(r,n);break;case"complete":y(e),o&&o.call(r)}}catch(e){h(e)}"closed"===e._state?v(e):"running"===e._state&&(e._state="ready")}function O(e,t,n){if("closed"!==e._state){if("buffering"!==e._state)return"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void g((function(){return function(e){var t=e._queue;if(t){e._queue=void 0,e._state="ready";for(var n=0;n<t.length&&(b(e,t[n].type,t[n].value),"closed"!==e._state);++n);}}(e)}))):void b(e,t,n);e._queue.push({type:t,value:n})}}var S=function(){function e(t,n){r(this,e),this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";var o=new C(this);try{this._cleanup=n.call(void 0,o)}catch(e){o.error(e)}"initializing"===this._state&&(this._state="ready")}return i(e,[{key:"unsubscribe",value:function(){"closed"!==this._state&&(y(this),v(this))}},{key:"closed",get:function(){return"closed"===this._state}}]),e}(),C=function(){function e(t){r(this,e),this._subscription=t}return i(e,[{key:"next",value:function(e){O(this._subscription,"next",e)}},{key:"error",value:function(e){O(this._subscription,"error",e)}},{key:"complete",value:function(){O(this._subscription,"complete")}},{key:"closed",get:function(){return"closed"===this._subscription._state}}]),e}(),A=function(){function e(t){if(r(this,e),!(this instanceof e))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof t)throw new TypeError("Observable initializer must be a function");this._subscriber=t}return i(e,[{key:"subscribe",value:function(e){return"object"==typeof e&&null!==e||(e={next:e,error:arguments[1],complete:arguments[2]}),new S(e,this._subscriber)}},{key:"forEach",value:function(e){var t=this;return new Promise((function(n,r){if("function"==typeof e)var o=t.subscribe({next:function(t){try{e(t,i)}catch(e){r(e),o.unsubscribe()}},error:r,complete:n});else r(new TypeError(e+" is not a function"));function i(){o.unsubscribe(),n()}}))}},{key:"map",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))((function(n){return t.subscribe({next:function(t){try{t=e(t)}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"filter",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(p(this))((function(n){return t.subscribe({next:function(t){try{if(!e(t))return}catch(e){return n.error(e)}n.next(t)},error:function(e){n.error(e)},complete:function(){n.complete()}})}))}},{key:"reduce",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=p(this),r=arguments.length>1,o=!1,i=arguments[1],a=i;return new n((function(n){return t.subscribe({next:function(t){var i=!o;if(o=!0,!i||r)try{a=e(a,t)}catch(e){return n.error(e)}else a=t},error:function(e){n.error(e)},complete:function(){if(!o&&!r)return n.error(new TypeError("Cannot reduce an empty sequence"));n.next(a),n.complete()}})}))}},{key:"concat",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o=p(this);return new o((function(t){var r,i=0;return function e(a){r=a.subscribe({next:function(e){t.next(e)},error:function(e){t.error(e)},complete:function(){i===n.length?(r=void 0,t.complete()):e(o.from(n[i++]))}})}(e),function(){r&&(r.unsubscribe(),r=void 0)}}))}},{key:"flatMap",value:function(e){var t=this;if("function"!=typeof e)throw new TypeError(e+" is not a function");var n=p(this);return new n((function(r){var o=[],i=t.subscribe({next:function(t){if(e)try{t=e(t)}catch(e){return r.error(e)}var i=n.from(t).subscribe({next:function(e){r.next(e)},error:function(e){r.error(e)},complete:function(){var e=o.indexOf(i);e>=0&&o.splice(e,1),a()}});o.push(i)},error:function(e){r.error(e)},complete:function(){a()}});function a(){i.closed&&0===o.length&&r.complete()}return function(){o.forEach((function(e){return e.unsubscribe()})),i.unsubscribe()}}))}},{key:l,value:function(){return this}}],[{key:"from",value:function(t){var n="function"==typeof this?this:e;if(null==t)throw new TypeError(t+" is not an object");var r=f(t,l);if(r){var o=r.call(t);if(Object(o)!==o)throw new TypeError(o+" is not an object");return m(o)&&o.constructor===n?o:new n((function(e){return o.subscribe(e)}))}if(s("iterator")&&(r=f(t,u)))return new n((function(e){g((function(){if(!e.closed){var n=!0,o=!1,i=void 0;try{for(var a,s=r.call(t)[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){var c=a.value;if(e.next(c),e.closed)return}}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}e.complete()}}))}));if(Array.isArray(t))return new n((function(e){g((function(){if(!e.closed){for(var n=0;n<t.length;++n)if(e.next(t[n]),e.closed)return;e.complete()}}))}));throw new TypeError(t+" is not observable")}},{key:"of",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var o="function"==typeof this?this:e;return new o((function(e){g((function(){if(!e.closed){for(var t=0;t<n.length;++t)if(e.next(n[t]),e.closed)return;e.complete()}}))}))}},{key:d,get:function(){return this}}]),e}();t.Observable=A,a()&&Object.defineProperty(A,Symbol("extensions"),{value:{symbol:l,hostReportError:h},configurable:!0})},1286:function(e,t,n){"use strict";(function(e,t){var r,o=n(1069);r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:t;Object(o.a)(r)}).call(this,n(190),n(709)(e))},1287:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(439);function o(e){return new r.a((function(t){t.error(e)}))}},1288:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n.n(r),i=n(68),a=n(723),s=function(e){var t=e.client,n=e.children,r=Object(a.a)();return o.a.createElement(r.Consumer,null,(function(e){return void 0===e&&(e={}),t&&e.client!==t&&(e=Object.assign({},e,{client:t})),Object(i.b)(e.client,28),o.a.createElement(r.Provider,{value:e},n)}))}},1289:function(e,t,n){"use strict";var r=n(25),o=n(300),i=n(831),a=n(630),s=n(250),c=n(1593),u=n(68),l=n(496),d=n(586),f=n(1307),p=n(1306),m=n(212);var h,g,v=n(1113),y=n(187),b=Object.create(null),O=function(){return b},S=Object.create(null),C=function(){function e(e,t){var n=this;this.policies=e,this.group=t,this.data=Object.create(null),this.rootIds=Object.create(null),this.refs=Object.create(null),this.getFieldValue=function(e,t){return Object(s.f)(e)?n.get(e.__ref,t):e&&e[t]},this.canRead=function(e){return Object(s.f)(e)?n.has(e.__ref):"object"==typeof e},this.toReference=function(e,t){if("string"==typeof e)return Object(s.g)(e);if(Object(s.f)(e))return e;var r=n.policies.identify(e)[0];if(r){var o=Object(s.g)(r);return t&&n.merge(r,e),o}}}return e.prototype.toObject=function(){return Object(r.a)({},this.data)},e.prototype.has=function(e){return void 0!==this.lookup(e,!0)},e.prototype.get=function(e,t){if(this.group.depend(e,t),y.c.call(this.data,e)){var n=this.data[e];if(n&&y.c.call(n,t))return n[t]}return"__typename"===t&&y.c.call(this.policies.rootTypenamesById,e)?this.policies.rootTypenamesById[e]:this instanceof I?this.parent.get(e,t):void 0},e.prototype.lookup=function(e,t){return t&&this.group.depend(e,"__exists"),y.c.call(this.data,e)?this.data[e]:this instanceof I?this.parent.lookup(e,t):this.policies.rootTypenamesById[e]?Object.create(null):void 0},e.prototype.merge=function(e,t){var n=this,r=this.lookup(e),o=new p.a(x).merge(r,t);if(this.data[e]=o,o!==r&&(delete this.refs[e],this.group.caching)){var i=Object.create(null);r||(i.__exists=1),Object.keys(t).forEach((function(e){if(!r||r[e]!==o[e]){i[e]=1;var t=Object(y.b)(e);t===e||n.policies.hasKeyArgs(o.__typename,t)||(i[t]=1),void 0!==o[e]||n instanceof I||delete o[e]}})),Object.keys(i).forEach((function(t){return n.group.dirty(e,t)}))}},e.prototype.modify=function(e,t){var n=this,o=this.lookup(e);if(o){var i=Object.create(null),a=!1,c=!0,u={DELETE:b,INVALIDATE:S,isReference:s.f,toReference:this.toReference,canRead:this.canRead,readField:function(t,r){return n.policies.readField("string"==typeof t?{fieldName:t,from:r||Object(s.g)(e)}:t,{store:n})}};if(Object.keys(o).forEach((function(s){var l=Object(y.b)(s),d=o[s];if(void 0!==d){var f="function"==typeof t?t:t[s]||t[l];if(f){var p=f===O?b:f(d,Object(r.a)(Object(r.a)({},u),{fieldName:l,storeFieldName:s,storage:n.getStorage(e,s)}));p===S?n.group.dirty(e,s):(p===b&&(p=void 0),p!==d&&(i[s]=p,a=!0,d=p))}void 0!==d&&(c=!1)}})),a)return this.merge(e,i),c&&(this instanceof I?this.data[e]=void 0:delete this.data[e],this.group.dirty(e,"__exists")),!0}return!1},e.prototype.delete=function(e,t,n){var r,o=this.lookup(e);if(o){var i=this.getFieldValue(o,"__typename"),a=t&&n?this.policies.getStoreFieldName({typename:i,fieldName:t,args:n}):t;return this.modify(e,a?((r={})[a]=O,r):O)}return!1},e.prototype.evict=function(e){var t=!1;return e.id&&(y.c.call(this.data,e.id)&&(t=this.delete(e.id,e.fieldName,e.args)),this instanceof I&&(t=this.parent.evict(e)||t),(e.fieldName||t)&&this.group.dirty(e.id,e.fieldName||"__exists")),t},e.prototype.clear=function(){this.replace(null)},e.prototype.extract=function(){var e=this,t=this.toObject(),n=[];return this.getRootIdSet().forEach((function(t){y.c.call(e.policies.rootTypenamesById,t)||n.push(t)})),n.length&&(t.__META={extraRootIds:n.sort()}),t},e.prototype.replace=function(e){var t=this;if(Object.keys(this.data).forEach((function(n){e&&y.c.call(e,n)||t.delete(n)})),e){var n=e.__META,o=Object(r.e)(e,["__META"]);Object.keys(o).forEach((function(e){t.merge(e,o[e])})),n&&n.extraRootIds.forEach(this.retain,this)}},e.prototype.retain=function(e){return this.rootIds[e]=(this.rootIds[e]||0)+1},e.prototype.release=function(e){if(this.rootIds[e]>0){var t=--this.rootIds[e];return t||delete this.rootIds[e],t}return 0},e.prototype.getRootIdSet=function(e){return void 0===e&&(e=new Set),Object.keys(this.rootIds).forEach(e.add,e),this instanceof I?this.parent.getRootIdSet(e):Object.keys(this.policies.rootTypenamesById).forEach(e.add,e),e},e.prototype.gc=function(){var e=this,t=this.getRootIdSet(),n=this.toObject();t.forEach((function(r){y.c.call(n,r)&&(Object.keys(e.findChildRefIds(r)).forEach(t.add,t),delete n[r])}));var r=Object.keys(n);if(r.length){for(var o=this;o instanceof I;)o=o.parent;r.forEach((function(e){return o.delete(e)}))}return r},e.prototype.findChildRefIds=function(e){if(!y.c.call(this.refs,e)){var t=this.refs[e]=Object.create(null),n=new Set([this.data[e]]),r=function(e){return null!==e&&"object"==typeof e};n.forEach((function(e){Object(s.f)(e)?t[e.__ref]=!0:r(e)&&Object.values(e).filter(r).forEach(n.add,n)}))}return this.refs[e]},e.prototype.makeCacheKey=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.group.keyMaker.lookupArray(e)},e}(),A=function(){function e(e){this.caching=e,this.d=null,this.keyMaker=new o.a(v.a),this.d=e?Object(o.b)():null}return e.prototype.depend=function(e,t){if(this.d){this.d(_(e,t));var n=Object(y.b)(t);n!==t&&this.d(_(e,n))}},e.prototype.dirty=function(e,t){this.d&&this.d.dirty(_(e,t))},e}();function _(e,t){return t+"#"+e}h=C||(C={}),g=function(e){function t(t){var n=t.policies,r=t.resultCaching,i=void 0===r||r,a=t.seed,s=e.call(this,n,new A(i))||this;return s.storageTrie=new o.a(v.a),s.sharedLayerGroup=new A(i),a&&s.replace(a),s}return Object(r.c)(t,e),t.prototype.addLayer=function(e,t){return new I(e,this,t,this.sharedLayerGroup)},t.prototype.removeLayer=function(){return this},t.prototype.getStorage=function(){return this.storageTrie.lookupArray(arguments)},t}(h),h.Root=g;var I=function(e){function t(t,n,r,o){var i=e.call(this,n.policies,o)||this;return i.id=t,i.parent=n,i.replay=r,i.group=o,r(i),i}return Object(r.c)(t,e),t.prototype.addLayer=function(e,n){return new t(e,this,n,this.group)},t.prototype.removeLayer=function(e){var t=this,n=this.parent.removeLayer(e);return e===this.id?(this.group.caching&&Object.keys(this.data).forEach((function(e){t.data[e]!==n.lookup(e)&&t.delete(e)})),n):n===this.parent?this:n.addLayer(this.id,this.replay)},t.prototype.toObject=function(){return Object(r.a)(Object(r.a)({},this.parent.toObject()),this.data)},t.prototype.findChildRefIds=function(t){var n=this.parent.findChildRefIds(t);return y.c.call(this.data,t)?Object(r.a)(Object(r.a)({},n),e.prototype.findChildRefIds.call(this,t)):n},t.prototype.getStorage=function(){for(var e=this.parent;e.parent;)e=e.parent;return e.getStorage.apply(e,arguments)},t}(C);function x(e,t,n){var r=e[n],o=t[n];return Object(m.a)(r,o)?r:o}function E(e){return!!(e instanceof C&&e.group.caching)}function T(e,t){return new a.a(e.message,t.path.slice(),t.query,t.clientOnly,t.variables)}var w=function(){function e(e){var t=this;this.config=e,this.executeSelectionSet=Object(o.c)((function(e){return t.execSelectionSetImpl(e)}),{keyArgs:function(e){return[e.selectionSet,e.objectOrReference,e.context]},makeCacheKey:function(e,t,n){if(E(n.store))return n.store.makeCacheKey(e,Object(s.f)(t)?t.__ref:t,n.varString)}}),this.knownResults=new WeakMap,this.executeSubSelectedArray=Object(o.c)((function(e){return t.execSubSelectedArrayImpl(e)}),{makeCacheKey:function(e){var t=e.field,n=e.array,r=e.context;if(E(r.store))return r.store.makeCacheKey(t,n,r.varString)}}),this.config=Object(r.a)({addTypename:!0},e)}return e.prototype.diffQueryAgainstStore=function(e){var t=e.store,n=e.query,o=e.rootId,i=void 0===o?"ROOT_QUERY":o,a=e.variables,c=e.returnPartialData,u=void 0===c||c,f=this.config.cache.policies;a=Object(r.a)(Object(r.a)({},Object(l.b)(Object(l.h)(n))),a);var p=this.executeSelectionSet({selectionSet:Object(l.e)(n).selectionSet,objectOrReference:Object(s.g)(i),context:{store:t,query:n,policies:f,variables:a,varString:JSON.stringify(a),fragmentMap:Object(d.a)(Object(l.d)(n)),path:[],clientOnly:!1}}),m=p.missing&&p.missing.length>0;if(m&&!u)throw p.missing[0];return{result:p.result,missing:p.missing,complete:!m}},e.prototype.isFresh=function(e,t,n,r){if(E(r.store)&&this.knownResults.get(e)===n){var o=this.executeSelectionSet.peek(n,t,r);if(o&&e===o.result)return!0}return!1},e.prototype.execSelectionSetImpl=function(e){var t=this,n=e.selectionSet,r=e.objectOrReference,o=e.context;if(Object(s.f)(r)&&!o.policies.rootTypenamesById[r.__ref]&&!o.store.has(r.__ref))return{result:{},missing:[T(new u.a(4),o)]};var i=o.variables,a=o.policies,l=o.store,m=[],h={result:null},g=l.getFieldValue(r,"__typename");function v(){return h.missing||(h.missing=[])}function y(e){var t;return e.missing&&(t=v()).push.apply(t,e.missing),e.result}this.config.addTypename&&"string"==typeof g&&!a.rootIdsByTypename[g]&&m.push({__typename:g});var b=new Set(n.selections);return b.forEach((function(e){var n;if(Object(f.c)(e,i))if(Object(s.d)(e)){var l=a.readField({fieldName:e.name.value,field:e,variables:o.variables,from:r},o),p=Object(s.h)(e);o.path.push(p);var h=o.clientOnly;o.clientOnly=h||!(!e.directives||!e.directives.some((function(e){return"client"===e.name.value}))),void 0===l?c.a.added(e)||v().push(T(new u.a(5),o)):Array.isArray(l)?l=y(t.executeSubSelectedArray({field:e,array:l,context:o})):e.selectionSet&&null!=l&&(l=y(t.executeSelectionSet({selectionSet:e.selectionSet,objectOrReference:l,context:o}))),void 0!==l&&m.push(((n={})[p]=l,n)),o.clientOnly=h,Object(u.b)(o.path.pop()===p)}else{var O=Object(d.b)(e,o.fragmentMap);O&&a.fragmentMatches(O,g)&&O.selectionSet.selections.forEach(b.add,b)}})),h.result=Object(p.c)(m),this.knownResults.set(h.result,n),h},e.prototype.execSubSelectedArrayImpl=function(e){var t,n=this,r=e.field,o=e.array,i=e.context;function a(e,n){return e.missing&&(t=t||[]).push.apply(t,e.missing),Object(u.b)(i.path.pop()===n),e.result}return r.selectionSet&&(o=o.filter(i.store.canRead)),{result:o=o.map((function(e,t){return null===e?null:(i.path.push(t),Array.isArray(e)?a(n.executeSubSelectedArray({field:r,array:e,context:i}),t):r.selectionSet?a(n.executeSelectionSet({selectionSet:r.selectionSet,objectOrReference:e,context:i}),t):(Object(u.b)(i.path.pop()===t),e))})),missing:t}},e}();var M=function(){function e(e,t){this.cache=e,this.reader=t}return e.prototype.writeToStore=function(e){var t=e.query,n=e.result,o=e.dataId,i=e.store,a=e.variables,c=Object(l.f)(t),f=Object(y.d)();a=Object(r.a)(Object(r.a)({},Object(l.b)(c)),a);var p=this.processSelectionSet({result:n||Object.create(null),dataId:o,selectionSet:c.selectionSet,mergeTree:{map:new Map},context:{store:i,written:Object.create(null),merge:function(e,t){return f.merge(e,t)},variables:a,varString:JSON.stringify(a),fragmentMap:Object(d.a)(Object(l.d)(t))}});if(!Object(s.f)(p))throw new u.a(7);return i.retain(p.__ref),p},e.prototype.processSelectionSet=function(e){var t=this,n=e.dataId,r=e.result,o=e.selectionSet,i=e.context,a=e.mergeTree,c=this.cache.policies,l=c.identify(r,o,i.fragmentMap),p=l[0],m=l[1];if("string"==typeof(n=n||p)){var h=i.written[n]||(i.written[n]=[]),g=Object(s.g)(n);if(h.indexOf(o)>=0)return g;if(h.push(o),this.reader&&this.reader.isFresh(r,g,o,i))return g}var v=Object.create(null);m&&(v=i.merge(v,m));var y=n&&c.rootTypenamesById[n]||Object(s.c)(r,o,i.fragmentMap)||n&&i.store.get(n,"__typename");"string"==typeof y&&(v.__typename=y);var b=new Set(o.selections);if(b.forEach((function(e){var n;if(Object(f.c)(e,i.variables))if(Object(s.d)(e)){var o=Object(s.h)(e),l=r[o];if(void 0!==l){var p=c.getStoreFieldName({typename:y,fieldName:e.name.value,field:e,variables:i.variables}),m=j(a,p),h=t.processFieldValue(l,e,i,m),g=e.selectionSet&&i.store.getFieldValue(h,"__typename")||void 0,O=c.getMergeFunction(y,e.name.value,g);O?m.info={field:e,typename:y,merge:O}:P(a,p),v=i.merge(v,((n={})[p]=h,n))}else if(c.usingPossibleTypes&&!Object(f.b)(["defer","client"],e))throw new u.a(8)}else{var S=Object(d.b)(e,i.fragmentMap);S&&c.fragmentMatches(S,y,r,i.variables)&&S.selectionSet.selections.forEach(b.add,b)}})),"string"==typeof n){var O=Object(s.g)(n);return a.map.size&&(v=this.applyMerges(a,O,v,i)),i.store.merge(n,v),O}return v},e.prototype.processFieldValue=function(e,t,n,r){var o=this;return t.selectionSet&&null!==e?Array.isArray(e)?e.map((function(e,i){var a=o.processFieldValue(e,t,n,j(r,i));return P(r,i),a})):this.processSelectionSet({result:e,selectionSet:t.selectionSet,context:n,mergeTree:r}):e},e.prototype.applyMerges=function(e,t,n,o,i){var a,c=this;if(e.map.size&&!Object(s.f)(n)){var l,d=Array.isArray(n)||!Object(s.f)(t)&&!Object(y.f)(t)?void 0:t,f=n;d&&!i&&(i=[Object(s.f)(d)?d.__ref:d]);var p=function(e,t){return Array.isArray(e)?"number"==typeof t?e[t]:void 0:o.store.getFieldValue(e,String(t))};e.map.forEach((function(e,t){i&&i.push(t);var n=p(d,t),r=p(f,t),a=c.applyMerges(e,n,r,o,i);a!==r&&(l=l||new Map).set(t,a),i&&Object(u.b)(i.pop()===t)})),l&&(n=Array.isArray(f)?f.slice(0):Object(r.a)({},f),l.forEach((function(e,t){n[t]=e})))}return e.info?this.cache.policies.runMergeFunction(t,n,e.info,o,i&&(a=o.store).getStorage.apply(a,i)):n},e}(),k=[];function j(e,t){var n=e.map;return n.has(t)||n.set(t,k.pop()||{map:new Map}),n.get(t)}function P(e,t){var n=e.map,r=n.get(t);!r||r.info||r.map.size||(k.push(r),n.delete(t))}new Set;var R=n(525),N=n(737);n.d(t,"a",(function(){return F}));var D={dataIdFromObject:N.b,addTypename:!0,resultCaching:!0,typePolicies:{}},F=function(e){function t(t){void 0===t&&(t={});var n=e.call(this)||this;return n.watches=new Set,n.typenameDocumentCache=new Map,n.makeVar=R.c,n.txCount=0,n.maybeBroadcastWatch=Object(o.c)((function(e,t){return n.broadcastWatch.call(n,e,!!t)}),{makeCacheKey:function(e){var t=e.optimistic?n.optimisticData:n.data;if(E(t)){var r=e.optimistic,o=e.rootId,i=e.variables;return t.makeCacheKey(e.query,e.callback,JSON.stringify({optimistic:r,rootId:o,variables:i}))}}}),n.watchDep=Object(o.b)(),n.config=Object(r.a)(Object(r.a)({},D),t),n.addTypename=!!n.config.addTypename,n.policies=new N.a({cache:n,dataIdFromObject:n.config.dataIdFromObject,possibleTypes:n.config.possibleTypes,typePolicies:n.config.typePolicies}),n.data=new C.Root({policies:n.policies,resultCaching:n.config.resultCaching}),n.optimisticData=n.data,n.storeWriter=new M(n,n.storeReader=new w({cache:n,addTypename:n.addTypename})),n}return Object(r.c)(t,e),t.prototype.restore=function(e){return e&&this.data.replace(e),this},t.prototype.extract=function(e){return void 0===e&&(e=!1),(e?this.optimisticData:this.data).extract()},t.prototype.read=function(e){var t=e.returnPartialData,n=void 0!==t&&t;try{return this.storeReader.diffQueryAgainstStore({store:e.optimistic?this.optimisticData:this.data,query:e.query,variables:e.variables,rootId:e.rootId,config:this.config,returnPartialData:n}).result||null}catch(e){if(e instanceof a.a)return null;throw e}},t.prototype.write=function(e){try{return++this.txCount,this.storeWriter.writeToStore({store:this.data,query:e.query,result:e.result,dataId:e.dataId,variables:e.variables})}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.modify=function(e){if(y.c.call(e,"id")&&!e.id)return!1;var t=e.optimistic?this.optimisticData:this.data;try{return++this.txCount,t.modify(e.id||"ROOT_QUERY",e.fields)}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.diff=function(e){return this.storeReader.diffQueryAgainstStore({store:e.optimistic?this.optimisticData:this.data,rootId:e.id||"ROOT_QUERY",query:e.query,variables:e.variables,returnPartialData:e.returnPartialData,config:this.config})},t.prototype.watch=function(e){var t=this;return this.watches.size||Object(R.d)(this),this.watches.add(e),e.immediate&&this.maybeBroadcastWatch(e),function(){t.watches.delete(e)&&!t.watches.size&&Object(R.b)(t),t.watchDep.dirty(e),t.maybeBroadcastWatch.forget(e)}},t.prototype.gc=function(){return this.optimisticData.gc()},t.prototype.retain=function(e,t){return(t?this.optimisticData:this.data).retain(e)},t.prototype.release=function(e,t){return(t?this.optimisticData:this.data).release(e)},t.prototype.identify=function(e){return Object(s.f)(e)?e.__ref:this.policies.identify(e)[0]},t.prototype.evict=function(e){if(!e.id){if(y.c.call(e,"id"))return!1;e=Object(r.a)(Object(r.a)({},e),{id:"ROOT_QUERY"})}try{return++this.txCount,this.optimisticData.evict(e)}finally{--this.txCount||!1===e.broadcast||this.broadcastWatches()}},t.prototype.reset=function(){return this.data.clear(),this.optimisticData=this.data,this.broadcastWatches(),Promise.resolve()},t.prototype.removeOptimistic=function(e){var t=this.optimisticData.removeLayer(e);t!==this.optimisticData&&(this.optimisticData=t,this.broadcastWatches())},t.prototype.performTransaction=function(e,t){var n=this,r=function(t){var r=n,o=r.data,i=r.optimisticData;++n.txCount,t&&(n.data=n.optimisticData=t);try{e(n)}finally{--n.txCount,n.data=o,n.optimisticData=i}},o=!1;"string"==typeof t?(this.optimisticData=this.optimisticData.addLayer(t,r),o=!0):null===t?r(this.data):r(),this.broadcastWatches(o)},t.prototype.transformDocument=function(e){if(this.addTypename){var t=this.typenameDocumentCache.get(e);return t||(t=Object(c.a)(e),this.typenameDocumentCache.set(e,t),this.typenameDocumentCache.set(t,t)),t}return e},t.prototype.broadcastWatches=function(e){var t=this;this.txCount||this.watches.forEach((function(n){return t.maybeBroadcastWatch(n,e)}))},t.prototype.broadcastWatch=function(e,t){this.watchDep.dirty(e),this.watchDep(e);var n=this.diff({query:e.query,variables:e.variables,optimistic:e.optimistic});e.optimistic&&t&&(n.fromOptimisticTransaction=!0),e.callback(n)},t}(i.a)},1303:function(e,t,n){"use strict";var r=n(0),o=n(209),i=n(317),a=n(441),s=n(115),c=n(488),u=n(489),l=n(149),d=0,f={reset:function(){s.b.getInstance().onReset((function(){return d++}))},getId:function(){return d},renderStyles:function(e,t){return Object(c.a)(Array.isArray(e)?e:[e],t)},renderFontFace:function(e,t){return Object(u.a)(e)},renderKeyframes:function(e){return Object(l.a)(e)}},p=function(e,t){for(var n=0,r=t;n<r.length;n++){var o=r[n];if(!(e=e.get(o)))return}return e},m=function(e,t,n){for(var r=0;r<t.length-1;r++){var o=t[r],i=e.get(o);i||(i=new Map,e.set(o,i)),e=i}e.set(t[t.length-1],n)};var h,g,v=(h=function(e){var t=e.semanticColors,n=e.fonts;return{body:[{color:t.bodyText,background:t.bodyBackground,fontFamily:n.medium.fontFamily,fontWeight:n.medium.fontWeight,fontSize:n.medium.fontSize,MozOsxFontSmoothing:n.medium.MozOsxFontSmoothing,WebkitFontSmoothing:n.medium.WebkitFontSmoothing}]}},g=new Map,function(e){void 0===e&&(e={});var t=e.theme,n=Object(i.d)(),r=Object(a.a)();t=t||r;var o=f.getId(),s="function"==typeof h,c=s?[o,n,t]:[o,n],u=p(g,c);if(!u){var l=s?h(t):h;u=f.renderStyles(l,{targetWindow:n,rtl:!!t.rtl}),m(g,c,u)}return u});function y(e){var t=v(e),n=e.className,a=e.applyTo;!function(e,t){var n,o="body"===e.applyTo,a=null===(n=Object(i.c)())||void 0===n?void 0:n.body;r.useEffect((function(){if(o&&a){for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&a.classList.add(r)}return function(){if(o&&a)for(var e=0,n=t;e<n.length;e++){var r=n[e];r&&a.classList.remove(r)}}}}),[o,a,t])}(e,[t.root,t.body]),e.className=Object(o.a)(n,t.root,"element"===a&&t.body)}var b=n(1),O=n(754),S=n(205),C=n(222),A=n(442),_=function(e){var t=e.theme,n=e.customizerContext,o=e.as||"div",i="string"==typeof e.as?Object(O.a)(e.as,e):Object(S.d)(e,["as"]);return r.createElement(A.a.Provider,{value:t},r.createElement(C.a.Provider,{value:n},r.createElement(o,Object(b.__assign)({},i))))},I=n(644),x=n(220),E=new Map,T=function(e){var t=e.theme,n=Object(a.a)(),o=e.theme=r.useMemo((function(){var e=Object(I.a)(n,t);return e.id=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=0,o=e;r<o.length;r++){var i=o[r];if(i){var a=i.id||E.get(i);a||(a=Object(x.a)(""),E.set(i,a)),n.push(a)}}return n.join("-")}(n,t),e}),[n,t]);e.customizerContext=r.useMemo((function(){return{customizations:{inCustomizerContext:!0,settings:{theme:o},scopedSettings:o.components||{}}}}),[o]),e.theme.rtl!==n.rtl&&(e.dir=e.theme.rtl?"rtl":"ltr")},w=n(740),M=n(449),k=n(453);n.d(t,"a",(function(){return j}));var j=r.forwardRef((function(e,t){var n=function(e,t){var n=Object(w.a)(t,e);return T(n),{state:n,render:_}}(e,{ref:Object(k.a)(t,r.useRef(null)),as:"div",applyTo:"element"}),o=n.render,i=n.state;return y(i),Object(M.b)(i.ref),o(i)}));j.displayName="ThemeProvider"},1304:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(839),o=n(743);function i(e){return Object(r.c)(e,{leave:a})}var a={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return c(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,n=e.name,r=l("(",c(e.variableDefinitions,", "),")"),o=c(e.directives," "),i=e.selectionSet;return n||o||r||"query"!==t?c([t,c([n,r]),o,i]," "):i},VariableDefinition:function(e){var t=e.variable,n=e.type,r=e.defaultValue,o=e.directives;return t+": "+n+l(" = ",r)+l(" ",c(o," "))},SelectionSet:function(e){return u(e.selections)},Field:function(e){var t=e.alias,n=e.name,r=e.arguments,o=e.directives,i=e.selectionSet,a=l("",t,": ")+n,s=a+l("(",c(r,", "),")");return s.length>80&&(s=a+l("(\n",d(c(r,"\n")),"\n)")),c([s,c(o," "),i]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+l(" ",c(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,n=e.directives,r=e.selectionSet;return c(["...",l("on ",t),c(n," "),r]," ")},FragmentDefinition:function(e){var t=e.name,n=e.typeCondition,r=e.variableDefinitions,o=e.directives,i=e.selectionSet;return("fragment ".concat(t).concat(l("(",c(r,", "),")")," ")+"on ".concat(n," ").concat(l("",c(o," ")," "))+i)},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var n=e.value;return e.block?Object(o.c)(n,"description"===t?"":"  "):JSON.stringify(n)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+c(e.values,", ")+"]"},ObjectValue:function(e){return"{"+c(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+l("(",c(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:s((function(e){var t=e.directives,n=e.operationTypes;return c(["schema",c(t," "),u(n)]," ")})),OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:s((function(e){return c(["scalar",e.name,c(e.directives," ")]," ")})),ObjectTypeDefinition:s((function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return c(["type",t,l("implements ",c(n," & ")),c(r," "),u(o)]," ")})),FieldDefinition:s((function(e){var t=e.name,n=e.arguments,r=e.type,o=e.directives;return t+(p(n)?l("(\n",d(c(n,"\n")),"\n)"):l("(",c(n,", "),")"))+": "+r+l(" ",c(o," "))})),InputValueDefinition:s((function(e){var t=e.name,n=e.type,r=e.defaultValue,o=e.directives;return c([t+": "+n,l("= ",r),c(o," ")]," ")})),InterfaceTypeDefinition:s((function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return c(["interface",t,l("implements ",c(n," & ")),c(r," "),u(o)]," ")})),UnionTypeDefinition:s((function(e){var t=e.name,n=e.directives,r=e.types;return c(["union",t,c(n," "),r&&0!==r.length?"= "+c(r," | "):""]," ")})),EnumTypeDefinition:s((function(e){var t=e.name,n=e.directives,r=e.values;return c(["enum",t,c(n," "),u(r)]," ")})),EnumValueDefinition:s((function(e){return c([e.name,c(e.directives," ")]," ")})),InputObjectTypeDefinition:s((function(e){var t=e.name,n=e.directives,r=e.fields;return c(["input",t,c(n," "),u(r)]," ")})),DirectiveDefinition:s((function(e){var t=e.name,n=e.arguments,r=e.repeatable,o=e.locations;return"directive @"+t+(p(n)?l("(\n",d(c(n,"\n")),"\n)"):l("(",c(n,", "),")"))+(r?" repeatable":"")+" on "+c(o," | ")})),SchemaExtension:function(e){var t=e.directives,n=e.operationTypes;return c(["extend schema",c(t," "),u(n)]," ")},ScalarTypeExtension:function(e){return c(["extend scalar",e.name,c(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return c(["extend type",t,l("implements ",c(n," & ")),c(r," "),u(o)]," ")},InterfaceTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return c(["extend interface",t,l("implements ",c(n," & ")),c(r," "),u(o)]," ")},UnionTypeExtension:function(e){var t=e.name,n=e.directives,r=e.types;return c(["extend union",t,c(n," "),r&&0!==r.length?"= "+c(r," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,n=e.directives,r=e.values;return c(["extend enum",t,c(n," "),u(r)]," ")},InputObjectTypeExtension:function(e){var t=e.name,n=e.directives,r=e.fields;return c(["extend input",t,c(n," "),u(r)]," ")}};function s(e){return function(t){return c([t.description,e(t)],"\n")}}function c(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!==(t=null==e?void 0:e.filter((function(e){return e})).join(n))&&void 0!==t?t:""}function u(e){return l("{\n",d(c(e,"\n")),"\n}")}function l(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return null!=t&&""!==t?e+t+n:""}function d(e){return l("  ",e.replace(/\n/g,"\n  "))}function f(e){return-1!==e.indexOf("\n")}function p(e){return null!=e&&e.some(f)}},1306:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return u}));var r=n(25),o=Object.prototype.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a(e)}function a(e){var t=e[0]||{},n=e.length;if(n>1)for(var r=new u,o=1;o<n;++o)t=r.merge(t,e[o]);return t}function s(e){return null!==e&&"object"==typeof e}var c=function(e,t,n){return this.merge(e[n],t[n])},u=function(){function e(e){void 0===e&&(e=c),this.reconciler=e,this.isObject=s,this.pastCopies=new Set}return e.prototype.merge=function(e,t){for(var n=this,i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];return s(t)&&s(e)?(Object.keys(t).forEach((function(a){if(o.call(e,a)){var s=e[a];if(t[a]!==s){var c=n.reconciler.apply(n,Object(r.f)([e,t,a],i));c!==s&&((e=n.shallowCopyForMerge(e))[a]=c)}}else(e=n.shallowCopyForMerge(e))[a]=t[a]})),e):t},e.prototype.shallowCopyForMerge=function(e){return s(e)&&!this.pastCopies.has(e)&&(e=Array.isArray(e)?e.slice(0):Object(r.a)({__proto__:Object.getPrototypeOf(e)},e),this.pastCopies.add(e)),e},e}()},1307:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(839),o=n(68);function i(e,t){var n=e.directives;return!n||!n.length||function(e){var t=[];e&&e.length&&e.forEach((function(e){if("skip"===(n=e.name.value)||"include"===n){var n,r=e.arguments;e.name.value;Object(o.b)(r&&1===r.length,39);var i=r[0];Object(o.b)(i.name&&"if"===i.name.value,40);var a=i.value;Object(o.b)(a&&("Variable"===a.kind||"BooleanValue"===a.kind),41),t.push({directive:e,ifArgument:i})}}));return t}(n).every((function(e){var n=e.directive,r=e.ifArgument,i=!1;return"Variable"===r.value.kind?(i=t&&t[r.value.name.value],Object(o.b)(void 0!==i,38)):i=r.value.value,"skip"===n.name.value?!i:i}))}function a(e,t){return function(e){var t=[];return Object(r.c)(e,{Directive:function(e){t.push(e.name.value)}}),t}(t).some((function(t){return e.indexOf(t)>-1}))}function s(e){return e&&a(["client"],e)&&a(["export"],e)}},1308:function(e,t,n){"use strict";function r(e){return Array.isArray(e)&&e.length>0}n.d(t,"a",(function(){return r}))},1309:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(318),o=n(121),i=n(217),a=n(43),s=n(841),c=n(1081),u=n(842);function l(e,t){return new p(e,t).parseDocument()}function d(e,t){var n=new p(e,t);n.expectToken(a.a.SOF);var r=n.parseValueLiteral(!1);return n.expectToken(a.a.EOF),r}function f(e,t){var n=new p(e,t);n.expectToken(a.a.SOF);var r=n.parseTypeReference();return n.expectToken(a.a.EOF),r}var p=function(){function e(e,t){var n=Object(s.b)(e)?e:new s.a(e);this._lexer=new u.a(n),this._options=t}var t=e.prototype;return t.parseName=function(){var e=this.expectToken(a.a.NAME);return{kind:o.a.NAME,value:e.value,loc:this.loc(e)}},t.parseDocument=function(){var e=this._lexer.token;return{kind:o.a.DOCUMENT,definitions:this.many(a.a.SOF,this.parseDefinition,a.a.EOF),loc:this.loc(e)}},t.parseDefinition=function(){if(this.peek(a.a.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(a.a.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var e=this._lexer.token;if(this.peek(a.a.BRACE_L))return{kind:o.a.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(e)};var t,n=this.parseOperationType();return this.peek(a.a.NAME)&&(t=this.parseName()),{kind:o.a.OPERATION_DEFINITION,operation:n,name:t,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseOperationType=function(){var e=this.expectToken(a.a.NAME);switch(e.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(e)},t.parseVariableDefinitions=function(){return this.optionalMany(a.a.PAREN_L,this.parseVariableDefinition,a.a.PAREN_R)},t.parseVariableDefinition=function(){var e=this._lexer.token;return{kind:o.a.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(a.a.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(a.a.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(e)}},t.parseVariable=function(){var e=this._lexer.token;return this.expectToken(a.a.DOLLAR),{kind:o.a.VARIABLE,name:this.parseName(),loc:this.loc(e)}},t.parseSelectionSet=function(){var e=this._lexer.token;return{kind:o.a.SELECTION_SET,selections:this.many(a.a.BRACE_L,this.parseSelection,a.a.BRACE_R),loc:this.loc(e)}},t.parseSelection=function(){return this.peek(a.a.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var e,t,n=this._lexer.token,r=this.parseName();return this.expectOptionalToken(a.a.COLON)?(e=r,t=this.parseName()):t=r,{kind:o.a.FIELD,alias:e,name:t,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(a.a.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(n)}},t.parseArguments=function(e){var t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(a.a.PAREN_L,t,a.a.PAREN_R)},t.parseArgument=function(){var e=this._lexer.token,t=this.parseName();return this.expectToken(a.a.COLON),{kind:o.a.ARGUMENT,name:t,value:this.parseValueLiteral(!1),loc:this.loc(e)}},t.parseConstArgument=function(){var e=this._lexer.token;return{kind:o.a.ARGUMENT,name:this.parseName(),value:(this.expectToken(a.a.COLON),this.parseValueLiteral(!0)),loc:this.loc(e)}},t.parseFragment=function(){var e=this._lexer.token;this.expectToken(a.a.SPREAD);var t=this.expectOptionalKeyword("on");return!t&&this.peek(a.a.NAME)?{kind:o.a.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(e)}:{kind:o.a.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseFragmentDefinition=function(){var e,t=this._lexer.token;return this.expectKeyword("fragment"),!0===(null===(e=this._options)||void 0===e?void 0:e.experimentalFragmentVariables)?{kind:o.a.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}:{kind:o.a.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}},t.parseFragmentName=function(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(e){var t=this._lexer.token;switch(t.kind){case a.a.BRACKET_L:return this.parseList(e);case a.a.BRACE_L:return this.parseObject(e);case a.a.INT:return this._lexer.advance(),{kind:o.a.INT,value:t.value,loc:this.loc(t)};case a.a.FLOAT:return this._lexer.advance(),{kind:o.a.FLOAT,value:t.value,loc:this.loc(t)};case a.a.STRING:case a.a.BLOCK_STRING:return this.parseStringLiteral();case a.a.NAME:switch(this._lexer.advance(),t.value){case"true":return{kind:o.a.BOOLEAN,value:!0,loc:this.loc(t)};case"false":return{kind:o.a.BOOLEAN,value:!1,loc:this.loc(t)};case"null":return{kind:o.a.NULL,loc:this.loc(t)};default:return{kind:o.a.ENUM,value:t.value,loc:this.loc(t)}}case a.a.DOLLAR:if(!e)return this.parseVariable()}throw this.unexpected()},t.parseStringLiteral=function(){var e=this._lexer.token;return this._lexer.advance(),{kind:o.a.STRING,value:e.value,block:e.kind===a.a.BLOCK_STRING,loc:this.loc(e)}},t.parseList=function(e){var t=this,n=this._lexer.token;return{kind:o.a.LIST,values:this.any(a.a.BRACKET_L,(function(){return t.parseValueLiteral(e)}),a.a.BRACKET_R),loc:this.loc(n)}},t.parseObject=function(e){var t=this,n=this._lexer.token;return{kind:o.a.OBJECT,fields:this.any(a.a.BRACE_L,(function(){return t.parseObjectField(e)}),a.a.BRACE_R),loc:this.loc(n)}},t.parseObjectField=function(e){var t=this._lexer.token,n=this.parseName();return this.expectToken(a.a.COLON),{kind:o.a.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e),loc:this.loc(t)}},t.parseDirectives=function(e){for(var t=[];this.peek(a.a.AT);)t.push(this.parseDirective(e));return t},t.parseDirective=function(e){var t=this._lexer.token;return this.expectToken(a.a.AT),{kind:o.a.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e),loc:this.loc(t)}},t.parseTypeReference=function(){var e,t=this._lexer.token;return this.expectOptionalToken(a.a.BRACKET_L)?(e=this.parseTypeReference(),this.expectToken(a.a.BRACKET_R),e={kind:o.a.LIST_TYPE,type:e,loc:this.loc(t)}):e=this.parseNamedType(),this.expectOptionalToken(a.a.BANG)?{kind:o.a.NON_NULL_TYPE,type:e,loc:this.loc(t)}:e},t.parseNamedType=function(){var e=this._lexer.token;return{kind:o.a.NAMED_TYPE,name:this.parseName(),loc:this.loc(e)}},t.parseTypeSystemDefinition=function(){var e=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(e.kind===a.a.NAME)switch(e.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(e)},t.peekDescription=function(){return this.peek(a.a.STRING)||this.peek(a.a.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");var n=this.parseDirectives(!0),r=this.many(a.a.BRACE_L,this.parseOperationTypeDefinition,a.a.BRACE_R);return{kind:o.a.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:r,loc:this.loc(e)}},t.parseOperationTypeDefinition=function(){var e=this._lexer.token,t=this.parseOperationType();this.expectToken(a.a.COLON);var n=this.parseNamedType();return{kind:o.a.OPERATION_TYPE_DEFINITION,operation:t,type:n,loc:this.loc(e)}},t.parseScalarTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");var n=this.parseName(),r=this.parseDirectives(!0);return{kind:o.a.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");var n=this.parseName(),r=this.parseImplementsInterfaces(),i=this.parseDirectives(!0),a=this.parseFieldsDefinition();return{kind:o.a.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:i,fields:a,loc:this.loc(e)}},t.parseImplementsInterfaces=function(){var e;if(!this.expectOptionalKeyword("implements"))return[];if(!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLImplementsInterfaces)){var t=[];this.expectOptionalToken(a.a.AMP);do{t.push(this.parseNamedType())}while(this.expectOptionalToken(a.a.AMP)||this.peek(a.a.NAME));return t}return this.delimitedMany(a.a.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var e;return!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLEmptyFields)&&this.peek(a.a.BRACE_L)&&this._lexer.lookahead().kind===a.a.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(a.a.BRACE_L,this.parseFieldDefinition,a.a.BRACE_R)},t.parseFieldDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseArgumentDefs();this.expectToken(a.a.COLON);var i=this.parseTypeReference(),s=this.parseDirectives(!0);return{kind:o.a.FIELD_DEFINITION,description:t,name:n,arguments:r,type:i,directives:s,loc:this.loc(e)}},t.parseArgumentDefs=function(){return this.optionalMany(a.a.PAREN_L,this.parseInputValueDef,a.a.PAREN_R)},t.parseInputValueDef=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(a.a.COLON);var r,i=this.parseTypeReference();this.expectOptionalToken(a.a.EQUALS)&&(r=this.parseValueLiteral(!0));var s=this.parseDirectives(!0);return{kind:o.a.INPUT_VALUE_DEFINITION,description:t,name:n,type:i,defaultValue:r,directives:s,loc:this.loc(e)}},t.parseInterfaceTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");var n=this.parseName(),r=this.parseImplementsInterfaces(),i=this.parseDirectives(!0),a=this.parseFieldsDefinition();return{kind:o.a.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:i,fields:a,loc:this.loc(e)}},t.parseUnionTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");var n=this.parseName(),r=this.parseDirectives(!0),i=this.parseUnionMemberTypes();return{kind:o.a.UNION_TYPE_DEFINITION,description:t,name:n,directives:r,types:i,loc:this.loc(e)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(a.a.EQUALS)?this.delimitedMany(a.a.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");var n=this.parseName(),r=this.parseDirectives(!0),i=this.parseEnumValuesDefinition();return{kind:o.a.ENUM_TYPE_DEFINITION,description:t,name:n,directives:r,values:i,loc:this.loc(e)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(a.a.BRACE_L,this.parseEnumValueDefinition,a.a.BRACE_R)},t.parseEnumValueDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseDirectives(!0);return{kind:o.a.ENUM_VALUE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseInputObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");var n=this.parseName(),r=this.parseDirectives(!0),i=this.parseInputFieldsDefinition();return{kind:o.a.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:r,fields:i,loc:this.loc(e)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(a.a.BRACE_L,this.parseInputValueDef,a.a.BRACE_R)},t.parseTypeSystemExtension=function(){var e=this._lexer.lookahead();if(e.kind===a.a.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)},t.parseSchemaExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var t=this.parseDirectives(!0),n=this.optionalMany(a.a.BRACE_L,this.parseOperationTypeDefinition,a.a.BRACE_R);if(0===t.length&&0===n.length)throw this.unexpected();return{kind:o.a.SCHEMA_EXTENSION,directives:t,operationTypes:n,loc:this.loc(e)}},t.parseScalarTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var t=this.parseName(),n=this.parseDirectives(!0);if(0===n.length)throw this.unexpected();return{kind:o.a.SCALAR_TYPE_EXTENSION,name:t,directives:n,loc:this.loc(e)}},t.parseObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),i=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===i.length)throw this.unexpected();return{kind:o.a.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:i,loc:this.loc(e)}},t.parseInterfaceTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),i=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===i.length)throw this.unexpected();return{kind:o.a.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:i,loc:this.loc(e)}},t.parseUnionTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseUnionMemberTypes();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:o.a.UNION_TYPE_EXTENSION,name:t,directives:n,types:r,loc:this.loc(e)}},t.parseEnumTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseEnumValuesDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:o.a.ENUM_TYPE_EXTENSION,name:t,directives:n,values:r,loc:this.loc(e)}},t.parseInputObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseInputFieldsDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:o.a.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:r,loc:this.loc(e)}},t.parseDirectiveDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(a.a.AT);var n=this.parseName(),r=this.parseArgumentDefs(),i=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var s=this.parseDirectiveLocations();return{kind:o.a.DIRECTIVE_DEFINITION,description:t,name:n,arguments:r,repeatable:i,locations:s,loc:this.loc(e)}},t.parseDirectiveLocations=function(){return this.delimitedMany(a.a.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var e=this._lexer.token,t=this.parseName();if(void 0!==c.a[t.value])return t;throw this.unexpected(e)},t.loc=function(e){var t;if(!0!==(null===(t=this._options)||void 0===t?void 0:t.noLocation))return new i.a(e,this._lexer.lastToken,this._lexer.source)},t.peek=function(e){return this._lexer.token.kind===e},t.expectToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t;throw Object(r.a)(this._lexer.source,t.start,"Expected ".concat(h(e),", found ").concat(m(t),"."))},t.expectOptionalToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t},t.expectKeyword=function(e){var t=this._lexer.token;if(t.kind!==a.a.NAME||t.value!==e)throw Object(r.a)(this._lexer.source,t.start,'Expected "'.concat(e,'", found ').concat(m(t),"."));this._lexer.advance()},t.expectOptionalKeyword=function(e){var t=this._lexer.token;return t.kind===a.a.NAME&&t.value===e&&(this._lexer.advance(),!0)},t.unexpected=function(e){var t=null!=e?e:this._lexer.token;return Object(r.a)(this._lexer.source,t.start,"Unexpected ".concat(m(t),"."))},t.any=function(e,t,n){this.expectToken(e);for(var r=[];!this.expectOptionalToken(n);)r.push(t.call(this));return r},t.optionalMany=function(e,t,n){if(this.expectOptionalToken(e)){var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r}return[]},t.many=function(e,t,n){this.expectToken(e);var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r},t.delimitedMany=function(e,t){this.expectOptionalToken(e);var n=[];do{n.push(t.call(this))}while(this.expectOptionalToken(e));return n},e}();function m(e){var t=e.value;return h(e.kind)+(null!=t?' "'.concat(t,'"'):"")}function h(e){return Object(u.b)(e)?'"'.concat(e,'"'):e}},131:function(e,t,n){"use strict";var r=n(3),o=Object(r.action)("CHANGE_FABRIC_THEME",(e,t)=>({themeSymbols:e,isDarkTheme:t}));const i={densityMode:"Full",palette:void 0,fonts:void 0,isInverted:!1,density:void 0};var a=Object(r.createStore)("fabricTheme",i),s=Object(r.mutatorAction)("MUTATE_FABRIC_THEME",(e,t)=>{var n;if(a().palette=e,a().isInverted=t,a().density){const e=a().density||{};a().density=Object.assign(Object.assign({},e),{components:Object.assign(Object.assign({},e.components||{}),{CommandBar:{styles:{root:{backgroundColor:null===(n=a().palette)||void 0===n?void 0:n.neutralLighter}}}})})}else a().density={components:{CommandBar:{styles:{root:{backgroundColor:e.neutralLighter}}},Icon:{styles:{root:{display:null}}}}}}),c=n(8);function u(){const{palette:e,fonts:t,isInverted:n}=a();Object(c.loadTheme)({fonts:t,isInverted:n,palette:e})}Object(r.orchestrator)(o,e=>{s(e.themeSymbols,e.isDarkTheme),u()});var l=n(6),d=Object(r.mutatorAction)("MUTATE_FABRIC_FONT",e=>{a().fonts=Object(c.createFontStyles)(e)});Object(r.orchestrator)(l.l,e=>{d(e.locale),u()});var f=Object(r.action)("MUTATE_FABRIC_DENSITY",(e,t)=>({densityMode:e,density:t})),p=(Object(r.mutator)(f,e=>{var t;const{densityMode:n,density:r}=e;a().density=Object.assign(Object.assign({},r),{components:Object.assign(Object.assign({},r.components||{}),{CommandBar:{styles:{root:{backgroundColor:null===(t=a().palette)||void 0===t?void 0:t.neutralLighter}}}})}),a().densityMode=n}),n(16));let m=Object(p.computed)(()=>Object(c.createTheme)(a()));var h=()=>m.get();function g(){return a().isInverted}function v(){return a().density}function y(){return a().densityMode}var b=n(282);function O(){const e=y();switch(e){case"Full":return"full";case"Simple":return"medium";case"Compact":return"compact";default:Object(b.a)(e)}}n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return O})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return f}))},138:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Normal=0]="Normal",e[e.Divider=1]="Divider",e[e.Header=2]="Header",e[e.Section=3]="Section"}(r||(r={}))},14274:function(e,t,n){"use strict";n.r(t);var r=n(7340),o=n(4743),i=n(20);const a=Object(i.e)(o.e,"clone_moduleChange",e=>{Object(r.h)(window,!0)});n.d(t,"moduleChangeOrchestrator",(function(){return a}))},1558:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(1),o=n(0),i=n(50),a=n(235),s=n(48),c=n(461),u=n(818),l=n(453),d=n(625),f=n(186),p=n(317),m=o.forwardRef((function(e,t){var n=o.useRef(null),g=o.useRef(null),v=o.useRef(null),y=Object(l.a)(n,t),b=Object(d.a)(void 0,e.id),O=Object(p.c)(),S=Object(i.j)(e,i.h),C=Object(f.a)((function(){return{previouslyFocusedElementOutsideTrapZone:void 0,previouslyFocusedElementInTrapZone:void 0,disposeFocusHandler:void 0,disposeClickHandler:void 0,hasFocus:!1,unmodalize:void 0}})),A=e.ariaLabelledBy,_=e.className,I=e.children,x=e.componentRef,E=e.disabled,T=e.disableFirstFocus,w=void 0!==T&&T,M=e.disabled,k=void 0!==M&&M,j=e.elementToFocusOnDismiss,P=e.forceFocusInsideTrap,R=void 0===P||P,N=e.focusPreviouslyFocusedInnerElement,D=e.firstFocusableSelector,F=e.ignoreExternalFocusing,L=e.isClickableOutsideFocusTrap,U=void 0!==L&&L,B=e.onFocus,H=e.onBlur,V=e.onFocusCapture,z=e.onBlurCapture,W=e.enableAriaHiddenSiblings,G={"aria-hidden":!0,style:{pointerEvents:"none",position:"fixed"},tabIndex:E?-1:0,"data-is-visible":!0},q=o.useCallback((function(){if(N&&C.previouslyFocusedElementInTrapZone&&Object(a.a)(n.current,C.previouslyFocusedElementInTrapZone))Object(s.b)(C.previouslyFocusedElementInTrapZone);else{var e="string"==typeof D?D:D&&D(),t=null;n.current&&(e&&(t=n.current.querySelector("."+e)),t||(t=Object(s.j)(n.current,n.current.firstChild,!1,!1,!1,!0))),t&&Object(s.b)(t)}}),[D,N,C]),K=o.useCallback((function(e){if(!E){var t=e===C.hasFocus?v.current:g.current;if(n.current){var r=e===C.hasFocus?Object(s.i)(n.current,t,!0,!1):Object(s.f)(n.current,t,!0,!1);r&&(r===g.current||r===v.current?q():r.focus())}}}),[E,q,C]),X=o.useCallback((function(e){null==z||z(e);var t=e.relatedTarget;null===e.relatedTarget&&(t=O.activeElement),Object(a.a)(n.current,t)||(C.hasFocus=!1)}),[O,C,z]),Q=o.useCallback((function(e){null==V||V(e),e.target===g.current?K(!0):e.target===v.current&&K(!1),C.hasFocus=!0,e.target!==e.currentTarget&&e.target!==g.current&&e.target!==v.current&&(C.previouslyFocusedElementInTrapZone=e.target)}),[V,C,K]),J=o.useCallback((function(){if(m.focusStack=m.focusStack.filter((function(e){return b!==e})),O){var e=O.activeElement;F||!C.previouslyFocusedElementOutsideTrapZone||"function"!=typeof C.previouslyFocusedElementOutsideTrapZone.focus||!Object(a.a)(n.current,e)&&e!==O.body||C.previouslyFocusedElementOutsideTrapZone!==g.current&&C.previouslyFocusedElementOutsideTrapZone!==v.current&&Object(s.b)(C.previouslyFocusedElementOutsideTrapZone)}}),[O,b,F,C]),Y=o.useCallback((function(e){if(!E&&m.focusStack.length&&b===m.focusStack[m.focusStack.length-1]){var t=e.target;Object(a.a)(n.current,t)||(q(),C.hasFocus=!0,e.preventDefault(),e.stopPropagation())}}),[E,b,q,C]),Z=o.useCallback((function(e){if(!E&&m.focusStack.length&&b===m.focusStack[m.focusStack.length-1]){var t=e.target;t&&!Object(a.a)(n.current,t)&&(q(),C.hasFocus=!0,e.preventDefault(),e.stopPropagation())}}),[E,b,q,C]),$=o.useCallback((function(){R&&!C.disposeFocusHandler?C.disposeFocusHandler=Object(c.a)(window,"focus",Y,!0):!R&&C.disposeFocusHandler&&(C.disposeFocusHandler(),C.disposeFocusHandler=void 0),U||C.disposeClickHandler?U&&C.disposeClickHandler&&(C.disposeClickHandler(),C.disposeClickHandler=void 0):C.disposeClickHandler=Object(c.a)(window,"click",Z,!0)}),[Z,Y,R,U,C]);return o.useEffect((function(){var e=n.current;return $(),function(){E&&!R&&Object(a.a)(e,null==O?void 0:O.activeElement)||J()}}),[$]),o.useEffect((function(){var e=void 0===R||R,t=void 0!==E&&E;if(!t||e){if(k)return;m.focusStack.push(b),C.previouslyFocusedElementOutsideTrapZone=j||O.activeElement,w||Object(a.a)(n.current,C.previouslyFocusedElementOutsideTrapZone)||q(),!C.unmodalize&&n.current&&W&&(C.unmodalize=Object(u.a)(n.current))}else e&&!t||(J(),C.unmodalize&&C.unmodalize());j&&C.previouslyFocusedElementOutsideTrapZone!==j&&(C.previouslyFocusedElementOutsideTrapZone=j)}),[j,R,E]),h((function(){C.disposeClickHandler&&(C.disposeClickHandler(),C.disposeClickHandler=void 0),C.disposeFocusHandler&&(C.disposeFocusHandler(),C.disposeFocusHandler=void 0),C.unmodalize&&C.unmodalize(),delete C.previouslyFocusedElementInTrapZone,delete C.previouslyFocusedElementOutsideTrapZone})),function(e,t,n){o.useImperativeHandle(e,(function(){return{get previouslyFocusedElement(){return t},focus:n}}),[t,n])}(x,C.previouslyFocusedElementInTrapZone,q),o.createElement("div",Object(r.__assign)({},S,{className:_,ref:y,"aria-labelledby":A,onFocusCapture:Q,onFocus:B,onBlur:H,onBlurCapture:X}),o.createElement("div",Object(r.__assign)({},G,{ref:g})),I,o.createElement("div",Object(r.__assign)({},G,{ref:v})))})),h=function(e){var t=o.useRef(e);t.current=e,o.useEffect((function(){return function(){t.current&&t.current()}}),[e])};m.displayName="FocusTrapZone",m.focusStack=[]},1559:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(538),s=n(294),c=n(270),u=n(50),l=Object(a.a)(),d=function(e){function t(t){var n=e.call(this,t)||this;Object(s.a)(n);var r=n.props.allowTouchBodyScroll,o=void 0!==r&&r;return n._allowTouchBodyScroll=o,n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){!this._allowTouchBodyScroll&&Object(c.d)()},t.prototype.componentWillUnmount=function(){!this._allowTouchBodyScroll&&Object(c.e)()},t.prototype.render=function(){var e=this.props,t=e.isDarkThemed,n=e.className,r=e.theme,a=e.styles,s=Object(u.j)(this.props,u.h),c=l(a,{theme:r,className:n,isDark:t});return i.createElement("div",Object(o.__assign)({},s,{className:c.root}))},t}(i.Component),f=n(8),p={root:"ms-Overlay",rootDark:"ms-Overlay--dark"};n.d(t,"a",(function(){return m}));var m=Object(r.a)(d,(function(e){var t,n=e.className,r=e.theme,o=e.isNone,i=e.isDark,a=r.palette,s=Object(f.getGlobalClassNames)(p,r);return{root:[s.root,r.fonts.medium,{backgroundColor:a.whiteTranslucent40,top:0,right:0,bottom:0,left:0,position:"absolute",selectors:(t={},t[f.HighContrastSelector]={border:"1px solid WindowText",opacity:0},t)},o&&{visibility:"hidden"},i&&[s.rootDark,{backgroundColor:a.blackTranslucent40}],n]}}),void 0,{scope:"Overlay"})},1561:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(8),s=n(538),c=n(220),u=n(986),l=n(485),d=n(37),f=n(294),p=n(269),m=n(205),h=n(50),g=n(807),v=n(918),y=n(620),b=Object(s.a)(),O=function(e){function t(n){var r=e.call(this,n)||this;return r._tooltipHost=i.createRef(),r._defaultTooltipId=Object(c.a)("tooltip"),r.show=function(){r._toggleTooltip(!0)},r.dismiss=function(){r._hideTooltip()},r._getTargetElement=function(){if(r._tooltipHost.current){var e=r.props.overflowMode;if(void 0!==e)switch(e){case g.a.Parent:return r._tooltipHost.current.parentElement;case g.a.Self:return r._tooltipHost.current}return r._tooltipHost.current}},r._onTooltipFocus=function(e){r._ignoreNextFocusEvent?r._ignoreNextFocusEvent=!1:r._onTooltipMouseEnter(e)},r._onTooltipBlur=function(e){r._ignoreNextFocusEvent=(null===document||void 0===document?void 0:document.activeElement)===e.target,r._hideTooltip()},r._onTooltipMouseEnter=function(e){var n=r.props,o=n.overflowMode,i=n.delay;if(t._currentVisibleTooltip&&t._currentVisibleTooltip!==r&&t._currentVisibleTooltip.dismiss(),t._currentVisibleTooltip=r,void 0!==o){var a=r._getTargetElement();if(a&&!Object(u.b)(a))return}if(!e.target||!Object(l.a)(e.target,r._getTargetElement()))if(r._clearDismissTimer(),r._clearOpenTimer(),i!==y.a.zero){r.setState({isAriaPlaceholderRendered:!0});var s=r._getDelayTime(i);r._openTimerId=r._async.setTimeout((function(){r._toggleTooltip(!0)}),s)}else r._toggleTooltip(!0)},r._onTooltipMouseLeave=function(e){var n=r.props.closeDelay;r._clearDismissTimer(),r._clearOpenTimer(),n?r._dismissTimerId=r._async.setTimeout((function(){r._toggleTooltip(!1)}),n):r._toggleTooltip(!1),t._currentVisibleTooltip===r&&(t._currentVisibleTooltip=void 0)},r._onTooltipKeyDown=function(e){(e.which===d.a.escape||e.ctrlKey)&&r.state.isTooltipVisible&&(r._hideTooltip(),e.stopPropagation())},r._clearDismissTimer=function(){r._async.clearTimeout(r._dismissTimerId)},r._clearOpenTimer=function(){r._async.clearTimeout(r._openTimerId)},r._hideTooltip=function(){r._clearOpenTimer(),r._clearDismissTimer(),r._toggleTooltip(!1)},r._toggleTooltip=function(e){r.state.isTooltipVisible!==e&&r.setState({isAriaPlaceholderRendered:!1,isTooltipVisible:e},(function(){return r.props.onTooltipToggle&&r.props.onTooltipToggle(e)}))},r._getDelayTime=function(e){switch(e){case y.a.medium:return 300;case y.a.long:return 500;default:return 0}},Object(f.a)(r),r.state={isAriaPlaceholderRendered:!1,isTooltipVisible:!1},r._async=new p.a(r),r}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.calloutProps,n=e.children,r=e.content,s=e.directionalHint,c=e.directionalHintForRTL,u=e.hostClassName,l=e.id,d=e.setAriaDescribedBy,f=void 0===d||d,p=e.tooltipProps,g=e.styles,y=e.theme;this._classNames=b(g,{theme:y,className:u});var O=this.state,S=O.isAriaPlaceholderRendered,C=O.isTooltipVisible,A=l||this._defaultTooltipId,_=!!(r||p&&p.onRenderContent&&p.onRenderContent()),I=C&&_,x=f&&C&&_?A:void 0;return i.createElement("div",Object(o.__assign)({className:this._classNames.root,ref:this._tooltipHost},{onFocusCapture:this._onTooltipFocus},{onBlurCapture:this._onTooltipBlur},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,onKeyDown:this._onTooltipKeyDown,role:"none","aria-describedby":x}),n,I&&i.createElement(v.a,Object(o.__assign)({id:A,content:r,targetElement:this._getTargetElement(),directionalHint:s,directionalHintForRTL:c,calloutProps:Object(m.a)({},t,{onDismiss:this._hideTooltip,onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave}),onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave},Object(h.j)(this.props,h.h),p)),S&&i.createElement("div",{id:A,role:"none",style:a.hiddenContentStyle},r))},t.prototype.componentWillUnmount=function(){t._currentVisibleTooltip&&t._currentVisibleTooltip===this&&(t._currentVisibleTooltip=void 0),this._async.dispose()},t.defaultProps={delay:y.a.medium},t}(i.Component),S={root:"ms-TooltipHost",ariaPlaceholder:"ms-TooltipHost-aria-placeholder"};n.d(t,"a",(function(){return C}));var C=Object(r.a)(O,(function(e){var t=e.className,n=e.theme;return{root:[Object(a.getGlobalClassNames)(S,n).root,{display:"inline"},t]}}),void 0,{scope:"TooltipHost"})},1563:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(538),s=n(220),c=n(517),u=n(1600),l=n(395),d=n(294),f=n(321),p=n(209),m=n(1264),h=n(932),g=Object(a.a)(),v=i.createElement(h.a,null).type,y="DialogContent",b=function(e){function t(t){var n=e.call(this,t)||this;return Object(d.a)(n),Object(f.a)(y,t,{titleId:"titleProps.id"}),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.showCloseButton,r=t.className,a=t.closeButtonAriaLabel,s=t.onDismiss,u=t.subTextId,l=t.subText,d=t.titleProps,f=void 0===d?{}:d,h=t.titleId,v=t.title,y=t.type,b=t.styles,O=t.theme,S=t.draggableHeaderClassName,C=g(b,{theme:O,className:r,isLargeHeader:y===c.a.largeHeader,isClose:y===c.a.close,draggableHeaderClassName:S}),A=this._groupChildren();return l&&(e=i.createElement("p",{className:C.subText,id:u},l)),i.createElement("div",{className:C.content},i.createElement("div",{className:C.header},i.createElement("div",Object(o.__assign)({id:h,role:"heading","aria-level":1},f,{className:Object(p.a)(C.title,f.className)}),v),i.createElement("div",{className:C.topButton},this.props.topButtonsProps.map((function(e,t){return i.createElement(m.a,Object(o.__assign)({key:e.uniqueId||t},e))})),(y===c.a.close||n&&y!==c.a.largeHeader)&&i.createElement(m.a,{className:C.button,iconProps:{iconName:"Cancel"},ariaLabel:a,onClick:s,title:a}))),i.createElement("div",{className:C.inner},i.createElement("div",{className:C.innerContent},e,A.contents),A.footers))},t.prototype._groupChildren=function(){var e={footers:[],contents:[]};return i.Children.map(this.props.children,(function(t){"object"==typeof t&&null!==t&&t.type===v?e.footers.push(t):e.contents.push(t)})),e},t.defaultProps={showCloseButton:!1,className:"",topButtonsProps:[],closeButtonAriaLabel:"Close"},t=Object(o.__decorate)([l.d],t)}(i.Component),O=n(8),S={contentLgHeader:"ms-Dialog-lgHeader",close:"ms-Dialog--close",subText:"ms-Dialog-subText",header:"ms-Dialog-header",headerLg:"ms-Dialog--lgHeader",button:"ms-Dialog-button ms-Dialog-button--close",inner:"ms-Dialog-inner",content:"ms-Dialog-content",title:"ms-Dialog-title"},C=Object(r.a)(b,(function(e){var t,n,r,o=e.className,i=e.theme,a=e.isLargeHeader,s=e.isClose,c=e.hidden,u=e.isMultiline,l=e.draggableHeaderClassName,d=i.palette,f=i.fonts,p=i.effects,m=i.semanticColors,h=Object(O.getGlobalClassNames)(S,i);return{content:[a&&[h.contentLgHeader,{borderTop:"4px solid "+d.themePrimary}],s&&h.close,{flexGrow:1,overflowY:"hidden"},o],subText:[h.subText,f.medium,{margin:"0 0 24px 0",color:m.bodySubtext,lineHeight:"1.5",wordWrap:"break-word",fontWeight:O.FontWeights.regular}],header:[h.header,{position:"relative",width:"100%",boxSizing:"border-box"},s&&h.close,l&&[l,{cursor:"move"}]],button:[h.button,c&&{selectors:{".ms-Icon.ms-Icon--Cancel":{color:m.buttonText,fontSize:O.IconFontSizes.medium}}}],inner:[h.inner,{padding:"0 24px 24px",selectors:(t={},t["@media (min-width: "+O.ScreenWidthMinSmall+"px) and (max-width: "+O.ScreenWidthMaxSmall+"px)"]={padding:"0 16px 16px"},t)}],innerContent:[h.content,{position:"relative",width:"100%"}],title:[h.title,f.xLarge,{color:m.bodyText,margin:"0",minHeight:f.xLarge.fontSize,padding:"16px 46px 20px 24px",lineHeight:"normal",selectors:(n={},n["@media (min-width: "+O.ScreenWidthMinSmall+"px) and (max-width: "+O.ScreenWidthMaxSmall+"px)"]={padding:"16px 46px 16px 16px"},n)},a&&{color:m.menuHeader},u&&{fontSize:f.xxLarge.fontSize}],topButton:[{display:"flex",flexDirection:"row",flexWrap:"nowrap",position:"absolute",top:"0",right:"0",padding:"15px 15px 0 0",selectors:(r={"> *":{flex:"0 0 auto"},".ms-Dialog-button":{color:m.buttonText},".ms-Dialog-button:hover":{color:m.buttonTextHovered,borderRadius:p.roundedCorner2}},r["@media (min-width: "+O.ScreenWidthMinSmall+"px) and (max-width: "+O.ScreenWidthMaxSmall+"px)"]={padding:"15px 8px 0 0"},r)}]}}),void 0,{scope:"DialogContent"}),A=Object(a.a)(),_={isDarkOverlay:!1,isBlocking:!1,className:"",containerClassName:"",topOffsetFixed:!1},I={type:c.a.normal,className:"",topButtonsProps:[]},x=function(e){function t(t){var n=e.call(this,t)||this;return n._getSubTextId=function(){var e=n.props,t=e.ariaDescribedById,r=e.modalProps,o=e.dialogContentProps,i=e.subText,a=r&&r.subtitleAriaId||t;return a||(a=(o&&o.subText||i)&&n._defaultSubTextId),a},n._getTitleTextId=function(){var e=n.props,t=e.ariaLabelledById,r=e.modalProps,o=e.dialogContentProps,i=e.title,a=r&&r.titleAriaId||t;return a||(a=(o&&o.title||i)&&n._defaultTitleTextId),a},n._id=Object(s.a)("Dialog"),n._defaultTitleTextId=n._id+"-title",n._defaultSubTextId=n._id+"-subText",n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e,t,n,r,a=this.props,s=a.className,c=a.containerClassName,l=a.contentClassName,d=a.elementToFocusOnDismiss,f=a.firstFocusableSelector,p=a.forceFocusInsideTrap,m=a.styles,h=a.hidden,g=a.ignoreExternalFocusing,v=a.isBlocking,y=a.isClickableOutsideFocusTrap,b=a.isDarkOverlay,O=a.isOpen,S=a.onDismiss,x=a.onDismissed,E=a.onLayerDidMount,T=a.responsiveMode,w=a.subText,M=a.theme,k=a.title,j=a.topButtonsProps,P=a.type,R=a.minWidth,N=a.maxWidth,D=a.modalProps,F=Object(o.__assign)({},D?D.layerProps:{onLayerDidMount:E});E&&!F.onLayerDidMount&&(F.onLayerDidMount=E),D&&D.dragOptions&&!D.dragOptions.dragHandleSelector?(n="ms-Dialog-draggable-header",r=Object(o.__assign)(Object(o.__assign)({},D.dragOptions),{dragHandleSelector:"."+n})):r=D&&D.dragOptions;var L=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({},_),{className:s,containerClassName:c,isBlocking:v,isDarkOverlay:b,onDismissed:x}),D),{layerProps:F,dragOptions:r}),U=Object(o.__assign)(Object(o.__assign)(Object(o.__assign)({className:l,subText:w,title:k,topButtonsProps:j,type:P},I),this.props.dialogContentProps),{draggableHeaderClassName:n,titleProps:Object(o.__assign)({id:(null===(e=this.props.dialogContentProps)||void 0===e?void 0:e.titleId)||this._defaultTitleTextId},null===(t=this.props.dialogContentProps)||void 0===t?void 0:t.titleProps)}),B=A(m,{theme:M,className:L.className,containerClassName:L.containerClassName,hidden:h,dialogDefaultMinWidth:R,dialogDefaultMaxWidth:N});return i.createElement(u.a,Object(o.__assign)({elementToFocusOnDismiss:d,firstFocusableSelector:f,forceFocusInsideTrap:p,ignoreExternalFocusing:g,isClickableOutsideFocusTrap:y,onDismissed:L.onDismissed,responsiveMode:T},L,{isDarkOverlay:L.isDarkOverlay,isBlocking:L.isBlocking,isOpen:void 0!==O?O:!h,className:B.root,containerClassName:B.main,onDismiss:S||L.onDismiss,subtitleAriaId:this._getSubTextId(),titleAriaId:this._getTitleTextId()}),i.createElement(C,Object(o.__assign)({subTextId:this._defaultSubTextId,title:U.title,subText:U.subText,showCloseButton:L.isBlocking,topButtonsProps:U.topButtonsProps,type:U.type,onDismiss:S||U.onDismiss,className:U.className},U),this.props.children))},t.defaultProps={hidden:!0},t=Object(o.__decorate)([l.d],t)}(i.Component),E={root:"ms-Dialog"};n.d(t,"a",(function(){return T}));var T=Object(r.a)(x,(function(e){var t,n=e.className,r=e.containerClassName,o=e.dialogDefaultMinWidth,i=void 0===o?"288px":o,a=e.dialogDefaultMaxWidth,s=void 0===a?"340px":a,c=e.hidden,u=e.theme;return{root:[Object(O.getGlobalClassNames)(E,u).root,u.fonts.medium,n],main:[{width:i,outline:"3px solid transparent",selectors:(t={},t["@media (min-width: "+O.ScreenWidthMinMedium+"px)"]={width:"auto",maxWidth:s,minWidth:i},t)},!c&&{display:"flex"},r]}}),void 0,{scope:"Dialog"});T.displayName="Dialog"},1591:function(e,t,n){"use strict";function r(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Object.create(null);return e.forEach((function(e){e&&Object.keys(e).forEach((function(t){var r=e[t];void 0!==r&&(n[t]=r)}))})),n}n.d(t,"a",(function(){return r}))},1592:function(e,t,n){"use strict";var r,o=n(590),i=n(1),a=n(0),s=n(1264),c=n(1189),u=n(1559),l=n(1182),d=n(538),f=n(270),p=n(209),m=n(269),h=n(122),g=n(294),v=n(321),y=n(220),b=n(168),O=n(50),S=n(235),C=n(1558),A=n(286),_=Object(d.a)(),I="Panel";!function(e){e[e.closed=0]="closed",e[e.animatingOpen=1]="animatingOpen",e[e.open=2]="open",e[e.animatingClosed=3]="animatingClosed"}(r||(r={}));var x,E,T,w,M,k=function(e){function t(t){var n=e.call(this,t)||this;n._panel=a.createRef(),n._animationCallback=null,n._hasCustomNavigation=!(!n.props.onRenderNavigation&&!n.props.onRenderNavigationContent),n.dismiss=function(e){n.props.onDismiss&&n.isActive&&n.props.onDismiss(e),(!e||e&&!e.defaultPrevented)&&n.close()},n._allowScrollOnPanel=function(e){e?n._allowTouchBodyScroll?Object(f.b)(e,n._events):Object(f.c)(e,n._events):n._events.off(n._scrollableContent),n._scrollableContent=e},n._onRenderNavigation=function(e){if(!n.props.onRenderNavigationContent&&!n.props.onRenderNavigation&&!n.props.hasCloseButton)return null;var t=n.props.onRenderNavigationContent,r=void 0===t?n._onRenderNavigationContent:t;return a.createElement("div",{className:n._classNames.navigation},r(e,n._onRenderNavigationContent))},n._onRenderNavigationContent=function(e){var t,r=e.closeButtonAriaLabel,o=e.hasCloseButton,i=e.onRenderHeader,c=void 0===i?n._onRenderHeader:i;if(o){var u=null===(t=n._classNames.subComponentStyles)||void 0===t?void 0:t.closeButton();return a.createElement(a.Fragment,null,!n._hasCustomNavigation&&c(n.props,n._onRenderHeader,n._headerTextId),a.createElement(s.a,{styles:u,className:n._classNames.closeButton,onClick:n._onPanelClick,ariaLabel:r,title:r,"data-is-visible":!0,iconProps:{iconName:"Cancel"}}))}return null},n._onRenderHeader=function(e,t,r){var o=e.headerText,s=e.headerTextProps,c=void 0===s?{}:s;return o?a.createElement("div",{className:n._classNames.header},a.createElement("div",Object(i.__assign)({id:r,role:"heading","aria-level":1},c,{className:Object(p.a)(n._classNames.headerText,c.className)}),o)):null},n._onRenderBody=function(e){return a.createElement("div",{className:n._classNames.content},e.children)},n._onRenderFooter=function(e){var t=n.props.onRenderFooterContent,r=void 0===t?null:t;return r?a.createElement("div",{className:n._classNames.footer},a.createElement("div",{className:n._classNames.footerInner},r())):null},n._animateTo=function(e){e===r.open&&n.props.onOpen&&n.props.onOpen(),n._animationCallback=n._async.setTimeout((function(){n.setState({visibility:e}),n._onTransitionComplete()}),200)},n._clearExistingAnimationTimer=function(){null!==n._animationCallback&&n._async.clearTimeout(n._animationCallback)},n._onPanelClick=function(e){n.dismiss(e)},n._onTransitionComplete=function(){n._updateFooterPosition(),n.state.visibility===r.open&&n.props.onOpened&&n.props.onOpened(),n.state.visibility===r.closed&&n.props.onDismissed&&n.props.onDismissed()};var o=n.props.allowTouchBodyScroll,c=void 0!==o&&o;return n._allowTouchBodyScroll=c,n._async=new m.a(n),n._events=new h.a(n),Object(g.a)(n),Object(v.a)(I,t,{ignoreExternalFocusing:"focusTrapZoneProps",forceFocusInsideTrap:"focusTrapZoneProps",firstFocusableSelector:"focusTrapZoneProps"}),n.state={isFooterSticky:!1,visibility:r.closed,id:Object(y.a)("Panel")},n}return Object(i.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return void 0===e.isOpen?null:!e.isOpen||t.visibility!==r.closed&&t.visibility!==r.animatingClosed?e.isOpen||t.visibility!==r.open&&t.visibility!==r.animatingOpen?null:{visibility:r.animatingClosed}:{visibility:r.animatingOpen}},t.prototype.componentDidMount=function(){this._events.on(window,"resize",this._updateFooterPosition),this._shouldListenForOuterClick(this.props)&&this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0),this.props.isOpen&&this.setState({visibility:r.animatingOpen})},t.prototype.componentDidUpdate=function(e,t){var n=this._shouldListenForOuterClick(this.props),o=this._shouldListenForOuterClick(e);this.state.visibility!==t.visibility&&(this._clearExistingAnimationTimer(),this.state.visibility===r.animatingOpen?this._animateTo(r.open):this.state.visibility===r.animatingClosed&&this._animateTo(r.closed)),n&&!o?this._events.on(document.body,"mousedown",this._dismissOnOuterClick,!0):!n&&o&&this._events.off(document.body,"mousedown",this._dismissOnOuterClick,!0)},t.prototype.componentWillUnmount=function(){this._async.dispose(),this._events.dispose()},t.prototype.render=function(){var e=this.props,t=e.className,n=void 0===t?"":t,o=e.elementToFocusOnDismiss,s=e.firstFocusableSelector,d=e.focusTrapZoneProps,f=e.forceFocusInsideTrap,p=e.hasCloseButton,m=e.headerText,h=e.headerClassName,g=void 0===h?"":h,v=e.ignoreExternalFocusing,y=e.isBlocking,S=e.isFooterAtBottom,I=e.isLightDismiss,x=e.isHiddenOnDismiss,E=e.layerProps,T=e.overlayProps,w=e.popupProps,M=e.type,k=e.styles,j=e.theme,P=e.customWidth,R=e.onLightDismissClick,N=void 0===R?this._onPanelClick:R,D=e.onRenderNavigation,F=void 0===D?this._onRenderNavigation:D,L=e.onRenderHeader,U=void 0===L?this._onRenderHeader:L,B=e.onRenderBody,H=void 0===B?this._onRenderBody:B,V=e.onRenderFooter,z=void 0===V?this._onRenderFooter:V,W=this.state,G=W.isFooterSticky,q=W.visibility,K=W.id,X=M===A.a.smallFixedNear||M===A.a.customNear,Q=Object(b.a)(j)?X:!X,J=M===A.a.custom||M===A.a.customNear?{width:P}:{},Y=Object(O.j)(this.props,O.h),Z=this.isActive,$=q===r.animatingClosed||q===r.animatingOpen;if(this._headerTextId=m&&K+"-headerText",!Z&&!$&&!x)return null;this._classNames=_(k,{theme:j,className:n,focusTrapZoneClassName:d?d.className:void 0,hasCloseButton:p,headerClassName:g,isAnimating:$,isFooterSticky:G,isFooterAtBottom:S,isOnRightSide:Q,isOpen:Z,isHiddenOnDismiss:x,type:M,hasCustomNavigation:this._hasCustomNavigation});var ee,te=this._classNames,ne=this._allowTouchBodyScroll;return y&&Z&&(ee=a.createElement(u.a,Object(i.__assign)({className:te.overlay,isDarkThemed:!1,onClick:I?N:void 0,allowTouchBodyScroll:ne},T))),a.createElement(c.a,Object(i.__assign)({},E),a.createElement(l.a,Object(i.__assign)({role:"dialog","aria-modal":y?"true":void 0,ariaLabelledBy:this._headerTextId?this._headerTextId:void 0,onDismiss:this.dismiss,className:te.hiddenPanel},w),a.createElement("div",Object(i.__assign)({"aria-hidden":!Z&&$},Y,{ref:this._panel,className:te.root}),ee,a.createElement(C.a,Object(i.__assign)({ignoreExternalFocusing:v,forceFocusInsideTrap:!(!y||x&&!Z)&&f,firstFocusableSelector:s,isClickableOutsideFocusTrap:!0},d,{className:te.main,style:J,elementToFocusOnDismiss:o}),a.createElement("div",{className:te.contentInner},a.createElement("div",{ref:this._allowScrollOnPanel,className:te.scrollableContent,"data-is-scrollable":!0},a.createElement("div",{className:te.commands,"data-is-visible":!0},F(this.props,this._onRenderNavigation)),(this._hasCustomNavigation||!p)&&U(this.props,this._onRenderHeader,this._headerTextId),H(this.props,this._onRenderBody),z(this.props,this._onRenderFooter)))))))},t.prototype.open=function(){void 0===this.props.isOpen&&(this.isActive||this.setState({visibility:r.animatingOpen}))},t.prototype.close=function(){void 0===this.props.isOpen&&this.isActive&&this.setState({visibility:r.animatingClosed})},Object.defineProperty(t.prototype,"isActive",{get:function(){return this.state.visibility===r.open||this.state.visibility===r.animatingOpen},enumerable:!1,configurable:!0}),t.prototype._shouldListenForOuterClick=function(e){return!!e.isBlocking&&!!e.isOpen},t.prototype._updateFooterPosition=function(){var e=this._scrollableContent;if(e){var t=e.clientHeight,n=e.scrollHeight;this.setState({isFooterSticky:t<n})}},t.prototype._dismissOnOuterClick=function(e){var t=this._panel.current;this.isActive&&t&&!e.defaultPrevented&&(Object(S.a)(t,e.target)||(this.props.onOuterClick?this.props.onOuterClick(e):this.dismiss(e)))},t.defaultProps={isHiddenOnDismiss:!1,isOpen:void 0,isBlocking:!0,hasCloseButton:!0,type:A.a.smallFixedFar},t}(a.Component),j=n(8),P={root:"ms-Panel",main:"ms-Panel-main",commands:"ms-Panel-commands",contentInner:"ms-Panel-contentInner",scrollableContent:"ms-Panel-scrollableContent",navigation:"ms-Panel-navigation",closeButton:"ms-Panel-closeButton ms-PanelAction-close",header:"ms-Panel-header",headerText:"ms-Panel-headerText",content:"ms-Panel-content",footer:"ms-Panel-footer",footerInner:"ms-Panel-footerInner",isOpen:"is-open",hasCloseButton:"ms-Panel--hasCloseButton",smallFluid:"ms-Panel--smFluid",smallFixedNear:"ms-Panel--smLeft",smallFixedFar:"ms-Panel--sm",medium:"ms-Panel--md",large:"ms-Panel--lg",largeFixed:"ms-Panel--fixed",extraLarge:"ms-Panel--xl",custom:"ms-Panel--custom",customNear:"ms-Panel--customLeft"},R="100%",N="auto",D=272,F=340,L=592,U=644,B=940,H="auto",V=0,z=48,W=428,G=176,q=((x={})["@media (min-width: "+j.ScreenWidthMinMedium+"px)"]={width:F},x),K=((E={})["@media (min-width: "+j.ScreenWidthMinLarge+"px)"]={width:L},E["@media (min-width: "+j.ScreenWidthMinXLarge+"px)"]={width:U},E),X=((T={})["@media (min-width: "+j.ScreenWidthMinUhfMobile+"px)"]={left:z,width:N},T["@media (min-width: "+j.ScreenWidthMinXXLarge+"px)"]={left:W},T),Q=((w={})["@media (min-width: "+j.ScreenWidthMinXXLarge+"px)"]={left:H,width:B},w),J=((M={})["@media (min-width: "+j.ScreenWidthMinXXLarge+"px)"]={left:G},M),Y=function(e){var t;switch(e){case A.a.smallFixedFar:t=Object(i.__assign)({},q);break;case A.a.medium:t=Object(i.__assign)(Object(i.__assign)({},q),K);break;case A.a.large:t=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},q),K),X);break;case A.a.largeFixed:t=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},q),K),X),Q);break;case A.a.extraLarge:t=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},q),K),X),J)}return t},Z={paddingLeft:"24px",paddingRight:"24px"};n.d(t,"a",(function(){return $}));var $=Object(o.a)(k,(function(e){var t,n,r,o,a=e.className,s=e.focusTrapZoneClassName,c=e.hasCloseButton,u=e.headerClassName,l=e.isAnimating,d=e.isFooterSticky,f=e.isFooterAtBottom,p=e.isOnRightSide,m=e.isOpen,h=e.isHiddenOnDismiss,g=e.hasCustomNavigation,v=e.theme,y=e.type,b=void 0===y?A.a.smallFixedFar:y,O=v.effects,S=v.fonts,C=v.semanticColors,_=Object(j.getGlobalClassNames)(P,v),I=b===A.a.custom||b===A.a.customNear;return{root:[_.root,v.fonts.medium,m&&_.isOpen,c&&_.hasCloseButton,{pointerEvents:"none",position:"absolute",top:0,left:0,right:0,bottom:0},I&&p&&_.custom,I&&!p&&_.customNear,a],overlay:[{pointerEvents:"auto",cursor:"pointer"},m&&l&&j.AnimationClassNames.fadeIn100,!m&&l&&j.AnimationClassNames.fadeOut100],hiddenPanel:[!m&&!l&&h&&{visibility:"hidden"}],main:[_.main,{backgroundColor:C.bodyBackground,boxShadow:O.elevation64,pointerEvents:"auto",position:"absolute",display:"flex",flexDirection:"column",overflowX:"hidden",overflowY:"auto",WebkitOverflowScrolling:"touch",bottom:0,top:0,left:H,right:V,width:R,selectors:Object(i.__assign)((t={},t[j.HighContrastSelector]={borderLeft:"3px solid "+C.variantBorder,borderRight:"3px solid "+C.variantBorder},t),Y(b))},b===A.a.smallFluid&&{left:V},b===A.a.smallFixedNear&&{left:V,right:H,width:D},b===A.a.customNear&&{right:"auto",left:0},I&&{maxWidth:"100vw"},m&&l&&!p&&j.AnimationClassNames.slideRightIn40,m&&l&&p&&j.AnimationClassNames.slideLeftIn40,!m&&l&&!p&&j.AnimationClassNames.slideLeftOut40,!m&&l&&p&&j.AnimationClassNames.slideRightOut40,s],commands:[_.commands,{paddingTop:18,selectors:(n={},n["@media (min-height: "+j.ScreenWidthMinMedium+"px)"]={backgroundColor:C.bodyBackground,position:"sticky",top:0},n)},g&&{marginTop:"inherit"}],navigation:[_.navigation,{display:"flex",justifyContent:"flex-end"},g&&{height:"44px"}],contentInner:[_.contentInner,{display:"flex",flexDirection:"column",flexGrow:1,overflowY:"hidden"}],header:[_.header,Z,{alignSelf:"flex-start"},c&&!g&&{flexGrow:1},g&&{flexShrink:0}],headerText:[_.headerText,S.xLarge,{color:C.bodyText,lineHeight:"27px",overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},u],scrollableContent:[_.scrollableContent,{overflowY:"auto"},f&&{flexGrow:1}],content:[_.content,Z,{paddingBottom:20},f&&{selectors:(r={},r["@media (min-height: "+j.ScreenWidthMinMedium+"px)"]={height:"100%"},r)}],footer:[_.footer,{flexShrink:0,borderTop:"1px solid transparent",transition:"opacity "+j.AnimationVariables.durationValue3+" "+j.AnimationVariables.easeFunction2,selectors:(o={},o["@media (min-height: "+j.ScreenWidthMinMedium+"px)"]={position:"sticky",bottom:0},o)},d&&{background:C.bodyBackground,borderTopColor:C.variantBorder}],footerInner:[_.footerInner,Z,{paddingBottom:16,paddingTop:16}],subComponentStyles:{closeButton:{root:[_.closeButton,{marginRight:14,color:v.palette.neutralSecondary,fontSize:j.IconFontSizes.large},g&&{marginRight:0,height:"auto",width:"44px"}],rootHovered:{color:v.palette.neutralPrimary}}}}}),void 0,{scope:"Panel"})},1593:function(e,t,n){"use strict";var r=n(25),o=n(839),i=(n(68),n(496));function a(e,t,n){var r=0;return e.forEach((function(n,o){t.call(this,n,o,e)&&(e[r++]=n)}),n),e.length=r,e}var s=n(250),c=n(586);n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return v}));var u={kind:"Field",name:{kind:"Name",value:"__typename"}};function l(e){return function e(t,n){return t.selectionSet.selections.every((function(t){return"FragmentSpread"===t.kind&&e(n[t.name.value],n)}))}(Object(i.f)(e)||Object(i.c)(e),Object(c.a)(Object(i.d)(e)))?null:e}function d(e){return function(t){return e.some((function(e){return e.name&&e.name===t.name.value||e.test&&e.test(t)}))}}function f(e,t){var n=Object.create(null),i=[],c=Object.create(null),u=[],f=l(Object(o.c)(t,{Variable:{enter:function(e,t,r){"VariableDefinition"!==r.kind&&(n[e.name.value]=!0)}},Field:{enter:function(t){if(e&&t.directives&&(e.some((function(e){return e.remove}))&&t.directives&&t.directives.some(d(e))))return t.arguments&&t.arguments.forEach((function(e){"Variable"===e.value.kind&&i.push({name:e.value.name.value})})),t.selectionSet&&function e(t){var n=[];return t.selections.forEach((function(t){(Object(s.d)(t)||Object(s.e)(t))&&t.selectionSet?e(t.selectionSet).forEach((function(e){return n.push(e)})):"FragmentSpread"===t.kind&&n.push(t)})),n}(t.selectionSet).forEach((function(e){u.push({name:e.name.value})})),null}},FragmentSpread:{enter:function(e){c[e.name.value]=!0}},Directive:{enter:function(t){if(d(e)(t))return null}}}));return f&&a(i,(function(e){return!!e.name&&!n[e.name]})).length&&(f=function(e,t){var n=function(e){return function(t){return e.some((function(e){return t.value&&"Variable"===t.value.kind&&t.value.name&&(e.name===t.value.name.value||e.test&&e.test(t))}))}}(e);return l(Object(o.c)(t,{OperationDefinition:{enter:function(t){return Object(r.a)(Object(r.a)({},t),{variableDefinitions:t.variableDefinitions?t.variableDefinitions.filter((function(t){return!e.some((function(e){return e.name===t.variable.name.value}))})):[]})}},Field:{enter:function(t){if(e.some((function(e){return e.remove}))){var r=0;if(t.arguments&&t.arguments.forEach((function(e){n(e)&&(r+=1)})),1===r)return null}}},Argument:{enter:function(e){if(n(e))return null}}}))}(i,f)),f&&a(u,(function(e){return!!e.name&&!c[e.name]})).length&&(f=function(e,t){function n(t){if(e.some((function(e){return e.name===t.name.value})))return null}return l(Object(o.c)(t,{FragmentSpread:{enter:n},FragmentDefinition:{enter:n}}))}(u,f)),f}function p(e){return Object(o.c)(Object(i.a)(e),{SelectionSet:{enter:function(e,t,n){if(!n||"OperationDefinition"!==n.kind){var o=e.selections;if(o)if(!o.some((function(e){return Object(s.d)(e)&&("__typename"===e.name.value||0===e.name.value.lastIndexOf("__",0))}))){var i=n;if(!(Object(s.d)(i)&&i.directives&&i.directives.some((function(e){return"export"===e.name.value}))))return Object(r.a)(Object(r.a)({},e),{selections:Object(r.f)(o,[u])})}}}}})}p.added=function(e){return e===u};var m={test:function(e){var t="connection"===e.name.value;return t&&(!e.arguments||e.arguments.some((function(e){return"key"===e.name.value}))),t}};function h(e){return f([m],Object(i.a)(e))}function g(e){return"query"===Object(i.e)(e).operation?e:Object(o.c)(e,{OperationDefinition:{enter:function(e){return Object(r.a)(Object(r.a)({},e),{operation:"query"})}}})}function v(e){Object(i.a)(e);var t=f([{test:function(e){return"client"===e.name.value},remove:!0}],e);return t&&(t=Object(o.c)(t,{FragmentDefinition:{enter:function(e){if(e.selectionSet&&e.selectionSet.selections.every((function(e){return Object(s.d)(e)&&"__typename"===e.name.value})))return null}}})),t}},16577:function(e){e.exports=JSON.parse('{"a":"_la","b":"$la"}')},16578:function(e){e.exports=JSON.parse('{"b":"hsa","a":"isa"}')},16579:function(e){e.exports=JSON.parse('{"a":"Doa"}')},16580:function(e,t,n){var r=n(16581);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},16581:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._2sp2LzX0SB77yRYeqt7zDr{width:16px;height:16px}html[dir] ._2sp2LzX0SB77yRYeqt7zDr{padding:7px}._2F3ya_4S-FyX8XKGFCDito{width:30px;height:30px;cursor:pointer}html[dir] ._2F3ya_4S-FyX8XKGFCDito{background-color:transparent;padding:0}html[dir=ltr] ._2F3ya_4S-FyX8XKGFCDito{margin:0 5px 0 0}html[dir=rtl] ._2F3ya_4S-FyX8XKGFCDito{margin:0 0 0 5px}html[dir] ._2F3ya_4S-FyX8XKGFCDito:hover{background-color:var(--themeLighter)}._2F3ya_4S-FyX8XKGFCDito .ms-Button-menuIcon{display:none}",""]),t.locals={image:"_2sp2LzX0SB77yRYeqt7zDr",addinEntryButton:"_2F3ya_4S-FyX8XKGFCDito"}},16582:function(e,t,n){var r=n(16583);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},16583:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,".s5hOln7z-zZasOWGu3-F2{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex;height:30px}",""]),t.locals={listViewContainer:"s5hOln7z-zZasOWGu3-F2"}},16584:function(e){e.exports=JSON.parse('{"a":"zpa"}')},16585:function(e,t,n){var r=n(16586);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},16586:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._10PnLdnt6LiaPm-2gBVmeV{display:block}html[dir] ._10PnLdnt6LiaPm-2gBVmeV{background:transparent;border:none}html[dir=ltr] ._10PnLdnt6LiaPm-2gBVmeV{margin-right:5px}html[dir=rtl] ._10PnLdnt6LiaPm-2gBVmeV{margin-left:5px}._3amj3Bp6iyGlSvDf4PSyTU{height:16px;width:0;color:var(--neutralTertiary)}html[dir] ._3amj3Bp6iyGlSvDf4PSyTU{padding:0 0 0 0;margin:7px 0 7px 0}html[dir=ltr] ._3amj3Bp6iyGlSvDf4PSyTU{border-right-width:1px;border-right-style:solid;float:left}html[dir=rtl] ._3amj3Bp6iyGlSvDf4PSyTU{border-left-width:1px;border-left-style:solid;float:right}._3BIDjCVKLetg8VVNwHIsEA{display:inline-block;width:30px;height:30px;cursor:pointer}html[dir] ._3BIDjCVKLetg8VVNwHIsEA{background-color:transparent}html[dir] ._3BIDjCVKLetg8VVNwHIsEA:hover{background-color:var(--themeLighter)}._3BIDjCVKLetg8VVNwHIsEA .ms-Button-menuIcon{display:none}._3o4AJMzGGO5HNC5Y6yW5YR{font-size:10px;color:var(--neutralSecondary)}",""]),t.locals={overflowContainer:"_10PnLdnt6LiaPm-2gBVmeV",overflowDivider:"_3amj3Bp6iyGlSvDf4PSyTU",overflowChevronContainer:"_3BIDjCVKLetg8VVNwHIsEA",overflowChevron:"_3o4AJMzGGO5HNC5Y6yW5YR"}},16587:function(e,t,n){var r=n(16588);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},16588:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._37gntWBV-snNffBOK6mqd7{display:-webkit-box;display:-ms-flexbox;display:flex;display:-webkit-flex}html[dir=ltr] ._37gntWBV-snNffBOK6mqd7{float:right}html[dir=rtl] ._37gntWBV-snNffBOK6mqd7{float:left}",""]),t.locals={divContainer:"_37gntWBV-snNffBOK6mqd7"}},16589:function(e){e.exports=JSON.parse('{"a":"fsa","b":"gsa"}')},166:function(e,t,n){var r;
/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(this&&this[r]||r);else if(Array.isArray(r))e.push(o.apply(this,r));else if("object"===i)if(r.toString===Object.prototype.toString)for(var a in r)n.call(r,a)&&r[a]&&e.push(this&&this[a]||a);else e.push(r.toString())}}return e.join(" ")}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},1675:function(e,t,n){"use strict";var r=n(1866),o=n(1987),i=n(1683),a=n(3),s=n(908),c=Object(a.mutatorAction)("createFocusedOtherDropViewState",(function(){i.a.focusedOtherDropViewState=Object(s.a)()}));function u(){return i.a.focusedOtherDropViewState||c(),i.a.focusedOtherDropViewState}var l,d=n(2229);!function(e){e[e.None=0]="None",e[e.Previous=1]="Previous",e[e.Next=2]="Next"}(l||(l={}));var f=l,p=n(1994),m=n(2003),h=n(2004);function g(e){const t=i.a.tableViews.get(e);switch(null==t?void 0:t.tableQuery.type){case 2:return t.serverFolderId;case 0:return t.tableQuery.folderId;default:return null}}var v=n(1771);function y(){const e=Object(v.a)();return!!e&&1===e.tableQuery.type}var b=n(2633),O=n(2634),S=n(6),C=n(1681),A=n(2635),_=n(2636),I=n(2239),x=n(2240);function E(e,t,n){const{tableQuery:r,virtualSelectAllExclusionList:o,totalRowsInView:i}=t;if(e){if(-1!==n)return 0===n?Object(S.b)(b.a):Object(S.b)(_.a);if(1==r.type)return Object(S.b)(O.a);if(fe(t))return Object(S.c)(Object(S.b)(A.a),fe(t));const e=C.d.folderTable.get(r.folderId);return Object(S.c)(Object(S.b)(A.a),Object(C.h)(e))}if(W(t)){const e=i-o.length;return Object(G.a)(t)?Object(S.c)(Object(S.b)(x.c),e):Object(S.c)(Object(S.b)(I.c),e)}return Object(S.b)(O.a)}function T(e){switch(e.tableQuery.type){case 0:case 2:case 3:return e.tableQuery.sortBy;default:throw new Error("getSortByForTable: Table Query type should be either of type group, or mail folder")}}function w(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 3:case 1:return e.tableQuery.viewFilter;default:throw new Error("Table Query should be either of type search, mail folder or group")}}function M(e){return e&&"Unread"==w(e)}var k=n(2241),j=n(7);function P(e,t){const n=Object(F.a)(e,t);let r=null;return me(i.a.tableViews.get(t).tableQuery.folderId)?r=Object(j.vb)(i.a.inboxPausedDateTime):n&&(r=new Date(n.lastModifiedTimeStamp).toISOString()),{conversationId:n.id,conversationLastSyncTimeStamp:r}}var R=n(36);function N(e,t){switch(t){case 0:case 1:return e.InstanceKey;default:return R.h.warn("listViewType:"+t+" not supported"),null}}var D=n(1831),F=n(1791),L=n(1956),U=n(2242);function B(e,t){const n=[];for(let r=0;r<e.length;r++){const o=t.rowIdToRowKeyMap.get(e[r]);o&&Array.prototype.push.apply(n,o)}return n}var H=n(2012),V=n(2230);function z(e){let t;switch(e){case 0:t="Conversation";break;case 1:t="Message";break;default:t="Unknown"}return t}function W(e){const{isInVirtualSelectAllMode:t,virtualSelectAllExclusionList:n}=e;return t&&n.length>0}var G=n(2167),q=n(1678),K=n(1679);function X(e){return!!e&&(e.folderId===Object(q.a)(K.b)||e.folderId===Object(q.a)(K.i))}var Q=n(1823),J=n(282);function Y(e){switch(e){case 1:return"Date";case 3:return"From";case 5:return"Importance";case 7:return"Size";case 8:return"Subject";default:return Object(J.a)(e)}}function Z(e){switch(e){case"All":case"Flagged":case"HasAttachment":case"ToOrCcMe":case"Unread":case"UserCategory":case"Focused":case"Mentioned":case"HasFile":return e;default:Object(J.a)(e)}}function $(e){switch(e){case-1:return"None";case 0:return"Focused";case 1:return"Other";default:Object(J.a)(e)}}function ee(e){switch(e){case 0:return"Conversation";case 1:return"Message";case 2:return"CalendarItems";default:Object(J.a)(e)}}function te(e){switch(e){case 0:return"Folder";case 1:return"Search";case 2:return"Group";case 3:return"GroupFolder";default:Object(J.a)(e)}}function ne(e,t,n){const o=[];return t.forEach(t=>{const i=r.getItemIds(t,n);"Flagged"==e.FlagStatus?o.push(i[0]):o.push(...i)}),o}function re(e,t,n){return!Object(oe.a)(e)&&(t&&n)}var oe=n(2015),ie=n(2066),ae=n(1885),se=n(1982);function ce(){return!Object(v.a)().isInCheckedMode&&i.a.expandedConversationViewState.selectedNodeIds.length>0}function ue(e){const t=i.a.tableViews.get(e),n=Object(p.a)(t),{tableQuery:r,selectedRowKeys:o}=t,a=Object(m.a)(t);if(a||W(t))return E(a,t,n);const s=ce()?i.a.expandedConversationViewState.selectedNodeIds.length:o.size;return 1==r.listViewType||ce()?0===s?Object(S.b)(I.a):1===s?Object(S.b)(I.b):Object(S.c)(Object(S.b)(I.c),s):0===s?Object(S.b)(x.a):1===s?Object(S.b)(x.b):Object(S.c)(Object(S.b)(x.c),s)}function le(){return i.a.expandedConversationViewState.selectedNodeIds}function de(e,t){return e?-1!==Object(p.a)(e)||"All"!==t&&"UserCategory"!==t:null}function fe(e){return 0===e.tableQuery.type&&"UserCategory"===e.tableQuery.viewFilter?e.tableQuery.categoryName:null}var pe=n(1698);function me(e){return i.a.inboxPausedDateTime&&e&&"inbox"===Object(pe.a)(e)}var he=n(2243),ge=n(2014);function ve(e,t){e.currentRowOperation=t,Promise.resolve().then(()=>{e.currentRowOperation=0})}const ye=Object(a.mutatorAction)("clearListViewVirtualization",e=>{e?(i.a.scrollTop=0,i.a.doNotVirtualize=!1):i.a.doNotVirtualize=!0,i.a.rowInfoForVLV.clear()});var be=n(2023);const Oe=Object(a.mutatorAction)("addNodeAsFork",(e,t)=>{const n=t.shift();if(Object(be.a)(e)&&n){const e=i.a.expandedConversationViewState.forks,r=e.map(e=>e.id);if((null==r?void 0:r.length)<=1){const n=t.shift();e.unshift({id:n,displayNames:[],ancestorIds:t}),i.a.expandedConversationViewState.selectedNodeIds.push(n)}-1==r.indexOf(n)&&e.unshift({id:n,displayNames:[],ancestorIds:[]})}});n.d(t,"o",(function(){return u})),n.d(t,"q",(function(){return d.a})),n.d(t,"L",(function(){return i.b})),n.d(t,"Z",(function(){return i.a})),n.d(t,"d",(function(){return f})),n.d(t,"n",(function(){return p.a})),n.d(t,"w",(function(){return m.a})),n.d(t,"k",(function(){return h.a})),n.d(t,"l",(function(){return h.b})),n.d(t,"p",(function(){return g})),n.d(t,"y",(function(){return y})),n.d(t,"G",(function(){return E})),n.d(t,"I",(function(){return v.a})),n.d(t,"K",(function(){return T})),n.d(t,"Q",(function(){return w})),n.d(t,"db",(function(){return M})),n.d(t,"m",(function(){return k.a})),n.d(t,"j",(function(){return P})),n.d(t,"E",(function(){return N})),n.d(t,"O",(function(){return D.a})),n.d(t,"M",(function(){return F.a})),n.d(t,"N",(function(){return L.a})),n.d(t,"D",(function(){return U.a})),n.d(t,"F",(function(){return B})),n.d(t,"X",(function(){return H.a})),n.d(t,"i",(function(){return V.a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"C",(function(){return z})),n.d(t,"W",(function(){return W})),n.d(t,"R",(function(){return G.a})),n.d(t,"S",(function(){return X})),n.d(t,"z",(function(){return Q.b})),n.d(t,"x",(function(){return Q.a})),n.d(t,"t",(function(){return Y})),n.d(t,"v",(function(){return Z})),n.d(t,"r",(function(){return $})),n.d(t,"s",(function(){return ee})),n.d(t,"u",(function(){return te})),n.d(t,"A",(function(){return ne})),n.d(t,"cb",(function(){return re})),n.d(t,"h",(function(){return oe.a})),n.d(t,"f",(function(){return ie.a})),n.d(t,"J",(function(){return ae.a})),n.d(t,"ab",(function(){return se.a})),n.d(t,"B",(function(){return ue})),n.d(t,"Y",(function(){return ce})),n.d(t,"H",(function(){return le})),n.d(t,"U",(function(){return de})),n.d(t,"P",(function(){return fe})),n.d(t,"V",(function(){return me})),n.d(t,"a",(function(){return he.a})),n.d(t,"T",(function(){return ge.a})),n.d(t,"bb",(function(){return ve})),n.d(t,"g",(function(){return ye})),n.d(t,"e",(function(){return Oe}))},1679:function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"k",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"l",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return h}));const r=["journal","outbox","syncissues"],o="archivemsgfolderroot",i="msgfolderroot",a="archivedeleteditems",s="deleteditems",c="archiverecoverableitemsdeletions",u="recoverableitemsdeletions",l="msgfolderroot",d="sharedFolderTree",f="primaryFolderTree",p="archiveFolderTree",m="favorites",h="groups"},1681:function(e,t,n){"use strict";var r=n(20),o=n(1691),i=n(3),a=n(1828),s=n(1702),c=(Object(i.mutator)(a.a,e=>{const{folderTreeId:t,userIdentity:n}=e,r=e.loadingState;Object(s.a)(n).get(t).loadingState=r}),Object(i.action)("PERSONA_SEARCH_FOLDERS_LOADED",(e,t)=>({existingFolders:e,personaOrPdlFavorites:t}))),u=n(1688),l=n(1874),d=n(225),f=(Object(i.mutator)(c,e=>{e.existingFolders.forEach(t=>{if(t){const n=t.FolderId.Id,r=e.personaOrPdlFavorites.filter(e=>e.searchFolderId===n);if(1===r.length){const e=r[0].displayName,n=Object.assign(Object.assign({},Object(l.c)(t,Object(d.d)())),{DisplayName:e});Object(u.a)().set(t.FolderId.Id,n)}}})}),n(36)),p=n(614),m=n(1679),h=n(702),g=n(1792);const v=Object(h.action)("removeFolderFromParentFolder")((function(e,t){const n=(null==t?void 0:t.folderTable)||Object(u.a)();e.forEach(e=>{n.delete(e)})}));let y=Object(h.action)("removeFolderFromParentFolder")((function(e,t){const n=(null==t?void 0:t.folderTable)||Object(u.a)();if(!(null==e?void 0:e.parentFolderId))return;let r=n.get(e.parentFolderId);Object(p.b)()&&r.distinguishedFolderType===m.k&&(r=Object(g.a)(e.mailboxInfo.mailboxSmtpAddress));let o=r.childFolderIds;const i=o.indexOf(e.id);i>-1&&o.splice(i,1)}));function b(e,t,n){let r=t.folderTable.get(n);Object(p.b)()&&r.distinguishedFolderType===m.k&&(r=Object(g.a)(e.mailboxInfo.mailboxSmtpAddress));let o=r.childFolderIds,i=!1,a=q(e).toLowerCase();if(-1==o.indexOf(e.id)){for(let n=0;n<o.length&&!i;n++){q(t.folderTable.get(o[n])).toLowerCase()>a&&(o.splice(n,0,e.id),i=!0)}i||o.push(e.id)}}let O=Object(h.action)("moveFolderToParentFolder")((function(e,t,n,r){const i=((null==r?void 0:r.folderTable)||Object(u.a)()).get(e);y(i,r),b(i,r||o.b,t),i.parentFolderId=t,i.mailboxInfo=n}));var S=n(1917),C=n(1706);Object(i.mutator)(C.a,e=>{!function(e,t,n,r,o){const i=Object(S.a)(n),a=Object(u.a)().get(n);a||f.h.warn("addFolderToStore: parent folder was not found");const s=Object.assign(Object.assign({},Object(l.c)(t,o||a.mailboxInfo)),{displayName:r,childFolderIds:[]});e.folderTable.set(t.FolderId.Id,s),b(s,e,i)}(e.folderStore,e.folder,e.parentFolderId,e.displayName,e.mailboxInfo)});var A=n(1923),_=n(57);const I=Object(i.action)("REMOVE_FOLDERTREE_DATA",(e,t)=>({folderTreeId:e,userIdentity:t}));var x=n(1724);const E=Object(i.mutatorAction)("setFolderTreeData",(e,t,n,r=!1,o=0,i)=>{const a=Object(s.a)(i),c=a.get(e);c?(c.id=e,c.rootFolder=t,c.loadingState=n,c.hasMoreData=r,c.currentLoadedIndex=o):a.set(e,{id:e,rootFolder:t,loadingState:n,hasMoreData:r,currentLoadedIndex:o})});Object(i.orchestrator)(C.f,()=>{const e={distinguishedFolderType:m.d,displayName:Object(_.g)().SessionSettings.ArchiveDisplayName,mailboxInfo:{type:"ArchiveMailbox",mailboxSmtpAddress:Object(_.g)().SessionSettings.ArchiveMailboxGuid,userIdentity:Object(d.d)().userIdentity}};E(m.d,e,x.a.Uninitialized)}),Object(i.mutator)(I,e=>{Object(s.a)(e.userIdentity).delete(e.folderTreeId)});var T=n(1829),w=n(6),M=n(2433),k=n(2446);Object(i.orchestrator)(T.a,e=>{const{displayName:t,folders:n,folderTreeIdentifier:r,includesLastItemInRange:o,offset:i,principalSMTPAddress:a,rootFolder:s,userIdentity:c}=e;Object(k.a)(t,s,n,e=>Object(M.a)(e,a)),E(r,Object(u.a)().get(s.id),x.a.Loaded,!o,i,c);const l=s.mailboxInfo.type,d=s.id;if("UserMailbox"===l||"ArchiveMailbox"===l){for(let e=0;e<n.length;e++){const t=n[e],r=t.id,o=t.distinguishedFolderType;("UserMailbox"===l||t.parentFolderId==d)&&!Object(w.k)(o)&&Object(_.a)(o,r)}Object(_.a)(s.distinguishedFolderType,d)}});var j=n(1678);function P(e){const t=Object(u.a)().get(e);return!!t.childFolderIds&&t.childFolderIds.map(e=>{return!!Object(u.a)().get(e)}).length>0}function R(e,t){return function e(t,n,r){const o=[];if(0===n){const i=e(t,n+1,r);o.push(...i)}else t.forEach(t=>{const i=Object(u.a)().get(t);if(i&&(o.push(Object.assign(Object.assign({},i),{depth:n})),P(t)&&r(t))){const t=e(i.childFolderIds,n+1,r);o.push(...t)}});return o}(e,0,t)}var N=n(16);let D,F={folderTable:new N.ObservableMap,mailboxFolderTreeData:new N.ObservableMap};let L=function(e,t){F.folderTable.set(e.id,e),e.parentFolderId&&F.folderTable.get(e.parentFolderId).childFolderIds.push(e.id),e.distinguishedFolderType&&(D[e.distinguishedFolderType]=e.id)};L=Object(h.action)("addFolderToStore-TestMethod")(L);const U=Object(i.action)("INITIALIZE_SHARED_FOLDERS");var B=n(1835),H=n(1918);function V(e){const t=Object(s.a)(),n=t&&t.get(e);return null==n?void 0:n.hasMoreData}var z=n(2092),W=n(1839),G=n(38);function q(e){var t;return e?Object(G.a)().SessionSettings.IsShadowMailbox&&(null===(t=e.remoteFolderInfo)||void 0===t?void 0:t.remoteFolderDisplayName)?e.remoteFolderInfo.remoteFolderDisplayName:e.displayName:""}const K=Object(i.mutatorAction)("setMailboxFolderTreeData",(e,t)=>{Object(o.a)().mailboxFolderTreeData.set(e,t)});function X(e){Object(s.b)(e)||K(e,function(e){return{folderTreeTable:new N.ObservableMap({[m.k]:{id:m.k,rootFolder:{distinguishedFolderType:m.k,displayName:m.k,mailboxInfo:Object(d.d)(e)},loadingState:x.a.Uninitialized}}),sharedFolderUserEmails:[]}}(e))}var Q=n(71);const J=new r.b(new r.c(()=>Promise.all([n.e(8),n.e(10),n.e(13),n.e(33),n.e(109)]).then(n.bind(null,19558))),e=>e.fetchPrimaryMailFolders);var Y=n(47),Z=n(2434);async function $(e,t,n){const r=Object(d.d)(t);t||(t=r.userIdentity),X(t);const o=Object(H.a)(m.k,t);if(o==x.a.Loading||o==x.a.Loaded&&!e)return;Object(a.a)(m.k,x.a.Loading,t);let i=!Object(Y.j)("tri-disableSDFolders")&&Object(Z.a)(n,r);try{if(!i){const e=await J.import();i=await e(r)}}catch(e){return void Object(a.a)(m.k,x.a.ErrorLoading,t)}if(!i)return void Object(a.a)(m.k,x.a.ErrorLoading,t);const s=Object(G.a)().SessionSettings.UserEmailAddress===t?Object(G.a)().SessionSettings.UserDisplayName:t;Object(T.a)(i.RootFolder,i.Folders,m.k,t,s,m.k,t,i.IncludesLastItemInRange,i.offset),function(){var e,t;const n=null===(e=Object(u.a)().get(Object(j.a)("inbox")))||void 0===e?void 0:e.childFolderIds.length,r=null===(t=Object(u.a)().get(Object(j.a)("msgfolderroot")))||void 0===t?void 0:t.totalMessageCount;Object(Q.o)("TnS_LoadFolders",[n,r])}()}var ee=n(1830);function te(e,t={folderTable:o.b.folderTable}){return Object(ee.c)(e,"msgfolderroot",t)}function ne(e){return Object(ee.a)(o.b.folderTable.get(e),"msgfolderroot")}var re=n(1767),oe=n(2073),ie=n(1924),ae=n(1919);n.d(t,"J",(function(){return ce})),n.d(t,"K",(function(){return ue})),n.d(t,"N",(function(){return le})),n.d(t,"O",(function(){return de})),n.d(t,"I",(function(){return fe})),n.d(t,"L",(function(){return pe})),n.d(t,"M",(function(){return me})),n.d(t,"x",(function(){return o.a})),n.d(t,"b",(function(){return A.a})),n.d(t,"i",(function(){return R})),n.d(t,"y",(function(){return P})),n.d(t,"a",(function(){return x.a})),n.d(t,"q",(function(){return S.a})),n.d(t,"S",(function(){return c})),n.d(t,"e",(function(){return v})),n.d(t,"T",(function(){return y})),n.d(t,"P",(function(){return O})),n.d(t,"c",(function(){return C.a})),n.d(t,"z",(function(){return C.f})),n.d(t,"l",(function(){return C.e})),n.d(t,"k",(function(){return C.d})),n.d(t,"Y",(function(){return C.k})),n.d(t,"X",(function(){return C.i})),n.d(t,"Q",(function(){return C.g})),n.d(t,"B",(function(){return U})),n.d(t,"U",(function(){return I})),n.d(t,"R",(function(){return T.a})),n.d(t,"W",(function(){return a.a})),n.d(t,"g",(function(){return B.a})),n.d(t,"u",(function(){return g.a})),n.d(t,"m",(function(){return u.a})),n.d(t,"p",(function(){return H.a})),n.d(t,"o",(function(){return V})),n.d(t,"n",(function(){return z.a})),n.d(t,"w",(function(){return W.a})),n.d(t,"h",(function(){return q})),n.d(t,"V",(function(){return E})),n.d(t,"A",(function(){return X})),n.d(t,"v",(function(){return $})),n.d(t,"F",(function(){return te})),n.d(t,"E",(function(){return ne})),n.d(t,"H",(function(){return ee.c})),n.d(t,"D",(function(){return ee.a})),n.d(t,"j",(function(){return re.a})),n.d(t,"r",(function(){return re.b})),n.d(t,"C",(function(){return re.c})),n.d(t,"t",(function(){return oe.a})),n.d(t,"G",(function(){return ie.b})),n.d(t,"s",(function(){return s.b})),n.d(t,"f",(function(){return ae.a}));t.d=o.b;const se=new r.c(()=>Promise.all([n.e(8),n.e(10),n.e(13),n.e(33),n.e(109)]).then(n.bind(null,19558))),ce=new r.b(se,e=>e.getArchiveFolders),ue=new r.b(se,e=>e.getFolderPermissions),le=new r.b(se,e=>e.updateFolderPermissions),de=new r.b(se,e=>e.updateFolderPermissionsInStore),fe=new r.b(se,e=>e.arePermissionArraysEqual),pe=(new r.b(se,e=>e.arePermissionsEqual),new r.b(se,e=>e.getSharedFolders)),me=new r.a(se,e=>e.updateFolder)},1683:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(16),o=n(3);const i={conversationItems:new r.ObservableMap({}),itemContextMenuState:null,selectedTableViewId:null,tableViewConversationRelations:new r.ObservableMap({}),tableViewItemRelations:new r.ObservableMap({}),tableViews:new r.ObservableMap({}),attachmentViewStates:new r.ObservableMap({}),expandedConversationViewState:{expandedRowKey:null,focusedNodeId:null,selectedNodeIds:[],allNodeIds:[],shouldBeExpanded:!1,busStopStateMap:new r.ObservableMap({}),forks:null},rowAttachmentPreviewWellViews:new r.ObservableMap({}),focusedOtherDropViewState:null,couponPeekPreviews:new r.ObservableMap({}),rowInfoForVLV:new r.ObservableMap({}),meetingMessageItems:new r.ObservableMap({}),offsetHeight:0,scrollTop:0,inboxPausedDateTime:null,inboxPausedLength:null,txpActionButtonData:new r.ObservableMap({}),lastIndexToRender:0,doNotVirtualize:!1};let a=Object(o.createStore)("listview",i);const s=a();t.a=s},1687:function(e,t,n){"use strict";n.d(t,"v",(function(){return i})),n.d(t,"E",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"z",(function(){return c})),n.d(t,"C",(function(){return u})),n.d(t,"D",(function(){return l})),n.d(t,"B",(function(){return d})),n.d(t,"A",(function(){return f})),n.d(t,"f",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"k",(function(){return h})),n.d(t,"r",(function(){return g})),n.d(t,"F",(function(){return v})),n.d(t,"w",(function(){return y})),n.d(t,"n",(function(){return b})),n.d(t,"y",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"q",(function(){return C})),n.d(t,"u",(function(){return A})),n.d(t,"l",(function(){return _})),n.d(t,"b",(function(){return I})),n.d(t,"s",(function(){return x})),n.d(t,"c",(function(){return E})),n.d(t,"j",(function(){return T})),n.d(t,"t",(function(){return w})),n.d(t,"o",(function(){return M})),n.d(t,"p",(function(){return k})),n.d(t,"e",(function(){return j})),n.d(t,"x",(function(){return P})),n.d(t,"h",(function(){return R})),n.d(t,"g",(function(){return N})),n.d(t,"m",(function(){return D}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(157)]).then(n.bind(null,4285)));let i=new r.b(o,e=>e.removeExtensibilityNotification),a=new r.b(o,e=>e.updatePersistentNotifications),s=new r.b(o,e=>e.closeTaskPaneAddinCommand),c=new r.b(o,e=>e.triggerAppointmentTimeChangedEvent),u=new r.b(o,e=>e.triggerRecipientsChangedEvent),l=new r.b(o,e=>e.triggerRecurrenceChangedEvent),d=new r.b(o,e=>e.triggerLocationsChangedEvent),f=new r.b(o,e=>e.triggerAttachmentsChangedEvent),p=new r.b(o,e=>e.deinitializeAddinsForItem),m=new r.b(o,e=>e.initializeAddinsForItem),h=new r.a(o,e=>e.initializeExtensibilityContext),g=new r.b(o,e=>e.onHostItemChanged),v=new r.b(o,e=>e.whenItemHasContextualAddinKeywords),y=new r.b(o,e=>e.runContextualEvaluationAndUpdate),b=new r.b(o,e=>e.launchTranslateCommand),O=new r.b(o,e=>e.shouldForceOnSendCompliantBehavior),S=(Object(r.d)(o,e=>e.AddinBarView),Object(r.d)(o,e=>e.TaskPaneCollection)),C=new r.b(o,e=>e.onComposeClose),A=new r.b(o,e=>e.openContextualCallout),_=new r.b(o,e=>e.launchAddinCommand),I=new r.b(o,e=>e.observeAddinCommandSurfaceItems),x=new r.a(o,e=>e.onItemNavigation),E=new r.b(o,e=>e.allowItemSendEvent),T=new r.a(o,e=>e.ExecuteEntryPoint),w=new r.a(o,e=>e.onLaunchEventTriggered),M=new r.a(o,e=>e.logAppTeachingUICalloutTelemetry),k=new r.a(o,e=>e.logCustomizeActionButtonAction),j=new r.b(o,e=>e.convertRecurrenceToAddinFormat),P=new r.b(o,e=>e.seriesTimeJsonConverter);const R=new r.a(o,e=>e.highlightOverflowAddins),N=new r.a(o,e=>e.highlightCustomizeActionButton),D=new r.a(o,e=>e.launchThirdPartyOnlineMeetingProviderAddin)},1688:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1691);function o(){return Object(r.a)().folderTable}},1690:function(e,t,n){"use strict";var r=n(3);const o=Object(r.action)("initializeOwaObservableDateTime"),i=Object(r.action)("observableNowChanged"),a=Object(r.action)("observableTodayChanged");var s=n(7),c=n(16),u=Object(r.createStore)("ObservableDateTime",{now:0,today:0});const l=Object(c.computed)(()=>Object(s.qc)(u().now)),d=()=>l.get(),f=Object(c.computed)(()=>Object(s.qc)(u().today)),p=()=>f.get(),m=e=>Object(s.Jb)(e,d()),h=e=>Object(s.Hb)(e,d()),g=e=>y(e,s.Jb),v=e=>y(e,s.Kb),y=(e,t)=>t(Object(s.bc)(Object(s.qc)(e)),p());function b(e){if(!e)return"";const t=Object(s.qc)(e);return function(e,t){const n=Object(s.bc)(e);if(Object(s.Lb)(n,t))return s.ab;const r=e=>Object(s.Rb)(n,Object(s.e)(t,-e),t);if(r(3))return s.ib;if(r(30))return s.hb;return s.Y}(t,p())(t)}function O(e){if(!e)return"";return function(e,t){const n=Object(s.bc)(e);return Object(s.Lb)(n,t)?Object(s.ab)(e):S(n,t,2)?Object(s.lb)(e):S(n,t,7)?Object(s.H)(Object(s.bb)(e),Object(s.ab)(e)):Object(s.H)(Object(s.J)(e),Object(s.ab)(e))}(Object(s.qc)(e),p())}function S(e,t,n){return Object(s.Rb)(e,Object(s.e)(t,-n),t)}const C=Object(r.action)("updateTimes"),A=Object(r.action)("setNow"),_=Object(r.action)("setToday",e=>({today:e}));Object(r.mutator)(A,()=>{u().now=Object(s.oc)()}),Object(r.mutator)(_,({today:e})=>{u().today=e});var I=n(22),x=n(88);let E=!1;Object(r.orchestrator)(o,()=>{if(C(),!E){const e=Object(s.Ub)(),t=Object(s.dc)(Object(s.h)(e,1)),n=Object(s.w)(t,e);setTimeout(()=>setInterval(C,I.g),n),document&&document.addEventListener("visibilitychange",C),E=!0}}),Object(r.orchestrator)(x.m,()=>{C()}),Object(r.orchestrator)(C,()=>{A();const e=Object(s.Cb)(Object(s.pc)()),t=u().today!=e;t&&_(e),i(),t&&a()}),n.d(t,"c",(function(){return o})),n.d(t,"i",(function(){return i})),n.d(t,"k",(function(){return a})),n.d(t,"h",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return g})),n.d(t,"g",(function(){return v})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return O}))},1691:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(3),o=n(16);const i=Object(r.createStore)("folderStore",{folderTable:new o.ObservableMap,mailboxFolderTreeData:new o.ObservableMap}),a=i();t.a=i},1692:function(e,t,n){"use strict";var r=n(20),o=n(1693),i=n(2053),a=n(1868),s=n(1848);const c="ChronologicalNewestOnBottom";function u(e,t){return e[t==c?0:e.length-1]}var l=n(707),d=n(1701);function f(e){return Object(s.a)(e,Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(d.a)({FieldURI:"TailoredXpEntities"}),Object(d.a)({FieldURI:"TailoredXpCalendarEventIds"}),Object(d.a)({FieldURI:"TailoredXpEntitiesStatus"}),Object(d.a)({FieldURI:"EntityNamesMap"})]}),"ItemTailoredXpData","Exchange2013").then(e=>{if(e&&!(e instanceof Error)){const{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:o}=e;return{TailoredXpEntities:t,TailoredXpCalendarEventIds:n,TailoredXpEntitiesStatus:r,EntityNamesMap:o}}return{}})}var p=n(2091),m=n(38);function h(e){const t=o.a.conversations.get(e);if(t){const e=Object(m.a)().UserOptions.ConversationSortOrderReact;return t.conversationNodeIds.length>0&&!t.loadingState.hasLoadFailed&&t.conversationSortOrder==e}return!1}var g=n(1937),v=n(1681);function y(e,t={folderTable:v.d.folderTable}){return!!t.folderTable.get(e)}var b=n(1679);function O(e,t){const n=v.d.folderTable.get(e);return!!n&&(Object(v.H)(n,b.d,t)||n.distinguishedFolderType===b.b)}function S(e){return O(e)||function(e){const t=v.d.folderTable.get(e);return t&&t.distinguishedFolderType===b.d}(e)}function C(e,t,n={folderTable:v.d.folderTable}){return Object(v.H)(e,t,n)}var A=n(1942),_=n(1895);function I(e){return e&&(Object(_.a)(e,b.i)||Object(_.a)(e,b.b))}function x(e){return e&&(C(e,b.h)||C(e,b.a))}var E=n(1986);function T(e,t){try{return w(e,t)}catch(e){return null}}function w(e,t){if(!e||!t)return null;const n=Object(v.m)().get(e).PermissionSet.Permissions.filter(e=>e.UserId.PrimarySmtpAddress===t);return null==n?void 0:n[0]}var M=n(296);const k="OneOff",j="Unknown";function P(e,t,n){return!Object(M.a)()&&(n==k||n==j)&&(null==e?void 0:e.indexOf(t))<0}var R=n(3),N=Object(R.mutatorAction)("setIsDraftQueuedForSubmission",(e,t)=>{const n=Object(o.b)().items.get(null==e?void 0:e.Id);n&&(n.isDraftQueuedForSubmission=t)}),D=n(1758);n.d(t,"s",(function(){return L})),n.d(t,"u",(function(){return o.a})),n.d(t,"g",(function(){return o.b})),n.d(t,"a",(function(){return i.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"e",(function(){return s.a})),n.d(t,"d",(function(){return u})),n.d(t,"t",(function(){return f})),n.d(t,"v",(function(){return p.a})),n.d(t,"q",(function(){return h})),n.d(t,"c",(function(){return g.a})),n.d(t,"r",(function(){return y})),n.d(t,"m",(function(){return O})),n.d(t,"l",(function(){return S})),n.d(t,"n",(function(){return C})),n.d(t,"j",(function(){return A.a})),n.d(t,"k",(function(){return I})),n.d(t,"p",(function(){return x})),n.d(t,"f",(function(){return E.a})),n.d(t,"h",(function(){return T})),n.d(t,"i",(function(){return w})),n.d(t,"o",(function(){return P})),n.d(t,"w",(function(){return N})),n.d(t,"x",(function(){return D.a}));const F=new r.c(()=>n.e(1960).then(n.bind(null,19870))),L=new r.a(F,e=>e.setTriageActionAnnouncement)},1693:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(16),o=n(3);const i={conversationNodes:new r.ObservableMap({}),conversations:new r.ObservableMap({}),items:new r.ObservableMap({}),searchFolderDisplayName:null,typeOfItemBeingDragged:null,triageAnnouncement:{message:null,politenessSetting:"off"}};let a=Object(o.createStore)("mail",i);const s=a();t.a=s},1696:function(e,t,n){"use strict";var r=n(1709),o=n(2213),i=n(6);function a(e){let t;return e>=1073741824?(e/=1073741824,t=Object(i.b)(o.b)):e>=1048576?(e/=1048576,t=Object(i.b)(o.d)):e>=1024?(e/=1024,t=Object(i.b)(o.c)):t=Object(i.b)(o.a),Object(i.c)(t,Math.round(e))}var s=n(1850),c=n(47);const u=[".pdf",".doc",".docx",".odt",".rtf",".ppt",".pptx",".pptm",".potx",".potm",".pot",".ppxx",".pps",".odp"];function l(e){if(!Object(c.j)("doc-attachment-documentThumbnail"))return!1;const t=Object(r.a)(e);return!!t&&u.indexOf(t.toLowerCase())>=0}var d;function f(e){switch(e){case".doc":case".docm":case".docx":case".dot":case".dotm":case".dotx":case".odt":case".rtf":return d.Word;case".csv":case".ods":case".xls":case".xlsb":case".xlsm":case".xlsx":return d.Excel;case".odp":case".pot":case".potm":case".potx":case".pps":case".ppsm":case".ppsx":case".ppt":case".pptm":case".pptx":return d.PowerPoint;default:return null}}!function(e){e[e.Word=0]="Word",e[e.Excel=1]="Excel",e[e.PowerPoint=2]="PowerPoint"}(d||(d={}));var p=n(1816);n.d(t,"b",(function(){return r.a})),n.d(t,"c",(function(){return r.b})),n.d(t,"d",(function(){return r.c})),n.d(t,"i",(function(){return a})),n.d(t,"g",(function(){return s.a})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"e",(function(){return p.b})),n.d(t,"a",(function(){return d}))},1697:function(e,t,n){"use strict";var r=n(20),o=n(57);function i(e){return Object.assign({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},e)}var a=n(35);var s=n(261);function c(e){const t=Object(o.g)().UserOptions.MailSendUndoInterval;return!e.MailSendUndoInterval&&t&&t<0&&(e.MailSendUndoInterval=0),void 0===(n=i({Header:Object(s.b)(),Options:(c=e,Object.assign({__type:"MailboxMessageConfigurationOptions:#Exchange"},c))}))||n.__type||(n=i(n)),Object(a.a)("SetMailboxMessageConfiguration",n,r);var n,r,c}function u(e,t){return null===e?t:e}function l(e,t,n,o,i){const a=t&&n?new r.b(t,n):null,s=o&&i?new r.b(o,i):null;return Object.assign(Object.assign({},e),{tryImportFullOptionFormSettingsSync:a?()=>a.tryImportForRender():void 0,tryImportQuickOptionSettingsSync:s?()=>s.tryImportForRender():void 0})}function d(e){const t=e.options.filter(e=>f(e)||function(e){var t;return null!==(t=e.tryImportFullOptionFormSettingsSync)&&void 0!==t&&t}(e)).map(e=>f(e)?e:Object.assign(Object.assign({},e),{fullOptionFormSettings:e.tryImportFullOptionFormSettingsSync()}));return t.some(({fullOptionFormSettings:e})=>!e)?null:t}function f(e){var t;return null!==(t=e.fullOptionFormSettings)&&void 0!==t&&t}var p=n(2746);n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return g})),n.d(t,"f",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return p.a}));const m=new r.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(479)]).then(n.bind(null,19822)));let h=new r.a(m,e=>e.confirmOptionNavigation),g=Object(r.d)(m,e=>e.OptionsEditor)},1698:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(66);function o(e){if(!e)throw new Error("Input parameter to folderIdToName must not be null.");return r.a.defaultFolderIdToNameMap.get(e)||"none"}},1701:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"PropertyUri:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1702:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(1691),o=n(57);function i(e){return a(e).folderTreeTable}function a(e){return e||(e=Object(o.b)()),Object(r.a)().mailboxFolderTreeData.get(e)}},1706:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"i",(function(){return p})),n.d(t,"a",(function(){return m}));var r=n(3);const o=Object(r.action)("ON_FIND_DUMPSTER_FOLDER_SUCCESS",(e,t)=>({rootFolder:e,folders:t})),i=Object(r.action)("GET_ARCHIVE_FOLDERS",(e,t)=>({source:e,isLoadingMore:t})),a=Object(r.action)("INITIALIZE_ARCHIVE_FOLDER_TREE_FROM_SESSIONDATA"),s=Object(r.action)("GET_FOLDER_PERMISSIONS",e=>({folderId:e})),c=Object(r.action)("GET_FOLDER_PERMISSIONS_SUCCESS"),u=Object(r.action)("GET_FOLDER_PERMISSIONS_FAILED"),l=Object(r.action)("UPDATE_FOLDER_PERMISSIONS",(e,t,n)=>({folderId:e,permissions:t,mailboxInfo:n})),d=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_IN_STORE",(e,t)=>({folderId:e,permissions:t})),f=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_SUCCESS"),p=Object(r.action)("UPDATE_FOLDER_PERMISSIONS_FAILED"),m=Object(r.action)("ADD_NEW_FOLDER_TO_STORE",(e,t,n,r,o)=>({folderStore:e,folder:t,parentFolderId:n,displayName:r,mailboxInfo:o}))},1709:function(e,t,n){"use strict";function r(e){if(!e)return null;const t=e.lastIndexOf(".");return t>0?e.substr(t).toLowerCase():null}function o(e){const t=r(e);return t?t.replace(".",""):null}function i(e){var t;return(null===(t=o(e))||void 0===t?void 0:t.substring(0,4))||""}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}))},1713:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1824);function o(e){if(!e)return null;return Object(r.a)().attachments.get(e.Id)}},1724:function(e,t,n){"use strict";var r;!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.ErrorLoading=3]="ErrorLoading"}(r||(r={})),t.a=r},1725:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(r||(r={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(o||(o={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(i||(i={}))},1728:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Base64InlineImage=0]="Base64InlineImage",e[e.Cloud=1]="Cloud",e[e.Local=2]="Local",e[e.MailItem=3]="MailItem",e[e.Uri=4]="Uri",e[e.AttachmentItem=5]="AttachmentItem",e[e.CloudSuggestion=6]="CloudSuggestion",e[e.AttachmentItemSuggestion=7]="AttachmentItemSuggestion",e[e.Inline=8]="Inline",e[e.Smime=9]="Smime",e[e.FilesHub=10]="FilesHub",e[e.GroupFilesHub=11]="GroupFilesHub",e[e.MailSearchFileSuggestion=12]="MailSearchFileSuggestion",e[e.Unknown=13]="Unknown",e[e.ContextualSuggestion=14]="ContextualSuggestion",e[e.ConsumerGroupFilesHub=15]="ConsumerGroupFilesHub",e[e.SmartDoc=16]="SmartDoc",e[e.ExpirableBase64InlineImage=17]="ExpirableBase64InlineImage",e[e.Sonora=18]="Sonora"}(r||(r={}))},1734:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1841);function o(){return r.a}},1735:function(e,t,n){"use strict";var r=n(1743);function o(e,t){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":t||e}}function i(e,t,n){t&&(e||n)&&Object(r.b)(t,o(e,n))}function a(e,t){var n;const r=null!=t?t:{},o=(null===(n=r.headers)||void 0===n?void 0:n.set)?new Headers(r.headers):new Headers;return r.datapoint=r.datapoint||{},r.datapoint.mailbox=r.datapoint.mailbox||"Explicit",i(e,o),Object.assign(Object.assign({},r),{headers:o})}var s=n(287),c=n(1744),u=n(59),l=n(307),d=n.n(l);async function f(e){return Object(u.b)().then(async t=>{if(e)if(Object(s.r)(e.userIdentity)){const n=await Object(c.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);d()(t,n)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const n=o(e.mailboxSmtpAddress);d()(t,n)}return t})}function p(){return Object(u.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function m(e=null){return Object(s.r)(e)?p().then(t=>{return Object(c.a)(e).then(e=>(Object.keys(e).forEach(n=>t[n]=e[n]),t))}):Promise.resolve({})}var h=n(52);function g(e,t,n,r){let o=new Headers;return n&&o.set("X-OWA-CANARY",Object(h.a)()),t&&o.set("X-OWA-ActionName",t),(e||r)&&(r?i(e,o,r):i(e,o)),o}n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return g}))},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1732);function o(e){return(e.__type||e.OwsTypeName)===r.e}},1743:function(e,t,n){"use strict";function r(e,t){Object.keys(t).forEach(n=>e.set(n,t[n]))}function o(e){let t=null!=e?e:{headers:new Headers};return t.datapoint=t.datapoint||{},t.datapoint.mailbox="Default",t}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},1744:function(e,t,n){"use strict";var r=n(1877),o=n(287),i=n(1690),a=n(71),s=n(7),c=n(36);const u="X-AnchorMailbox",l="Authorization",d="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function p(e,t){const n={},p=Object(o.k)(e);if(t?(n[u]=t,n[f]=t):p&&(n[u]=p.anchorMailbox),Object(o.s)())return c.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),n;if(p){if(p.accountState==o.b.AccessRevoked)return null;if(p.accountState==o.b.AccountDeprovisioned||p.accountState==o.b.AccountNotFound)return Object(o.d)(p.accountState,p.accountProviderType),null}if(p){let t,o=p.token,u=Object(i.f)(p.tokenExpiry);!u&&o||(Object(a.o)("getAndUpdateAccessToken",{tokenExpiry:Object(s.y)(p.tokenExpiry,Object(s.Ub)()),isTokenExpired_1:u,isTokenInvalid_2:!o},{isCore:!0}),o=await r.a.importAndExecute(p.accountId,e,o),c.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+o),o||(o="")),"Outlook"==p.accountProviderType?(t=`MSAuth1.0 usertoken="${o}", type="MSACT"`,n[d]=1..toString()):"Google"!=p.accountProviderType&&"ICloud"!=p.accountProviderType&&"Yahoo"!=p.accountProviderType||(t=`Bearer ${o}`,n[d]=2..toString()),n[l]=t}return n}var m=n(1743),h=n(912);async function g(e,t){var n;const r=Object(m.a)();if(r.headers=await async function(e,t){var n;const r=t&&(null===(n=e.headers)||void 0===n?void 0:n.set)?new Headers(e.headers):new Headers,o=await p(e.mailboxInfo.userIdentity,v(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(m.b)(r,o),r}(e,t),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},Object(o.s)()){const t=Object(h.a)(null===(n=null==e?void 0:e.mailboxInfo)||void 0===n?void 0:n.userIdentity);c.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+t),r.sourceId=t,r.datapoint.mailbox="Connected"}else r.datapoint.mailbox="Connected";return r}function v(e,t){const n="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return n&&null==t&&c.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),n}n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return v}))},1747:function(e,t,n){"use strict";var r=n(3);let o=Object(r.createStore)("folderForestStore",{selectedNode:{id:null,treeType:"primaryFolderTree",type:0}});var i=o();function a(){return i.selectedNode}function s(){const e=a();switch(e.type){case 1:return e.searchFolderId;case 5:return e.data.searchFolderId;case 3:return null;default:return e.id}}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i}))},1754:function(e,t,n){"use strict";var r=n(20),o=n(1675),i=n(47);function a(){return s(Object(o.I)())}function s(e){let t=null;return e&&(2===e.tableQuery.type?t=e.tableQuery.folderId:Object(i.j)("grp-loadFolders")&&3===e.tableQuery.type&&(t=e.tableQuery.groupId)),t}function c(){const e=Object(o.I)();return e&&(2==e.tableQuery.type||Object(i.j)("grp-loadFolders")&&3==e.tableQuery.type)}function u(e){return!!e&&(2==e.type||l(e)||Object(i.j)("grp-loadFolders")&&3==e.type)}function l(e){if(!e||1!=e.type)return!1;return"Group"==e.searchScope.kind}function d(e){if(2==e.type)return e.folderId;if(Object(i.j)("grp-loadFolders")&&3==e.type)return e.groupId;if(l(e)){return e.searchScope.groupId}return null}function f(){const e=Object(o.I)();return e&&u(e.tableQuery)}function p(){return Object(i.j)("grp-loadFolders")&&c()}n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return g})),n.d(t,"n",(function(){return v})),n.d(t,"m",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"j",(function(){return O})),n.d(t,"l",(function(){return S})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return p}));const m=new r.c(()=>Promise.all([n.e(19),n.e(48),n.e(61),n.e(452)]).then(n.bind(null,19734))),h=new r.b(m,e=>e.getGroupDisplayName),g=new r.b(m,e=>e.getGroupDisplayNameFromTableView),v=new r.b(m,e=>e.isPrivateUnjoinedGroup),y=new r.b(m,e=>e.isJoinedGroup),b=new r.b(m,e=>e.getRetentionPolicyTagsForGroup),O=new r.b(m,e=>e.getRetentionPolicyTagListForGroupTableQuery),S=new r.b(m,e=>e.isGroupOwner)},1756:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u}));var r,o,i,a=n(1725);!function(e){e.size8="20px",e.size10="20px",e.size16="16px",e.size24="24px",e.size28="28px",e.size32="32px",e.size40="40px",e.size48="48px",e.size56="56px",e.size72="72px",e.size100="100px",e.size120="120px"}(o||(o={})),function(e){e.size6="6px",e.size8="8px",e.size12="12px",e.size16="16px",e.size20="20px",e.size28="28px",e.size32="32px",e.border="2px"}(i||(i={}));var s=function(e){return{isSize8:e===a.c.size8,isSize10:e===a.c.size10||e===a.c.tiny,isSize16:e===a.c.size16,isSize24:e===a.c.size24||e===a.c.extraExtraSmall,isSize28:e===a.c.size28||e===a.c.extraSmall,isSize32:e===a.c.size32,isSize40:e===a.c.size40||e===a.c.small,isSize48:e===a.c.size48||e===a.c.regular,isSize56:e===a.c.size56,isSize72:e===a.c.size72||e===a.c.large,isSize100:e===a.c.size100||e===a.c.extraLarge,isSize120:e===a.c.size120}},c=((r={})[a.c.tiny]=10,r[a.c.extraExtraSmall]=24,r[a.c.extraSmall]=28,r[a.c.small]=40,r[a.c.regular]=48,r[a.c.large]=72,r[a.c.extraLarge]=100,r[a.c.size8]=8,r[a.c.size10]=10,r[a.c.size16]=16,r[a.c.size24]=24,r[a.c.size28]=28,r[a.c.size32]=32,r[a.c.size40]=40,r[a.c.size48]=48,r[a.c.size56]=56,r[a.c.size72]=72,r[a.c.size100]=100,r[a.c.size120]=120,r),u=function(e){return{isAvailable:e===a.b.online,isAway:e===a.b.away,isBlocked:e===a.b.blocked,isBusy:e===a.b.busy,isDoNotDisturb:e===a.b.dnd,isOffline:e===a.b.offline}}},1758:function(e,t,n){"use strict";var r=n(47),o=n(132),i=n(57),a=n(20);const s=new a.c(()=>n.e(970).then(n.bind(null,19895))),c=new a.b(s,e=>e.isReadingPaneConversationEnabled);function u(){var e,t;if(Object(r.j)("mon-rp-unstackedConversation")){return 0==(null===(t=null===(e=Object(i.g)())||void 0===e?void 0:e.UserOptions)||void 0===t?void 0:t.GlobalListViewTypeReact)&&!function(){var e,t;let n=null;const r=c.tryImportForRender();if(r)n=r();else{const r=Object(o.a)("useNativeConversationOptions");let a=null===(e=Object(i.g)())||void 0===e?void 0:e.PrimeSettings;if(null==a?void 0:a.Items)for(let e of a.Items)if("ReadingPaneConversationOptions"===e.Id&&e.Value){const o=null===(t=e.Value.options)||void 0===t?void 0:t[0];n=r?null==o?void 0:o.conversationEnabledNativeHost:null==o?void 0:o.conversationEnabled;break}null==n&&(n=!r)}return n}()}return!1}n.d(t,"a",(function(){return u}))},1765:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},1767:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return p}));var r=n(1678),o=n(1698),i=n(1691),a=n(1792),s=n(1688),c=n(1835),u=n(1839),l=n(1818);function d(e,t){const n=Object(s.a)();if(t){return[...n.values()].filter(n=>n.distinguishedFolderType===e&&n.mailboxInfo.mailboxSmtpAddress===t)[0]}{const t=Object(r.a)(e);return t?n.get(t):void 0}}function f(e,t){if("SharedMailbox"===e&&!t)throw new Error("To get all the shared folders you must pass principalSMTPAddress");let n,r=[];switch(e){case"ArchiveMailbox":n=Object(c.a)(t);break;case"SharedMailbox":n=Object(u.a)(t);break;default:n=Object(a.a)(t)}const s=Object(l.a)();if("UserMailbox"==e&&n.distinguishedFolderType==Object(a.a)(t).distinguishedFolderType&&n.id){const e=s.map(e=>d(e,t)).filter(e=>(null==e?void 0:e.parentFolderId)===n.id);r=t?e.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t).map(e=>e.id):e.map(e=>e.id)}const f=function(e,t){if(!(null==e?void 0:e.childFolderIds))return[];const n=e.childFolderIds.map(e=>i.b.folderTable.get(e));return(t?n.filter(e=>e.mailboxInfo.mailboxSmtpAddress===t):n).map(e=>e.id)}(n,t);for(let e=0;e<f.length;e++)-1==s.indexOf(Object(o.a)(f[e]))&&r.push(f[e]);return r}function p(e,t){const n=Object(s.a)().get(e);return(null==n?void 0:n.mailboxInfo.type)===t}},1771:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1885),o=n(1683);function i(){return o.a.tableViews.get(Object(r.a)())}},1774:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(332);function o(e){var t;return null===(t=Object(r.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1775:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(57);function o(e){var t;return!!(e&((null===(t=Object(r.g)().ViewStateConfiguration)||void 0===t?void 0:t.ListViewBitFlags)||0))}function i(e,t){o(t)!==e&&Object(r.x)(n=>{!function(e,t,n){var r;if(null==(null===(r=t.ViewStateConfiguration)||void 0===r?void 0:r.ListViewBitFlags))return;e?t.ViewStateConfiguration.ListViewBitFlags|=n:t.ViewStateConfiguration.ListViewBitFlags&=~n}(e,n,t)})}},1777:function(e,t,n){"use strict";const r=new RegExp("^data:(image\\/\\w+);base64,([A-Za-z0-9+/=]+?)$","i");function o(e){let t=null;const n=r.exec(e);if(n){const e=n[1],r=n[2];let o=null;try{o=atob(r)}catch(e){}if(o){const n=new ArrayBuffer(o.length),r=new Uint8Array(n);for(let e=0;e<o.length;e++)r[e]=o.charCodeAt(e);t=new File([n],"image.png",{type:e})}}return t}var i=n(1728),a=n(1696);function s(e){return e.map(e=>({fileType:i.a.Uri,name:e.name,type:Object(a.b)(e.url)||"",size:0,uri:e.url}))}var c=n(36);function u(e,t,n){if(e.length!=t.length)return c.d("The sizes of subjects and latestItemIds are different"),null;const r=[];for(let o=0;o<e.length;o++){const a={fileType:i.a.MailItem,name:e[o],size:(null==n?void 0:n[o])||0,itemId:t[o]};r.push(a)}return r}function l(e,t,n){const r=[],o={fileType:i.a.MailItem,name:e,size:n||0,mimeContent:t};return r.push(o),r}function d(e){if(!e)return null;let t=[];for(var n=0;n<e.length;n++){const r=e[n],o={fileType:i.a.Local,name:r.name,size:r.size,type:r.type,fileObject:r};t.push(o)}return t}function f(e){if(!e)return null;const t=[];for(let n=0;n<e.length;n++){const r=e[n],o={fileType:r.fileType,name:r.name,size:r.size,type:r.type,dataUri:r.dataUri};t.push(o)}return t}function p(e){var t,n;if(null===e)return null;return{fileType:i.a.Cloud,name:e.Name,size:e.Size,providerId:e.AttachmentProviderId,providerType:e.ProviderType,location:e.Location,providerEndpointUrl:e.ProviderEndpointUrl,isFolder:1===e.Type,fileId:e.Id,fileParentId:e.ParentId,thumbnailUrl:(null===(t=e.Thumbnail)||void 0===t?void 0:t.Url)||"",previewUrl:(null===(n=e.Preview)||void 0===n?void 0:n.Url)||"",type:e.MimeType}}function m(e){if(null===e)return null;return{attachmentItemId:e.Id,name:e.Name,size:e.Size,fileType:i.a.AttachmentItem,type:"ItemIdAttachment:#Exchange"}}var h=n(1778);function g(e){switch(e?e.toLowerCase():null){case h.d.ONE_DRIVE_PRO.toLowerCase():return 0;case h.d.GDRIVE.toLowerCase():return 5;case h.d.ONE_DRIVE_CONSUMER.toLowerCase():return 1;case h.d.DROPBOX.toLowerCase():return 2;case h.d.BOX.toLowerCase():return 3;case h.d.WOPI_BOX.toLowerCase():return 7;case h.d.WOPI_EGNYTE.toLowerCase():return 8;case h.d.MAILBOX.toLowerCase():return 4;case h.d.FACEBOOK.toLowerCase():return 6;default:return null}}n.d(t,"f",(function(){return o})),n.d(t,"j",(function(){return s})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return i.a}))},1778:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"d",(function(){return m}));const r="Box",o="Dropbox",i="Facebook",a="GDrive",s="Mailbox",c="MailMessage",u="OneDriveConsumer",l="OneDrivePro",d="WopiBox",f="WopiDropbox",p="WopiEgnyte",m={BOX:r,DROPBOX:o,FACEBOOK:i,GDRIVE:a,MAILBOX:s,ONE_DRIVE_CONSUMER:u,ONE_DRIVE_PRO:l,RECENT_ATTACHMENTS:"RecentAttachments",WOPI:"Wopi",WOPI_BOX:d,WOPI_EGNYTE:p}},1785:function(e,t,n){"use strict";const r={};function o(e,t){s(e)&&i(e),r[e]=t}function i(e){delete r[e]}function a(e){return r[e]}function s(e){return!!r[e]}n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))},1788:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"TargetFolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1791:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1831),o=n(1683);function i(e,t){const n=Object(r.a)(e,t);return o.a.tableViewConversationRelations.get(n)}},1792:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1795),o=n(1679);function i(e){return Object(r.a)(o.k,e)}},1795:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1702);function o(e,t){const n=Object(r.a)(t),o=n&&n.get(e);return null==o?void 0:o.rootFolder}},1797:function(e,t,n){"use strict";var r;!function(e){e[e.Unknown=0]="Unknown",e[e.AppointmentOrganizer=1]="AppointmentOrganizer",e[e.AppointmentAttendee=2]="AppointmentAttendee",e[e.MessageCompose=3]="MessageCompose",e[e.MessageRead=4]="MessageRead",e[e.MeetingRequest=5]="MeetingRequest",e[e.DetectedEntity=7]="DetectedEntity",e[e.Events=8]="Events",e[e.LaunchEvent=9]="LaunchEvent",e[e.TrapOnSendEvent=6]="TrapOnSendEvent"}(r||(r={}));var o=r;n.d(t,"a",(function(){return o}))},1799:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"DistinguishedFolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1800:function(e,t,n){"use strict";var r=n(1974),o=n(1675);function i(){return Object(r.a)(Object(o.I)())}n.d(t,"b",(function(){return r.a})),n.d(t,"d",(function(){return r.c})),n.d(t,"c",(function(){return r.b})),n.d(t,"e",(function(){return r.d})),n.d(t,"a",(function(){return i}))},1804:function(e,t,n){"use strict";var r,o,i;n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(r||(r={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(o||(o={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(i||(i={}))},1810:function(e,t,n){"use strict";var r=class{constructor(e,t){if(this.AddinCommands=t,!this.AddinCommands)throw new Error("AddinCommands cannot be null while constructing an addin");this.DisplayName=e.DisplayName,this.IconUrl=e.IconUrl,this.HighResolutionIconUrl=e.HighResolutionIconUrl,this.Id=e.Id}},o=n(6724),i=n(282);class a{constructor(e,t,n,r){if(this.control=e,this.tabInfo=t,this.groupInfo=n,this.extension=r,this.extension=r,o.b(e)){const o=e;this.subCommands=[];for(const e of o.MenuItems)this.subCommands.push(new a(e,t,n,r))}}get isActionable(){return!!this.control.Action}get isMenu(){return!!this.control.MenuItems}get_EntryPoint(){var e;if(o.c(this.control)){return this.control.Action.SourceLocation}return o.a(this.control)?null===(e=this.extension)||void 0===e?void 0:e.ExtensionPointCollection.FunctionFile:(Object(i.a)(this.control),"")}get_Id(){var e;return(null===(e=this.extension)||void 0===e?void 0:e.Id)+this.control.Id}get_Label(){return this.control.Label}get_ExtensionDisplayName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.DisplayName}get_Size16Icon(){return this.control&&this.control.Icon?this.control.Icon.Size16Url:null}getControl(){return this.control}get_Settings(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Settings}get_Version(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Version}get_ExtensionId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Id}get_AppDomains(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppDomains}get_Type(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Type}get_ConsentState(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentState}get_RequestedCapabilities(){var e;return null===(e=this.extension)||void 0===e?void 0:e.RequestedCapabilities}get_IconUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.IconUrl}get_OriginString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.OriginString}get_ExtensionPointCollection(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ExtensionPointCollection}get_ExtendedPermissions(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ExtendedPermissions}get_AppStatus(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppStatus}get_LicenseType(){var e;return null===(e=this.extension)||void 0===e?void 0:e.LicenseType}get_EndNodeUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.EndNodeUrl}get_MarketPlaceAssetId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceAssetID}get_TypeString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.TypeString}get_ProviderName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ProviderName}get_ConsentMetaData(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentMetadata}get_MarketPlaceContentMarket(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceContentMarket}get_WebApplicationResource(){var e;return null===(e=this.extension)||void 0===e?void 0:e.WebApplicationResource}set_ConsentState(e){this.extension.ConsentState=e}set_RequestedCapabilities(e){this.extension.RequestedCapabilities=e}set_TypeString(e){this.extension.TypeString=e}set_ExtensionId(e){this.extension.Id=e}set_OriginString(e){this.extension.OriginString=e}set_Settings(e){this.extension.Settings=e}}var s=a;var c,u=class{constructor(e,t){this.detectedEntity=e,this.extension=t}get_EntryPoint(){return this.detectedEntity.SourceLocation}get_MarketPlaceAssetId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceAssetID}get_Version(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Version}get_Settings(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Settings}get_ConsentState(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentState}get_AppDomains(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppDomains}get_RequestedCapabilities(){var e;return null===(e=this.extension)||void 0===e?void 0:e.RequestedCapabilities}get_IconUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.IconUrl}get_OriginString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.OriginString}get_ExtendedPermissions(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ExtendedPermissions}get_AppStatus(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppStatus}get_LicenseType(){var e;return null===(e=this.extension)||void 0===e?void 0:e.LicenseType}get_EndNodeUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.EndNodeUrl}get_TypeString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.TypeString}get_Id(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Id}get_Label(){return this.detectedEntity.Label}get_ExtensionDisplayName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.DisplayName}get_ExtensionId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Id}get_ActivationRule(){return this.detectedEntity.Rule}get_Size16Icon(){var e;return null===(e=this.extension)||void 0===e?void 0:e.IconUrl}getControl(){return null}get_ExtensionPointCollection(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ExtensionPointCollection}get_WebApplicationResource(){var e;return null===(e=this.extension)||void 0===e?void 0:e.WebApplicationResource}get_ProviderName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ProviderName}get_MarketPlaceContentMarket(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceContentMarket}get_ConsentMetaData(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentMetadata}set_ConsentState(e){this.extension.ConsentState=e}set_RequestedCapabilities(e){this.extension.RequestedCapabilities=e}set_TypeString(e){this.extension.TypeString=e}set_ExtensionId(e){this.extension.Id=e}set_OriginString(e){this.extension.OriginString=e}set_Settings(e){this.extension.Settings=e}};!function(e){e[e.TimedOut=-1]="TimedOut",e[e.Success=0]="Success",e[e.FunctionNotFound=11101]="FunctionNotFound",e[e.NavigatedBeforeCompleted=13001]="NavigatedBeforeCompleted",e[e.PreinstalledConsented=13002]="PreinstalledConsented",e[e.Unknown=13003]="Unknown"}(c||(c={}));var l=c,d=n(3),f=n(1734),p=n(2274),m=Object(d.mutatorAction)("setAutoRunAddinCommandWaitingQueue",(e,t,n)=>{const r=Object(f.a)().autoRunAddinCommandWaitingQueue,o=Object(p.a)(n,t);r.has(o)||r.set(o,new Array),r.get(o).push(e)}),h=Object(d.mutatorAction)("destroyAutoRunAddinCommandFromWaitingQueue",(e,t,n)=>{const r=Object(f.a)().autoRunAddinCommandWaitingQueue,o=Object(p.a)(n,e);if(r.has(o)){const e=r.get(o);for(let n=0;n<e.length;n++)if(e[n].addinCommand===t){e.splice(n,1);break}0===e.length&&r.delete(o)}}),g=n(702),v=n(16);const y="DeferrablePromise timed out";class b{constructor(e){this.internalPromise=new Promise((t,n)=>{this.internalResolve=t,this.internalReject=n,this.timeout=setTimeout(()=>{n(new Error(y)),this.isRejected=!0},e)})}then(e,t){return this.internalPromise.then(e,t)}catch(e){return this.internalPromise.catch(e)}resolve(e){this.isFullfilled&&this.isRejected||(this.internalResolve(e),this.isFullfilled=!0,clearTimeout(this.timeout))}reject(e){this.isFullfilled&&this.isRejected||(this.internalReject(e),this.isRejected=!0,clearTimeout(this.timeout))}reset(e){this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.reject(new Error(y)),this.isRejected=!0},e)}}Symbol.toStringTag;const O=33e4,S=3e5,C={};var A=n(47);const _=[{Id:"8d763f92-e8cb-4843-a9ef-9cba0dca8727",Function:"insertMeetingButton",Name:"BlueJeans",DisplayName:"BlueJeans Meeting",FlightName:"addin-everyMeetingOnlineClient-BlueJeans"},{Id:"7a91e319-a65d-4ceb-909b-12203561dbf5",Function:"apptOrganizerJoinMeetingButton",Name:"Webex",DisplayName:"Cisco Webex Scheduler",FlightName:"addin-everyMeetingOnlineClient-Webex"},{Id:"6df220fc-e48e-4469-8db1-6912ce109886",Function:"addMeetingApptButton",Name:"GoogleMeet",DisplayName:"GoogleMeet",FlightName:"addin-everyMeetingOnlineClient-GoogleMeet"},{Id:"39403046-5079-4d8b-a7d0-d540c95a3a5b",Function:"funcCreateMeetingButton",Name:"GoToMeeting",DisplayName:"GoToMeeting",FlightName:"addin-everyMeetingOnlineClient-GoToMeeting"},{Id:"0ef8b29f-ff7f-4603-b4f3-ea836b406f3f",Function:"addJioMeetButton",Name:"JioMeet",DisplayName:"JioMeet",FlightName:"addin-everyMeetingOnlineClient-JioMeet"},{Id:"a7ca6c74-33fb-43a4-a3e4-781078f0eff5",Function:"addZoomButton",Name:"Zoom",DisplayName:"Zoom",FlightName:"addin-everyMeetingOnlineClient-Zoom"}];var I=n(1841);const x=Object(d.mutatorAction)("setUiLessAddinRunningForEMO",e=>{I.a.uiLessAddinRunningForEMO=e});var E=Object(g.action)("setUilessExtendedAddinCommand")((function(e,t,n,r){var o,i,a;const s=function(e){const t=new b(O);return C[e]=t,t.catch(e=>e.message===y?{status:l.TimedOut}:{status:l.Unknown})}(e),c=Object(p.a)(r,n),u=Object(f.a)().runningUILessExtendedAddinCommands;u.has(c)||u.set(c,new v.ObservableMap),u.get(c).set(e,t);const d=null===(o=null==t?void 0:t.addinCommand)||void 0===o?void 0:o.get_ExtensionId();if(Object(A.j)("addin-everyMeetingOnline")&&(null===(a=null===(i=null==t?void 0:t.addinCommand)||void 0===i?void 0:i.get_ExtensionPointCollection())||void 0===a?void 0:a.AppointmentOrganizerCommandSurface)&&d){let e=null;for(let t of _)if(t.Id==d){e=t.Name;break}e&&x(e)}return s})),T=n(2682),w=n(71),M=n(2),k=n(3572);let j=Object(d.action)("onAutorunExecutionCompleted",(e,t,n,r,o,i)=>({extendedAddinCommand:e,controlId:t,hostItemIndex:n,status:r,targetWindow:o,completedContext:i}));Object(d.orchestrator)(j,e=>{e.extendedAddinCommand.addinCommandTelemetry.setExecutionEndTime();const t=e.extendedAddinCommand.addinCommand;Object(w.o)("AddinExecutionCompleted",{id:Object(k.a)(t.get_MarketPlaceAssetId(),t.get_ExtensionId(),t.get_ProviderName(),t.get_TypeString()),controlId:e.controlId,owa_1:Object(M.m)(),owa_2:Object(pe.c)(e.hostItemIndex),executionEndTime:e.extendedAddinCommand.addinCommandTelemetry.getExecutionEndTime()}),Ve(e.controlId,e.hostItemIndex,e.status,e.targetWindow,e.completedContext),Object(f.a)().activeAutorunUilessFrames.delete(e.controlId),N(e.hostItemIndex,e.targetWindow)});var P=j;const R=(e,t,n,r)=>{e.forEach(e=>{r&&(e.launchEventArgs=r),e.controlId=z(t,e.addinCommand.get_Id(),n),e.addinCommandTelemetry.setQueuePushTime(),m(e,t,n)})},N=(e,t)=>{F(e,t).forEach(n=>{L(e,t)&&(n.addinCommandTelemetry.setQueuePopTime(),D(n,e,t))})},D=(e,t,n)=>{const r=e.addinCommand,o=e.controlId;U(r.get_Id(),t,n)?Object(f.a)().activeAutorunUilessFrames.get(o).invokeAppCommand(r.getControl(),e.launchEventArgs):E(o,e,t,n).then(r=>{r.status==l.TimedOut&&P(e,o,t,l.TimedOut,n)}),h(t,r,n)},F=(e,t)=>{const n=Object(p.a)(t,e),r=Object(f.a)().autoRunAddinCommandWaitingQueue.get(n);return r||[]},L=(e,t)=>!(H(e,t)||B()),U=(e,t,n)=>{const r=Object(p.a)(n,t),o=Object(f.a)().runningUILessExtendedAddinCommands;let i=!1;return!!o.has(r)&&(o.get(r).forEach(t=>{const n=t.addinCommand;V(n)&&n.get_Id()===e&&(i=!0)}),i)},B=()=>{const e=Object(f.a)().runningUILessExtendedAddinCommands;let t=0;return e.forEach(e=>{e.forEach(e=>{const n=e.addinCommand;V(n)&&(t+=1)})}),t>=20},H=(e,t)=>{const n=Object(f.a)().runningUILessExtendedAddinCommands;let r=0;const o=Object(p.a)(t,e);return n.has(o)&&n.get(o).forEach(e=>{const t=e.addinCommand;V(t)&&(r+=1)}),r>=5},V=e=>e instanceof T.a,z=(e,t,n)=>{let r=null;const o=Object(p.a)(n,e),i=Object(f.a)().runningUILessExtendedAddinCommands;return i.has(o)&&i.get(o).forEach(e=>{r=W(e,t)?e.controlId:r}),r||(F(e,n).forEach(e=>{r=W(e,t)?e.controlId:r}),r||_e())},W=(e,t)=>e.controlId&&e.addinCommand.get_Id()===t;var G=n(2991);class q{CreateAddinCommand(e,t,n,r){return new s(e,t,n,r)}CreateContextualAddinCommand(e,t){return new u(e,t)}CreateEventAddinCommand(e,t){switch(e.Type){case 1:return new s({Id:"ItemSend",Action:e},null,null,t)}return null}CreateAutoRunAddinCommand(e,t,n){let r;switch(e.Type){case 0:r="Unknown";break;case 1:r="OnNewMessageCompose";break;case 2:r="OnNewAppointmentOrganizer";break;case 3:r="OnMessageAttachmentsChanged";break;case 4:r="OnAppointmentAttachmentsChanged";break;case 5:r="OnMessageSend";break;case 6:r="OnAppointmentSend";break;case 7:r="OnMessageRecipientsChanged";break;case 8:r="OnAppointmentAttendeesChanged";break;case 9:r="OnAppointmentTimeChanged";break;case 10:r="OnAppointmentRecurrenceChanged";break;case 11:r="OnInfoBarDismissClicked";break;default:r="Unknown"}const o={Id:r,Action:e};return new T.a(e.Type,o,t,n)}}var K=n(1797);function X(e,t){switch(t){case K.a.MeetingRequest:return e.MessageReadCommandSurface;case K.a.AppointmentAttendee:return e.AppointmentAttendeeCommandSurface;case K.a.AppointmentOrganizer:return e.AppointmentOrganizerCommandSurface;case K.a.DetectedEntity:return e.DetectedEntity;case K.a.MessageCompose:return e.MessageComposeCommandSurface;case K.a.MessageRead:return e.MessageReadCommandSurface;case K.a.LaunchEvent:return e.LaunchEvent;case K.a.TrapOnSendEvent:default:return null}}const Q="User",J="MarketPlace";function Y(e,t,n){return!(!e||t!=Q||n!=J)}class Z{constructor(e){this.addinCommandFactory=e,this.GetAutoRunAddinCommands=(e,t,n)=>{if(!e)return null;const r={},o=Object(A.j)("addin-autoRun")&&Object(A.j)("addin-autoRun-shouldBlockUserInstalledStoreAddin");return e.LaunchEvents.forEach(e=>{o&&Y(t.MarketplaceAssetID,t.OriginString,t.TypeString)||this.isLaunchEventTypeSupported(e.Type)&&(r[e.Type.toString()]=this.addinCommandFactory.CreateAutoRunAddinCommand(e,t,n))}),new v.ObservableMap(r)}}CreateAddinIfEntryPointSupported(e,t){let n;return n=t==K.a.TrapOnSendEvent?this.GetEventsAddinCommands(e.ExtensionPointCollection.Events,e):t==K.a.DetectedEntity?this.GetContextualAddinCommand(X(e.ExtensionPointCollection,t),e):t==K.a.LaunchEvent?this.GetAutoRunAddinCommands(X(e.ExtensionPointCollection,t),e,t):this.GetAddinCommands(X(e.ExtensionPointCollection,t),e),n?new r(e,n):null}GetAddinCommands(e,t){if(!e)return null;const n={};return e.Tabs.forEach(e=>{e.Groups.forEach(r=>{r.Controls.forEach(o=>{n[o.Id]=this.addinCommandFactory.CreateAddinCommand(o,e,r,t)})})}),new v.ObservableMap(n)}GetContextualAddinCommand(e,t){if(!e)return null;const n={};return n[t.Id]=this.addinCommandFactory.CreateContextualAddinCommand(e,t),new v.ObservableMap(n)}GetEventsAddinCommands(e,t){if(!e)return null;const n={};return e.forEach(e=>{n[e.Type]=this.addinCommandFactory.CreateEventAddinCommand(e,t)}),new v.ObservableMap(n)}isLaunchEventTypeSupported(e){return 1==e||2==e||7==e||8==e||3==e||4==e||11==e||9==e||10==e}}var $=Object(d.mutatorAction)("closeAllAutoRunCommandsforHostItemIndex",(e,t)=>{const n=Object(f.a)().autoRunAddinCommandWaitingQueue,r=Object(p.a)(t,e);n.delete(r)});function ee(){return{regExMatches:{},matchedKnownEntityTypes:[],filteredEntityMatches:{}}}var te=Object(g.action)("destroyExtensibilityHostItem")((function(e){I.a.HostItems.delete(e)}));function ne(e){return!!e&&!!e.SupportsSharedFolders}function re(e){return e.filter(e=>{return ne(function(e){const t=[...e.AddinCommands.values()];if(0==t.length)return null;return t[0].get_ExtensionPointCollection()}(e))})}function oe(e){return e.filter(e=>{return ne(e.get_ExtensionPointCollection())})}function ie(e){return ne(e.get_ExtensionPointCollection())}var ae=n(3343);var se=e=>{const t=Object(f.a)().EnabledAddinCommands;return t?t.getAutoRunAddinsByLaunchEventType(e).map(t=>t.AddinCommands.get(e.toString())):[]},ce=n(4828),ue=n(2313),le=n(2061);function de(e){const{activeDialogs:t}=Object(f.a)();for(let n of t.values())if(n&&e===n.controlId)return 5;return Object(ue.c)(e)?2:Object(ce.a)(e)?1:Object(le.b)(e)?3:4}function fe(e){const t=Object(f.a)();return[...function(e,t){let n=[],r=t.taskPanes;for(let t of r.values())for(let r of t.values())r.hostItemIndex===e&&n.push(r.controlId);return n}(e,t),...function(e,t){let n=[];return t.runningUILessExtendedAddinCommands.forEach((t,r)=>{if(JSON.parse(r).hostItemIndex===e)for(let e of t.keys())n.push(e)}),n}(e,t),...function(e,t){const n=t.runningContextualAddinCommand;if(n&&n.hostItemIndex===e)return[t.runningContextualAddinCommand.controlId];return[]}(e,t)]}var pe=n(2267);function me(){return I.a.Context}function he(e){const t=Object(ae.a)(e);return t&&t.get_ExtensionId()}function ge(e){return I.a.HostItems.get(e)}var ve=n(1979);function ye(e){const t=Object(ue.c)(e);if(t){const e=Object(ve.a)(t.targetWindow);let n=e?e.tabId:t.targetWindow===window?"Main":null;const r=Object(f.a)().taskPanes.get(n);if(!r)return null;for(let e of r.values())return Object(p.a)(e.targetWindow,e.hostItemIndex)}const n=Object(ce.a)(e);return n?n.hostItemIndex:Object(le.a)(e)}function be(e){return Object(ae.a)(e).get_WebApplicationResource()}var Oe=n(2850);function Se(e){Object(Oe.a)()?e():Object(v.when)(Oe.a,e)}function Ce(){return I.a.ExtensibilityStateIsDirty}var Ae=n(326);function _e(){return Object(Ae.a)()}var Ie=Object(g.action)("terminateContextualCallout")((function(){const e=Object(f.a)();e.runningContextualAddinCommand=null,e.contextualCalloutState.contextualAnchor=null,e.contextualCalloutState.activeContextualAddinCommands=[],e.contextualCalloutState.selectedTerms=[]})),xe=Object(g.action)("initializeContextualCallout")((function(e,t,n){const r=Object(f.a)();r.runningContextualAddinCommand&&Ie();const o=ge(t),i=new v.ObservableMap,a=r.contextualCalloutState;a.selectedTerms=[],e.forEach(e=>{const t=o.contextualTerms.get(e).slice();t&&t.length>0&&(a.selectedTerms.push(e),t.forEach(e=>{i.set(e.get_Id(),e)}))}),a.contextualAnchor=n,a.activeContextualAddinCommands=[...i.values()],a.hostItemIndex=t})),Ee=Object(g.action)("initializeExtensibilityHostItem")((function(e){I.a.HostItems.has(e)||I.a.HostItems.set(e,{contextualTerms:null,contextualEvaluationResults:null})})),Te=n(5322);function we(e){var t;return!!(t=e,I.a.activeDialogs.get(t))}function Me(e){return Object(f.a)().HostItems.has(e)}var ke=Object(d.mutatorAction)("setActiveDialog",(function(e,t,n){const{activeDialogs:r}=Object(f.a)(),o=Object(p.a)(t,n);e?r.set(o,e):r.delete(o)}));var je=Object(g.action)("setEnabledAddinCommands")((function(e){I.a.EnabledAddinCommands=e})),Pe=n(57);var Re=Object(g.action)("setExtensibilityContext")((function(e){var t;if(null==e?void 0:e.Extensions){const n=Object(Pe.g)(),r=null===(t=null==n?void 0:n.UserOptions)||void 0===t?void 0:t.WebSuggestedRepliesEnabledForUser;let o=-1;for(let t=0;t<e.Extensions.length;t++){let n=e.Extensions[t];"599e5de2-d41c-442a-bdb4-92eafa18a0dc"===n.Id&&null==n.ExtensionPointCollection.DetectedEntity&&(n.ExtensionPointCollection.DetectedEntity=n.ExtensionPointCollection.CustomPane,n.ExtensionPointCollection.DetectedEntity.Label=n.DisplayName),r&&"bc13b9d0-5ba2-446a-956b-c583bdc94d5e"===n.Id&&Object(A.j)("mc-smartReplyWithCustomMeeting")&&(o=t)}o>=0&&e.Extensions.splice(o,1)}I.a.Context=e})),Ne=Object(g.action)("setExtensibilityStateIsDirty")((function(e){I.a.ExtensibilityStateIsDirty=e})),De=Object(g.action)("setContextualAddinCommand")((function(e,t,n){Object(f.a)().runningContextualAddinCommand=function(e,t,n){return{controlId:e,addinCommand:t,hostItemIndex:n}}(e,n,t)})),Fe=Object(d.mutatorAction)("setTaskPaneAddinCommand",(function(e,t,n,r,o,i,a){const{taskPanes:s}=Object(f.a)(),c=Object(ve.a)(i);let u=c?c.tabId:i===window?"Main":null;const l=function(e,t,n,r,o,i,a){return{controlId:e,addinCommand:t,hostItemIndex:n,targetWindow:r,mode:o,errorType:i||0,initializationContext:a}}(e,n,t,i,o,null,a);s.has(u)||s.set(u,new v.ObservableMap),s.get(u).set(r,l)})),Le=n(2555),Ue=n(2584),Be=Object(d.mutatorAction)("terminateTaskPaneAddin",(function(e,t,n){const{taskPanes:r}=Object(f.a)(),o=Object(ve.a)(n);let i=o?o.tabId:n===window?"Main":null;r.has(i)&&(r.get(i).delete(e),0===r.get(i).size&&r.delete(i))})),He=Object(d.mutatorAction)("terminatePersistantTaskPaneAddinWithAppId",(function(e){var t;const{taskPanes:n}=Object(f.a)();for(let[r,o]of n){const i=o.get("Persistent");(null===(t=null==i?void 0:i.addinCommand)||void 0===t?void 0:t.get_ExtensionId())===e&&(n.get(r).delete("Persistent"),0===n.get(r).size&&n.delete(r))}})),Ve=Object(g.action)("terminateUiLessExtendedAddinCommand")((function(e,t,n,r,o){const i=Object(p.a)(r,t);!function(e,t){if(C[e]){C[e].resolve(t),delete C[e]}}(e,{status:n,allowEvent:null==o?void 0:o.allowEvent});const a=Object(f.a)().runningUILessExtendedAddinCommands;a.has(i)&&(a.get(i).delete(e),0===a.get(i).size&&a.delete(i))})),ze=Object(g.action)("timeoutResetUiLessExtendedAddinCommand")((function(e){!function(e){C[e]&&C[e].reset(S)}(e)})),We=Object(d.mutatorAction)("toggleTaskPaneType",(function(e,t){const{taskPanes:n}=Object(f.a)();if("Persistent"===e)for(let[r,o]of n)if(1===n.get(r).size){for(let[i,a]of o)if("Persistent"===i&&a.addinCommand.get_ExtensionId()===t){const t=Object(ue.b)(i,a.hostItemIndex,a.targetWindow);n.get(r).delete(i),n.get(r).set(Object(ue.a)(e),t)}}else n.get(r).delete(e);if("NonPersistent"===e)for(let[e,r]of n)if(1===n.get(e).size){for(let[o,i]of r)if("NonPersistent"===o&&i.addinCommand.get_ExtensionId()===t||"Persistent"===o&&i.addinCommand.get_ExtensionId()!==t){const t=Object(ue.b)(o,i.hostItemIndex,i.targetWindow);n.get(e).delete(o),n.get(e).set(Object(ue.a)(o),t)}}else{const o=["Persistent","NonPersistent"];for(let i=0;i<o.length;i++){let a=o[i];const s=r.get(a);if("NonPersistent"===a&&s.addinCommand.get_ExtensionId()===t){const t=Object(ue.b)(a,s.hostItemIndex,s.targetWindow);n.get(e).delete(a),n.get(e).set(Object(ue.a)(a),t)}else"Persistent"===a&&s.addinCommand.get_ExtensionId()!==t&&n.get(e).delete(a)}}})),Ge=Object(g.action)("updateConsentState")((function(e,t,n){Object(ae.a)(t).set_ConsentState(Number(n))})),qe=Object(g.action)("updateContextualEvaluation")((function(e,t,n,r={hostItem:I.a.HostItems.get(e)}){const o=r.hostItem;o&&(o.contextualTerms=t,o.contextualEvaluationResults=n)})),Ke=Object(g.action)("updateEntityExtractionResult")((function(e,t){e.EntityExtractionResult=t})),Xe=Object(g.action)("updateExtensionSettings")((function(e,t,n){Object(ae.a)(t).set_Settings(n)})),Qe=Object(d.mutatorAction)("updateFrameworkComponentHostItemIndexMap",(function(e,t,n){const{frameworkComponentHostItemIndexMap:r}=Object(f.a)();if(t&&n){const o={hostItemIndex:t,targetWindow:n};r.set(e,o)}else r.delete(e)})),Je=Object(d.mutatorAction)("updatePersistentTaskPaneHostItem",(function(e,t,n){const r=Object(ve.a)(n);let o=r?r.tabId:n===window?"Main":null;const{taskPanes:i,frameworkComponentHostItemIndexMap:a}=Object(f.a)();if(i.has(o)){const r=Object(ue.b)("Persistent",e,n);r.hostItemIndex=t,r.errorType=0}if(!i.has(o)){i.set(o,new v.ObservableMap);const e=Object(ue.b)("Persistent",t,n);i.get(o).set("Persistent",e);const r={hostItemIndex:t,targetWindow:n};a.set("exfc_main",r)}})),Ye=Object(g.action)("updateMailReadSurfaceNewAddin")((function(e){I.a.mailReadSurfaceNewAddinId=e})),Ze=Object(g.action)("updateMailComposeSurfaceNewAddin")((function(e){I.a.mailComposeSurfaceNewAddinId=e})),$e=Object(g.action)("updateCalendarSurfaceNewAddin")((function(e){I.a.calendarSurfaceNewAddinId=e})),et=Object(d.mutatorAction)("updateAnyNewAdminAddinInstalled",(function(e){I.a.anyNewAdminAddinInstalled=e}));var tt=Object(g.action)("setCompliance")((function(e){const t=JSON.parse(e);t&&t.hasOwnProperty("IsMinor")&&(I.a.compliance.isMinor=t.IsMinor)})),nt=(n(2556),n(2557));const rt=Object(d.mutatorAction)("updateUnpinnedAdminAddins",(e,t)=>{switch(t){case K.a.MessageRead:I.a.mailReadSurfaceUnpinnedAdminAddins=e;break;case K.a.MessageCompose:I.a.mailComposeSurfaceUnpinnedAdminAddins=e;break;case K.a.AppointmentOrganizer:I.a.appointmentOrganizerSurfaceUnpinnedAdminAddins=e;break;case K.a.AppointmentAttendee:I.a.appointmentAttendeeSurfaceUnpinnedAdminAddins=e}}),ot=Object(d.mutatorAction)("updateStoreToHighlightAddins",e=>{I.a.shouldHighlightUnpinnedAdminAddins=!0,I.a.themeSpecificHighlightDataStore=e});n(2558);n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"N",(function(){return V})),n.d(t,"e",(function(){return R})),n.d(t,"V",(function(){return N})),n.d(t,"A",(function(){return G.b})),n.d(t,"b",(function(){return q})),n.d(t,"c",(function(){return Z})),n.d(t,"g",(function(){return $})),n.d(t,"j",(function(){return I.a})),n.d(t,"h",(function(){return ee})),n.d(t,"i",(function(){return te})),n.d(t,"l",(function(){return re})),n.d(t,"f",(function(){return ie})),n.d(t,"k",(function(){return oe})),n.d(t,"m",(function(){return ae.a})),n.d(t,"q",(function(){return se})),n.d(t,"s",(function(){return de})),n.d(t,"p",(function(){return fe})),n.d(t,"E",(function(){return ue.b})),n.d(t,"F",(function(){return ue.c})),n.d(t,"G",(function(){return ue.d})),n.d(t,"B",(function(){return pe.c})),n.d(t,"r",(function(){return pe.a})),n.d(t,"t",(function(){return me})),n.d(t,"u",(function(){return f.a})),n.d(t,"w",(function(){return he})),n.d(t,"y",(function(){return ge})),n.d(t,"n",(function(){return ye})),n.d(t,"x",(function(){return X})),n.d(t,"I",(function(){return be})),n.d(t,"O",(function(){return Oe.a})),n.d(t,"xb",(function(){return Se})),n.d(t,"P",(function(){return Ce})),n.d(t,"z",(function(){return _e})),n.d(t,"J",(function(){return xe})),n.d(t,"K",(function(){return Ee})),n.d(t,"M",(function(){return le.e})),n.d(t,"S",(function(){return le.f})),n.d(t,"H",(function(){return le.c})),n.d(t,"R",(function(){return Te.a})),n.d(t,"L",(function(){return we})),n.d(t,"Q",(function(){return Me})),n.d(t,"T",(function(){return Y})),n.d(t,"U",(function(){return P})),n.d(t,"W",(function(){return ke})),n.d(t,"Z",(function(){return je})),n.d(t,"ab",(function(){return Re})),n.d(t,"bb",(function(){return Ne})),n.d(t,"Y",(function(){return De})),n.d(t,"cb",(function(){return Fe})),n.d(t,"db",(function(){return E})),n.d(t,"eb",(function(){return Le.a})),n.d(t,"o",(function(){return p.a})),n.d(t,"D",(function(){return Ue.b})),n.d(t,"C",(function(){return Ue.a})),n.d(t,"fb",(function(){return Ie})),n.d(t,"hb",(function(){return Be})),n.d(t,"gb",(function(){return He})),n.d(t,"ib",(function(){return Ve})),n.d(t,"jb",(function(){return ze})),n.d(t,"kb",(function(){return We})),n.d(t,"nb",(function(){return Ge})),n.d(t,"ob",(function(){return qe})),n.d(t,"pb",(function(){return Ke})),n.d(t,"qb",(function(){return Xe})),n.d(t,"rb",(function(){return Qe})),n.d(t,"ub",(function(){return Je})),n.d(t,"tb",(function(){return Ye})),n.d(t,"sb",(function(){return Ze})),n.d(t,"mb",(function(){return $e})),n.d(t,"lb",(function(){return et})),n.d(t,"X",(function(){return tt})),n.d(t,"v",(function(){return nt.a})),n.d(t,"wb",(function(){return rt})),n.d(t,"vb",(function(){return ot}))},1816:function(e,t,n){"use strict";function r(e){return function(e){const t=i.exec(e);return t&&t.length>1&&o[t[1].toLowerCase()]}(e||"")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a}));const o={"image/bmp":".bmp","image/x-ms-bmp":".bmp","image/gif":".gif","image/jpeg":".jpeg","image/png":".png","image/vnd.adobe.photoshop":".psd","image/tiff":".tiff"},i=/^\s*([^;\s]*)(?:;|\s|$)/;function a(e){let t="";return Object.entries(o).forEach(n=>{n[1]===e&&(t=n[0])}),t}},1817:function(e,t,n){"use strict";var r=n(0),o=n(23),i=Object(o.a)((function(e){return r.createElement(r.Fragment,null,e.location)}));const a=/\(([^)]*)\)/gi,s=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,c=/\s+/gi;function u(e){let t="";if(!e)return t;let n=(e=(e=(e=(e=e.replace(a,"")).replace(s,"")).replace(c," ")).trim()).split(" ");return n.length>=2?(t+=n[0].charAt(0).toUpperCase(),t+=n[n.length-1].charAt(0).toUpperCase()):0!=n.length&&(t+=n[0].charAt(0).toUpperCase()),t}var l=n(1725);const d=Object.keys(l.a).length/2;function f(e){if(!e)return null;let t=0;for(let r=e.length-1;r>=0;r--){let o=e.charCodeAt(r);var n=r%8;t^=(o<<n)+(o>>8-n)}return t%d}function p(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:u(e),textBoyColor:f(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}var m=n(1935);var h=n(703);function g(e){var t;if(e){let n=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),r=Object(m.c)(e.DisplayName,n);return"Room"==e.PersonaTypeString&&(n.LocationUri=e.EmailAddress.EmailAddress),{personaId:null===(t=e.PersonaId)||void 0===t?void 0:t.Id,feedbackId:e.FeedbackId,displayName:r,postalAddress:n,emailAddress:e.EmailAddress,displayAddress:Object(m.a)(n),initials:u(r),textBoyColor:f(r),selectionSource:"LocationWell",personaType:Object(h.a)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity,entityType:e.EntityType,audioDeviceName:e.AudioDeviceName,displayDeviceName:e.DisplayDeviceName,videoDeviceName:e.VideoDeviceName,isWheelChairAccessible:e.IsWheelChairAccessible}}return null}var v=n(1911);function y(e){if((null==e?void 0:e.DisplayName)&&e.PostalAddress){let t=Object(m.c)(e.DisplayName,e.PostalAddress),n=Object(v.a)(e.PostalAddress)&&!Object(h.a)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:n,displayAddress:Object(m.a)(e.PostalAddress),initials:u(t),textBoyColor:f(t),personaType:Object(v.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var b=n(6),O=n(38),S=n(327),C=n(283);const A=290,_=135;function I(e,t,n,r,o,i){o=o||A,i=i||_;const a=Object(O.a)();if((!Object(h.a)(n)||e&&t)&&a.PolicySettings.PlacesEnabled){var s=Object(b.c)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",e&&e.toString(),t&&t.toString(),encodeURIComponent(n),Object(b.e)(),o,i);Object(S.b)(s,void 0,!0).then(e=>{Object(C.a)(e.status)?e.json().then(e=>{r(`data:image/png;base64,${e.ib}`)}):r("")})}else r("")}var x=n(2412),E=n(36),T=n(307),w=n.n(T);const M=Object(o.a)((function(e){var t,n;const o=r.useRef(),[i,a]=r.useState(null);r.useEffect(()=>{var t;let n=!0;return(null===(t=e.locationPersona)||void 0===t?void 0:t.postalAddress)&&e.locationPersona.postalAddress.Latitude&&e.locationPersona.postalAddress.Longitude&&!Object(h.a)(e.locationPersona.displayName)&&!i&&"pending"!=o.current&&"failed"!=o.current&&(o.current="pending",I(e.locationPersona.postalAddress.Latitude,e.locationPersona.postalAddress.Longitude,null,(function(e){n&&(a(e),e?o.current="success":(o.current="failed",E.h.warn("getLocationPhoto.downloadLocationPhoto failed")))}),64,64)),()=>n=!1},[null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Latitude,null===(n=e.locationPersona.postalAddress)||void 0===n?void 0:n.Longitude,e.locationPersona.displayName]);let{locationPersona:s,className:c,size:u,showPersonaDetails:d}=e;if(s){let e={};return Object(h.a)(i)?w()(e,{imageInitials:s.initials,initialsColor:s.textBoyColor}):w()(e,{imageUrl:i,imageShouldFadeIn:!1}),r.createElement(x.a,Object.assign({className:c,presence:l.b.none,hidePersonaDetails:!d,size:u,text:s.displayName,secondaryText:s.displayAddress},e))}return null})),k="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}&FORM=CalLoc",j="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}&FORM=CalLoc";function P(e,t,n,r){return e&&t?Object(b.c)(k,e.toString(),t.toString(),n,r):n?Object(b.c)(j,n,r):null}var R=n(2011),N=n(20);function D(e,t){return{Id:t,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:t,Type:"Business"}}}var F=n(1842);function L(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function U(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function B(e,t,n,r){return e?{PostalAddress:{LocationUri:n,LocationSource:r,Type:t,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}var H=n(1907);function V(e){let t=[];return e&&"string"!=typeof e&&t.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),t}n.d(t,"t",(function(){return W})),n.d(t,"b",(function(){return G})),n.d(t,"m",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"k",(function(){return y})),n.d(t,"a",(function(){return M})),n.d(t,"n",(function(){return P})),n.d(t,"o",(function(){return I})),n.d(t,"r",(function(){return R.a})),n.d(t,"s",(function(){return v.a})),n.d(t,"g",(function(){return D})),n.d(t,"c",(function(){return F.a})),n.d(t,"d",(function(){return F.b})),n.d(t,"e",(function(){return F.c})),n.d(t,"p",(function(){return L})),n.d(t,"h",(function(){return U})),n.d(t,"i",(function(){return B})),n.d(t,"f",(function(){return H.a})),n.d(t,"u",(function(){return H.d})),n.d(t,"q",(function(){return H.b})),n.d(t,"j",(function(){return V}));const z=new N.c(()=>Promise.all([n.e(22),n.e(25),n.e(35),n.e(647)]).then(n.bind(null,19814)));let W=new N.b(z,e=>e.createTxpPostalAddressFromLocationPersona);const G=Object(N.d)(z,e=>e.WebUrlLocation,i)},1818:function(e,t,n){"use strict";var r=n(57),o=n(47);function i(e){var t;const n=Object(r.g)().SegmentationSettings,i=null===(t=Object(r.g)().SessionSettings)||void 0===t?void 0:t.IsShadowMailbox;return"junkemail"===e?!!(null==n?void 0:n.JunkEMail):"notes"!==e||!!(null==n?void 0:n.StickyNotes)&&Object(o.j)("cal-stickyNotesFolder")&&!i}var a=n(296);function s(){const e=Object(a.a)()?["inbox","junkemail","drafts","sentitems","scheduled","deleteditems","archive"]:["inbox","drafts","sentitems","scheduled","deleteditems","junkemail","archive"];return Object(o.j)("notes-folder-view")&&e.push("notes"),e}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}))},18181:function(e){e.exports=JSON.parse('{"b":"B9b","a":"C9b"}')},1823:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(7);const o=Object(r.Vb)("UTC",4500,8,1);Object(r.vb)(o).slice(0,-1);function i(e){return s(e.lastDeliveryOrRenewTimeStamp)}function a(e){return s(e.ReceivedOrRenewTime)}function s(e){if(e===c())return!0;return new Date(e).getTime()==Object(r.Cb)(o)}function c(){try{return new Date(Object(r.Cb)(o)).toLocaleString(),Object(r.qc)(o).toString()}catch(e){return null}}},1824:function(e,t,n){"use strict";var r=n(16),o=n(3);const i={attachments:new r.ObservableMap({})},a=Object(o.createStore)("attachment",i);t.a=a},1828:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("SET_LOADING_STATE_FOR_FOLDER_TREE",(e,t,n)=>({folderTreeId:e,loadingState:t,userIdentity:n}))},1829:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("ON_QUERY_FOLDERHIERARCHY",(e,t,n,r,o,i,a,s,c)=>({rootFolder:e,folders:t,distinguishedFolderId:n,principalSMTPAddress:r,displayName:o,folderTreeIdentifier:i,userIdentity:a,includesLastItemInRange:s,offset:c}))},1830:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(1691);function o(e){return"msgfolderroot"===e.distinguishedFolderType}let i=function(e,t,n={folderTable:r.b.folderTable}){const o=!!e&&e.parentFolderId;if(!o)return!1;let i=n.folderTable.get(o);for(;i;){if(i.distinguishedFolderType==t)return!0;if(!i.parentFolderId)return!1;i=n.folderTable.get(i.parentFolderId)}return!1};function a(e,t,n={folderTable:r.b.folderTable}){return function(e,t){return!!e&&e.distinguishedFolderType==t}(e,t)||i(e,t,n)}},1831:function(e,t,n){"use strict";function r(e,t){return t+e}n.d(t,"a",(function(){return r}))},1833:function(e,t,n){"use strict";var r=n(2555),o=n(2743),i=n(3),a=Object(i.mutatorAction)("appendOnSendAction",(e,t)=>{const n=e.appendOnSend;if(!n)return;let r=!1;for(let o=0;o<n.length;o++)if(n[o].id===t.id){e.appendOnSend[o]=t,r=!0;break}r||e.appendOnSend.push(t)}),s=n(1687),c=n(2267),u=n(2737),l=n(2648),d=n(2738),f=n(2374),p=n(2061),m=n(2764),h=n(2452),g=n(1926),v=n(2571),y=n(1785),b=n(2585),O=n(2649),S=n(2650),C=n(2651),A=n(2556),_=n(2557),I=n(2558);n.d(t,"Z",(function(){return r.a})),n.d(t,"ab",(function(){return o.a})),n.d(t,"k",(function(){return a})),n.d(t,"N",(function(){return s.v})),n.d(t,"W",(function(){return s.E})),n.d(t,"w",(function(){return s.d})),n.d(t,"R",(function(){return s.z})),n.d(t,"U",(function(){return s.C})),n.d(t,"V",(function(){return s.D})),n.d(t,"T",(function(){return s.B})),n.d(t,"S",(function(){return s.A})),n.d(t,"y",(function(){return s.f})),n.d(t,"B",(function(){return s.i})),n.d(t,"C",(function(){return s.j})),n.d(t,"J",(function(){return s.r})),n.d(t,"X",(function(){return s.F})),n.d(t,"O",(function(){return s.w})),n.d(t,"F",(function(){return s.n})),n.d(t,"Q",(function(){return s.y})),n.d(t,"j",(function(){return s.a})),n.d(t,"I",(function(){return s.q})),n.d(t,"M",(function(){return s.u})),n.d(t,"D",(function(){return s.l})),n.d(t,"u",(function(){return s.b})),n.d(t,"K",(function(){return s.s})),n.d(t,"v",(function(){return s.c})),n.d(t,"L",(function(){return s.t})),n.d(t,"G",(function(){return s.o})),n.d(t,"x",(function(){return s.e})),n.d(t,"P",(function(){return s.x})),n.d(t,"A",(function(){return s.h})),n.d(t,"z",(function(){return s.g})),n.d(t,"H",(function(){return s.p})),n.d(t,"E",(function(){return s.m})),n.d(t,"n",(function(){return c.a})),n.d(t,"q",(function(){return c.b})),n.d(t,"i",(function(){return u.a})),n.d(t,"h",(function(){return l.a})),n.d(t,"l",(function(){return d.a})),n.d(t,"Y",(function(){return f.a})),n.d(t,"t",(function(){return p.d})),n.d(t,"f",(function(){return m.a})),n.d(t,"o",(function(){return h.e})),n.d(t,"c",(function(){return g.b})),n.d(t,"b",(function(){return v.a})),n.d(t,"m",(function(){return y.c})),n.d(t,"a",(function(){return b.a})),n.d(t,"d",(function(){return O.a})),n.d(t,"e",(function(){return S.a})),n.d(t,"g",(function(){return C.a})),n.d(t,"r",(function(){return A.a})),n.d(t,"p",(function(){return _.a})),n.d(t,"s",(function(){return I.a}))},1835:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1795),o=n(1679);function i(e){return Object(r.a)(o.d,e)}},1839:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1795);function o(e){return Object(r.a)(e)}},1841:function(e,t,n){"use strict";var r=n(3);var o=n(16);const i=Object(r.createStore)("extensibility",{EnabledAddinCommands:null,HostItems:new o.ObservableMap,IsPreinstalledTeachingUIAvailable:!1,Context:null,frameworkComponentHostItemIndexMap:new o.ObservableMap,taskPanes:new o.ObservableMap,activeDialogs:new o.ObservableMap,ExtensibilityStateIsDirty:!1,contextualCalloutState:{activeContextualAddinCommands:[],contextualAnchor:null,hostItemIndex:null,selectedTerms:[]},runningContextualAddinCommand:null,runningUILessExtendedAddinCommands:new o.ObservableMap,autoRunAddinCommandWaitingQueue:new o.ObservableMap,compliance:{isMinor:!1},activeAutorunUilessFrames:new o.ObservableMap})();t.a=i},1842:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(1911);function o(e,t){if(null==e&&null!=t||null!=e&&null==t)return!1;if(null==e&&null==t)return!0;if(0==e.length&&0==t.length)return!0;if(e.length!=t.length)return!1;let n=0;for(;n<e.length;){if(!i(e[n],t[n]))return!1;n++}return!0}function i(e,t){return!(!e&&t||e&&!t)&&(e.Id===t.Id||Object(r.a)(e.PostalAddress)&&Object(r.a)(t.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.PostalAddress.LocationUri.toLowerCase())}function a(e,t){return e&&Object(r.a)(t.PostalAddress)?s(e,t.PostalAddress.LocationUri):c(e,t.Id)}function s(e,t){return!!(t&&e&&e.some(e=>Object(r.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===t.toLowerCase()))}function c(e,t){return e&&e.some(e=>e.Id===t)}},1848:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2371),o=n(47),i=n(4);const a=new i.d(()=>Promise.all([n.e(8),n.e(10),n.e(13),n.e(33),n.e(584)]).then(n.bind(null,3381))),s=new i.a(a,e=>e.getItemViaGraphQL);function c(e,t,n,i,a,c,u,l,d){if(Object(o.j)("mon-rp-loadItemViaGql")){if(!e&&!l)throw new Error("getItem passed a null or undefined id");return s.importAndExecute(e,t,n,i,a,c,u,l,d)}return Object(r.a)(e,t,n,i,c,u,l)}},1850:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1709),o=n(1816),i=n(175);const a=[".bmp",".gif",".jpe",".jpeg",".jpg",".jfif",".dib",".png",".psd"],s=[".tiff",".tif"];function c(e,t,n=!0){return u(Object(r.a)(e)||Object(o.a)(t),n)}function u(e,t=!0){return!!e&&(a.indexOf(e.toLowerCase())>=0||t&&s.indexOf(e.toLowerCase())>=0&&(Object(i.c)()||Object(i.f)()))}},1851:function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"b",(function(){return d}));var r=n(20);const o=new r.c(()=>n.e(644).then(n.bind(null,3937))),i=new r.b(o,e=>e.searchSuggestionsForSinglePersona),a=new r.b(o,e=>e.searchSuggestions),s=new r.b(o,e=>e.logResponseReceived),c=new r.b(o,e=>e.logRenderLayout),u=new r.b(o,e=>e.logClientDataSource),l=new r.b(o,e=>e.logSearchActions),d=new r.b(o,e=>e.logManuallyAddedContact)},1866:function(e,t,n){"use strict";n.r(t);var r=n(1683),o=n(1791),i=n(1956),a=n(2012),s=n(1823),c=n(71),u=n(1982),l=n(1692),d=n(2023),f=n(2578),p=n(2013),m=n(1758),h=n(36);function g(e){return function(e,t){return y({isPinned:t,returnTime:e.returnTime,receivedOrRenewedTime:e.lastDeliveryOrRenewTimeStamp,receivedTime:e.lastDeliveryTimeStamp})}(e,Object(s.b)(e))}function v(e){return function(e,t){return y({isPinned:t,returnTime:e.ReturnTime,receivedOrRenewedTime:e.ReceivedOrRenewTime,receivedTime:e.DateTimeReceived})}(e,Object(s.c)(e))}function y(e){const{returnTime:t,receivedOrRenewedTime:n,receivedTime:r,isPinned:o}=e;return!!t||!o&&n&&(i=r,!(new Date(n).setMilliseconds(0)==new Date(i).setMilliseconds(0)));var i}function b(e,t){return $(e,t,1)}function O(e,t){return $(e,t,2)}function S(e,t){return $(e,t,3)}function C(e,t){return $(e,t,14)}function A(e,t){return $(e,t,17)}function _(e,t){return $(e,t,18)}function I(e,t){return $(e,t,10)}function x(e,t){return $(e,t,9)}function E(e,t){return $(e,t,4)}function T(e,t){return $(e,t,6)}function w(e,t){return $(e,t,31)}function M(e,t){return $(e,t,7)}function k(e,t){return $(e,t,8)}function j(e,t){return $(e,t,5)}function P(e,t){return $(e,t,19)}function R(e,t){return $(e,t,21)}function N(e,t){return $(e,t,20)}function D(e,t){return $(e,t,30)}function F(e,t){return $(e,t,22)}function L(e,t){return $(e,t,23)}function U(e,t){return $(e,t,32)}function B(e,t){return $(e,t,29)}function H(e,t){return $(e,t,28)}function V(e,t){return $(e,t,26)}function z(e,t){return $(e,t,27)}function W(e,t){return $(e,t,24)}function G(e,t){return $(e,t,12)}n.d(t,"getCanDelete",(function(){return b})),n.d(t,"getCategories",(function(){return O})),n.d(t,"getConversationId",(function(){return S})),n.d(t,"getIsPinned",(function(){return C})),n.d(t,"getItem",(function(){return A})),n.d(t,"getItemIds",(function(){return _})),n.d(t,"getLatestGlobalItemId",(function(){return I})),n.d(t,"getGlobalItemIds",(function(){return x})),n.d(t,"getDraftItemIds",(function(){return E})),n.d(t,"getExecuteSearchSortOrder",(function(){return T})),n.d(t,"getUniqueSenders",(function(){return w})),n.d(t,"getFlagType",(function(){return M})),n.d(t,"getFlagStatus",(function(){return k})),n.d(t,"getEffectiveMentioned",(function(){return j})),n.d(t,"getLastDeliveryOrRenewTimeStamp",(function(){return P})),n.d(t,"getLastModifiedTimeStamp",(function(){return R})),n.d(t,"getLastDeliveryTimeStamp",(function(){return N})),n.d(t,"getSubject",(function(){return D})),n.d(t,"getLastSenderMailbox",(function(){return F})),n.d(t,"getLastSenderSMTP",(function(){return L})),n.d(t,"getUnreadCount",(function(){return U})),n.d(t,"getSize",(function(){return B})),n.d(t,"getRowIdString",(function(){return H})),n.d(t,"getRowClientItemId",(function(){return V})),n.d(t,"getRowIdToShowInReadingPane",(function(){return z})),n.d(t,"getParentFolderId",(function(){return W})),n.d(t,"getInstrumentationContext",(function(){return G})),n.d(t,"getIsDraft",(function(){return q})),n.d(t,"getIsSubmitted",(function(){return K})),n.d(t,"getIsSnoozed",(function(){return X})),n.d(t,"getValidCouponIndexes",(function(){return Q})),n.d(t,"getImportance",(function(){return J})),n.d(t,"getArchiveTag",(function(){return Y})),n.d(t,"getPolicyTag",(function(){return Z})),n.d(t,"getConversationProperty",(function(){return ee}));let q=function(e,t){return $(e,t,13)},K=function(e,t){return $(e,t,16)};function X(e,t){return $(e,t,15)}function Q(e,t){return $(e,t,33)}function J(e,t){return $(e,t,11)}function Y(e,t){return $(e,t,0)}function Z(e,t){return $(e,t,25)}function $(e,t,n){switch(t.tableQuery.listViewType){case 0:return ee(e,t,n);case 1:return function(e,t,n){var r;const o=Object(i.a)(e,t.id);if(!o)return te("ItemNotInRelations",n),null;const c=o.clientId,u=l.u.items.get(c.Id);if(!u)return te("ItemNotInCache",n),null;const d=Object(a.a)(u)?u:null,f=null===(r=null==d?void 0:d.From)||void 0===r?void 0:r.Mailbox;switch(n){case 28:return c.Id;case 27:case 26:return c;case 3:return d.ConversationId.Id;case 7:return u.Flag;case 8:return u.Flag?u.Flag.FlagStatus:null;case 14:return s.c(u);case 17:return u;case 18:return[c.Id];case 10:return c.Id;case 9:return[c.Id];case 19:return u.ReceivedOrRenewTime;case 20:return u.DateTimeReceived;case 21:return u.LastModifiedTime;case 32:return d&&!d.IsRead?1:0;case 22:return f;case 23:return null==f?void 0:f.EmailAddress;case 31:return f?[f.Name]:null;case 6:return o.executeSearchSortOrder;case 24:return u.ParentFolderId.Id;case 30:return u.Subject;case 29:return u.Size;case 5:return u.MentionedMe;case 13:return u.IsDraft;case 4:return u.IsDraft?[c.Id]:[];case 16:return u.IsSubmitted;case 12:return o.instrumentationContext;case 2:return u.Categories;case 1:return u.CanDelete;case 33:return u.validCouponIndexes;case 11:return u.Importance;case 0:return u.ArchiveTag;case 25:return u.PolicyTag;case 15:return v(u);default:return null}}(e,t,n);default:return null}}function ee(e,t,n){var i;const a=Object(o.a)(e,t.id);if(!a)return te("ConversationNotInCache",n),null;const c=a.id,h=Object(u.a)(c),v=l.u.conversations.get(c);let y=void 0;switch((null==v?void 0:v.conversationNodeIds)&&v.conversationNodeIds.length>0&&(y=Object(p.b)(v.conversationNodeIds[0])),n){case 28:return c;case 26:return null==h?void 0:h.clientId;case 27:if(Object(m.a)()){const t=Object(r.b)().expandedConversationViewState;let n=null;if(t.expandedRowKey==e&&(n=t.selectedNodeIds),!n||n.length<=0)return{Id:a.itemIds[0],mailboxInfo:null==h?void 0:h.clientId.mailboxInfo};if(1==n.length)return{Id:Object(f.a)(n[0],Object(d.a)(e)),mailboxInfo:null==h?void 0:h.clientId.mailboxInfo}}return null==h?void 0:h.clientId;case 3:return c;case 7:return null==y?void 0:y.Flag;case 8:return a.flagStatus;case 14:return s.b(a);case 17:return y;case 18:return a.itemIds;case 10:return h.globalItemIds[0];case 9:return h.globalItemIds||[];case 4:return a.draftItemIds||[];case 19:return a.lastDeliveryOrRenewTimeStamp;case 20:return a.lastDeliveryTimeStamp;case 21:return a.lastModifiedTimeStamp;case 32:return a.unreadCount;case 22:return null===(i=a.lastSender)||void 0===i?void 0:i.Mailbox;case 23:return a.lastSender&&a.lastSender.Mailbox.EmailAddress;case 6:return a.executeSearchSortOrder;case 24:return 1===t.tableQuery.type?a.parentFolderId:t.tableQuery.folderId;case 30:return h.subject;case 31:return a.uniqueSenders;case 29:return h.size;case 5:return a.effectiveMentioned;case 12:return a.instrumentationContext;case 2:return a.categories;case 1:return null==v?void 0:v.canDelete;case 33:return h.validCouponIndexes;case 11:return a.importance;case 0:return null==y?void 0:y.ArchiveTag;case 25:return null==y?void 0:y.PolicyTag;case 15:return g(a);case 16:case 13:default:return null}}function te(e,t){const n=Object(c.q)();let r=e+" PropertyType:"+t;n&&(r+=" Scenario:"+n.eventName),h.h.warn(r),Object(c.o)(e,{Scenario:null==n?void 0:n.eventName,propertyType:t})}},1868:function(e,t,n){"use strict";var r;!function(e){e[e.Auto=0]="Auto",e[e.CommandBarArrows=1]="CommandBarArrows",e[e.KeyboardUpDown=2]="KeyboardUpDown",e[e.KeyboardEnter=3]="KeyboardEnter",e[e.KeyboardShiftEnter=4]="KeyboardShiftEnter",e[e.KeyboardCtrlSpace=5]="KeyboardCtrlSpace",e[e.MailListItemBody=6]="MailListItemBody",e[e.MailListItemBodyDoubleClick=7]="MailListItemBodyDoubleClick",e[e.MailListItemCheckbox=8]="MailListItemCheckbox",e[e.MailListItemContextMenu=9]="MailListItemContextMenu",e[e.MailListItemExpansion=10]="MailListItemExpansion",e[e.MailListItemRichPreview=11]="MailListItemRichPreview",e[e.MailListItemTwisty=12]="MailListItemTwisty",e[e.NewConversation=13]="NewConversation",e[e.Reset=14]="Reset",e[e.RowRemoval=15]="RowRemoval",e[e.ImmersiveReadingPaneDelete=16]="ImmersiveReadingPaneDelete",e[e.RouteHandler=17]="RouteHandler",e[e.ToggleCheckAll=18]="ToggleCheckAll",e[e.MessageAd=19]="MessageAd",e[e.SearchSuggestionClick=20]="SearchSuggestionClick",e[e.SingleLineClearSelection=21]="SingleLineClearSelection",e[e.KeyboardHome=22]="KeyboardHome",e[e.KeyboardEnd=23]="KeyboardEnd"}(r||(r={})),t.a=r},1869:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1901),o=n(1890);function i(e,t){if(!e)return null==t||t.addCheckpoint("HSR_NO_R"),Promise.reject(Object(r.a)("500","Server returned a null response!",null));const n=Array.isArray(e)?e:[e];for(const e of n)if(e&&!Object(o.a)(e))return null==t||t.addCheckpoint("HSR_R_E"),Promise.reject(Object(r.a)(e.ResponseCode,e.StackTrace,e.MessageText));return null==t||t.addCheckpoint("HSR_S"),Promise.resolve()}},187:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return d}));var r=n(250),o=n(1307),i=n(1306),a=Object.prototype.hasOwnProperty;var s=/^[_a-z][_0-9a-z]*/i;function c(e){var t=e.match(s);return t?t[0]:e}function u(e,t,n){return!(!t||"object"!=typeof t)&&(Array.isArray(t)?t.every((function(t){return u(e,t,n)})):e.selections.every((function(e){if(Object(r.d)(e)&&Object(o.c)(e,n)){var i=Object(r.h)(e);return a.call(t,i)&&(!e.selectionSet||u(e.selectionSet,t[i],n))}return!0})))}function l(e){return null!==e&&"object"==typeof e&&!Object(r.f)(e)&&!Array.isArray(e)}function d(){return new i.a}},1873:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ExtendedPropertyType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1874:function(e,t,n){"use strict";var r=function(e,t){var n,r;if(e.ExtendedProperty)for(let o=0;o<e.ExtendedProperty.length;o++){let i=e.ExtendedProperty[o];if((null===(n=null==i?void 0:i.ExtendedFieldURI)||void 0===n?void 0:n.PropertyTag)===t||(null===(r=null==i?void 0:i.ExtendedFieldURI)||void 0===r?void 0:r.PropertyName)===t)return i.Value}};var o=e=>{const t=r(e,"SourceWellKnownFolderType");switch(t&&parseInt(t,10)||-1){case 86:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_ARCHIVE";case 87:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_IMPORTANT";case 88:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_STARRED";default:return"REMOTE_DISTINGUISHED_FOLDER_TYPE_UNSPECIFIED"}};var i=e=>r(e,"0x7018")||null;var a=e=>"false"!==r(e,"0x10f4"),s=n(2332);var c=n(1679),u=n(36);function l(e,t,n,r){var o;const i=e.RootFolder;if(!i||!i.Folders||!i.ParentFolder)throw new Error("mapFindFolderResponseToGql: failed to get folders");let s=[];null==i||i.Folders.forEach(e=>{if(e&&function(e,t,n){if(r=null==e?void 0:e.__type,"Folder:#Exchange"!=r)return!1;var r;if((null==e?void 0:e.DistinguishedFolderId)&&c.f.indexOf(e.DistinguishedFolderId)>=0)return!1;if(a(e))return!1;if("clutter"===e.DistinguishedFolderId&&0===e.TotalCount)return!1;if("junkemail"===e.DistinguishedFolderId)return!!t;if("notes"===e.DistinguishedFolderId)return!!n;return!0}(e,n,r)){const n=d(e,t);n&&s.push(n)}});const u=function(e,t){return"SharedMailbox"===t?void 0:e}((null===(o=null==i?void 0:i.ParentFolder)||void 0===o?void 0:o.DistinguishedFolderId)||"none",t.type);i.ParentFolder.DistinguishedFolderId=u;let l=d(i.ParentFolder,t);return{__typename:"FolderHierarchyResult",Folders:s,RootFolder:l,offset:i.IndexedPagingOffset,TotalItemsInView:i.TotalItemsInView,IncludesLastItemInRange:i.IncludesLastItemInRange}}function d(e,t){const n=e,{FolderId:a,ParentFolderId:c,DisplayName:l,ArchiveTag:d,PolicyTag:h,ChildFolderCount:g,UnreadCount:v,TotalCount:y,FolderClass:b,DistinguishedFolderId:O}=n;if(!a||!c)return u.h.warn("mapOWSFolderToGql: ignoring folder with missing folderId or missing parentFolderId"),null;const S=g||0,C=p(a),A=function(e){const t=r(e,s.a);if(t){const e=atob(t);return[e.substr(0,e.length-1)]}return null}(n);return{id:C.Id,changeKey:C.ChangeKey,__typename:"MailFolder",type:n.__type,parentFolderId:p(c).Id,displayName:l||"",distinguishedFolderType:O||null,FolderClass:b||"IPF.Note",UnreadCount:v||0,totalMessageCount:y||0,ArchiveTag:d?m(d):null,PolicyTag:h?m(h):null,childFolderCount:S,remoteFolderInfo:{remoteFolderDisplayName:i(n),remoteDistinguishedFolderType:o(n)},replicaList:A,PermissionSet:n.PermissionSet,messageSizeInBytes:f(n),pausedTotalCount:null,principalSMTPAddress:null,mailboxInfo:{type:t.type,userIdentity:t.userIdentity,mailboxSmtpAddress:t.mailboxSmtpAddress,auxiliaryMailboxGuid:null==A?void 0:A[0]}}}function f(e){var t,n;return null===(n=null===(t=e.ExtendedProperty)||void 0===t?void 0:t[0])||void 0===n?void 0:n.Value}function p(e){return{__typename:"FolderId",Id:e.Id,ChangeKey:e.ChangeKey}}function m(e){return{__typename:"RetentionTagType",IsExplicit:!!e.IsExplicit,Value:e.Value}}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d}))},1877:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(20),o=n(1765);n.d(t,"b",(function(){return o.a}));const i=new r.c(()=>n.e(874).then(n.bind(null,2361))),a=new r.a(i,e=>e.getAndUpdateAccessToken)},188:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,a){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==a&&"function"!=typeof a)throw new Error("Cache timeout callback must be a function");var s=e[t];s?clearTimeout(s.timeout):r++;var c={value:n,expire:o+Date.now()};return isNaN(c.expire)||(c.timeout=setTimeout(function(){i(t),a&&a(t,n)}.bind(this),o)),e[t]=c,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var a=e[i];if(void 0!==a){if(isNaN(a.expire)||a.expire>=Date.now())return o&&t++,a.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var a in r)if(r.hasOwnProperty(a)){if(i)if(e[a])continue;var s=r[a],c=s.expire-o;if(c<=0){this.del(a);continue}c=c>0?c:void 0,this.put(a,s.value,c)}return this.size()}}e.exports=new r,e.exports.Cache=r},1885:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1683);function o(){return r.a.selectedTableViewId}},1890:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r="Success";function o(e){return e&&e.ResponseClass==r}},1895:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(66);function o(e,t){if(!e||!t)throw new Error("Input parameters to doesFolderIdEqualName must not be null.");return r.a.defaultFolderNameToIdMap.get(t)==e}},1898:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(47);const o="_ODSPPSL";function i(e){return Object(r.j)("doc-link-savePermission")&&e&&-1!==e.indexOf(o)?e.substring(0,e.length-o.length):e}function a(e){return!!Object(r.j)("doc-link-savePermission")&&e.lastIndexOf(o)===e.length-o.length}function s(e,t){return!Object(r.j)("doc-link-savePermission")||2!==t&&1!==t?e:e+o}},1900:function(e,t,n){"use strict";var r=n(0);const o=r.createContext(window);t.a=o},1901:function(e,t,n){"use strict";function r(e,t,n){let r="ResponseCode="+e;t&&(r+=", Stacktrace="+t);const o=new Error(r);return o.responseCode=e,o.fetchErrorType="ServerFailure",n&&(o.diagnosticInfo="MessageText= "+n),o}n.d(t,"a",(function(){return r}))},1902:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(16),o=n(1937),i=n(3);const a={loadedItemReadingPaneViewStates:new r.ObservableMap({}),loadedConversationReadingPaneViewStates:new r.ObservableMap({}),itemPreviewPaneViewState:null,itemPrintPaneViewState:null,deeplinkId:null,shouldShowMobileUpsellEmptyState:!1,primaryReadingPaneTabId:null,sxsItemId:null,loadingProjectionIds:[]};let s=Object(i.createStore)("readingpane",a);const c=s();o.a.registerReference(()=>[...c.loadedConversationReadingPaneViewStates.keys()]),t.a=c},1907:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var r=n(1817);function o(e){var t;let n=!1;return e.DisplayName&&(n=(null===(t=a(e.DisplayName))||void 0===t?void 0:t.length)>0),!Object(r.r)(e.PostalAddress)&&n}function i(e){return function(){const t=/^http*/i.test(e)?e:"//"+e;window.open(t,"_blank")}}function a(e){var t;return null===(t=e.match(/\S+/g))||void 0===t?void 0:t.filter(e=>s(e))}function s(e){return/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(e)}},1911:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2011);function o(e){return Object(r.a)(e)&&"Resource"===e.LocationSource}},1912:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2316),o=n(1898);function i(e){const t=Object(r.a)(),n=Object(o.b)(e);return t.sharingLinks.get(n)}},1917:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1678),o=n(1691),i=n(611);function a(e){let t=Object(r.a)(e);if(t||(t=e),Object(o.a)().folderTable.get(t))return Object(o.a)().folderTable.get(t).id;return Object(i.a)({Id:t,__type:"FolderId:#Exchange"}).Id}},1918:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1724),o=n(1702);function i(e,t){const n=Object(o.a)(t),i=n&&n.get(e);return(null==i?void 0:i.loadingState)||r.a.Uninitialized}},1919:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(6),o=n(1924),i=n(36);function a(e){try{if(!e)return null;const t=atob(e),n=t.length,r=new Uint8Array(new ArrayBuffer(n));for(let e=0;e<n;e++)r[e]=t.charCodeAt(e);return Object(o.a)(r)}catch(t){return i.d("getMailboxGuidFromEwsId : conversion failed for id "+e+" with error "+t),null}}function s(e,t){if(!e||!t)return null;return r.c("{0}@{1}",e,t)}},192:function(e,t,n){"use strict";var r;!function(e){e[e.None=-1]="None",e[e.Red=0]="Red",e[e.Orange=1]="Orange",e[e.Peach=2]="Peach",e[e.YellowLight=3]="YellowLight",e[e.GreenLight=4]="GreenLight",e[e.TealLight=5]="TealLight",e[e.Olive=6]="Olive",e[e.BlueSky=7]="BlueSky",e[e.PurpleLight=8]="PurpleLight",e[e.Pink=9]="Pink",e[e.SteelLight=10]="SteelLight",e[e.SteelGrey=11]="SteelGrey",e[e.GreyLight=12]="GreyLight",e[e.GreyDark=13]="GreyDark",e[e.Black=14]="Black",e[e.RedDark=15]="RedDark",e[e.OrangeDark=16]="OrangeDark",e[e.BrownMedium=17]="BrownMedium",e[e.YellowDark=18]="YellowDark",e[e.GreenDark=19]="GreenDark",e[e.TealDark=20]="TealDark",e[e.OliveDark=21]="OliveDark",e[e.BlueDark=22]="BlueDark",e[e.PurpleDark=23]="PurpleDark",e[e.MagentaDark=24]="MagentaDark"}(r||(r={})),t.a=r},1923:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(16),o=n(3),i=n(1691),a=n(1688);const s=Object(o.mutatorAction)("addFoldersToFolderTableMutator",e=>{0==Object(a.a)().size&&(Object(i.a)().folderTable=new r.ObservableMap),Object.keys(e).forEach(t=>{const n=JSON.stringify(e[t]);if(JSON.stringify(Object(a.a)().get(t))!=n){const e=JSON.parse(n);Object(a.a)().set(t,e)}})})},1924:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(36);function o(e){if(!e)return null;let t=e,n=0;if(1==t[0]){if(t=a(t),!t)return null}else n=1;n++;const o=t[n]+(t[n+1]>>8);return n+=2,function(e,t,n){if(t+n>e.length)return r.d("ConvertByteArrayToString: offset + count must not exceed byte array length."),null;let o="";for(let r=t;r<t+n;r++)o+=String.fromCharCode(e[r]);return o}(t,n,o)}function i(e){if(!e)return!1;try{let t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;e++)n[e]=t.charCodeAt(e);let r=0;return 1===n[0]?n=a(n):r=1,n&&1===n[r]}catch(e){return!1}}function a(e){const t=s(e,null);if(0==t)return r.d("rleDecompress : Invalid id"),null;let n=new Uint8Array(t);return s(e,n),n}function s(e,t){let n=0;for(let o=1;o<e.length;++o)if(o==e.length-1||e[o]!=e[o+1])null!=t&&(t[n]=e[o]),n++;else{if(o==e.length-2)return r.d("decompressEx : Invalid id"),null;let i=e[o+2];for(let r=0;r<i+2;r++)null!=t&&(t[n]=e[o]),n++;o+=2}return n}},1926:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.OoeInvalidDataFormat=2006]="OoeInvalidDataFormat",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.AttachmentSizeExceeded=9e3]="AttachmentSizeExceeded",e[e.NumberOfAttachmentsExceeded=9001]="NumberOfAttachmentsExceeded",e[e.InvalidAttachmentId=9003]="InvalidAttachmentId",e[e.InvalidAttachmentPath=9004]="InvalidAttachmentPath",e[e.CannotAddAttachmentBeforeUpgrade=9005]="CannotAddAttachmentBeforeUpgrade",e[e.AttachmentDeletedBeforeUploadCompletes=9006]="AttachmentDeletedBeforeUploadCompletes",e[e.AttachmentUploadGeneralFailure=9007]="AttachmentUploadGeneralFailure",e[e.AttachmentToDeleteDoesNotExist=9008]="AttachmentToDeleteDoesNotExist",e[e.AttachmentDeleteGeneralFailure=9009]="AttachmentDeleteGeneralFailure",e[e.InvalidEndTime=9010]="InvalidEndTime",e[e.HtmlSanitizationFailure=9011]="HtmlSanitizationFailure",e[e.NumberOfRecipientsExceeded=9012]="NumberOfRecipientsExceeded",e[e.CursorPositionChanged=9014]="CursorPositionChanged",e[e.ComposeFormNotReadyForAttachments=9015]="ComposeFormNotReadyForAttachments",e[e.InvalidSelection=9016]="InvalidSelection",e[e.GenericTokenError=9018]="GenericTokenError",e[e.GenericSettingsError=9019]="GenericSettingsError",e[e.GenericResponseError=9020]="GenericResponseError",e[e.SaveError=9021]="SaveError",e[e.DuplicateNotificationKey=9023]="DuplicateNotificationKey",e[e.NotificationKeyNotFound=9024]="NotificationKeyNotFound",e[e.NumberOfNotificationsExceeded=9025]="NumberOfNotificationsExceeded",e[e.PersistedNotificationArrayReadError=9026]="PersistedNotificationArrayReadError",e[e.PersistedNotificationArraySaveError=9027]="PersistedNotificationArraySaveError",e[e.CannotPersistPropertyInUnsavedDraftError=9028]="CannotPersistPropertyInUnsavedDraftError",e[e.CallSaveAsyncBeforeToken=9029]="CallSaveAsyncBeforeToken",e[e.InvalidParameterValueError=9031]="InvalidParameterValueError",e[e.ApiCallNotSupportedByExtensionPoint=9032]="ApiCallNotSupportedByExtensionPoint",e[e.SetRecurrenceOnInstance=9033]="SetRecurrenceOnInstance",e[e.InvalidRecurrence=9034]="InvalidRecurrence",e[e.InsufficientItemPermissions=9038]="InsufficientItemPermissions",e[e.InternalServerError=9042]="InternalServerError",e[e.AttachmentTypeNotSupported=9043]="AttachmentTypeNotSupported",e[e.InvalidCategoryError=9044]="InvalidCategoryError",e[e.DuplicateCategoryError=9045]="DuplicateCategoryError",e[e.ItemNotSavedError=9046]="ItemNotSavedError",e[e.MissingExtendedPermissionsForAPIError=9047]="MissingExtendedPermissionsForAPIError",e[e.ItemNotFound=9049]="ItemNotFound",e[e.KeyNotFound=9050]="KeyNotFound",e[e.SessionDataObjectMaxLengthExceeded=9051]="SessionDataObjectMaxLengthExceeded"}(r||(r={})),t.b=r},1935:function(e,t,n){"use strict";var r=n(6),o=n(703);const i="en-us",a={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};const s=", ";function c(e,t,n,r,i,a){let s=[];Object(o.a)(e)||(s[s.length]=e);let c="";return Object(o.a)(t)||(c=t),Object(o.a)(n)||(c=Object(o.a)(c)?n:c+a+n),Object(o.a)(r)||(c=Object(o.a)(c)?r:c+a+r),Object(o.a)(c)||(s[s.length]=c),Object(o.a)(i)||(s[s.length]=i),s}function u(e,t,n,u,l){let d="",f=function(){let e="";Object(o.a)(Object(r.e)())||(e=Object(r.e)());let t=a[e];return null==t&&(t=a[i]),t}(),p=[],m=s;switch(f){case"a_c_pc_pr_ctry":p=c(e,t,n,u,l,m);break;case"a_c_pr_ctry_pc":p=c(e,t,u,l,n,m);break;case"a_c_pr_pc_ctry":p=c(e,t,u,n,l,m);break;case"a_ctry_c_pr_pc":p=c(e,l,t,u,n,m);break;case"a_pc_c_pr_ctry":p=c(e,n,t,u,l,m);break;case"a_pc_pr_c_ctry":p=c(e,n,u,t,l,m);break;case"c_a_pc_pr_ctry":p=c(t,e,n,u,l,m);break;case"ctry_pc_pr_c_a":p=c(l,n,u,t,e,m);break;case"ctry_pr_c_pc_a":p=c(l,u,t,n,e,m);break;case"pc_ctry_pr_c_a":p=c(n,l,u,t,e,m);break;case"pc_pr_c_a_ctry":p=c(n,u,t,e,l,m)}return d=p.join(m),d}function l(e){return e?u(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function d(e,t){return Object(o.a)(e)?l(t):e}function f(e,t,n){const i=l(t);return Object(o.a)(e)?i:""==i||n?e:Object(r.c)("{0} ({1})",e,i)}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f}))},1937:function(e,t,n){"use strict";const r=new(n(957).a)(50);t.a=r},1942:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1895),o=n(1679);function i(e){return e&&(Object(r.a)(e,o.h)||Object(r.a)(e,o.a))}},19463:function(e,t,n){"use strict";n.r(t);var r=n(18181),o=n(6734),i=n(6),a=n(564),s=n(2096),c=n(3767);const u=e=>()=>{Object(a.b)(Object(i.b)(r.b),Object(i.b)(r.a),!Object(c.b)(e),{okText:Object(i.b)(o.a),hideCancelButton:!1}).then(t=>{t==a.a.ok&&s.a.importAndExecute(e)})};let l=e=>()=>e.conversationId;var d=n(4292);const f=e=>()=>{var t;return(null===(t=e.fromViewState)||void 0===t?void 0:t.from)?e.fromViewState.from.email:Object(d.a)()};var p=n(1833),m=n(11862),h=n(6313),g=n(6269),v=n(4555),y=n(2044),b=n(702),O=Object(b.action)("clearRecipientWell")((function(e){e.recipients=[],e.isDirty=!0})),S=n(1078);const C=e=>t=>{const n=x(e,t);return Object(v.a)(n)},A=e=>(t,n)=>{I(e,t);const r=x(e,t);O(r);const o=n.map(S.a);Object(y.a)(o,r)},_=e=>(t,n)=>{I(e,t);const r=x(e,t),o=n.map(S.a);Object(y.a)(o,r)};function I(e,t){switch(e.showCompactRecipientWell&&Object(g.a)(e),t){case p.g.To:return;case p.g.Cc:return void Object(h.a)(e);case p.g.Bcc:return void Object(m.a)(e)}}const x=(e,t)=>{let n;switch(t){case p.g.To:n=e.toRecipientWell;break;case p.g.Cc:n=e.ccRecipientWell;break;case p.g.Bcc:n=e.bccRecipientWell}return n};var E=n(3124),T=n(2501);var w=e=>()=>(Object(T.a)(e),Object(E.b)(e,!1,!0).then(()=>Promise.resolve(e.itemId.Id)).catch(()=>Promise.resolve(null))),M=n(9668),k=n(9669),j=n(8217),P=n(2929),R=n(8218);const N=e=>()=>(Object(T.a)(e),e.content),D=e=>(t,n)=>{Object(P.a)(e,t),Object(j.a)(e,t)},F=e=>()=>e.bodyType,L=e=>t=>{Object(M.a)(e,t)},U=e=>t=>{Object(k.a)(e,t)},B=e=>t=>{Object(p.k)(e.addin,t)};var H=n(11865),V=n(11864);const z=e=>()=>e.subject,W=e=>t=>{Object(H.a)(e,t)};function G(e){return 1===e.lastFocusedControl}const q=e=>()=>2===e.addin.lastFocusedControl?(e=>()=>(function(e){return 2===e.lastFocusedControl})(e.addin)?Object(R.a)(e):null)(e)():1===e.addin.lastFocusedControl?(e=>()=>{if(!G(e.addin))return null;const{selectionStart:t,selectionEnd:n}=e.addin.subject;let r=e.subject;return r=r.slice(t,n),{data:r,sourceProperty:"subject",startPosition:t,endPosition:n}})(e)():null,K=e=>t=>{2===e.addin.lastFocusedControl?U(e)(t):1===e.addin.lastFocusedControl&&(e=>t=>{if(!G(e.addin))return;let n=e.subject;const{selectionStart:r,selectionEnd:o}=e.addin.subject;n=n.slice(0,r)+t+n.slice(o),Object(H.a)(e,n);const i=r+t.length;Object(V.a)(e.addin.subject,i,i)})(e)(t)};var X=n(2168),Q=n(805),J=n(1675),Y=n(1693),Z=n(5320),$=n(57),ee=n(1692),te=n(1681);const ne=e=>()=>oe(e),re=e=>()=>{const t=e;return void 0!==t.isInSharedFolder&&t.isInSharedFolder};function oe(e){if(!e||!e.ParentFolderId)return!1;const t=e.ParentFolderId.Id;return Object(te.C)(t,"SharedMailbox")}function ie(){return!0}async function ae(){return(await Q.u.import())()}async function se(e){return(await Q.r.import())(e,"Addin")}async function ce(e){return(await Q.w.import())(e,"Addin")}const ue=e=>()=>(async function(e){let t=Object(Y.b)().items.get(e.itemId).Categories;const n=(await Q.u.import())();if(null==t)return[];let r=[];for(let e of t){let t=n.filter(t=>t.Name===e),o={Name:e,Color:t.length>0?t[0].Color:Z.a.None};r.push(o)}return r})(e),le=e=>t=>new Promise((n,r)=>{let o=Object(Y.b)().items.get(e.itemId);const i=o.ParentFolderId.Id,a=Object($.l)();var s=Object(ee.h)(i,a);if(oe(o)&&s&&("PublishingAuthor"===s.PermissionLevel||"Author"===s.PermissionLevel||"NoneditingAuthor"===s.PermissionLevel||"Reviewer"===s.PermissionLevel||"Contributor"===s.PermissionLevel))return void r(new p.b(p.c.OperationNotSupported));const c=Object(J.I)(),u=[...c.selectedRowKeys.keys()];return X.a.importAndExecute(u,c,t,"Addin"),n()}),de=e=>t=>new Promise((n,r)=>{let o=Object(Y.b)().items.get(e.itemId);const i=o.ParentFolderId.Id,a=Object($.l)();var s=Object(ee.h)(i,a);if(oe(o)&&s&&("PublishingAuthor"===s.PermissionLevel||"Author"===s.PermissionLevel||"NoneditingAuthor"===s.PermissionLevel||"Reviewer"===s.PermissionLevel||"Contributor"===s.PermissionLevel))return void r(new p.b(p.c.OperationNotSupported));const c=Object(J.I)(),u=[...c.selectedRowKeys.keys()];return X.F.importAndExecute(u,c,t,"Addin"),n()});function fe(e){return Y.a.items.get(e)}var pe=n(1800),me=n(2589);async function he(e){let t=fe(e);if(!t||!t.NormalizedBody){const n={Id:e,mailboxInfo:Object(pe.b)(Object(J.I)())};t=await me.f.importAndExecute(n,"LoadMore")}if(!t)throw new Error("ErrorInvalidIdMalformed")}var ge=n(225),ve=n(2280);function ye(e){const t={Id:e,mailboxInfo:Object(ge.d)()};Object(ve.c)({itemId:t,entrySource:"Mail_Addins"})}var be=n(744);async function Oe(e){let t=fe(e);if(!t||!t.NormalizedBody){const n={Id:e,mailboxInfo:Object(pe.b)(Object(J.I)())};t=await me.f.importAndExecute(n,"LoadItemReadingPaneMailAddins")}t.IsDraft?await async function(e){await s.h.importAndExecute(e,null,2)}(e):Object(be.a)(e)}var Se=n(1686);const Ce=e=>{return!!~Object(Se.g)(Se.d.SurfaceActions).composeSurfaceAddins.indexOf(e)},Ae=e=>{return!!~Object(Se.g)(Se.d.SurfaceActions).readSurfaceAddins.indexOf(e)};var _e=n(2654),Ie=n(47),xe=n(2386);const Ee=e=>async()=>{var t;return e.itemId?Object(Ie.j)("fwk-immutable-ids")?null===(t=await Object(_e.b)([e.itemId.Id],xe.a.EwsId,Object(ge.d)().userIdentity,_e.a.Addins))||void 0===t?void 0:t[0]:e.itemId.Id:null},Te=e=>async()=>{var t;return Object(Ie.j)("fwk-immutable-ids")?null===(t=await Object(_e.b)([e.ItemId.Id],xe.a.EwsId,Object(ge.d)().userIdentity,_e.a.Addins))||void 0===t?void 0:t[0]:e.ItemId.Id},we=e=>()=>{const t=e;return{owner:t.folderOwnerEmailAddress,delegatePermissions:ke(t.folderPermission)}},Me=e=>()=>{const t=e.ParentFolderId.Id,n=Object($.l)(),r=Object(ee.h)(t,n),{principalSMTPAddress:o}=Object(te.m)().get(t);return{owner:o,delegatePermissions:ke(r)}};function ke(e){return e?{Read:"FullDetails"==e.ReadItems,Create:e.CanCreateItems,EditOwn:"All"==e.EditItems||"Owned"==e.EditItems,EditAll:"All"==e.EditItems,DeleteOwn:"All"==e.DeleteItems||"Owned"==e.DeleteItems,DeleteAll:"All"==e.DeleteItems}:{Read:!0,Create:!0,EditOwn:!0,EditAll:!0,DeleteOwn:!0,DeleteAll:!0}}var je=n(1797),Pe=n(1777),Re=n(2108),Ne=n(9728),De=n(9729),Fe=n(4395),Le=n(1696);var Ue=n(3914);function Be(e,t){let n=qe(e.docViewAttachments,t);if(n||(n=qe(e.imageViewAttachments,t)),n||(n=qe(e.inlineAttachments,t)),!n)throw new p.b(p.c.GenericResponseError);return Ue.b.importAndExecute(n,t)}const He=e=>(t,n,r)=>Object(De.a)(e,t,n,r).catch(Ve);function Ve(e){throw e.messageId?function(e){switch(e){case"ErrorTooLargeForLocalAttachmentSingle":case"ErrorTooLargeForLocalAttachmentMultiple":return p.c.AttachmentSizeExceeded;default:return p.c.AttachmentUploadGeneralFailure}}(e.messageId):p.c.AttachmentUploadGeneralFailure}const ze=e=>(t,n,r)=>Object(Ne.a)(e,t,n,r).catch(Ve),We=e=>()=>(Object(T.a)(e),Ue.a.importAndExecute(e.attachmentWell,e.content)),Ge=e=>(t,n,r)=>(function(e,t,n,r){return new Promise((o,i)=>{let a=!1;const s=()=>{a||(a=!0,i({errorType:"UploadError"}))},c=(e,t,n)=>{Object(Re.v)(e,t,n,!Object(Ie.j)("addin-fix-multipleCallbacksForAttachmentHandler")),o(t.Id)},u=e=>{a||(a=!0,o(e.Id))};try{let o;const i=Object(Le.g)(n),a=Object(Le.b)(n),d=Object(Le.e)(a);if(r&&i){const e={name:n,size:0,dataUri:t,fileType:Pe.a.Base64InlineImage,type:d||"image/png"};o=Object(Pe.d)([e])}else{const e=atob(t),r=e.length,a=new Uint8Array(new ArrayBuffer(r));for(let t=0;t<r;t++)a[t]=e.charCodeAt(t);let s=null;s=i?new Blob([a],{type:d||"image/png"}):new Blob([a]);var l=s;l.name=n,o=Object(Pe.g)([l])}Object(Fe.a)(o,e,{isInline:r,isHiddenInline:!0,shouldShare:!1},u,c,s)}catch(e){i({errorType:p.c.AttachmentUploadGeneralFailure})}})})(e,t,n,r).catch(Ve);function qe(e,t){const n=e.filter(e=>e.attachmentId.Id===t);return n.length>0?n[0]:null}const Ke=e=>t=>new Promise((n,r)=>{Re.g.import().then(o=>{try{let i=qe(e.attachmentWell.docViewAttachments,t);if(i||(i=qe(e.attachmentWell.imageViewAttachments,t)),i||(i=qe(e.attachmentWell.inlineAttachments,t)),!i)return void r(new p.b(p.c.AttachmentToDeleteDoesNotExist));const a=Object.assign(Object.assign({},e.itemId),{mailboxInfo:Object(pe.a)()}),s=(e,t,r)=>{Object(Re.w)(e,t,r,!Object(Ie.j)("addin-fix-multipleCallbacksForAttachmentHandler")),n()};o(e.attachmentWell,i,a,e,s)}catch(e){r(new p.b(p.c.AttachmentDeleteGeneralFailure))}})}),Xe=e=>t=>Be(e.attachmentWell,t);var Qe=n(9667),Je=n(1804),Ye=n(71);function Ze(e,t,n,r){return()=>{var o;const a=Object(p.o)(t);if(!a)return null;const s=function(e,t,n,r){return{text:Object(i.b)(Qe.a),action:()=>{let o=!1;n.Actions&&(o=!0),Object(Ye.o)("DissmissButtonClicked",{IsClickableInfobar:o});const i=n.ExtensionId,a=n.Persistent;p.N.import().then(n=>{n(t),a&&p.W.import().then(t=>{t(e,i)})}),r(t),Object(Ie.j)("addin-autoRun")&&Object(Ie.j)("addin-autoRun-infobarDismissClickedEvent")&&p.L.importAndExecute(e,11)}}}(e,t,a,n),c=(null===(o=a.Actions)||void 0===o?void 0:o.CustomButtonAction)&&a.Actions.NotificationActionData?function(e,t,n,r){return{text:t,action:()=>{Object(Ye.o)("ClickableInfoBarClicked"),p.C.importAndExecute(e,n,r)}}}(e,a.Actions.NotificationActionData.actionText,a.Actions.CustomButtonAction,r):"";return{key:a.Key,source:Je.c.Extensibility,rank:et(a.Type),messageParts:$e(s,c,a),color:Je.a.Grey,icon:a.Actions?a.Actions.CustomButtonIcon:null}}}function $e(e,t,n){var r;return(null===(r=n.Actions)||void 0===r?void 0:r.CustomButtonAction)?[n.Message,"|",t,"|",e]:[n.Message,"|",e]}function et(e){switch(e){case 0:case 1:return Je.b.Info;case 2:return Je.b.Error;case 3:return Je.b.InsightMessage}return Je.b.Safety}var tt=n(2036),nt=n(2101);const rt=e=>(t,n)=>{Object(tt.a)(e,t,Ze(Object(p.n)(e.composeId),t,ot(e),n))},ot=e=>t=>{Object(nt.a)(e,[t])},it=e=>()=>e.infoBarIds;var at=n(9670),st=n(16);const ct=e=>(t,n,r)=>{var o;let i,a=0;if((null===(o=e.addin.sessionStore)||void 0===o?void 0:o.has(r))?(i=e.addin.sessionStore.get(r),i.dataStore.has(t)&&(a-=pt(t)+pt(i.dataStore.get(t)))):i={size:0,dataStore:new st.ObservableMap},a+=pt(t)+pt(n),i.size+a>5e4)throw p.c.SessionDataObjectMaxLengthExceeded;Object(at.c)(e.addin,i,t,n,a,r)},ut=e=>(t,n)=>{var r;if(null===(r=e.addin.sessionStore)||void 0===r?void 0:r.has(n)){const r=e.addin.sessionStore.get(n);if(r.dataStore.has(t))return r.dataStore.get(t)}throw p.c.KeyNotFound},lt=e=>t=>{const n=e.addin.sessionStore;return n.has(t)&&n.get(t).size>0?n.get(t).dataStore:JSON.stringify(new st.ObservableMap)},dt=e=>t=>{var n;(null===(n=e.addin.sessionStore)||void 0===n?void 0:n.has(t))&&Object(at.a)(e.addin,t)},ft=e=>(t,n)=>{var r;if(null===(r=e.addin.sessionStore)||void 0===r?void 0:r.has(n)){const r=e.addin.sessionStore.get(n);if(r.dataStore.has(t)){const o=pt(t)+pt(r.dataStore.get(t));return void Object(at.b)(e.addin,t,o,n)}}throw p.c.KeyNotFound},pt=e=>new Blob([e]).size;var mt=n(3),ht=Object(mt.mutatorAction)("removeInternetHeaders",(e,t)=>{t.forEach(t=>{e.internetHeaders.get(t)&&(e.keysOfInternetHeadersToBeRemoved.push(t),e.internetHeaders.delete(t))})}),gt=n(5309),vt=Object(mt.mutatorAction)("setInternetHeaders",(e,t)=>{e.internetHeaders=e.internetHeaders.merge(t)}),yt=n(1848),bt=n(261),Ot=n(707),St=n(467);const Ct="00020386-0000-0000-C000-000000000046",At="0x007D";async function _t(e,t){let n;const r=[];t.forEach(t=>{e.addin.internetHeaders.get(t)||e.addin.keysOfInternetHeadersToBeRemoved&&-1!=e.addin.keysOfInternetHeadersToBeRemoved.indexOf(t)||r.push(t)}),r.length>0&&(n=await async function(e,t){const n=Object(Ot.a)({BaseShape:"IdOnly",AdditionalProperties:It(e)});let r={};try{const e=await Object(yt.a)(t,n,null);!e||e instanceof Error||e.ExtendedProperty&&(o=e.ExtendedProperty,r=o.reduce((e,t)=>(e[t.ExtendedFieldURI.PropertyName]=t.Value,e),{}))}catch(e){throw e}var o;return r}(r,e.itemId.Id),vt(e.addin,n),Object(gt.a)(e))}function It(e){const t=[];return e.forEach(e=>{t.push(Object(bt.a)(Ct,e,"String"))}),t}function xt(){const e=[];return e.push(Object(St.a)({PropertyTag:At,PropertyType:"String"})),e}const Et=e=>t=>{vt(e.addin,t),Object(gt.a)(e)},Tt=e=>async t=>{4===e.operation&&await _t(e,t),ht(e.addin,t),Object(gt.a)(e)},wt=e=>async t=>(4===e.operation&&await _t(e,t),[...e.addin.internetHeaders.keys()].filter(e=>t.includes(e)).reduce((t,n)=>(t[n]=e.addin.internetHeaders.get(n),t),{}));var Mt=n(2927),kt=n(331),jt=n(3744),Pt=Object(b.action)("disableClientSignatureOnReply")((function(){if(Object(jt.a)()){const e=Object(Mt.a)();e.defaultReplySignatureName&&(e.defaultReplySignatureName="")}else Object(kt.a)(e=>{const t=e.UserOptions;t.AutoAddSignatureOnReply&&(t.AutoAddSignatureOnReply=!t.AutoAddSignatureOnReply)})})),Rt=Object(b.action)("disableClientSignatureOnNew")((function(){if(Object(jt.a)()){const e=Object(Mt.a)();e.defaultSignatureName&&(e.defaultSignatureName="")}else Object(kt.a)(e=>{const t=e.UserOptions;t.AutoAddSignature&&(t.AutoAddSignature=!t.AutoAddSignature)})})),Nt=n(3133),Dt=n(1697),Ft=n(38),Lt=n(7907);const Ut=e=>()=>{let t,n="newMail";return"reply"===e.addin.draftComposeType&&(n="reply"),"forward"===e.addin.draftComposeType&&(n="forward"),"newMail"===e.addin.draftComposeType&&(n="newMail"),t={coercionType:e.bodyType.toLowerCase(),composeType:n},t},Bt=e=>t=>Object(Nt.d)(e,t,!0).then(()=>!0).catch(()=>!1),Ht=()=>()=>{if(Object(jt.a)()){const e=Object(Mt.a)();return""!==e.defaultSignatureName||""!==e.defaultReplySignatureName}{const e=Object(Ft.a)().UserOptions;return e.AutoAddSignature||e.AutoAddSignatureOnReply}};async function Vt(){if(Object(jt.a)()){const e=Object(Mt.a)();let t=!1;return e.defaultSignatureName&&(Rt(),Object(Lt.b)(""),t=!0),e.defaultReplySignatureName&&(Pt(),Object(Lt.a)(""),t=!0),t}{const e=Object(Ft.a)().UserOptions;let t=!1;return e.AutoAddSignature&&(Rt(),t=!0),e.AutoAddSignatureOnReply&&(Pt(),t=!0),await Object(Dt.f)({AutoAddSignature:e.AutoAddSignature,AutoAddSignatureOnReply:e.AutoAddSignatureOnReply}),t}}function zt(e){return{getRecipients:C(e),setRecipients:A(e),addRecipients:_(e),getSubject:z(e),setSubject:W(e),getItemId:Ee(e),getConversationId:l(e),getBody:N(e),setBody:D(e),getBodyType:F(e),prependBody:L(e),getSelectedData:q(e),setSelectedData:K(e),setBodySelectedData:U(e),mode:je.a.MessageCompose,saveItem:w(e),addNotificationMessage:rt(e),removeNotificationMessage:ot(e),getNotificationMessageIds:it(e),close:u(e),checkItemId:he,displayMessageForm:Oe,displayAppointmentForm:ye,addItemAttachment:He(e),addFileAttachment:ze(e),addFileAttachmentFromBase64:Ge(e),removeAttachment:Ke(e),getAttachments:We(e),getAttachmentContent:Xe(e),isAddinPinned:Ce,isSharedItem:re(e),getSharedProperties:we(e),isRemoteItem:ie,getFrom:f(e),getInternetHeaders:wt(e),setInternetHeaders:Et(e),removeInternetHeaders:Tt(e),appendOnSend:B(e),getCategoriesMailbox:ae,addCategoriesMailbox:se,removeCategoriesMailbox:ce,getComposeTypeAndCoercionType:Ut(e),setSignature:Bt(e),isClientSignatureEnabled:Ht(),disableClientSignature:Vt,setSessionDataState:ct(e),getSessionDataState:ut(e),getAllSessionDataState:lt(e),clearSessionDataState:dt(e),removeSessionDataState:ft(e)}}var Wt=n(8548);const Gt=(e,t,n,r,o,i,a,s)=>{Object(Wt.a)("Mail_AddIns",void 0,e,t,n,r,o,i,a,s)};var qt=n(6462),Kt=n(6088);function Xt(e,t,n,r){const o=fe(e),i=o?o.ConversationId.Id:null,a=Object(Kt.a)(r);s.m.importAndExecute({referenceItemOrId:e,mailboxInfo:Object(ge.d)(),isReplyAll:t,useFullCompose:!0,actionSource:"AddIns",instrumentationContexts:[],conversationId:i,body:n,fullComposeTarget:2,attachmentFiles:a})}var Qt=n(2788),Jt=n(1701),Yt=n(2808),Zt=n(1890);function $t(e){return async function(e){return(await Object(Yt.a)({Header:Object(bt.b)(),Body:Object(Qt.a)({EventIds:[e],ItemShape:Object(Ot.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(Jt.a)({FieldURI:"calendar:Recurrence"}),Object(Jt.a)({FieldURI:"calendar:SeriesMasterItemId"})]})})},null)).Body.ResponseMessages.Items}(e).then(e=>{if(Object(Zt.a)(e[0])){const t=e[0].Items[0];return{SeriesMasterItemId:t.SeriesMasterItemId,Recurrence:t.Recurrence}}return null})}const en=e=>async()=>{if(!e.AssociatedCalendarItemId)return null;if(e.Recurrence)return e.Recurrence;{const t=await $t(e.AssociatedCalendarItemId);if(!t)return null;if(t.Recurrence)return t.Recurrence;if(t.SeriesMasterItemId){const e=await $t(t.SeriesMasterItemId);return e?e.Recurrence:null}return null}};const tn=e=>()=>(async function(e){const t=Object(Ot.a)({BaseShape:"IdOnly",AdditionalProperties:xt()});try{const n=await Object(yt.a)(e,t,null);if(n&&!(n instanceof Error))return n.ExtendedProperty?n.ExtendedProperty[0].Value:""}catch(e){throw e}})(e.ItemId.Id);var nn=n(3293),rn=n(2111),on=n(8865),an=n(10287),sn=n(10063);const cn=e=>(t,n)=>{sn.a(e)(t,Ze(Object(p.q)(e.itemId),t,un(e),n))},un=e=>t=>{sn.c(e)(t)},ln=e=>()=>sn.b(e)(),dn=e=>t=>Be(e.attachmentWell,t),fn=(e,t,n)=>()=>!e.isConversationItemPart||Object(on.b)({conversationReadingPaneState:n.conversationReadingPaneViewState})==e,pn=(e,t)=>()=>{var n;const r=e.isConversationItemPart?null===(n=t.ConversationId)||void 0===n?void 0:n.Id:null;return!!Object(nn.a)(r)};var mn=function(e,t,n){var r,o;return void 0===n&&(n={conversationReadingPaneViewState:Object(rn.a)(null===(r=null==e?void 0:e.ConversationId)||void 0===r?void 0:r.Id)}),{getItem:Object(Ie.j)("fwk-immutable-ids")?Object(an.a)(e):()=>Promise.resolve(e),getItemWithUnsafeIdsImmediate:()=>e,getItemId:Te(e),addNotificationMessage:cn(t),removeNotificationMessage:un(t),getNotificationMessageIds:ln(t),mode:je.a.MessageRead,displayMessageForm:Oe,displayNewMessageForm:qt.a,displayNewAppointmentForm:Gt,displayReplyForm:Xt,displayAppointmentForm:ye,checkItemId:he,isAddinPinned:Ae,isItemSelected:fn(t,0,n),isInlineComposeOpen:pn(t,e),isSharedItem:ne(e),isRemoteItem:ie,getSharedProperties:Me(e),getRecurrence:en(e),getSeriesId:(o=e,o&&o.IsRecurring?async()=>{const e=await $t(o.AssociatedCalendarItemId);return(null==e?void 0:e.SeriesMasterItemId)?e.SeriesMasterItemId.Id:null}:()=>Promise.resolve(void 0)),getAllInternetHeaders:tn(e),getAttachmentContent:dn(t),getCategoriesMailbox:ae,addCategoriesMailbox:se,removeCategoriesMailbox:ce,getCategoriesItem:ue(t),addCategoriesItemRead:le(t),removeCategoriesItemRead:de(t)}};n.d(t,"createMailComposeAdapter",(function(){return zt})),n.d(t,"createMailReadAdapter",(function(){return mn}))},1956:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1831),o=n(1683);function i(e,t){const n=Object(r.a)(e,t);return o.a.tableViewItemRelations.get(n)}},1961:function(e,t,n){"use strict";var r=n(3),o=n(2853);const i=Object(r.createStore)("fileProviderStore",Object(o.a)());t.a=i},1969:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a}));var r=n(3);const o=Object(r.action)("FILE_PROVIDER_ADDED",e=>({providerViewState:e})),i=Object(r.action)("FILE_PROVIDER_REMOVED",e=>({providerType:e})),a=Object(r.action)("PROVIDERS_LOADED",e=>({providers:e}))},1971:function(e,t,n){"use strict";n.d(t,"l",(function(){return m})),n.d(t,"n",(function(){return h})),n.d(t,"k",(function(){return g})),n.d(t,"m",(function(){return v}));var r=n(20),o=n(2368);n.d(t,"b",(function(){return o.a}));var i=n(2328);n.d(t,"i",(function(){return i.a}));n(1961);var a=n(1969);n.d(t,"d",(function(){return a.a})),n.d(t,"e",(function(){return a.b})),n.d(t,"o",(function(){return a.c}));var s=n(2314);n.d(t,"a",(function(){return s.b}));var c=n(2102);n.d(t,"g",(function(){return c.a})),n.d(t,"h",(function(){return c.b}));var u=n(2315);n.d(t,"j",(function(){return u.a}));var l=n(2136);n.d(t,"c",(function(){return l.a}));var d=n(2291);n.d(t,"f",(function(){return d.b}));var f=n(910);const p=new r.c(()=>Promise.all([n.e(0),n.e(680)]).then(n.bind(null,4090))),m=new r.b(p,e=>e.loadProviders),h=new r.b(p,e=>e.removeFileProvider),g=new r.b(p,e=>e.addFileProvider),v=new r.b(p,e=>e.removeAndAddFileProvider);Object(r.f)(f.a,p,e=>e.resetFileProviderStoreOrchestrator)},1974:function(e,t,n){"use strict";var r=n(225),o=n(1681);const i=new Map;var a=n(2058),s=n(1754),c=n(3070);function u(e){return e?l(e.tableQuery):Object(r.d)()}function l(e){const t=Object(s.b)(e),n=null==e?void 0:e.folderId;return null!=t?Object(a.a)(t):d(n)}function d(e){return Object(o.G)(e)?Object(c.a)(e):function(e){if(!e)return Object(r.d)();if(!i.has(e)){let t=Object(o.t)(e,!0);i.set(e,t)}return i.get(e)}(e)}function f(e){return{mailboxInfo:l(e)}}n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return f}))},1975:function(e,t,n){"use strict";n.d(t,"e",(function(){return"{id}"})),n.d(t,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),n.d(t,"a",(function(){return"data-custom"})),n.d(t,"c",(function(){return"originalsrc"})),n.d(t,"b",(function(){return"data-loadstatus"})),n.d(t,"d",(function(){return"pending"}))},1979:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(952);function o(e){var t;return null===(t=r.a.projections)||void 0===t?void 0:t.filter(t=>t.tabId==e||t.window==e)[0]}},1982:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1683);function o(e){return r.a.conversationItems.get(e)}},1985:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("START_SEARCH",(e,t,n=!1,r=[],o,i="All")=>({actionSource:e,scenarioId:t,explicitSearch:n,connectedAccountInfo:r,searchProvider:o,filter:i}))},1986:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1681),o=n(1747);function i(){const e=Object(o.c)();let t=null;return t=1===e.type?e.searchFolderId:5===e.type?e.data.searchFolderId:e.id,null==t?null:r.d.folderTable.get(t)}},1987:function(e,t,n){"use strict";n.r(t),n.d(t,"DESCENDING_SORT_DIR",(function(){return o})),n.d(t,"ASCENDING_SORT_DIR",(function(){return i})),n.d(t,"DEFAULT_SORT_COLUMN",(function(){return a})),n.d(t,"getSortBySupportingPin",(function(){return s})),n.d(t,"getSupportedSortColumns",(function(){return c})),n.d(t,"getDefaultSortDirectionForSortColumn",(function(){return u})),n.d(t,"getDefaultSortBy",(function(){return l})),n.d(t,"isTableMultiValueSort",(function(){return d}));var r=n(1678);const o="Descending",i="Ascending",a=1;function s(){return{sortColumn:1,sortDirection:o}}function c(e){return Object(r.a)("sentitems")==e||Object(r.a)("drafts")==e?[1,7]:[1,3,7,5,8]}function u(e){switch(e){case 1:case 7:case 5:return o;case 3:case 8:return i;default:throw new Error("getDefaultSortDirectionForSortColumn: sortColumn not supported")}}function l(){return{sortColumn:a,sortDirection:u(a)}}function d(e){const t=0==e.type&&e.sortBy.sortColumn;return t&&0==e.listViewType&&3==t}},1989:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"BodyContentType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},1994:function(e,t,n){"use strict";function r(e){if(!e)return null;switch(e.tableQuery.type){case 0:case 2:case 3:return e.tableQuery.focusedViewFilter;case 1:return-1;default:throw new Error("Table Query should be either of type search, mail folder or group")}}n.d(t,"a",(function(){return r}))},1997:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(47);function o(){return Object(r.j)("cal-cmp-fluidCollaborativeSpace")||Object(r.j)("cal-fluid-collabSpaceRead")}},2003:function(e,t,n){"use strict";function r(e){const{isInVirtualSelectAllMode:t,virtualSelectAllExclusionList:n,selectedRowKeys:r,rowKeys:o,totalRowsInView:i,tableQuery:a,isInCheckedMode:s}=e;return t?0===n.length:(o.length==i||1==a.type)&&(s&&r.size==o.length)}n.d(t,"a",(function(){return r}))},2004:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(1799),o=n(611),i=n(47);function a(e,t){return e.serverFolderId?e.serverFolderId==e.tableQuery.folderId?t?null:s(e.tableQuery):c(e.serverFolderId):null}function s(e){return 2==e.type?(t=e.folderId,Object(r.a)({Id:Object(i.j)("grp-junkemailitems")?"junkemail":"inbox",Mailbox:{MailboxType:"GroupMailbox",EmailAddress:t}})):c(e.folderId);var t}function c(e){return Object(o.a)({Id:e})}},2011:function(e,t,n){"use strict";function r(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}n.d(t,"a",(function(){return r}))},2012:function(e,t,n){"use strict";function r(e){return!(null==e?void 0:e.ItemClass)||-1!==e.ItemClass.indexOf("IPM.Note")||-1!==e.ItemClass.indexOf("IPM.Schedule.Meeting")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.JoinRequest")||-1!==e.ItemClass.indexOf("IPM.GroupMailbox.AddMemberRequest")||-1!==e.ItemClass.indexOf("IPM.Post")||-1!==e.ItemClass.indexOf("IPM.Sharing")||-1!==e.ItemClass.indexOf("IPM.Outlook.Recall")}n.d(t,"a",(function(){return r}))},2013:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return l}));var r=n(1747),o=n(38),i=n(1895),a=n(1693),s=n(1942);function c(e){const t=(null==e?void 0:e.itemIds)?e.itemIds.length:0;if(0==t)return[null,!1,!1];let n=null,o=2==Object(r.c)().type||!Object(r.b)(),c=!1;if(1==t){if(n=a.a.items.get(e.itemIds[0]),!n)return[null,!1,!1];o=o||n.ParentFolderId&&n.ParentFolderId.Id==Object(r.b)()}else{let t=null;for(const s of e.itemIds){const e=a.a.items.get(s);if(!e)return[null,!1,!1];if(e.ParentFolderId&&e.ParentFolderId.Id==Object(r.b)()){n=e,o=!0;break}Object(i.a)(e.ParentFolderId.Id,"sentitems")&&(t=e)}n||(n=t||a.a.items.get(e.itemIds[0]))}return c=Object(s.a)(n.ParentFolderId.Id),[n,o,c]}function u(e,t,n){var r;const i=Object(o.a)(),a=null===(r=null==i?void 0:i.UserOptions)||void 0===r?void 0:r.HideDeletedItems;return e&&!((e.IsDraft||a)&&t&&!n)}function l(e){const t=a.a.conversationNodes.get(e),[n,r,o]=c(t);return u(n,o,r)?n:null}},2014:function(e,t,n){"use strict";function r(e){return"persona"===e||"privatedistributionlist"===e||"category"===e}n.d(t,"a",(function(){return r}))},2015:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1675),o=n(1775);function i(e){return"Unread"!==Object(r.Q)(e)||Object(o.a)(64)}},2023:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(1683),o=n(1758);function i(e){return Object(o.a)()&&c(e)&&!!r.a.expandedConversationViewState.forks}function a(e){return Object(o.a)()?c(e)&&!r.a.expandedConversationViewState.forks:c(e)}function s(e){const t=r.a.expandedConversationViewState,n=t.expandedRowKey==e&&t.shouldBeExpanded;return Object(o.a)()&&n&&!t.forks}function c(e){return r.a.expandedConversationViewState.expandedRowKey==e&&!r.a.expandedConversationViewState.shouldBeExpanded}},2024:function(e,t,n){"use strict";n.d(t,"a",(function(){return ReactEditor})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(14),n.e(16),n.e(22),n.e(25),n.e(419)]).then(n.bind(null,3790)));let ReactEditor=Object(r.d)(o,e=>e.ReactEditor),i=new r.b(o,e=>e.setTableHeaderRow),a=new r.b(o,e=>e.operateContent),s=new r.b(o,e=>e.focusToEditor);function c(e){s.import().then(t=>t(e))}},2035:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"s",(function(){return i})),n.d(t,"q",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"n",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"d",(function(){return h})),n.d(t,"i",(function(){return g})),n.d(t,"p",(function(){return v})),n.d(t,"m",(function(){return y})),n.d(t,"r",(function(){return b})),n.d(t,"o",(function(){return O})),n.d(t,"l",(function(){return S}));const r="multipart/signed",o="application/pkcs7-mime",i="application/x-pkcs7-mime",a=".p7m",s="CLSID:56023A83-B4FC-413B-9285-6BB1DAD977A2",c="CLASSID",u="4",l="0800",d=57,f=78,p="IPM.Note.SMIME.MultipartSigned",m="smime-",h="image",g="OwaToSmime",v="SmimeToOwa",y="en-US",b=["Culture","CodePage","AttachmentSizeLimit","UseKeyIdentifier","AllowUserChoiceOfSigningCertificate","IncludeCertificateChainWithoutRootCertificate","IncludeCertificateChainAndRootCertificate","EncryptTemporaryBuffers","SignedEmailCertificateInclusion","IncludeSmimeCapabilitiesInMessage","CopyRecipientHeaders","OnlyUseSmartCard","EncryptionAlgorithms","SigningAlgorithms","AlwaysEncrypt","AlwaysSign","TripleWrapSignedEncryptedMail","BccEncryptedEmailForking"],O="https://microsoftedge.microsoft.com/addons/detail/gamjhjfeblghkihfjdpmbpajhlpmobbp",S="chrome-extension://maafgiompdekodanheihhgilkjchcakm/Options.html"},2036:function(e,t,n){"use strict";var r=n(2792),o=n(702);const i=Object(o.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=[...e.infoBarIds];const o=e.infoBarHostKey;n&&(r.b[o]||(r.b[o]={}),r.b[o][t]=n)}}));t.a=i},2044:function(e,t,n){"use strict";var r=n(225),o=n(810),i=n(1851),a=n(976),s=n(3);const c=Object(s.action)("resolvePendingPersonaOnRecipient",(e,t,n)=>({recipient:e,nextPersona:t,searchedString:n}));Object(s.mutator)(c,({recipient:e,nextPersona:t,searchedString:n})=>{Object(o.a)(e.persona.EmailAddress)===n&&(e.isPendingResolution=!1,t&&(e.persona=t,e.isValid=!0,e.displayText=Object(a.a)(t.EmailAddress)))});var u=c,l=n(47),d=n(326);const f=Object(s.action)("addRecipientsToRecipientWell",(e,t)=>({newRecipients:e,recipientWell:t}));t.a=f;Object(s.mutator)(f,e=>{const{recipientWell:t}=e;t.recipients.splice(t.recipients.length,0,...e.newRecipients),t.isDirty=!0}),Object(s.orchestrator)(f,e=>{const{newRecipients:t,recipientWell:n}=e;t.forEach(async e=>{if(!e.isPendingResolution)return;const t=Object(o.a)(e.persona.EmailAddress);let a=n.userIdentity;a||(a=Object(r.d)().userIdentity);const s=await i.g.import().then(e=>e(a,t));if(Object(l.j)("rp-3STelemetryEvents")&&null==s){const t=n.findPeopleFeedbackManager.conversationId;i.b.import().then(n=>n(e.persona,t)),n.findPeopleFeedbackManager.conversationId=Object(d.a)()}u(e,s,t)})})},2045:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1725),o=[r.a.lightBlue,r.a.blue,r.a.darkBlue,r.a.teal,r.a.green,r.a.darkGreen,r.a.lightPink,r.a.pink,r.a.magenta,r.a.purple,r.a.orange,r.a.lightRed,r.a.darkRed,r.a.violet,r.a.gold,r.a.burgundy,r.a.warmGray,r.a.cyan,r.a.rust,r.a.coolGray],i=o.length;function a(e){var t=e.primaryText,n=e.text,a=e.initialsColor;return"string"==typeof a?a:function(e){switch(e){case r.a.lightBlue:return"#4F6BED";case r.a.blue:return"#0078D4";case r.a.darkBlue:return"#004E8C";case r.a.teal:return"#038387";case r.a.lightGreen:case r.a.green:return"#498205";case r.a.darkGreen:return"#0B6A0B";case r.a.lightPink:return"#C239B3";case r.a.pink:return"#E3008C";case r.a.magenta:return"#881798";case r.a.purple:return"#5C2E91";case r.a.orange:return"#CA5010";case r.a.red:return"#EE1111";case r.a.lightRed:return"#D13438";case r.a.darkRed:return"#A4262C";case r.a.transparent:return"transparent";case r.a.violet:return"#8764B8";case r.a.gold:return"#986F0B";case r.a.burgundy:return"#750B1C";case r.a.warmGray:return"#7A7574";case r.a.cyan:return"#005B70";case r.a.rust:return"#8E562E";case r.a.coolGray:return"#69797E";case r.a.black:return"#1D1D1D";case r.a.gray:return"#393939"}}(a=void 0!==a?a:function(e){var t=r.a.blue;if(!e)return t;for(var n=0,a=e.length-1;a>=0;a--){var s=e.charCodeAt(a),c=a%8;n^=(s<<c)+(s>>8-c)}return t=o[n%i]}(n||t))}},2053:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Pending=1]="Pending",e[e.Complete=2]="Complete"}(r||(r={}))},2058:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(225);const o={};function i(e){const t=e.toLocaleLowerCase();if(!o[t]){const n={type:"GroupMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e};o[t]=n}return o[t]}},2059:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return p}));const r="SwitchGroup",o="NavigateFromMeToWe",i="GroupHeader_SendEmail_Button_Clicked",a="GroupHeader_Email_Button_Clicked",s="GroupHeader_Files_Button_Clicked",c="GroupHeader_Calendar_Button_Clicked",u="GroupHeader_Notebook_Button_Clicked",l="GroupHeader_Planner_Button_Clicked",d="GroupHeader_Site_Button_Clicked",f="GroupHeader_CustomLeaveGroup_Button_Clicked",p="GroupHeader_Settings_Button_Clicked"},2061:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return f}));var r=n(1734),o=n(2682),i=n(2584),a=n(2274);function s(e){return Object(r.a)().runningUILessExtendedAddinCommands.has(e)}function c(e){var t;const n=null===(t=Object(r.a)().runningUILessExtendedAddinCommands)||void 0===t?void 0:t.get(e);if(n)for(let e of n.values()){if(!(e.addinCommand instanceof o.a))return!0}return!1}function u(e){const t=p();if(!t)return null;for(const n of t.values())for(const t of n.keys())if(t===e)return n.get(t).addinCommand;return null}function l(e,t){const n=Object(i.a)(t),r=Object(a.a)(n,e);return p().has(r)&&p().get(r).has(t)?p().get(r).get(t).addinCommandTelemetry:null}function d(e){const t=p();if(!t)return null;for(const n of t.keys()){const r=t.get(n);for(const t of r.keys())if(t===e)return n}return null}function f(e){return null!==u(e)}function p(){return Object(r.a)().runningUILessExtendedAddinCommands}},2066:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2015),o=n(1675);function i(e){return"Unread"==Object(o.Q)(e)&&Object(r.a)(e)}},207:function(e,t,n){"use strict";var r;function o(e){return!!e&&e<7}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.loading=1]="loading",e[e.setVariables=2]="setVariables",e[e.fetchMore=3]="fetchMore",e[e.refetch=4]="refetch",e[e.poll=6]="poll",e[e.ready=7]="ready",e[e.error=8]="error"}(r||(r={}))},2073:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(225),o=n(1688),i=n(1679),a=n(38),s=n(1919);function c(e,t){var n;const c=Object(o.a)(),u=null==c?void 0:c.get(e),l=Object(a.a)().SessionSettings;let d,f,p,m;const h=Object(r.d)();return"SharedMailbox"===(null==u?void 0:u.mailboxInfo.type)?(d=u.mailboxInfo.mailboxSmtpAddress,m="SharedMailbox"):e==i.d||e==i.b||"ArchiveMailbox"==(null==u?void 0:u.mailboxInfo.type)?(p=null===(n=null==u?void 0:u.replicaList)||void 0===n?void 0:n[0],p&&t?f=p:(f=l.ArchiveMailboxGuid,p=void 0),m="ArchiveMailbox",d=Object(s.a)(f,l.OrganizationDomain)):(d=h.mailboxSmtpAddress,m="UserMailbox"),{type:m,userIdentity:h.userIdentity,mailboxSmtpAddress:d,auxiliaryMailboxGuid:p}}},2091:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1693);function o(e){return r.a.items.get(e)}},2092:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1702);function o(e,t){const n=Object(r.a)(t),o=n&&n.get(e);return(null==o?void 0:o.currentLoadedIndex)||0}},2096:function(e,t,n){"use strict";n.d(t,"m",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"q",(function(){return f})),n.d(t,"p",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"o",(function(){return h})),n.d(t,"l",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"c",(function(){return y})),n.d(t,"g",(function(){return b})),n.d(t,"n",(function(){return O})),n.d(t,"b",(function(){return S})),n.d(t,"e",(function(){return C}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(0),n.e(4),n.e(8),n.e(10),n.e(265)]).then(n.bind(null,3702))),i={captureBundleTime:!0};let a=new r.a(o,e=>e.replyToMessage,i),s=new r.a(o,e=>e.forwardMessage,i),c=new r.a(o,e=>e.closeCompose),u=new r.a(o,e=>e.discardCompose),l=new r.a(o,e=>e.loadDraftToCompose),d=new r.a(o,e=>e.openCompose),f=new r.a(o,e=>e.trySaveAndCloseCompose),p=new r.a(o,e=>e.trySaveAndCloseAllMessages),m=new r.a(o,e=>e.moveComposeToTab),h=new r.a(o,e=>e.tryCreateResendDraft),g=new r.a(o,e=>e.replyToApprovalMessage);const v=new r.a(o,e=>e.onEditDraftButtonClicked);let y=new r.b(o,e=>e.createReply),b=new r.b(o,e=>e.getToCcRecipientsForReply),O=new r.b(o,e=>e.replyToMessageAndCreateViewState),S=new r.b(o,e=>e.createAttachments),C=new r.b(o,e=>e.extractComposePopoutData)},2099:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(538),s=n(127),c=n(740),u=n(50),l=n(168),d=n(990),f=n(8),p=n(334),m=n(1725),h=n(1756),g=n(453),v=Object(a.a)({cacheSize:100}),y=i.forwardRef((function(e,t){var n=e.coinSize,r=e.isOutOfOffice,o=e.styles,a=e.presence,s=e.theme,c=e.presenceTitle,u=e.presenceColors,l=i.useRef(null),d=Object(g.a)(t,l),f=Object(h.d)(e.size),y=!(f.isSize8||f.isSize10||f.isSize16||f.isSize24||f.isSize28||f.isSize32)&&(!n||n>32),O=n?n/3<40?n/3+"px":"40px":"",S=n?{fontSize:n?n/6<20?n/6+"px":"20px":"",lineHeight:O}:void 0,C=n?{width:O,height:O}:void 0,A=v(o,{theme:s,presence:a,size:e.size,isOutOfOffice:r,presenceColors:u});return a===m.b.none?null:i.createElement("div",{role:"presentation",className:A.presence,style:C,title:c,ref:d},y&&i.createElement(p.a,{className:A.presenceIcon,iconName:b(e.presence,e.isOutOfOffice),style:S}))}));function b(e,t){if(e){switch(m.b[e]){case"online":return"SkypeCheck";case"away":return t?"SkypeArrow":"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?"SkypeArrow":""}return""}}y.displayName="PersonaPresenceBase";var O={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function S(e){return{color:e,borderColor:e}}function C(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function A(e){return{height:e,width:e}}function _(e){return{backgroundColor:e}}var I=Object(r.a)(y,(function(e){var t,n,r,i,a,s,c=e.theme,u=e.presenceColors,l=c.semanticColors,d=c.fonts,p=Object(f.getGlobalClassNames)(O,c),m=Object(h.d)(e.size),g=Object(h.c)(e.presence),v=u&&u.available||"#6BB700",y=u&&u.away||"#FFAA44",b=u&&u.busy||"#C43148",I=u&&u.dnd||"#C50F1F",x=u&&u.offline||"#8A8886",E=u&&u.oof||"#B4009E",T=u&&u.background||l.bodyBackground,w=g.isOffline||e.isOutOfOffice&&(g.isAvailable||g.isBusy||g.isAway||g.isDoNotDisturb),M=m.isSize72||m.isSize100?"2px":"1px";return{presence:[p.presence,Object(o.__assign)(Object(o.__assign)({position:"absolute",height:h.a.size12,width:h.a.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+T,textAlign:"center",boxSizing:"content-box",backgroundClip:"border-box"},Object(f.getHighContrastNoAdjustStyle)()),{selectors:(t={},t[f.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},t)}),(m.isSize8||m.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[f.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},n)},(m.isSize8||m.isSize10||m.isSize24||m.isSize28||m.isSize32)&&A(h.a.size8),(m.isSize40||m.isSize48)&&A(h.a.size12),m.isSize16&&{height:h.a.size6,width:h.a.size6,borderWidth:"1.5px"},m.isSize56&&A(h.a.size16),m.isSize72&&A(h.a.size20),m.isSize100&&A(h.a.size28),m.isSize120&&A(h.a.size32),g.isAvailable&&{backgroundColor:v,selectors:(r={},r[f.HighContrastSelector]=_("Highlight"),r)},g.isAway&&_(y),g.isBlocked&&[{selectors:(i={":after":m.isSize40||m.isSize48||m.isSize72||m.isSize100?{content:'""',width:"100%",height:M,backgroundColor:b,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},i[f.HighContrastSelector]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},i)}],g.isBusy&&_(b),g.isDoNotDisturb&&_(I),g.isOffline&&_(x),(w||g.isBlocked)&&[{backgroundColor:T,selectors:(a={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:M+" solid "+b,borderRadius:"50%",boxSizing:"border-box"}},a[f.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},a)}],w&&g.isAvailable&&C(M,v),w&&g.isBusy&&C(M,b),w&&g.isAway&&C(M,E),w&&g.isDoNotDisturb&&C(M,I),w&&g.isOffline&&C(M,x),w&&g.isOffline&&e.isOutOfOffice&&C(M,E)],presenceIcon:[p.presenceIcon,{color:T,fontSize:"6px",lineHeight:h.a.size12,verticalAlign:"top",selectors:(s={},s[f.HighContrastSelector]={color:"Window"},s)},m.isSize56&&{fontSize:"8px",lineHeight:h.a.size16},m.isSize72&&{fontSize:d.small.fontSize,lineHeight:h.a.size20},m.isSize100&&{fontSize:d.medium.fontSize,lineHeight:h.a.size28},m.isSize120&&{fontSize:d.medium.fontSize,lineHeight:h.a.size32},g.isAway&&{position:"relative",left:w?void 0:"1px"},w&&g.isAvailable&&S(v),w&&g.isBusy&&S(b),w&&g.isAway&&S(E),w&&g.isDoNotDisturb&&S(I),w&&g.isOffline&&S(x),w&&g.isOffline&&e.isOutOfOffice&&S(E)]}}),void 0,{scope:"PersonaPresence"}),x=n(56),E=n(335),T=n(2045),w=Object(a.a)({cacheSize:100}),M=Object(s.c)((function(e,t,n,r,o,i){return Object(f.mergeStyles)(e,!i&&{backgroundColor:Object(T.a)({text:r,initialsColor:t,primaryText:o}),color:n})})),k={size:m.c.size48,presence:m.b.none,imageAlt:""};var j=i.forwardRef((function(e,t){var n=Object(c.a)(k,e),r=function(e){var t=e.onPhotoLoadingStateChange,n=e.imageUrl,r=i.useState(x.c.notLoaded),o=r[0],a=r[1];return i.useEffect((function(){a(x.c.notLoaded)}),[n]),[o,function(e){a(e),null==t||t(e)}]}(n),a=r[0],s=r[1],l=P(s),d=n.className,f=n.coinProps,h=n.showUnknownPersonaCoin,g=n.coinSize,v=n.styles,y=n.imageUrl,b=n.initialsColor,O=n.initialsTextColor,S=n.isOutOfOffice,C=n.onRenderCoin,A=void 0===C?l:C,_=n.onRenderPersonaCoin,E=void 0===_?A:_,T=n.onRenderInitials,j=void 0===T?R:T,N=n.presence,D=n.presenceTitle,F=n.presenceColors,L=n.primaryText,U=n.showInitialsUntilImageLoads,B=n.text,H=n.theme,V=n.size,z=Object(u.j)(n,u.h),W=Object(u.j)(f||{},u.h),G=g?{width:g,height:g}:void 0,q=h,K={coinSize:g,isOutOfOffice:S,presence:N,presenceTitle:D,presenceColors:F,size:V,theme:H},X=w(v,{theme:H,className:f&&f.className?f.className:d,size:V,coinSize:g,showUnknownPersonaCoin:h}),Q=Boolean(a!==x.c.loaded&&(U&&y||!y||a===x.c.error||q));return i.createElement("div",Object(o.__assign)({role:"presentation"},z,{className:X.coin,ref:t}),V!==m.c.size8&&V!==m.c.size10&&V!==m.c.tiny?i.createElement("div",Object(o.__assign)({role:"presentation"},W,{className:X.imageArea,style:G}),Q&&i.createElement("div",{className:M(X.initials,b,O,B,L,h),style:G,"aria-hidden":"true"},j(n,R)),!q&&E(n,l),i.createElement(I,Object(o.__assign)({},K))):n.presence?i.createElement(I,Object(o.__assign)({},K)):i.createElement(p.a,{iconName:"Contact",className:X.size10WithoutPresenceIcon}),n.children)}));j.displayName="PersonaCoinBase";var P=function(e){return function(t){var n=t.coinSize,r=t.styles,o=t.imageUrl,a=t.imageAlt,s=t.imageShouldFadeIn,c=t.imageShouldStartVisible,u=t.theme,l=t.showUnknownPersonaCoin,d=t.size,f=void 0===d?k.size:d;if(!o)return null;var p=w(r,{theme:u,size:f,showUnknownPersonaCoin:l}),m=n||h.e[f];return i.createElement(E.a,{className:p.image,imageFit:x.b.cover,src:o,width:m,height:m,alt:a,shouldFadeIn:s,shouldStartVisible:c,onLoadingStateChange:e})}},R=function(e){var t=e.imageInitials,n=e.allowPhoneInitials,r=e.showUnknownPersonaCoin,o=e.text,a=e.primaryText,s=e.theme;if(r)return i.createElement(p.a,{iconName:"Help"});var c=Object(l.a)(s);return""!==(t=t||Object(d.a)(o||a||"",c,n))?i.createElement("span",null,t):i.createElement(p.a,{iconName:"Contact"})},N={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"};n.d(t,"a",(function(){return D}));var D=Object(r.a)(j,(function(e){var t,n=e.className,r=e.theme,i=e.coinSize,a=r.palette,s=r.fonts,c=Object(h.d)(e.size),u=Object(f.getGlobalClassNames)(N,r),l=i||e.size&&h.e[e.size]||48;return{coin:[u.coin,s.medium,c.isSize8&&u.size8,c.isSize10&&u.size10,c.isSize16&&u.size16,c.isSize24&&u.size24,c.isSize28&&u.size28,c.isSize32&&u.size32,c.isSize40&&u.size40,c.isSize48&&u.size48,c.isSize56&&u.size56,c.isSize72&&u.size72,c.isSize100&&u.size100,c.isSize120&&u.size120,n],size10WithoutPresenceIcon:{fontSize:s.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[u.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:l,width:l},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[u.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0},l>10&&{height:l,width:l}],initials:[u.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":a.white,fontSize:s.large.fontSize,fontWeight:f.FontWeights.semibold,lineHeight:48===l?46:l,height:l,selectors:(t={},t[f.HighContrastSelector]=Object(o.__assign)(Object(o.__assign)({border:"1px solid WindowText"},Object(f.getHighContrastNoAdjustStyle)()),{color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"}),t.i={fontWeight:f.FontWeights.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},l<32&&{fontSize:s.xSmall.fontSize},l>=32&&l<40&&{fontSize:s.medium.fontSize},l>=40&&l<56&&{fontSize:s.mediumPlus.fontSize},l>=56&&l<72&&{fontSize:s.xLarge.fontSize},l>=72&&l<100&&{fontSize:s.xxLarge.fontSize},l>=100&&{fontSize:s.superLarge.fontSize}]}}),void 0,{scope:"PersonaCoin"})},2101:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2792),o=n(3);const i=Object(o.mutatorAction)("removeInfoBarMessages",(e,t,n)=>{t>=0&&e.infoBarIds.splice(t,1);const o=e.infoBarHostKey;r.b[o]&&(delete r.b[o][n],0===Object.keys(r.b[o]).length&&delete r.b[o])});function a(e,t){if(e){const n=Array.isArray(t)?t:t?[t]:e.infoBarIds?[...e.infoBarIds]:[];for(const t of n){const n=e.infoBarIds&&e.infoBarIds.indexOf(t);i(e,n,t)}}}},2102:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(1961);const o=()=>[...Object(r.a)().providers.values()],i=e=>Object(r.a)().providers.get(e)||null},2104:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(1709),o=n(47);function i(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(o.j)("cmp-prague")&&(".fluid"===t||".note"===t))}function a(e){const t=(Object(r.a)(e)||"").toLowerCase();return!!e&&(Object(o.j)("cmp-prague")&&".note"===t)}},2105:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1686),o=n(57);function i(){let e=!0;if(Object(o.r)()){const t=Object(r.g)(r.d.ExternalImages);e=null===t.externalImagesSelectedOption||0===t.externalImagesSelectedOption}else{const t=Object(o.g)().PolicySettings;e=void 0===t.ExternalImageProxyEnabled||t.ExternalImageProxyEnabled}return e}},2108:function(e,t,n){"use strict";n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"q",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"u",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return h})),n.d(t,"j",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"l",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"c",(function(){return O})),n.d(t,"p",(function(){return S})),n.d(t,"s",(function(){return C})),n.d(t,"b",(function(){return A})),n.d(t,"m",(function(){return _})),n.d(t,"h",(function(){return I})),n.d(t,"t",(function(){return x})),n.d(t,"n",(function(){return E}));var r=n(20),o=n(2377);n.d(t,"v",(function(){return o.a}));var i=n(2378);n.d(t,"w",(function(){return i.a}));const a=new r.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(319)]).then(n.bind(null,4005))),s=new r.a(a,e=>e.initializeAttachments),c=new r.a(a,e=>e.reinitializeAttachments),u=(new r.a(a,e=>e.setInlineAttachmentStatus),new r.a(a,e=>e.addAttachmentIntoWellBeforeUpload)),l=new r.b(a,e=>e.refreshSharingTipsAttachmentWell),d=new r.b(a,e=>e.createAttachmentsViaQueueManager),f=new r.b(a,e=>e.createAttachmentsFromRecentAttachments),p=new r.a(a,e=>e.deleteAttachmentViaQueueManager),m=new r.b(a,e=>e.createAttachmentFullViewStateAndStoreBackingModel),h=new r.b(a,e=>e.createAttachmentFullViewState),g=new r.b(a,e=>e.getAttachmentWellInitialValue),v=new r.b(a,e=>e.getAttachmentWellForCompose),y=new r.b(a,e=>e.getConversationAttachmentWellInitialValue),b=(new r.b(a,e=>e.getMaxClassicAttachmentsSize),new r.b(a,e=>e.getAvailableLocalAttachmentSize)),O=new r.b(a,e=>e.createAttachmentFileFromExistingMailboxAttachment),S=new r.a(a,e=>e.mergeToConversationAttachmentWell),C=new r.a(a,e=>e.sortConversationAttachmentWell),A=new r.a(a,e=>e.convertImageViewAttachmentToInlineAttachment),_=new r.b(a,e=>e.getLastCloudyAttachmentsSharingIssueForBlockOnSend),I=new r.b(a,e=>e.getAllValidAttachments),x=new r.b(a,e=>e.uploadLocalFile),E=new r.b(a,e=>e.getShouldShareAttachmentProperties)},2111:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1902),o=n(3055);function i(e){return Object(r.b)().loadedConversationReadingPaneViewStates.get(e||Object(r.b)().sxsItemId||Object(o.a)())}},212:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=Object.prototype,o=r.toString,i=r.hasOwnProperty,a=Function.prototype.toString,s=new Map;function c(e,t){try{return function e(t,n){if(t===n)return!0;var r=o.call(t),s=o.call(n);if(r!==s)return!1;switch(r){case"[object Array]":if(t.length!==n.length)return!1;case"[object Object]":if(f(t,n))return!0;var c=u(t),l=u(n),p=c.length;if(p!==l.length)return!1;for(var m=0;m<p;++m)if(!i.call(n,c[m]))return!1;for(m=0;m<p;++m){var h=c[m];if(!e(t[h],n[h]))return!1}return!0;case"[object Error]":return t.name===n.name&&t.message===n.message;case"[object Number]":if(t!=t)return n!=n;case"[object Boolean]":case"[object Date]":return+t==+n;case"[object RegExp]":case"[object String]":return t==""+n;case"[object Map]":case"[object Set]":if(t.size!==n.size)return!1;if(f(t,n))return!0;for(var g=t.entries(),v="[object Map]"===r;;){var y=g.next();if(y.done)break;var b=y.value,O=b[0],S=b[1];if(!n.has(O))return!1;if(v&&!e(S,n.get(O)))return!1}return!0;case"[object Uint16Array]":case"[object Uint8Array]":case"[object Uint32Array]":case"[object Int32Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object ArrayBuffer]":t=new Uint8Array(t),n=new Uint8Array(n);case"[object DataView]":var C=t.byteLength;if(C===n.byteLength)for(;C--&&t[C]===n[C];);return-1===C;case"[object AsyncFunction]":case"[object GeneratorFunction]":case"[object AsyncGeneratorFunction]":case"[object Function]":var A=a.call(t);return A===a.call(n)&&(I=d,!((x=(_=A).length-I.length)>=0&&_.indexOf(I,x)===x))}var _,I,x;return!1}(e,t)}finally{s.clear()}}function u(e){return Object.keys(e).filter(l,e)}function l(e){return void 0!==this[e]}var d="{ [native code] }";function f(e,t){var n=s.get(e);if(n){if(n.has(t))return!0}else s.set(e,n=new Set);return n.add(t),!1}},213:function(e,t,n){"use strict";var r=n(36);let o;function i(){return null==o&&(o="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),o}var a=n(113);const s=500,c=[],u=[],l=[];let d=!0;function f(e,t){Object(r.g)((e,t,n,o)=>{d&&(t==r.b.Error&&u.push({message:e,error:o}),c.push({message:e,level:t}))}),e(m),t(m),i()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(s):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(s))}function p(e){const t=Object(a.a)(e);return d=!1,{traces:c,errors:u,network:l,usage:t}}function m(){d&&l.push(arguments)}n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return a.b})),n.d(t,"c",(function(){return i}))},2132:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20),o=n(2759);function i(e,t,n,i,a){return class{constructor(...e){this.onImportedCallbacks=[],this.args=e,this.pluginName=n}initialize(e){this.editor=e,this.pendingEvents=[],this.pluginInstance?this.initializeAndCallback():i||this.internalImport()}dispose(){this.pluginInstance&&(this.pluginInstance.dispose(),a||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]}getName(){return this.isImported()?this.pluginInstance.getName():this.pluginName}setPluginUtils(e){this.pluginUtils=e,Object(o.a)(this.pluginInstance)&&this.pluginInstance.setPluginUtils(this.pluginUtils)}getContextMenuItems(e){var t,n;return this.isImported()?null===(n=(t=this.pluginInstance).getContextMenuItems)||void 0===n?void 0:n.call(t,e):null}onPluginEvent(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):(null==i?void 0:i(e,this.editor))&&this.internalImport(e)}willHandleEventExclusively(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)}getPlugin(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()}isImported(){return!!this.pluginInstance}addOnImportedCallback(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)}initializeAndCallback(){this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach(e=>e(this.pluginInstance))}internalImport(n){return this.importPluginPromise||(this.importPluginPromise=new r.b(e,t).import().then(e=>(this.pluginInstance=new e(...this.args),this.setPluginUtils(this.pluginUtils),this.editor&&(this.initializeAndCallback(),this.pendingEvents.length>0&&this.pluginInstance.onPluginEvent&&this.pendingEvents.forEach(e=>{this.pluginInstance.onPluginEvent(e)}),this.pendingEvents=[]),this.pluginInstance)),this.importPluginPromise.catch(()=>{this.pendingEvents=[]})),n&&this.pendingEvents.push(n),this.importPluginPromise}}}},2136:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded",e[e.Throttled=3]="Throttled"}(r||(r={}))},2167:function(e,t,n){"use strict";function r(e){return 0===e.tableQuery.listViewType}n.d(t,"a",(function(){return r}))},2168:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"y",(function(){return s})),n.d(t,"l",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return l})),n.d(t,"p",(function(){return d})),n.d(t,"E",(function(){return f})),n.d(t,"G",(function(){return p})),n.d(t,"O",(function(){return m})),n.d(t,"K",(function(){return h})),n.d(t,"J",(function(){return g})),n.d(t,"w",(function(){return v})),n.d(t,"x",(function(){return y})),n.d(t,"i",(function(){return b})),n.d(t,"h",(function(){return O})),n.d(t,"d",(function(){return S})),n.d(t,"I",(function(){return C})),n.d(t,"N",(function(){return A})),n.d(t,"v",(function(){return _})),n.d(t,"u",(function(){return I})),n.d(t,"s",(function(){return x})),n.d(t,"r",(function(){return E})),n.d(t,"B",(function(){return T})),n.d(t,"C",(function(){return w})),n.d(t,"t",(function(){return M})),n.d(t,"q",(function(){return k})),n.d(t,"H",(function(){return j})),n.d(t,"Q",(function(){return P})),n.d(t,"R",(function(){return R})),n.d(t,"f",(function(){return N})),n.d(t,"e",(function(){return D})),n.d(t,"a",(function(){return F})),n.d(t,"F",(function(){return L})),n.d(t,"g",(function(){return U})),n.d(t,"L",(function(){return B})),n.d(t,"o",(function(){return H})),n.d(t,"n",(function(){return V})),n.d(t,"M",(function(){return z})),n.d(t,"A",(function(){return W})),n.d(t,"z",(function(){return G})),n.d(t,"m",(function(){return q})),n.d(t,"D",(function(){return K})),n.d(t,"P",(function(){return X}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(8),n.e(10),n.e(13),n.e(19),n.e(302)]).then(n.bind(null,7332))),i=new r.a(o,e=>e.addMailboxToSafeSenders),a=new r.a(o,e=>e.alwaysMoveRowToFocusedOrOther),s=new r.a(o,e=>e.moveMailListRowsToFocusedOrOther),c=new r.a(o,e=>e.deleteMailListRows),u=new r.a(o,e=>e.deleteItems),l=new r.b(o,e=>e.deleteItemsBasedOnNodeOrThreadIds),d=new r.b(o,e=>e.likeItem),f=new r.a(o,e=>e.reactToItem),p=new r.a(o,e=>e.restoreAllItems),m=new r.a(o,e=>e.toggleRowsFlagState),h=new r.a(o,e=>e.setMailListRowsFlagState),g=new r.a(o,e=>e.setItemsFlagStateFromItemIds),v=(new r.a(o,e=>e.moveItemsFromItemIds),new r.b(o,e=>e.moveItemsBasedOnNodeIds)),y=new r.a(o,e=>e.moveMailListRows),b=new r.a(o,e=>e.copyMailListRows),O=new r.a(o,e=>e.copyGroupMailListRows),S=new r.a(o,e=>e.archiveMailListRowsFromTable),C=new r.b(o,e=>e.scheduleRows),A=new r.a(o,e=>e.toggleRowPinnedState),_=new r.a(o,e=>e.markRowsPinnedUnpinned),I=new r.a(o,e=>e.markRowsJunkNotJunkFromTable),x=new r.b(o,e=>e.markItemsJunkNotJunkBasedOnNodeIds),E=new r.a(o,e=>e.markItemJunkNotJunkFromReadingPane),T=new r.a(o,e=>e.onKeyboardMarkAsJunkNotJunk),w=new r.a(o,e=>e.onKeyboardToggleFlagState),M=new r.a(o,e=>e.markRowsAsPhishingFromTable),k=new r.a(o,e=>e.markItemAsPhishingFromReadingPane),j=new r.a(o,e=>e.restoreMailListRows),P=new r.a(o,e=>e.unsubscribeEmail),R=new r.b(o,e=>e.unsubscribeEmailV2),N=new r.a(o,e=>e.blockLastSendersFromTable),D=new r.a(o,e=>e.blockLastSenderFromReadingPane),F=new r.a(o,e=>e.addCategoriesFromTable),L=new r.a(o,e=>e.removeCategoriesFromTable),U=new r.a(o,e=>e.clearCategoriesFromTable),B=new r.a(o,e=>e.sweepConversations),H=new r.a(o,e=>e.emptyTableView),V=new r.a(o,e=>e.emptySearchTableView),z=new r.b(o,e=>e.toggleIgnoreConversations),W=new r.b(o,e=>e.moveSharedFolderItems),G=new r.b(o,e=>e.moveSharedFolderConversations),q=new r.b(o,e=>e.dismissNudge),K=new r.b(o,e=>e.onRemoveMeeting),X=new r.a(o,e=>e.translateFromTable)},217:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}));var r=n(840),o=function(){function e(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}return e.prototype.toJSON=function(){return{start:this.start,end:this.end}},e}();Object(r.a)(o);var i=function(){function e(e,t,n,r,o,i,a){this.kind=e,this.start=t,this.end=n,this.line=r,this.column=o,this.value=a,this.prev=i,this.next=null}return e.prototype.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();function a(e){return null!=e&&"string"==typeof e.kind}Object(r.a)(i)},218:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(3);const o={loadState:n(514).b.Loading,selectedSourceId:"",globalSettingsSourceId:"",sources:[]},i=Object(r.createStore)("AccountSourceList",o);t.a=i},2197:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"Message:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2211:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1735);function o(e,t){return{headers:Object(r.e)(e,"GroupMailbox",!1,t)}}},2213:function(e){e.exports=JSON.parse('{"b":"Haa","d":"Iaa","c":"Jaa","a":"Kaa"}')},2224:function(e,t,n){"use strict";var r=n(71),o=n(282),i=n(47),a=n(296),s=n(1686),c=n(99),u=n(1774),l=n(624),d=n(1997);function f(e){var t;const n=Object(s.g)(s.d.Bohemia);if(Object(a.a)()||!(null===(t=Object(u.a)())||void 0===t?void 0:t.AttachmentDataProviderAvailable)||!function(){switch(Object(c.a)().browser){case"Chrome":case"Firefox":case"Edge Anaheim":case"Opera":return!0;case"Safari":return"Windows"!==Object(c.b)().os&&Object(c.m)([13,1]);default:return!1}}()||!n.fluidEnabledForTenant||!n.bohemiaEnabled)return Object(s.h)().loadState!==s.b.OptionsLoaded&&Object(r.o)("FluidEnabledNotFetchedWhenChecked",{source:e},{isCore:!0}),!1;switch(e){case 0:case 1:case 5:case 7:return Object(i.j)("cmp-prague");case 2:case 6:case 3:return function(e){if(!Object(i.j)("cmp-prague")||Object(l.d)())return!1;switch(e){case 2:case 6:return Object(d.a)();case 3:return Object(i.j)("cal-cmp-fluidCollaborativeSpace");default:return!1}}(e);case 4:return Object(i.j)("cmp-prague")&&(Object(i.j)("cal-board-fluidAsset")||Object(i.j)("cal-board-dev-createFluidAsset"));default:return Object(o.a)(e)}}const p={0:"MailReadingPane",1:"MailCompose",5:"AgendaEditor",4:"CalendarBoard",2:"CalendarReadingPane",3:"CalendarCompose",6:"MailCalendarCard",7:"None"};n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p}))},2229:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2579),o=n(2580),i=n(2594),a=n(6),s=n(1675);function c(e,t,n){if(1===e)return Object(a.b)(i.a);if(t){if(Object(s.P)(t))return Object(s.P)(t);switch(Object(s.n)(t)){case 0:return Object(a.b)(o.a);case 1:return Object(a.b)(r.a)}}return n}},2230:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1791);function o(e,t,n,o){const i=[],a=new Map;for(let s=0;s<e.length;s++){const c=e[s],u=Object(r.a)(c,t),l=u.id;!a.get(l)&&n(u,o)&&(i.push(c),a.set(l,!0))}return i}},2239:function(e){e.exports=JSON.parse('{"a":"I6b","b":"J6b","c":"K6b"}')},2240:function(e){e.exports=JSON.parse('{"a":"F6b","b":"G6b","c":"H6b"}')},2241:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2014);function o(e,t){switch(e.tableQuery.type){case 0:const n=e.tableQuery.scenarioType;return t&&!Object(r.a)(n)?e.tableQuery.folderId:e.serverFolderId;case 1:case 2:default:return null}}},2242:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1683),o=n(1866);function i(e,t){const n=r.a.tableViews.get(t),i=e.map(e=>Object(o.getRowIdString)(e,n)).filter(e=>e);return i.filter((e,t)=>i.indexOf(e)==t)}},2243:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.BusStart=1]="BusStart",e[e.BusEnd=2]="BusEnd",e[e.BusStop=3]="BusStop",e[e.NoStop=4]="NoStop",e[e.CheckMark=5]="CheckMark"}(r||(r={})),t.a=r},226:function(e,t,n){"use strict";function r(e){var t,n;if((null==e?void 0:e.length)>0){const r=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(n=e[1])||void 0===n?void 0:n.length)>0?r:void 0}}const o="bearer",i="msauth1.0",a=3600,s=86400,c=6e4,u=1e3;function l(e){if(e){const t=e.split(" ");return r(t)==o?t[1]:e}}function d(e,t){if(e){const n=r(e.split(" "));if(n){if(t){return(1e3*t-Date.now()-c)/u}return n==i?s:a}}}function f(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}))},2263:function(e,t,n){"use strict";n(2211);var r=n(2058);function o(e){let t=void 0;switch(e){case"None":t=0;break;case"Private":t=1;break;case"Secret":t=2;break;case"Public":t=3}return t}var i=n(3),a=Object(i.action)("EDIT_GROUP_SUCCESS",(e,t)=>({groupSmtp:e,photoUrl:t})),s=Object(i.action)("ADD_GROUP_MEMBER_SUCCESS",e=>({groupSmtp:e})),c=Object(i.action)("MEMBER_MANAGEMENT_SUCCESS",e=>({groupSmtp:e})),u=Object(i.action)("POPUP_OPENED",()=>({isOpen:!0})),l=Object(i.action)("POPUP_CLOSED",()=>({isOpen:!1})),d=Object(i.action)("DELETE_GROUP_SUCCESS",e=>({groupSmtp:e})),f=Object(i.action)("EDIT_GROUP_SMTP_SUCCESS",(e,t,n,r)=>({aadObjectId:e,groupSmtp:t,photoUrl:n,oldGroupSmtp:r})),p=n(2059);n.d(t,"n",(function(){return r.a})),n.d(t,"o",(function(){return o})),n.d(t,"m",(function(){return a})),n.d(t,"j",(function(){return s})),n.d(t,"p",(function(){return c})),n.d(t,"r",(function(){return u})),n.d(t,"q",(function(){return l})),n.d(t,"k",(function(){return d})),n.d(t,"l",(function(){return f})),n.d(t,"g",(function(){return p.g})),n.d(t,"c",(function(){return p.c})),n.d(t,"d",(function(){return p.d})),n.d(t,"a",(function(){return p.a})),n.d(t,"e",(function(){return p.e})),n.d(t,"f",(function(){return p.f})),n.d(t,"i",(function(){return p.i})),n.d(t,"b",(function(){return p.b})),n.d(t,"h",(function(){return p.h}))},2267:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));let r=e=>`extCompose_${e}`,o=e=>`extRead_${e}`,i=e=>0===e.indexOf("extCompose")?"Compose":0===e.indexOf("extRead")?"Read":""},227:function(e,t,n){"use strict";t.decode=t.parse=n(380),t.encode=t.stringify=n(381)},2272:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Text=0]="Text",e[e.Html=3]="Html"}(r||(r={}))},2273:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return i}));const r=20,o=10,i=100},2274:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1979);function o(e,t){let n="";if("string"==typeof e)n=e;else{const t=Object(r.a)(e);n=t?t.tabId:e===window?"Main":null}const o={hostItemIndex:t,tabId:n};return JSON.stringify(o)}},2280:function(e,t,n){"use strict";var r=n(3);const o=Object(r.action)("launchCalendarFullCompose",e=>({config:e})),i=Object(r.action)("launchCalendarFullComposeToDuplicate",(e,t)=>({itemId:e,entrySource:t})),a=Object(r.action)("launchCalendarReadingPane",(e,t)=>({config:e,targetWindow:t}));n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}))},2285:function(e,t,n){"use strict";n.d(t,"w",(function(){return p})),n.d(t,"x",(function(){return m})),n.d(t,"r",(function(){return h})),n.d(t,"p",(function(){return g})),n.d(t,"j",(function(){return v})),n.d(t,"t",(function(){return y})),n.d(t,"o",(function(){return b})),n.d(t,"e",(function(){return O})),n.d(t,"g",(function(){return S})),n.d(t,"z",(function(){return C})),n.d(t,"F",(function(){return A})),n.d(t,"G",(function(){return _})),n.d(t,"E",(function(){return I})),n.d(t,"m",(function(){return x})),n.d(t,"k",(function(){return E})),n.d(t,"n",(function(){return T})),n.d(t,"u",(function(){return w})),n.d(t,"s",(function(){return M})),n.d(t,"l",(function(){return k})),n.d(t,"J",(function(){return j})),n.d(t,"a",(function(){return P})),n.d(t,"b",(function(){return R})),n.d(t,"c",(function(){return N})),n.d(t,"d",(function(){return D})),n.d(t,"H",(function(){return F})),n.d(t,"B",(function(){return B})),n.d(t,"y",(function(){return H})),n.d(t,"A",(function(){return V})),n.d(t,"f",(function(){return z})),n.d(t,"h",(function(){return W})),n.d(t,"D",(function(){return G})),n.d(t,"i",(function(){return q})),n.d(t,"q",(function(){return K})),n.d(t,"v",(function(){return X})),n.d(t,"I",(function(){return Q})),n.d(t,"C",(function(){return J}));var r=n(4304),o=n(5366),i="on",a="attachEvent",s="addEventListener",c="detachEvent",u="removeEventListener",l=r.d,d=r.b.freeze;r.b.seal;function f(e){return r.f.toString.call(e)}function p(e,t){return typeof e===t}function m(e){return void 0===e||typeof e===r.l}function h(e){return null===e||m(e)}function g(e){return!h(e)}function v(e,t){return e&&r.e.call(e,t)}function y(e){return typeof e===r.j}function b(e){return typeof e===r.h}function O(e,t,n,r){void 0===r&&(r=!1);var o=!1;if(!h(e))try{h(e[s])?h(e[a])||(e[a](i+t,n),o=!0):(e[s](t,n,r),o=!0)}catch(e){}return o}function S(e,t,n,r){if(void 0===r&&(r=!1),!h(e))try{h(e[u])?h(e[c])||e[c](i+t,n):e[u](t,n,r)}catch(e){}}function C(e,t){if(e)for(var n in e)r.e.call(e,n)&&t.call(e,n,e[n])}function A(e,t){if(e&&t){var n=t.length,r=e.length;if(e===t)return!0;if(r>=n){for(var o=r-1,i=n-1;i>=0;i--){if(e[o]!=t[i])return!1;o--}return!0}}return!1}function _(e,t){var n=!1;if(e&&t){var r=t.length;if(e===t)return!0;if(e.length>=r){for(var o=0;o<r;o++)if(e[o]!==t[o])return!1;n=!0}}return n}function I(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function x(e){return"[object Date]"===f(e)}function E(e){return"[object Array]"===f(e)}function T(e){return"[object Error]"===f(e)}function w(e){return"string"==typeof e}function M(e){return"number"==typeof e}function k(e){return"boolean"==typeof e}function j(e){if(x(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function P(e,t,n){var r=e.length;try{for(var o=0;o<r&&!(o in e&&-1===t.call(n||e,e[o],o,e));o++);}catch(e){}}function R(e,t,n){var r=e.length,o=n||0;try{for(var i=Math.max(o>=0?o:r-Math.abs(o),0);i<r;i++)if(i in e&&e[i]===t)return i}catch(e){}return-1}function N(e,t,n){var r=e.length,o=n||e,i=new Array(r);try{for(var a=0;a<r;a++)a in e&&(i[a]=t.call(o,e[a],e))}catch(e){}return i}function D(e,t,n){var r,o=e.length,i=0;if(arguments.length>=3)r=arguments[2];else{for(;i<o&&!(i in e);)i++;r=e[i++]}for(;i<o;)i in e&&(r=t(r,e[i],i,e)),i++;return r}function F(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var L=!{toString:null}.propertyIsEnumerable("toString"),U=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function B(e){var t=typeof e;t===r.h||t===r.j&&null!==e||Object(o.c)("objKeys called on non-object");var n=[];for(var i in e)e&&r.e.call(e,i)&&n.push(i);if(L)for(var a=U.length,s=0;s<a;s++)e&&r.e.call(e,U[s])&&n.push(U[s]);return n}function H(e,t,n,r){if(l)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),r&&(o.set=r),l(e,t,o),!0}catch(e){}return!1}function V(e){return d&&(e=d(e)),e}function z(){var e=Date;return e.now?e.now():(new e).getTime()}function W(e){return T(e)?e.name:""}function G(e,t,n,r,o){var i=n;return e&&((i=e[t])===n||o&&!o(i)||r&&!r(n)||(i=n,e[t]=i)),i}function q(e,t,n){var r;return e?!(r=e[t])&&h(r)&&(r=m(n)?{}:n,e[t]=r):r=m(n)?{}:n,r}function K(e){return!e}function X(e){return!!e}function Q(e){throw new Error(e)}function J(e){return e&&(e=Object(r.b)(r.a?Object(r.a)({},e):e)),e}},2287:function(e,t,n){"use strict";var r=n(16),o=n(3);let i={folderTable:new r.ObservableMap,rootFolder:null},a=Object(o.createStore)("publicFolderFavoriteStore",i)();t.a=a},2291:function(e,t,n){"use strict";var r=n(35);function o(e){return Object.assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}function i(e){const t=o({ProviderType:e});return void 0===(n=t)||n.__type||(n=o(n)),Object(r.a)("GetNewAttachmentDataProviderCreationInfo",n,i);var n,i}function a(e){return Object.assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}function s(e){const t=a({ProviderType:e});return void 0===(n=t)||n.__type||(n=a(n)),Object(r.a)("GetAttachmentDataProviderCreator",n,o);var n,o}var c=n(2834),u=n(2715);n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b}));const l="code",d=3e3,f=3;function p(e){return{state:e}}function m(e){return e.state}function h(e){return e.code}function g(e,t,n,r,o){const a={providerType:e,getAuthUrlInfo:null,getCSRFToken:m,getOAuthCode:h};return async function e(t,n,r,o,a,u,l){try{let e;if(7===t||9===t||8===t){const n=await s(t);e=n.AttachmentDataProviderCreator.ProviderAppKey,r=n.AttachmentDataProviderCreator.AuthorizationUri}else{e=(await i(t)).ProviderAppKey}n.getAuthUrlInfo=Object(c.d)(t,r,o,e,a,u)}catch(i){l>0&&setTimeout(()=>e(t,n,r,o,a,u,--l),d)}}(e,a,t,n,r,o,f),a}let v=null;function y(){if(!v){if(v={},Object(u.a)(3)&&(v[3]=g(3,"https://app.box.com/api/oauth2/authorize",Object(c.c)(3),l,p)),Object(u.a)(2)&&(v[2]=g(2,"https://www.dropbox.com/oauth2/authorize",Object(c.b)(2),l,p)),Object(u.a)(5)){const e=g(5,"https://accounts.google.com/o/oauth2/auth",`${c.a}/ADPRedirect.aspx`,l,e=>{const t={state:e,provider:5..toString(),url:Object(c.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});e.getCSRFToken=e=>{return JSON.parse(e.state).state},v[5]=e}Object(u.a)(1)&&(v[1]=g(1,"https://login.live.com/oauth20_authorize.srf",Object(c.c)(1),l,e=>({state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}))),Object(u.a)(7)&&(v[7]=g(7,"",Object(c.c)(7),l,p)),Object(u.a)(8)&&(v[8]=g(8,"",Object(c.c)(8),l,p)),Object(u.a)(9)&&(v[9]=g(9,"",Object(c.c)(9),l,p))}return v}function b(e){const t=y();return e in t?t[e]:null}},2300:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(71);let o={};const i="DebugEditor108089";function a(e,t,n){var a;const c=null===(a=o[e.editorId])||void 0===a?void 0:a.htmlEditor;if(t&&c){const n=c.getDocument().defaultView,o=t.getDocument().defaultView,a=n==o,u=window!=n,l=window!=o,d=s(()=>o.opener?"true":"false"),f=s(()=>o.parent==o?"false":"true"),p=s(()=>o.location.href.replace(/\/[^\/]*@[^\/]+\//,"/<PII>/"));Object(r.o)(i,{eventName:"DuplicatedEditor",inSameWindow:a,OriginalInProjection:u,NewInProjection:l,NewWindowHasOpener:d,NewWindowIsIFrame:f,NewWindowUrl:p,editorId:e.editorId})}o[e.editorId]={htmlEditor:t,plainTextEditor:n}}function s(e){try{return e()}catch(e){return"error"}}function c(e,t,n){const a=o[e.editorId];let s=!1;a&&(a.htmlEditor==t&&(a.htmlEditor=null,s=!0),a.plainTextEditor==n&&(a.plainTextEditor=null,s=!0),a.htmlEditor||a.plainTextEditor||delete o[e.editorId]),!s&&t&&Object(r.o)(i,{eventName:"NoEditorToRemove",hasOperator:!!a,hasOriginalEditor:!!(null==a?void 0:a.htmlEditor),removingEditorId:e.editorId})}function u(e,t,n,a,s){var c;if(e){const u=e.bodyType,l=void 0===u||"HTML"===u,d="Text"===u,{htmlEditor:f,plainTextEditor:p}=s||o[e.editorId]||{};if(l&&t&&(f&&!f.isDisposed()||a)){t(f);const n=null===(c=o[e.editorId])||void 0===c?void 0:c.htmlEditor;f&&n&&f!=n&&Object(r.o)(i,{eventName:"OperateWrongEditor",editorId:e.editorId})}else d&&n&&(p||a)&&n(p)}}},231:function(e,t,n){"use strict";var r=n(290),o=n(14);function i(e){return Object(r.resolve)(Object(o.g)(),e)}function a(e){return i("resources/images/"+e)}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}))},2313:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(1734),o=n(1979);function i(e,t,n){var i;const{taskPanes:a}=Object(r.a)(),s=Object(o.a)(n);let c=s?s.tabId:n===window?"Main":null;return null===(i=null==a?void 0:a.get(c))||void 0===i?void 0:i.get(e)}function a(e){const{taskPanes:t}=Object(r.a)();if(!t)return null;for(let n of t.values())for(let t of n.values())if(t&&t.controlId===e)return t;return null}function s(e){const{taskPanes:t}=Object(r.a)();if(!t)return null;for(let n of t.values())for(let[t,r]of n)if(r&&r.controlId===e)return t;return null}function c(e){return"Persistent"===e?"NonPersistent":"Persistent"}},2314:function(e,t,n){"use strict";var r;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),function(e){e[e.Groups=1e4]="Groups"}(r||(r={}));const o=Object.freeze([1,3,2,6,5,7,8,9]),i=Object.freeze([...o,0,4,10])},2315:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1961);function o(){return Object(r.a)().loadState}},2316:function(e,t,n){"use strict";n.d(t,"b",(function(){return a}));var r=n(16),o=n(3);const i={sharingLinks:new r.ObservableMap({}),linksIdContainerMap:new r.ObservableMap({})},a=Object(o.createStore)("sharingLinkStore",i);t.a=a},2322:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="IPM.Note.SMIME"},2328:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(2874),o=n(2795),i=n(2852),a=n(6),s=n(282);function c(e,t=!1){if(t)return"";switch(e){case 0:return Object(a.b)(i.b);case 1:return Object(a.b)(i.a);case 2:case 9:return Object(a.b)(r.b);case 3:case 7:return Object(a.b)(r.a);case 5:return Object(a.b)(r.e);case 6:return Object(a.b)(r.d);case 4:return Object(a.b)(r.f);case 10:return Object(a.b)(o.b);case 8:return Object(a.b)(r.c);default:return Object(s.a)(e)}}},2332:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="0x6698"},2368:function(e,t,n){"use strict";var r;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(r||(r={})),t.a=r},2371:function(e,t,n){"use strict";var r=n(954),o=n(905);var i=n(955),a=n(261),s=n(36),c=n(1869);function u(e,t,n,u,l,d,f){const p=Object(a.b)();var m;return u&&(p.RequestServerVersion=u),d&&(p.ManagementRole=(m={UserRoles:["MailboxSearch"]},Object.assign({__type:"ManagementRoleType:#Exchange"},m))),Object(i.a)({Header:p,Body:Object(r.a)({ItemShape:t,ItemIds:Array.isArray(e)?e.map(e=>Object(o.a)({Id:e})):e?[Object(o.a)({Id:e})]:[],ShapeName:null!=n?n:void 0,InternetMessageId:f})},l).then(e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseMessages)||void 0===n?void 0:n.Items}).then(e=>Object(c.a)(e).then(()=>e)).then(t=>{if(!(null==t?void 0:t.length))return null;let n=[];return t.forEach(e=>{n=n.concat(e.Items)}),n.length?Array.isArray(e)||void 0!==f?n:n[0]:null}).catch(e=>(s.h.warn("GetItem:"+e.message),e))}n.d(t,"a",(function(){return u}))},2374:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("openInClientStore")},2377:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_ATTACHMENT_CREATED",(e,t,n,r=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:r}))},2378:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_ATTACHMENT_DELETED",(e,t,n,r=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:r}))},2386:function(e,t,n){"use strict";var r;!function(e){e.EwsId="ews",e.EwsImmutableId="ewsimmutable"}(r||(r={}));var o=n(47),i=n(3),a=Object(i.createStore)("immutableId",{IsImmutableIdFeatureOnForConnectedAccount:!1});var s=n(287);function c(e){return Object(s.r)(e)?a().IsImmutableIdFeatureOnForConnectedAccount?r.EwsImmutableId:r.EwsId:Object(o.j)("fwk-immutable-ids")?r.EwsImmutableId:r.EwsId}function u(e){return!!e&&e.length<90}function l(e){const t=[],n=[],r=[];return null==e||e.forEach((e,o)=>{"string"==typeof e&&(e.indexOf("@")>-1?r.push({id:e,idx:o}):u(e)?t.push({id:e,idx:o}):n.push({id:e,idx:o}))}),[t,n,r]}function d(e,t){const[n,o]=l(e),i=c(t);return i===r.EwsImmutableId&&o.length>0||i===r.EwsId&&n.length>0}const f=Object(i.mutatorAction)("setIsImmutableIdFeatureOnForConnectedAccount",e=>{a().IsImmutableIdFeatureOnForConnectedAccount=e});n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return f})),n.d(t,"a",(function(){return r}))},2404:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"SetItemField:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2405:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemChange:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2412:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(538),s=n(740),c=n(50),u=n(1561),l=n(807),d=n(2099),f=n(1725),p=n(453),m=n(63),h=Object(a.a)(),g={size:f.c.size48,presence:f.b.none,imageAlt:"",showOverflowTooltip:!0};var v=i.forwardRef((function(e,t){var n=Object(s.a)(g,e),r=i.useRef(null),a=Object(p.a)(t,r),v=function(){return n.text||n.primaryText||""},y=function(e,t,r){return i.createElement("div",{dir:"auto",className:e},t&&t(n,r))},b=function(e,t){return void 0===t&&(t=!0),e?t?function(){return i.createElement(u.a,{content:e,overflowMode:l.a.Parent,directionalHint:m.a.topLeftEdge},e)}:function(){return i.createElement(i.Fragment,null,e)}:void 0},O=b(v(),n.showOverflowTooltip),S=b(n.secondaryText,n.showOverflowTooltip),C=b(n.tertiaryText,n.showOverflowTooltip),A=b(n.optionalText,n.showOverflowTooltip),_=n.hidePersonaDetails,I=n.onRenderOptionalText,x=void 0===I?A:I,E=n.onRenderPrimaryText,T=void 0===E?O:E,w=n.onRenderSecondaryText,M=void 0===w?S:w,k=n.onRenderTertiaryText,j=void 0===k?C:k,P=n.onRenderPersonaCoin,R=void 0===P?function(e){return i.createElement(d.a,Object(o.__assign)({},e))}:P,N=n.size,D=n.allowPhoneInitials,F=n.className,L=n.coinProps,U=n.showUnknownPersonaCoin,B=n.coinSize,H=n.styles,V=n.imageAlt,z=n.imageInitials,W=n.imageShouldFadeIn,G=n.imageShouldStartVisible,q=n.imageUrl,K=n.initialsColor,X=n.initialsTextColor,Q=n.isOutOfOffice,J=n.onPhotoLoadingStateChange,Y=n.onRenderCoin,Z=n.onRenderInitials,$=n.presence,ee=n.presenceTitle,te=n.presenceColors,ne=n.showInitialsUntilImageLoads,re=n.showSecondaryText,oe=n.theme,ie=Object(o.__assign)({allowPhoneInitials:D,showUnknownPersonaCoin:U,coinSize:B,imageAlt:V,imageInitials:z,imageShouldFadeIn:W,imageShouldStartVisible:G,imageUrl:q,initialsColor:K,initialsTextColor:X,onPhotoLoadingStateChange:J,onRenderCoin:Y,onRenderInitials:Z,presence:$,presenceTitle:ee,showInitialsUntilImageLoads:ne,size:N,text:v(),isOutOfOffice:Q,presenceColors:te},L),ae=h(H,{theme:oe,className:F,showSecondaryText:re,presence:$,size:N}),se=Object(c.j)(n,c.h),ce=i.createElement("div",{className:ae.details},y(ae.primaryText,T,O),y(ae.secondaryText,M,S),y(ae.tertiaryText,j,C),y(ae.optionalText,x,A),n.children);return i.createElement("div",Object(o.__assign)({},se,{ref:a,className:ae.root,style:B?{height:B,minWidth:B}:void 0}),R(ie,R),(!_||N===f.c.size8||N===f.c.size10||N===f.c.tiny)&&ce)}));v.displayName="PersonaBase";var y=n(8),b=n(1756),O={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"};n.d(t,"a",(function(){return S}));var S=Object(r.a)(v,(function(e){var t=e.className,n=e.showSecondaryText,r=e.theme,o=r.semanticColors,i=r.fonts,a=Object(y.getGlobalClassNames)(O,r),s=Object(b.d)(e.size),c=Object(b.c)(e.presence),u={color:o.bodySubtext,fontWeight:y.FontWeights.regular,fontSize:i.small.fontSize};return{root:[a.root,r.fonts.medium,y.normalize,{color:o.bodyText,position:"relative",height:b.b.size48,minWidth:b.b.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},s.isSize8&&[a.size8,{height:b.b.size8,minWidth:b.b.size8}],s.isSize10&&[a.size10,{height:b.b.size10,minWidth:b.b.size10}],s.isSize16&&[a.size16,{height:b.b.size16,minWidth:b.b.size16}],s.isSize24&&[a.size24,{height:b.b.size24,minWidth:b.b.size24}],s.isSize24&&n&&{height:"36px"},s.isSize28&&[a.size28,{height:b.b.size28,minWidth:b.b.size28}],s.isSize28&&n&&{height:"32px"},s.isSize32&&[a.size32,{height:b.b.size32,minWidth:b.b.size32}],s.isSize40&&[a.size40,{height:b.b.size40,minWidth:b.b.size40}],s.isSize48&&a.size48,s.isSize56&&[a.size56,{height:b.b.size56,minWidth:b.b.size56}],s.isSize72&&[a.size72,{height:b.b.size72,minWidth:b.b.size72}],s.isSize100&&[a.size100,{height:b.b.size100,minWidth:b.b.size100}],s.isSize120&&[a.size120,{height:b.b.size120,minWidth:b.b.size120}],c.isAvailable&&a.available,c.isAway&&a.away,c.isBlocked&&a.blocked,c.isBusy&&a.busy,c.isDoNotDisturb&&a.doNotDisturb,c.isOffline&&a.offline,t],details:[a.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(s.isSize8||s.isSize10)&&{paddingLeft:17},(s.isSize24||s.isSize28||s.isSize32)&&{padding:"0 8px"},(s.isSize40||s.isSize48)&&{padding:"0 12px"}],primaryText:[a.primaryText,y.noWrap,{color:o.bodyText,fontWeight:y.FontWeights.regular,fontSize:i.medium.fontSize,selectors:{":hover":{color:o.inputTextHovered}}},n&&{height:"16px",lineHeight:"16px",overflowX:"hidden"},(s.isSize8||s.isSize10)&&{fontSize:i.small.fontSize,lineHeight:b.b.size8},s.isSize16&&{lineHeight:b.b.size28},(s.isSize24||s.isSize28||s.isSize32||s.isSize40||s.isSize48)&&n&&{height:18},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&{fontSize:i.xLarge.fontSize},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&n&&{height:22}],secondaryText:[a.secondaryText,y.noWrap,u,(s.isSize8||s.isSize10||s.isSize16||s.isSize24||s.isSize28||s.isSize32)&&{display:"none"},n&&{display:"block",height:"16px",lineHeight:"16px",overflowX:"hidden"},s.isSize24&&n&&{height:18},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&{fontSize:i.medium.fontSize},(s.isSize56||s.isSize72||s.isSize100||s.isSize120)&&n&&{height:18}],tertiaryText:[a.tertiaryText,y.noWrap,u,{display:"none",fontSize:i.medium.fontSize},(s.isSize72||s.isSize100||s.isSize120)&&{display:"block"}],optionalText:[a.optionalText,y.noWrap,u,{display:"none",fontSize:i.medium.fontSize},(s.isSize100||s.isSize120)&&{display:"block"}],textContent:[a.textContent,y.noWrap]}}),void 0,{scope:"Persona"})},2433:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1688);function o(e,t){return Object(r.a)().has(e.id)?Object(r.a)().get(e.id):Object.assign({childFolderIds:[],principalSMTPAddress:t},e)}},2434:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(15),o=n(1874),i=n(1818);function a(e,t){var n,a,s,c;let u=null==e?void 0:e.folderHierarchy,l="s";if(!u){const d=null===(c=null===(s=null===(a=null===(n=null==e?void 0:e.findFolders)||void 0===n?void 0:n.Body)||void 0===a?void 0:a.ResponseMessages)||void 0===s?void 0:s.Items)||void 0===c?void 0:c[0];if(d)if("Error"==d.ResponseClass)l="e",Object(r.b)("ffr_c",d.ResponseCode||"un");else try{u=Object(o.b)(d,t,Object(i.b)("junkemail"),Object(i.b)("notes"))}catch(e){l="m",Object(r.b)("ffr_c",e.message)}else l="nrm"}return Object(r.b)("ffr",l),u}},2446:function(e,t,n){"use strict";var r=n(1923),o=n(3),i=n(1688);const a=Object(o.mutatorAction)("updateFolder",(e,t,n,r)=>{t&&(e.displayName=t),r.forEach(e=>{const t=n[e],r=n[t.parentFolderId]||Object(i.a)().get(t.parentFolderId);r&&-1==r.childFolderIds.indexOf(e)&&r.childFolderIds.push(e)})});var s=n(1818);function c(e,t,n,o){const i={},c=i[t.id]=o(t),u=[];for(let e=0;e<n.length;e++){const t=n[e],r=t.id,a=t.distinguishedFolderType;Object(s.b)(a)&&(i[r]=o(t),u.push(r))}a(c,e,i,u),Object(r.a)(i)}n.d(t,"a",(function(){return c}))},2452:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p}));const r=5;let o={},i={};function a(e,t,n,r){g([e,"data",t])||function(e,t){o[e]=o[e]||{data:{},messageIds:[]},o[e].data[t]={}}(e,t),u(n)&&m(n),function(e,t,n,r){o[e].data[t][n]=r,o[e].messageIds.push(n),i[n]={hostItemIndex:e,extensionId:t}}(e,t,n,r)}function s(e){c(e)&&m(e)}function c(e){if(!u(e))return null;const{hostItemIndex:t,extensionId:n}=i[e];return g([t,"data",n,e])}function u(e){return!!i[e]}function l(e,t,n){const o=h(e,t)||[],i=Object.keys(o).length||0;return n?i>=1:i>=r}function d(e,t){const n=h(e,t);return n?Object.keys(n).reduce((e,t)=>{const r=n[t];return r.Persistent&&(e[t]=r),e},{}):{}}function f(e){return o[e]?o[e].messageIds:[]}function p(e){if(!o[e])return;o[e].messageIds.forEach(e=>delete i[e]),delete o[e]}function m(e){const{hostItemIndex:t,extensionId:n}=i[e];delete h(t,n)[e],delete i[e];const r=o[t].messageIds,a=r.indexOf(e);~a&&r.splice(a,1)}function h(e,t){return g([e,"data",t])}function g(e){let t=o;for(let n=0;n<e.length;n++){const r=e[n];if(!t[r])return null;t=t[r]}return t}},2460:function(e,t,n){"use strict";var r=n(3),o=n(3015),i=n(35);async function a(){let e=await Object(i.a)("GetMailboxCalendarConfiguration",{},t);var t;return e.ErrorCode?null:e.Options}async function s(){o.a.calendarConfiguration||c(await a())}const c=Object(r.mutatorAction)("setCalendarConfiguration",e=>{o.a.calendarConfiguration=e});var u=n(4354),l=n(6062),d=n(47),f=n(3044),p=n(36);let m;async function h(e,t){Object(d.j)(u.c)&&!m&&(m=async function(e,t){try{const n=await Object(l.a)(e,t),r=n.status;g(200===r?await n.json():null,r),200!==r&&Object(f.c)(u.d.TXPSettingsResponseError,[r,n.statusText])}catch(e){p.h.warn("[TXP]"+e.message),Object(f.c)(u.d.TXPSettingsResponseError,e.message)}}(e,t)),await m,m=void 0}const g=Object(r.mutatorAction)("setTxpSettings",(e,t)=>{o.a.txpSettings=e,o.a.statusCode=t});function v(){o.a.txpSettings||h()}var y=n(4439);const b=Object(r.action)("updateTxpSettingFlag",(e,t,n)=>({flagName:e,enabled:t,value:n}));Object(r.mutator)(b,e=>{const t=Object(y.a)(),{flagName:n}=e;"CreateEventsFromEmailAsPrivate"==n||"ShowAsTrips"==n?t[n]=e.enabled:n&&t&&t.EntityTypeSettings&&t.EntityTypeSettings[n]&&(t.EntityTypeSettings[n].ProcessingLevel=e.value)});var O=n(1);function S(e){return Object.assign({__type:"SetMailboxCalendarConfigurationRequest:#Exchange"},e)}function C(e,t){return void 0===e||e.__type||(e=S(e)),Object(i.a)("SetMailboxCalendarConfiguration",e,t)}var A=n(261),_=n(38);function I(e){var t;if(null===(t=Object(_.a)().PolicySettings)||void 0===t?void 0:t.LocalEventsEnabled)return C(S({Header:Object(A.b)(),Options:e}));{const{LocalEventsEnabled:t,LocalEventsLocation:n}=e,r=Object(O.__rest)(e,["LocalEventsEnabled","LocalEventsLocation"]);return C(S({Header:Object(A.b)(),Options:r}))}}var x=n(702),E=n(307),T=n.n(E),w=Object(x.action)("storeCalendarMailboxConfiguration")((function(e){T()(o.a.calendarConfiguration,e)}));async function M(e){return w(e),await I(e)}function k(){return o.a.calendarConfiguration}var j=()=>{var e,t;return null===(t=null===(e=o.a.calendarConfiguration)||void 0===e?void 0:e.WorkingHoursTimeZone)||void 0===t?void 0:t.TimeZoneId},P=Object(r.mutatorAction)("updateCalendarMailboxConfiguration",(function(e){T()(k(),e)})),R=n(4937);n.d(t,"g",(function(){return M})),n.d(t,"c",(function(){return k})),n.d(t,"b",(function(){return j})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"i",(function(){return P})),n.d(t,"h",(function(){return I})),n.d(t,"a",(function(){return R.a})),n.d(t,"j",(function(){return b})),s(),v()},247:function(e,t,n){"use strict";var r=n(711),o="object"==typeof self&&self&&self.Object===Object&&self,i=r.a||o||Function("return this")();t.a=i},2483:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(646);let o=(e,t)=>e||t;function i(e){return[...(e||Object(r.a)()).isShown.values()].reduce(o,!1)}},2499:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(38);function o(){const e=Object(r.a)().PolicySettings;return e?{OutboundCharset:e.OutboundCharset,UseGB18030:e.UseGB18030,UseISO885915:e.UseISO885915}:{OutboundCharset:"AutoDetect"}}},25:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return u}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}function s(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function c(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function u(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}},250:function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"j",(function(){return u})),n.d(t,"i",(function(){return l})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return v}));var r=n(1070),o=n.n(r),i=n(68),a=n(586);function s(e){return{__ref:String(e)}}function c(e){return Boolean(e&&"object"==typeof e&&"string"==typeof e.__ref)}function u(e,t,n,r){if(function(e){return"IntValue"===e.kind}(n)||function(e){return"FloatValue"===e.kind}(n))e[t.value]=Number(n.value);else if(function(e){return"BooleanValue"===e.kind}(n)||function(e){return"StringValue"===e.kind}(n))e[t.value]=n.value;else if(function(e){return"ObjectValue"===e.kind}(n)){var o={};n.fields.map((function(e){return u(o,e.name,e.value,r)})),e[t.value]=o}else if(function(e){return"Variable"===e.kind}(n)){var a=(r||{})[n.name.value];e[t.value]=a}else if(function(e){return"ListValue"===e.kind}(n))e[t.value]=n.values.map((function(e){var n={};return u(n,t,e,r),n[t.value]}));else if(function(e){return"EnumValue"===e.kind}(n))e[t.value]=n.value;else{if(!function(e){return"NullValue"===e.kind}(n))throw new i.a(53);e[t.value]=null}}function l(e,t){var n=null;e.directives&&(n={},e.directives.forEach((function(e){n[e.name.value]={},e.arguments&&e.arguments.forEach((function(r){var o=r.name,i=r.value;return u(n[e.name.value],o,i,t)}))})));var r=null;return e.arguments&&e.arguments.length&&(r={},e.arguments.forEach((function(e){var n=e.name,o=e.value;return u(r,n,o,t)}))),f(e.name.value,r,n)}var d=["connection","include","skip","client","rest","export"];function f(e,t,n){if(t&&n&&n.connection&&n.connection.key){if(n.connection.filter&&n.connection.filter.length>0){var r=n.connection.filter?n.connection.filter:[];r.sort();var i={};return r.forEach((function(e){i[e]=t[e]})),n.connection.key+"("+JSON.stringify(i)+")"}return n.connection.key}var a=e;if(t){var s=o()(t);a+="("+s+")"}return n&&Object.keys(n).forEach((function(e){-1===d.indexOf(e)&&(n[e]&&Object.keys(n[e]).length?a+="@"+e+"("+JSON.stringify(n[e])+")":a+="@"+e)})),a}function p(e,t){if(e.arguments&&e.arguments.length){var n={};return e.arguments.forEach((function(e){var r=e.name,o=e.value;return u(n,r,o,t)})),n}return null}function m(e){return e.alias?e.alias.value:e.name.value}function h(e,t,n){if("string"==typeof e.__typename)return e.__typename;for(var r=0,o=t.selections;r<o.length;r++){var i=o[r];if(g(i)){if("__typename"===i.name.value)return e[m(i)]}else{var s=h(e,Object(a.b)(i,n).selectionSet,n);if("string"==typeof s)return s}}}function g(e){return"Field"===e.kind}function v(e){return"InlineFragment"===e.kind}},2501:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2300),o=n(2929);function i(e,t){Object(r.b)(e,t=>{Object(o.a)(e,t.getContent())},t=>{Object(o.a)(e,t.value)},!1,t)}},2519:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(3),o=n(4114);const i=Object(r.createStore)("protection",Object(o.a)()),a=i()},252:function(e,t,n){"use strict";t.a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},2549:function(e,t,n){"use strict";var r;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(r||(r={})),t.a=r},2555:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(296),o=n(47),i=n(1678),a=n(1679);function s(e){if(function(e){return null!=e.RightsManagementLicenseData}(e)&&!function(e){var t;return Object(o.j)("addin-enableAddinsForIRM")&&!Object(r.a)()&&(null===(t=e.RightsManagementLicenseData)||void 0===t?void 0:t.ProgrammaticAccessAllowed)}(e))return!1;if(e.IsDraft)return!1;const t=e.ItemClass?e.ItemClass.toLowerCase():"";if(0==t.indexOf("ipm.note.smime")&&-1==t.indexOf("ipm.note.smime.multipartsigned"))return!1;if(0==t.indexOf("report"))return!1;if(Object(o.j)("addin-disableAddinsForInPlaceArchiveFolder")){if(e.ParentFolderId.Id===Object(i.a)(a.d))return!1}return!0}},2556:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1841),o=n(1797);function i(e){switch(e){case o.a.MessageRead:return r.a.mailReadSurfaceNewAddinId;case o.a.MessageCompose:return r.a.mailComposeSurfaceNewAddinId;case o.a.AppointmentOrganizer:case o.a.AppointmentAttendee:return r.a.calendarSurfaceNewAddinId;default:return""}}},2557:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1841);function o(e){const t=r.a.Context;for(let n of t.Extensions)if(n.Id.toLowerCase()===e.toLowerCase())return n;return null}},2558:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1734);function o(){var e;return null===(e=Object(r.a)())||void 0===e?void 0:e.uiLessAddinRunningForEMO}},2568:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("TRY_REMOVE_FROM_MAIL_STORE_ITEMS",(e,t)=>({itemIdToRemove:e,removeItemSource:t}))},2571:function(e,t,n){"use strict";t.a=class{constructor(e){this.errorCode=e}}},2578:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2013);function o(e,t){var n;return t?e:null===(n=Object(r.b)(e))||void 0===n?void 0:n.ItemId.Id}},2579:function(e){e.exports=JSON.parse('{"a":"P6b"}')},2580:function(e){e.exports=JSON.parse('{"a":"R6b"}')},2584:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(1734),o=n(2061),i=n(2313);function a(e){const t=function(e){const t=Object(i.c)(e);return t?t.targetWindow:null}(e);return t||function(e){const t=Object(o.a)(e);let n=window;const r=c();return t&&r?(r.forEach((r,o)=>{o===t&&r.forEach((t,r)=>{e==r&&(n=t.targetWindow)})}),n):n}(e)}function s(e){let t=window;const n=c();return n?(n.forEach((n,r)=>{JSON.parse(r).hostItemIndex===e&&n.forEach((e,n)=>{t=e.targetWindow})}),t):t}function c(){return Object(r.a)().runningUILessExtendedAddinCommands}},2585:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var r,o=n(6),i=n(1732),a=n(1738);!function(e){e[e.File=0]="File",e[e.Item=1]="Item",e[e.Cloud=2]="Cloud"}(r||(r={}));const s=e=>e.map(e=>({id:c(e),name:e.Name,contentType:e.ContentType,size:e.Size,attachmentType:u(e),isInline:e.IsInline||!1}));function c(e){var t;return Object(a.a)(e)?e.AttachLongPathName:null===(t=e.AttachmentId)||void 0===t?void 0:t.Id}function u(e){switch(e.__type||e.OwsTypeName){case i.a:return r.File;case i.b:return r.Item;case i.e:return r.Cloud;case i.c:const t=e;return Object(o.k)(t.AttachmentIdToAttach)?r.Item:r.File;default:throw new Error(`Invalid type of attachment ${e.__type}`)}}},2589:function(e,t,n){"use strict";var r=n(20),o=n(2700),i=n(1692),a=n(702),s=Object(a.action)("setIsPendingDeleteConversationItemParts")((function(e,t,n={conversationItemParts:i.u.conversations.get(e)}){const r=n.conversationItemParts;r&&(r.isPendingDelete=t)})),c=n(2273);n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return o.a})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return c.b})),n.d(t,"b",(function(){return c.c}));const u=new r.c(()=>Promise.all([n.e(8),n.e(10),n.e(13),n.e(33),n.e(194)]).then(n.bind(null,19519))),l=new r.a(u,e=>e.loadAllRecipientsForItem),d=new r.a(u,e=>e.loadItem),f=new r.a(u,e=>e.loadConversation)},2594:function(e){e.exports=JSON.parse('{"a":"Q6b"}')},262:function(e,t,n){"use strict";var r=Array.isArray;t.a=r},2620:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(225);function o(e){return{type:"PublicMailbox",userIdentity:Object(r.d)().userIdentity,mailboxSmtpAddress:e}}},263:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(289),o=n(3);const i={tabs:[{id:"primaryTab",type:r.a.Primary,state:2,blink:!1,sxsId:"primaryTab"}],tabBarWidth:0,isOverflowMenuShown:!1,isTabBarAvailable:!1};let a=Object(o.createStore)("tab",i);a();const s=a().tabs[0]},2630:function(e,t,n){"use strict";var r=n(909),o=n(919),i=n(566),a=Object(o.a)((function(e,t,n,o){Object(r.a)(t,Object(i.a)(t),e,o)}));t.a=a},2633:function(e){e.exports=JSON.parse('{"a":"O6b"}')},2634:function(e){e.exports=JSON.parse('{"a":"N6b"}')},2635:function(e){e.exports=JSON.parse('{"a":"M6b"}')},2636:function(e){e.exports=JSON.parse('{"a":"L6b"}')},2637:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(2035),o=n(2322);function i(e){return e&&0===e.indexOf(r.e)}function a(e){return e&&0===e.indexOf(o.a)&&!i(e)}function s(e){return e&&0===e.indexOf(o.a)}function c(e){return e.match(/^ipm\.(appointment|schedule\.meeting(?!\.notification))/i)}},2648:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Unknown=0]="Unknown",e[e.Single=1]="Single",e[e.Empty=2]="Empty",e[e.Multi=3]="Multi",e[e.NotSupported=4]="NotSupported"}(r||(r={}))},2649:function(e,t,n){"use strict";var r;!function(e){e[e.Added=0]="Added",e[e.Deleted=1]="Deleted"}(r||(r={})),t.a=r},2650:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Room="room",e.Custom="custom"}(r||(r={}))},2651:function(e,t,n){"use strict";var r;!function(e){e[e.To=0]="To",e[e.Cc=1]="Cc",e[e.Bcc=2]="Bcc",e[e.RequiredAttendees=0]="RequiredAttendees",e[e.OptionalAttendees=1]="OptionalAttendees",e[e.Resources=2]="Resources"}(r||(r={})),t.a=r},2654:function(e,t,n){"use strict";var r,o=n(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(r||(r={})),n.d(t,"b",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return r}));const i=new o.d(()=>n.e(872).then(n.bind(null,19655))),a=(e,t)=>{const n=new o.a(e,t);return(...e)=>n.importAndExecute(...e)},s=a(i,e=>e.convertIdsToTargetFormat),c=a(i,e=>e.translateRestImmutableIdsToEwsIds),u=a(i,e=>e.translateEwsIdsToEwsImmutableIds),l=a(i,e=>e.translateEwsIdsToRestImmutableIds);a(i,e=>e.translateEwsImmutableIdsToEwsIds)},2662:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(38),o=n(47);function i(){var e;return(null===(e=Object(r.a)().UserOptions)||void 0===e?void 0:e.SendFromAliasEnabled)&&Object(o.j)("cmp-proxy-address")}},2682:function(e,t,n){"use strict";var r=n(1797);t.a=class{constructor(e,t,n,r){this.event=e,this.control=t,this.extension=n,this.mode=r}getLaunchEventType(){return this.event}getControl(){return this.control}get_EntryPoint(){var e;switch(this.mode){case r.a.LaunchEvent:return null===(e=this.extension)||void 0===e?void 0:e.ExtensionPointCollection.LaunchEvent.SourceLocation;default:return null}}get_IconUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.IconUrl}get_Label(){var e;return null===(e=this.control)||void 0===e?void 0:e.Label}get_Id(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Id}get_OriginString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.OriginString}get_ExtensionId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Id}get_MarketPlaceAssetId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceAssetID}get_TypeString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.TypeString}get_ProviderName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ProviderName}get_ConsentMetaData(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentMetadata}get_MarketPlaceContentMarket(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceContentMarket}get_WebApplicationResource(){var e;return null===(e=this.extension)||void 0===e?void 0:e.WebApplicationResource}get_ExtensionPointCollection(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ExtensionPointCollection}get_ExtensionDisplayName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.DisplayName}get_Size16Icon(){return this.control&&this.control.Icon?this.control.Icon.Size16Url:null}get_ExtendedPermissions(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ExtendedPermissions}get_AppStatus(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppStatus}get_LicenseType(){var e;return null===(e=this.extension)||void 0===e?void 0:e.LicenseType}get_Settings(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Settings}get_Version(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Version}get_AppDomains(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppDomains}get_Type(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Type}get_ConsentState(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentState}get_RequestedCapabilities(){var e;return null===(e=this.extension)||void 0===e?void 0:e.RequestedCapabilities}get_EndNodeUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.EndNodeUrl}set_ConsentState(e){this.extension.ConsentState=e}set_RequestedCapabilities(e){this.extension.RequestedCapabilities=e}set_TypeString(e){this.extension.TypeString=e}set_ExtensionId(e){this.extension.Id=e}set_OriginString(e){this.extension.OriginString=e}set_Settings(e){this.extension.Settings=e}}},2698:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="DeleteRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M6.5 7v4a.5.5 0 001 0V7a.5.5 0 00-1 0z"}),r.createElement("path",{d:"M9 6.5c.28 0 .5.22.5.5v4a.5.5 0 01-1 0V7c0-.28.22-.5.5-.5z"}),r.createElement("path",{d:"M10 4h3a.5.5 0 010 1h-.55l-.76 6.78A2.5 2.5 0 019.21 14H6.79a2.5 2.5 0 01-2.48-2.22L3.55 5H3a.5.5 0 010-1h3a2 2 0 114 0zM8 3a1 1 0 00-1 1h2a1 1 0 00-1-1zM4.56 5l.74 6.67A1.5 1.5 0 006.79 13h2.42c.76 0 1.4-.57 1.5-1.33L11.43 5H4.56z"})),displayName:"DeleteRegular"});Object(o.registerIcons)({icons:{DeleteRegular:r.createElement(a,null)}})},2700:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1692),o=n(2568),i=n(3321),a=n(3);function s(e){if(r.u.conversations.has(e)){const t=r.u.conversations.get(e);for(const e of t.conversationNodeIds){const t=r.u.conversationNodes.get(e);if(t)for(const e of t.itemIds)Object(o.a)(e,1);c(e)}u(e)}Object(i.a)()}const c=Object(a.mutatorAction)("deleteConversationNode",e=>{r.u.conversationNodes.delete(e)}),u=Object(a.mutatorAction)("deleteConversation",e=>{r.u.conversations.delete(e)})},2715:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1774),o=n(296),i=n(282),a=n(47);function s(e){const t=Object(r.a)();switch(e){case 5:return(null==t?void 0:t.GoogleDriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.j)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return(null==t?void 0:t.BoxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.j)("doc-fileProvider-box");case 2:return(null==t?void 0:t.DropboxAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.j)("doc-fileProvider-dropbox");case 6:return!1;case 1:return!!Object(o.a)()||(null==t?void 0:t.OnedriveAttachmentsEnabled)&&(null==t?void 0:t.ThirdPartyAttachmentsEnabled);case 10:return Object(a.j)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return(null==t?void 0:t.ThirdPartyAttachmentsEnabled)&&Object(a.j)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2737:function(e,t,n){"use strict";t.a={sendFeedback:()=>{}}},2738:function(e,t,n){"use strict";function r(e,t,n){const o={hostItemIndex:e,targetWindow:n};if(t.getClickHandler)t.onClick=t.getClickHandler(o);else if(t.sectionProps){t.sectionProps.items.forEach(t=>{r(e,t,n)})}else if(t.subMenuProps){t.subMenuProps.items.forEach(t=>{r(e,t,n)})}}n.d(t,"a",(function(){return r}))},2743:function(e,t,n){"use strict";var r=n(2850),o=n(1734);var i=n(2991),a=n(38);function s(){const e=null!=Object(o.a)().Context,t=Object(r.a)(),n=Object(a.a)().SegmentationSettings.OnSendAddinsEnabled;return e&&t?n&&Object(i.a)(1).length>0:n}n.d(t,"a",(function(){return s}))},2746:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("HIDE_FULL_OPTION",(e,t)=>({showQuickOptions:e,subcategory:t}))},2759:function(e,t,n){"use strict";function r(e){return e&&!!e.setPluginUtils}n.d(t,"a",(function(){return r}))},2764:function(e,t,n){"use strict";var r;!function(e){e[e.Selected=0]="Selected",e[e.Deselected=1]="Deselected"}(r||(r={})),t.a=r},2776:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1732);function o(e){return(e.__type||e.OwsTypeName)===r.b}},2784:function(e,t,n){var r=n(3391);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},2785:function(e,t,n){var r=n(3392);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},2786:function(e,t,n){var r=n(3393);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},2787:function(e,t,n){var r=n(3394);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},2788:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetCalendarEventRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2792:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r={};function o(e,t){var n;const o=e.infoBarHostKey;return null===(n=r[o])||void 0===n?void 0:n[t]}},2793:function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"l",(function(){return a})),n.d(t,"o",(function(){return s})),n.d(t,"q",(function(){return c})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return h})),n.d(t,"r",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"d",(function(){return y})),n.d(t,"j",(function(){return b})),n.d(t,"f",(function(){return O})),n.d(t,"i",(function(){return S})),n.d(t,"a",(function(){return C}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(308)]).then(n.bind(null,4953))),i=new r.a(o,e=>e.onSmimeItemAttachmentOpened),a=new r.a(o,e=>e.mergeSmimeDecodedMessageProperties),s=(new r.b(o,e=>e.fetchAndDecodeSmimeMessage),new r.b(o,e=>e.setSmimePropertiesInDraftMessage)),c=new r.b(o,e=>e.trySetSmimeProperties),u=new r.b(o,e=>e.tryAddSmimeProperties),l=new r.b(o,e=>e.createMailResponseBodyContent),d=new r.b(o,e=>e.downloadSmimeAttachment),f=new r.b(o,e=>e.getMergedSmimeViewState),p=new r.b(o,e=>e.getMergedSmimeViewStateForDraft),m=new r.b(o,e=>e.isSmimeItemDecoding),h=new r.b(o,e=>e.previewSmimeAttachment),g=new r.b(o,e=>e.updateSmimeAttachmentIds),v=new r.b(o,e=>e.createSmimeAttachmentsFromFiles),y=new r.b(o,e=>e.createSmimeAttachmentsViaSmimeQueueManager),b=new r.b(o,e=>e.initializeAttachmentStateForSmimeAttachments),O=new r.b(o,e=>e.getAttachmentsForSmimeResponse),S=new r.b(o,e=>e.getSmimeAttachmentsForRequest),C=Object(r.d)(o,e=>e.SignatureDetails)},2795:function(e){e.exports=JSON.parse('{"a":"Lca","b":"Mca"}')},2806:function(e,t,n){"use strict";var r=n(0),o=n(123),i=n.n(o),a=n(23),s=n(933),c=n(2483),u=n(646);let l=(e,t)=>e||t;function d(e){return[...(e||Object(u.a)()).shrinkable.values()].reduce(l,!1)}var f=n(3388),p=n.n(f),m=n(166);const h=n.n(m).a.bind(p.a);var g=Object(a.a)(({underlay:e})=>Object(c.a)(e)&&r.createElement("div",{className:h(p.a.underlay,{shrinkable:d(e)})})),v=n(1303),y=n(131),b=n(449),O=n(3311),S=n.n(O);t.a=Object(a.a)((function({renderHeader:e,children:t,renderSkipLinkPlaceholder:n,underlay:o}){return Object(b.b)(),r.createElement(v.a,{className:S.a.appContainer,theme:Object(y.c)()},null==n?void 0:n(),null==e?void 0:e(),r.createElement("div",{className:i()(S.a.main,{isShyHeaderMode:Object(s.b)()})},t,r.createElement(g,{underlay:o})))}))},2808:function(e,t,n){"use strict";var r=n(35);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetCalendarEventJsonRequest:#Exchange"},n)),Object(r.a)("GetCalendarEvent",e,t)}n.d(t,"a",(function(){return o}))},2816:function(e,t,n){"use strict";var r=n(3);const o=Object(r.createStore)("AppHostStore",{hostedApp:void 0,selectedEntityId:"",selectedSubEntityId:"",subEntityLabel:"",isInError:!1});t.a=o},283:function(e,t,n){"use strict";var r=n(907);n.d(t,"a",(function(){return r.a}))},2834:function(e,t,n){"use strict";var r=n(610),o=n(2);function i(e,t,n){if(!e||!t||!n)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?`${e}&${t}=${n}`:`${e}?${t}=${n}`}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));const a=Object(o.S)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function s(e){const t=e?encodeURIComponent(`?provider=${e}`):"",n=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return`${Object(r.n)()}/mail/${n}${t}`}function c(e){const t=`${Object(r.n)()}/mail/AddFileProvider.html`,n=encodeURIComponent(`provider=${e}&url=${t}`);return`${a}/ADPRedirect.aspx?${n}`}function u(e,t,n,r,o,a){return()=>{const e=function(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,n=[];for(let r=0;r<16;r++)n.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+n.join("")}();let s=i(t,"client_id",r);if(s=i(s,"redirect_uri",n),s=i(s,"response_type",o),a){const t=a(e);s=Object.keys(t).reduce((e,n)=>i(e,n,t[n]),s)}return{authUrl:s,redirectUrl:n,csrfToken:e}}}},2843:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"CreateItemJsonRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2844:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"CreateItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2850:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1734);function o(){const e=Object(r.a)().EnabledAddinCommands;return!!e&&e.isInitialized}},2852:function(e){e.exports=JSON.parse('{"b":"Yca","a":"Zca"}')},2853:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(16),o=n(2136);function i(){return{providers:new r.ObservableMap,loadState:o.a.NotLoaded,removalPending:new r.ObservableMap}}},286:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.smallFluid=0]="smallFluid",e[e.smallFixedFar=1]="smallFixedFar",e[e.smallFixedNear=2]="smallFixedNear",e[e.medium=3]="medium",e[e.large=4]="large",e[e.largeFixed=5]="largeFixed",e[e.extraLarge=6]="extraLarge",e[e.custom=7]="custom",e[e.customNear=8]="customNear"}(r||(r={}))},287:function(e,t,n){"use strict";var r,o=n(3);!function(e){e[e.Valid=0]="Valid",e[e.AccountDeprovisioned=1]="AccountDeprovisioned",e[e.AccessRevoked=2]="AccessRevoked",e[e.TransientTokenError=3]="TransientTokenError",e[e.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",e[e.AccountNotFound=5]="AccountNotFound",e[e.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var i=n(80);const a=Object(o.action)("addAccount",e=>({userIdentity:e.userIdentity,account:e})),s=Object(o.action)("removeAccount",e=>({userIdentity:e})),c=Object(o.action)("updateAccount",(e,t,n)=>({userIdentity:e,accountToken:t,accountTokenExpiresIn:n})),u=Object(o.action)("updateOWAConnectedAccountStatus",(e,t)=>({userIdentity:e,accountState:t})),l=Object(o.action)("connectedAccountIsInErrorState",(e,t)=>Object(i.b)({name:"connectedAccountIsInErrorState",customData:{accountState_1:r[e],accountProvider_2:t}},{accountState:e})),d=Object(o.action)("connectedAccountsListRequested",e=>({isSuccess:e})),f=Object(o.action)("setAccountsStoreState",e=>({state:e}));var p,m=n(16);!function(e){e[e.None=0]="None",e[e.Loading=1]="Loading",e[e.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",e[e.AccountsLoadError=3]="AccountsLoadError"}(p||(p={}));var h=Object(o.createStore)("OWAAccountsStore",{accountsMap:new m.ObservableMap({}),accountsLoadedState:p.None}),g=n(282),v=n(57),y=n(912),b=n(971),O=n(516);function S(e){var t;if(Object(O.a)()){const n=Object(b.a)(Object(y.a)(e));if(n&&"OFFICE365"==(null===(t=n.mailbox)||void 0===t?void 0:t.mailboxType))return!1}else if(e==Object(v.b)())return!1;return void 0!==_(e)}var C=n(972);function A(){return[...h().accountsMap.values()]}function _(e){return h().accountsMap.get(e)}function I(){var e,t;return Object(O.a)()?(null===(e=A())||void 0===e?void 0:e.length)>1?A()[1]:null:(null===(t=A())||void 0===t?void 0:t.length)>0?A()[0]:null}function x(){return A().filter(e=>e.accountState!=r.Valid)}function E(e){return A().filter(t=>e.includes(t.accountState))}function T(e){return A().filter(t=>t.accountProviderType==e)}function w(e){return S(e)?_(e).accountProviderType:null}function M(e){return Object(O.a)()?e.token:"Outlook"==e.accountProviderType?`MSAuth1.0 usertoken="${e.token}", type="MSACT"`:"Google"==e.accountProviderType||"ICloud"==e.accountProviderType||"Yahoo"==e.accountProviderType?`Bearer ${e.token}`:"Office365"==e.accountProviderType?(Object(C.a)(!1,"Office365 accounts should not use this function."),""):Object(g.a)(e.accountProviderType)}function k(e,t){return function(n){const r=_(n);return r?r[e]:t}}k("accountUniqueId","0");const j=k("accountState",r.Valid),P=()=>A().some(e=>!D(e.userIdentity)),R=k("accountProviderType",null),N=e=>"Outlook"==R(e),D=e=>j(e)==r.Valid,F=()=>A().length>0;function L(){return h().accountsLoadedState}var U=n(71),B=n(727),H=n(7),V=n(132),z=n(13);function W(){return!Object(V.a)("acctmonaccounts")&&(Object(z.i)("sourcelistapi")||Object(z.i)("accountsapi"))}Object(o.mutator)(a,({account:e})=>{Object(U.o)("owaAccountAdded",{accountStatus_1:r[e.accountState]}),h().accountsMap.set(e.userIdentity,e)}),Object(o.orchestrator)(a,({account:e})=>{W()&&B.a.importAndExecute(e.userIdentity,e.accountUniqueId,e.accountState)}),Object(o.mutator)(s,({userIdentity:e})=>{h().accountsMap.delete(e)}),Object(o.orchestrator)(s,({userIdentity:e})=>{W()&&B.c.importAndExecute(e)}),Object(o.mutator)(c,({userIdentity:e,accountToken:t,accountTokenExpiresIn:n})=>{const r=h().accountsMap.get(e);r.token=t,r.tokenExpiry=Object(H.j)(Object(H.Ub)(),n)}),Object(o.mutator)(u,({userIdentity:e,accountState:t})=>{const n=h().accountsMap.get(e);n.accountState==r.Valid&&t!=r.Valid&&Object(U.o)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[t]}),n.accountState=t}),Object(o.orchestrator)(u,({userIdentity:e,accountState:t})=>{W()&&B.d.importAndExecute(e,t)}),Object(o.mutator)(d,e=>{const t=e.isSuccess?p.AccountsLoadSuccessful:p.AccountsLoadError;h().accountsLoadedState=t}),Object(o.mutator)(f,e=>{h().accountsLoadedState=e.state}),n.d(t,"c",(function(){return a})),n.d(t,"v",(function(){return s})),n.d(t,"y",(function(){return c})),n.d(t,"x",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"w",(function(){return f})),n.d(t,"n",(function(){return A})),n.d(t,"k",(function(){return _})),n.d(t,"i",(function(){return I})),n.d(t,"f",(function(){return x})),n.d(t,"g",(function(){return E})),n.d(t,"o",(function(){return T})),n.d(t,"j",(function(){return w})),n.d(t,"m",(function(){return M})),n.d(t,"l",(function(){return j})),n.d(t,"q",(function(){return P})),n.d(t,"u",(function(){return N})),n.d(t,"t",(function(){return D})),n.d(t,"p",(function(){return F})),n.d(t,"h",(function(){return L})),n.d(t,"r",(function(){return S})),n.d(t,"s",(function(){return O.a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return p}))},2874:function(e){e.exports=JSON.parse('{"b":"Rca","a":"Sca","e":"Tca","d":"Uca","f":"Vca","c":"Wca"}')},2875:function(e,t,n){"use strict";function r(e,t){return{name:e,dataType:1,value:t,classification:4}}function o(e,t){return{name:e,dataType:2,value:t,classification:4}}function i(e,t){return{name:e,dataType:3,value:t,classification:4}}function a(e,t){return{name:e,dataType:0,value:t,classification:4}}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return a}))},289:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.MailCompose=3]="MailCompose",e[e.SxS=4]="SxS",e[e.CalendarCompose=5]="CalendarCompose",e[e.CalendarReadingPane=6]="CalendarReadingPane"}(r||(r={}))},290:function(e,t,n){"use strict";var r=n(446),o=n(447);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){o.isString(e)&&(e=b(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var a=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,u=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(u),d=["%","/","?",";","#"].concat(l),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,h={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=n(227);function b(e,t,n){if(e&&o.isObject(e)&&e instanceof i)return e;var r=new i;return r.parse(e,t,n),r}i.prototype.parse=function(e,t,n){if(!o.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),s=-1!==i&&i<e.indexOf("#")?"?":"#",u=e.split(s);u[0]=u[0].replace(/\\/g,"/");var b=e=u.join(s);if(b=b.trim(),!n&&1===e.split("#").length){var O=c.exec(b);if(O)return this.path=b,this.href=b,this.pathname=O[1],O[2]?(this.search=O[2],this.query=t?y.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var S=a.exec(b);if(S){var C=(S=S[0]).toLowerCase();this.protocol=C,b=b.substr(S.length)}if(n||S||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var A="//"===b.substr(0,2);!A||S&&g[S]||(b=b.substr(2),this.slashes=!0)}if(!g[S]&&(A||S&&!v[S])){for(var _,I,x=-1,E=0;E<f.length;E++){-1!==(T=b.indexOf(f[E]))&&(-1===x||T<x)&&(x=T)}-1!==(I=-1===x?b.lastIndexOf("@"):b.lastIndexOf("@",x))&&(_=b.slice(0,I),b=b.slice(I+1),this.auth=decodeURIComponent(_)),x=-1;for(E=0;E<d.length;E++){var T;-1!==(T=b.indexOf(d[E]))&&(-1===x||T<x)&&(x=T)}-1===x&&(x=b.length),this.host=b.slice(0,x),b=b.slice(x),this.parseHost(),this.hostname=this.hostname||"";var w="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!w)for(var M=this.hostname.split(/\./),k=(E=0,M.length);E<k;E++){var j=M[E];if(j&&!j.match(p)){for(var P="",R=0,N=j.length;R<N;R++)j.charCodeAt(R)>127?P+="x":P+=j[R];if(!P.match(p)){var D=M.slice(0,E),F=M.slice(E+1),L=j.match(m);L&&(D.push(L[1]),F.unshift(L[2])),F.length&&(b="/"+F.join(".")+b),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),w||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+U,this.href+=this.host,w&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!h[C])for(E=0,k=l.length;E<k;E++){var H=l[E];if(-1!==b.indexOf(H)){var V=encodeURIComponent(H);V===H&&(V=escape(H)),b=b.split(H).join(V)}}var z=b.indexOf("#");-1!==z&&(this.hash=b.substr(z),b=b.slice(0,z));var W=b.indexOf("?");if(-1!==W?(this.search=b.substr(W),this.query=b.substr(W+1),t&&(this.query=y.parse(this.query)),b=b.slice(0,W)):t&&(this.search="",this.query={}),b&&(this.pathname=b),v[C]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var G=this.search||"";this.path=U+G}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,a="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&o.isObject(this.query)&&Object.keys(this.query).length&&(a=y.stringify(this.query));var s=this.search||a&&"?"+a||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==i?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),t+i+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+r},i.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(o.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var n=new i,r=Object.keys(this),a=0;a<r.length;a++){var s=r[a];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),u=0;u<c.length;u++){var l=c[u];"protocol"!==l&&(n[l]=e[l])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var p=d[f];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||g[e.protocol])n.pathname=e.pathname;else{for(var m=(e.pathname||"").split("/");m.length&&!(e.host=m.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),n.pathname=m.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var h=n.pathname||"",y=n.search||"";n.path=h+y}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),O=e.host||e.pathname&&"/"===e.pathname.charAt(0),S=O||b||n.host&&e.pathname,C=S,A=n.pathname&&n.pathname.split("/")||[],_=(m=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(_&&(n.hostname="",n.port=null,n.host&&(""===A[0]?A[0]=n.host:A.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host=null),S=S&&(""===m[0]||""===A[0])),O)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,A=m;else if(m.length)A||(A=[]),A.pop(),A=A.concat(m),n.search=e.search,n.query=e.query;else if(!o.isNullOrUndefined(e.search)){if(_)n.hostname=n.host=A.shift(),(w=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=w.shift(),n.host=n.hostname=w.shift());return n.search=e.search,n.query=e.query,o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!A.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var I=A.slice(-1)[0],x=(n.host||e.host||A.length>1)&&("."===I||".."===I)||""===I,E=0,T=A.length;T>=0;T--)"."===(I=A[T])?A.splice(T,1):".."===I?(A.splice(T,1),E++):E&&(A.splice(T,1),E--);if(!S&&!C)for(;E--;E)A.unshift("..");!S||""===A[0]||A[0]&&"/"===A[0].charAt(0)||A.unshift(""),x&&"/"!==A.join("/").substr(-1)&&A.push("");var w,M=""===A[0]||A[0]&&"/"===A[0].charAt(0);_&&(n.hostname=n.host=M?"":A.length?A.shift():"",(w=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=w.shift(),n.host=n.hostname=w.shift()));return(S=S||n.host&&A.length)&&!M&&A.unshift(""),A.length?n.pathname=A.join("/"):(n.pathname=null,n.path=null),o.isNull(n.pathname)&&o.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},i.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},2906:function(e,t,n){"use strict";t.a=e=>{if(e){const{shouldEncryptMessageAsSmime:t,shouldSignMessageAsSmime:n}=e;return t||n}return!1}},291:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(135),o=n(100),i=n(2);let a;function s(e){a=e}async function c(e){var t,n;if(Object(i.Q)())return o.f.importAndExecute(Object(r.a)());const s=a&&await a(void 0,e);if(s&&s.length>0){if("bearer"===(null===(t=null==s?void 0:s.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return s.split(" ")[1];if("msauth1.0"===(null===(n=null==s?void 0:s.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return s}}},2926:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"DeleteItemField:#Exchange"},e)}n.d(t,"a",(function(){return r}))},2927:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(3),o=n(4189);const i=Object(r.createStore)("signature",Object(o.a)()),a=i()},2929:function(e,t,n){"use strict";var r=n(3),o=n(3252),i=n(71);t.a=function(e,t,n){if(e.content!=t&&(a(e,t),n||Object(o.a)(e,!0),(null==t?void 0:t.indexOf("data-ogsc="))>0)){const r=new Error,o=e.isDarkMode,a=s(e)?e.bodyType:"",c=s(e)?e.preferredEditors[a]:"";Object(i.o)("DebugEditor108089",{eventName:"NoColorTransform",editorId:e.editorId,callstack:r.stack,length:t.length,isInitializing:n,isDarkMode:o,bodyType:a,activeEditor:c})}};const a=Object(r.mutatorAction)("Editor_UpdateContent",(e,t)=>{e.content=t});function s(e){return!!e.preferredEditors}},2991:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1797),o=n(1734);const i="User",a="Organization",s="Default";function c(e){const t=Object(o.a)().EnabledAddinCommands;return t?t.getExtensionPoint(r.a.TrapOnSendEvent).map(t=>t.AddinCommands.get(e.toString())):[]}function u(e){const t=c(e),n=t.filter(e=>e.get_OriginString()==i),r=t.filter(e=>e.get_OriginString()==s),o=t.filter(e=>e.get_OriginString()==a);return n.sort((e,t)=>l(e,t)),r.sort((e,t)=>l(e,t)),o.sort((e,t)=>l(e,t)),[...n,...r,...o]}function l(e,t){const n=e.get_Id(),r=t.get_Id();return n<r?-1:n>r?1:0}},300:function(e,t,n){"use strict";var r=function(){return Object.create(null)},o=Array.prototype,i=o.forEach,a=o.slice,s=function(){function e(e,t){void 0===e&&(e=!0),void 0===t&&(t=r),this.weakness=e,this.makeData=t}return e.prototype.lookup=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.lookupArray(e)},e.prototype.lookupArray=function(e){var t=this;return i.call(e,(function(e){return t=t.getChildTrie(e)})),t.data||(t.data=this.makeData(a.call(e)))},e.prototype.getChildTrie=function(t){var n=this.weakness&&function(e){switch(typeof e){case"object":if(null===e)break;case"function":return!0}return!1}(t)?this.weak||(this.weak=new WeakMap):this.strong||(this.strong=new Map),r=n.get(t);return r||n.set(t,r=new e(this.weakness,this.makeData)),r},e}();var c=n(433);function u(){}n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return D})),n.d(t,"a",(function(){return s}));var l,d=function(){function e(e,t){void 0===e&&(e=1/0),void 0===t&&(t=u),this.max=e,this.dispose=t,this.map=new Map,this.newest=null,this.oldest=null}return e.prototype.has=function(e){return this.map.has(e)},e.prototype.get=function(e){var t=this.getNode(e);return t&&t.value},e.prototype.getNode=function(e){var t=this.map.get(e);if(t&&t!==this.newest){var n=t.older,r=t.newer;r&&(r.older=n),n&&(n.newer=r),t.older=this.newest,t.older.newer=t,t.newer=null,this.newest=t,t===this.oldest&&(this.oldest=r)}return t},e.prototype.set=function(e,t){var n=this.getNode(e);return n?n.value=t:(n={key:e,value:t,newer:null,older:this.newest},this.newest&&(this.newest.newer=n),this.newest=n,this.oldest=this.oldest||n,this.map.set(e,n),n.value)},e.prototype.clean=function(){for(;this.oldest&&this.map.size>this.max;)this.delete(this.oldest.key)},e.prototype.delete=function(e){var t=this.map.get(e);return!!t&&(t===this.newest&&(this.newest=t.older),t===this.oldest&&(this.oldest=t.newer),t.newer&&(t.newer.older=t.older),t.older&&(t.older.newer=t.newer),this.map.delete(e),this.dispose(t.value,e),!0)},e}(),f=new c.a,p=Object.prototype.hasOwnProperty,m=void 0===(l=Array.from)?function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t}:l;function h(e){var t=e.unsubscribe;"function"==typeof t&&(e.unsubscribe=void 0,t())}var g=[],v=100;function y(e,t){if(!e)throw new Error(t||"assertion failure")}function b(e){switch(e.length){case 0:throw new Error("unknown value");case 1:return e[0];case 2:throw e[1]}}var O=function(){function e(t){this.fn=t,this.parents=new Set,this.childValues=new Map,this.dirtyChildren=null,this.dirty=!0,this.recomputing=!1,this.value=[],this.deps=null,++e.count}return e.prototype.peek=function(){if(1===this.value.length&&!A(this))return S(this),this.value[0]},e.prototype.recompute=function(e){return y(!this.recomputing,"already recomputing"),S(this),A(this)?function(e,t){M(e),f.withValue(e,C,[e,t]),function(e,t){if("function"==typeof e.subscribe)try{h(e),e.unsubscribe=e.subscribe.apply(null,t)}catch(t){return e.setDirty(),!1}return!0}(e,t)&&function(e){if(e.dirty=!1,A(e))return;I(e)}(e);return b(e.value)}(this,e):b(this.value)},e.prototype.setDirty=function(){this.dirty||(this.dirty=!0,this.value.length=0,_(this),h(this))},e.prototype.dispose=function(){var e=this;this.setDirty(),M(this),x(this,(function(t,n){t.setDirty(),k(t,e)}))},e.prototype.forget=function(){this.dispose()},e.prototype.dependOn=function(e){e.add(this),this.deps||(this.deps=g.pop()||new Set),this.deps.add(e)},e.prototype.forgetDeps=function(){var e=this;this.deps&&(m(this.deps).forEach((function(t){return t.delete(e)})),this.deps.clear(),g.push(this.deps),this.deps=null)},e.count=0,e}();function S(e){var t=f.getValue();if(t)return e.parents.add(t),t.childValues.has(e)||t.childValues.set(e,[]),A(e)?E(t,e):T(t,e),t}function C(e,t){e.recomputing=!0,e.value.length=0;try{e.value[0]=e.fn.apply(null,t)}catch(t){e.value[1]=t}e.recomputing=!1}function A(e){return e.dirty||!(!e.dirtyChildren||!e.dirtyChildren.size)}function _(e){x(e,E)}function I(e){x(e,T)}function x(e,t){var n=e.parents.size;if(n)for(var r=m(e.parents),o=0;o<n;++o)t(r[o],e)}function E(e,t){y(e.childValues.has(t)),y(A(t));var n=!A(e);if(e.dirtyChildren){if(e.dirtyChildren.has(t))return}else e.dirtyChildren=g.pop()||new Set;e.dirtyChildren.add(t),n&&_(e)}function T(e,t){y(e.childValues.has(t)),y(!A(t));var n,r,o,i=e.childValues.get(t);0===i.length?e.childValues.set(t,t.value.slice(0)):(n=i,r=t.value,(o=n.length)>0&&o===r.length&&n[o-1]===r[o-1]||e.setDirty()),w(e,t),A(e)||I(e)}function w(e,t){var n=e.dirtyChildren;n&&(n.delete(t),0===n.size&&(g.length<v&&g.push(n),e.dirtyChildren=null))}function M(e){e.childValues.size>0&&e.childValues.forEach((function(t,n){k(e,n)})),e.forgetDeps(),y(null===e.dirtyChildren)}function k(e,t){t.parents.delete(e),e.childValues.delete(t),w(e,t)}var j={setDirty:!0,dispose:!0,forget:!0};function P(e){var t=new Map,n=e&&e.subscribe;function r(e){var r=f.getValue();if(r){var o=t.get(e);o||t.set(e,o=new Set),r.dependOn(o),"function"==typeof n&&(h(o),o.unsubscribe=n(e))}}return r.dirty=function(e,n){var r=t.get(e);if(r){var o=n&&p.call(j,n)?n:"setDirty";m(r).forEach((function(e){return e[o]()})),t.delete(e),h(r)}},r}function R(){var e=new s("function"==typeof WeakMap);return function(){return e.lookupArray(arguments)}}R();var N=new Set;function D(e,t){void 0===t&&(t=Object.create(null));var n=new d(t.max||Math.pow(2,16),(function(e){return e.dispose()})),r=t.keyArgs,o=t.makeCacheKey||R(),i=function(){var i=o.apply(null,r?r.apply(null,arguments):arguments);if(void 0===i)return e.apply(null,arguments);var a=n.get(i);a||(n.set(i,a=new O(e)),a.subscribe=t.subscribe,a.forget=function(){return n.delete(i)});var s=a.recompute(Array.prototype.slice.call(arguments));return n.set(i,a),N.add(n),f.hasValue()||(N.forEach((function(e){return e.clean()})),N.clear()),s};function a(e){var t=n.get(e);t&&t.setDirty()}function s(e){var t=n.get(e);if(t)return t.peek()}function c(e){return n.delete(e)}return Object.defineProperty(i,"size",{get:function(){return n.map.size},configurable:!1,enumerable:!1}),i.dirtyKey=a,i.dirty=function(){a(o.apply(null,arguments))},i.peekKey=s,i.peek=function(){return s(o.apply(null,arguments))},i.forgetKey=c,i.forget=function(){return c(o.apply(null,arguments))},i.makeCacheKey=o,i.getKey=r?function(){return o.apply(null,r.apply(null,arguments))}:o,Object.freeze(i)}},3006:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(47);function o(){return Object(r.j)("tri-officeRailHost")||Object(r.j)("tri-appServiceApps")}},3015:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.createStore)("calendarConfiguration",{calendarConfiguration:null,txpSettings:null,statusCode:0})()},3044:function(e,t,n){"use strict";var r=n(71);function o(e,t,n){Object(r.o)(e,t,{cosmosOnlyData:n,isCore:!0})}function i(e){return new r.b(e,{isCore:!0})}var a=n(623);function s(){return{ariaTenantTokens:Object(a.a)(),flightControls:{client_event:{flight:"ana-client-event",rate:5},client_error:{flight:"ana-client-error"},client_verbose:{flight:"ana-client-verbose",rate:1},client_network_request:{flight:"ana-client-network-request",rate:1}},verboseWhiteListEvents:["AttachmentRefreshDownloadToken","TabViewActivateTab"],qosDatapointNames:["AddMemberModalSave","CreateGrouptoAddMembers","EditGroupModalSave","ForwardInSMIME","GroupFilesHubEnsureAuthToken","GroupFilesHubListsLoad","GroupMailComposeSend","loadSuggestedGroupsAction","MailComposeForward","MailComposeNew","MailComposeReply","MailComposeReplyAll","MailComposeSend","MessageOptionsEmptyInvariantViolation","MessageOptionsMultipleDialogsInvariantViolation","NavigateFromMeToWe","OpenItemPeek","PreviewAttachmentInSxSE2E","ReplyAllInSMIME","ReplyInSMIME","SaveCalendarEvent","SearchEndToEnd","SelectGroup","SelectMailItem","showFullCompose","showReadingPane","SwitchGroup","SwitchMailFolder","TnS_DeleteConversation","TnS_DeleteItem","ViewCalendarEvent"],sampledQosDatapointNames:["LoadGroupsInLeftNavFromSessionData"]}}n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}))},3055:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(806),o=n(3195);function i(){const e=Object(r.d)();switch(e.type){case r.a.SecondaryReadingPane:return e.data.id.Id;case r.a.Primary:default:return Object(o.a)()}}},306:function(e,t,n){"use strict";t.a=function(e){return null!=e&&"object"==typeof e}},3070:function(e,t,n){"use strict";var r=n(1675),o=n(1681);function i(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)}function a(){const e=Object(r.I)();return e&&0==e.tableQuery.type&&Object(o.G)(e.tableQuery.folderId)?e.tableQuery.folderId:null}var s=n(3),c=n(2287),u=n(2620),l=n(16);var d=Object(s.createStore)("publicFolderUtilsStore",new l.ObservableMap),f=n(57);function p(e){if(!d().has(e)){const t=c.a.folderTable.get(e),n=null!=t.replicaList?t.replicaList[0]:Object(f.g)().SessionSettings.DefaultPublicFolderMailbox,r=Object(u.a)(n);m(e,r)}return d().get(e)}const m=Object(s.mutatorAction)("addPublicFolderMailboxInfoToStore",(e,t)=>{d().set(e,t)});n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return p}))},3072:function(e,t,n){"use strict";var r=n(35);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return o}))},3087:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"UpdateItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},309:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var r=n(25),o=n(1308);function i(e){return e.hasOwnProperty("graphQLErrors")}var a=function(e){var t="";return Object(o.a)(e.graphQLErrors)&&e.graphQLErrors.forEach((function(e){var n=e?e.message:"Error message not found.";t+=n+"\n"})),e.networkError&&(t+=e.networkError.message+"\n"),t=t.replace(/\n$/,"")},s=function(e){function t(n){var r=n.graphQLErrors,o=n.networkError,i=n.errorMessage,s=n.extraInfo,c=e.call(this,i)||this;return c.graphQLErrors=r||[],c.networkError=o||null,c.message=i||a(c),c.extraInfo=s,c.__proto__=t.prototype,c}return Object(r.c)(t,e),t}(Error)},3093:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(4929);const o=e=>[e.toRecipientWell,e.ccRecipientWell,e.bccRecipientWell],i=e=>{const t=o(e);return Object(r.a)(t).map(e=>e.persona.EmailAddress.EmailAddress)},a=e=>{const t=o(e);return Object(r.a)(t).map(e=>e.persona.EmailAddress)}},3108:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(173),i=n(526),a=n(317);let s=0;function c(e,t){const n=(t||window).document;let c=n.createElement("div");c.id=`owa-modal-${s++}`,n.body.appendChild(c);let u=!1;const l=()=>{u||(u=!0,o.unmountComponentAtNode(c),n.body.removeChild(c))};let d;return[new Promise((n,s)=>{d=s,o.render(r.createElement(a.b,{window:t||window},r.createElement(i.a,{type:i.b.None,onError:()=>{l(),s()}},r.createElement(e,{onDismiss:e=>{l(),n(e)}}))),c)}),()=>{l(),d()}]}},3124:function(e,t,n){"use strict";n.d(t,"c",(function(){return C})),n.d(t,"e",(function(){return A})),n.d(t,"f",(function(){return _})),n.d(t,"d",(function(){return I})),n.d(t,"a",(function(){return x}));var r=n(2036),o=n(2101),i=n(4464),a=n(4198),s=n(5132),c=n(5894),u=n(5979),l=n(3767),d=n(4683),f=n(38),p=n(71),m=n(3457),h=n(3453),g=n(47),v=n(3),y=n(4556),b=n(5659);const O={};function S(e){let t=O[e.composeId];return t||(t={activeSaveAction:null,hasPendingSaveAction:!1},O[e.composeId]=t),t}function C(e){const t=O[e.composeId];return t&&!!t.activeSaveAction}async function A(e,t){const n=S(e);n.activeSaveAction=t,await t.then(e=>(n.activeSaveAction=null,Promise.resolve(e))).catch(e=>(n.activeSaveAction=null,Promise.reject(e)))}async function _(e){const t=O[e.composeId];return(null==t?void 0:t.activeSaveAction)?(await t.activeSaveAction,Promise.resolve(!0)):Promise.resolve(!1)}function I(e){const t=O[e.composeId];return t&&!!t.activeSaveAction}function x(e){O[e.composeId]&&delete O[e.composeId]}t.b=Object(p.r)(a.b.MailComposeSave,(async function(e,t=!1,n=!1){return await async function(e){const t=S(e);return t.activeSaveAction?t.hasPendingSaveAction?(await t.activeSaveAction,Promise.resolve(!1)):(t.hasPendingSaveAction=!0,await t.activeSaveAction,t.hasPendingSaveAction=!1,Promise.resolve(!0)):Promise.resolve(!0)}(e)?e?e.isSending||I(e)?Promise.resolve():(t||(Object(o.a)(e,s.a),E(e),Object(y.d)(Object(b.a)(e))),Object(o.a)(e,"warningMessageMaxRecipientsExceed"),function(e){return Object(l.a)(e)<=Object(f.a)().MaxRecipientsPerMessage}(e)?A(e,Object(u.b)(e).then(n=>(e.isSending||(Object(u.a)(n,e),Object(d.a)()&&Object(i.a)(e,t?2:4),Object(m.a)()&&Object(g.j)("cmp-clp-auto-labeling")&&h.g.import().then(t=>{t(e,e.protectionViewState.clpViewState,e.itemId,e.content)})),Promise.resolve())).catch(o=>{if(!t&&!e.isSending){const t=Object(c.a)(o?o.message:null,!1);Object(r.a)(e,t)}return n&&!e.isSending?Promise.reject(o):Promise.resolve()})):(Object(r.a)(e,"warningMessageMaxRecipientsExceed"),Promise.resolve())):Promise.reject(new Error("could not save message if view state does not exist")):Promise.resolve()}));const E=Object(v.mutatorAction)("resetIsManuallySaved",e=>{e.isManuallySaved=!0})},3133:function(e,t,n){"use strict";var r=n(20);function o(e,t){const n=new r.b(e,e=>e[t]);return(...e)=>n.import().then(t=>t(...e))}n.d(t,"e",(function(){return i})),n.d(t,"j",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"n",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return h})),n.d(t,"l",(function(){return g})),n.d(t,"k",(function(){return v})),n.d(t,"f",(function(){return y}));const i=new r.c(()=>Promise.all([n.e(0),n.e(4),n.e(6),n.e(7),n.e(269)]).then(n.bind(null,19507))),a=o(i,"send"),s=o(i,"save"),c=o(i,"runPostOpenTasks"),u=o(i,"switchBodyType"),l=o(i,"discard"),d=o(i,"upConvert"),f=o(i,"insertSignature"),p=o(i,"popoutCompose"),m=o(i,"createAttachments"),h=o(i,"clickAttachButton"),g=o(i,"showMessageOptionsDialog"),v=o(i,"setFromAddress"),y=o(i,"onClickFromMenu")},3135:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetClientAccessTokenRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},3139:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onOfficeAppClick",(e,t)=>({app:e,currentlySelectedModule:t}))},3140:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("updateInternetMessageId",(e,t,n)=>({conversationId:e,itemId:t,internetMessageId:n}))},3164:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(2),o=n(40),i=n(57);function a(){let e=Object(r.v)("targetServer"),t="DefaultAnchorMailbox"+(e?"_"+e.toLocaleLowerCase():"");return Object(r.v)(t)}function s(){let e=function(){let e="",t=Object(o.b)().pathname.split("/").filter(e=>e.length);return t.length>=2&&t[1].match(/.+@.+/)&&(e=t[1]),e}();if(0===e.length){let t=Object(i.g)();if(null==t?void 0:t.SessionSettings){let n=t.SessionSettings.ExternalDirectoryTenantGuid,r=t.SessionSettings.UserPuid;r&&n&&(e=`PUID:${r}@${n}`)}}return 0===e.length&&(e=a()),e}},318:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(946);function o(e,t,n){return new r.a("Syntax Error: ".concat(n),void 0,e,[t])}},3183:function(e,t,n){"use strict";var r=n(35);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetClientAccessTokenJsonRequest:#Exchange"},n)),Object(r.a)("GetClientAccessToken",e,t)}n.d(t,"a",(function(){return o}))},3192:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onModuleClick",(e,t,n)=>({module:e,currentlySelectedModule:t,activeModuleAction:n}))},3195:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1902),o=n(610);function i(){var e,t;return Object(o.w)()?null===(e=Object(r.b)().deeplinkId)||void 0===e?void 0:e.id:null===(t=Object(r.b)().primaryReadingPaneTabId)||void 0===t?void 0:t.Id}},3226:function(e,t,n){"use strict";n.d(t,"e",(function(){return _})),n.d(t,"k",(function(){return x})),n.d(t,"d",(function(){return E})),n.d(t,"i",(function(){return w})),n.d(t,"g",(function(){return M})),n.d(t,"b",(function(){return k})),n.d(t,"j",(function(){return j})),n.d(t,"l",(function(){return P})),n.d(t,"f",(function(){return R})),n.d(t,"c",(function(){return N})),n.d(t,"h",(function(){return D})),n.d(t,"p",(function(){return F})),n.d(t,"o",(function(){return L})),n.d(t,"a",(function(){return U})),n.d(t,"m",(function(){return B})),n.d(t,"n",(function(){return H})),n.d(t,"r",(function(){return V})),n.d(t,"q",(function(){return z}));var r=n(4304),o=n(5366),i=n(2285),a="window",s="document",c="navigator",u="location",l="console",d="performance",f="JSON",p="crypto",m="msCrypto",h="ReactNative",g="msie",v="trident/",y=null,b=null,O=!1,S=null,C=null;function A(e,t){var n=!1;if(e){try{if(!(n=t in e)){var o=e[r.k];o&&(n=t in o)}}catch(e){}if(!n)try{var a=new e;n=!Object(i.x)(a[t])}catch(e){}}return n}function _(e){var t=Object(o.a)();return t&&t[e]?t[e]:e===a&&I()?window:null}function I(){return Boolean(typeof window===r.j&&window)}function x(){return I()?window:_(a)}function E(){return Boolean(typeof document===r.j&&document)?document:_(s)}function T(){return Boolean(typeof navigator===r.j&&navigator)}function w(){return T()?navigator:_(c)}function M(e){if(e&&O){var t=_("__mockLocation");if(t)return t}return typeof location===r.j&&location?location:_(u)}function k(){return typeof console!==r.l?console:_(l)}function j(){return _(d)}function P(){return Boolean(typeof JSON===r.j&&JSON||null!==_(f))}function R(){return P()?JSON||_(f):null}function N(){return _(p)}function D(){return _(m)}function F(){var e=w();return!(!e||!e.product)&&e.product===h}function L(){var e=w();if(e&&(e.userAgent!==b||null===y)){var t=((b=e.userAgent)||"").toLowerCase();y=Object(i.E)(t,g)||Object(i.E)(t,v)}return y}function U(e){var t=Object[r.k].toString.call(e),n="";return"[object Error]"===t?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":P()&&(n=R().stringify(e)),t+n}function B(){return null===C&&(C=T()&&Boolean(w().sendBeacon)),C}function H(e){var t=!1;try{t=!!_("fetch");var n=_("Request");t&&e&&n&&(t=A(n,"keepalive"))}catch(e){}return t}function V(){return null===S&&(S=void 0!==typeof XDomainRequest)&&z()&&(S=S&&!A(_("XMLHttpRequest"),"withCredentials")),S}function z(){var e=!1;try{e=!!_("XMLHttpRequest")}catch(e){}return e}},3234:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("onOpenMetaOsApp",({appManifest:e,entityId:t,subEntityId:n,subEntityLabel:r})=>({appManifest:e,entityId:t,subEntityId:n,subEntityLabel:r}))},325:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(590),i=n(813),a=n.n(i);const s=({Svg:e,displayName:t})=>{const n=Object(o.a)(({styles:t})=>{const{root:n,svg:o}="function"==typeof t?t({}):t;return r.createElement("span",{role:"presentation","aria-hidden":!0,style:n,className:a.a.root},r.createElement(e,{className:a.a.svg,style:o}))},{},void 0,{scope:"OwaSvgIcon"});return n.displayName=t,n}},3252:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setIsDirty")((function(e,t){e.isDirty=t}))},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function i(){return o()+o()+"-"+o()+"-"+o()+"-"+o()+"-"+o()+o()+o()}function a(e){return r.test(e)}},327:function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"g",(function(){return d}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(0),n.e(901),n.e(504)]).then(n.bind(null,1565))),i=new r.a(o,e=>e.makePostRequest).importAndExecute,a=new r.a(o,e=>e.makePatchRequest).importAndExecute,s=new r.a(o,e=>e.makePutRequest).importAndExecute,c=new r.a(o,e=>e.makeGetRequest).importAndExecute,u=new r.a(o,e=>e.makeDeleteRequest).importAndExecute,l=new r.a(o,e=>e.makeGraphRequest).importAndExecute,d=new r.a(o,e=>e.sendOwsPrimeRequest).importAndExecute},328:function(e,t,n){"use strict";var r,o=n(565),i=n(247).a["__core-js_shared__"],a=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";var s=function(e){return!!a&&a in e},c=n(252),u=n(434),l=/^\[object .+?Constructor\]$/,d=Function.prototype,f=Object.prototype,p=d.toString,m=f.hasOwnProperty,h=RegExp("^"+p.call(m).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var g=function(e){return!(!Object(c.a)(e)||s(e))&&(Object(o.a)(e)?h:l).test(Object(u.a)(e))};var v=function(e,t){return null==e?void 0:e[t]};t.a=function(e,t){var n=v(e,t);return g(n)?n:void 0}},3283:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onSelectOfficeRailApp",e=>({app:e}))},3293:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(806),o=n(263),i=n(937),a=n(282);function s(e,t=0,n,s){const d=function(e){switch(e){case 0:return c;case 1:return u;case 2:return l;default:return Object(a.a)(e)}}(t),f=Object(i.b)();for(const t of Object(o.a)().tabs)if(t.type==r.a.MailCompose&&0==t.state){const r=f.viewStates.get(t.data);if((null==r?void 0:r.isInlineCompose)&&d(r,e)&&(0==r.asyncSendState||n&&6==r.asyncSendState)&&(!s&&!t.projectionRPTabId||t.projectionRPTabId==s))return r}return null}function c(e,t){return e.conversationId===t}function u(e,t){return e.referenceItemId.Id===t}function l(e,t){return!1}},3311:function(e,t,n){var r=n(3312);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},3312:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._2kUAzKQd_A7zj30wwO3Tty{height:100%;-webkit-box-orient:vertical;-ms-flex-direction:column;flex-direction:column;position:relative;z-index:0}._2kUAzKQd_A7zj30wwO3Tty,.zZJcFiYp1GsQ-Zkcz02eC{overflow:hidden;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-direction:normal}.zZJcFiYp1GsQ-Zkcz02eC{height:auto;min-height:0;-webkit-box-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:horizontal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch}",""]),t.locals={appContainer:"_2kUAzKQd_A7zj30wwO3Tty",main:"zZJcFiYp1GsQ-Zkcz02eC"}},3321:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(3);const o=Object(r.action)("ON_DELETE_CONVERSATION_ITEM_PARTS_COMPLETE"),i=Object(r.action)("TOGGLE_ROW_READ_STATE_COMPLETE")},3343:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4828),o=n(2313),i=n(2061);function a(e){const t=Object(o.c)(e);if(t)return t.addinCommand;const n=Object(r.a)(e);return n?n.addinCommand:Object(i.b)(e)}},3351:function(e,t,n){"use strict";var r=n(3);const o=Object(r.action)("openCalendarBoardView");var i=n(47),a=n(57);function s(){var e;return Object(i.j)("cal-sublimity")&&!(null===(e=Object(a.g)().SessionSettings)||void 0===e?void 0:e.IsShadowMailbox)}function c(){window.open("/calendar/view/board","_blank")}n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}))},3363:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r,o=(r=[],{fireEvent:function(e){r.forEach((function(t){return t(e)}))},addListener:function(e){e&&r.push(e)}});function i(){return o}function a(e,t,n){o.fireEvent({level:e,category:t,message:n})}function s(e,t,n){a(0,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}},3388:function(e,t,n){var r=n(3389);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},3389:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,".vbF-r-E4avKj8URfLkl17{width:320px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}@media only screen and (max-width:1400px){._3LSK0fynhhkK7LzEI6gycY.vbF-r-E4avKj8URfLkl17{width:calc(100vw - 1080px);min-width:0}}",""]),t.locals={underlay:"vbF-r-E4avKj8URfLkl17",shrinkable:"_3LSK0fynhhkK7LzEI6gycY"}},3391:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"#OwaReferenceAttachments{display:none}",""]),t.locals={OwaReferenceAttachments:"OwaReferenceAttachments"}},3392:function(e,t,n){(e.exports=n(76)(!1)).push([e.i,'[class*=" o365-Icon--"]:before,[class^=o365-Icon--]:before{font-family:office365icons;font-style:normal;font-weight:400;speak:none;display:inline-block;text-decoration:inherit;width:1em;font-variant:normal;line-height:1em}html[dir] [class*=" o365-Icon--"]:before,html[dir] [class^=o365-Icon--]:before{text-align:center;text-transform:none}html[dir=ltr] [class*=" o365-Icon--"]:before,html[dir=ltr] [class^=o365-Icon--]:before,html[dir=rtl] [class*=" o365-Icon--"]:before,html[dir=rtl] [class^=o365-Icon--]:before{margin-right:.2em;margin-left:.2em}',""])},3393:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,'.o365-Icon--direct:before{content:"\\e369"}.o365-Icon--emptyDocuments:before{content:"\\e324"}.o365-Icon--emptyDocumentSearch:before{content:"\\e404"}.o365-Icon--emptyDraft:before{content:"\\e325"}.o365-Icon--emptyError:before{content:"\\e347"}.o365-Icon--emptyFolder:before{content:"\\e348"}.o365-Icon--emptyMail:before{content:"\\e326"}.o365-Icon--emptySearch:before{content:"\\e327"}.o365-Icon--emptyTrash:before{content:"\\e328"}.o365-Icon--emptyTrophy:before{content:"\\e329"}.o365-Icon--emptyImage:before{content:"\\e406"}.o365-Icon--emptyImageSearch:before{content:"\\e405"}.o365-Icon--flag2:before{content:"\\e36b"}.o365-Icon--magnifyingGlass:before{content:"\\e36c"}.o365-Icon--unread:before{content:"\\e367"}.o365-Icon--folderClosed:before{content:"\\e394"}.o365-Icon--lock3:before{content:"\\e36f"}',""]),t.locals={"o365-Icon--direct":"o365-Icon--direct","o365-Icon--emptyDocuments":"o365-Icon--emptyDocuments","o365-Icon--emptyDocumentSearch":"o365-Icon--emptyDocumentSearch","o365-Icon--emptyDraft":"o365-Icon--emptyDraft","o365-Icon--emptyError":"o365-Icon--emptyError","o365-Icon--emptyFolder":"o365-Icon--emptyFolder","o365-Icon--emptyMail":"o365-Icon--emptyMail","o365-Icon--emptySearch":"o365-Icon--emptySearch","o365-Icon--emptyTrash":"o365-Icon--emptyTrash","o365-Icon--emptyTrophy":"o365-Icon--emptyTrophy","o365-Icon--emptyImage":"o365-Icon--emptyImage","o365-Icon--emptyImageSearch":"o365-Icon--emptyImageSearch","o365-Icon--flag2":"o365-Icon--flag2","o365-Icon--magnifyingGlass":"o365-Icon--magnifyingGlass","o365-Icon--unread":"o365-Icon--unread","o365-Icon--folderClosed":"o365-Icon--folderClosed","o365-Icon--lock3":"o365-Icon--lock3"}},3394:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,'a,body,button,div,form,html,img,label,span,textarea{margin:0;padding:0;border:0;font:inherit;vertical-align:baseline}body,button,div,form,html,img,label,span,textarea{color:inherit}table{font:inherit}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration,input[type=search]::-webkit-search-results-button,input[type=search]::-webkit-search-results-decoration{display:none}input::-webkit-input-placeholder{color:var(--neutralTertiary)}input::-moz-placeholder{color:var(--neutralTertiary)}input::-ms-input-placeholder{color:var(--neutralTertiary)}input::placeholder{color:var(--neutralTertiary)}.ms-Fabric--isFocusHidden :focus{outline:0}@media print{.ms-Callout-container,.noPrint,.noPrint *{display:none!important}}html{-ms-content-zooming:none}body{width:100%;min-width:1008px;height:100%;overflow-y:hidden;overflow-x:auto;position:absolute!important;font-family:"Segoe UI Web (West European)",Segoe UI,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,sans-serif;-webkit-scrollbar-base-color:var(--white);-webkit-scrollbar-face-color:var(--neutralTertiaryAlt);-webkit-scrollbar-shadow-color:var(--white);-webkit-scrollbar-highlight-color:var(--white);-webkit-scrollbar-3dlight-color:var(--white);-webkit-scrollbar-darkshadow-color:var(--white);-webkit-scrollbar-track-color:var(--white);-webkit-scrollbar-arrow-color:var(--white);-webkit-tap-highlight-color:transparent;-webkit-font-smoothing:antialiased}html[dir] body{background-color:var(--white)}.customScrollBar,body{-ms-overflow-style:-ms-autohiding-scrollbar;scrollbar-color:var(--neutralTertiaryAlt) transparent;scrollbar-width:thin}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment,html[dir] body::-webkit-scrollbar-button:horizontal:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] body::-webkit-scrollbar-button:horizontal:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEA+QLMGAIMGAIMGAIMBAUIGQoZU5HAwB+ZgDtGYq3fgAAAABJRU5ErkJggg==)}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement,html[dir] body::-webkit-scrollbar-button:horizontal:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] body::-webkit-scrollbar-button:horizontal:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAiSURBVHgBY2BEAxQJMKAJMKAJMKAJMOATgIkQMBTBooZfAH56AO2yINTrAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment,html[dir] body::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment:hover,html[dir] body::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAfSURBVHgBY2BEA7QTYIAChAoYH6EFxkeYwQBj0MelAH3GAO2C9+AaAAAAAElFTkSuQmCC)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement,html[dir] body::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEXM09b///8OmaLeAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] body::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAABlBMVEWdtMT///8YSU3FAAAAAnRSTlP/AOW3MEoAAAAgSURBVHgBY2BEAzQVYIAzYHwGGAvOZ4AyIXyECH1cCgB/GgDtpWTgqAAAAABJRU5ErkJggg==)}.customScrollBar::-webkit-scrollbar,body::-webkit-scrollbar{height:18px;width:18px}.customScrollBar::-webkit-scrollbar:disabled,body::-webkit-scrollbar:disabled{display:none}.customScrollBar::-webkit-scrollbar-button,.customScrollBar::-webkit-scrollbar-corner,body::-webkit-scrollbar-button,body::-webkit-scrollbar-corner{cursor:pointer}html[dir] .customScrollBar::-webkit-scrollbar-button,html[dir] .customScrollBar::-webkit-scrollbar-corner,html[dir] body::-webkit-scrollbar-button,html[dir] body::-webkit-scrollbar-corner{background:transparent}.customScrollBar::-webkit-scrollbar-button:horizontal:decrement,.customScrollBar::-webkit-scrollbar-button:horizontal:decrement:hover,.customScrollBar::-webkit-scrollbar-button:horizontal:increment,.customScrollBar::-webkit-scrollbar-button:horizontal:increment:hover,.customScrollBar::-webkit-scrollbar-button:vertical:decrement,.customScrollBar::-webkit-scrollbar-button:vertical:decrement:hover,.customScrollBar::-webkit-scrollbar-button:vertical:increment,.customScrollBar::-webkit-scrollbar-button:vertical:increment:hover,body::-webkit-scrollbar-button:horizontal:decrement,body::-webkit-scrollbar-button:horizontal:decrement:hover,body::-webkit-scrollbar-button:horizontal:increment,body::-webkit-scrollbar-button:horizontal:increment:hover,body::-webkit-scrollbar-button:vertical:decrement,body::-webkit-scrollbar-button:vertical:decrement:hover,body::-webkit-scrollbar-button:vertical:increment,body::-webkit-scrollbar-button:vertical:increment:hover{height:18px;width:18px}html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement,html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment,html[dir] .customScrollBar::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment,html[dir] .customScrollBar::-webkit-scrollbar-button:vertical:increment:hover,html[dir] body::-webkit-scrollbar-button:horizontal:decrement,html[dir] body::-webkit-scrollbar-button:horizontal:decrement:hover,html[dir] body::-webkit-scrollbar-button:horizontal:increment,html[dir] body::-webkit-scrollbar-button:horizontal:increment:hover,html[dir] body::-webkit-scrollbar-button:vertical:decrement,html[dir] body::-webkit-scrollbar-button:vertical:decrement:hover,html[dir] body::-webkit-scrollbar-button:vertical:increment,html[dir] body::-webkit-scrollbar-button:vertical:increment:hover{background-position:50%}html[dir] .customScrollBar::-webkit-scrollbar-track,html[dir] body::-webkit-scrollbar-track{background:transparent}html[dir] .customScrollBar::-webkit-scrollbar-thumb,html[dir] .customScrollBar::-webkit-scrollbar-thumb:hover,html[dir] body::-webkit-scrollbar-thumb,html[dir] body::-webkit-scrollbar-thumb:hover{border-radius:9px;border:solid 6px transparent;background-clip:content-box}html[dir] .customScrollBar::-webkit-scrollbar-thumb,html[dir] body::-webkit-scrollbar-thumb{background-color:var(--neutralTertiaryAlt)}html[dir] .customScrollBar::-webkit-scrollbar-thumb:hover,html[dir] body::-webkit-scrollbar-thumb:hover{background-color:#98a3a6}.customScrollBar::-webkit-scrollbar-thumb:vertical,body::-webkit-scrollbar-thumb:vertical{min-height:50px}.customScrollBar::-webkit-scrollbar-thumb:horizontal,body::-webkit-scrollbar-thumb:horizontal{min-width:50px}#app{height:100%;width:100%;overflow:hidden}.displayNone{display:none!important}.visibilityHidden{visibility:hidden}html[dir] .backgroundColorNeutralLight{background-color:var(--neutralLight)}html[dir=ltr] .monPersonaMarginThreeColumn,html[dir=ltr] .personaMarginThreeColumn,html[dir=ltr] .personaMarginThreeColumnCondensedView{padding:0 12px 0 8px}html[dir=rtl] .monPersonaMarginThreeColumn,html[dir=rtl] .personaMarginThreeColumn,html[dir=rtl] .personaMarginThreeColumnCondensedView{padding:0 8px 0 12px}html[dir] .personaMarginThreeColumn{padding-top:15px}html[dir] .monPersonaMarginThreeColumn{padding-top:5px}.screenReaderOnly{clip:rect(0 0 0 0);-webkit-clip-path:inset(100%);clip-path:inset(100%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}.disableTextSelection{-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.allowTextSelection{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;cursor:auto}.fadein200-appear{opacity:.01}.fadein200-appear.fadein200-appear-active{opacity:1}html[dir] .fadein200-appear.fadein200-appear-active{-webkit-transition:opacity .2s ease-in;transition:opacity .2s ease-in}html[dir=rtl] .flipForRtl{-webkit-transform:scaleX(-1);transform:scaleX(-1)}@font-face{font-family:EmojiFont;src:local("Apple Color Emoji"),local("Segoe UI Emoji"),local("NotoColorEmoji"),local("Android Emoji"),local("Segoe UI Symbol"),local("EmojiSymbols");unicode-range:U+200d,U+203c,U+2049,U+2122,U+2139,U+2194-2199,U+21a9-21aa,U+231a-231b,U+2328,U+23cf,U+23e9-23f3,U+23f8-23fa,U+24c2,U+25aa-25ab,U+25b6,U+25c0,U+25fb-25fe,U+2600-2604,U+260e,U+2611,U+2614-2615,U+2618,U+261d,U+2620,U+2622-2623,U+2626,U+262a,U+262e-262f,U+2638-263a,U+2640,U+2642,U+2648-2653,U+2660,U+2663,U+2665-2666,U+2668,U+267b,U+267f,U+2692-2697,U+2699,U+269b-269c,U+26a0-26a1,U+26aa-26ab,U+26b0-26b1,U+26bd-26be,U+26c4-26c5,U+26c8,U+26ce,U+26cf,U+26d1,U+26d3-26d4,U+26e9-26ea,U+26f0-26f5,U+26f7-26fa,U+26fd,U+2702,U+2705,U+2708-2709,U+270a-270b,U+270c-270d,U+270f,U+2712,U+2714,U+2716,U+271d,U+2721,U+2728,U+2733-2734,U+2744,U+2747,U+274c,U+274e,U+2753-2755,U+2757,U+2763-2764,U+2795-2797,U+27a1,U+27b0,U+27bf,U+2934-2935,U+2b05-2b07,U+2b1b-2b1c,U+2b50,U+2b55,U+3030,U+303d,U+3297,U+3299,U+fe0f,U+1f000-1f9ff}@font-face{font-family:EmojiFont;src:local("Apple Color Emoji"),local("Segoe UI Emoji"),local("NotoColorEmoji"),local("Android Emoji"),local("Segoe UI Symbol"),local("EmojiSymbols");unicode-range:U+200d,U+203c,U+2049,U+2122,U+2139,U+2194-2199,U+21a9-21aa,U+231a-231b,U+2328,U+23cf,U+23e9-23f3,U+23f8-23fa,U+24c2,U+25aa-25ab,U+25b6,U+25c0,U+25fb-25fe,U+2600-2604,U+260e,U+2611,U+2614-2615,U+2618,U+261d,U+2620,U+2622-2623,U+2626,U+262a,U+262e-262f,U+2638-263a,U+2640,U+2642,U+2648-2653,U+2660,U+2663,U+2665-2666,U+2668,U+267b,U+267f,U+2692-2697,U+2699,U+269b-269c,U+26a0-26a1,U+26aa-26ab,U+26b0-26b1,U+26bd-26be,U+26c4-26c5,U+26c8,U+26ce,U+26cf,U+26d1,U+26d3-26d4,U+26e9-26ea,U+26f0-26f5,U+26f7-26fa,U+26fd,U+2702,U+2705,U+2708-2709,U+270a-270b,U+270c-270d,U+270f,U+2712,U+2714,U+2716,U+271d,U+2721,U+2728,U+2733-2734,U+2744,U+2747,U+274c,U+274e,U+2753-2755,U+2757,U+2763-2764,U+2795-2797,U+27a1,U+27b0,U+27bf,U+2934-2935,U+2b05-2b07,U+2b1b-2b1c,U+2b50,U+2b55,U+3030,U+303d,U+3297,U+3299,U+fe0f,U+1f000-1f9ff;font-weight:600}html[dir] mark{background-color:#fff100}',""]),t.locals={"ms-Fabric--isFocusHidden":"ms-Fabric--isFocusHidden","ms-Callout-container":"ms-Callout-container",noPrint:"noPrint",customScrollBar:"customScrollBar",app:"app",displayNone:"displayNone",visibilityHidden:"visibilityHidden",backgroundColorNeutralLight:"backgroundColorNeutralLight",monPersonaMarginThreeColumn:"monPersonaMarginThreeColumn",personaMarginThreeColumn:"personaMarginThreeColumn",personaMarginThreeColumnCondensedView:"personaMarginThreeColumnCondensedView",screenReaderOnly:"screenReaderOnly",disableTextSelection:"disableTextSelection",allowTextSelection:"allowTextSelection","fadein200-appear":"fadein200-appear","fadein200-appear-active":"fadein200-appear-active",flipForRtl:"flipForRtl"}},3410:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(38);function o(){return Object(r.a)().SessionSettings.UserEmailAddress}},3430:function(e,t,n){"use strict";n(2784),n(2785),n(2786),n(2787)},3434:function(e,t,n){"use strict";var r=n(3108);n.d(t,"a",(function(){return r.a}))},3435:function(e,t,n){"use strict";n(3430),n(2806);var r=n(2483);n.d(t,"a",(function(){return r.a}))},3441:function(e){e.exports=JSON.parse('{"deleteItem":"Epa"}')},3453:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return f}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(4),n.e(8),n.e(10),n.e(12),n.e(397)]).then(n.bind(null,5983))),i=new r.a(o,e=>e.loadCLPUserLabels),a=(new r.a(o,e=>e.addAuditActionToViewState),new r.b(o,e=>e.showJustificationModal)),s=new r.a(o,e=>e.loadItemCLPInfo),c=new r.b(o,e=>e.updateItemCLPInfo),u=new r.b(o,e=>e.logReadCLPLabel),l=new r.b(o,e=>e.triggerCLPAutoLabeling),d=(new r.b(o,e=>e.constructCLPAuditAction),Object(r.d)(o,e=>e.CLPSubjectHeaderLabel)),f=Object(r.d)(o,e=>e.CLPMandatoryLabelModal)},3457:function(e,t,n){"use strict";var r=n(47),o=n(2519),i=n(296);t.a=function(){const{clpLabels:e}=o.b;return Object(r.j)("cmp-clp")&&e.length>0&&e.some(e=>e.isLabelEnabled)&&!Object(i.a)()}},347:function(e,t,n){"use strict";var r=n(366),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r.a?r.a.toStringTag:void 0;var c=function(e){var t=i.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[s]=n:delete e[s]),o},u=Object.prototype.toString;var l=function(e){return u.call(e)},d="[object Null]",f="[object Undefined]",p=r.a?r.a.toStringTag:void 0;t.a=function(e){return null==e?void 0===e?f:d:p&&p in Object(e)?c(e):l(e)}},349:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var r,o=n(68);!function(e){e[e.Query=0]="Query",e[e.Mutation=1]="Mutation",e[e.Subscription=2]="Subscription"}(r||(r={}));var i=new Map;function a(e){var t;switch(e){case r.Query:t="Query";break;case r.Mutation:t="Mutation";break;case r.Subscription:t="Subscription"}return t}function s(e){var t,n,a=i.get(e);if(a)return a;Object(o.b)(!!e&&!!e.kind,34);var s=e.definitions.filter((function(e){return"FragmentDefinition"===e.kind})),c=e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&"query"===e.operation})),u=e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})),l=e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&"subscription"===e.operation}));Object(o.b)(!s.length||c.length||u.length||l.length,35),Object(o.b)(c.length+u.length+l.length<=1,36),n=c.length?r.Query:r.Mutation,c.length||u.length||(n=r.Subscription);var d=c.length?c:u.length?u:l;Object(o.b)(1===d.length,37);var f=d[0];t=f.variableDefinitions||[];var p={name:f.name&&"Name"===f.name.kind?f.name.value:"data",type:n,variables:t};return i.set(e,p),p}},3493:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="MailRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M2 6.04V11c0 1.1.9 2 2 2h8a2 2 0 002-2V5a2 2 0 00-2-2H4a2 2 0 00-2 2v1.04zM4 4h8a1 1 0 011 1v.74l-5 2.7-5-2.7V5a1 1 0 011-1zM3 6.88l4.76 2.56a.5.5 0 00.48 0L13 6.88V11a1 1 0 01-1 1H4a1 1 0 01-1-1V6.88z"})),displayName:"MailRegular"});Object(o.registerIcons)({icons:{MailRegular:r.createElement(a,null)}})},3533:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(453),s=n(538),c=n(48),u=n(235),l=n(50),d=n(657),f=n(503),p=n(186),m=function(e,t,n){for(var r=0,o=e;r<o.length;r++){var i=o[r];n[t.register(i,!0)]=i}},h=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];e.unregister(t[o],o,!0),delete t[o]}},g=function(e){var t=d.a.getInstance(),n=e.className,r=e.overflowItems,a=e.keytipSequences,s=e.itemSubMenuProvider,c=e.onRenderOverflowButton,u=Object(p.a)({}),l=i.useCallback((function(e){return s?s(e):e.subMenuProps?e.subMenuProps.items:void 0}),[s]),g=i.useMemo((function(){var e=[],n=[];return a?null==r||r.forEach((function(r){var i,s=r.keytipProps;if(s){var c={content:s.content,keySequences:s.keySequences,disabled:s.disabled||!(!r.disabled&&!r.isDisabled),hasDynamicChildren:s.hasDynamicChildren,hasMenu:s.hasMenu};s.hasDynamicChildren||l(r)?c.onExecute=t.menuExecute.bind(t,a,null===(i=null==r?void 0:r.keytipProps)||void 0===i?void 0:i.keySequences):c.onExecute=s.onExecute,e.push(c);var u=Object(o.__assign)(Object(o.__assign)({},r),{keytipProps:Object(o.__assign)(Object(o.__assign)({},s),{overflowSetSequence:a})});null==n||n.push(u)}else null==n||n.push(r)})):n=r,{modifiedOverflowItems:n,keytipsToRegister:e}}),[r,l,t,a]),v=g.modifiedOverflowItems;return function(e,t,n){var r=Object(f.a)(e);i.useEffect((function(){r&&(h(n,r),m(t,n,e))})),i.useEffect((function(){return m(t,n,e),function(){h(n,e)}}),[])}(u,g.keytipsToRegister,t),i.createElement("div",{className:n},c(v))},v=Object(s.a)(),y=i.forwardRef((function(e,t){var n=i.useRef(null),r=Object(a.a)(n,t);!function(e,t){i.useImperativeHandle(e.componentRef,(function(){return{focus:function(){var e=!1;return t.current&&(e=Object(c.c)(t.current)),e},focusElement:function(e){var n=!1;return!!e&&(t.current&&Object(u.a)(t.current,e)&&(e.focus(),n=document.activeElement===e),n)}}}),[t])}(e,n);var s=e.items,d=e.overflowItems,f=e.className,p=e.styles,m=e.vertical,h=e.role,y=e.overflowSide,b=void 0===y?"end":y,O=e.onRenderItem,S=v(p,{className:f,vertical:m}),C=!!d&&d.length>0;return i.createElement("div",Object(o.__assign)({},Object(l.j)(e,l.h),{role:h||"group","aria-orientation":"menubar"===h?!0===m?"vertical":"horizontal":void 0,className:S.root,ref:r}),"start"===b&&C&&i.createElement(g,Object(o.__assign)({},e,{className:S.overflowButton})),s&&s.map((function(e,t){return i.createElement("div",{className:S.item,key:e.key,role:"none"},O(e))})),"end"===b&&C&&i.createElement(g,Object(o.__assign)({},e,{className:S.overflowButton})))}));y.displayName="OverflowSet";var b={flexShrink:0,display:"inherit"};n.d(t,"a",(function(){return O}));var O=Object(r.a)(y,(function(e){var t=e.className;return{root:["ms-OverflowSet",{position:"relative",display:"flex",flexWrap:"nowrap"},e.vertical&&{flexDirection:"column"},t],item:["ms-OverflowSet-item",b],overflowButton:["ms-OverflowSet-overflowButton",b]}}),void 0,{scope:"OverflowSet"})},3538:function(e,t,n){"use strict";var r=n(47),o=n(283),i=n(5),a=n(610),s=n(3164),c=n(52),u=n(159),l=n(158),d=n(404),f=n(36),p=n(83),m=n(638);const h="owsserver",g="owsapi";var v=n(2),y=n(160),b=n(161),O=n(10);n.d(t,"g",(function(){return A})),n.d(t,"c",(function(){return I})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return E})),n.d(t,"f",(function(){return T})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return M}));const S=2048;var C=null;function A(e,t,n,o,i,s,c,u,l){const f="object"==typeof n&&n.customHeaders||c,p=f?Object.keys(f).reduce((e,t)=>(e[t.toLowerCase()]=f[t],e),{}):void 0;let m="object"==typeof n?Object.assign(Object.assign({},n),{customHeaders:p}):{returnFullResponse:n,correlationId:i,requestObject:s,customHeaders:p,throwServiceError:u,includeCredentials:l};if(!m.customHeaders||!m.customHeaders.authorization){void 0===m.includeCredentials&&(m.includeCredentials=!Object(r.j)("auth-authzHeaderNoCookies"));let n=Object(a.n)(),[i,s]=Object(d.getAccessTokenforResourceAsLazy)(n,"OwsGateway");return i?_(e,t,m,o,i):s.then(n=>_(e,t,m,o,n))}return _(e,t,m,o)}function _(e,t,n,d,A){var _;const{returnFullResponse:I,correlationId:x,requestObject:E,customHeaders:T,throwServiceError:w,sendPayloadAsBody:M,includeCredentials:k}=n;let j=new Headers;j.append("X-OWA-CANARY",Object(c.a)()),j.append("X-MS-AppName","owa-react"+Object(a.r)()),j.set("X-OWA-SessionId",Object(v.N)());const P={n:Object(u.a)().toString()};x&&(j.append("client-request-id",x),P.cri=x),T&&Object.keys(T).forEach(e=>{j.append(e,T[e])});const R=Object(p.b)();if(R&&(j.append(p.a,R),P.cv=R),A){const e="Authorization";if(A.length>0&&"msauth1.0"===(null===(_=null==A?void 0:A.split(" ")[0])||void 0===_?void 0:_.toLowerCase()))j.append(e,A);else{if(Object(r.j)("fwk-devTools")){var N=A.split(".");3==N.length&&0!==N[2].length||f.d(`BearerTokenIncomplete ${N.length}`)}j.append(e,`Bearer  ${A}`)}}let D={method:t,credentials:!1!==k?"same-origin":"omit",body:n.requestBody,headers:j};if(E){j.append("Content-Type","application/json");const n=JSON.stringify(E),o=e.search(/ows\/|owa\//i)>=0;if(Object(r.j)("fwk-emptyPost")&&o&&"POST"==t&&!M){const e=encodeURIComponent(n);e.length<S?j.append("X-OWA-UrlPostData",e):D.body=n}else D.body=n}Object(y.a)(j),Object(b.a)(j);const F=function(e){const t=new RegExp(/\bows\//,"i");if(e.match(t)){let t=e.split("/");if(t.length>3&&"api"==t[1]||t.length>2){let e="api"==t[1]?t[3]:t[2];return e=null==e?void 0:e.split("?")[0],e}}return null}(e);if(null!=F){const t=Object(r.j)("fwk-owsprimecosmic-everything")||function(e){const t=["ActivityFeed","AdsTargetingOptOutController","Amp","AsgSmsProxy","CalendarIcons","CloudCacheConfig","FloodGateSurvey","getstarted","linkedin","OutlookOptions","outlookfavorites","ScenarioSettings","SchoolCalendars","webpushsubscriptions"];if(Object(r.j)("fwk-owsprimecosmic-selectedApis"))return t.indexOf(e)>-1;return!1}(F);if(t){const t=new RegExp(/\bows\//,"i");e=e.replace(t,"owsprime/")}null==d&&(d=t?"OWSPrimeCosmic"+F:"OWSPrime"+F)}let L=async function(e,t){if(!t||!t["x-anchormailbox"]){let t=Object(O.a)().getAnchorMailbox?await Object(O.a)().getAnchorMailbox():Object(s.a)();t&&t.length>0&&(e.headers.append("x-anchormailbox",t),e.headers.append("X-RoutingParameter-SessionKey",t))}return e}(D,T);const U=function(e,t){var n=function(e,t){var n=Object(a.x)(e,t),r=n.split("/");r.length>0&&("ows"==r[0]||"OutlookGateway"==r[0])&&(r[0]=Object(a.g)(r[0]),n=r.join("/"));return Object(a.a)(n)}(Object(r.j)("fwk-proxyOwsPrime")?"/OutlookGateway/":"/",e),o=Object(a.n)()+n;if(Object(r.j)("fwk-devTools")&&Object(i.f)(h)&&(Object(i.c)(g)==e||!Object(i.f)(g))&&(null==C&&(C=confirm(`A query param '${h}' is set to redirect some of calls to '${Object(i.c)(h)}'.\n\nThose calls contain PII. If this is not intentional, click 'Cancel' below or remove the queryparam and reload the page.`)),C)){var s=e.split("/");s.length>0&&("ows"==s.shift()||"owsprime"==s.shift())&&(e=s.join("/")),o=Object(i.c)(h)+"/"+e}return Object(a.v)(o,t)}(e,P),B=Object(l.a)(U,L);return Object(m.a)(D,n,B,d,U),B.then(n=>{if(I)return n;if(Object(o.a)(n.status))return n.text().then(e=>e?JSON.parse(e):{});throw new Error(`${t} request to ${e} failed, http error:${n.status}`)}).catch(e=>{if(f.h.warn(e),w){throw{stack:e.stack,message:e.message,correlationVector:R,correlationId:n.correlationId,networkError:!0}}return[]})}function I(e,t){var n,r;let o="OWSGateway";try{let e=null===(r=null===(n=JSON.parse(t))||void 0===n?void 0:n[0])||void 0===r?void 0:r.operationName;null!=e&&(o=o+"."+e)}catch(e){}return A(e,"POST",{requestBody:t,customHeaders:{"Content-Type":"application/json"},returnFullResponse:!0},o)}function x(e,t,n,r,o,i,a,s,c,u){return A(e,"POST",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:o,throwServiceError:i,sendPayloadAsBody:a,includeCredentials:s,datapoint:u},c)}function E(e,t,n,r,o,i,a,s){return A(e,"PATCH",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:o,throwServiceError:i,includeCredentials:a},s)}function T(e,t,n,r,o,i,a,s){return A(e,"PUT",r,a,n,t,o,i,s)}function w(e,t,n,r,o,i,a){return A(e,"GET",n,a,t,void 0,r,o,i)}function M(e,t,n,r,o,i,a,s){return A(e,"DELETE",{returnFullResponse:r,correlationId:n,requestObject:t,customHeaders:o,throwServiceError:i,includeCredentials:a},s)}},3572:function(e,t,n){"use strict";n(4827);function r(e,t,n,r){return Telemetry.PrivacyRules.GetAssetId(OSF.StoreType.Exchange,e,t,n,r)}var o=n(2),i=n(6),a=n(7005),s=n.n(a);n.d(t,"a",(function(){return r})),OSF.getLocalizedStringsFilePath=function(){let e=Object(o.I)()+"resources/locale/osfruntime/",t=Object(i.f)()||"en";return e+(s.a[t]||"en-us")+"/jscript/"},OSF.getManifestHostType=function(){},OSF.AppTelemetry={get enableTelemetry(){return!0}}},3643:function(e,t,n){"use strict";var r=function(){return{tenantTokens:["56468f6991c348029c6bba403b444607-7f5d6cd1-7fbe-4ab1-be03-3b2b6aeb3eb4-7696"]}},o=n(1785),i=n(71),a=n(6),s=n(1810),c=n(2),u=n(3572);function l(e,t,n,r){return Object(u.a)(e,t,n,r)}const d=(e,t,n,u,d,f,p)=>{let m=function(e){const t=Object(o.c)(e);if(null==t?void 0:t.isSharedItem)return t.isSharedItem();return!1}(n),h=!!Object(s.N)(t);if(function(e,t,n,o,u,d,f,p,m){let h,g;p&&(h=p.getExecutionInitTime(),g=p.getExecutionStartTime());const v=new i.b("ExtAddinLaunched",r());v.addCustomData({id:l(t.get_MarketPlaceAssetId(),t.get_ExtensionId(),t.get_ProviderName(),t.get_TypeString()),name:null==t?void 0:t.get_ExtensionDisplayName(),owa_1:Object(c.m)(),owa_2:Object(s.B)(n),owa_3:o,lang:Object(a.e)(),owa_4:null==t?void 0:t.get_Type(),errorCode:u,delegate:d,isAutoRun:f,executionInitTime:h,executionStartTime:g,controlId:m}),e?v.end():v.endWithError("Timeout",new Error("Add-in failed to load with code: "+u))}(e,t,n,u,p,m,h,d,f),e&&m&&function(e,t){const n=new i.b("ExtDelegateAddinLaunched",r());n.addCustomData({id:l(e.get_MarketPlaceAssetId(),e.get_ExtensionId(),e.get_ProviderName(),e.get_TypeString()),name:e.get_ExtensionDisplayName(),owa_1:Object(c.m)(),owa_2:Object(s.B)(t)}),n.end()}(t,n),e&&h){let e=function(e){return e.getLaunchEventType()}(t);!function(e,t,n,o,a){let s,c;o&&(s=o.getQueuePushTime(),c=o.getQueuePopTime());const u=new i.b("ExtAutoRunAddinLaunched",r());u.addCustomData({id:l(e.get_MarketPlaceAssetId(),e.get_ExtensionId(),e.get_ProviderName(),e.get_TypeString()),name:e.get_ExtensionDisplayName(),launchEventType:n,autoRunQueuePushTimeTime:s,autorunQueuePopTime:c,controlId:a}),u.end()}(t,0,e,d,f)}};const f=9e5;function p(){const e=r();return e.timeout=f,new i.b("ExtItemSendEvent",e)}function m(e,t){e.addCustomData({owa_1:t}),e.end()}function h(e,t,n){e.addCustomData({reason:g(t),id:l(n.get_MarketPlaceAssetId(),n.get_ExtensionId(),n.get_ProviderName(),n.get_TypeString()),name:n.get_ExtensionDisplayName(),module:Object(c.m)()}),e.end()}function g(e){if(e.status===s.d.Success)return e.allowEvent?4:2;switch(e.status){case s.d.TimedOut:return 16;case s.d.FunctionNotFound:return 8;default:return 32}}var v=n(8583),y=n(4956),b=n(1797),O=n(47);const S="addin";var C=n(282);function A(e,t,n,r){e.data["Data.SDX.AppState"]=P(n),e.data["Data.SDX.LaunchReason"]=function(e,t){if(Object(s.R)(e.get_ExtensionId(),t)||Object(y.d)(e)||Object(s.N)(e))return"Auto";return"Manual"}(t,r),e.data["Data.SDX.CommandPlacement"]=function(e,t,n){var r;if(Object(s.R)(e.get_ExtensionId(),n))return"OnSend";if(Object(y.d)(e))return"Persistent";if(Object(s.N)(e))return"LaunchEvent";if(e.detectedEntity)return"Contextual";const i=Object(o.c)(t);return(null===(r=null==i?void 0:i.isAddinPinned)||void 0===r?void 0:r.call(i,e.get_ExtensionId()))?"Ribbon":"Overflow"}(t,n,r),e.data["Data.SDX.ActionType"]=function(e){switch(Object(s.s)(e)){case 2:return"ShowTaskpane";case 3:return"ExecuteFunction";case 1:return"Contextual";case 5:return"Dialog";case 4:return"Unknown"}}(r),e.data["Data.SDX.AppInstallOrigin"]=N(t.get_OriginString()),e.data["Data.SDX.FeatureFlags"]=D()}function _(e,t,n,r){e.data["Data.SDX.AppState"]=P(n),e.data["Data.SDX.AppInstallOrigin"]=N(t.get_OriginString()),e.data["Data.SDX.LaunchEventType"]=t.getLaunchEventType(),e.data["Instance.Id"]=r}function I(e,t){const n=Object(s.v)(t);n&&(e.data["Data.SDX.AppInstallOrigin"]=N(n.OriginString),e.data["Data.SDX.Id"]=l(n.MarketplaceAssetID,n.Id,n.ProviderName,n.TypeString)),e.data["Data.SDX.FeatureFlags"]=D()}function x(e,t,n,r){e.data["Data.SDX.AppState"]=j(r);const o=Object(s.v)(t);o&&(e.data["Data.SDX.AppInstallOrigin"]=N(o.OriginString),e.data["Data.SDX.CommandPlacement"]=n?"Ribbon":"Overflow",e.data["Data.SDX.Id"]=l(o.MarketplaceAssetID,o.Id,o.ProviderName,o.TypeString)),e.data["Data.SDX.FeatureFlags"]=D()}function E(e,t,n,r,o){e.data["Data.SDX.AppState"]=j(o);const i=Object(s.v)(t);i&&(e.data["Data.SDX.AppInstallOrigin"]=N(i.OriginString),e.data["Data.SDX.Id"]=l(i.MarketplaceAssetID,i.Id,i.ProviderName,i.TypeString)),e.data["Data.AppTeachingUICalloutAction"]=function(e){switch(e){case"Show":return"Show";case"ClickOnClose":return"ClickOnClose";case"ClickOnGotIt":return"ClickOnGotIt";case"ClickOnCustomize":return"ClickOnCustomize";case"MissNoAnchor":return"MissNoAnchor";case"MissNotSelected":return"MissNotSelected";case"ClickOnSettings":return"ClickOnSettings";default:return Object(C.a)(e)}}(r),e.data["Data.AppTeachingUICalloutGoal"]=function(e){switch(e){case"NewAdminDeployment":return"NewAdminDeployment";case"Awareness":return"Awareness";case"EMOOffOrUnknown":return"EMOOffOrUnknown";case"EMOOn":return"EMOOn";default:return Object(C.a)(e)}}(n),e.data["Data.SDX.FeatureFlags"]=D()}function T(e,t,n){e.data["Data.SDX.AppState"]=j(n);const r=Object(s.v)(t);r&&(e.data["Data.SDX.AppInstallOrigin"]=N(r.OriginString),e.data["Data.SDX.Id"]=l(r.MarketplaceAssetID,r.Id,r.ProviderName,r.TypeString)),e.data["Data.SDX.FeatureFlags"]=D()}function w(e,t,n){e.data["Data.CustomizeActionPlacementGoal"]=function(e){switch(e){case"OverFlowMenu":return"OverFlowMenu";case"UICallout":return"UICallout";default:return Object(C.a)(e)}}(n),e.data["Data.CustomizeActionStatusGoal"]=function(e){switch(e){case"Highlighted":return"Highlighted";case"Clicked":return"Clicked";case"HighlightedAndClicked":return"HighlightedAndClicked";default:return Object(C.a)(e)}}(t),e.data["Data.SDX.FeatureFlags"]=D()}function M(){switch(Object(c.E)()){case"Dogfood":return"Dogfood";case"Microsoft":return"Microsoft";default:return"Production"}}function k(){const e=Object(v.a)();return"outlookCom"===e||"gmail"===e?"Consumer":"Commercial"}function j(e){switch(e){case b.a.MessageRead:return"MessageRead";case b.a.MessageCompose:return"MessageCompose";case b.a.AppointmentAttendee:return"AppointmentAttendee";case b.a.AppointmentOrganizer:return"AppointmentOrganizer";default:return"Unknown"}}function P(e){const t=Object(o.c)(e);return j(null==t?void 0:t.mode)}function R(){switch(Object(v.a)()){case"outlookCom":return"MsaPuid";case"office365":return"OrgIdPuid";default:return"Unknown"}}function N(e){return"Organization"===e?"Organization":"User"===e?"User":"Default"===e?"Default":"None"}function D(){return Object(O.g)(S).sort().join(",")}const F="db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",L=1755;async function U(e){const t=$({eventName:"Office.Extensibility.Host.AppInstall",telemetryProperties:{ariaTenantToken:F,nexusTenantToken:L},eventFlags:{dataCategories:ee,diagnosticLevel:te},timestamp:Date.now()});I(t,e),t.iKey&&await i.l.importAndExecute(t.iKey,t)}async function B(e,t,n){const r=$({eventName:"Office.Extensibility.Host.AppPinning",telemetryProperties:{ariaTenantToken:F,nexusTenantToken:L},eventFlags:{dataCategories:ee,diagnosticLevel:te},timestamp:Date.now()});x(r,e,t,n),r.iKey&&await i.l.importAndExecute(r.iKey,r)}async function H(e,t,n,r){const o=$({eventName:"Office.Extensibility.Host.AppTeachingUICallout",telemetryProperties:{ariaTenantToken:F,nexusTenantToken:L},eventFlags:{dataCategories:ee,diagnosticLevel:te},timestamp:Date.now()});E(o,e,t,n,r),o.iKey&&await i.l.importAndExecute(o.iKey,o)}async function V(e,t,n){const r=$({eventName:"Office.Extensibility.Host.LaunchEvent",telemetryProperties:{ariaTenantToken:F,nexusTenantToken:L},eventFlags:{dataCategories:ee,diagnosticLevel:te},timestamp:Date.now()});_(r,e,t,n),r.iKey&&await i.l.importAndExecute(r.iKey,r)}async function z(e,t){const n=$({eventName:"Office.Extensibility.Host.AppHighlighted",telemetryProperties:{ariaTenantToken:F,nexusTenantToken:L},eventFlags:{dataCategories:ee,diagnosticLevel:te},timestamp:Date.now()});T(n,e,t),n.iKey&&await i.l.importAndExecute(n.iKey,n)}async function W(e,t){const n=$({eventName:"Office.Extensibility.Host.CustomizeActionButtonAction",telemetryProperties:{ariaTenantToken:F,nexusTenantToken:L},eventFlags:{dataCategories:ee,diagnosticLevel:te},timestamp:Date.now()});w(n,e,t),n.iKey&&await i.l.importAndExecute(n.iKey,n)}var G=n(7713),q=n(2875),K=n(6037),X=n(57),Q=n(99);let J=null;function Y(){if(!J){const e=Object(X.g)();let t=[...G.a.Office.System.User.getFields("User",{primaryIdentityHash:e.SessionSettings.UserPuid,primaryIdentitySpace:R(),isAnonymous:!1}),q.d("App.Name","Outlook"),q.d("App.Platform","Web"),q.d("App.Version",Object(c.u)()),q.d("Release.AudienceGroup",M()),q.d("Release.Audience",Object(c.E)()),q.d("User.TenantId",e.SessionSettings.ExternalDirectoryTenantGuid),q.d("User.TenantGroup",k()),q.d("Browser.Name",Object(Q.a)().browser),q.d("Browser.Version",Object(Q.a)().browserVersion.join(".")),q.d("Session.Id",Object(c.N)()),q.d("Data.ExEnv",Object(c.E)()),q.d("Device.OsBuild","N/A"),q.d("Device.OsVersion","N/A")];J=new K.a(t,{enableCustomerContent:!0})}return J}function Z(e){return Y().getOneDSCustomerContent(e)}function $(e){return Y().getOneDSTelemetryEvent(e)}const ee=2,te=110;n.d(t,"p",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return m})),n.d(t,"c",(function(){return A})),n.d(t,"e",(function(){return I})),n.d(t,"f",(function(){return x})),n.d(t,"g",(function(){return E})),n.d(t,"i",(function(){return _})),n.d(t,"d",(function(){return T})),n.d(t,"h",(function(){return w})),n.d(t,"r",(function(){return U})),n.d(t,"s",(function(){return B})),n.d(t,"t",(function(){return H})),n.d(t,"v",(function(){return V})),n.d(t,"q",(function(){return z})),n.d(t,"u",(function(){return W})),n.d(t,"n",(function(){return Z})),n.d(t,"o",(function(){return $})),n.d(t,"a",(function(){return ee})),n.d(t,"b",(function(){return te})),n.d(t,"m",(function(){return l}))},365:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1),o=n(8),i=n(127),a=Object(i.c)((function(e,t){var n,i,a,s,c,u,l,d,f,p,m,h,g,v=e.effects,y=e.palette,b=e.semanticColors,O={left:-2,top:-2,bottom:-2,right:-2,border:"none"},S={position:"absolute",width:1,right:31,top:8,bottom:8},C={splitButtonContainer:[Object(o.getFocusStyle)(e,{highContrastStyle:O,inset:2}),{display:"inline-flex",selectors:{".ms-Button--default":{borderTopRightRadius:"0",borderBottomRightRadius:"0",borderRight:"none"},".ms-Button--primary":{borderTopRightRadius:"0",borderBottomRightRadius:"0",border:"none",selectors:(n={},n[o.HighContrastSelector]=Object(r.__assign)({color:"WindowText",backgroundColor:"Window",border:"1px solid WindowText",borderRightWidth:"0"},Object(o.getHighContrastNoAdjustStyle)()),n)},".ms-Button--primary + .ms-Button":{border:"none",selectors:(i={},i[o.HighContrastSelector]={border:"1px solid WindowText",borderLeftWidth:"0"},i)}}}],splitButtonContainerHovered:{selectors:{".ms-Button--primary":{selectors:(a={},a[o.HighContrastSelector]={color:"Window",backgroundColor:"Highlight"},a)},".ms-Button.is-disabled":{color:b.buttonTextDisabled,selectors:(s={},s[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},s)}}},splitButtonContainerChecked:{selectors:{".ms-Button--primary":{selectors:(c={},c[o.HighContrastSelector]=Object(r.__assign)({color:"Window",backgroundColor:"WindowText"},Object(o.getHighContrastNoAdjustStyle)()),c)}}},splitButtonContainerCheckedHovered:{selectors:{".ms-Button--primary":{selectors:(u={},u[o.HighContrastSelector]=Object(r.__assign)({color:"Window",backgroundColor:"WindowText"},Object(o.getHighContrastNoAdjustStyle)()),u)}}},splitButtonContainerFocused:{outline:"none!important"},splitButtonMenuButton:(l={padding:6,height:"auto",boxSizing:"border-box",borderRadius:0,borderTopRightRadius:v.roundedCorner2,borderBottomRightRadius:v.roundedCorner2,border:"1px solid "+y.neutralSecondaryAlt,borderLeft:"none",outline:"transparent",userSelect:"none",display:"inline-block",textDecoration:"none",textAlign:"center",cursor:"pointer",verticalAlign:"top",width:32,marginLeft:-1,marginTop:0,marginRight:0,marginBottom:0},l[o.HighContrastSelector]={".ms-Button-menuIcon":{color:"WindowText"}},l),splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},S),{selectors:(d={},d[o.HighContrastSelector]={backgroundColor:"WindowText"},d)}),splitButtonDividerDisabled:Object(r.__assign)(Object(r.__assign)({},S),{selectors:(f={},f[o.HighContrastSelector]={backgroundColor:"GrayText"},f)}),splitButtonMenuButtonDisabled:{pointerEvents:"none",border:"none",selectors:(p={":hover":{cursor:"default"},".ms-Button--primary":{selectors:(m={},m[o.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},m)},".ms-Button-menuIcon":{selectors:(h={},h[o.HighContrastSelector]={color:"GrayText"},h)}},p[o.HighContrastSelector]={color:"GrayText",border:"1px solid GrayText",backgroundColor:"Window"},p)},splitButtonFlexContainer:{display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"center",alignItems:"center"},splitButtonContainerDisabled:{outline:"none",border:"none",selectors:(g={},g[o.HighContrastSelector]=Object(r.__assign)({color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},Object(o.getHighContrastNoAdjustStyle)()),g)},splitButtonMenuFocused:Object(r.__assign)({},Object(o.getFocusStyle)(e,{highContrastStyle:O,inset:2}))};return Object(o.concatStyleSets)(C,t)}))},3658:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onAppHostHeaderStartSearch")},366:function(e,t,n){"use strict";var r=n(247).a.Symbol;t.a=r},369:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},3730:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="FlagRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M4 9V3h8.03l-1.94 2.7a.5.5 0 000 .6L12.03 9H4zm0 1h9a.5.5 0 00.4-.8L11.12 6l2.3-3.2A.5.5 0 0013 2H3.5a.5.5 0 00-.5.5v11a.5.5 0 001 0V10z"})),displayName:"FlagRegular"});Object(o.registerIcons)({icons:{FlagRegular:r.createElement(a,null)}})},3744:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(38),o=n(47);function i(){var e;return Object(o.j)("cmp-roaming-signature")&&!(null===(e=Object(r.a)().SessionSettings)||void 0===e?void 0:e.IsExplicitLogon)}},3746:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(38),o=n(296),i=n(57);function a(){var e;return Object(o.a)()?Object(i.t)():null===(e=Object(r.a)().SegmentationSettings)||void 0===e?void 0:e.Irm}},376:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(218);function o(e){const t=[];if(Object(r.a)().sources.forEach(n=>{n.sourceId===e?t.push({source:n}):n.sharedSources&&n.sharedSources.sources.forEach(r=>{r.sourceId===e&&t.push({source:r,hostingSourceId:n.sourceId})})}),t.length>1)throw new Error("Duplicate account found");return t[0]}function i(e){var t;return null===(t=o(e))||void 0===t?void 0:t.source}},3765:function(e,t,n){"use strict";function r(e){return void 0!==e.publicFolderId}n.d(t,"a",(function(){return r}))},3766:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));const r="X-OWA-SmimeInstalled",o="1",i="SmimeWithoutActiveX",a="message/rfc822",s="ErrorSmimeSendCancelled"},3767:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(5441);function o(e){var t,n,r;return e.isDirty||(null===(t=e.toRecipientWell)||void 0===t?void 0:t.isDirty)||(null===(n=e.ccRecipientWell)||void 0===n?void 0:n.isDirty)||(null===(r=e.bccRecipientWell)||void 0===r?void 0:r.isDirty)}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},377:function(e,t,n){"use strict";var r=n(192);var o=n(3),i=n(16);n.d(t,"b",(function(){return s}));let a={categoryIdToNameMap:{},categoryMenuViewState:{findText:"",isFocusInSearchBox:!1,shouldShowAllCategories:!1},categoryColorPickerViewState:{colorPickerTarget:null,shouldShowColorPicker:!1},colorCodeColorValueMap:{[r.a.None]:{primaryColor:"#CCCCCC",secondaryColor:"#A6A6A6",iconColor:"#000000",textColor:"#000000"},[r.a.Red]:{primaryColor:"#fce9ea",secondaryColor:"#F1919A",iconColor:"#E74856",textColor:"#D01B2A"},[r.a.Orange]:{primaryColor:"#fff1e0",secondaryColor:"#ffba66",iconColor:"#FF8C00",textColor:"#A35A00"},[r.a.Peach]:{primaryColor:"#fff5e8",secondaryColor:"#ffcd8f",iconColor:"#FFAB45",textColor:"#A35A00"},[r.a.YellowLight]:{primaryColor:"#fffde0",secondaryColor:"#fff766",iconColor:"#FFF100",textColor:"#7A7400"},[r.a.GreenLight]:{primaryColor:"#e9f9e8",secondaryColor:"#91e38d",iconColor:"#47D041",textColor:"#257E20"},[r.a.TealLight]:{primaryColor:"#e6f8f9",secondaryColor:"#83dde0",iconColor:"#30C6CC",textColor:"#1D797C"},[r.a.Olive]:{primaryColor:"#EEF5E4",secondaryColor:"#abcc7c",iconColor:"#73AA24",textColor:"#527A1A"},[r.a.BlueSky]:{primaryColor:"#e0f7fd",secondaryColor:"#66d7f7",iconColor:"#00BCF2",textColor:"#007899"},[r.a.PurpleLight]:{primaryColor:"#f0ecf6",secondaryColor:"#b7a2d4",iconColor:"#8764B8",textColor:"#7D57B2"},[r.a.Pink]:{primaryColor:"#fef2f7",secondaryColor:"#f8bfd9",iconColor:"#F495BF",textColor:"#D8186E"},[r.a.SteelLight]:{primaryColor:"#f3f5f6",secondaryColor:"#c6ced1",iconColor:"#A0AEB2",textColor:"#5E7373"},[r.a.SteelGrey]:{primaryColor:"#D0E0E2",secondaryColor:"#6693a0",iconColor:"#004B60",textColor:"#004B60"},[r.a.GreyLight]:{primaryColor:"#f6f5f5",secondaryColor:"#d0cecd",iconColor:"#B1ADAB",textColor:"#776E6E"},[r.a.GreyDark]:{primaryColor:"#D4D4D4",secondaryColor:"#9e9c9b",iconColor:"#5D5A58",textColor:"#5D5A58"},[r.a.Black]:{primaryColor:"#969696",secondaryColor:"#666666",iconColor:"#000000",textColor:"#000000"},[r.a.RedDark]:{primaryColor:"#C09BA4",secondaryColor:"#ac6d77",iconColor:"#750B1C",textColor:"#750B1C"},[r.a.OrangeDark]:{primaryColor:"#f9eae2",secondaryColor:"#df9670",iconColor:"#CA5010",textColor:"#B3480F"},[r.a.BrownMedium]:{primaryColor:"#f5ece2",secondaryColor:"#cda16e",iconColor:"#AB620D",textColor:"#9D590B"},[r.a.YellowDark]:{primaryColor:"#f7f3e0",secondaryColor:"#dac466",iconColor:"#C19C00",textColor:"#856A00"},[r.a.GreenDark]:{primaryColor:"#C8DACC",secondaryColor:"#669377",iconColor:"#004B1C",textColor:"#004B1C"},[r.a.TealDark]:{primaryColor:"#CEDCDE",secondaryColor:"#669396",iconColor:"#004B50",textColor:"#004B50"},[r.a.OliveDark]:{primaryColor:"#C3DAC3",secondaryColor:"#6da66d",iconColor:"#0B6A0B",textColor:"#0b6a0b"},[r.a.BlueDark]:{primaryColor:"#A6ACC4",secondaryColor:"#667996",iconColor:"#002050",textColor:"#002050"},[r.a.PurpleDark]:{primaryColor:"#B5ACC8",secondaryColor:"#84729c",iconColor:"#32145A",textColor:"#32145A"},[r.a.MagentaDark]:{primaryColor:"#D1B8D1",secondaryColor:"#9d669d",iconColor:"#5C005C",textColor:"#5C005C"}},pendingCategoryNamesMap:{},categoryDetails:new i.ObservableMap({}),isSearchFolderReady:!1,categoryDialogViewState:null,isApplyingCategoryOperation:!1,blockedCategoryNames:[]};const s=Object(o.createStore)("category",a);t.a=s()},380:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var s=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var l=0;l<u;++l){var d,f,p,m,h=e[l].replace(s,"%20"),g=h.indexOf(n);g>=0?(d=h.substr(0,g),f=h.substr(g+1)):(d=h,f=""),p=decodeURIComponent(d),m=decodeURIComponent(f),r(a,p)?o(a[p])?a[p].push(m):a[p]=[a[p],m]:a[p]=m}return a};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},381:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(a(e),(function(a){var s=encodeURIComponent(r(a))+n;return o(e[a])?i(e[a],(function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[a]))})).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var a=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},3811:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(2816);const i=Object(r.mutatorAction)("onInvalidAppNavigation",()=>{Object(o.a)().isInError=!0})},3829:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1774),o=n(1971);function i(e){const t=Object(r.a)();return(null==t?void 0:t.AttachmentDataProviderAvailable)&&!a()||e&&(null==t?void 0:t.GroupsOneDriveDataProviderAvailable)}const a=()=>{Object(o.j)()===o.c.NotLoaded&&o.l.import().then(e=>e(e=>{}));const e=Object(o.g)((0).toString());return!!e&&!e.name}},3839:function(e,t,n){"use strict";function r(e){return o(e)&&(2==(t=e).operation||t.toRecipientWell.recipients.some(e=>e.persona.EmailAddress.EmailAddress.toLowerCase()===t.groupId.toLowerCase()));var t}function o(e){return!!e.groupId}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},3892:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(47),o=n(132),i=n(3006);const a={Mail:!0,Calendar:!0,People:!0,FilesHub:!0,AppHost:!0};function s(e){return(Object(o.a)("moduleSwitch")||Object(r.j)("fwk-module-switch")||Object(i.a)())&&a[e]}function c(e,t){return s(e)&&s(t)}},3893:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);let o=Object(r.createStore)("leftRailStore",{selectedApp:null,enabledRailItems:[]});o()},3914:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(142),n.e(781)]).then(n.bind(null,6577)));let i=new r.a(o,e=>e.getTypeOfAttachment),a=new r.a(o,e=>e.getAllAttachments),s=new r.a(o,e=>e.getAttachmentContentHelper),c=new r.a(o,e=>e.prepareAddinCommunicationInPopout)},3940:function(e,t,n){"use strict";const r=32,o=126;function i(e){if(!e)return!1;for(const t of e){if(null==t||0===t.trim().length)return!1;let e=t.length;for(;e--;)if(t.charCodeAt(e)>o||t.charCodeAt(e)<r)return!1}return!0}function a(e){return!!e&&i(Object.keys(e))}var s,c;!function(e){e[e.Read=1]="Read",e[e.Create=2]="Create",e[e.DeleteOwn=4]="DeleteOwn",e[e.DeleteAll=8]="DeleteAll",e[e.EditOwn=16]="EditOwn",e[e.EditAll=32]="EditAll"}(s||(s={})),function(e){e.Base64="base64",e.Eml="eml",e.Url="url",e.Ical="iCalendar"}(c||(c={}));var u=n(2650),l=(n(2651),n(2585)),d=n(2649);const f=e=>{var t;let n={locationIdentifier:{}};return n.displayName=null!==(t=e.DisplayName)&&void 0!==t?t:"",e.PostalAddress&&"Resource"===e.PostalAddress.LocationSource&&e.PostalAddress.LocationUri?(n.emailAddress=e.PostalAddress.LocationUri,n.locationIdentifier.id=n.emailAddress,n.locationIdentifier.type=u.a.Room):(n.emailAddress="",n.locationIdentifier.id=n.displayName,n.locationIdentifier.type=u.a.Custom),n};function p(e){if(!e||e.length<=0)return!1;for(const t of e)if(t.id.trim().length<=0)return!1;return!0}n.d(t,"i",(function(){return i})),n.d(t,"h",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return u.a})),n.d(t,"a",(function(){return l.a})),n.d(t,"f",(function(){return l.b})),n.d(t,"c",(function(){return d.a})),n.d(t,"g",(function(){return f})),n.d(t,"j",(function(){return p}))},3951:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(3),o=n(2816);const i=Object(r.mutatorAction)("onSelectAppTab",(e,t)=>{Object(o.a)().selectedEntityId=e,t&&(Object(o.a)().selectedSubEntityId=t)})},3952:function(e,t,n){"use strict";var r=n(2816);t.a=()=>{var e;return{appId:null===(e=Object(r.a)().hostedApp)||void 0===e?void 0:e.appId,appManifest:Object(r.a)().hostedApp,entityId:Object(r.a)().selectedEntityId,subEntityId:Object(r.a)().selectedSubEntityId,subEntityLabel:Object(r.a)().subEntityLabel}}},3954:function(e){e.exports=JSON.parse('{"a":"wna"}')},3955:function(e){e.exports=JSON.parse('{"a":"xna"}')},3961:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="ArrowForwardRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M12.3 8L9.6 10.68a.5.5 0 00.64.77l.07-.06 3.56-3.57.05-.07.03-.06.02-.06V7.6a.5.5 0 00.02-.1v.07-.11l-.02-.09-.02-.06-.04-.08-.05-.07-3.55-3.55a.5.5 0 00-.77.64l.06.07L12.3 7H8c-3.52 0-5.89 1.98-6 4.8v.2a.5.5 0 001 0c0-2.27 1.8-3.9 4.74-4h4.56z"})),displayName:"ArrowForwardRegular"});Object(o.registerIcons)({icons:{ArrowForwardRegular:r.createElement(a,null)}})},3971:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"SingleRecipientType:#Exchange"},e)}n.d(t,"a",(function(){return r}))},402:function(e,t,n){"use strict";var r=n(565),o=n(570);t.a=function(e){return null!=e&&Object(o.a)(e.length)&&!Object(r.a)(e)}},4042:function(e,t,n){"use strict";var r=n(2816);t.a=()=>Object(r.a)().isInError},4043:function(e){e.exports=JSON.parse('{"a":"qna","c":"rna","e":"sna","b":"tna","d":"una"}')},4044:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="ArrowReplyRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M3.7 8l2.69 2.68a.5.5 0 01-.64.77l-.07-.06-3.56-3.57-.05-.07-.03-.06-.02-.06V7.6A.5.5 0 012 7.5v.07-.11l.02-.09.02-.06.04-.08.05-.07 3.55-3.55a.5.5 0 01.77.64l-.06.07L3.7 7H8c3.52 0 5.89 1.98 6 4.8v.2a.5.5 0 01-1 0c0-2.27-1.8-3.9-4.74-4H3.7l2.69 2.68L3.7 8z"})),displayName:"ArrowReplyRegular"});Object(o.registerIcons)({icons:{ArrowReplyRegular:r.createElement(a,null)}})},4052:function(e){e.exports=JSON.parse('{"a":"pna"}')},406:function(e,t,n){"use strict";t.a=function(e,t){return e===t||e!=e&&t!=t}},408:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(38),o=n(287),i=n(57);function a(e){let t;t=e&&Object(o.r)(e.userIdentity)?Object(i.h)(e.userIdentity):Object(r.a)();let n=null==t?void 0:t.MasterCategoryList;return(null==n?void 0:n.MasterList)||[]}},4103:function(e){e.exports=JSON.parse('{"a":"Ina"}')},4114:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(16);function o(){return{clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new r.ObservableMap,messageClassifications:new r.ObservableMap}}},4119:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(3363),o="Data.",i="zC.",a="f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",s="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function c(e,t,n){t&&t.forEach((function(t){if(!t.classification||4===t.classification||1===t.classification||n.customerContentEnabled&&32===t.classification){var r,a;switch(r=n.prependDataToken?t.name.substr(0,3)===i?i+o+t.name.substr(3):o+t.name:t.name,t.dataType){case 3:a=6;break;case 2:a=4;break;case 4:a=8;break;case 0:return void(e[r]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case 1:default:return void(e[r]=t.value)}var s={value:t.value,propertyType:a};e[r]=s}}))}function u(e,t){try{return e()}catch(e){return Object(r.a)(1,"1DS Sink",e),t}}},4149:function(e,t,n){"use strict";var r=n(3);var o=Object(r.createStore)("SurfaceActionsStore",{addinOptionSurfaceItems:{}})(),i=n(702),a=Object(i.action)("setAddinOptionSurfaceItems")((function(e){o.addinOptionSurfaceItems=e}));function s(e){return o.addinOptionSurfaceItems[e]}var c=n(6),u=n(5022),l=n(5425),d=n(4494),f=n(4761),p=n(6028),m=n(5864),h=n(4495),g=n(3441),v=n(4409),y=n(5642),b=n(4536),O=n(6029),S=n(6030),C=n(6031),A=n(4103),_=n(6032),I=n(6033),x=n(5296),E=n(3955),T=n(3954),w=n(4995),M=n(4043),k=n(4052),j=n(4994),P=n(5426),R=n(5865),N=n(6034),D=n(5866),F=n(5861),L=n(5635),U=n(5405),B=n(5862),H=n(5636),V=n(296),z=n(6267),W=n(5427);function G(e){switch(e){case"AddAttachment":case"AddClassicAttachment":return Object(c.b)(p.a);case"InsertLink":return Object(c.b)(p.b);case"AddInlineImage":return Object(c.b)(b.a);case"AddEmoji":return Object(c.b)(z.d);case"QuickUse":return Object(c.b)(z.r);case"ToggleRibbon":return Object(c.b)(y.a);case"SaveDraft":return Object(c.b)(N.a);case"InsertSignature":return Object(c.b)(O.a);case"ShowFrom":return Object(c.b)(L.showFrom);case"SetImportance":return Object(c.b)(F.setImportance);case"ShowMessageOptions":return Object(c.b)(B.showMessageOptions);case"SwitchBodyType":return Object(c.b)(H.switchToPlainTextMenuItem);case"SensitivityMenu":return Object(c.b)(D.a);case"ProtectMessage":return Object(c.b)(m.a);case"AccChecker":return Object(c.b)(u.accCheckerMenuItemText);case"ToggleDarkCompose":return Object(c.b)(z.y);case"ToggleDictation":return Object(c.b)(z.z);case"SetDictationLanguage":return Object(c.b)(z.v);case"ProofingOptions":return Object(c.b)(z.q);case"FluidHeroButton":return Object(c.b)(z.b);case"CustomizeActions":return Object(c.b)(z.c);case"MessageExtensions":return Object(c.b)(W.a);default:return""}}function q(e){switch(e){case"LikeUnlike":return Object(c.b)(z.h);case"SetReaction":return Object(c.b)(z.w);case"Reply":return Object(c.b)(E.a);case"ReplyAll":return Object(c.b)(T.a);case"Forward":return Object(c.b)(A.a);case"ForwardEmailAsAttachment":return Object(c.b)(z.e);case"ReplyByMeeting":return Object(c.b)(z.j);case"ReportAbuse":return Object(c.b)(R.a);case"Popout":return Object(c.b)(P.popoutsOpenInNewWindow);case"Delete":return Object(c.b)(z.g);case"MarkReadUnread":return Object(c.b)(M.a);case"FlagUnflag":return Object(c.b)(C.a);case"AssignPolicy":return Object(c.b)(f.a);case"AddToSafeSenders":return Object(c.b)(z.f);case"MarkJunkNotJunk":return Object(c.b)(I.a);case"MarkAsPhishing":return Object(c.b)(z.i);case"Block":return Object(c.c)(Object(c.b)(S.a),"");case"CreateRule":return Object(c.b)(h.a);case"Print":return Object(c.b)(x.a);case"Translate":return Object(c.b)(w.a);case"ShowInImmersiveReader":return Object(c.b)(U.a);case"ViewMessageSource":return Object(V.a)()?Object(c.b)(z.l):Object(c.b)(z.k);case"ToggleDarkMode":return Object(c.b)(_.a);case"ReplyByIM":return Object(c.b)(z.u);case"ReplyAllByIM":return Object(c.b)(z.t);case"ToggleAmp":return Object(c.b)(z.x);case"AddToBoard":return Object(c.b)(l.a);case"OtherReplyActions":return Object(c.b)(z.p);case"MessageSafety":return Object(c.b)(z.m);case"View":return Object(c.b)(z.A);case"CustomizeActions":return Object(c.b)(z.c);case"AdvancedActions":return Object(c.b)(z.a);case"Addins":return Object(c.b)(z.o);case"MessageExtensions":return Object(c.b)(W.a);default:return""}}function K(e){switch(e){case"None":return Object(c.b)(z.n);case"Delete":return Object(c.b)(g.deleteItem);case"Archive":return Object(c.b)(d.a);case"PinUnpin":return Object(c.b)(j.a);case"ReadUnread":return Object(c.b)(z.s);case"FlagUnflag":return Object(c.b)(v.a);case"Move":return Object(c.b)(k.a);default:return""}}var X=n(4289),Q=n(4293),J=n(6035),Y=n(3351),Z=n(3746),$=n(47),ee=n(2224),te=n(1686),ne=n(38),re=n(131),oe=n(175);function ie(){let e=[{key:"Reply",hideInGroup:!0,hideInSxS:!0},{key:"ReplyAll",hideInGroup:!1,hideInSxS:!0},{key:"Forward",hideInGroup:!1,hideInSxS:!0}];return e.push({key:"-",hideInGroup:!1,hideInSxS:!1},{key:"ReplyByMeeting",hideInGroup:!0,hideInSxS:!0},{key:"ForwardEmailAsAttachment",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"Delete",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1},{key:"MarkReadUnread",hideInGroup:!1,hideInSxS:!0},{key:"FlagUnflag",hideInGroup:!0,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object($.j)("fwk-skypeBusinessV2")&&e.push({key:"ReplyByIM",hideInGroup:!0,hideInSxS:!1},{key:"ReplyAllByIM",hideInGroup:!0,hideInSxS:!1},{key:"-",hideInGroup:!0,hideInSxS:!1}),Object(Y.a)()&&e.push({key:"AddToBoard",hideInGroup:!1,hideInSxS:!1},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(ne.a)().SessionSettings.IsShadowMailbox||(e.push({key:"AddToSafeSenders",hideInGroup:!0,hideInSxS:!0},{key:"MarkJunkNotJunk",hideInGroup:!0,hideInSxS:!0},{key:"MarkAsPhishing",hideInGroup:!0,hideInSxS:!0},{key:"Block",hideInGroup:!0,hideInSxS:!0}),Object($.j)("tri-reportAbuse")&&e.push({key:"ReportAbuse",hideInGroup:!Object(V.a)(),hideInSxS:!0}),e.push({key:"-",hideInGroup:!1,hideInSxS:!1})),Object(V.a)()||e.push({key:"AssignPolicy",hideInGroup:!1,hideInSxS:!0},{key:"-",hideInGroup:!1,hideInSxS:!1}),Object(ne.a)().SessionSettings.IsShadowMailbox||e.push({key:"CreateRule",hideInGroup:!0,hideInSxS:!0}),e.push({key:"Print",hideInGroup:!1,hideInSxS:!1}),Object($.j)("rp-inlineTranslation")&&Object($.j)("rp-inlineTranslationManual")&&e.push({key:"Translate",hideInGroup:!0,hideInSxS:!0}),Object(re.g)()&&e.push({key:"ToggleDarkMode",hideInGroup:!1,hideInSxS:!1}),e.push({key:"ShowInImmersiveReader",hideInGroup:!1,hideInSxS:!0}),e.push({key:"ViewMessageSource",hideInGroup:!1,hideInSxS:!0}),e.push({key:"Popout",hideInGroup:!1,hideInSxS:!0}),Object($.j)("rp-reactions")||Object(V.a)()||e.push({key:"LikeUnlike",hideInGroup:!1,hideInSxS:!0}),Object($.j)("rp-reactions")&&e.push({key:"SetReaction",hideInGroup:!1,hideInSxS:!0,hideInMailSurfaceSettings:!0}),Object($.j)("mos-messageExtensionsFlyout")&&e.push({key:"MessageExtensions",hideInGroup:!1,hideInSxS:!0,hideInMailSurfaceSettings:!0}),Object($.j)("rp-amp")&&Object(V.a)()&&e.push({key:"ToggleAmp",hideInGroup:!1,hideInSxS:!0}),e.push({key:"OtherReplyActions",hideInMailSurfaceSettings:!0},{key:"MessageSafety",hideInMailSurfaceSettings:!0},{key:"View",hideInMailSurfaceSettings:!0},{key:"CustomizeActions",hideInMailSurfaceSettings:!0},{key:"AdvancedActions",hideInMailSurfaceSettings:!0},{key:"Addins",hideInMailSurfaceSettings:!0}),e}function ae(){let e=[];return e.push({key:"AddAttachment",hideInGroup:!1}),e.push({key:"AddInlineImage",hideInGroup:!1}),Object(ee.b)(1)&&e.push({key:"FluidHeroButton",hideInGroup:!1,hideInMailSurfaceSettings:!0}),e.push({key:"AddEmoji",hideInGroup:!1}),Object(Q.a)()&&e.push({key:"ProofingOptions",hideInGroup:!1}),(Object(oe.d)()||Object(oe.b)())&&Object($.j)("cmp-dictation")&&e.push({key:"ToggleDictation",hideInGroup:!1}),e=e.concat([{key:"ToggleRibbon",hideInGroup:!1},{key:"SaveDraft",hideInGroup:!1},{key:"InsertSignature",hideInGroup:!1},{key:"ShowFrom",hideInGroup:!1},{key:"SetImportance",hideInGroup:!1},{key:"SwitchBodyType",hideInGroup:!1},{key:"AccChecker",hideInGroup:!1}]),Object($.j)("cmp-clp")&&!Object(V.a)()&&e.push({key:"SensitivityMenu",hideInGroup:!1}),Object(Z.a)()&&e.push({key:"ProtectMessage",hideInGroup:!1}),Object(J.a)()&&e.push({key:"ShowMessageOptions",hideInGroup:!1}),Object($.j)("mos-messageExtensionsFlyout")&&e.push({key:"MessageExtensions"}),e.push({key:"CustomizeActions",hideInGroup:!1,hideInMailSurfaceSettings:!0}),e}function se(e){return"Reply"==e||"ReplyAll"==e||"Forward"==e}function ce(e){return-1!==Object(te.g)(te.d.SurfaceActions).readSurfaceActions.indexOf(e)}function ue(e,t){return ce(e)||!(!Object($.j)("rp-csaPinnedLikes")||Object($.j)("rp-reactions")||"LikeUnlike"!==e||!t.LikeCount)||!("ToggleDarkMode"!==e||!Object(re.g)())||!("ToggleAmp"!==e||!Object($.j)("rp-amp")||!Object(V.a)())||!("SetReaction"!==e||!Object($.j)("rp-reactions"))||!("MessageExtensions"!==e||!Object($.j)("mos-messageExtensionsFlyout"))}var le=n(71);function de(e,t,n,r){let o;r?o=r:(o="Pinned",(null==n?void 0:n.renderedInOverflow)&&(o=n.isPinned?"Overflow":"NotPinned")),Object(le.o)(e?"CSACountComposeUserAction":"CSACountReadUserAction",[t,o])}function fe(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach(e=>{e.renderedInOverflow=!0})}function pe(e){var t,n;null===(n=null===(t=e.subMenuProps)||void 0===t?void 0:t.items)||void 0===n||n.forEach(e=>{e.renderedInOverflow=!1})}var me=n(1710);function he(e){const t=Object(me.f)(me.c.SurfaceActions);return!["SetDictationLanguage","ProofingOptions"].includes(e)&&t.composeSurfaceActions.includes(e)||t.composeSurfaceAddins.includes(e)||["ToggleDarkCompose","AddClassicAttachment","InsertLink","FluidHeroButton","MessageExtensions"].includes(e)}n.d(t,"n",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return G})),n.d(t,"g",(function(){return q})),n.d(t,"f",(function(){return K})),n.d(t,"a",(function(){return"-"})),n.d(t,"d",(function(){return X.a})),n.d(t,"h",(function(){return X.c})),n.d(t,"e",(function(){return ae})),n.d(t,"i",(function(){return ie})),n.d(t,"p",(function(){return se})),n.d(t,"o",(function(){return ue})),n.d(t,"j",(function(){return ce})),n.d(t,"k",(function(){return de})),n.d(t,"m",(function(){return fe})),n.d(t,"l",(function(){return pe})),n.d(t,"q",(function(){return he}))},4157:function(e,t,n){"use strict";var r=n(20),o=n(4233);n(4989);n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o.a}));const i=new r.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(365)]).then(n.bind(null,19703))),a=Object(r.d)(i,e=>e.AppDrawer)},4166:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(r||(r={}));var o={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104}},4189:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(16);function o(){return{legacySignature:{html:null,txt:null},roamingSignatureMap:new r.ObservableMap,defaultSignatureName:"",defaultReplySignatureName:""}}},4195:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(47),o=n(3829);function i(){return Object(r.j)("honeybee-sonora-file")&&Object(o.a)(!1)}function a(){return Object(r.j)("honeybee-sonora-mentions-files")&&Object(o.a)(!1)}},4198:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s}));var r=n(5131),o=n(5893),i=n(3839);const a="MailComposeSend";function s(e){return"string"==typeof e?e:e.ItemId.Id}t.b={MailComposeReply:{name:"MailComposeReply",options:{},customData:e=>[e.actionSource,e.useFullCompose],actionSource:e=>e.actionSource,cosmosOnlyData:e=>s(e.referenceItemOrId)},MailComposeReplyAll:{name:"MailComposeReplyAll",options:{},customData:e=>[e.actionSource,e.useFullCompose],actionSource:e=>e.actionSource,cosmosOnlyData:e=>s(e.referenceItemOrId)},MailComposeSendE2E:{name:"MailComposeSendE2E",customData:e=>({composeTraceId:e.logTraceId,operation:e.operation,isGroupScenario:Object(i.b)(e)})},MailComposeSave:{name:"MailComposeSave"},MailComposeUpConvert:{name:"MailComposeUpConvert"},ComposeCommandDiscardCompose:{name:"ComposeCommandDiscardCompose",customData:e=>({composeTraceId:e.logTraceId,messageLanguage:Object(o.a)(e)}),options:{isCore:!0},cosmosOnlyData:e=>JSON.stringify({smartReplyExtractionId:Object(r.a)(e,"smartReply"),smartDocExtractionId:Object(r.a)(e,"smartDoc")})}}},4199:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="Addins"},4233:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("onAppDrawerAppClick",e=>({appId:e}))},4252:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(3410),o=n(4321),i=n(38),a=n(296);function s(e){let t=[];const n=Object(r.a)();Object(o.a)(n)||t.push(n);const a=c(n,e);return t=t.concat(a),t=function(e){const t=Object(i.a)().SessionSettings.ConnectedAccountInfos;t&&t.length>0&&t.forEach(t=>{-1==e.lastIndexOf(t.EmailAddress)&&e.push(t.EmailAddress)});return e}(t),t}function c(e,t){let n=[];if(Object(a.a)()||t){const t=function(e){return u(e,Object(i.a)().SessionSettings.UserProxyAddresses)}(e);n=n.concat(t)}if(Object(a.a)()){const t=function(e){return u(e,Object(i.a)().SessionSettings.NotManagedEmailAddresses)}(e);n=n.concat(t)}return n}function u(e,t){const n=[];return t&&t.length>0&&t.forEach(t=>{e==t||Object(o.a)(t)||n.push(t)}),n}},4255:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),o=n(2843);function i(e,t){return void 0===e||e.__type||(e=Object(o.a)(e)),Object(r.a)("CreateItem",e,t)}},4261:function(e,t,n){"use strict";function r(e){return e.policyMatchDetails.slice().sort((e,t)=>{const n=o(t.Action)-o(e.Action);return 0==n?null==e.MatchPriority?null==t.MatchPriority?n:1:null==t.MatchPriority?-1:e.MatchPriority-t.MatchPriority:n})[0]}function o(e){switch(e){case 1:return 0;case 4:case 2:case 3:return 1;case 5:return 2;default:return 3}}n.d(t,"a",(function(){return r}))},4285:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"MAX_REGEX_MATCHES",(function(){return I})),n.d(r,"MAX_BODY_REGEX_ACTIVATION_LENGTH",(function(){return x})),n.d(r,"MAX_REGEX_MATCH_LENGTH",(function(){return E}));var o=n(2452),i=n(6576),a=n(7010),s=n(7684),c=n(1810),u=n(5241);const l="AND",d="OR";class f{constructor(e){this.collectionRule=e}Evaluate(e,t){let n=this.GetInitialEvaluationResult();for(const r of this.collectionRule.Rules){const o=P(r).Evaluate(e,t);n=this.UpdateEvaluationResult(n,o)}return n}ItemIsReadyForEvaluation(e){for(const t of this.collectionRule.Rules){if(!P(t).ItemIsReadyForEvaluation(e))return!1}return!0}GetInitialEvaluationResult(){if(this.collectionRule.Mode.toUpperCase()==l)return!0;if(this.collectionRule.Mode.toUpperCase()==d)return!1;throw new Error(`Invalid mode for a Collection rule: ${this.collectionRule.Mode}`)}UpdateEvaluationResult(e,t){return!(this.collectionRule.Mode.toUpperCase()==l&&!t)&&(!(this.collectionRule.Mode.toUpperCase()!=d||!t)||e)}}class p{Evaluate(e,t){return!!e.HasAttachments}ItemIsReadyForEvaluation(e){return!0}}var m=n(307),h=n.n(m);const g="Address",v="ContactString",y="EmailAddress",b="MeetingString",O="OriginalPhoneString",S="TaskString",C="Url";class A{constructor(e){this.itemHasKnownEntityRule=e}Evaluate(e,t){if(!e.EntityExtractionResult)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Addresses,g);case 7:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Contacts,v);case 6:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.EmailAddresses,y);case 1:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.MeetingSuggestions,b);case 5:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.PhoneNumbers,O);case 2:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.TaskSuggestions,S);case 4:return this.EvaluateForEntityType(e,t,e.EntityExtractionResult.Urls,C);default:throw new Error(`Unexpected known entity: ${this.itemHasKnownEntityRule.EntityType}`)}}EvaluateForEntityType(e,t,n,r){if(!n)return!1;const o=[];let i=!1,a=0;for(const e of n)if(this.EvaluateRegExForTerm(e[r])){i=!0,-1===t.evaluationResult.matchedKnownEntityTypes.indexOf(this.itemHasKnownEntityRule.EntityType)&&t.evaluationResult.matchedKnownEntityTypes.push(this.itemHasKnownEntityRule.EntityType),2!==this.itemHasKnownEntityRule.Highlight&&"Subject"!==e.Position&&(t.terms.push(_(e,r)),a++);const n=h()({},e);o.push(n)}if(this.itemHasKnownEntityRule.FilterName&&this.itemHasKnownEntityRule.RegExFilter&&this.SaveRegexMatches(o,t.evaluationResult),a>0){const e=t.highlightableEntities[this.itemHasKnownEntityRule.EntityType];(!e||a>e)&&(t.highlightableEntities[this.itemHasKnownEntityRule.EntityType]=a)}return i}EvaluateRegExForTerm(e){const t=this.itemHasKnownEntityRule.IgnoreCase,n=this.itemHasKnownEntityRule.RegExFilter;if(!n)return!0;const r=Object(u.h)(e,n,t);return r&&r.length>0}ItemIsReadyForEvaluation(e){return!!e.EntityExtractionResult||!this.ItemHasEntityOnServer(e)}ItemHasEntityOnServer(e){if(!e.PropertyExistence)return!1;switch(this.itemHasKnownEntityRule.EntityType){case 3:return e.PropertyExistence.ExtractedAddresses;case 7:return e.PropertyExistence.ExtractedContacts;case 6:return e.PropertyExistence.ExtractedEmails;case 1:return e.PropertyExistence.ExtractedMeetings;case 5:return e.PropertyExistence.ExtractedPhones;case 2:return e.PropertyExistence.ExtractedTasks;case 4:return e.PropertyExistence.ExtractedUrls;default:return!1}}SaveRegexMatches(e,t){switch(this.itemHasKnownEntityRule.EntityType){case 3:t.filteredEntityMatches.Addresses||(t.filteredEntityMatches.Addresses={}),t.filteredEntityMatches.Addresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 7:t.filteredEntityMatches.Contacts||(t.filteredEntityMatches.Contacts={}),t.filteredEntityMatches.Contacts[this.itemHasKnownEntityRule.FilterName]=e;break;case 6:t.filteredEntityMatches.EmailAddresses||(t.filteredEntityMatches.EmailAddresses={}),t.filteredEntityMatches.EmailAddresses[this.itemHasKnownEntityRule.FilterName]=e;break;case 1:t.filteredEntityMatches.MeetingSuggestions||(t.filteredEntityMatches.MeetingSuggestions={}),t.filteredEntityMatches.MeetingSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 5:t.filteredEntityMatches.PhoneNumbers||(t.filteredEntityMatches.PhoneNumbers={}),t.filteredEntityMatches.PhoneNumbers[this.itemHasKnownEntityRule.FilterName]=e;break;case 2:t.filteredEntityMatches.TaskSuggestions||(t.filteredEntityMatches.TaskSuggestions={}),t.filteredEntityMatches.TaskSuggestions[this.itemHasKnownEntityRule.FilterName]=e;break;case 4:t.filteredEntityMatches.Urls||(t.filteredEntityMatches.Urls={}),t.filteredEntityMatches.Urls[this.itemHasKnownEntityRule.FilterName]=e}}}function _(e,t){return t===b?function(e,t){const n=e[t];if(!e.TimeStringLength)return n;const r=n.slice(e.TimeStringBeginIndex,e.TimeStringBeginIndex+e.TimeStringLength),o=n.slice(e.TimeStringBeginIndex+e.TimeStringLength,n.length);if(0==o.length)return r;return r+"(?="+o+")"}(e,t):e[t]}const I=50,x=5e5,E=10240;var T=n(282);function w(e){return 0===e.indexOf("ipm.note")||0===e.indexOf("ipm.schedule")||0===e.indexOf("ipm.sharing")}function M(e){return 0===e.indexOf("ipm.appointment")||"ipm.ole.class.{00061055-0000-0000-c000-000000000046}"==e}class k{constructor(e){this.itemIsRule=e}Evaluate(e,t){return this.EvaluateItemType(e)&&this.EvaluateItemClass(e)}EvaluateItemType(e){const t=e.ItemClass;return!(1!=this.itemIsRule.ItemType||!t||!w(t.toLowerCase()))||(!(2!=this.itemIsRule.ItemType||!t||!M(t.toLowerCase()))||!this.itemIsRule.ItemType)}EvaluateItemClass(e){const t=e.ItemClass;return!this.itemIsRule.ItemClass||(this.itemIsRule.IncludeSubClasses?t&&0===t.toLowerCase().indexOf(this.itemIsRule.ItemClass.toLowerCase()):t&&this.itemIsRule.ItemClass.toLowerCase()===t.toLowerCase())}ItemIsReadyForEvaluation(e){return!0}}class j{constructor(e,t){this.itemHasRegularExpressionMatchRule=e,this.limits=t||r}Evaluate(e,t){var n;const r=this.GetPropertyForEvaluation(e,t),o=this.itemHasRegularExpressionMatchRule.RegExValue,i=this.itemHasRegularExpressionMatchRule.IgnoreCase;let a=null;if(null!=r&&(a=Object(u.h)(r,o,i)),2===this.itemHasRegularExpressionMatchRule.PropertyName){const t=(null===(n=e.QuotedTextList)||void 0===n?void 0:n.length)>0?e.QuotedTextList[0]:null;if(t){let e=Object(u.h)(t,o,i);a.push(...e)}}if(null==a)return t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=[],!1;const s=this.removeDuplicatesAndApplyMatchLimits(a);if(t.evaluationResult.regExMatches[this.itemHasRegularExpressionMatchRule.RegExName]=s,2===this.itemHasRegularExpressionMatchRule.Highlight)return!0;if(2==this.itemHasRegularExpressionMatchRule.PropertyName)for(const e of s)t.terms.push(e);return!0}ItemIsReadyForEvaluation(e){return!0}removeDuplicatesAndApplyMatchLimits(e){const t={};let n=0;for(const r of e){if(n>=this.limits.MAX_REGEX_MATCHES)break;r.length<=this.limits.MAX_REGEX_MATCH_LENGTH&&(t[r]=1,n++)}return Object.keys(t)}GetPropertyForEvaluation(e,t){switch(this.itemHasRegularExpressionMatchRule.PropertyName){case 1:return e.Subject;case 4:return this.GetSenderSMTPAddress(e);case 3:return this.GetBodyWithLimits(e);case 2:if(t.plainTextBody)return t.plainTextBody;const n=this.GetBodyWithLimits(e);return t.plainTextBody=Object(u.e)(n),t.plainTextBody;default:return Object(T.a)(this.itemHasRegularExpressionMatchRule.PropertyName),""}}GetSenderSMTPAddress(e){if(w(e.ItemClass.toLowerCase())){const t=e;if(t.Sender&&t.Sender.Mailbox)return t.Sender.Mailbox.EmailAddress}if(M(e.ItemClass.toLowerCase())){const t=e;if(t.Organizer&&t.Organizer.Mailbox)return t.Organizer.Mailbox.EmailAddress}return null}GetBodyWithLimits(e){const t=this.GetBody(e);return null!=t&&t.length>this.limits.MAX_BODY_REGEX_ACTIVATION_LENGTH?null:t}GetBody(e){let t;e.NormalizedBody?t=e.NormalizedBody:e.UniqueBody?t=e.UniqueBody:e.Body&&(t=e.Body);const n=this.itemHasRegularExpressionMatchRule.PropertyName;return!t||"Text"===t.BodyType&&3===n?null:t.Value}}function P(e){if("ItemIs"==e.Type)return new k(e);if("ItemHasAttachment"==e.Type)return new p;if("ItemHasKnownEntity"==e.Type)return new A(e);if("ItemHasRegularExpressionMatch"==e.Type)return new j(e);if("Collection"==e.Type)return new f(e);throw new Error(`Rule type not supported: ${e.Type}`)}var R=n(16);function N(e,t,n){const r={};if(e.length>0){let o;e.forEach(e=>{o=function(e){const t={evaluationResult:Object(c.h)(),highlightableEntities:{},terms:[]};return e&&(t.plainTextBody=e.plainTextBody,t.highlightableEntities=e.highlightableEntities),t}(o);const i=function(e,t,n){try{return function(e,t,n){if(P(e).Evaluate(t,n))return n.terms;return[]}(e.detectedEntity.Rule,t,n)}catch(e){return[]}}(e,t,o);for(const t of i)r[t]?r[t].push(e):r[t]=[e];i.length>0&&(n[e.get_ExtensionId()]=o.evaluationResult)})}return new R.ObservableMap(r)}function D(e,t){try{return function(e,t){return P(e).ItemIsReadyForEvaluation(t)}(e.detectedEntity.Rule,t)}catch(e){return!0}}async function F(e,t){if(!function(e,t){for(const n of e){if(!D(n,t))return!1}return!0}(t,e)){const t=await Object(u.j)(e);Object(c.pb)(e,t.EntityExtractionResult)}}var L=n(1785),U=n(1797);async function B(e,t){const n=Object(L.c)(t);if(!n)return;let r=!1;n.isSharedItem&&(r=n.isSharedItem());const o=function(e){const t=c.j.EnabledAddinCommands;if(!t)return[];let n=t.getExtensionPoint(U.a.DetectedEntity);return 0==n.length?[]:(e&&(n=Object(c.l)(n)),n.map(e=>{return[...e.AddinCommands.values()][0]}))}(r),i={};await F(e,o);const a=N(o,e,i),s=new R.ObservableMap(i);Object(c.ob)(t,a,s)}var H=n(5767),V=n(4956),z=n(7340),W=n(47);async function G(e,t,n=!0,r,o){if(Object(L.a)(e,t),Object(c.K)(e),(i=t.mode)==U.a.MessageRead||i==U.a.MeetingRequest||i==U.a.AppointmentAttendee){const n=t;Object(c.xb)(function(e,t){return()=>e.getItem().then(e=>B(e,t))}(n,e))}var i;!Object(W.j)("addin-getExtNotificationsFromGetItem")||t.mode!=U.a.MessageRead&&t.mode!=U.a.MessageCompose?Object(u.k)(e,r):Object(u.l)(e,r,o),await Object(V.f)(t.mode),await Object(s.a)(),Object(H.b)()&&Object(z.f)(z.a.Single,e,r),Object(z.e)(n,e,r)}var q=n(1979);function K(e,t){const n=Object(q.a)(t),r={hostItemIndex:e,tabId:n?n.tabId:t===window?"Main":null},o=JSON.stringify(r);t!=window&&Object(z.i)(e,t),Object(u.f)(e),Object(z.b)(e,t),Object(c.i)(e),Object(c.g)(e,t),function(e,t){const n=JSON.parse(e);n&&(Object(c.M)(e)?Object(R.when)(()=>!Object(c.M)(e),()=>t(n.hostItemIndex)):t(n.hostItemIndex))}(o,X),Object(z.h)(t)}function X(e){Object(c.Q)(e)||Object(L.b)(e)}var Q=n(2764);function J(e,t,n){t==Q.a.Deselected&&Object(z.b)(e,n)}function Y(e){return!!Object(c.y)(e)&&null!=Object(c.y)(e).contextualTerms}function Z(e,t){return Object(R.when)(()=>Y(e),()=>t(function(e){return Y(e)?[...Object(c.y)(e).contextualTerms.keys()]:null}(e)))}var $=n(4456),ee=n(4991);class te extends c.a{constructor(){super({},{},{},{}),this.extension={AppDomains:[ee.e,ee.d],Id:ee.k,Version:ee.i,Type:"Default",TypeString:"Default",Origin:"Default",OriginString:"Default",IconUrl:ee.h,DisplayName:ee.c,ConsentState:0,Description:ee.b,ProviderName:ee.j,HighResolutionIconUrl:ee.g,AppStatus:"",LicenseType:0,Settings:"{}",RequestedCapabilities:1,DisableEntityHighlighting:!1,Enabled:!0,LicenseStatus:0,IsMandatory:!1,ExtensionPointCollection:this.get_ExtensionPointCollection()},this.addinId=ee.k,this.commandId=ee.a,this.endpoint=ee.d}get isActionable(){return!0}get isMenu(){return!1}get_EntryPoint(){return this.endpoint.toString()}get_Label(){var e;return null===(e=this.extension)||void 0===e?void 0:e.DisplayName}get_ExtensionDisplayName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.DisplayName}get_Id(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Id}get_Size16Icon(){var e;return null===(e=this.extension)||void 0===e?void 0:e.IconUrl}get_Version(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Version}get_ExtensionPointCollection(){return{FunctionFile:ee.f,MessageReadCommandSurface:this.get_ExtensionPoint(),MessageComposeCommandSurface:null,AppointmentOrganizerCommandSurface:null,AppointmentAttendeeCommandSurface:null,Events:null,DetectedEntity:null,CustomPane:null,__type:"MessageReadCommandSurface"}}get_ExtensionPoint(){return{Tabs:[this.get_Tab()],__type:""}}get_Tab(){return{Type:0,Id:"TabDefault",Groups:[this.get_Group()],Label:ee.c,__type:null}}get_Group(){return{Id:"ScreamGroup",Label:ee.c,Controls:[this.get_TaskPaneControl()],__type:null}}get_IconUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.IconUrl}get_IconUrls(){return{Size16Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon16x16.png",Size32Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon32x32.png",Size80Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon80x80.png",Size20Url:null,Size24Url:null,Size40Url:null,Size48Url:null,Size64Url:"https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",__type:null}}get_TaskPaneControl(){const e=this.get_Control();return e.Action={SourceLocation:ee.f,__type:"TaskPaneButton"},e}get_Control(){return{Label:ee.c,Supertip:{Title:"Translate Item",Description:ee.b},Icon:this.get_IconUrls(),Id:ee.a,__type:"ShowTaskpane"}}get_OriginString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.OriginString}get_ExtensionId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Id}get_MarketPlaceAssetId(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceAssetID}get_TypeString(){var e;return null===(e=this.extension)||void 0===e?void 0:e.TypeString}get_ProviderName(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ProviderName}get_ConsentMetaData(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentMetadata}get_MarketPlaceContentMarket(){var e;return null===(e=this.extension)||void 0===e?void 0:e.MarketplaceContentMarket}get_WebApplicationResource(){var e;return null===(e=this.extension)||void 0===e?void 0:e.WebApplicationResource}get_ExtendedPermissions(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ExtendedPermissions}get_AppStatus(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppStatus}get_LicenseType(){var e;return null===(e=this.extension)||void 0===e?void 0:e.LicenseType}get_Settings(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Settings}get_AppDomains(){var e;return null===(e=this.extension)||void 0===e?void 0:e.AppDomains}get_Type(){var e;return null===(e=this.extension)||void 0===e?void 0:e.Type}get_ConsentState(){var e;return null===(e=this.extension)||void 0===e?void 0:e.ConsentState}get_RequestedCapabilities(){var e;return null===(e=this.extension)||void 0===e?void 0:e.RequestedCapabilities}get_EndNodeUrl(){var e;return null===(e=this.extension)||void 0===e?void 0:e.EndNodeUrl}set_ConsentState(e){this.extension.ConsentState=e}set_RequestedCapabilities(e){this.extension.RequestedCapabilities=e}set_TypeString(e){this.extension.TypeString=e}set_ExtensionId(e){this.extension.Id=e}set_OriginString(e){this.extension.OriginString=e}set_Settings(e){this.extension.Settings=e}}var ne=te,re=n(10527);async function oe(e,t){await Object(re.a)();const n=new ne;if(null==n)return null;Object(z.g)(e,n,U.a.MessageRead,t)}var ie=n(7008),ae=n(2743),se=n(23),ce=n(0),ue=n(2738),le=n(16577),de=n(6),fe=n(6724),pe=n(7696);var me=n(8846),he=n(16578),ge=n(6451),ve=n(2374),ye=n(564),be=n(71);var Oe=n(7006);async function Se(e,t,n=window,r){if(Object(Oe.f)(t))return void await async function(){const e=await Object(ye.b)(Object(de.b)(he.b),Object(de.b)(ge.b),!1,{okText:Object(de.b)(he.a),cancelText:Object(de.b)(ge.a)});Object(be.o)("ExtGDPRMinorDialogResponse",[e]),e===ye.a.cancel&&Object(ve.a)()}();const o=Object(L.c)(e);let i=!0;if(o&&(o.mode===U.a.MessageRead||o.mode===U.a.AppointmentAttendee)){const e=await o.getItem();i=Object(c.eb)(e)}await Object(ye.b)(Object(de.b)(le.a),"",i,{bodyElement:ce.createElement("p",null,Object(de.b)(le.b)),hideCancelButton:!0}),i&&(fe.c(t.control)?Object(me.a)(e,t,null==o?void 0:o.mode,n,r):fe.a(t.control)&&function(e,t,n){const r=new pe.d(e,new pe.a,n),o=r.controlId;Object(c.db)(o,r,t,n)}(t,e,n))}var Ce=n(10530),Ae=n(138);class _e{constructor(e,t){this.key=e,this.name=t}generateData(){return{id:this.key,key:this.key,name:this.name,title:this.description,ariaLabel:this.accessibilityText,iconProps:Object(Ce.a)(this.iconUrl),itemType:Ae.a.Normal,getClickHandler:this.getClickHandler,subMenuProps:this.subMenuData?{items:[this.subMenuData.generateData()]}:null}}}class Ie{constructor(e,t){this.key=e,this.header=t,this.menuItemDataList=[]}addItem(e){this.menuItemDataList.push(e)}generateItemsData(){for(const e of this.menuItemDataList)this.data.push(e.generateData())}generateData(){return this.data=[],this.generateItemsData(),{key:this.key,itemType:Ae.a.Section,sectionProps:{title:this.header,items:this.data}}}}function xe(e,t){const{Id:n,Label:r}=e.control,o=new _e(n,r);return e.isMenu?o.subMenuData=Ee(n,r,e.subCommands,t):e.isActionable&&(o.getClickHandler=ke(e)),o.iconUrl=e.control.Icon?e.control.Icon.Size16Url:null,o.accessibilityText=e.control.Label,o.description=e.control.Supertip?e.control.Supertip.Title:null,o}function Ee(e,t,n,r){const o=new Ie(e,t);for(const e of n)o.addItem(xe(e,r));return o}function Te(e,t){const n=new _e(e.Id,e.DisplayName);if(Object(Oe.h)(e))if(Object(Oe.g)(e))n.subMenuData=Ee(e.Id,e.DisplayName,Object(Oe.d)(e).subCommands,t);else{const r=[...e.AddinCommands.values()];n.subMenuData=Ee(e.Id,e.DisplayName,r,t)}else Object(Oe.a)(e)&&(n.getClickHandler=ke(Object(Oe.d)(e)));return n.description=Object(Oe.e)(e),n.accessibilityText=Object(Oe.b)(e),n.iconUrl=e.IconUrl,n}var we=n(16579);var Me=n(10531);function ke(e){return t=>n=>{(null==n?void 0:n.stopPropagation)&&n.stopPropagation(),Se(t.hostItemIndex,e,t.targetWindow,null)}}function je(e,t){const n=function(e,t){const n=new Ie("AddinsHeader",Object(de.b)(we.a));for(const r of e)n.addItem(Te(r,t));return n}(e,t).generateData();return t!=window?n:(Object(c.t)()&&Object(c.t)().InClientStoreUrl&&(n.sectionProps.items.push(Object(Me.b)()),n.sectionProps.items.push(Object(Me.a)())),n)}var Pe=n(1264),Re=n(379),Ne=n(56),De=n(1900),Fe=n(16580),Le=n.n(Fe),Ue=Object(se.a)((function(e){const t=ce.useContext(De.a),[n,r]=ce.useState(!1),o=n=>{n.stopPropagation(),Object(Oe.a)(e.addin)&&Se(e.hostItemIndex,Object(Oe.d)(e.addin),t)},i={iconType:Re.a.Image,imageProps:{src:e.addin.IconUrl,width:16,height:16,imageFit:Ne.b.contain,onLoadingStateChange:e=>{e==Ne.c.error?r(!0):r(!1)}}},a={iconType:Re.a.Default,iconName:"Photo2"},s=Object(Oe.b)(e.addin),c={className:Le.a.addinEntryButton,iconProps:n?a:i,title:s,ariaLabel:s};if(Object(Oe.a)(e.addin))return ce.createElement(Pe.a,Object.assign({onClick:o},c));if(Object(Oe.h)(e.addin)){const n=function(e,t){return Te(e,t).generateData()}(e.addin,t);return Object(ue.a)(e.hostItemIndex,n,t),ce.createElement(Pe.a,Object.assign({onMenuClick:o,menuProps:n.subMenuProps,menuIconProps:null},c))}return null})),Be=n(16582),He=n.n(Be);var Ve=function(e){const t=[];for(const n of e.addins)t.push(ce.createElement(Ue,{hostItemIndex:e.hostItemIndex,addin:n,key:n.Id}));return ce.createElement("div",{className:He.a.listViewContainer},t)},ze=n(16584),We=n(123),Ge=n.n(We),qe=n(16585),Ke=n.n(qe),Xe=Object(se.a)((function(e){const t=ce.useContext(De.a),n={iconType:Re.a.Default,iconName:"ChevronDownMed",className:Ge()([Ke.a.overflowChevron])},r={className:Ge()([Ke.a.overflowChevronContainer]),iconProps:n,title:Object(de.b)(ze.a),ariaLabel:Object(de.b)(ge.c)},o=je(e.addins,t);return Object(ue.a)(e.hostItemIndex,o,t),ce.createElement("div",{className:Ge()([Ke.a.overflowContainer])},ce.createElement("div",{className:Ge()([Ke.a.overflowDivider])}),ce.createElement(Pe.a,Object.assign({onMenuClick:Qe,menuProps:{items:[o]},menuIconProps:null},r)))}));function Qe(e){e.stopPropagation()}var Je=n(16587),Ye=n.n(Je);const Ze=5,$e=3,et=5;var tt=Object(se.a)((function(e){const t=c.j.HostItems.get(e.Index),n=c.j.EnabledAddinCommands;if(!t||!n)return ce.createElement("div",null);const r=Object(L.c)(e.Index);let o=function(e){switch(e){case U.a.MessageRead:return $e;case U.a.MessageCompose:return et;default:return Ze}}(r.mode);const i=n.getExtensionPoint(r.mode);o=Math.min(o,i.length);let a=null;return o<i.length&&(a=ce.createElement(Xe,{hostItemIndex:e.Index,addins:i.slice(o,i.length)})),ce.createElement("div",{className:Ye.a.divContainer},ce.createElement(Ve,{hostItemIndex:e.Index,addins:i.slice(0,o)}),a)}));var nt=n(10199);const rt=function(e){const{activeDialogs:t}=Object(c.u)();for(let n of t.values())n.parentControlId==e&&Object($.j)({eventDispId:$.a.DISPLAY_DIALOG_DISPID,controlId:e})};function ot(e,t){const n=Object(c.o)(t,e);Object(c.u)().runningUILessExtendedAddinCommands.has(n)&&[...Object(c.u)().runningUILessExtendedAddinCommands.get(n).keys()].forEach((n,r)=>{!function(e,t,n,r){rt(e),Object(c.ib)(e,t,n,r)}(n,e,c.d.NavigatedBeforeCompleted,t)})}var it=n(10528),at=n(3);function st(e){const t=Object(c.D)(e);ot(e,t),Object(c.g)(e,t)}Object(at.orchestrator)(it.b,({hostItemIndex:e})=>st(e));var ct=n(10529);function ut(e,t,n){Object(c.J)(e,t,n);const r=Object(c.u)();Object(ct.a)(t,r.contextualCalloutState.activeContextualAddinCommands[0])}async function lt(e,t,n,r,o,i){const a=Object(Oe.c)(t,n,r);if(null==a)return null;await Se(e,a,o,i)}const dt={};function ft(e,t,n,r=window){const o=function(e,t,n,r){const o=Object(q.a)(r),i=o?o.tabId:r===window?"Main":null;return e+"_"+t+"_"+n+"_"+i}(e,t=!!t,n,r);return dt[o]||(dt[o]=Object(R.computed)(()=>{const n=Object(c.u)().Context,o=Object(c.u)().EnabledAddinCommands;return o?function(e,t,n,r,o){if(n&&t.isInitialized){return je(t.getExtensionPoint(e,r),o)}return null}(e,o,n,t,r):null})),dt[o]}var pt=n(8524),mt=n(11867),ht=n(16589),gt=n(3643),vt=n(38);var yt=async()=>{const e=Object(c.u)().Context;if(Object(c.O)()&&e)return!0;{const e={name:"Extensibility initialization observer timeout",timeout:9e3};try{await Object(R.when)(()=>Object(c.u)().Context&&Object(c.O)(),e)}catch(e){return!1}}return Object(c.u)().Context&&Object(c.O)()};async function bt(e,t){var n;const r=Object(gt.j)(),o=Object(vt.a)().SegmentationSettings.OnSendAddinsEnabled;if(o&&!await yt()&&function(e){const t=Object(c.u)().Context,n=Object(c.O)();if(e&&(!t||!n))return Object(ye.b)(Object(de.b)(mt.a),Object(de.b)(ht.b),!1,{hideCancelButton:!0}),!0;return!1}(o))return Object(gt.l)(r,1),!1;let i=Object(c.A)(1);const a=Object(L.c)(e);(null===(n=null==a?void 0:a.isSharedItem)||void 0===n?void 0:n.call(a))&&(i=Object(c.k)(i)),function(e,t){e.forEach(e=>Object(u.m)(t,e.get_ExtensionId(),`${e.get_ExtensionId()}ItemSend`))}(i,e);for(let n=0;n<i.length;n++){if(!await Ot(e,i[n],r,t))return!1;r.addCheckmark(`ItemSend${n}`)}return i.length>0?Object(gt.l)(r,4):r.invalidate(),!0}async function Ot(e,t,n,r){const o=new pe.d(t,new pe.a,r),i=o.controlId,a=await Object(c.db)(i,o,e,r);return a.status===c.d.Success&&!1!==a.allowEvent||(Object(u.c)(e,t.get_ExtensionId(),!1,`${t.get_ExtensionId()}ItemSend`,0,Object(de.c)(Object(de.b)(ht.a),t.get_ExtensionDisplayName()),r),Object(c.ib)(i,e,a.status,r),Object(gt.k)(n,a,t),!1)}var St=(e,t,n=window,r)=>{Object(W.j)("addin-autoRun")&&Object(c.O)()&&Object(z.d)(e,t,n,r)};let Ct=Object(at.action)("onLaunchEventTriggered",(e,t,n,r)=>({hostItemIndex:e,launchEventType:t,args:n,targetWindow:r}));Object(at.orchestrator)(Ct,e=>{St(e.hostItemIndex,e.launchEventType,e.targetWindow,e.args)});var At=Ct,_t=n(6134),It=n(1734);function xt(e,t){var n,r,o,i;const a=Object(It.a)();if(a.shouldHighlightUnpinnedAdminAddins&&e&&e.key)switch(t){case U.a.MessageRead:a.mailReadSurfaceUnpinnedAdminAddins&&(null===(n=a.mailReadSurfaceUnpinnedAdminAddins)||void 0===n||n.forEach(t=>{t==e.key&&(e.className=a.themeSpecificHighlightDataStore,Object(gt.q)(e.key,U.a.MessageRead))}));break;case U.a.MessageCompose:a.mailComposeSurfaceUnpinnedAdminAddins&&(null===(r=a.mailComposeSurfaceUnpinnedAdminAddins)||void 0===r||r.forEach(t=>{t==e.key&&(e.className=a.themeSpecificHighlightDataStore,Object(gt.q)(e.key,U.a.MessageCompose))}));break;case U.a.AppointmentOrganizer:a.appointmentOrganizerSurfaceUnpinnedAdminAddins&&(null===(o=a.appointmentOrganizerSurfaceUnpinnedAdminAddins)||void 0===o||o.forEach(t=>{t==e.key&&(e.className=a.themeSpecificHighlightDataStore,Object(gt.q)(e.key,U.a.AppointmentOrganizer))}));break;case U.a.AppointmentAttendee:a.appointmentAttendeeSurfaceUnpinnedAdminAddins&&(null===(i=a.appointmentAttendeeSurfaceUnpinnedAdminAddins)||void 0===i||i.forEach(t=>{t==e.key&&(e.className=a.themeSpecificHighlightDataStore,Object(gt.q)(e.key,U.a.AppointmentAttendee))}))}}function Et(e){if(!e)return;const t=Object(It.a)();t.shouldHighlightUnpinnedAdminAddins&&(t.mailReadSurfaceUnpinnedAdminAddins||t.mailComposeSurfaceUnpinnedAdminAddins||t.appointmentOrganizerSurfaceUnpinnedAdminAddins||t.appointmentAttendeeSurfaceUnpinnedAdminAddins)&&(e.className=t.themeSpecificHighlightDataStore,Object(gt.u)("Highlighted","OverFlowMenu"))}var Tt=n(8333),wt=n(2460);function Mt(e,t,n){var r,o;if(Object(c.O)()){let i=n;if(!i){let e=Object(wt.c)();i=null==e?void 0:e.DefaultOnlineMeetingProvider}let a,s,u,l=null;const d=new Map(Tt.a.map(e=>[e.Id,e])),f=Object(c.t)();for(let e of null==f?void 0:f.Extensions)if(i==(!!d.has(e.Id)&&d.get(e.Id).Name)){l=e;break}if(!l)return!1;try{s=null===(o=null===(r=null==l?void 0:l.ExtensionPointCollection)||void 0===r?void 0:r.AppointmentOrganizerCommandSurface)||void 0===o?void 0:o.Tabs[0],u=null==s?void 0:s.Groups[0],a=null==u?void 0:u.Controls[0],Object(W.j)("addin-EMOGoogleMeetSupport")&&"6df220fc-e48e-4469-8db1-6912ce109886"==l.Id&&(a=null==u?void 0:u.Controls[0].MenuItems[0]);const n=new c.a(a,s,u,l),i=new pe.d(n,new pe.a,t);return Object(c.db)(i.controlId,i,e,window),!0}catch(e){return!1}}return!1}n.d(t,"removeExtensibilityNotification",(function(){return o.h})),n.d(t,"updatePersistentNotifications",(function(){return i.a})),n.d(t,"closeTaskPaneAddinCommand",(function(){return a.a})),n.d(t,"initializeAddinsForItem",(function(){return G})),n.d(t,"deinitializeAddinsForItem",(function(){return K})),n.d(t,"onHostItemChanged",(function(){return J})),n.d(t,"initializeExtensibilityContext",(function(){return s.a})),n.d(t,"whenItemHasContextualAddinKeywords",(function(){return Z})),n.d(t,"runContextualEvaluationAndUpdate",(function(){return B})),n.d(t,"triggerAppointmentTimeChangedEvent",(function(){return $.e})),n.d(t,"triggerAttachmentsChangedEvent",(function(){return $.f})),n.d(t,"triggerRecipientsChangedEvent",(function(){return $.h})),n.d(t,"triggerRecurrenceChangedEvent",(function(){return $.i})),n.d(t,"triggerLocationsChangedEvent",(function(){return $.g})),n.d(t,"launchTranslateCommand",(function(){return oe})),n.d(t,"setPersistedAddin",(function(){return ie.a})),n.d(t,"shouldForceOnSendCompliantBehavior",(function(){return ae.a})),n.d(t,"AddinBarView",(function(){return tt})),n.d(t,"TaskPaneCollection",(function(){return nt.a})),n.d(t,"onComposeClose",(function(){return st})),n.d(t,"openContextualCallout",(function(){return ut})),n.d(t,"launchAddinCommand",(function(){return lt})),n.d(t,"observeAddinCommandSurfaceItems",(function(){return ft})),n.d(t,"onItemNavigation",(function(){return pt.a})),n.d(t,"allowItemSendEvent",(function(){return bt})),n.d(t,"ExecuteEntryPoint",(function(){return Se})),n.d(t,"onLaunchEventTriggered",(function(){return At})),n.d(t,"logAppTeachingUICalloutTelemetry",(function(){return gt.t})),n.d(t,"logCustomizeActionButtonAction",(function(){return gt.u})),n.d(t,"convertRecurrenceToAddinFormat",(function(){return _t.a})),n.d(t,"seriesTimeJsonConverter",(function(){return _t.d})),n.d(t,"highlightOverflowAddins",(function(){return xt})),n.d(t,"highlightCustomizeActionButton",(function(){return Et})),n.d(t,"launchThirdPartyOnlineMeetingProviderAddin",(function(){return Mt}))},4289:function(e,t,n){"use strict";var r=n(231),o=n(131),i=n(4044),a=n(4410),s=n(3961),c=n(5859),u=n(2698),l=n(3730),d=n(5407),f=n(5275),p=n(1055),m=n(0),h=n(8),g=n(325),v="ShieldErrorRegular";const y=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M8 5c.28 0 .5.22.5.5v3a.5.5 0 01-1 0v-3c0-.28.22-.5.5-.5zm0 6.5A.75.75 0 108 10a.75.75 0 000 1.5zm-.86-9.46A9.27 9.27 0 012.55 3.5H2.5A.5.5 0 002 4v2.76a7.5 7.5 0 003.69 6.45l2.06 1.22c.15.1.35.1.5 0l2.07-1.22A7.5 7.5 0 0014 6.76V4a.5.5 0 00-.5-.5h-.06a4.96 4.96 0 01-.8-.06 8.98 8.98 0 01-4.29-1.8.5.5 0 00-.7 0l-.11.1c-.09.08-.22.18-.4.3zM3 6.76V4.48a9.6 9.6 0 002.78-.63A9.3 9.3 0 008 2.65l.3.22a9.69 9.69 0 004.7 1.6v2.29a6.5 6.5 0 01-3.2 5.6L8 13.41l-1.8-1.07A6.5 6.5 0 013 6.75z"})),displayName:"ShieldErrorRegular"});Object(h.registerIcons)({icons:{ShieldErrorRegular:m.createElement(y,null)}});var b=n(3493),O=n(5867),S="PersonAddRegular";const C=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M6.22 13.96C3.55 13.66 2 11.8 2 10v-.5C2 8.67 2.67 8 3.5 8h2.1c-.16.32-.3.65-.4 1H3.5a.5.5 0 00-.5.5v.5c0 1.13.88 2.33 2.5 2.8.2.42.44.8.72 1.16zm3.4-8.9a2.75 2.75 0 10-3.3 1.86c.32-.37.68-.7 1.08-.97a1.76 1.76 0 01-2.15-1.7 1.75 1.75 0 113 1.23c.43-.2.89-.33 1.38-.41zM10.5 15a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V10h1.5a.5.5 0 010 1H11v1.5a.5.5 0 01-1 0V11H8.5a.5.5 0 010-1H10V8.5c0-.28.22-.5.5-.5z"})),displayName:"PersonAddRegular"});Object(h.registerIcons)({icons:{PersonAddRegular:m.createElement(C,null)}});var A="MailErrorRegular";const _=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M12 13v-2.2c.35-.1.68-.24 1-.4V13a2 2 0 01-2 2H3a2 2 0 01-2-2V7c0-1.1.9-2 2-2h2.02a5.57 5.57 0 000 1H3a1 1 0 00-1 1v.74l5 2.7.54-.3c.35.22.72.4 1.1.54l-1.4.76a.5.5 0 01-.48 0L2 8.88V13a1 1 0 001 1h8a1 1 0 001-1zm-1.5-3a4.5 4.5 0 100-9 4.5 4.5 0 000 9zM10 3.5a.5.5 0 011 0v2a.5.5 0 01-1 0v-2zm1.13 4a.62.62 0 11-1.25 0 .62.62 0 011.24 0z"})),displayName:"MailErrorRegular"});Object(h.registerIcons)({icons:{MailErrorRegular:m.createElement(_,null)}});var I="MailWarningRegular";const x=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M7.27 5H3a2 2 0 00-2 2v6c0 1.1.9 2 2 2h8a2 2 0 002-2v-1h-1v1a1 1 0 01-1 1H3a1 1 0 01-1-1V8.88l3.08 1.65c-.1-.35-.1-.74.02-1.12L2 7.74V7a1 1 0 011-1h3.77l.5-1zM6.1 9.55l3.5-7a1 1 0 011.78 0l3.5 7A1 1 0 0114 11H7a1 1 0 01-.9-1.45zM10.5 4a.5.5 0 00-.5.5v3a.5.5 0 001 0v-3a.5.5 0 00-.5-.5zm.5 5.5a.5.5 0 10-1 0 .5.5 0 001 0z"})),displayName:"MailWarningRegular"});Object(h.registerIcons)({icons:{MailWarningRegular:m.createElement(x,null)}});var E=n(5811),T=n(4762),w=n(5274),M="BranchRegular";const k=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M4 5.5a3.5 3.5 0 114.49 3.36 5.5 5.5 0 005.26 3.89h.33a3.5 3.5 0 110 1.5h-.33a6.99 6.99 0 01-5.5-2.67v3.5a3.5 3.5 0 11-1.5 0V8.92A3.5 3.5 0 014 5.5zm3.5-2a2 2 0 100 4 2 2 0 000-4zm0 13a2 2 0 100 4 2 2 0 000-4zm8-3a2 2 0 104 0 2 2 0 00-4 0z"})),displayName:"BranchRegular"});Object(h.registerIcons)({icons:{BranchRegular:m.createElement(k,null)}});var j="WindowNewRegular";const P=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M7.5 5.5c0-.28.22-.5.5-.5h2.5c.28 0 .5.22.5.5V8a.5.5 0 01-1 0V6.7L7.35 9.36a.5.5 0 11-.7-.7L9.29 6H8a.5.5 0 01-.5-.5z"}),m.createElement("path",{d:"M4.13 3.7A2.5 2.5 0 016.5 2h5A2.5 2.5 0 0114 4.5v5c0 1.1-.7 2.03-1.7 2.37v.36c0 .34-.1.76-.38 1.12-.3.37-.75.65-1.38.65H4.77A2.75 2.75 0 012 11.23V5.46c0-.55.2-1 .55-1.32.34-.31.78-.45 1.22-.45h.36zM4 4.7h-.23a.81.81 0 00-.55.18c-.12.1-.22.28-.22.58v5.77c0 1 .78 1.77 1.77 1.77h5.77a.7.7 0 00.59-.27.89.89 0 00.18-.5V12H6.5A2.5 2.5 0 014 9.5V4.7zM6.5 3C5.67 3 5 3.67 5 4.5v5c0 .83.67 1.5 1.5 1.5h5c.83 0 1.5-.67 1.5-1.5v-5c0-.83-.67-1.5-1.5-1.5h-5z"})),displayName:"WindowNewRegular"});Object(h.registerIcons)({icons:{WindowNewRegular:m.createElement(P,null)}});var R=n(4763),N=n(4910),D="NotePinRegular";const F=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M6.61 1.46l1.93 1.93a1.5 1.5 0 01-.4 2.4l-1.65.8a1 1 0 00-.51.58l-.38 1.1a1 1 0 01-1.65.38L3 7.71 1.7 9H1v-.7L2.3 7l-.96-.95a1 1 0 01.39-1.65l1.1-.38a1 1 0 00.57-.5l.8-1.66a1.5 1.5 0 012.41-.4zM2 11.5V9.93l.95-.96.05.05v2.48c0 .83.67 1.5 1.5 1.5H8v-2.5A2.5 2.5 0 0110.5 8H13V4.5c0-.83-.67-1.5-1.5-1.5H9.46l-.13-.14L8.47 2h3.03A2.5 2.5 0 0114 4.5v3.67c0 .66-.26 1.3-.73 1.77l-3.33 3.33a2.5 2.5 0 01-1.77.73H4.5A2.5 2.5 0 012 11.5zm7 1.25c.08-.05.16-.12.23-.19l3.33-3.33.2-.23H10.5C9.67 9 9 9.67 9 10.5v2.25z"})),displayName:"NotePinRegular"});Object(h.registerIcons)({icons:{NotePinRegular:m.createElement(F,null)}});var L="PersonChatRegular";const U=Object(g.a)({Svg:e=>m.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),m.createElement("path",{d:"M7.6 13.27l-.21.7C4.62 13.73 3 11.84 3 10v-.5C3 8.67 3.67 8 4.5 8h4.54a4.3 4.3 0 00-1.01 1H4.5a.5.5 0 00-.5.5v.5c0 1.34 1.24 2.78 3.48 2.98l.12.29zM8 1.5A2.75 2.75 0 118 7a2.75 2.75 0 010-5.5zm0 1A1.75 1.75 0 108 6a1.75 1.75 0 000-3.5zm7 9a3.5 3.5 0 01-5.2 3.06L8.41 15a.32.32 0 01-.4-.4l.43-1.4A3.5 3.5 0 1115 11.5zM10.5 10a.5.5 0 000 1h2a.5.5 0 000-1h-2zm-.5 2.5c0 .28.22.5.5.5h1a.5.5 0 000-1h-1a.5.5 0 00-.5.5z"})),displayName:"PersonChatRegular"});Object(h.registerIcons)({icons:{PersonChatRegular:m.createElement(U,null)}});var B=n(5021),H=n(47);n.d(t,"a",(function(){return ee})),n.d(t,"c",(function(){return te})),n.d(t,"b",(function(){return ne}));const V="attach.svg",z="attachDark.svg",W="inlineimage.svg",G="inlineimageDark.svg",q="emoji.svg",K="fluid.svg",X="showribbon.svg",Q="showribbonDark.svg",J="dictate.svg",Y="dictationLanguage.svg",Z="spelling.svg",$=Object(H.j)("mon-densities");function ee(e){let t,n,r=!1;switch(e){case"AddAttachment":t=re(Object(o.g)()?z:V),n=re(V),r=!0;break;case"AddInlineImage":t=re(Object(o.g)()?G:W),n=re(W),r=!0;break;case"AddEmoji":t=re(q),r=!0;break;case"ToggleDarkCompose":t="Sunny";break;case"FluidHeroButton":t=re(K),r=!0;break;case"QuickUse":t="ClipboardList";break;case"ToggleDictation":t=re(J),r=!0;break;case"SetDictationLanguage":t=re(Y),r=!0;break;case"ToggleRibbon":t=re(Object(o.g)()?Q:X),n=re(X),r=!0;break;case"SensitivityMenu":t="MarkAsProtected";break;case"ProtectMessage":t="Encryption";break;case"SaveDraft":t="Save";break;case"InsertSignature":t="InsertSignatureLine";break;case"ShowFrom":t="ArrangeByFrom";break;case"SetImportance":t="Important";break;case"ShowMessageOptions":t="MailOptions";break;case"SwitchBodyType":t="PlainText";break;case"AccChecker":t="AccessibiltyChecker";break;case"ProofingOptions":t=re(Z),r=!0;break;case"MessageExtensions":t=$?B.a:"AddIn";break;default:t=""}return{iconName:t,fallbackIconName:n||t,isImage:r}}function te(e){let t;switch(e){case"-":t="-";break;case"Reply":t=$?i.a:"Reply";break;case"ReplyAll":t=$?a.a:"ReplyAll";break;case"Forward":t=$?s.a:"Forward";break;case"ReplyByMeeting":t=$?p.a:"Calendar";break;case"ReportAbuse":t=$?v:"ReportHacked";break;case"Delete":t=$?u.a:"Delete";break;case"MarkReadUnread":t=$?b.a:"Mail";break;case"FlagUnflag":t=$?l.a:"Flag";break;case"AssignPolicy":t=$?O.a:"Assign";break;case"AddToSafeSenders":t=$?S:"AddFriend";break;case"MarkJunkNotJunk":t=$?A:"MailAlert";break;case"MarkAsPhishing":t=$?I:"Phishing";break;case"Block":t=$?E.a:"BlockContact";break;case"CreateRule":t=$?f.a:"CreateMailRule";break;case"Print":t=$?T.a:"Print";break;case"Translate":t=$?d.a:"LocaleLanguage";break;case"ShowInImmersiveReader":t=$?w.a:"ReadOutLoud";break;case"ViewMessageSource":t=$?M:"OpenSource";break;case"Popout":t=$?j:"OpenInNewWindow";break;case"LikeUnlike":t=$?R.a:"Like";break;case"SetReaction":t=$?c.a:"Emoji2";break;case"ToggleDarkMode":t=$?N.a:"Sunny";break;case"ReplyByIM":case"ReplyAllByIM":t=$?L:"ChatInviteFriend";break;case"ToggleAmp":t="LightningBolt";break;case"AddToBoard":t=$?D:"NotePinned";break;case"MessageExtensions":t=$?B.a:"AddIn";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function ne(e){let t;switch(e){case"-":t="-";break;case"Delete":t="Delete";break;case"Archive":t="Archive";break;case"PinUnpin":t="Pinned";break;case"ReadUnread":t="Mail";break;case"FlagUnflag":t="Flag";break;case"Move":t="FabricFolder";break;default:t=""}return{iconName:t,fallbackIconName:t,isImage:!1}}function re(e){return Object(r.a)("surfaceActions/"+e)}},4292:function(e,t,n){"use strict";var r=n(614),o=n(968),i=n(1692),a=n(38),s=n(4252),c=n(3410),u=n(923),l=n(296);var d=n(4321);function f(){const e=function(){const e=Object(a.a)(),t=Object(l.a)()?e.SessionSettings.DefaultFromAddress:e.UserOptions.SendAddressDefault;return Object(u.d)(t)?t:Object(c.a)()}(),t=Object(c.a)();if(t===e&&Object(d.a)(e)){const e=Object(s.b)(t,!0);if(e&&e.length>0)return e[0]}return e}var p=n(5027);function m(e){let t;if(e){const n=Object(i.g)(),r=null==n?void 0:n.items,o=r&&r.has(e.Id)&&r.get(e.Id);t=o&&Object(p.a)(o.ToRecipients,o.CcRecipients)}if(!t&&Object(r.b)()){const e=Object(o.a)(),{emailAddress:t,displayName:n}=(null==e?void 0:e.m365mailbox)||{};if(t&&n)return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t,Name:n}}return{MailboxType:"Mailbox",RoutingType:"SMTP",EmailAddress:t||f(),Name:Object(a.a)().SessionSettings.UserDisplayName}}n.d(t,"a",(function(){return m}))},4293:function(e,t,n){"use strict";var r=n(2024);const o="_ShowEditorSettingsSource";function i(e,t){return()=>{r.c.import().then(n=>n(e,e=>(e.triggerContentChangedEvent(o,t),null)))}}var a=n(47),s=n(175);function c(){return!!Object(a.j)("mc-officeEditorProofingMasterFlight")&&(Object(s.b)()||Object(s.c)()||Object(a.j)("mc-officeEditorBXFirefoxSafari")&&(Object(s.d)()||Object(s.f)()))}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c}))},43:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"})},4304:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"j",(function(){return o})),n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return a})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m}));var r="function",o="object",i="undefined",a="prototype",s="hasOwnProperty",c="default",u=Object,l=u[a],d=u.assign,f=u.create,p=u.defineProperty,m=l[s]},4320:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r={Name:{id:34230,propertyType:"String"},Description:{id:34231,propertyType:"String"},Id:{id:34232,propertyType:"String"},IsClassified:{id:34229,propertyType:"Boolean"}},o="messageClassification"},4321:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(38),o=n(296);function i(e){let t=!1;if(Object(o.a)()){const n=Object(r.a)();t=0==(e=e.toLowerCase()).indexOf("outlook_"+n.HexCID)||-1!=e.indexOf("@shadow.outlook.com")}return t}},433:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=null,o={},i=1,a=Array,s=a["@wry/context:Slot"]||function(){var e=function(){function e(){this.id=["slot",i++,Date.now(),Math.random().toString(36).slice(2)].join(":")}return e.prototype.hasValue=function(){for(var e=r;e;e=e.parent)if(this.id in e.slots){var t=e.slots[this.id];if(t===o)break;return e!==r&&(r.slots[this.id]=t),!0}return r&&(r.slots[this.id]=o),!1},e.prototype.getValue=function(){if(this.hasValue())return r.slots[this.id]},e.prototype.withValue=function(e,t,n,o){var i,a=((i={__proto__:null})[this.id]=e,i),s=r;r={parent:s,slots:a};try{return t.apply(o,n)}finally{r=s}},e.bind=function(e){var t=r;return function(){var n=r;try{return r=t,e.apply(this,arguments)}finally{r=n}}},e.noContext=function(e,t,n){if(!r)return e.apply(n,t);var o=r;try{return r=null,e.apply(n,t)}finally{r=o}},e}();try{Object.defineProperty(a,"@wry/context:Slot",{value:a["@wry/context:Slot"]=e,enumerable:!1,writable:!1,configurable:!1})}finally{return e}}();s.bind,s.noContext},434:function(e,t,n){"use strict";var r=Function.prototype.toString;t.a=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},4340:function(e,t,n){"use strict";n.d(t,"f",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return g}));var r=n(71),o=n(7),i=n(38);function a(e,t){const n=v(e.selectedCLPLabel,"Change"),{originalCLPLabel:o,selectedCLPLabel:i}=e,a=Object.assign(Object.assign({},n),{IsLabelChanged:!0,LabelIdBefore:o?o.id:null,IsProtectionChanged:!(!o||!i)&&o.isEncryptingLabel!=i.isEncryptingLabel,ProtectedBefore:null==o?void 0:o.isEncryptingLabel,UserJustification:t});r.m.importAndExecute(a)}function s(e){const t=v(e,"Discover");r.m.importAndExecute(t)}function c(e){(null==e?void 0:e.value)&&e.value.length>0&&Object(r.o)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function u(e){e&&Object(r.o)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function l(e,t){t&&e?Object(r.o)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(r.o)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function d(e){401!=e.status&&Object(r.o)("CLPAutoLabelEnabled")}function f(){Object(r.o)("CLPMandatoryLabelDialogShown")}function p(){Object(r.o)("CLPAutoLabelAutomaticApplied")}function m(){Object(r.o)("CLPAutoLabelRecommendedShown")}function h(){Object(r.o)("CLPAutoLabelRecommendedApplied")}function g(){Object(r.o)("CLPAutoLabelRecommendedDismissed")}function v(e,t){const{ExternalDirectoryTenantGuid:n,UserEmailAddress:r}=Object(i.a)().SessionSettings;return{CreationTime:Object(o.vb)(Object(o.Ub)()),Version:"1.1",Operation:t,OrganizationId:n,UserId:r,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},4354:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c}));const r="cal-txp-optionsV2",o="txpb2/api/v1.1/me/{0}",i="txpb2/api/v1.0/me/{0}",a="UserSettings",s="Unblock",c={TXPSettingsLoad:"TxpSettingsLoad",TXPSettingsResponseError:"TXPSettingsResponseError",TxpSettingsSaveV2:"TxpSettingsSaveV2",TxpUnblock:"TxpUnblock"}},439:function(e,t,n){"use strict";var r=n(830),o=n.n(r);n.d(t,"a",(function(){return o.a}));n(1286);var i=o.a.prototype;i["@@observable"]||(i["@@observable"]=function(){return this})},4395:function(e,t,n){"use strict";var r=n(702),o=Object(r.action)("setNumberOfWaitingAttachments")((function(e,t){t<0||(e.numberOfWaitingAttachments=t)})),i=n(3124),a=n(71),s=n(225),c=n(4464),u=n(4683),l=n(2793),d=n(2906),f=n(36),p=n(2108);async function m(e,t,n,r,m,h,g){let v=!1;const y=Object(d.a)(t.smimeViewState);t.itemId||y||(v=!0,o(t,t.numberOfWaitingAttachments+1));try{return t.itemId||y||await Object(i.f)(t)||await Object(i.b)(t),async function(e,t,n,r,o,i,c){if(Object(d.a)(t.smimeViewState)){const r=await l.c.import();try{return await r(e,Object.assign(Object.assign({},t.itemId),{mailboxInfo:Object(s.d)()}),t.attachmentWell,n,t)}catch(e){Object(a.o)("CreateSmimeAttachmentsFromFilesErrorDatapoint",{errorMessage:e.message},{isCore:!0}),f.h.warn(e)}}else if(e.length>0){return(await p.f.import())(t.attachmentWell,Object.assign(Object.assign({},t.itemId),{mailboxInfo:n.mailboxInfo?n.mailboxInfo:Object(s.d)()}),e,t,n,r,o,i,c,t.logTraceId)}return[]}(e,t,n,e=>{r&&r(e),Object(u.a)()&&Object(c.a)(t,8)},m,h,g)}finally{v&&o(t,t.numberOfWaitingAttachments-1)}}n.d(t,"a",(function(){return m}))},4409:function(e){e.exports=JSON.parse('{"a":"Dpa"}')},441:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(0),o=n(370),i=n(849),a=n(442);var s=function(){var e=Object(r.useContext)(a.a),t=Object(o.a)(["theme"]).theme;return e||t||Object(i.a)({})}},4410:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="ArrowReplyAllRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M9.39 3.61c.17.17.2.44.06.64l-.06.07L6.7 7H8c3.52 0 5.89 1.98 6 4.8v.2a.5.5 0 01-1 0c0-2.27-1.8-3.9-4.74-4H6.7l2.69 2.68a.5.5 0 01-.64.77l-.07-.06-3.56-3.57-.05-.07-.03-.06-.02-.06L5 7.57v-.2l.03-.06.04-.08.05-.07 3.55-3.55c.2-.2.51-.2.7 0zM2.15 7.15l3.5-3.5a.5.5 0 01.76.63l-.06.07L3.21 7.5l3.14 3.15a.5.5 0 01-.63.76l-.07-.06-3.5-3.5a.5.5 0 01-.06-.63l.06-.07 3.5-3.5-3.5 3.5z"})),displayName:"ArrowReplyAllRegular"});Object(o.registerIcons)({icons:{ArrowReplyAllRegular:r.createElement(a,null)}})},442:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0),o=r.createContext(void 0)},4421:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(38);function o(e,t){return e===t||e&&t&&e.toLowerCase()==t.toLowerCase()}function i(e){return e&&o(e.EmailAddress,Object(r.a)().SessionSettings.UserEmailAddress)}},443:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(1);function o(e,t,n,o,a){return void 0===a&&(a=!1),function(e,t){var n="";!0===t&&(n=" /* @deprecated */");return e.listTextColor=e.listText+n,e.menuItemBackgroundChecked+=n,e.warningHighlight+=n,e.warningText=e.messageText+n,e.successText+=n,e}(i(e,t,Object(r.__assign)({primaryButtonBorder:"transparent",errorText:o?"#F1707B":"#a4262c",messageText:o?"#F3F2F1":"#323130",messageLink:o?"#6CB8F6":"#005A9E",messageLinkHovered:o?"#82C7FF":"#004578",infoIcon:o?"#C8C6C4":"#605e5c",errorIcon:o?"#F1707B":"#A80000",blockingIcon:o?"#442726":"#FDE7E9",warningIcon:o?"#C8C6C4":"#797775",severeWarningIcon:o?"#FCE100":"#D83B01",successIcon:o?"#92C353":"#107C10",infoBackground:o?"#323130":"#f3f2f1",errorBackground:o?"#442726":"#FDE7E9",blockingBackground:o?"#442726":"#FDE7E9",warningBackground:o?"#433519":"#FFF4CE",severeWarningBackground:o?"#4F2A0F":"#FED9CC",successBackground:o?"#393D1B":"#DFF6DD",warningHighlight:o?"#fff100":"#ffb900",successText:o?"#92c353":"#107C10"},n),o),a)}function i(e,t,n,o,i){void 0===i&&(i=!1);var a={},s=e||{},c=s.white,u=s.black,l=s.themePrimary,d=s.themeDark,f=s.themeDarker,p=s.themeDarkAlt,m=s.themeLighter,h=s.neutralLight,g=s.neutralLighter,v=s.neutralDark,y=s.neutralQuaternary,b=s.neutralQuaternaryAlt,O=s.neutralPrimary,S=s.neutralSecondary,C=s.neutralSecondaryAlt,A=s.neutralTertiary,_=s.neutralTertiaryAlt,I=s.neutralLighterAlt,x=s.accent;return c&&(a.bodyBackground=c,a.bodyFrameBackground=c,a.accentButtonText=c,a.buttonBackground=c,a.primaryButtonText=c,a.primaryButtonTextHovered=c,a.primaryButtonTextPressed=c,a.inputBackground=c,a.inputForegroundChecked=c,a.listBackground=c,a.menuBackground=c,a.cardStandoutBackground=c),u&&(a.bodyTextChecked=u,a.buttonTextCheckedHovered=u),l&&(a.link=l,a.primaryButtonBackground=l,a.inputBackgroundChecked=l,a.inputIcon=l,a.inputFocusBorderAlt=l,a.menuIcon=l,a.menuHeader=l,a.accentButtonBackground=l),d&&(a.primaryButtonBackgroundPressed=d,a.inputBackgroundCheckedHovered=d,a.inputIconHovered=d),f&&(a.linkHovered=f),p&&(a.primaryButtonBackgroundHovered=p),m&&(a.inputPlaceholderBackgroundChecked=m),h&&(a.bodyBackgroundChecked=h,a.bodyFrameDivider=h,a.bodyDivider=h,a.variantBorder=h,a.buttonBackgroundCheckedHovered=h,a.buttonBackgroundPressed=h,a.listItemBackgroundChecked=h,a.listHeaderBackgroundPressed=h,a.menuItemBackgroundPressed=h,a.menuItemBackgroundChecked=h),g&&(a.bodyBackgroundHovered=g,a.buttonBackgroundHovered=g,a.buttonBackgroundDisabled=g,a.buttonBorderDisabled=g,a.primaryButtonBackgroundDisabled=g,a.disabledBackground=g,a.listItemBackgroundHovered=g,a.listHeaderBackgroundHovered=g,a.menuItemBackgroundHovered=g),y&&(a.primaryButtonTextDisabled=y,a.disabledSubtext=y),b&&(a.listItemBackgroundCheckedHovered=b),A&&(a.disabledBodyText=A,a.variantBorderHovered=(null==n?void 0:n.variantBorderHovered)||A,a.buttonTextDisabled=A,a.inputIconDisabled=A,a.disabledText=A),O&&(a.bodyText=O,a.actionLink=O,a.buttonText=O,a.inputBorderHovered=O,a.inputText=O,a.listText=O,a.menuItemText=O),I&&(a.bodyStandoutBackground=I,a.defaultStateBackground=I),v&&(a.actionLinkHovered=v,a.buttonTextHovered=v,a.buttonTextChecked=v,a.buttonTextPressed=v,a.inputTextHovered=v,a.menuItemTextHovered=v),S&&(a.bodySubtext=S,a.focusBorder=S,a.inputBorder=S,a.smallInputBorder=S,a.inputPlaceholderText=S),C&&(a.buttonBorder=C),_&&(a.disabledBodySubtext=_,a.disabledBorder=_,a.buttonBackgroundChecked=_,a.menuDivider=_),x&&(a.accentButtonBackground=x),(null==t?void 0:t.elevation4)&&(a.cardShadow=t.elevation4),!o&&(null==t?void 0:t.elevation8)?a.cardShadowHovered=t.elevation8:a.variantBorderHovered&&(a.cardShadowHovered="0 0 1px "+a.variantBorderHovered),a=Object(r.__assign)(Object(r.__assign)({},a),n)}},4439:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3015);function o(){return r.a.txpSettings}},4456:function(e,t,n){"use strict";function r(e,t){if(e){e(function(e){const t={};return t.Error=e,t}(t.EventResponseCode))}}function o(e,t){(function(e){return void 0!==e.invokeHandlerIfPreviousOnTriggerFailed})(e)&&e.invokeHandlerIfPreviousOnTriggerFailed(t)}var i;!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT=9032]="API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT",e[e.INTERNAL_ERROR=5001]="INTERNAL_ERROR",e[e.URL_NOT_IN_APP_DOMAINS=12004]="URL_NOT_IN_APP_DOMAINS",e[e.WEB_DIALOG_CLOSED=12006]="WEB_DIALOG_CLOSED",e[e.DIALOG_ALREADY_OPEN=12007]="DIALOG_ALREADY_OPEN"}(i||(i={}));var a=i;const s="DialogApiEventError",c="ApiEventError";function u(e,t,n){return{EventResponseCode:e,ErrorClassification:t,ErrorDetails:n}}function l(){return u(a.SUCCESS)}function d(e){return e.EventResponseCode===a.SUCCESS}function f(e,t){return l()}function p(e){return l()}function m(e,t){return l()}function h(e){return e}function g(e){return[JSON.stringify(e)]}var v;!function(e){e[e.DISPLAY_DIALOG_DISPID=10]="DISPLAY_DIALOG_DISPID",e[e.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID=11]="DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID",e[e.DIALOG_PARENT_MESSAGE_RECEIVED=12]="DIALOG_PARENT_MESSAGE_RECEIVED",e[e.ITEM_CHANGED_EVENT_DISPID=46]="ITEM_CHANGED_EVENT_DISPID",e[e.RECIPIENTS_CHANGED_EVENT_DISPID=47]="RECIPIENTS_CHANGED_EVENT_DISPID",e[e.APPOINTMENT_TIME_CHANGED_EVENT_DISPID=48]="APPOINTMENT_TIME_CHANGED_EVENT_DISPID",e[e.RECURRENCE_CHANGED_EVENT=49]="RECURRENCE_CHANGED_EVENT",e[e.ATTACHMENTS_CHANGED_EVENT_DISPID=50]="ATTACHMENTS_CHANGED_EVENT_DISPID",e[e.LOCATIONS_CHANGED_EVENT=51]="LOCATIONS_CHANGED_EVENT"}(v||(v={}));const y={},b={};function O(e,t){var n,r;switch(t){case v.DIALOG_PARENT_MESSAGE_RECEIVED:let e=b[t];if(null===(n=y[e])||void 0===n?void 0:n[t])return y[e][t]}return(null===(r=y[e])||void 0===r?void 0:r[t])?y[e][t]:null}function S(e){delete y[e]}function C(e,t){return!!O(e,t)}var A=n(71),_=n(1810),I=n(2),x=n(3643);function E(e,t,n,o,i){const s=z(e);let f=s.onTrigger(n,t);if(d(f)&&(f=function(e,t,n,r){const o=O(e,t);if(!o)return u(a.INTERNAL_ERROR,c,"HandlerNotRegistered");const i=n.formatArgsForHandler(r);return o(i),l()}(t,e,s,n)),r(o,f),i){const n=Object(_.m)(t),r=f.EventResponseCode;Object(A.o)("ExecuteEvent",{dispId:e,Id:Object(x.m)(n.get_MarketPlaceAssetId(),n.get_ExtensionId(),n.get_ProviderName(),n.get_TypeString()),DisplayName:n.get_ExtensionDisplayName(),owa_1:Object(I.m)(),owa_2:Object(_.B)(i),extPoint:Object(_.s)(t),owa_4:n.get_Type(),EventResponseCode:r})}}var T=n(326);function w(e,t){const n=Object(_.n)(e),r=JSON.parse(n);if(Object(_.L)(n))return u(a.DIALOG_ALREADY_OPEN,s,a[a.DIALOG_ALREADY_OPEN]);if(!function(e,t){if(t&&1==t.displayInIframe){return function(e,t){return Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(e,t)}(Object(_.m)(e).get_AppDomains(),t.url)}return!0}(e,t))return u(a.URL_NOT_IN_APP_DOMAINS,s,a[a.URL_NOT_IN_APP_DOMAINS]);let o=function(e,t,n){const r=Object(_.n)(e),o=JSON.parse(r);return t&&1==t.displayInIframe?{controlId:Object(T.a)(),dialogType:1,url:t.url,heightInPercentage:t.height,widthInPercentage:t.width,parentControlId:e,isOpen:n,hostItemIndex:o.hostItemIndex,tabId:o.tabId}:Object(_.S)(e)?{controlId:Object(T.a)(),dialogType:2,parentControlId:e,isOpen:n,hostItemIndex:o.hostItemIndex,tabId:o.tabId}:null}(e,t,!0);return Object(_.W)(o,r.tabId,r.hostItemIndex),l()}function M(e){const t=Object(_.n)(e),n=JSON.parse(t);return Object(_.W)(null,n.tabId,n.hostItemIndex),E(v.DISPLAY_DIALOG_DISPID,e,null),l()}function k(e,t){return l()}function j(e){return function(e){return null!=e&&void 0!==e.messageToParent}(e)?function(e){const t=e.messageToParent,n=e.targetOrigin,r=e.SecurityOrigin;return{messageType:"0",messageContent:t,targetOrigin:n,messageOrigin:r}}(e):{messageType:a.WEB_DIALOG_CLOSED}}let P=!1,R=null;function N(e,t){return function(e,t){C(t,v.ITEM_CHANGED_EVENT_DISPID)||(P=!0,R={controlId:t,args:e},Object(A.o)("ExtTriggerUnregisteredItemChangedEvent"))}(e,t),l()}function D(e){P&&R.controlId===e&&E(v.ITEM_CHANGED_EVENT_DISPID,e,R.args),P=!1,R=null}function F(e){return[JSON.stringify(e)]}function L(e){return[JSON.stringify(e)]}function U(e){const t={recurrence:JSON.stringify(e.recurrence)};return[JSON.stringify(t)]}function B(e){return[JSON.stringify(e)]}function H(){return l()}function V(e){return e?function(e){const t=e.messageContent,n=e.targetOrigin,r=e.SecurityOrigin;return{messageType:"0",messageContent:t,targetOrigin:n,messageOrigin:r}}(e):{messageType:a.WEB_DIALOG_CLOSED}}function z(e){switch(e){case v.DISPLAY_DIALOG_DISPID:case v.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:return{register:w,unregister:M,onTrigger:k,formatArgsForHandler:j};case v.DIALOG_PARENT_MESSAGE_RECEIVED:return{register:f,unregister:p,onTrigger:H,formatArgsForHandler:V};case v.ITEM_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:N,formatArgsForHandler:h,invokeHandlerIfPreviousOnTriggerFailed:D};case v.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:g};case v.RECIPIENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:L};case v.RECURRENCE_CHANGED_EVENT:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:U};case v.LOCATIONS_CHANGED_EVENT:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:F};case v.ATTACHMENTS_CHANGED_EVENT_DISPID:return{register:f,unregister:p,onTrigger:m,formatArgsForHandler:B};default:throw new Error("ApiEvent not implemented")}}var W=n(47);const G=[v.DISPLAY_DIALOG_DISPID];function q(e,t,n){const i=function(e,t){const n=Object(_.m)(e),r=Object(_.N)(n),o=G.includes(t);return!(!r||!o)}(t.controlId,t.eventDispId);if(Object(W.j)("addin-autoRun")&&i)return Object(A.o)("ExtRegisterApiEventNotSupportedInAutorun",[t.eventDispId]),void r(n,u(a.API_CALL_NOT_SUPPORTED_BY_EXTENSIONPOINT));if(Object(_.S)(t.controlId)&&function(e){switch(e){case v.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID:case v.DISPLAY_DIALOG_DISPID:case v.DIALOG_PARENT_MESSAGE_RECEIVED:return!1;case v.APPOINTMENT_TIME_CHANGED_EVENT_DISPID:case v.ITEM_CHANGED_EVENT_DISPID:case v.RECIPIENTS_CHANGED_EVENT_DISPID:case v.RECURRENCE_CHANGED_EVENT:case v.LOCATIONS_CHANGED_EVENT:case v.ATTACHMENTS_CHANGED_EVENT_DISPID:return!0}}(t.eventDispId))return void r(n,l());const s=function(e){return e.targetId?JSON.parse(e.targetId):null}(t),c=z(t.eventDispId);let f=c.register(t.controlId,s);d(f)&&(f=function(e,t,n){return function(e,t,n){y[e]||(y[e]={},b[t]=e),y[e][t]=n}(e,t,n),l()}(t.controlId,t.eventDispId,e)),r(n,f),o(c,t.controlId)}function K(e,t){let n=z(e.eventDispId).unregister(e.controlId);d(n)&&(n=function(e,t){if(!C(e,t))return u(a.INTERNAL_ERROR,c,"ControlNotRegistered");return function(e,t){var n;(null===(n=y[e])||void 0===n?void 0:n[t])&&delete y[e][t]}(e,t),l()}(e.controlId,e.eventDispId)),r(t,n)}function X(e,t,n){const r=Object(_.p)(e);var o=!1,i=null;r.forEach(r=>{C(r,t)&&(o||(o=!0,i=n()),E(t,r,i,null,e))})}var Q=n(1785),J=n(1797);function Y(e,t){const n=Object(Q.c)(e);null!=n&&n.mode===J.a.AppointmentOrganizer&&X(e,v.APPOINTMENT_TIME_CHANGED_EVENT_DISPID,()=>t)}var Z=n(282),$=n(3940);function ee(e,t,n){const r=Object(_.r)(e),o=Object(Q.c)(r);if(null==o||o.mode!==J.a.AppointmentOrganizer&&o.mode!==J.a.MessageCompose)return;let i=null;switch(t){case $.c.Added:i="added";break;case $.c.Deleted:i="removed";break;default:Object(Z.a)(t)}let a={attachmentStatus:i,attachmentDetails:n};X(r,v.ATTACHMENTS_CHANGED_EVENT_DISPID,()=>a)}function te(e,t){const n=Object(Q.c)(e);null==n||n.mode!==J.a.AppointmentOrganizer&&n.mode!==J.a.MessageCompose||X(e,v.RECIPIENTS_CHANGED_EVENT_DISPID,()=>t)}function ne(e,t){const n=Object(Q.c)(e);null!=n&&n.mode===J.a.AppointmentOrganizer&&X(e,v.RECURRENCE_CHANGED_EVENT,()=>({recurrence:t}))}function re(e,t){const n=Object(_.r)(e),r=Object(Q.c)(n);if(null!=r&&r.mode===J.a.AppointmentOrganizer){const e=t.map($.g);X(n,v.LOCATIONS_CHANGED_EVENT,()=>({enhancedLocations:e}))}}n.d(t,"c",(function(){return q})),n.d(t,"j",(function(){return K})),n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return S})),n.d(t,"e",(function(){return Y})),n.d(t,"f",(function(){return ee})),n.d(t,"h",(function(){return te})),n.d(t,"i",(function(){return ne})),n.d(t,"g",(function(){return re})),n.d(t,"a",(function(){return v}))},446:function(e,t,n){(function(e,r){var o;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof r&&r;a.global!==a&&a.window!==a&&a.self;var s,c=2147483647,u=36,l=1,d=26,f=38,p=700,m=72,h=128,g="-",v=/^xn--/,y=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=u-l,C=Math.floor,A=String.fromCharCode;function _(e){throw new RangeError(O[e])}function I(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function x(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+I((e=e.replace(b,".")).split("."),t).join(".")}function E(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function T(e){return I(e,(function(e){var t="";return e>65535&&(t+=A((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=A(e)})).join("")}function w(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function M(e,t,n){var r=0;for(e=n?C(e/p):e>>1,e+=C(e/t);e>S*d>>1;r+=u)e=C(e/S);return C(r+(S+1)*e/(e+f))}function k(e){var t,n,r,o,i,a,s,f,p,v,y,b=[],O=e.length,S=0,A=h,I=m;for((n=e.lastIndexOf(g))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&_("not-basic"),b.push(e.charCodeAt(r));for(o=n>0?n+1:0;o<O;){for(i=S,a=1,s=u;o>=O&&_("invalid-input"),((f=(y=e.charCodeAt(o++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:u)>=u||f>C((c-S)/a))&&_("overflow"),S+=f*a,!(f<(p=s<=I?l:s>=I+d?d:s-I));s+=u)a>C(c/(v=u-p))&&_("overflow"),a*=v;I=M(S-i,t=b.length+1,0==i),C(S/t)>c-A&&_("overflow"),A+=C(S/t),S%=t,b.splice(S++,0,A)}return T(b)}function j(e){var t,n,r,o,i,a,s,f,p,v,y,b,O,S,I,x=[];for(b=(e=E(e)).length,t=h,n=0,i=m,a=0;a<b;++a)(y=e[a])<128&&x.push(A(y));for(r=o=x.length,o&&x.push(g);r<b;){for(s=c,a=0;a<b;++a)(y=e[a])>=t&&y<s&&(s=y);for(s-t>C((c-n)/(O=r+1))&&_("overflow"),n+=(s-t)*O,t=s,a=0;a<b;++a)if((y=e[a])<t&&++n>c&&_("overflow"),y==t){for(f=n,p=u;!(f<(v=p<=i?l:p>=i+d?d:p-i));p+=u)I=f-v,S=u-v,x.push(A(w(v+I%S,0))),f=C(I/S);x.push(A(w(f,0))),i=M(n,O,r==o),n=0,++r}++n,++t}return x.join("")}s={version:"1.4.1",ucs2:{decode:E,encode:T},decode:k,encode:j,toASCII:function(e){return x(e,(function(e){return y.test(e)?"xn--"+j(e):e}))},toUnicode:function(e){return x(e,(function(e){return v.test(e)?k(e.slice(4).toLowerCase()):e}))}},void 0===(o=function(){return s}.call(t,n,t,e))||(e.exports=o)}()}).call(this,n(369)(e),n(190))},4461:function(e,t,n){"use strict";var r,o=n(1),i=n(3363),a=".",s={};!function(e){var t=9007199254740991,n=-t,r=98,o=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,i=/^[a-zA-Z0-9_\.]{1,95}$/;function a(e){return i.test(e)}function s(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!a(e.name))throw new Error("Invalid dataField name");2===e.dataType&&c(e.value)}))}function c(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<n||e>t)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>r)return!1;return o.test(e)}(e.eventName))throw new Error("Invalid eventName");var t=e.eventContract;if(t){if(t.name&&!a(t.name))throw new Error("Invalid eventContract");s(t.dataFields)}s(e.dataFields)},e.validateInt=c}(r||(r={}));var c=n(2875);n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return d}));var u=-1;function l(e){var t={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?Object(o.__assign)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t}var d=function(){function e(e,t,n){var r,i;this.telemetrySinks=[],this.persistentDataFields=[],this.eventQueue=[],this.config=n||{},e&&(this.telemetrySinks=e.telemetrySinks,(r=this.persistentDataFields).push.apply(r,e.persistentDataFields),this.config=Object(o.__assign)(Object(o.__assign)({},e.getConfig()),this.config)),t&&(i=this.persistentDataFields).push.apply(i,t)}return e.prototype.sendTelemetryEvent=function(e){var t=l(e),n=t.telemetryProperties;if(n.customerContentVersion||n.customerContentType)Object(i.b)(0,0,(function(){return"Customer content"}));else{if(!n.ariaTenantToken||!n.nexusTenantToken){var r=function(e){for(var t=e.length;t>0;){var n=e.substr(0,t);if(s[n])return s[n];t=e.lastIndexOf(a,t-1)}}(t.eventName);if(!r)return void Object(i.b)(0,0,(function(){return"No tenant token: "+e.eventName}));n.ariaTenantToken=r.ariaTenantToken,n.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(t)}},e.prototype.sendCustomerContent=function(e){var t=l(e),n=t.telemetryProperties;return(!n.customerContentVersion||n.customerContentVersion>1)&&(n.customerContentVersion=1),n.ariaTenantToken=void 0,n.nexusTenantToken=void 0,t.dataFields.push(Object(c.c)("EventContent.Type",2)),this.sendTelemetryEventInternal(t)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):Object(i.b)(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void Object(i.a)(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(t){var n=e.telemetryProperties;n.customerContentVersion&&n.customerContentType?t.sendCustomerContent&&t.sendCustomerContent(e):t.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t,n;e.dataFields&&(null===(n=e.dataFields)||void 0===n||n.unshift(Object(c.d)("OTelJS.Version","4.3.10")),this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields)),this.config.disableValidation||r.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,t=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&t.forEach((function(t){e.sendTelemetryEventInternal(t)}))},e.prototype.setTenantToken=function(e,t,n){!function(e,t){e.substring(0,7)==="Office"+a&&e[e.length-1]!==a?s[e]=t:Object(i.b)(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:t,nexusTenantToken:n})},e.prototype.cloneEvent=function(e){return l(e)},e.prototype.getConfig=function(){return this.config},e}()},4464:function(e,t,n){"use strict";var r=n(6),o=n(4792),i=n(2036),a=n(2630),s=n(35);function c(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetDlpPolicyTipsRequest:#Exchange"},n)),Object(s.a)("GetDlpPolicyTips",e,t)}var u=n(296),l=n(2101),d=n(702),f=n(3093),p=n(4261),m=n(36);n.d(t,"b",(function(){return y}));const h=Object(d.action)("triggerPolicyTips")((function(e,t,n,r,i,a){var s,u,d,p;const m=e.policyTipsViewState;if(m.handlerDisabled||(null===(s=e.protectionViewState)||void 0===s?void 0:s.IRMData))return;const{inProgressPolicyMatch:y,succeededPolicyMatch:S,pendingPolicyMatch:C}=m;if(n||(n=b(e.subject)),r||(r=b(e.content)),i||(i=Object(o.a)(e)),a||(a=null===(p=null===(d=null===(u=e.protectionViewState)||void 0===u?void 0:u.clpViewState)||void 0===d?void 0:d.selectedCLPLabel)||void 0===p?void 0:p.id),m.isRequestInProgress)m.pendingRequests=!0,C.itemId=e.itemId,C.subjectChecksum=n,C.contentChecksum=r,C.eventTrigger=t,C.attachmentIds=i,C.CLPLabelId=a;else{if(m.pendingRequests=!1,y.itemId=e.itemId,y.subjectChecksum=n,y.contentChecksum=r,y.eventTrigger=t,y.attachmentIds=i,y.CLPLabelId=a,0==(_=y).subjectChecksum&&0==_.contentChecksum&&0==_.attachmentIds.length)return S.policyMatchDetails=[],S.subjectChecksum=0,S.contentChecksum=0,S.attachmentIds=[],S.CLPLabelId="",void Object(l.a)(e,"dlpPolicyTips");(O(y,S)||function(e,t){if(e.attachmentIds.length!=t.attachmentIds.length)return!0;for(let n=0;n<e.attachmentIds.length;n++)if(null!=e.attachmentIds[n]&&null!=t.attachmentIds[n]&&e.attachmentIds[n].Id!=t.attachmentIds[n].Id)return!0;return!1}(y,S)||(A=S,y.CLPLabelId!=A.CLPLabelId)||1==t)&&function(e){const{succeededPolicyMatch:t,inProgressPolicyMatch:n}=e.policyTipsViewState,r=e.itemId;if(null==r?void 0:r.Id){const o={ItemId:r,ClientSupportsScanResultData:!0,ScanResultData:t.scanResultData,ScanResultMetadata:t.scanResultMetaData,BodyOrSubjectChanged:O(n,t),NeedToReclassify:!t.itemId,CustomizedStringsNeeded:!0,Recipients:Object(f.a)(e),EventTrigger:n.eventTrigger};e.policyTipsViewState.isRequestInProgress=!0,c(o).then(t=>{!function(e,t,n,r){const o=t.policyTipsViewState,i=o.pendingPolicyMatch;o.isRequestInProgress=!1,o.pendingRequests&&i&&h(t,i.eventTrigger,i.subjectChecksum,i.contentChecksum,i.attachmentIds,i.CLPLabelId);0==e.EvaluationResult||1==e.OptimizationResult||2==e.EvaluationResult?n(t,e):r(t,e)}(t,e,g,v)})}}(e)}var A,_}));t.a=h;function g(e,t){const n=e.policyTipsViewState,{succeededPolicyMatch:r,inProgressPolicyMatch:o}=n;r.itemId=o.itemId,r.attachmentIds=o.attachmentIds,r.subjectChecksum=o.subjectChecksum,r.contentChecksum=o.contentChecksum,r.CLPLabelId=o.CLPLabelId,r.policyMatchDetails=t.Matches,t.ScanResultData&&(r.scanResultData=t.ScanResultData),t.ScanResultMetadata&&(r.scanResultMetaData=t.ScanResultMetadata),1==t.OptimizationResult&&(n.handlerDisabled=!0),function(e,t){if(t){const n=e.policyTipsViewState,r={complianceUrl:t.ComplianceURL,blockString:t.PolicyTipMessageBlockString,notifyString:t.PolicyTipMessageNotifyString,overrideString:t.PolicyTipMessageOverrideString},o=(e,t)=>t||e;Object(a.a)(n,r,o)}}(e,t.CustomizedStrings),y(e)}function v(e,t){const n=e.policyTipsViewState;t?(m.h.warn(Object(r.c)("PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult)+" Diagnostic: "+t.DiagnosticData),4!=t.EvaluationResult&&7!=t.EvaluationResult&&1!=t.EvaluationResult&&6!=t.EvaluationResult&&8!=t.EvaluationResult||(m.h.warn("Disabling further PolicyTips requests because of the failure"),n.handlerDisabled=!0)):(m.h.warn("PolicyTipsResponse is null (PolicyTipsRequest is timed out)"),n.handlerDisabled=!0),Object(l.a)(e,"dlpPolicyTips")}function y(e){Object(l.a)(e,["consumerDlpPolicyTips","enterpriseDlpPolicyTips"]),Object(p.a)(e.policyTipsViewState.succeededPolicyMatch)&&(Object(u.a)()?Object(i.a)(e,"consumerDlpPolicyTips"):Object(i.a)(e,"enterpriseDlpPolicyTips"))}function b(e){let t=0;if(e)for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return t}function O(e,t){return e.subjectChecksum!=t.subjectChecksum||e.contentChecksum!=t.contentChecksum}},447:function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},4494:function(e){e.exports=JSON.parse('{"a":"Lpa"}')},4495:function(e){e.exports=JSON.parse('{"a":"Fpa"}')},4536:function(e){e.exports=JSON.parse('{"a":"Bpa"}')},4555:function(e,t,n){"use strict";function r(e){const t=[];if(null==e?void 0:e.recipients)for(const n of e.recipients){const e=n.persona.EmailAddress;(null==e?void 0:e.ItemId)&&"PrivateDL"==e.MailboxType?t.push({Name:e.Name,RoutingType:e.RoutingType,MailboxType:e.MailboxType,ItemId:{Id:e.ItemId.Id,ChangeKey:null},EmailAddressIndex:e.EmailAddressIndex,RelevanceScore:e.RelevanceScore||0}):t.push(n.persona.EmailAddress)}return t}n.d(t,"a",(function(){return r}))},4556:function(e,t,n){"use strict";n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));let r={};function o(e,t){var n;if(t)for(const e of t.recipientEditors)e.getContent();else for(const t of e)null===(n=r[t.recipientWellId])||void 0===n||n.getContent()}function i(e,t){r[e]=t}function a(e){delete r[e]}function s(e){return r[e]}},4603:function(e,t,n){"use strict";var r=n(20),o=n(3234),i=n(3811),a=(n(3951),n(3952)),s=n(4042),c=n(3),u=n(2816);Object(c.mutator)(o.a,e=>{const{appManifest:t,entityId:n,subEntityId:r,subEntityLabel:o}=e;if(!t||!t.staticTabs||0===t.staticTabs.length)return void(Object(u.a)().isInError=!0);const i=t.staticTabs.map(e=>e.entityId).indexOf(n)>-1;Object(u.a)().hostedApp=t,Object(u.a)().selectedEntityId=n&&i?n:t.staticTabs[0].entityId,r&&(Object(u.a)().selectedSubEntityId=r),o&&(Object(u.a)().subEntityLabel=o)}),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return o.a})),n.d(t,"f",(function(){return i.a})),n.d(t,"b",(function(){return a.a})),n.d(t,"c",(function(){return s.a}));const l=new r.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(314)]).then(n.bind(null,19656))),d=Object(r.d)(l,e=>e.AppHostContainer),f=new r.a(l,e=>e.tryOpenMOSAppWithContext),p=new r.a(l,e=>e.dispatchOpenMetaOsApp)},4622:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(7761),o=n(4166),i={NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32},a={Normal:1,CostDeferred:2,RealTime:3,Immediate:4},s={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},c=Object(r.a)(Object(r.a)({},o.b),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520})},4623:function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"d",(function(){return A})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return I})),n.d(t,"e",(function(){return k}));var r=n(4166),o=n(3226),i=n(2285),a="toGMTString",s="toUTCString",c="cookie",u="expires",l="enabled",d="isCookieUseDisabled",f="disableCookiesUsage",p="_ckMgr",m="",h=null,g=null,v=null,y=Object(o.d)(),b={},O={};function S(e,t){var n=_[p]||O[p];return n||(n=_[p]=_(e,t),O[p]=n),n}function C(e){return!e||e.isEnabled()}function A(e,t){var n;if(e)n=e.getCookieMgr();else if(t){var r=t.cookieCfg;n=r[p]?r[p]:_(t)}return n||(n=S(t,(e||{}).logger)),n}function _(e,t){var n=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Object(i.D)(t,"domain",e.cookieDomain,i.p,i.r),Object(i.D)(t,"path",e.cookiePath||"/",null,i.r),Object(i.r)(t[l])){var n=void 0;Object(i.x)(e[d])||(n=!e[d]),Object(i.x)(e[f])||(n=!e[f]),t[l]=n}return t}(e||O),r=n.path||"/",c=n.domain,h=!1!==n[l],v={isEnabled:function(){var e=h&&I(t),n=O[p];return e&&n&&v!==n&&(e=C(n)),e},setEnabled:function(e){h=!1!==e},set:function(e,t,l,d,f){var p=!1;if(C(v)){var h={},y=Object(i.H)(t||m),b=y.indexOf(";");if(-1!==b&&(y=Object(i.H)(t.substring(0,b)),h=x(t.substring(b+1))),Object(i.D)(h,"domain",d||c,i.v,i.x),!Object(i.r)(l)){var O=Object(o.o)();if(Object(i.x)(h[u])){var S=Object(i.f)()+1e3*l;if(S>0){var A=new Date;A.setTime(S),Object(i.D)(h,u,E(A,O?a:s)||E(A,O?a:s)||m,i.v)}}O||Object(i.D)(h,"max-age",m+l,null,i.x)}var _=Object(o.g)();_&&"https:"===_.protocol&&(Object(i.D)(h,"secure",null,null,i.x),null===g&&(g=!k((Object(o.i)()||{}).userAgent)),g&&Object(i.D)(h,"SameSite","None",null,i.x)),Object(i.D)(h,"path",f||r,null,i.x),(n.setCookie||M)(e,T(y,h)),p=!0}return p},get:function(e){var t=m;return C(v)&&(t=(n.getCookie||w)(e)),t},del:function(e,t){var n=!1;return C(v)&&(n=v.purge(e,t)),n},purge:function(e,r){var i,a=!1;if(I(t)){var s=((i={}).path=r||"/",i[u]="Thu, 01 Jan 1970 00:00:01 GMT",i);Object(o.o)()||(s["max-age"]="0"),(n.delCookie||M)(e,T(m,s)),a=!0}return a}};return v[p]=v,v}function I(e){if(null===h){h=!1;try{h=void 0!==(y||{})[c]}catch(t){e&&e.throwInternal(r.a.WARNING,r.b.CannotAccessCookie,"Cannot access document.cookie - "+Object(i.h)(t),{exception:Object(o.a)(t)})}}return h}function x(e){var t={};if(e&&e.length){var n=Object(i.H)(e).split(";");Object(i.a)(n,(function(e){if(e=Object(i.H)(e||m)){var n=e.indexOf("=");-1===n?t[e]=null:t[Object(i.H)(e.substring(0,n))]=Object(i.H)(e.substring(n+1))}}))}return t}function E(e,t){return Object(i.o)(e[t])?e[t]():null}function T(e,t){var n=e||m;return Object(i.z)(t,(function(e,t){n+="; "+e+(Object(i.r)(t)?m:"="+t)})),n}function w(e){var t=m;if(y){var n=y[c]||m;v!==n&&(b=x(n),v=n),t=Object(i.H)(b[e]||m)}return t}function M(e,t){y&&(y[c]=e+"="+t)}function k(e){return!!Object(i.u)(e)&&(!(!Object(i.E)(e,"CPU iPhone OS 12")&&!Object(i.E)(e,"iPad; CPU OS 12"))||(!!(Object(i.E)(e,"Macintosh; Intel Mac OS X 10_14")&&Object(i.E)(e,"Version/")&&Object(i.E)(e,"Safari"))||(!(!Object(i.E)(e,"Macintosh; Intel Mac OS X 10_14")||!Object(i.F)(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!Object(i.E)(e,"Chrome/5")&&!Object(i.E)(e,"Chrome/6"))||(!(!Object(i.E)(e,"UnrealEngine")||Object(i.E)(e,"Chrome"))||!(!Object(i.E)(e,"UCBrowser/12")&&!Object(i.E)(e,"UCBrowser/11")))))))}},4634:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(3006),o=n(47);const i=["db5e5970-212f-477f-a3fc-2227dc7782bf","4c4ec2e8-4a2c-4bce-8d8f-00fc664a4e5b","9b049ed6-fc8b-40c7-815b-bf84e344d270","f3a6e67f-850d-4dd9-960a-04c6638ded36","Y29tLm1pY3Jvc29mdC50ZWFtc3BhY2UudGFiLnBsYW5uZXIjIzEuMi4zIyNQdWJsaXNoZWQ=","MmUzYTYyOGQtNmY1NC00MTAwLTllN2EtZjAwYmMzNjIxYTg1IyMxLjAuOCMjUHVibGlzaGVk","ZGI1ZTU5NzAtMjEyZi00NzdmLWEzZmMtMjIyN2RjNzc4MmJmIyMyLjIuMyMjUHVibGlzaGVk",...Object(o.j)("mos-testApp")?["com.example.metaostestapp.test"]:[]];function a(e){return Object(r.a)()&&i.indexOf(e)>-1}},4670:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.SeeMore=3]="SeeMore"}(r||(r={}))},4679:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(707),o=n(1975),i=n(1701),a=n(2105),s=n(2549),c=n(47),u=n(5886),l=n(467);function d(e){const t=Object(r.a)({BaseShape:"IdOnly",ClientSupportsIrm:!0,FilterHtmlContent:!0,InlineImageCustomDataTemplate:o.e,InlineImageUrlOnLoadTemplate:"",InlineImageUrlTemplate:o.f,AdditionalProperties:[Object(i.a)({FieldURI:"ItemLastModifiedTime"}),Object(l.a)({PropertyName:"suggested_attachment_session_id",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})]});return Object(u.a)(t),e&&(t.BodyType=e),t.ImageProxyCapability=Object(c.j)("rp-replyImageProxy")&&Object(a.a)()?s.a.OwaConnectorsProxyAndCompose:s.a.None,t}},4682:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},4683:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(38);function o(){return Object(r.a)().PolicyTipsEnabled}},471:function(e,t,n){"use strict";var r=n(474);var o=function(){this.__data__=new r.a,this.size=0};var i=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var a=function(e){return this.__data__.get(e)};var s=function(e){return this.__data__.has(e)},c=n(475),u=n(522),l=200;var d=function(e,t){var n=this.__data__;if(n instanceof r.a){var o=n.__data__;if(!c.a||o.length<l-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new u.a(o)}return n.set(e,t),this.size=n.size,this};function f(e){var t=this.__data__=new r.a(e);this.size=t.size}f.prototype.clear=o,f.prototype.delete=i,f.prototype.get=a,f.prototype.has=s,f.prototype.set=d;t.a=f},474:function(e,t,n){"use strict";var r=function(){this.__data__=[],this.size=0},o=n(406);var i=function(e,t){for(var n=e.length;n--;)if(Object(o.a)(e[n][0],t))return n;return-1},a=Array.prototype.splice;var s=function(e){var t=this.__data__,n=i(t,e);return!(n<0)&&(n==t.length-1?t.pop():a.call(t,n,1),--this.size,!0)};var c=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]};var u=function(e){return i(this.__data__,e)>-1};var l=function(e,t){var n=this.__data__,r=i(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function d(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}d.prototype.clear=r,d.prototype.delete=s,d.prototype.get=c,d.prototype.has=u,d.prototype.set=l;t.a=d},4743:function(e,t,n){"use strict";var r=n(20),o=n(4157),i=n(3192),a=n(3139),s=n(3283),c=n(1985),u=n(3658),l=n(3006),d=n(3892),f=n(3),p=n(3893);Object(f.mutator)(i.a,e=>{Object(p.a)().selectedApp=null}),Object(f.mutator)(u.a,e=>{Object(p.a)().selectedApp=null});var m=n(4634),h=n(4603);Object(f.mutator)(a.a,e=>{Object(m.a)(e.app)&&(Object(p.a)().selectedApp=e.app)}),Object(f.mutator)(o.b,e=>{Object(p.a)().selectedApp=e.appId}),Object(f.mutator)(s.a,e=>{Object(p.a)().selectedApp=e.app}),Object(f.mutator)(h.g,e=>{Object(p.a)().selectedApp=e.appManifest.appId}),n.d(t,"c",(function(){return v})),n.d(t,"e",(function(){return i.a})),n.d(t,"f",(function(){return a.a})),n.d(t,"d",(function(){return u.a})),n.d(t,"a",(function(){return l.a})),n.d(t,"b",(function(){return d.b}));const g=new r.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(434)]).then(n.bind(null,19731))),v=(new r.b(g,e=>e.getSelectedOfficeRailApp),new r.b(g,e=>e.getLeftRailItemContextualMenuItems));Object(r.f)(i.a,g,e=>e.onModuleClickOrchestrator),Object(r.f)(a.a,g,e=>e.onOfficeAppClickOrchestrator),Object(r.f)(c.a,g,e=>e.startSearchOrchestrator),Object(r.f)(a.a,g,e=>e.onOfficeAppClickAppHostOrchestration),Object(r.f)(o.b,g,e=>e.onAppDrawerAppClickAppHostOrchestration),Object(r.f)(s.a,g,e=>e.onSelectOfficeRailAppHostOrchestration)},475:function(e,t,n){"use strict";var r=n(328),o=n(247),i=Object(r.a)(o.a,"Map");t.a=i},4761:function(e){e.exports=JSON.parse('{"a":"Kpa"}')},4762:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="PrintRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M4 3.5C4 2.67 4.67 2 5.5 2h5c.83 0 1.5.67 1.5 1.5V4h1a2 2 0 012 2v4.5c0 .83-.67 1.5-1.5 1.5h-1.4v.5c0 .83-.67 1.5-1.5 1.5H5.5A1.5 1.5 0 014 12.5V12H2.5A1.5 1.5 0 011 10.5V6c0-1.1.9-2 2-2h1v-.5zm7 .5v-.5a.5.5 0 00-.5-.5h-5a.5.5 0 00-.5.5V4h6zM4 5H3a1 1 0 00-1 1v4.5c0 .28.22.5.5.5H4v-.5C4 9.67 4.67 9 5.5 9h5.1c.83 0 1.5.67 1.5 1.5v.5h1.4a.5.5 0 00.5-.5V6a1 1 0 00-1-1H4zm1.5 5a.5.5 0 00-.5.5v2c0 .28.22.5.5.5h5.1a.5.5 0 00.5-.5v-2a.5.5 0 00-.5-.5H5.5z"})),displayName:"PrintRegular"});Object(o.registerIcons)({icons:{PrintRegular:r.createElement(a,null)}})},4763:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="ThumbLikeRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M8.03 1.92c.21-.52.8-1.08 1.55-.87.6.17.97.52 1.2 1 .2.44.25.96.26 1.46a7.5 7.5 0 01-.24 1.74c-.06.26-.12.51-.19.74h1.38a2 2 0 011.92 2.56l-1.36 4.65a2.5 2.5 0 01-3.15 1.68L4.05 13.2A2 2 0 012.77 12l-.52-1.4a2 2 0 01.86-2.42l1.87-1.1.02-.01.1-.09c.1-.07.23-.2.4-.4.35-.39.82-1.03 1.3-2.04.2-.44.37-.78.53-1.1.25-.5.46-.92.7-1.52zm-2.51 6l-.02.01-1.88 1.11a1 1 0 00-.43 1.22l.52 1.38a1 1 0 00.64.6l5.35 1.68c.8.26 1.65-.2 1.89-1l1.36-4.65A1 1 0 0012 6.99H9.93a.5.5 0 01-.48-.67c.1-.28.26-.77.38-1.3.13-.54.22-1.08.2-1.49 0-.47-.05-.82-.16-1.06a.78.78 0 00-.56-.45c-.04-.02-.1-.01-.16.03a.54.54 0 00-.19.25c-.25.63-.5 1.11-.76 1.65-.16.3-.32.63-.5 1.01a9.52 9.52 0 01-1.45 2.29 5.05 5.05 0 01-.7.65l-.02.02h-.01z"})),displayName:"ThumbLikeRegular"});Object(o.registerIcons)({icons:{ThumbLikeRegular:r.createElement(a,null)}})},4791:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(7),n.e(560)]).then(n.bind(null,7349)));let i=new r.a(o,e=>e.mountAndShowFlexPane),a=new r.a(o,e=>e.hideFlexPane)},4792:function(e,t,n){"use strict";function r(e){const t=[],n=e.attachmentWell;return n&&(n.docViewAttachments.forEach(e=>{t.push(e.attachmentId)}),n.inlineAttachments.forEach(e=>{t.push(e.attachmentId)}),n.imageViewAttachments.forEach(e=>{t.push(e.attachmentId)})),t}n.d(t,"a",(function(){return r}))},4793:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2197),o=n(1701),i=n(2404);function a(e,t){return Object(i.a)({Path:Object(o.a)({FieldURI:e}),Item:Object(r.a)({[e]:t})})}},4795:function(e,t,n){"use strict";function r(e,t,n){const r=n.fromHtml(e,t);return r&&0!=r.length?1==r.length?r[0]:n.wrap(r,"SPAN"):null}n.d(t,"a",(function(){return r}))},4827:function(e,t){
/*
    Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.

    This file also contains the following Promise implementation (with a few small modifications):
        * @overview es6-promise - a tiny implementation of Promises/A+.
        * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
        * @license   Licensed under MIT license
        *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
        * @version   2.3.0
*/
var n,r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(e){return function(t){return c([e,t])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});!function(e){var t=function(){var e=!0;function t(){}return t.prototype.isMsAjaxLoaded=function(){var t="function",n="undefined";return!!(typeof Sys!==n&&typeof Type!==n&&Sys.StringBuilder&&typeof Sys.StringBuilder===t&&Type.registerNamespace&&typeof Type.registerNamespace===t&&Type.registerClass&&typeof Type.registerClass===t&&typeof Function._validateParams===t&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===t)&&e},t.prototype.loadMsAjaxFull=function(e){var t=("https:"===window.location.protocol.toLowerCase()?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";u.OUtil.loadScript(t,e)},Object.defineProperty(t.prototype,"msAjaxError",{get:function(){var e=this;return null==e._msAjaxError&&e.isMsAjaxLoaded()&&(e._msAjaxError=Error),e._msAjaxError},set:function(e){this._msAjaxError=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxString",{get:function(){var e=this;return null==e._msAjaxString&&e.isMsAjaxLoaded()&&(e._msAjaxString=String),e._msAjaxString},set:function(e){this._msAjaxString=e},enumerable:e,configurable:e}),Object.defineProperty(t.prototype,"msAjaxDebug",{get:function(){var e=this;return null==e._msAjaxDebug&&e.isMsAjaxLoaded()&&(e._msAjaxDebug=Sys.Debug),e._msAjaxDebug},set:function(e){this._msAjaxDebug=e},enumerable:e,configurable:e}),t}();e.MicrosoftAjaxFactory=t}(f||(f={}));var a,s,c=new f.MicrosoftAjaxFactory,u=u||{};!function(e){var t=function(){function e(e){this._internalStorage=e}return e.prototype.getItem=function(e){try{return this._internalStorage&&this._internalStorage.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){try{this._internalStorage&&this._internalStorage.setItem(e,t)}catch(e){}},e.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(e){}},e.prototype.removeItem=function(e){try{this._internalStorage&&this._internalStorage.removeItem(e)}catch(e){}},e.prototype.getKeysWithPrefix=function(e){var t=[];try{for(var n=this._internalStorage&&this._internalStorage.length||0,r=0;r<n;r++){var o=this._internalStorage.key(r);0===o.indexOf(e)&&t.push(o)}}catch(e){}return t},e.prototype.isLocalStorageAvailable=function(){return null!=this._internalStorage},e}();e.SafeStorage=t}(f||(f={})),u.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"},u.TestFlightStart=1e3,u.TestFlightEnd=1009,u.FlightNames={UseOriginNotUrl:0,AddinEnforceHttps:2,FirstPartyAnonymousProxyReadyCheckTimeout:6,AddinRibbonIdAllowUnknown:9,ManifestParserDevConsoleLog:15,AddinActionDefinitionHybridMode:18,UseActionIdForUILessCommand:20,RequirementSetRibbonApiOnePointTwo:21,SetFocusToTaskpaneIsEnabled:22,ShortcutInfoArrayInUserPreferenceData:23,OSFTestFlight1000:u.TestFlightStart,OSFTestFlight1001:u.TestFlightStart+1,OSFTestFlight1002:u.TestFlightStart+2,OSFTestFlight1003:u.TestFlightStart+3,OSFTestFlight1004:u.TestFlightStart+4,OSFTestFlight1005:u.TestFlightStart+5,OSFTestFlight1006:u.TestFlightStart+6,OSFTestFlight1007:u.TestFlightStart+7,OSFTestFlight1008:u.TestFlightStart+8,OSFTestFlight1009:u.TestFlightEnd},u.FlightTreatmentNames={AllowStorageAccessByUserActivationOnIFrame:"Microsoft.Office.SharedOnline.AllowStorageAccessByUserActivationOnIFrame",IsPrivateAddin:"Microsoft.Office.SharedOnline.IsPrivateAddin",LogAllAddinsAsPublic:"Microsoft.Office.SharedOnline.LogAllAddinsAsPublic",AddinCommandRibbonCacheFixEnabled:"Microsoft.Office.SharedOnline.AddinCommandRibbonCacheFixEnabled",OSFSolutionRefactor:"Microsoft.Office.SharedOnline.OSFSolutionRefactor"},u.Flights=[],u.Settings={},u.WindowNameItemKeys={BaseFrameName:"baseFrameName",HostInfo:"hostInfo",XdmInfo:"xdmInfo",SerializerVersion:"serializerVersion",AppContext:"appContext",Flights:"flights"},u.OUtil=function(){var e="focus",t="https:",n="on",r="configurable",o="writable",i="enumerable",a="",s="undefined",l=!1,d=!0,p="string",m=2147483647,h=null,g="#",v=-1,y=v,b="&_xdm_Info=",O="&_serializer_version=",S="&_flights=",C="_xdm_",A=g,_="class",I={},x=h,E=h,T=(new Date).getTime();function w(){var e=m*Math.random();return(e^=T^(new Date).getMilliseconds()<<Math.floor(21*Math.random())).toString(16)}function M(){if(!x){try{var e=window.sessionStorage}catch(t){e=h}x=new f.SafeStorage(e)}return x}function k(e){for(var t,n=[],r=[],o=e.length,i=0;i<o;i++)(t=e[i]).tabIndex?t.tabIndex>0?r.push(t):0===t.tabIndex&&n.push(t):n.push(t);return r=r.sort((function(e,t){var n=e.tabIndex-t.tabIndex;return 0===n&&(n=r.indexOf(e)-r.indexOf(t)),n})),[].concat(r,n)}return{set_entropy:function(e){if(typeof e==p)for(var t=0;t<e.length;t+=4){for(var n=0,r=0;r<4&&t+r<e.length;r++)n=(n<<8)+e.charCodeAt(t+r);T^=n}else T^="number"==typeof e?e:m*Math.random();T&=m},extend:function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.uber=t.prototype,t.prototype.constructor===Object.prototype.constructor&&(t.prototype.constructor=t)},setNamespace:function(e,t){t&&e&&!t[e]&&(t[e]={})},unsetNamespace:function(e,t){t&&e&&t[e]&&delete t[e]},serializeSettings:function(e){var t={};for(var n in e){var r=e[n];try{r=JSON?JSON.stringify(r,(function(e,t){return u.OUtil.isDate(this[e])?u.DDA.SettingsManager.DateJSONPrefix+this[e].getTime()+u.DDA.SettingsManager.DataJSONSuffix:t})):Sys.Serialization.JavaScriptSerializer.serialize(r),t[n]=r}catch(e){}}return t},deserializeSettings:function(e){var t={};for(var n in e=e||{}){var r=e[n];try{r=JSON?JSON.parse(r,(function(e,t){var n;return typeof t===p&&t&&t.length>6&&t.slice(0,5)===u.DDA.SettingsManager.DateJSONPrefix&&t.slice(v)===u.DDA.SettingsManager.DataJSONSuffix&&(n=new Date(parseInt(t.slice(5,v))))?n:t})):Sys.Serialization.JavaScriptSerializer.deserialize(r,d),t[n]=r}catch(e){}}return t},loadScript:function(e,t,n){if(e&&t){var r=window.document,o=I[e];if(o)o.loaded?t():o.pendingCallbacks.push(t);else{var i=r.createElement("script");i.type="text/javascript",o={loaded:l,pendingCallbacks:[t],timer:h},I[e]=o;var a=function(){o.timer!=h&&(clearTimeout(o.timer),delete o.timer),o.loaded=d;for(var e=o.pendingCallbacks.length,t=0;t<e;t++){o.pendingCallbacks.shift()()}},s=function(){delete I[e],o.timer!=h&&(clearTimeout(o.timer),delete o.timer);for(var t=o.pendingCallbacks.length,n=0;n<t;n++){o.pendingCallbacks.shift()()}};i.readyState?i.onreadystatechange=function(){"loaded"!=i.readyState&&"complete"!=i.readyState||(i.onreadystatechange=h,a())}:i.onload=a,i.onerror=s,n=n||3e4,o.timer=setTimeout((function(){window.navigator.userAgent.indexOf("Trident")>0?s(h):s(new Event("Script load timed out"))}),n),i.setAttribute("crossOrigin","anonymous"),i.src=e,r.getElementsByTagName("head")[0].appendChild(i)}}},loadCSS:function(e){if(e){var t=window.document,n=t.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.getElementsByTagName("head")[0].appendChild(n)}},parseEnum:function(e,t){var n=t[e.trim()];if(typeof n==s)throw c.msAjaxDebug.trace("invalid enumeration string:"+e),c.msAjaxError.argument("str");return n},delayExecutionAndCache:function(){var e={calc:arguments[0]};return function(){return e.calc&&(e.val=e.calc.apply(this,arguments),delete e.calc),e.val}},getUniqueId:function(){return(y+=1).toString()},formatString:function(){var e=arguments,t=e[0];return t.replace(/{(\d+)}/gm,(function(t,n){var r=parseInt(n,10)+1;return void 0===e[r]?"{"+n+"}":e[r]}))},generateConversationId:function(){return[w(),w(),(new Date).getTime().toString()].join("_")},getFrameName:function(e){return C+e+this.generateConversationId()},addXdmInfoAsHash:function(e,t){return u.OUtil.addInfoAsHash(e,b,t,l)},addSerializerVersionAsHash:function(e,t){return u.OUtil.addInfoAsHash(e,O,t,d)},addFlightsAsHash:function(e,t){return u.OUtil.addInfoAsHash(e,S,t,d)},addInfoAsHash:function(e,t,n,r){var o,i=(e=e.trim()||a).split(A),s=i.shift(),c=i.join(A);return o=r?[t,encodeURIComponent(n),c].join(a):[c,t,n].join(a),[s,A,o].join(a)},parseHostInfoFromWindowName:function(e,t){return u.OUtil.parseInfoFromWindowName(e,t,u.WindowNameItemKeys.HostInfo)},parseXdmInfo:function(e){var t=u.OUtil.parseXdmInfoWithGivenFragment(e,window.location.hash);return t||(t=u.OUtil.parseXdmInfoFromWindowName(e,window.name)),t},parseXdmInfoFromWindowName:function(e,t){return u.OUtil.parseInfoFromWindowName(e,t,u.WindowNameItemKeys.XdmInfo)},parseXdmInfoWithGivenFragment:function(e,t){return u.OUtil.parseInfoWithGivenFragment(b,C,l,e,t)},parseSerializerVersion:function(e){var t=u.OUtil.parseSerializerVersionWithGivenFragment(e,window.location.hash);return isNaN(t)&&(t=u.OUtil.parseSerializerVersionFromWindowName(e,window.name)),t},parseSerializerVersionFromWindowName:function(e,t){return parseInt(u.OUtil.parseInfoFromWindowName(e,t,u.WindowNameItemKeys.SerializerVersion))},parseSerializerVersionWithGivenFragment:function(e,t){return parseInt(u.OUtil.parseInfoWithGivenFragment(O,"_serializer_version=",d,e,t))},parseFlights:function(e){var t=u.OUtil.parseFlightsWithGivenFragment(e,window.location.hash);return 0==t.length&&(t=u.OUtil.parseFlightsFromWindowName(e,window.name)),t},checkFlight:function(e){return u.Flights&&u.Flights.indexOf(e)>=0},pushFlight:function(e){return u.Flights.indexOf(e)<0?(u.Flights.push(e),d):l},getBooleanSetting:function(e){return u.OUtil.getBooleanFromDictionary(u.Settings,e)},getBooleanFromDictionary:function(e,t){var n=e&&t&&void 0!==e[t]&&e[t]&&(typeof e[t]===p&&"TRUE"===e[t].toUpperCase()||"boolean"==typeof e[t]&&e[t]);return void 0!==n?n:l},parseFlightsFromWindowName:function(e,t){return u.OUtil.parseArrayWithDefault(u.OUtil.parseInfoFromWindowName(e,t,u.WindowNameItemKeys.Flights))},parseFlightsWithGivenFragment:function(e,t){return u.OUtil.parseArrayWithDefault(u.OUtil.parseInfoWithGivenFragment(S,"_flights=",d,e,t))},parseArrayWithDefault:function(e){var t=[];try{t=JSON.parse(e)}catch(e){}return Array.isArray(t)||(t=[]),t},parseInfoFromWindowName:function(e,t,n){try{var r=JSON.parse(t),o=r!=h?r[n]:h,i=M();if(!e&&i&&r!=h){var a=r[u.WindowNameItemKeys.BaseFrameName]+n;o?i.setItem(a,o):o=i.getItem(a)}return o}catch(e){return h}},parseInfoWithGivenFragment:function(e,t,n,r,o){var i=o.split(e),a=i.length>1?i[i.length-1]:h;n&&a!=h&&(a.indexOf("&")>=0&&(a=a.split("&")[0]),a=decodeURIComponent(a));var s=M();if(!r&&s){var c=window.name.indexOf(t);if(c>v){var u=window.name.indexOf(";",c);u==v&&(u=window.name.length);var l=window.name.substring(c,u);a?s.setItem(l,a):a=s.getItem(l)}}return a},getConversationId:function(){var e=window.location.search,t=h;if(e){var n=e.indexOf("&");(t=n>0?e.substring(1,n):e.substr(1))&&"="===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1))&&(t=decodeURIComponent(t))}return t},getInfoItems:function(e){var t=e.split("$");return typeof t[1]==s&&(t=e.split("|")),typeof t[1]==s&&(t=e.split("%7C")),t},getXdmFieldValue:function(e,t){var n=a,r=u.OUtil.parseXdmInfo(t);if(r){var o=u.OUtil.getInfoItems(r);if(null!=o&&o.length>=3)switch(e){case u.XdmFieldName.ConversationUrl:n=o[2];break;case u.XdmFieldName.AppId:n=o[1]}}return n},validateParamObject:function(e,t){var n=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:l},{name:"expectedProperties",type:Object,mayBeNull:l},{name:"callback",type:Function,mayBeNull:d}]);if(n)throw n;for(var r in t)if(n=Function._validateParameter(e[r],t[r],r))throw n},writeProfilerMark:function(e){window.msWriteProfilerMark&&(window.msWriteProfilerMark(e),c.msAjaxDebug.trace(e))},outputDebug:function(e){typeof c!==s&&c.msAjaxDebug&&c.msAjaxDebug.trace&&c.msAjaxDebug.trace(e)},defineNondefaultProperty:function(e,t,n,r){for(var o in n=n||{},r){var i=r[o];null==n[i]&&(n[i]=d)}return Object.defineProperty(e,t,n),e},defineNondefaultProperties:function(e,t,n){for(var r in t=t||{})u.OUtil.defineNondefaultProperty(e,r,t[r],n);return e},defineEnumerableProperty:function(e,t,n){return u.OUtil.defineNondefaultProperty(e,t,n,[i])},defineEnumerableProperties:function(e,t){return u.OUtil.defineNondefaultProperties(e,t,[i])},defineMutableProperty:function(e,t,n){return u.OUtil.defineNondefaultProperty(e,t,n,[o,i,r])},defineMutableProperties:function(e,t){return u.OUtil.defineNondefaultProperties(e,t,[o,i,r])},finalizeProperties:function(e,t){t=t||{};for(var n=Object.getOwnPropertyNames(e),r=n.length,o=0;o<r;o++){var i=n[o],a=Object.getOwnPropertyDescriptor(e,i);a.get||a.set||(a.writable=t.writable||l),a.configurable=t.configurable||l,a.enumerable=t.enumerable||d,Object.defineProperty(e,i,a)}return e},mapList:function(e,t){var n=[];if(e)for(var r in e)n.push(t(e[r]));return n},listContainsKey:function(e,t){for(var n in e)if(t==n)return d;return l},listContainsValue:function(e,t){for(var n in e)if(t==e[n])return d;return l},augmentList:function(e,t){var n=e.push?function(t,n){e.push(n)}:function(t,n){e[t]=n};for(var r in t)n(r,t[r])},redefineList:function(e,t){for(var n in e)delete e[n];for(var r in t)e[r]=t[r]},isArray:function(e){return"[object Array]"===Object.prototype.toString.apply(e)},isFunction:function(e){return"[object Function]"===Object.prototype.toString.apply(e)},isDate:function(e){return"[object Date]"===Object.prototype.toString.apply(e)},addEventListener:function(e,t,r){e.addEventListener?e.addEventListener(t,r,l):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.attachEvent?e.attachEvent(n+t,r):e[n+t]=r},removeEventListener:function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,l):Sys.Browser.agent===Sys.Browser.InternetExplorer&&e.detachEvent?e.detachEvent(n+t,r):e[n+t]=h},getCookieValue:function(e){return RegExp(e+"[^;]+").exec(document.cookie).toString().replace(/^[^=]+./,a)},xhrGet:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){4==r.readyState&&(200==r.status?t(r.responseText):n(r.status))},r.open("GET",e,d),r.send()}catch(e){n(e)}},xhrGetFull:function(e,t,n,r){var o,i=t;try{(o=new XMLHttpRequest).onreadystatechange=function(){4==o.readyState&&(200==o.status?n(o,i):r(o.status))},o.open("GET",e,d),o.send()}catch(e){r(e)}},encodeBase64:function(e){if(!e)return e;var t,n,r,o,i,s,c,u=[],l=[],d=0,f=e.length;do{t=e.charCodeAt(d++),n=e.charCodeAt(d++),r=e.charCodeAt(d++),c=0,o=255&t,i=t>>8,s=255&n,l[c++]=o>>2,l[c++]=(3&o)<<4|i>>4,l[c++]=(15&i)<<2|s>>6,l[c++]=63&s,isNaN(n)||(o=n>>8,i=255&r,s=r>>8,l[c++]=o>>2,l[c++]=(3&o)<<4|i>>4,l[c++]=(15&i)<<2|s>>6,l[c++]=63&s),isNaN(n)?l[c-1]=64:isNaN(r)&&(l[c-2]=64,l[c-1]=64);for(var p=0;p<c;p++)u.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(l[p]))}while(d<f);return u.join(a)},getSessionStorage:function(){return M()},getLocalStorage:function(){if(!E){try{var e=window.localStorage}catch(t){e=h}E=new f.SafeStorage(e)}return E},convertIntToCssHexColor:function(e){return g+(Number(e)+16777216).toString(16).slice(-6)},attachClickHandler:function(e,t){e.onclick=function(){t()},e.ontouchend=function(e){t(),e.preventDefault()}},getQueryStringParamValue:function(e,t){var n=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:l},{name:"paramName",type:String,mayBeNull:l}]);if(n)return c.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null."),a;var r=new RegExp("[\\?&]"+t+"=([^&#]*)","i");return r.test(e)?r.exec(e)[1]:(c.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found."),a)},getHostnamePortionForLogging:function(e){var t=Function._validateParams(arguments,[{name:"hostname",type:String,mayBeNull:l}]);if(t)return a;var n=e.split("."),r=n.length;return r>=2?n[r-2]+"."+n[r-1]:1==r?n[0]:void 0},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?d:l},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!u.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},startsWith:function(e,t,n){return n?e.substr(0,t.length)===t:e.startsWith(t)},containsPort:function(e,t,n,r){return this.startsWith(e,t+"//"+n+":"+r,d)||this.startsWith(e,n+":"+r,d)},getRedundandPortString:function(e,n){return e&&n?n.protocol==t&&this.containsPort(e,t,n.hostname,"443")?":443":"http:"==n.protocol&&this.containsPort(e,"http:",n.hostname,"80")?":80":a:a},removeChar:function(e,t){return t<e.length-1?e.substring(0,t)+e.substring(t+1):t==e.length-1?e.substring(0,e.length-1):e},cleanUrlOfChar:function(e,t){for(var n=0;n<e.length;n++)if(e.charAt(n)===t){if(n+1>=e.length)return this.removeChar(e,n);if("/"===t){if("?"===e.charAt(n+1)||e.charAt(n+1)===g)return this.removeChar(e,n)}else if("?"===t&&e.charAt(n+1)===g)return this.removeChar(e,n)}return e},cleanUrl:function(e){if(e=this.cleanUrlOfChar(e,"/"),e=this.cleanUrlOfChar(e,"?"),"https://"==(e=this.cleanUrlOfChar(e,g)).substr(0,8))(t=e.indexOf(":443"))!=v&&(t!=e.length-4&&"/"!=e.charAt(t+4)&&"?"!=e.charAt(t+4)&&e.charAt(t+4)!=g||(e=e.substring(0,t)+e.substring(t+4)));else if("http://"==e.substr(0,7)){var t;(t=e.indexOf(":80"))!=v&&(t!=e.length-3&&"/"!=e.charAt(t+3)&&"?"!=e.charAt(t+3)&&e.charAt(t+3)!=g||(e=e.substring(0,t)+e.substring(t+3)))}return e},parseUrl:function(e,n){var r=this;if(void 0===n&&(n=l),typeof e!==s&&e){var o="NotHttps",i=r.isIE(),c={protocol:void 0,hostname:void 0,host:void 0,port:void 0,pathname:void 0,search:void 0,hash:void 0,isPortPartOfUrl:void 0};try{if(i){var d=document.createElement("a");if(d.href=e,!(d&&d.protocol&&d.host&&d.hostname&&d.href&&r.cleanUrl(d.href).toLowerCase()===r.cleanUrl(e).toLowerCase()))throw"InvalidUrl";if(u.OUtil.checkFlight(u.FlightNames.AddinEnforceHttps)&&n&&d.protocol!=t)throw new Error(o);var f=r.getRedundandPortString(e,d);c.protocol=d.protocol,c.hostname=d.hostname,c.port=f==a?d.port:a,c.host=f!=a?d.hostname:d.host,c.pathname=(i?"/":a)+d.pathname,c.search=d.search,c.hash=d.hash,c.isPortPartOfUrl=r.containsPort(e,d.protocol,d.hostname,d.port)}else{var p=new URL(e);if(p&&p.protocol&&p.host&&p.hostname){if(u.OUtil.checkFlight(u.FlightNames.AddinEnforceHttps)&&n&&p.protocol!=t)throw new Error(o);c.protocol=p.protocol,c.hostname=p.hostname,c.port=p.port,c.host=p.host,c.pathname=p.pathname,c.search=p.search,c.hash=p.hash,c.isPortPartOfUrl=p.host.lastIndexOf(":"+p.port)==p.host.length-p.port.length-1}}}catch(e){if(e.message===o)throw e}return c}},shallowCopy:function(e){if(e==h)return h;if(e instanceof Object){if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}var r=e.constructor();for(var o in e)e.hasOwnProperty(o)&&(r[o]=e[o]);return r}return e},createObject:function(e){var t=h;if(e){t={};for(var n=e.length,r=0;r<n;r++)t[e[r].name]=e[r].value}return t},addClass:function(e,t){if(!u.OUtil.hasClass(e,t)){var n=e.getAttribute(_);n?e.setAttribute(_,n+" "+t):e.setAttribute(_,t)}},removeClass:function(e,t){if(u.OUtil.hasClass(e,t)){var n=e.getAttribute(_),r=new RegExp("(\\s|^)"+t+"(\\s|$)");n=n.replace(r,a),e.setAttribute(_,n)}},hasClass:function(e,t){var n=e.getAttribute(_);return n&&n.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},focusToFirstTabbable:function(t,n){var r,o,i=l,a=function(){i=d},s=function(e,t,n){return t<0||t>e?v:0===t&&n?v:t!==e-1||n?n?t-1:t+1:v};if(t=k(t),r=n?t.length-1:0,0===t.length)return h;for(;!i&&r>=0&&r<t.length;)o=t[r],window.focus(),o.addEventListener(e,a),o.focus(),o.removeEventListener(e,a),r=s(t.length,r,n),i||o!==document.activeElement||(i=d);return i?o:h},focusToNextTabbable:function(t,n,r){var o,i,a,s=l,c=function(){s=d},u=function(e,t,n){return t<0||t>e?v:0===t&&n?v:t!==e-1||n?n?t-1:t+1:v};if(o=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return v}(t=k(t),n),(i=u(t.length,o,r))<0)return h;for(;!s&&i>=0&&i<t.length;)(a=t[i]).addEventListener(e,c),a.focus(),a.removeEventListener(e,c),i=u(t.length,i,r),s||a!==document.activeElement||(s=d);return s?a:h},isNullOrUndefined:function(e){return typeof e===s?d:e===h?d:l},stringEndsWith:function(e,t){if(!u.OUtil.isNullOrUndefined(e)&&!u.OUtil.isNullOrUndefined(t)){if(t.length>e.length)return l;if(e.substr(e.length-t.length)===t)return d}return l},hashCode:function(e){var t=0;if(!u.OUtil.isNullOrUndefined(e))for(var n=0,r=e.length;n<r;)t=(t<<5)-t+e.charCodeAt(n++)|0;return t},getValue:function(e,t){return u.OUtil.isNullOrUndefined(e)?t:e},externalNativeFunctionExists:function(e){return"unknown"===e||e!==s}}}(),u.OUtil.Guid=function(){var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return{generateNewGuid:function(){for(var t="",n=(new Date).getTime(),r=0;r<32&&n>0;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[n%16],n=Math.floor(n/16);for(;r<32;r++)8!=r&&12!=r&&16!=r&&20!=r||(t+="-"),t+=e[Math.floor(16*Math.random())];return t}}}();try{u.Flights=u.OUtil.parseFlights(!0)}catch(e){}window.OSF=u,function(e){var t="\n",n=!0,r=null,o="undefined",i=function(){function e(){}return e.isInstanceOfType=function(e,t){if(typeof t===o||t===r)return!1;if(t instanceof e)return n;var i=t.constructor;return i&&"function"==typeof i&&i.__typeName&&"Object"!==i.__typeName||(i=Object),!(i!==e)||i.__typeName&&e.__typeName&&i.__typeName===e.__typeName},e}();e.MsAjaxTypeHelper=i;var a=function(){var e="Parameter name: {0}";function n(){}return n.create=function(e,t){var n=new Error(e);if(n.message=e,t)for(var r in t)n[r]=t[r];return n.popStackFrame(),n},n.parameterCount=function(e){var t="Sys.ParameterCountException: "+(e||"Parameter count mismatch."),r=n.create(t,{name:"Sys.ParameterCountException"});return r.popStackFrame(),r},n.argument=function(r,o){var i="Sys.ArgumentException: "+(o||"Value does not fall within the expected range.");r&&(i+=t+s.format(e,r));var a=n.create(i,{name:"Sys.ArgumentException",paramName:r});return a.popStackFrame(),a},n.argumentNull=function(r,o){var i="Sys.ArgumentNullException: "+(o||"Value cannot be null.");r&&(i+=t+s.format(e,r));var a=n.create(i,{name:"Sys.ArgumentNullException",paramName:r});return a.popStackFrame(),a},n.argumentOutOfRange=function(i,a,c){var u="Sys.ArgumentOutOfRangeException: "+(c||"Specified argument was out of the range of valid values.");i&&(u+=t+s.format(e,i)),typeof a!==o&&a!==r&&(u+=t+s.format("Actual value was {0}.",a));var l=n.create(u,{name:"Sys.ArgumentOutOfRangeException",paramName:i,actualValue:a});return l.popStackFrame(),l},n.argumentType=function(r,o,i,a){var c="Sys.ArgumentTypeException: ";c+=a||(o&&i?s.format("Object of type '{0}' cannot be converted to type '{1}'.",o.getName?o.getName():o,i.getName?i.getName():i):"Object cannot be converted to the required type."),r&&(c+=t+s.format(e,r));var u=n.create(c,{name:"Sys.ArgumentTypeException",paramName:r,actualType:o,expectedType:i});return u.popStackFrame(),u},n.argumentUndefined=function(r,o){var i="Sys.ArgumentUndefinedException: "+(o||"Value cannot be undefined.");r&&(i+=t+s.format(e,r));var a=n.create(i,{name:"Sys.ArgumentUndefinedException",paramName:r});return a.popStackFrame(),a},n.invalidOperation=function(e){var t="Sys.InvalidOperationException: "+(e||"Operation is not valid due to the current state of the object."),r=n.create(t,{name:"Sys.InvalidOperationException"});return r.popStackFrame(),r},n}();e.MsAjaxError=a;var s=function(){function e(){}return e.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=e;return r.replace(/{(\d+)}/gm,(function(e,n){var r=parseInt(n,10);return void 0===t[r]?"{"+n+"}":t[r]}))},e.startsWith=function(e,t){return e.substr(0,t.length)===t},e}();e.MsAjaxString=s;var u=function(){function e(){}return e.trace=function(){},e}();if(e.MsAjaxDebug=u,!c.isMsAjaxLoaded()){var l=function(e,t,n){void 0!==e.__typeName&&e.__typeName!==r||(e.__typeName=t),void 0!==e.__class&&e.__class!==r||(e.__class=n)};l(Function,"Function",n),l(Error,"Error",n),l(Object,"Object",n),l(String,"String",n),l(Boolean,"Boolean",n),l(Date,"Date",n),l(Number,"Number",n),l(RegExp,"RegExp",n),l(Array,"Array",n),Function.createCallback||(Function.createCallback=function(e,t){var r=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:n}]);if(r)throw r;return function(){var n=arguments.length;if(n>0){for(var r=[],o=0;o<n;o++)r[o]=arguments[o];return r[n]=t,e.apply(this,r)}return e.call(this,t)}}),Function.createDelegate||(Function.createDelegate=function(e,t){var r=Function._validateParams(arguments,[{name:"instance",mayBeNull:n},{name:"method",type:Function}]);if(r)throw r;return function(){return t.apply(e,arguments)}}),Function._validateParams||(Function._validateParams=function(e,t,n){var i,a=t.length;if(n=n||typeof n===o,i=Function._validateParameterCount(e,t,n))return i.popStackFrame(),i;for(var s=0,c=e.length;s<c;s++){var u=t[Math.min(s,a-1)],l=u.name;if(u.parameterArray)l+="["+(s-a+1)+"]";else if(!n&&s>=a)break;if(i=Function._validateParameter(e[s],u,l))return i.popStackFrame(),i}return r}),Function._validateParameterCount||(Function._validateParameterCount=function(e,t,o){var i,s,c=t.length,u=e.length;if(u<c){var l=c;for(i=0;i<c;i++){var d=t[i];(d.optional||d.parameterArray)&&l--}u<l&&(s=n)}else if(o&&u>c)for(s=n,i=0;i<c;i++)if(t[i].parameterArray){s=!1;break}if(s){var f=a.parameterCount();return f.popStackFrame(),f}return r}),Function._validateParameter||(Function._validateParameter=function(e,t,n){var i,a=t.type,s=!!t.integer,c=!!t.domElement,u=!!t.mayBeNull;if(i=Function._validateParameterType(e,a,s,c,u,n))return i.popStackFrame(),i;var l=t.elementType,d=!!t.elementMayBeNull;if(a===Array&&typeof e!==o&&e!==r&&(l||!d))for(var f=!!t.elementInteger,p=!!t.elementDomElement,m=0;m<e.length;m++){var h=e[m];if(i=Function._validateParameterType(h,l,f,p,d,n+"["+m+"]"))return i.popStackFrame(),i}return r}),Function._validateParameterType||(Function._validateParameterType=function(t,n,i,a,s,c){var u;return typeof t===o?s?r:((u=e.MsAjaxError.argumentUndefined(c)).popStackFrame(),u):t===r?s?r:((u=e.MsAjaxError.argumentNull(c)).popStackFrame(),u):n&&!e.MsAjaxTypeHelper.isInstanceOfType(n,t)?((u=e.MsAjaxError.argumentType(c,typeof t,n)).popStackFrame(),u):r}),window.Type||(window.Type=Function),Type.registerNamespace||(Type.registerNamespace=function(e){for(var t=e.split("."),n=window,r=0;r<t.length;r++)n[t[r]]=n[t[r]]||{},n=n[t[r]]}),Type.prototype.registerClass||(Type.prototype.registerClass=function(e){({})}),typeof Sys===o&&Type.registerNamespace("Sys"),Error.prototype.popStackFrame||(Error.prototype.popStackFrame=function(){var e=this;if(0!==arguments.length)throw a.parameterCount();if(typeof e.stack!==o&&e.stack!==r&&typeof e.fileName!==o&&e.fileName!==r&&typeof e.lineNumber!==o&&e.lineNumber!==r){for(var n=e.stack.split(t),i=n[0],s=e.fileName+":"+e.lineNumber;typeof i!==o&&i!==r&&-1===i.indexOf(s);)n.shift(),i=n[0];var c=n[1];if(typeof c!==o&&c!==r){var u=c.match(/@(.*):(\d+)$/);typeof u!==o&&u!==r&&(e.fileName=u[1],e.lineNumber=parseInt(u[2]),n.shift(),e.stack=n.join(t))}}}),c.msAjaxError=a,c.msAjaxString=s,c.msAjaxDebug=u}}(f||(f={})),u.OUtil.setNamespace("Microsoft",window),u.OUtil.setNamespace("Office",Microsoft),u.OUtil.setNamespace("Common",Microsoft.Office),Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},u.SerializerVersion={MsAjax:0,Browser:1},(f||(f={})).appSpecificCheckOrigin=function(){return!1},Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5},Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6},Microsoft.Office.Common.MessageType={request:0,response:1},Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2},Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1},Microsoft.Office.Common.HostTrustStatus={unknown:0,untrusted:1,nothttps:2,trusted:3},Microsoft.Office.Common.MethodObject=function(e,t,n){this._method=e,this._invokeType=t,this._blockingOthers=n},Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}},Microsoft.Office.Common.EventMethodObject=function(e,t){this._registerMethodObject=e,this._unregisterMethodObject=t},Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}},Microsoft.Office.Common.ServiceEndPoint=function(e){var t=this,n=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:!1}]);if(n)throw n;t._methodObjectList={},t._eventHandlerProxyList={},t._Id=e,t._conversations={},t._policyManager=null,t._appDomains={},t._onHandleRequestError=null},Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(e,t,n,r){var o="invokeType",i=!1,a=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:i},{name:"method",type:Function,mayBeNull:i},{name:o,type:Number,mayBeNull:i},{name:"blockingOthers",type:Boolean,mayBeNull:i}]);if(a)throw a;if(n!==Microsoft.Office.Common.InvokeType.async&&n!==Microsoft.Office.Common.InvokeType.sync)throw c.msAjaxError.argument(o);var s=new Microsoft.Office.Common.MethodObject(t,n,r);this._methodObjectList[e]=s},unregisterMethod:function(e){var t=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:!1}]);if(t)throw t;delete this._methodObjectList[e]},registerEvent:function(e,t,n){var r=!1,o=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:r},{name:"registerMethod",type:Function,mayBeNull:r},{name:"unregisterMethod",type:Function,mayBeNull:r}]);if(o)throw o;var i=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,Microsoft.Office.Common.InvokeType.syncRegisterEvent,r),new Microsoft.Office.Common.MethodObject(n,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,r));this._methodObjectList[e]=i},registerEventEx:function(e,t,n,r,o){var i=!1,a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:i},{name:"registerMethod",type:Function,mayBeNull:i},{name:"registerMethodInvokeType",type:Number,mayBeNull:i},{name:"unregisterMethod",type:Function,mayBeNull:i},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:i}]);if(a)throw a;var s=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(t,n,i),new Microsoft.Office.Common.MethodObject(r,o,i));this._methodObjectList[e]=s},unregisterEvent:function(e){var t=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:!1}]);if(t)throw t;this.unregisterMethod(e)},registerConversation:function(e,t,n,r){var o="appDomains",i=!0,a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1},{name:"conversationUrl",type:String,mayBeNull:!1,optional:i},{name:o,type:Object,mayBeNull:i,optional:i},{name:"serializerVersion",type:Number,mayBeNull:i,optional:i}]);if(a)throw a;if(n){if(!(n instanceof Array))throw c.msAjaxError.argument(o);this._appDomains[e]=n}this._conversations[e]={url:t,serializerVersion:r}},unregisterConversation:function(e){var t=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:!1}]);if(t)throw t;delete this._conversations[e]},setPolicyManager:function(e){var t="policyManager",n=Function._validateParams(arguments,[{name:t,type:Object,mayBeNull:!1}]);if(n)throw n;if(!e.checkPermission)throw c.msAjaxError.argument(t);this._policyManager=e},getPolicyManager:function(){return this._policyManager},dispose:function(){var e=null,t=this;t._methodObjectList=e,t._eventHandlerProxyList=e,t._Id=e,t._conversations=e,t._policyManager=e,t._appDomains=e,t._onHandleRequestError=e}},Microsoft.Office.Common.ClientEndPoint=function(e,t,n,r){var o="targetWindow",i=!1,a=this,s=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:i},{name:o,mayBeNull:i},{name:"targetUrl",type:String,mayBeNull:i},{name:"serializerVersion",type:Number,mayBeNull:!0,optional:!0}]);if(s)throw s;try{if(!t.postMessage)throw c.msAjaxError.argument(o)}catch(e){if(!Object.prototype.hasOwnProperty.call(t,"postMessage"))throw c.msAjaxError.argument(o)}a._conversationId=e,a._targetWindow=t,a._targetUrl=n,a._callingIndex=0,a._callbackList={},a._eventHandlerList={},a._serializerVersion=null!=r?r:u.SerializerVersion.Browser,a._checkReceiverOriginAndRun=null,a._hostTrustCheckStatus=Microsoft.Office.Common.HostTrustStatus.unknown,a._checkStatusLogged=i},Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(e,t,n){var r=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"param",mayBeNull:!0}]);if(r)throw r;var o=this,i=function(){var r=o._callingIndex++,i=new Date,a={callback:t,createdOn:i.getTime()};n&&"object"==typeof n&&"number"==typeof n.__timeout__&&(a.timeout=n.__timeout__,delete n.__timeout__),o._callbackList[r]=a;try{if(o._hostTrustCheckStatus!==Microsoft.Office.Common.HostTrustStatus.trusted&&"ContextActivationManager_getAppContextAsync"!==e)throw"Access Denied";var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.invoke,o._conversationId,r,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,o._serializerVersion);o._targetWindow.postMessage(c,o._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete o._callbackList[r]}}};o._checkReceiverOriginAndRun?o._checkReceiverOriginAndRun(i):(o._hostTrustCheckStatus=Microsoft.Office.Common.HostTrustStatus.trusted,i())},registerForEvent:function(e,t,n,r){var o=this,i=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"eventHandler",type:Function,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(i)throw i;var a=o._callingIndex++,s=new Date;o._callbackList[a]={callback:n,createdOn:s.getTime()};try{var c=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.registerEvent,o._conversationId,a,r),u=Microsoft.Office.Common.MessagePackager.envelope(c,o._serializerVersion);o._targetWindow.postMessage(u,o._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer(),o._eventHandlerList[e]=t}catch(e){try{null!==n&&n(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete o._callbackList[a]}}},unregisterForEvent:function(e,t,n){var r=this,o=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:!1},{name:"callback",type:Function,mayBeNull:!0},{name:"data",mayBeNull:!0,optional:!0}]);if(o)throw o;var i=r._callingIndex++,a=new Date;r._callbackList[i]={callback:t,createdOn:a.getTime()};try{var s=new Microsoft.Office.Common.Request(e,Microsoft.Office.Common.ActionType.unregisterEvent,r._conversationId,i,n),c=Microsoft.Office.Common.MessagePackager.envelope(s,r._serializerVersion);r._targetWindow.postMessage(c,r._targetUrl),Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{null!==t&&t(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete r._callbackList[i]}}finally{delete r._eventHandlerList[e]}}},Microsoft.Office.Common.XdmCommunicationManager=function(){var e="serviceEndPointId",t=!0,n="a",r="null",o="channel is not ready.",i="conversationId",a="Unknown conversation Id.",s=!1,l=null,d=[],p=l,m=l,h=10,g=s,v=l,y=65e3,b=y,O={},S={},C=s;function A(e){for(var t in O)if(O[t]._conversations[e])return O[t];throw c.msAjaxDebug.trace(a),c.msAjaxError.argument(i)}function _(e){var t=S[e];return!t&&c.msAjaxDebug.trace(a),t}function I(e){d.push(e)}function x(){if(m!==l){if(!g)if(d.length>0){E(d.shift())}else clearInterval(m),m=l}else c.msAjaxDebug.trace(o)}function E(e){g=e.getInvokeBlockingFlag(),e.invoke(),p=(new Date).getTime()}function T(){if(v){var e,t,n=0,r=new Date;for(var i in S)for(var a in(e=S[i])._callbackList){var s=e._callbackList[a];if((t=s.timeout?s.timeout:b)>=0&&Math.abs(r.getTime()-s.createdOn)>=t)try{s.callback&&s.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,l)}finally{delete e._callbackList[a]}else n++}0===n&&(clearInterval(v),v=l)}else c.msAjaxDebug.trace(o)}function w(){g=s}function M(e,t){var o,i,a=s;if(!(e&&t&&e!==r&&t!==r&&e.length&&t.length))return a;u.OUtil.checkFlight(u.FlightNames.AddinEnforceHttps)?a=R(e,t):(o=document.createElement(n),i=document.createElement(n),o.href=e,i.href=t,a=N(o,i));return a}function k(e,t){var o=s;if(!(t&&t!==r&&t.length&&e&&e instanceof Array&&e.length))return o;var i=document.createElement(n),a=document.createElement(n);i.href=t;for(var c=0;c<e.length&&!o;c++)-1!==e[c].indexOf("://")&&(u.OUtil.checkFlight(u.FlightNames.AddinEnforceHttps)?o=R(t,e[c]):(a.href=e[c],o=N(i,a)));return o}function j(e){if(!e||e===r)return s;var t=["^office-int\\.com$","^officeapps\\.live-int\\.com$","^.*\\.dod\\.online\\.office365\\.us$","^.*\\.gov\\.online\\.office365\\.us$","^.*\\.officeapps\\.live\\.com$","^.*\\.officeapps\\.live-int\\.com$","^.*\\.officeapps-df\\.live\\.com$","^.*\\.online\\.office\\.de$","^.*\\.partner\\.officewebapps\\.cn$","^.*\\.office\\.net$","^"+document.domain.replace(new RegExp("\\.","g"),"\\.")+"$"];return new RegExp(t.join("|")).test(e)}function P(e,o){if(!e||!o||e===r||o===r)return s;var i,a;u.OUtil.checkFlight(u.FlightNames.AddinEnforceHttps)?(i=u.OUtil.parseUrl(e,t),a=u.OUtil.parseUrl(o,t)):((i=document.createElement(n)).href=e,(a=document.createElement(n)).href=o);var c=i.protocol===a.protocol,l=i.port===a.port,d=a.hostname,f=i.hostname,p=d===f,m=s;return!p&&d.length>f.length+1&&(m=d.slice(-(f.length+1))==="."+f),l&&c&&(p||m)}function R(e,n){return N(u.OUtil.parseUrl(e,t),u.OUtil.parseUrl(n,t))}function N(e,t){return e.hostname==t.hostname&&e.protocol==t.protocol&&D(e,t)}function D(e,t){return e.port==t.port||""==e.port&&"http:"==e.protocol&&"80"==t.port||""==e.port&&"https:"==e.protocol&&"443"==t.port||""==t.port&&"http:"==t.protocol&&"80"==e.port||""==t.port&&"https:"==t.protocol&&"443"==e.port}function F(e){var o="Access Denied";if(u&&""!=e.data){var i,a=u.SerializerVersion.Browser,d=e.data;try{a=(i=Microsoft.Office.Common.MessagePackager.unenvelope(d,u.SerializerVersion.Browser))._serializerVersion!=l?i._serializerVersion:a}catch(e){return}if(i._messageType===Microsoft.Office.Common.MessageType.request){var v=e.origin==l||e.origin===r?i._origin:e.origin;try{var y=A(i._conversationId),b=y._conversations[i._conversationId];a=b.serializerVersion!=l?b.serializerVersion:a;var O=[b.url].concat(y._appDomains[i._conversationId]);if(!k(O,e.origin)&&!f.appSpecificCheckOrigin(O,e,i._origin,k))if(!P(b.url,e.origin))throw"Failed origin check";var S=i._data!=l?i._data:{};S.SecurityOrigin=e.origin;var C=y.getPolicyManager();if(C&&!C.checkPermission(i._conversationId,i._actionName,S))throw o;var T=function(e,t){var n=e._methodObjectList[t._actionName];if(!n)throw c.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+t._actionName),c.msAjaxError.argument("messageObject");return t._actionType===Microsoft.Office.Common.ActionType.invoke?n:t._actionType===Microsoft.Office.Common.ActionType.registerEvent?n.getRegisterMethodObject():n.getUnregisterMethodObject()}(y,i),R=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,v,i._actionName,i._conversationId,i._correlationId,w,a),N=new Microsoft.Office.Common.Invoker(T,S,R,y._eventHandlerProxyList,i._conversationId,i._actionName,a),D=t;m==l&&((p==l||(new Date).getTime()-p>h)&&!g?(E(N),D=s):m=setInterval(x,h)),D&&I(N)}catch(c){y&&y._onHandleRequestError&&y._onHandleRequestError(i,c);var F=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;c==o&&(F=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied);var L=new Microsoft.Office.Common.Response(i._actionName,i._conversationId,i._correlationId,F,Microsoft.Office.Common.ResponseType.forCalling,c),U=Microsoft.Office.Common.MessagePackager.envelope(L,a),B=s;try{B=!(!e.source||!e.source.postMessage)}catch(e){}var H=s;if(window.location.href&&e.origin&&e.origin!==r&&P(window.location.href,e.origin))H=t;else if(e.origin&&e.origin!==r)if(u.OUtil.checkFlight(u.FlightNames.AddinEnforceHttps)){H=j(u.OUtil.parseUrl(e.origin,t).hostname)}else{var V=document.createElement(n);V.href=e.origin,H=j(V.hostname)}B&&H&&e.source.postMessage(U,v)}}else{if(i._messageType!==Microsoft.Office.Common.MessageType.response)return;var z=_(i._conversationId);if(!z)return;if(z._serializerVersion=a,!M(z._targetUrl,e.origin))throw"Failed orgin check";if(i._responseType===Microsoft.Office.Common.ResponseType.forCalling){var W=z._callbackList[i._correlationId];if(W)try{W.callback&&W.callback(i._errorCode,i._data)}finally{delete z._callbackList[i._correlationId]}}else{var G=z._eventHandlerList[i._actionName];void 0!==G&&G!==l&&G(i._data)}}}}function L(){C||(!function(e){if(window.addEventListener)window.addEventListener("message",e,s);else{if(!(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent))throw c.msAjaxDebug.trace("Browser doesn't support the required API."),c.msAjaxError.argument("Browser");window.attachEvent("onmessage",e)}}(F),C=t)}return{connect:function(e,t,n,r){var o=S[e];return o||(L(),o=new Microsoft.Office.Common.ClientEndPoint(e,t,n,r),S[e]=o),o},getClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:i,type:String,mayBeNull:s}]);if(t)throw t;return S[e]},createServiceEndPoint:function(e){L();var t=new Microsoft.Office.Common.ServiceEndPoint(e);return O[e]=t,t},getServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;return O[t]},deleteClientEndPoint:function(e){var t=Function._validateParams(arguments,[{name:i,type:String,mayBeNull:s}]);if(t)throw t;delete S[e]},deleteServiceEndPoint:function(t){var n=Function._validateParams(arguments,[{name:e,type:String,mayBeNull:s}]);if(n)throw n;delete O[t]},urlCompare:function(e,t){return N(e,t)},checkUrlWithAppDomains:function(e,t){return k(e,t)},isTargetSubdomainOfSourceLocation:function(e,t){return P(e,t)},_setMethodTimeout:function(e){var t=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:s}]);if(t)throw t;b=e<=0?y:e},_startMethodTimeoutTimer:function(){v||(v=setInterval(T,2e3))},isHostNameValidWacDomain:function(e){return j(e)},_hasSamePort:function(e,t){return D(e,t)}}}(),Microsoft.Office.Common.Message=function(e,t,n,r,o){var i=!1,a=this,s=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:i},{name:"actionName",type:String,mayBeNull:i},{name:"conversationId",type:String,mayBeNull:i},{name:"correlationId",mayBeNull:i},{name:"data",mayBeNull:!0,optional:!0}]);if(s)throw s;a._messageType=e,a._actionName=t,a._conversationId=n,a._correlationId=r,a._origin=window.location.origin,a._data=void 0===o?null:o},Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}},Microsoft.Office.Common.Request=function(e,t,n,r,o){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,e,n,r,o),this._actionType=t},u.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message),Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType},Microsoft.Office.Common.Response=function(e,t,n,r,o,i){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,e,t,n,i),this._errorCode=r,this._responseType=o},u.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message),Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode},Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType},Microsoft.Office.Common.MessagePackager={envelope:function(e){return"object"==typeof e&&(e._serializerVersion=u.SerializerVersion.Browser),JSON.stringify(e)},unenvelope:function(e){return JSON.parse(e)}},Microsoft.Office.Common.ResponseSender=function(e,t,n,r,o,i,a){var s=!1,l=this,d=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:s},{name:"requesterUrl",type:String,mayBeNull:s},{name:"actionName",type:String,mayBeNull:s},{name:"conversationId",type:String,mayBeNull:s},{name:"correlationId",mayBeNull:s},{name:"responsetype",type:Number,maybeNull:s},{name:"serializerVersion",type:Number,maybeNull:!0,optional:!0}]);if(d)throw d;l._requesterWindow=e,l._requesterUrl=t,l._actionName=n,l._conversationId=r,l._correlationId=o,l._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError,l._responseType=i;var f=l;l._send=function(e){var t=function(e,t){var n="undefined",r=u.OUtil.parseUrl(e),o=u.OUtil.parseUrl(t);if(!(r&&r.hostname&&o&&o.hostname)){return s}if(!Microsoft.Office.Common.XdmCommunicationManager.urlCompare(r,o)){r&&(r.protocol,r.hostname,r.port&&r.port),o&&(o.protocol,o.hostname,o.port&&o.port);return s}return!0};try{if("dialogMessageReceived"===f._actionName&&"*"!==e.targetOrigin){if(e.targetOrigin&&!t(e.targetOrigin,f._requesterUrl))return}else if("dialogParentMessageReceived"===f._actionName&&e.targetOrigin&&"*"!==e.targetOrigin&&!t(e.targetOrigin,f._requesterUrl))return;var n=new Microsoft.Office.Common.Response(f._actionName,f._conversationId,f._correlationId,f._invokeResultCode,f._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,a);f._requesterWindow.postMessage(r,f._requesterUrl)}catch(e){c.msAjaxDebug.trace("ResponseSender._send error:"+e.message)}}},Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(e){this._invokeResultCode=e}},Microsoft.Office.Common.InvokeCompleteCallback=function(e,t,n,r,o,i,a){var s=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(s,e,t,n,r,o,Microsoft.Office.Common.ResponseType.forCalling,a),s._postCallbackHandler=i;var u=s;s._send=function(e,t){null!=t&&(u._invokeResultCode=t);try{var n=new Microsoft.Office.Common.Response(u._actionName,u._conversationId,u._correlationId,u._invokeResultCode,u._responseType,e),r=Microsoft.Office.Common.MessagePackager.envelope(n,a);u._requesterWindow.postMessage(r,u._requesterUrl),u._postCallbackHandler()}catch(e){c.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+e.message)}}},u.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender),Microsoft.Office.Common.Invoker=function(e,t,n,r,o,i,a){var s=!0,c=!1,u=this,l=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:c},{name:"paramValue",mayBeNull:s},{name:"invokeCompleteCallback",mayBeNull:c},{name:"eventHandlerProxyList",mayBeNull:s},{name:"conversationId",type:String,mayBeNull:c},{name:"eventName",type:String,mayBeNull:c},{name:"serializerVersion",type:Number,mayBeNull:s,optional:s}]);if(l)throw l;u._methodObject=e,u._param=t,u._invokeCompleteCallback=n,u._eventHandlerProxyList=r,u._conversationId=o,u._eventName=i,u._serializerVersion=a},Microsoft.Office.Common.Invoker.prototype={invoke:function(){var e=this;try{var t;switch(e._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:e._methodObject.getMethod()(e._param,e._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:t=e._methodObject.getMethod()(e._param),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var n=e._createEventHandlerProxyObject(e._invokeCompleteCallback);t=e._methodObject.getMethod()(n.getSend(),e._param),e._eventHandlerProxyList[e._conversationId+e._eventName]=n.getSend(),e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var r=e._eventHandlerProxyList[e._conversationId+e._eventName];t=e._methodObject.getMethod()(r,e._param),delete e._eventHandlerProxyList[e._conversationId+e._eventName],e._invokeCompleteCallback.getSend()(t);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var o=e._createEventHandlerProxyObject(e._invokeCompleteCallback);e._methodObject.getMethod()(o.getSend(),e._invokeCompleteCallback.getSend(),e._param),e._eventHandlerProxyList[e._callerId+e._eventName]=o.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var i=e._eventHandlerProxyList[e._callerId+e._eventName];e._methodObject.getMethod()(i,e._invokeCompleteCallback.getSend(),e._param),delete e._eventHandlerProxyList[e._callerId+e._eventName]}}catch(t){e._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse),e._invokeCompleteCallback.getSend()(t)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(e){return new Microsoft.Office.Common.ResponseSender(e.getRequesterWindow(),e.getRequesterUrl(),e.getActionName(),e.getConversationId(),e.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}},u.OUtil.setNamespace("OSF",window),u.MessageIDs={FetchBundleUrl:0,LoadReactBundle:1,LoadBundleSuccess:2,LoadBundleError:3},u.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608,ExcelAndroid:8388609,VisioWebApp:8388610,OneNoteIOS:8388611,WordAndroid:8388613,PowerpointAndroid:8388614,Visio:8388615,OneNoteAndroid:4194305},u.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"},u.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"},u.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18,MouseEnter:19,MouseLeave:20,UpdateTargetUrl:21,InstallCustomFunctions:22,SendTelemetryEvent:23,UninstallCustomFunctions:24,SendMessage:25,LaunchExtensionComponent:26,StopExtensionComponent:27,RestartExtensionComponent:28,EnableTaskPaneHeaderButton:29,DisableTaskPaneHeaderButton:30,TaskPaneHeaderButtonClicked:31,RemoveAppCommandsAddin:32,RefreshRibbonGallery:33,GetOriginalControlId:34,OfficeJsReady:35,InsertDevManifest:36,InsertDevManifestError:37,SendCustomerContent:38,KeyboardShortcuts:39},u.SharedConstants={NotificationConversationIdSuffix:"_ntf"},u.DialogMessageType={DialogMessageReceived:0,DialogParentMessageReceived:1,DialogClosed:12006},u.OfficeAppContext=function(e,t,n,r,o,i,a,s,c,u,l,d,f,p,m,h,g,v,y,b,O,S,C,A,_,I,x){var E=this;E._id=e,E._appName=t,E._appVersion=n,E._appUILocale=r,E._dataLocale=o,E._docUrl=i,E._clientMode=a,E._settings=s,E._reason=c,E._osfControlType=u,E._eToken=l,E._correlationId=d,E._appInstanceId=f,E._touchEnabled=p,E._commerceAllowed=m,E._appMinorVersion=h,E._requirementMatrix=g,E._hostCustomMessage=v,E._hostFullVersion=y,E._isDialog=!1,E._clientWindowHeight=b,E._clientWindowWidth=O,E._addinName=S,E._appDomains=C,E._dialogRequirementMatrix=A,E._featureGates=_,E._officeTheme=I,E._initialDisplayMode=x,E.get_id=function(){return this._id},E.get_appName=function(){return this._appName},E.get_appVersion=function(){return this._appVersion},E.get_appUILocale=function(){return this._appUILocale},E.get_dataLocale=function(){return this._dataLocale},E.get_docUrl=function(){return this._docUrl},E.get_clientMode=function(){return this._clientMode},E.get_bindings=function(){return this._bindings},E.get_settings=function(){return this._settings},E.get_reason=function(){return this._reason},E.get_osfControlType=function(){return this._osfControlType},E.get_eToken=function(){return this._eToken},E.get_correlationId=function(){return this._correlationId},E.get_appInstanceId=function(){return this._appInstanceId},E.get_touchEnabled=function(){return this._touchEnabled},E.get_commerceAllowed=function(){return this._commerceAllowed},E.get_appMinorVersion=function(){return this._appMinorVersion},E.get_requirementMatrix=function(){return this._requirementMatrix},E.get_dialogRequirementMatrix=function(){return this._dialogRequirementMatrix},E.get_hostCustomMessage=function(){return this._hostCustomMessage},E.get_hostFullVersion=function(){return this._hostFullVersion},E.get_isDialog=function(){return this._isDialog},E.get_clientWindowHeight=function(){return this._clientWindowHeight},E.get_clientWindowWidth=function(){return this._clientWindowWidth},E.get_addinName=function(){return this._addinName},E.get_appDomains=function(){return this._appDomains},E.get_featureGates=function(){return this._featureGates},E.get_officeTheme=function(){return this._officeTheme},E.get_initialDisplayMode=function(){return this._initialDisplayMode?this._initialDisplayMode:0}},u.OsfControlType={DocumentLevel:0,ContainerLevel:1},u.ClientMode={ReadOnly:0,ReadWrite:1},u.OUtil.setNamespace("Microsoft",window),u.OUtil.setNamespace("Office",Microsoft),u.OUtil.setNamespace("Client",Microsoft.Office),u.OUtil.setNamespace("WebExtension",Microsoft.Office),Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened",ControlActivation:"controlActivation"},Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"},Microsoft.Office.WebExtension.FilterType={All:"all"},Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",PlatformType:"platformType",HostType:"hostType",ForceConsent:"forceConsent",ForceAddAccount:"forceAddAccount",AuthChallenge:"authChallenge",AllowConsentPrompt:"allowConsentPrompt",ForMSGraphAccess:"forMSGraphAccess",AllowSignInPrompt:"allowSignInPrompt",JsonPayload:"jsonPayload",EnableNewHosts:"enableNewHosts",AccountTypeFilter:"accountTypeFilter",AddinTrustId:"addinTrustId",Reserved:"reserved",Tcid:"tcid",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",CustomFieldId:"customFieldId",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",DisplayInIframe:"displayInIframe",MessageContent:"messageContent",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",UrlNoHostInfo:"urlNoHostInfo",TargetOrigin:"targetOrigin",AppCommandInvocationCompletedData:"appCommandInvocationCompletedData",Base64:"base64",FormId:"formId"},u.OUtil.setNamespace("DDA",u),u.DDA.DocumentMode={ReadOnly:1,ReadWrite:0},u.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"},u.DDA.EventDescriptors={},u.DDA.ListDescriptors={},u.DDA.UI={},u.DDA.getXdmEventName=function(e,t){return t==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||t==Microsoft.Office.WebExtension.EventType.BindingDataChanged||t==Microsoft.Office.WebExtension.EventType.DataNodeDeleted||t==Microsoft.Office.WebExtension.EventType.DataNodeInserted||t==Microsoft.Office.WebExtension.EventType.DataNodeReplaced?e+"_"+t:t},u.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidGetAccessTokenMethod:98,dispidGetAuthContextMethod:99,dispidOpenBrowserWindow:102,dispidCreateDocumentMethod:105,dispidInsertFormMethod:106,dispidDisplayRibbonCalloutAsyncMethod:109,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123,dispidCreateTaskMethod:124,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidSendMessageMethod:145,dispidExecuteFeature:146,dispidQueryFeature:147,dispidMethodMax:147},u.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidDialogNotificationShownInAddinEvent:11,dispidDialogParentMessageReceivedEvent:12,dispidObjectDeletedEvent:13,dispidObjectSelectionChangedEvent:14,dispidObjectDataChangedEvent:15,dispidContentControlAddedEvent:16,dispidActivationStatusChangedEvent:32,dispidRichApiMessageEvent:33,dispidAppCommandInvokedEvent:39,dispidOlkItemSelectedChangedEvent:46,dispidOlkRecipientsChangedEvent:47,dispidOlkAppointmentTimeChangedEvent:48,dispidOlkRecurrenceChangedEvent:49,dispidOlkAttachmentsChangedEvent:50,dispidOlkEnhancedLocationsChangedEvent:51,dispidOlkInfobarClickedEvent:52,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63},u.Constants={FileVersion:"0.0.0.0",ThreePartsFileVersion:"0.0.0",OmexAnonymousServiceName:"__omexExtensionAnonymousProxy",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceName:"__omexExtensionGatedProxy",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceName:"__omexExtensionProxy",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",OmexConsentNotificationPage:"/client/consentnotification.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",ConsentedCacheKey:"__OSF_RUNTIME_.Consented.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"https://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",DisplayLanguageParameterName:"_office.displayLanguage",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js",StringResourceFile:"osfruntime_strings.js"},function(e){var t=function(){function t(){}return t.init=function(t){return e.ShortcutsMappingTableManager.init(t)},t.getShortcutInfoArrayFromShortcutKey=function(t,n){if(n<1||n>255)throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidKeyCode,"Invalid parameter key code: "+n);if(0==t||!e.ActionMetadataManager.containsModifierKeys(t))throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.missingModifierKey,"Missing modifier key: "+t);return e.ShortcutsMappingTableManager.getShortcutsInfo(t,n)},t.containsModifierKeys=function(t){var n=e.ExtendedManifestUtility.getPlatformName()==e.ShortcutsMappingTableManager.s_shortcutPlatformMac;return 0!=(t&(e.ShortcutsMappingTableManager.modifierKeys.SHIFT|e.ShortcutsMappingTableManager.modifierKeys.CTRL|e.ShortcutsMappingTableManager.modifierKeys.ALT|(n?e.ShortcutsMappingTableManager.modifierKeys.COMMAND:0)))},t}();e.ActionMetadataManager=t}(f||(f={})),function(e){e.TelemetryProperties={ariaTenantToken:"db334b301e7b474db5e0f02f07c51a47-a1b5bc36-1bbe-482f-a64a-c2d9cb606706-7439",nexusTenantToken:1755};var t=function(){var t="Addin Shortcut Error: Invalid key combination",n=null;function i(){}return i.getShortcutsMappingTable=function(){return i.s_shortcutsMappingTable},i.getActionName=function(e,t){return i.s_actionTable==n?n:i.s_actionTable[e]!=n?i.s_actionTable[e][t]:n},i.getKeyCodeFromVirtualKey=function(e){if(!i.s_stringToKeyCodeMap){i.s_stringToKeyCodeMap={};var t=Object.keys(i.keyCodes);for(var n in t){var r=t[n],o=i.keyCodes[r],a=i.specialCharacters[o];a&&(i.s_stringToKeyCodeMap[a]=r),i.s_stringToKeyCodeMap[o.toUpperCase()]=r}}return i.s_stringToKeyCodeMap[e.toUpperCase()]},i.convertModifierKeyToNumber=function(e){var t=(e=e.trim()).toUpperCase();return i.modifierKeys[t]==n?1==t.length||i.keyCodes[t]?(s.RuntimeTelemetryHelper.LogExceptionTag("Addin Shortcut Error: Multiple virtual key",n,n,573125059),n):(s.RuntimeTelemetryHelper.LogExceptionTag("Addin Shortcut Error: Invalid modifier key",n,n,573125058),n):i.modifierKeys[t]},i.convertModifierKeys=function(e){for(var t=0,r=0;r<e.length;r++){if(e[r]==n)return-1;t|=i.convertModifierKeyToNumber(e[r])}return t},i.convertStringToKeys=function(e){var r=e.split("+");if(r.length<2)return s.RuntimeTelemetryHelper.LogExceptionTag(t,n,n,n),n;var o=r.splice(0,r.length-1),a=r[r.length-1],c=i.convertModifierKeys(o),u=i.convertVirtualKeyToInt(a);return-1==u||-1==c?(s.RuntimeTelemetryHelper.LogExceptionTag(t,n,n,573125057),n):{modifierKeys:c,virtualKey:u}},i.convertVirtualKeyToInt=function(e){var t=(e=e.trim()).toUpperCase();if(1==t.length)return t.charCodeAt(0);var n=i.getKeyCodeFromVirtualKey(t);return n||-1},i.getShortcutsInfo=function(e,t){var r=[];if(i.s_shortcutsMappingTable[t]==n)return r;var o=i.s_shortcutsMappingTable[t][e];if(o==n)return r;for(var a in o)r.push({addinId:o[a].addinId,actionId:o[a].actionId,actionName:o[a].actionName});return r},i.getShortcutText=function(e,t,n){var r=i.keyCodes[t];return r||(r=String.fromCharCode(t)),i.getModifierKeyString(e,n)+"+"+r},i.getModifierKeyString=function(e,t){for(var n=[],r=1;r<=e;){if(e&r){var o=void 0;r==i.modifierKeys[i.s_optionKey.toUpperCase()]?(t||(t=i.s_shortcutPlatformWin32),o=t.toLowerCase()==i.s_shortcutPlatformMac?i.s_optionKey:i.s_altKey):o=i.keyCodesToModifierKeys[r],o&&n.push(o)}r<<=1}return(n=n.sort()).join("+")},i.getShortcutsMappingTableString=function(){return i.s_shortcutsMappingTable==n?n:JSON.stringify(i.s_shortcutsMappingTable)},i.getActionTableString=function(){return i.s_actionTable==n?n:JSON.stringify(i.s_actionTable)},i.getKeysFromShortcutPlatformAvailability=function(e){return"object"==typeof e?e[i.s_shortcutPlatformWeb]?e[i.s_shortcutPlatformWeb]:e[i.s_shortcutPlatformDefault]?e[i.s_shortcutPlatformDefault]:n:n},i.validateExtendedManifestShortcutKeys=function(r,o,a){var c=this;return e.OsfCache.get(e.OsfCache.c_osfCacheTableName,i.s_shortcutsTableCacheKey).then((function(u){var l="Addin Shortcut Error: Duplicate key combination in the same add-in",d="Addin Shortcut Error: Modifier key only contains SHIFT",f=r.shortcuts;if(f){var p={},m={};try{u&&(m=JSON.parse(u))}catch(t){if(s.RuntimeTelemetryHelper.LogExceptionTag("Addin Shortcut Error: Cannot parse shortcut table cache",n,n,573125056),a)throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidExtendedOverride," Addin Shortcut Error: Cannot parse shortcut table cache")}for(var h=0;h<f.length;h++){var g=i.getKeysFromShortcutPlatformAvailability(f[h].key),v=i.convertStringToKeys(g);if(v==n&&(s.RuntimeTelemetryHelper.LogExceptionTag(t,n,n,573125027),a))throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidKeyCode,t);if(v.modifierKeys==c.modifierKeys.SHIFT&&(s.RuntimeTelemetryHelper.LogExceptionTag(d,n,n,556287122),a))throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidKeyCode,d);if(m[v.virtualKey]&&m[v.virtualKey][v.modifierKeys]&&(m[v.virtualKey][v.modifierKeys].push({actionId:f[h].action,addinId:o}),s.RuntimeTelemetryHelper.LogExceptionTag("Addin Shortcut Warning: Duplicate key combination in existing cache",n,n,573125026)),p[v.virtualKey]==n&&(p[v.virtualKey]={}),p[v.virtualKey][v.modifierKeys]){for(var y in p[v.virtualKey][v.modifierKeys])if(p[v.virtualKey][v.modifierKeys][y].addinId==o)if(p[v.virtualKey][v.modifierKeys][y].actionId==f[h].action)s.RuntimeTelemetryHelper.LogExceptionTag("Addin Shortcut Error: Duplicate shortcut entry",n,n,573125025);else if(s.RuntimeTelemetryHelper.LogExceptionTag(l,n,n,573125024),a)throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidExtendedOverride,l)}else p[v.virtualKey][v.modifierKeys]=[];p[v.virtualKey][v.modifierKeys].push({actionId:f[h].action,addinId:o})}}}))},i.createActionsByIdTable=function(e){var t={};if(e)for(var n=0;n<e.length;n++)t[e[n].id]=e[n].name;return t},i.rebuildMappingTable=function(t){i.s_shortcutsMappingTable={},i.s_actionTable={};for(var r=0;r<t.length;r++){var o=t[r].extendedManifest.shortcuts,a=t[r].extendedManifest.actions,s=t[r].addinId,c=i.createActionsByIdTable(a);if(e.ShortcutKeyDispatchManager.isCustomShortcutsEnabled()&&(i.s_actionTable[s]=c),o){for(var u=0;u<o.length;u++){var l=i.getKeysFromShortcutPlatformAvailability(o[u].key),d=i.convertStringToKeys(l);if(d==n)return;var f=c[o[u].action],p={modifierKeys:d.modifierKeys,virtualKey:d.virtualKey,actionId:o[u].action,addinId:s,actionName:f||o[u].action};i.s_shortcutsMappingTable[d.virtualKey]==n&&(i.s_shortcutsMappingTable[d.virtualKey]={}),i.s_shortcutsMappingTable[d.virtualKey][d.modifierKeys]==n&&(i.s_shortcutsMappingTable[d.virtualKey][d.modifierKeys]=[]),i.s_shortcutsMappingTable[d.virtualKey][d.modifierKeys].push(p)}i.sendShortcutTelemetry(s,o.length)}}},i.sendShortcutTelemetry=function(t,r){setTimeout((function(){var o="function",i=new u.AddinIdInfo(t);if(i.getSolutionId()&&i.getStoreTypeId())if("object"==typeof Otel&&typeof Otel.Telemetry===o&&typeof Otel.Telemetry.sendOtelEvent===o){var a={otelEvent:{eventName:"Office.Extensibility.Shortcuts.InstallationInfo",dataFields:[{name:"solutionId",dataType:1,value:i.getPrivacyCompliantSolutionId()},{name:"storeType",dataType:1,value:e.ManifestUtil.GetStoreTypeName(i.getStoreTypeId())},{name:"shortcutsCount",dataType:2,value:r}],telemetryProperties:e.TelemetryProperties}};Otel.Telemetry.sendOtelEvent(a)}else s.RuntimeTelemetryHelper.LogCommonMessageTag("Addin Shortcut Error: The Otel isn't available, couldn't call sendOtelEvent for logging the shortcuts telemetry",n,573125022);else s.RuntimeTelemetryHelper.LogCommonMessageTag("Addin Shortcut Error: Couldn't get solutionid or storetype from the addinid",n,573125023)}),0)},i.getAllExtendedManifestAndBuildMappingTable=function(){return r(this,void 0,void 0,(function(){var t;return o(this,(function(n){switch(n.label){case 0:return[4,e.OsfExtendedManifestCache.getAll()];case 1:return t=n.sent(),i.rebuildMappingTable(t),[4,e.OsfCache.set(e.OsfCache.c_osfCacheTableName,i.s_shortcutsTableCacheKey,e.ShortcutsMappingTableManager.getShortcutsMappingTableString())];case 2:return n.sent(),e.ShortcutKeyDispatchManager.isCustomShortcutsEnabled()?[4,e.OsfCache.set(e.OsfCache.c_osfCacheTableName,i.s_actionTableCacheKey,e.ShortcutsMappingTableManager.getActionTableString())]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},i.init=function(t){return r(this,void 0,void 0,(function(){var r,a;return o(this,(function(o){switch(o.label){case 0:return t?e.ShortcutKeyDispatchManager.isCustomShortcutsEnabled()?[4,e.OsfCache.get(e.OsfCache.c_osfCacheTableName,i.s_shortcutsTableCacheKey)]:[3,6]:[3,11];case 1:return a=o.sent(),[4,e.OsfCache.get(e.OsfCache.c_osfCacheTableName,i.s_actionTableCacheKey)];case 2:return r=o.sent(),a!=n&&r!=n?[3,4]:[4,i.getAllExtendedManifestAndBuildMappingTable()];case 3:return o.sent(),[3,5];case 4:i.s_shortcutsMappingTable=JSON.parse(a),i.s_actionTable=JSON.parse(r),o.label=5;case 5:return[3,10];case 6:return[4,e.OsfCache.get(e.OsfCache.c_osfCacheTableName,i.s_shortcutsTableCacheKey)];case 7:return(a=o.sent())!=n?[3,9]:[4,i.getAllExtendedManifestAndBuildMappingTable()];case 8:return o.sent(),[3,10];case 9:i.s_shortcutsMappingTable=JSON.parse(a),o.label=10;case 10:return[3,13];case 11:return[4,i.getAllExtendedManifestAndBuildMappingTable()];case 12:o.sent(),o.label=13;case 13:return[2]}}))}))},i.s_shortcutPlatformMac="macintosh",i.s_shortcutPlatformWin32="windows",i.s_shortcutsTableCacheKey="shortcutstablecache",i.s_shortcutsMappingTable={},i.s_shortcutPlatformWeb="web",i.s_shortcutPlatformDefault="default",i.s_altKey="Alt",i.s_optionKey="Option",i.s_stringToKeyCodeMap=n,i.s_actionTableCacheKey="actiontablecache",i.s_actionTable={},i.keyCodes={18:"Alt",192:"BackQuote",220:"\\",8:"BackSpace",20:"CapsLock",188:",",17:"Ctrl",189:"-",46:"Del",40:"Down",35:"End",13:"Enter",187:"=",27:"Esc",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",36:"Home",45:"Ins",37:"Left",219:"[",91:"Meta",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",96:"NumPad0",97:"NumPad1",98:"NumPad2",99:"NumPad3",100:"NumPad4",101:"NumPad5",102:"NumPad6",103:"NumPad7",104:"NumPad8",105:"NumPad9",111:"NumPadDivide",110:"NumPadDot",109:"NumPadMinus",106:"NumPadMultiply",107:"NumPadPlus",34:"PageDown",33:"PageUp",179:"Pause",190:".",44:"PrintScreen",39:"Right",221:"]",145:"ScrollLock",186:";",222:"'",191:"/",32:"Space",9:"Tab",38:"Up",16:"Shift"},i.specialCharacters={"/":"SLASH","'":"SINGLEQUOTE",";":"SEMICOLON",".":"PERIOD","[":"LEFTBRACKET","]":"RIGHTBRACKET","=":"EQUALSIGN","-":"DASH",",":"COMMA","\\":"BACKSLASH"},i.modifierKeys={SHIFT:4,CTRL:8,CONTROL:8,ALT:32,OPTION:32,COMMAND:256},i.keyCodesToModifierKeys={4:"Shift",8:"Ctrl",32:"Alt",256:"Command"},i}();e.ShortcutsMappingTableManager=t}(f||(f={})),function(e){!function(t){var n="IsReactRibbonEnabled",r="ov:SourceLocation",o="resid",a="OfficeGroup",s="ov:Description",c="ov:Title",l=!0,d=!1,f="bt:Image",p="ov:VersionOverrides",m="o:OfficeApp",h=null,g="OfficeControl",v=g,y=function(e){var t=this;t.name="AddinManifestError",t.message=t.name+": "+e},b=function(e){this.name="AddinInternalError",this.message=e};function O(e,t){if(e==h)throw new y(t)}function S(e,t){for(var n="\r\n\f\b\v\t",r=0;r<n.length;++r)if(e.indexOf(n[r])>=0)throw new y(t)}var C=function(){function e(e){var t="bt:String",n=this;n.Images={},n.Urls={},n.LongStrings={},n.ShortStrings={};var r=e.manifest._xmlProcessor.selectSingleNode(m),o=e.selectSingleNode(r,[p,"ov:Resources"]);n.parseCollection(e,e.selectChildNodes(f,o,["bt:Images"]),n.Images),n.parseCollection(e,e.selectChildNodes("bt:Url",o,["bt:Urls"]),n.Urls),n.parseCollection(e,e.selectChildNodes(t,o,["bt:LongStrings"]),n.LongStrings),n.parseCollection(e,e.selectChildNodes(t,o,["bt:ShortStrings"]),n.ShortStrings)}return e.prototype.parseCollection=function(e,t,n){for(var r=t.length,o=0;o<r;o++){var i=t[o];n[i.getAttribute("id")]=e.parseLocaleAwareSettingsAndGetValue(i)}},e}();t.ManifestResourceManager=C;var A=function(){var e="Invalid characters in text value: ";function t(e,t,n,r){var o=this;o.hostType=e,o.formFactor=t,o.entitlement=n,o.manifest=r,o.resources=new C(o),o.officeGroupCount=0,o.officeControlCount=0}return t.prototype.shouldParseNode=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:OverriddenByRibbonApi",e);return t!=h&&this.manifest._parseBooleanNode(t)?d:l},t.prototype.parseIdRequired=function(e){var t=e.getAttribute("id");return O(t,"Id required"),t},t.prototype.parseLabel=function(e){var t=this.manifest._xmlProcessor.selectSingleNode("ov:Label",e);return t!=h?this.getShortString(t):h},t.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return O(t,"Label required"),t},t.prototype.parseRequiredSuperTip=function(e){var t=this.parseSuperTip(e);return O(t,"SuperTip required"),t},t.prototype.parseSuperTip=function(e){var t=this,n=h,r=t.manifest._xmlProcessor.selectSingleNode("ov:Supertip",e);if(r!=h){var o,i=r;O(r=t.manifest._xmlProcessor.selectSingleNode(c,i),"Title is necessary for SuperTip."),o=t.getShortString(r),O(r=t.manifest._xmlProcessor.selectSingleNode(s,i),"Description is necessary for SuperTip."),n={title:o,description:t.getLongString(r)}}return n},t.prototype.parseRequiredIcon=function(e){var t=this.parseIcon(e);return O(t,"Icon required"),t},t.prototype.parseIcon=function(e){var t=this.selectChildNodes(f,e,["ov:Icon"]),n=t.length;if(0==n)return h;for(var r={},o=0;o<n;o++){var i=t[o];r[i.getAttribute("size")]=this.getImageResource(i)}return r},t.prototype.parseMultipleChildControls=function(e,t,n){for(var r=[],o=0;o<t.childNodes.length;o++)-1!==e.indexOf(t.childNodes[o].nodeName)&&r.push(t.childNodes[o]);return this.parseControls(r,n)},t.prototype.parseChildControls=function(e,t,n){var r=this.manifest._xmlProcessor.selectNodes(e,t);return this.parseControls(r,n)},t.prototype.parseControls=function(e,t){for(var n=[],r=e.length,o=0;o<r;o++){var i=e[o];if(this.shouldParseNode(i)){var a=t(this,i);O(a,"parser must return a control."),n.push(a)}}return n},t.prototype.parseGroupUnderTab=function(e){var t;switch(e.nodeName){case a:t=new L,this.officeGroupCount++;break;default:t=new F}return t.parse(this,e),t},t.prototype.parseControlInGroup=function(e){var n,r=e.getAttribute(t.typeAttributeName);switch(r||e.nodeName!==v||(r=g),r){case"Menu":n=new k;break;case"Button":n=new P(r);break;case g:n=new N,this.officeControlCount++;break;default:throw new y("Unsupported control type.")}return n.parse(this,e),n},t.prototype.parseMenuItem=function(e){var t=new R;return t.parse(this,e),t},t.prototype.parseLocaleAwareSettingsAndGetValue=function(e){var t=this,n={},r=e.getAttribute("DefaultValue");n[t.manifest._defaultLocale]=r,n[t.manifest._defaultLocale.toLocaleLowerCase()]=r;var o=t.manifest._xmlProcessor.selectNodes("bt:Override",e);if(o)for(var i=o.length,a=0;a<i;a++){var s=(e=o[a]).getAttribute("Locale"),c=e.getAttribute("Value");n[s]=c,n[s.toLocaleLowerCase()]=c}return t.manifest._getDefaultValue(n)},t.prototype.selectSingleNode=function(e,t){if(t==h)return e;for(var n=0;n<t.length&&(e=this.manifest._xmlProcessor.selectSingleNode(t[n],e))!=h;n++);return e},t.prototype.selectChildNodes=function(e,t,n){return(t=this.selectSingleNode(t,n))==h?[]:this.manifest._xmlProcessor.selectNodes(e,t)},t.prototype.getSingleNodeValue=function(e,t){var n=this.manifest._xmlProcessor.selectSingleNode(e,t);return n?this.manifest._xmlProcessor.getNodeValue(n):""},t.prototype.getResourceByNode=function(e,t){var n=t.getAttribute(o),r=e[n];return O(r,"resid: "+n+" not found"),r},t.prototype.getImageResource=function(e){return this.getResourceByNode(this.resources.Images,e)},t.prototype.getUrlResource=function(e){return this.getResourceByNode(this.resources.Urls,e)},t.prototype.getLongString=function(t){var n=this.getResourceByNode(this.resources.LongStrings,t);return S(n,e+n),n},t.prototype.getShortString=function(t){var n=this.getResourceByNode(this.resources.ShortStrings,t);return S(n,e+n),n},t.typeAttributeName="xsi:type",t}();t.ParsingContext=A;var _=function(){function e(){}return e.buildControls=function(e,t){for(var n=t.length,r=0;r<n;r++){t[r].apply(e)}},e}(),I=function(e,t,n){var r=this;void 0===n&&(n=d),r.multipleCustomTabsEnabled=d,r.functionFile=e,r.builder=t,r.multipleCustomTabsEnabled=n},x=function(){function e(){}return e.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor,r=n.selectSingleNode(c,t);O(r,"Title is necessary for GetStarted."),this.title=e.getShortString(r);var o=n.selectSingleNode(s,t);O(o,"Description is necessary for GetStarted."),this.description=e.getLongString(o);var i=n.selectSingleNode("ov:LearnMoreUrl",t);this.learnMoreUrl=e.getUrlResource(i)},e}(),E=function(){function e(e){this.type=e}return e.prototype.buildAction=function(){},e.prototype.parse=function(){},e}(),T=function(e){function t(){return e!==h&&e.apply(this,arguments)||this}return i(t,e),t.prototype.buildAction=function(e){var t=this;return e.actionBuilder.buildShowTaskpane(t.sourceLocation,t.title,t.taskpaneId,t.sourceLocationResid)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n);var i=t.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",n);i!=h&&(r.taskpaneId=i.firstChild.nodeValue),(i=t.manifest._xmlProcessor.selectSingleNode("ov:SourceLocation ",n))!=h&&(r.sourceLocationResid=i.getAttribute(o)),(i=t.manifest._xmlProcessor.selectSingleNode(c,n))!=h&&(r.title=t.getShortString(i))},t}(function(e){function t(){var t=e!==h&&e.apply(this,arguments)||this;return t.title=h,t}return i(t,e),t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode(r,t);O(n,"SourceLocation is necessary for ShowTaskpane action"),this.sourceLocation=e.getUrlResource(n),e.manifest.addManifestUrl(this.sourceLocation)},t}(E)),w=function(e){function t(){return e!==h&&e.apply(this,arguments)||this}return i(t,e),t.prototype.buildAction=function(e){return O(e.functionFile,"Function file source url is necessary for ExecuteFunctionAction."),e.actionBuilder.buildCallFunction(e.functionFile,this.functionName,this.controlId)},t.prototype.parse=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",t);O(n,"FunctionName is necessary for ExecuteFunctionAction."),this.functionName=e.manifest._xmlProcessor.getNodeValue(n)},t}(E),M=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),k=function(e){function t(){return e!==h&&e.apply(this,arguments)||this}return i(t,e),t.prototype.apply=function(e){e.controlBuilder.startBuildMenu(this),_.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},t.prototype.parse=function(t,n){var r=this;if(t.shouldParseNode(n)){e.prototype.parse.call(r,t,n),r.icon=t.parseRequiredIcon(n),r.superTip=t.parseRequiredSuperTip(n);var o=t.selectChildNodes("ov:Item",n,["ov:Items"]);r.children=t.parseControls(o,(function(e,t){return e.parseMenuItem(t)}))}},t}(M);t.MenuControl=k;var j=function(e){function t(t){var n=e.call(this)||this;return n.enabled=l,n.controlType=t,n}return i(t,e),t.prototype.apply=function(e){var t=this,n=t.action.buildAction(e),r={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:n,enabled:t.enabled};t.applyControl(e,r)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),r.icon=r.parseIcon(t,n),r.superTip=t.parseRequiredSuperTip(n);var o=t.manifest._xmlProcessor.selectSingleNode("ov:Action",n);O(o,"Action is necessary for itemControl.");var i,a=o.getAttribute(A.typeAttributeName);switch(a){case"ShowTaskpane":i=new T(a);break;case"ExecuteFunction":(i=new w(a)).controlId=r.id;break;default:throw new y("Unsupported action type.")}i.parse(t,o),r.actionType=a,r.action=i;var s=t.manifest._xmlProcessor.selectSingleNode("ov:Enabled",n);s!=h&&(r.enabled=t.manifest._parseBooleanNode(s))},t.prototype.applyControl=function(){throw new b("Not implemented method applyControl for ItemControl.")},t.prototype.parseIcon=function(e,t){return e.parseIcon(t)},t}(M),P=function(e){function t(){return e!==h&&e.apply(this,arguments)||this}return i(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addButton(t)},t.prototype.parseIcon=function(e,t){return e.parseRequiredIcon(t)},t}(j),R=function(e){function t(){return e.call(this,"MenuItem")||this}return i(t,e),t.prototype.applyControl=function(e,t){e.controlBuilder.addMenuItem(t)},t}(j),N=function(e){function t(){var t=e.call(this,g)||this;return t.label=h,t.icon=h,t.superTip=h,t.actionType=h,t.action=h,t.enabled=l,t}return i(t,e),t.prototype.apply=function(e){var t=this,n={id:t.id,label:t.label,icon:t.icon,superTip:t.superTip,actionType:t.actionType,action:t.action,enabled:t.enabled};t.applyControl(e,n)},t.prototype.parse=function(e,t){var n=this;try{n.id=e.parseIdRequired(t)}catch(e){throw new y("Required id attribute missing for OfficeControl.")}if(u.RibbonControlIdMap&&u.RibbonControlIdMap[n.id])n.id=u.RibbonControlIdMap[n.id];else if(!u.OUtil.checkFlight(u.FlightNames.AddinRibbonIdAllowUnknown))throw new y("Unsupported control id for OfficeControl.")},t.prototype.applyControl=function(e,t){e.controlBuilder.addNativeControl(t)},t}(j),D=function(){function e(e){var t=this;t.label=h,t.isOfficeTab=d,t.visible=l,t.children=[],t.tabType="default",t.insertBefore="",t.insertAfter="",t.autoFocus=d,t.isOfficeTab=e}return e.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildTab(this);for(var t=this.children.length,n=0;n<t;n++){this.children[n].apply(e)}e.builder.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var r=this;r.id=e.parseIdRequired(t),r.isOfficeTab||(r.label=e.parseLabelRequired(t),u.Settings[n]&&(r.insertBefore=e.getSingleNodeValue("ov:InsertBefore",t),r.insertAfter=e.getSingleNodeValue("ov:InsertAfter",t),r.insertBefore&&("TabHome"===r.insertBefore&&(r.autoFocus=l),e.insertBefore=r.insertBefore),r.insertAfter&&(e.insertAfter=r.insertAfter))),u.Settings[n]?r.children=e.parseMultipleChildControls(["Group",a],t,(function(e,t){return e.parseGroupUnderTab(t)})):r.children=e.parseMultipleChildControls(["Group"],t,(function(e,t){return e.parseGroupUnderTab(t)}))},e}(),F=function(e){function t(){var t=e!==h&&e.apply(this,arguments)||this;return t.groupType="Custom",t}return i(t,e),t.prototype.parse=function(t,r){var o=this;t.shouldParseNode(r)&&(e.prototype.parse.call(o,t,r),o.icon=t.parseRequiredIcon(r),u.Settings[n]?o.children=t.parseMultipleChildControls(["Control",g],r,(function(e,t){return e.parseControlInGroup(t)})):o.children=t.parseMultipleChildControls(["Control"],r,(function(e,t){return e.parseControlInGroup(t)})))},t.prototype.apply=function(e){e.builder.ribbonBuilder.startBuildGroup(this),_.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.ribbonBuilder},this.children),e.builder.ribbonBuilder.endBuildGroup()},t}(M),L=function(e){function t(){var t=e.call(this)||this;return t.children=h,t.label=h,t.icon=h,t.groupType=a,t}return i(t,e),t.prototype.parse=function(e,t){var n=this;try{n.id=e.parseIdRequired(t)}catch(e){throw new y("Required id attribute missing for OfficeGroup.")}if(u.RibbonGroupIdMap&&u.RibbonGroupIdMap[n.id])n.id=u.RibbonGroupIdMap[n.id];else if(!u.OUtil.checkFlight(u.FlightNames.AddinRibbonIdAllowUnknown))throw new y("Unsupported id for OfficeGroup.")},t.prototype.apply=function(e){e.builder.ribbonBuilder.addNativeGroup(this)},t}(F),U=function(){function e(e){this.type=e,this.tabs=[]}return e.prototype.apply=function(e){if(this.type==e.builder.commandSurface)for(var t=this.tabs.length,n=0,r=0,o=0;o<t;o++){var i=this.tabs[o];if(i.isOfficeTab&&n<1)n++;else{if(i.isOfficeTab||!(r<1||e.multipleCustomTabsEnabled))break;r++}i.apply(e)}},e.prototype.parse=function(e,t){var n="undefined",r=e.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",t);r!=h&&((s=new D(l)).parse(e,r),this.tabs.push(s));var o=e.manifest._xmlProcessor.selectNodes("ov:CustomTab",t);if(o)for(var i=o.length,a=0;a<i;a++){var s;if((r=o[a])!=h)(s=new D(d)).parse(e,r),this.tabs.push(s)}typeof otel!==n&&typeof otel.sendTelemetryEvent!==n&&otel.sendTelemetryEvent({name:"Office.Online.Extensibility.Ribbon.OfficeGroupControlCount",dataFields:[{name:"OfficeControlCount",int64:e.officeControlCount},{name:"OfficeGroupCount",int64:e.officeGroupCount},{name:"InsertBefore",string:JSON.stringify(e.insertBefore)},{name:"InsertAfter",string:JSON.stringify(e.insertAfter)}]})},e}(),B=function(){function e(){}return e.prototype.parse=function(e,t){e.shouldParseNode(t)&&(this.id=e.parseIdRequired(t),this.children=e.parseChildControls("ov:Control",t,(function(e,t){return e.parseControlInGroup(t)})))},e.prototype.apply=function(e){e.controlBuilder.startBuildMenu({id:this.id,label:h,superTip:h}),_.buildControls(e,this.children),e.controlBuilder.endBuildMenu()},e}(),H=function(){function e(e){this.type=e}return e.prototype.apply=function(e){this.type==e.builder.commandSurface&&_.buildControls({functionFile:e.functionFile,actionBuilder:e.builder.actionBuilder,controlBuilder:e.builder.contextMenuBuilder},this.children)},e.prototype.parse=function(e,t){this.children=e.parseChildControls("ov:OfficeMenu",t,(function(e,t){var n=new B;return n.parse(e,t),n}))},e}(),V=function(){function e(e){this.type=e}return e.prototype.apply=function(){},e.prototype.parse=function(e,t){var n=this,r=e.manifest._xmlProcessor.selectSingleNode("ov:Namespace",t);r&&(n.namespaceResId=r.getAttribute(o));var i=e.manifest._xmlProcessor.selectSingleNode("ov:Script",t);if(i&&(n.scriptResId=n._parseSourceLocationResId(e,i)),!n.scriptResId)throw new y("Missing required <Script> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var a=e.manifest._xmlProcessor.selectSingleNode("ov:Page",t);if(a&&(n.pageResId=n._parseSourceLocationResId(e,a)),!n.pageResId)throw new y("Missing required <Page> element under element <ExtensionPoint xsi:type='CustomFunctions'>.");var s=e.manifest._xmlProcessor.selectSingleNode("ov:Metadata",t);if(s&&(n.metadataResId=n._parseSourceLocationResId(e,s)),!n.metadataResId)throw new y("Missing required <Metadata> element under element <ExtensionPoint xsi:type='CustomFunctions'>.")},e.prototype._parseSourceLocationResId=function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode(r,t);if(n)return n.getAttribute(o)},e}();t.CustomFunctionsExtensionPoint=V;var z=function(){function t(){var e=this;e.getStartedNode=h,e.functionFile=h,e.functionFileResid=h,e.cacheableUrls=[],e.ExtensionPoints=[]}return t.prototype.cacheableResources=function(){return this.cacheableUrls},t.prototype.apply=function(t,n,r){var o=this;void 0===r&&(r=d);try{t.startApplyAddin({entitlement:o.extensionEntitlement,manifest:o.extensionManifest,startedNode:o.getStartedNode,overrides:{type:o.type,description:o.description}});for(var i=new I(o.functionFile,t,r),a=o.ExtensionPoints.length,s=0;s<a;s++){o.ExtensionPoints[s].apply(i)}t.endApplyAddin()}catch(t){throw t instanceof y&&n.setErrorMessageForAddin(o.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),u.OUtil.checkFlight(u.FlightNames.ManifestParserDevConsoleLog)&&e.DevConsole.log(t),t}},t.prototype.parse=function(e,t){var n=this;n.type=t.getAttribute(A.typeAttributeName);var r=e.manifest._xmlProcessor.selectSingleNode(s,t);r!=h&&(n.description=e.getLongString(r));for(var i=e.selectChildNodes("ov:Host",t,["ov:Hosts"]),a=h,c=i.length,u=0;u<c;u++){var l=i[u];if(l.getAttribute(A.typeAttributeName)==e.hostType){(a=e.manifest._xmlProcessor.selectSingleNode("ov:"+e.formFactor,l))==h&&(a=e.manifest._xmlProcessor.selectSingleNode("ov:AllFormFactors",l));break}}var d=e.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",a);d!=h&&(n.getStartedNode=new x,n.getStartedNode.parse(e,d)),(r=e.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",a))!=h&&(n.functionFileResid=r.getAttribute(o),n.functionFile=e.getUrlResource(r),e.manifest.addManifestUrl(n.functionFile));var f=e.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",a);c=f.length;for(u=0;u<c;u++){var p,m=f[u],g=m.getAttribute(A.typeAttributeName);switch(g){case"Events":throw"Not Implemented";case"PrimaryCommandSurface":p=new U(g);break;case"ContextMenu":p=new H(g);break;case"CustomFunctions":p=new V(g);break;default:throw new y("Unsupported extension type.")}p.parse(e,m),n.ExtensionPoints.push(p)}var v=e.resources.Images;for(var b in v)n.cacheableUrls.push(v[b]);n.extensionEntitlement=e.entitlement,n.extensionManifest=e.manifest},t}();t.VersionOverrides=z;var W=function(){function e(){}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(){},e}(),G=function(){function t(e,t){this.hostType=e,this.formFactor=t}return t.prototype.parseExtensions=function(t,n,r){try{var o=n._xmlProcessor.selectSingleNode(m),i=n._xmlProcessor.selectSingleNode(p,o);if(i==h)return new W;var a=new z;return a.parse(new A(this.hostType,this.formFactor,t,n),i),a}catch(n){throw n instanceof y&&r.setErrorMessageForAddin(t.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),u.OUtil.checkFlight(u.FlightNames.ManifestParserDevConsoleLog)&&e.DevConsole.log(n),n}},t}();t.AddinCommandsManifestParser=G}(e.Parser||(e.Parser={}))}(f||(f={})),function(e){var t=function(){function t(){}return t.clearSettingsByExtendedManifest=function(t){return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getSetting().then((function(n){if(n){var r=JSON.parse(n),o=t.shortcuts;if(Object.keys(r).length>0&&o){for(var i=0;i<o.length;i++){var a=e.ShortcutsMappingTableManager.getKeysFromShortcutPlatformAvailability(o[i].key),s=e.ShortcutsMappingTableManager.convertStringToKeys(a);null!=s&&(r[s.virtualKey]&&r[s.virtualKey][s.modifierKeys]&&(delete r[s.virtualKey][s.modifierKeys],0==Object.keys(r[s.virtualKey]).length&&delete r[s.virtualKey]))}return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().saveSettings(JSON.stringify(r))}}}))},t}();e.AddinShortcutsPreferenceSettingHelper=t}(f||(f={})),function(e){!function(e){e.log=function(e){u.OUtil.getBooleanSetting("DevConsoleEnabled")}}(e.DevConsole||(e.DevConsole={}))}(f||(f={})),function(e){!function(e){var t,n="Button",r="MenuItem",o=!1,a="ShowTaskpane",s=null;!function(e){var t="LongString",n="ShortString";e[e.Image=0]="Image",e[e.Url=1]="Url",e[e[n]=2]=n,e[e[t]=3]=t}(t||(t={}));var c=function(e){this.name="AddinManifestError",this.message=this.name+": "+e};function u(e,t){if(void 0!==typeof e&&e===s)throw new c(t)}function l(e,t){if(void 0!==typeof e&&e===s&&""===e)throw new c(t)}var d=function(){function e(e,t,n,r,o,i){var a=this;a.hostType=e,a.formFactor=t,a.entitlement=n,a.manifest=r,a.ribbonData=o,a.runtimeId=i,a.actions=a.parseActions(o.actions),u(a.actions,"actions is required")}return e.prototype.parseActions=function(e){for(var t={},n=0,r=e;n<r.length;n++){var o=r[n];if(o.id&&o.type){var i;switch(o.type){case a:(i=new p).parse(this,o);break;case"ExecuteFunction":(i=new m).parse(this,o);break;default:throw new c("Unknown action type")}i.runtimeId||(i.runtimeId=this.runtimeId),t[o.id]=i}}return t},e.prototype.parseIdRequired=function(e){var t=e.id?e.id:s;return l(t,"Id required"),t},e.prototype.parseLabelRequired=function(e){var t=this.parseLabel(e);return u(t,"Label required"),t},e.prototype.parseLabel=function(e){return e.label?e.label:s},e.prototype.parseSuperTipRequired=function(e){if(!e.superTip)throw new c("Supertip required");return this.parseSuperTip(e)},e.prototype.parseSuperTip=function(e){var t={title:"",description:""};return e.superTip&&(t.title=e.superTip.title?e.superTip.title:"",t.description=e.superTip.description?e.superTip.description:""),t},e.prototype.parseIconRequired=function(e){if(e.icon)return this.parseIcon(e);throw new c("Icon required")},e.prototype.parseIcon=function(e){var t={};if(e.icon)for(var n=0,r=e.icon;n<r.length;n++){var o=r[n];o.size&&o.sourceLocation&&(t[o.size]=o.sourceLocation)}return t},e.typeAttributeName="xsi:type",e}();e.ParsingContext=d;var f=function(){function e(){}return e.prototype.clone=function(){},e.prototype.buildAction=function(){},e.prototype.parse=function(e,t){l(t.type,"Action type required."),this.type=t.type},e}(),p=function(e){function t(){var t=e!==s&&e.apply(this,arguments)||this;return t.type=a,t.title=s,t.supportsPinning=o,t}return i(t,e),t.prototype.clone=function(){var e=this,n=new t;return n.id=e.id,n.type=e.type,n.controlId=e.controlId,n.runtimeId=e.runtimeId,n.title=e.title,n.sourceLocation=e.sourceLocation,n.taskpaneId=e.taskpaneId,n.supportsPinning=e.supportsPinning,n},t.prototype.buildAction=function(e){var t=this;return e.buildShowTaskpane(t.sourceLocation,t.title,t.taskpaneId,t.runtimeId)},t.prototype.parse=function(t,n){var r=this;e.prototype.parse.call(r,t,n),l(n.taskpaneId,"Taskpane ID required"),r.taskpaneId=n.taskpaneId,l(n.sourceLocation,"Source Location required"),r.sourceLocation=n.sourceLocation,u(n.title,"Title required"),r.title=n.title,n.supportPinning||(r.supportsPinning=n.supportPinning)},t}(f),m=function(e){function t(){return e!==s&&e.apply(this,arguments)||this}return i(t,e),t.prototype.clone=function(){var e=this,n=new t;return n.id=e.id,n.type=e.type,n.controlId=e.controlId,n.runtimeId=e.runtimeId,n.functionFile=e.functionFile,n.functionName=e.functionName,n},t.prototype.buildAction=function(e){var t=this;return e.buildCallFunction(t.functionFile,t.functionName,t.controlId,t.id)},t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n),this.functionFile=n.functionFile,this.functionName=n.functionName},t}(f),h=function(){function e(){}return e.prototype.parse=function(e,t){this.id=e.parseIdRequired(t),this.label=e.parseLabelRequired(t)},e}(),g=function(e){function t(){var t=e.call(this)||this;return t.enabled=!0,t}return i(t,e),t.prototype.apply=function(){},t.prototype.parse=function(t,i){var a=this;if(e.prototype.parse.call(a,t,i),a.icon=t.parseIconRequired(i),a.superTip=t.parseSuperTipRequired(i),a.enabled=!!i.enabled||o,i.type&&(a.controlType=i.type,i.type==r||i.type==n)){if(!(i.actionId&&i.actionId in t.actions))throw new c("Action is required");var s=t.actions[i.actionId].clone();s.controlId=a.id,a.actionParsed=s,a.actionType=s.type}},t}(h),v=function(e){function t(){var t=e.call(this)||this;return t.children=[],t.controlType="Menu",t}return i(t,e),t.prototype.apply=function(t,n){e.prototype.apply.call(this,t,n),t.ribbonBuilder.startBuildMenu(this);for(var r=0,o=this.children;r<o.length;r++){o[r].apply(t,n)}t.ribbonBuilder.endBuildMenu()},t.prototype.parse=function(t,n){if(e.prototype.parse.call(this,t,n),!(n.items&&n.items instanceof Array))throw new c("Menu items required.");for(var r=0,o=n.items;r<o.length;r++){var i=o[r],a=new y;a.parse(t,i),this.children.push(a)}},t}(g);e.Menu=v;var y=function(e){function t(){var t=e.call(this)||this;return t.controlType=r,t}return i(t,e),t.prototype.apply=function(t,n){var r=this;e.prototype.apply.call(r,t,n);var o=r.actionParsed.buildAction(t.actionBuilder),i={id:r.id,label:r.label,icon:r.icon,superTip:r.superTip,actionType:r.actionType,action:o,enabled:r.enabled};t.ribbonBuilder.addMenuItem(i)},t}(g),b=function(e){function t(){var t=e.call(this)||this;return t.controlType=n,t}return i(t,e),t.prototype.apply=function(t,n){var r=this;e.prototype.apply.call(r,t,n);var o=r.actionParsed.buildAction(t.actionBuilder),i={id:r.id,label:r.label,icon:r.icon,superTip:r.superTip,actionType:r.actionType,action:o,enabled:r.enabled};t.ribbonBuilder.addButton(i)},t}(g),O=function(e){function t(){var t=e!==s&&e.apply(this,arguments)||this;return t.children=[],t}return i(t,e),t.prototype.parse=function(t,r){var o=this;e.prototype.parse.call(o,t,r),o.icon=t.parseIconRequired(r);for(var i=0,a=r.controls;i<a.length;i++){var s=a[i];switch(l(s.type,"Control type required."),s.type){case n:var u=new b;u.parse(t,s),o.children.push(u);break;case"Menu":var d=new v;d.parse(t,s),o.children.push(d);break;default:throw new c("Unknown control type.")}}},t.prototype.apply=function(e,t){e.ribbonBuilder.startBuildGroup(this);for(var n=0,r=this.children;n<r.length;n++){r[n].apply(e,t)}e.ribbonBuilder.endBuildGroup()},t}(h),S=function(){function e(){var e=this;e.label=s,e.isOfficeTab=o,e.visible=!0,e.children=[],e.tabType="contextual",e.insertBefore="",e.insertAfter=""}return e.prototype.apply=function(e,t){e.ribbonBuilder.startBuildTab(this);for(var n=0,r=this.children;n<r.length;n++){r[n].apply(e,t)}e.ribbonBuilder.endBuildTab()},e.prototype.parse=function(e,t){var n=this;n.id=t.id,n.visible=t.visible||o,n.label=e.parseLabelRequired(t);for(var r=0,i=t.groups;r<i.length;r++){var a=i[r],s=new O;s.parse(e,a),n.children.push(s)}},e}(),C=function(){function e(e,t,n){this.entitlement=t,this.manifest=n,this.tabs=e}return e.prototype.cacheableResources=function(){return[]},e.prototype.apply=function(e,t){var n={entitlement:this.entitlement,manifest:this.manifest,overrides:s,startedNode:s};e.startApplyAddin(n);for(var r=0,o=this.tabs;r<o.length;r++){o[r].apply(e,t)}e.endApplyAddin()},e}(),A=function(){function e(e,t){var n=this;n.hostType=e,n.formFactor=t,n.tabs=[],n.maxTabCount=20}return e.prototype.parse=function(e,t,n,r,o){var i=[];try{var a=new d(this.hostType,this.formFactor,e,t,n,o);a.parseActions(n.actions);for(var s=0,u=n.tabs.slice(0,this.maxTabCount);s<u.length;s++){var l=u[s],f=new S;f.parse(a,l),i.push(f)}}catch(t){throw t instanceof c&&r.setErrorMessageForAddin(e.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message),t}return new C(i,e,t)},e}();e.AddinCommandsJsonParser=A}(e.JsonParser||(e.JsonParser={}))}(f||(f={})),function(e){var t=function(){function e(){}return e.createManifestForAddinAction=function(e,t,n,r){var o=null,i=new u.Manifest.ExtensionSettings,a=(u.FormFactor.Default,{}),s=e._UILocale.toLocaleLowerCase();a[s]=n,i._defaultHeight=o,i._defaultWidth=o,i._sourceLocations={},i._sourceLocations[s]=t;var c=e;return new u.Manifest.Manifest((function(e){e._xmlProcessor=c._xmlProcessor,e._displayNames=n!=o?a:c._displayNames,e._iconUrls=c._iconUrls,e._extensionSettings={formFactor:i},e._highResolutionIconUrls=c._highResolutionIconUrls,e._target=c._target,e._id=r!=o?r:c._id,e._version=c._version,e._providerName=c._providerName,e._idIssuer=c._idIssuer,e._alternateId=c._alternateId,e._defaultLocale=c._defaultLocale,e._signature=c._signature,e._capabilities=c._capabilities,e._hosts=c._hosts,e._descriptions=c._descriptions,e._appDomains=c._appDomains,e._permissions=c._permissions,e._requirements=c._requirements,e._webApplicationResource=c._webApplicationResource,e._webApplicationId=c._webApplicationId,e._webApplicationMsaId=c._webApplicationMsaId,e._webApplicationScopes=c._webApplicationScopes,e._webApplicationAuthorizations=c._webApplicationAuthorizations,e._ribbonExtensionControls=c._ribbonExtensionControls,e._equivalentAddins=c._equivalentAddins,e._versionOverrides=c._versionOverrides}),c._UILocale)},e.cacheManifestForAction=function(e,t,n){u.OsfManifestManager.cacheManifest(t,n,e)},e.purgeManifestForAction=function(e,t){u.OsfManifestManager.purgeManifest(e,t)},e}();e.AddinCommandsManifestManager=t}(f||(f={})),function(e){var t="##UILessContainer##",n=null;e.AddinActionContextMap={},e.AutoShowTaskPaneControlIdMap={};var r,o,i={},a={};!function(e){var t="ExclusiveForNew",n="ExclusiveForCur";e[e.Default=1]="Default",e[e[n]=2]=n,e[e[t]=3]=t}(r=e.CommandInvokeMode||(e.CommandInvokeMode={})),function(e){var t="ooeOperationNotSupported",n="ooeSuccess",r="ooeTimeout";e[e[r]=-1]=r,e[e[n]=0]=n,e[e[t]=5e3]=t}(o||(o={}));var s=function(){function r(e,t,n){this.contextProvider=e,this.manifest=n,this.entitlement=t}return r.prototype.buildShowTaskpane=function(e,t,n,r){return this.CreateManifestAndActivationContextForTaskpaneCommand(e,t,n,r)},r.prototype.buildCallFunction=function(e,t,n,r){return!t&&u.OUtil.checkFlight(u.FlightNames.UseActionIdForUILessCommand)?this.CreateManifestAndActivationContextForUILessCommand(e,r,n):this.CreateManifestAndActivationContextForUILessCommand(e,t,n)},r.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,t,r,a){var s=function(e,t){t==o.ooeSuccess&&r!=n&&(i[r]=e)},c=function(e,t){var r=i[e];if(r==n)return!1;var o=t.getOsfControl(r);return o!=n&&(o._sharedRuntimeId==n&&o._refresh(),!0)};return this.CreateManifestAndActivationContext(e,t,r,a,(function(e,t,o,i){r!=n&&c(r,t),e.showTaskpane(o,i,s)}))},r.prototype.CreateManifestAndActivationContext=function(t,r,o,i,s){var c=this,l=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,t,r,n);return function(r){var d=c.contextProvider.createActionContext(r,(function(a,d){var f=c.entitlement.assetId,p={assetId:f+(o||r),appVersion:c.entitlement.appVersion,storeId:c.entitlement.storeId,storeType:u.StoreType.InMemory,targetType:u.OsfControlTarget.TaskPane};l._inMemoryEToken=c.entitlement.eToken;var m=p.assetId,h=d==n?u.ManifestHostType.Workbook:u.getManifestHostType(d._hostType),g=r;if(d!=n){var v={ownerAssetId:f,controlId:r,originalControlId:""};d._notifyHost("0",u.AgaveHostAction.GetOriginalControlId,v),v.originalControlId!=n&&(g=v.originalControlId)}var y=n;u.OUtil.checkFlight(u.FlightNames.AddinActionDefinitionHybridMode)?t!=n?y=l.getSharedRuntimeForTaskpane(h,o||g):(y=l.getSharedRuntimeById(h,i),o=l.getTaskpaneIdByRuntimeId(h,i),p.assetId=f+o):y=l.getSharedRuntimeForTaskpane(h,o||g),y!=n&&y.Resid!=n&&y.Resid.length>0&&(m=u.OsfManifestManager.getSharedRuntimeManifestCacheKey(f,y.Resid)),e.AddinCommandsManifestManager.cacheManifestForAction(l,m,p.appVersion),s(a,d,p,l,o)}));e.AddinActionContextMap[r]=d,e.AutoShowTaskPaneControlIdMap[c.entitlement.assetId]==n&&"Office.AutoShowTaskpaneWithDocument"==o&&(e.AutoShowTaskPaneControlIdMap[c.entitlement.assetId]=r),i&&(a[c.entitlement.assetId]||(a[c.entitlement.assetId]={}),a[c.entitlement.assetId][i]||(a[c.entitlement.assetId][i]=r))}},r.prototype.CreateManifestAndActivationContextForUILessCommand=function(r,i,a){var s=this,c=function(e,t){if(t==o.ooeSuccess){var n={source:{id:a}};f.invokeAppCommand(e,i,n,(function(){}))}},l=e.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,r,n,n);return function(r){var i=s.contextProvider.createActionContext(r,(function(r,i){var a=s.entitlement.assetId,d={assetId:a+t,appVersion:s.entitlement.appVersion,storeId:s.entitlement.storeId,storeType:u.StoreType.InMemory,targetType:u.OsfControlTarget.TaskPane},p=d.assetId,m=i==n?u.ManifestHostType.Workbook:u.getManifestHostType(i._hostType),h=l.getSharedRuntimeForAppCmdsExecuteFunction(m);h!=n&&h.Resid!=n&&h.Resid.length>0&&(p=u.OsfManifestManager.getSharedRuntimeManifestCacheKey(a,h.Resid)),e.AddinCommandsManifestManager.cacheManifestForAction(l,p,d.appVersion),r.createUILessSandbox(d,l,(function(e,t){if(t==o.ooeSuccess)f.ensureOsfHostEntry(e,r);c(e,t)}))}));e.AddinActionContextMap[r]=i}},r}(),c=function(){function n(e,t){this.contextProvider=e,this.entitlement=t}return n.prototype.buildShowTaskpane=function(){var t=this;return function(n){delete e.AddinActionContextMap[n],e.AddinCommandsManifestManager.purgeManifestForAction(t.entitlement.assetId+n,t.entitlement.appVersion)}},n.prototype.buildCallFunction=function(){var n=this;return function(r){delete e.AddinActionContextMap[r],e.AddinCommandsManifestManager.purgeManifestForAction(n.entitlement.assetId+t,n.entitlement.appVersion)}},n}(),l=function(){function t(){}return t.createActionBuilder=function(e,t,n){return new s(e,t,n)},t.createDeleterActionBuilder=function(e,t){return new c(e,t)},t.bindAction=function(e,t){t(e)},t.retrieveActionContext=function(t){return e.AddinActionContextMap[t]},t.retrieveAutoShowTaskPaneControlIdMap=function(){return e.AutoShowTaskPaneControlIdMap},t.getTaskPaneControlIdFromAssetIdRuntimeId=function(e,t){return a[e]?a[e][t]:n},t}();e.DefaultControlActionBinder=l;var d=function(){function e(){this.invocationQueue={}}return e.prototype.invokeAppCommand=function(t,o,i,a,s){var c=this,l={dispid:u.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:c.osfControlId};l[0]=t,l[1]=o,l[2]=JSON.stringify(i),s=s||e.defaultTimeout;var d=i&&i.commandMode?i.commandMode:r.Default,f={args:l,onComplete:a,timeout:s,timeoutTimer:n},p=c.invocationQueue[o];p==n&&(p=[],c.invocationQueue[o]=p),!(d==r.ExclusiveForCur&&p.length>0)&&!(d==r.ExclusiveForNew&&p.length>1)&&p.push(f),1==p.length&&c.trySendInvocation(f)},e.prototype.invocationCompleted=function(e,t,r){var o=this,i=o;for(var a in o.invocationQueue){var s=o.invocationQueue[a],c=s[0];if(e==c.args[0]){if(s.length>1){s.splice(0,1);var u=s[0];window.setTimeout((function(){i.trySendInvocation(u)}),0)}else delete o.invocationQueue[a];return c.timeoutTimer!=n&&(window.clearTimeout(c.timeoutTimer),c.timeoutTimer=n),void c.onComplete(t,r)}}},e.prototype.sendInvocations=function(e){var t=this;if(t.eventHandler=e,e!=n)for(var r in t.invocationQueue){var o=t.invocationQueue[r][0];t.sendInvocation(e,o)}},e.prototype.trySendInvocation=function(e){var t=this.eventHandler;t!=n&&this.sendInvocation(t,e)},e.prototype.sendInvocation=function(e,t){var n=this,r=t.args;e(r),t.timeoutTimer=window.setTimeout((function(){n.invocationTimeout(r[0])}),t.timeout)},e.prototype.invocationTimeout=function(e){this.invocationCompleted(e,o.ooeTimeout,n)},e.prototype.disposeHost=function(){var e=this;for(var t in e.invocationQueue)return;e.host.disposeHost(e.osfControlId),e.onDisposed!=n&&e.onDisposed(e)},e.defaultTimeout=3e5,e}(),f=function(){var e="targetId",t="controlId",r="eventDispId";function i(){}return i.registerEvent=function(n,o,a){i.registerEventInternal(a[r],a[t],a[e],n,(function(e){o&&o(0==e)}))},i.unregisterEvent=function(n,o,a){i.unregisterEventInternal(a[r],a[t],a[e],n,(function(e){o&&o(0==e)}))},i.invokeAppCommand=function(e,t,n,r){var o=i.getOrCreateOsfHostEntry(e),a=i.getNextAppCommandId();o.invokeAppCommand(a,t,n,r)},i.invocationCompleted=function(e,t){var r=i.getOrCreateOsfHostEntry(e),o=t[0],a=t[1],s=t[2]?JSON.parse(t[2]):n;r.invocationCompleted(o,a,s)},i.ensureOsfHostEntry=function(e,t){var r=i.getOrCreateOsfHostEntry(e);return r.host==n&&(r.host=t),r},i.getNextAppCommandId=function(){return"AppCmd"+i._nextAppCommandId++},i.getOrCreateOsfHostEntry=function(e){var t=i._invocationQueues[e];return t==n&&((t=new d).osfControlId=e,t.onDisposed=function(e){delete i._invocationQueues[e.osfControlId]},i._invocationQueues[e]=t),t},i.registerEventInternal=function(e,t,n,r,a){switch(e){case u.DDA.EventDispId.dispidAppCommandInvokedEvent:var s=i.getOrCreateOsfHostEntry(t);return a(o.ooeSuccess),void s.sendInvocations(r)}a(o.ooeOperationNotSupported)},i.unregisterEventInternal=function(e,t,r,a,s){switch(e){case u.DDA.EventDispId.dispidAppCommandInvokedEvent:var c=i.getOrCreateOsfHostEntry(t);return c.eventHandler==a&&(c.eventHandler=n),void s(o.ooeSuccess)}s(o.ooeOperationNotSupported)},i._nextAppCommandId=0,i._invocationQueues={},i}();e.AddinCommandsRuntimeManager=f}(f||(f={})),u.ShowWindowDialogParameterKeys={Url:"url",Width:"width",Height:"height",DisplayInIframe:"displayInIframe",HideTitle:"hideTitle",UseDeviceIndependentPixels:"useDeviceIndependentPixels",PromptBeforeOpen:"promptBeforeOpen",EnforceAppDomain:"enforceAppDomain",UrlNoHostInfo:"urlNoHostInfo"},u.HostThemeButtonStyleKeys={ButtonBorderColor:"buttonBorderColor",ButtonBackgroundColor:"buttonBackgroundColor"},u.OmexPageParameterKeys={AppName:"client",AppVersion:"cv",AppUILocale:"ui",AppDomain:"appDomain",StoreLocator:"rs",AssetId:"assetid",NotificationType:"notificationType",AppCorrelationId:"corr",AuthType:"authType",AppId:"appid",Scopes:"scopes"},u.AuthType={Anonymous:0,MSA:1,OrgId:2,ADAL:3},u.OmexMessageKeys={MessageType:"messageType",MessageValue:"messageValue"},u.OmexRemoveAddinMessageKeys={RemoveAddinResultCode:"resultCode",RemoveAddinResultValue:"resultValue"},u.OmexRemoveAddinResultCode={Success:0,ClientError:400,ServerError:500,UnknownError:600},function(e){!function(e){var t="undefined",n="^https://[a-z0-9-]+.(officeapps.live|officeapps-df.live|partner.officewebapps).com/";function r(e){if(typeof JSON!==t)try{return JSON.stringify(e)}catch(e){}return""}function o(){try{var e=window.navigator.userAgent;return e.indexOf("MSIE ")>-1||e.indexOf("Trident/")>-1||e.indexOf("Edge/")>-1}catch(e){return i("Error happens in isInternetExplorer.",e),!1}}function i(e,t){c.msAjaxDebug.trace(e+" Exception details: "+r(t))}e.parseAppContextFromWindowName=function(e,t){return u.OUtil.parseInfoFromWindowName(e,t,u.WindowNameItemKeys.AppContext)},e.serializeObjectToString=r,e.isHostTrusted=function(){return new RegExp(n).test(u.getClientEndPoint()._targetUrl.toLowerCase())},e.addHostInfoAsQueryParam=function(e,t){if(!e)return null;var n,r="#",o=(e=e.trim()||"").split(r),i=o.shift(),a=o.join(r),s=i.split("?");return s.length>1?n=i+"&_host_Info="+t:s.length>0&&(n=i+"?_host_Info="+t),a?[n,r,a].join(""):n},e.getDomainForUrl=function(e){if(!e)return null;var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.host},e.shouldUseLocalStorageToPassMessage=function(){try{for(var e=["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3","Windows NT 10.0"],t=window.navigator.userAgent,n=0,r=e.length;n<r;n++)if(t.indexOf(e[n])>-1)return o();return!1}catch(e){return i("Error happens in shouldUseLocalStorageToPassMessage.",e),!1}},e.isInternetExplorer=o,e.removeMatchesFromLocalStorage=function(e){for(var t=u.OUtil.getLocalStorage(),n=t.getKeysWithPrefix(""),r=0,o=n.length;r<o;r++)for(var i=n[r],a=0,s=e.length;a<s;a++)if(e[a].test(i)){t.removeItem(i);break}},e.logExceptionToBrowserConsole=i,e.isTeamsWebView=function(){var e=navigator.userAgent;return/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)},e.getHostSecure=function(e){if(typeof e!==t&&e){var n=void 0,r="https:";try{var o=new URL(e);if(o&&(n=o.host),!o.protocol)throw"fallback";if(o.protocol!==r)return}catch(t){try{var i=document.createElement("a");if(i.href=e,i.protocol!==r)return;var a=e.match(new RegExp("^https://[^/?#]+","i")),s=a&&1==a.length?a[0].toLowerCase():"",c=(i.protocol+"//"+i.hostname).toLowerCase();(i.protocol+"//"+i.host).toLowerCase()!==s&&c!=s||(n="443"==i.port?i.hostname:i.host)}catch(e){return}}return n?n.toLowerCase():void 0}};var a=function(){function e(){}return e.GatedCacheKeyPrefix="__OSF_GATED_OMEX.",e.AnonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.UngatedCacheKeyPrefix="__OSF_OMEX.",e.ActivatedCacheKeyPrefix="__OSF_RUNTIME_.Activated.",e.AppinstallAuthenticated="appinstall_authenticated.",e.Entitlement="entitle.",e.AppState="appState.",e.AppDetails="appDetails.",e.AppInstallInfo="appInstallInfo.",e.AuthenticatedAppInstallInfoCacheKey=e.GatedCacheKeyPrefix+e.AppinstallAuthenticated+"{0}.{1}.{2}.{3}",e.EntitlementsKey=e.Entitlement+"{0}.{1}",e.AppStateCacheKey="{0}"+e.AppState+"{1}.{2}",e.AppDetailKey="{0}"+e.AppDetails+"{1}",e.AppInstallInfoKey="{0}"+e.AppInstallInfo+"{1}.{2}",e.ActivatedCacheKey=e.ActivatedCacheKeyPrefix+"{0}.{1}.{2}",e}();e.CacheConstants=a}(e.WACUtils||(e.WACUtils={}))}(f||(f={})),u.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64},u.Xpath3Provider=function(e,t){var n=this;n._xmldoc=(new DOMParser).parseFromString(e,"text/xml"),n._evaluator=new XPathEvaluator,n._namespaceMapping={},n._defaultNamespace=null;for(var r,o=t.split(" "),i=0;i<o.length;++i)(r=/xmlns="([^"]*)"/g.exec(o[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(o[i]))&&(n._namespaceMapping[r[1]]=r[2]);n._resolver=n},u.Xpath3Provider.prototype={lookupNamespaceURI:function(e){return this._namespaceMapping[e]||this._defaultNamespace},addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);return r?r.singleNodeValue:null},selectNodes:function(e,t){var n=(t?"./":"/")+e;t=t||this.getDocumentElement();var r=this._evaluator.evaluate(n,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),o=[];if(r)for(var i=r.iterateNext();i;)o.push(i),i=r.iterateNext();return o},selectNodesByXPath:function(e,t){var n=this._evaluator.evaluate(e,t,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),r=[];if(n)for(var o=n.iterateNext();o;)r.push(o),o=n.iterateNext();return r},getDocumentElement:function(){return this._xmldoc.documentElement}},u.IEXpathProvider=function(e,t){for(var n=null,r=["MSXML2.DOMDocument.6.0"],o=0;o<r.length;o++)try{(n=new ActiveXObject(r[o])).setProperty("ResolveExternals",!1),n.setProperty("ValidateOnParse",!1),n.setProperty("ProhibitDTD",!0),n.setProperty("MaxXMLSize",u.XmlConstants.MaxXmlSize),n.setProperty("MaxElementDepth",u.XmlConstants.MaxElementDepth),n.async=!1,n.loadXML(e),n.setProperty("SelectionLanguage","XPath"),n.setProperty("SelectionNamespaces",t);break}catch(e){c.msAjaxDebug.trace("xml doc creating error:"+e)}this._xmldoc=n},u.IEXpathProvider.prototype={selectSingleNode:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectSingleNode(n)},addNamespaceMapping:function(e,t){var n="SelectionNamespaces",r=this._xmldoc.getProperty(n),o="xmlns:"+e+"=",i="xmlns:"+e+'="'+t+'"';return-1==r.indexOf(o)&&(r=r+" "+i,this._xmldoc.setProperty(n,r),!0)},selectNodes:function(e,t){var n=(t?"./":"/")+e;return(t=t||this.getDocumentElement()).selectNodes(n)},selectNodesByXPath:function(e,t){return t.selectNodes(e)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}},u.DomParserProvider=function(e,t){var n=this;try{n._xmldoc=(new DOMParser).parseFromString(e,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}n._namespaceMapping={},n._defaultNamespace=null;for(var r,o=t.split(" "),i=0;i<o.length;++i)(r=/xmlns="([^"]*)"/g.exec(o[i]))?n._defaultNamespace=r[1]:(r=/xmlns:([^=]*)="([^"]*)"/g.exec(o[i]))&&(n._namespaceMapping[r[1]]=r[2])},u.DomParserProvider.prototype={addNamespaceMapping:function(e,t){return!this._namespaceMapping[e]&&(this._namespaceMapping[e]=t,!0)},selectSingleNode:function(e,t){var n=t||this._xmldoc,r=this._selectNodes(e,n);return 0===r.length?null:r[0]},selectNodes:function(e,t){var n=t||this._xmldoc;return this._selectNodes(e,n)},selectNodesByXPath:function(){return null},_selectNodes:function(e,t){var n=[];if(!e)return n;var r,o,i=e.split(":");if(1===i.length)r=null,o=i[0];else{if(2!==i.length)throw c.msAjaxError.argument("name");r=this._namespaceMapping[i[0]],o=i[1]}if(!t.hasChildNodes)return n;for(var a=t.childNodes,s=0;s<a.length;s++)o===this._removeNodePrefix(a[s].nodeName)&&r===a[s].namespaceURI&&n.push(a[s]);return n},_removeNodePrefix:function(e){var t=e.split(":");return 1===t.length?e:t[1]},getDocumentElement:function(){return this._xmldoc.documentElement}},u.XmlProcessor=function(e,t){var n=this,r=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:!1},{name:"xmlNamespaces",type:String,mayBeNull:!1}]);if(r)throw r;document.implementation&&document.implementation.hasFeature("XPath","3.0")?n._provider=new u.Xpath3Provider(e,t):(n._provider=new u.IEXpathProvider(e,t),n._provider.getActiveXObject()||(n._provider=new u.DomParserProvider(e,t)))},u.XmlProcessor.prototype={addNamespaceMapping:function(e,t){var n=Function._validateParams(arguments,[{name:"namespacePrefix",type:String,mayBeNull:!1},{name:"namespaceUri",type:String,mayBeNull:!1}]);if(n)throw n;return this._provider.addNamespaceMapping(e,t)},selectSingleNode:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectSingleNode(e,t)},selectNodes:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return this._provider.selectNodes(e,t)},selectNodesByXPath:function(e,t){var n=Function._validateParams(arguments,[{name:"xpath",type:String,mayBeNull:!1},{name:"contextNode",mayBeNull:!0,optional:!0}]);if(n)throw n;return t=t||this._provider.getDocumentElement(),this._provider.selectNodesByXPath(e,t)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.text?e.text:e.textContent},getNodeText:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return 9==this.getNodeType(e)?this.getNodeText(this.getDocumentElement()):e.text?e.text:e.textContent},setNodeText:function(e,t){var n=!1,r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:n},{name:"text",type:String,mayBeNull:n}]);if(r)throw r;if(9==this.getNodeType(e))return n;try{e.text?e.text=t:e.textContent=t}catch(e){return n}return!0},getNodeXml:function(e){var t,n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(n)throw n;return e.xml?t=e.xml:(t=(new XMLSerializer).serializeToString(e),2==this.getNodeType(e)&&(t=this.getNodeBaseName(e)+'="'+t+'"')),t},setNodeXml:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"xml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new u.XmlProcessor(t,"");if(!r.isValidXml())return null;var o=r.getDocumentElement();try{e.parentNode.replaceChild(o,e)}catch(e){return null}return o},getNodeNamespaceURI:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.namespaceURI},getNodePrefix:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.prefix},getNodeBaseName:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return!e.nodeType||1!=e.nodeType&&2!=e.nodeType?e.nodeName:e.baseName?e.baseName:e.localName},getNodeType:function(e){var t=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1}]);if(t)throw t;return e.nodeType},appendChild:function(e,t){var n=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"childXml",type:String,mayBeNull:!1}]);if(n)throw n;var r=new u.XmlProcessor(t,"");if(!r.isValidXml())return null;var o=r.getDocumentElement();return e.appendChild(o),o},_getAttributeLocalName:function(e){return e.localName?e.localName:e.baseName},readAttributes:function(e,t,n){var r=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:!1},{name:"attributesToRead",type:Object,mayBeNull:!1},{name:"objectToFill",type:Object,mayBeNull:!1}]);if(r)throw r;for(var o,i,a=0;a<e.attributes.length;a++)for(var s in o=e.attributes[a],i=this._getAttributeLocalName(o),t)i===s&&(n[t[s]]=o.value)},isValidXml:function(){var e="parsererror";if(null==this.getDocumentElement())return!1;if(this._provider._xmldoc.getElementsByTagName(e).length>0){var t=(new DOMParser).parseFromString("<","text/xml").getElementsByTagName(e)[0].namespaceURI;return this._provider._xmldoc.getElementsByTagNameNS(t,e).length<=0}return!0}},function(e){var t=function(){function e(){}return e.prototype.Serialize=function(e){try{return JSON.stringify(e)}catch(e){return null}},e.prototype.Deserialize=function(e){try{return JSON.parse(e)}catch(e){return null}},e}();e.SafeSerializer=t;var n=function(){function e(e,t){this._localStorage=e,this._serializer=t}return e.prototype.GetCacheItem=function(t,n,r,o,i){var a="cacheExpired",s=this;void 0===n&&(n=!0),void 0===i&&(i=!0),s.ValidateCurrentCache();var c=s._localStorage.getItem(t);if(c){var u=s._serializer.Deserialize(c);if(void 0!==o&&o>0&&o-u.createdOn>0)s._localStorage.removeItem(t),r&&(r[a]=!0);else{if(!n)return u.data;var l=new Date;if(Math.abs(l.getTime()-u.createdOn)<e.msPerDay*u.refreshRate)return u.data;i&&(s._localStorage.removeItem(t),r&&(r[a]=!0))}}},e.prototype.SetCacheItem=function(t,n,r){r=r||e.defaultRefreshRateInDays;var o={data:n,createdOn:(new Date).getTime(),refreshRate:r};this._localStorage.setItem(t,this._serializer.Serialize(o))},e.prototype.RemoveCacheItem=function(e){this._localStorage.removeItem(e)},e.prototype.RemoveAll=function(e){for(var t=this._localStorage.getKeysWithPrefix(e),n=0,r=t.length;n<r;n++)this._localStorage.removeItem(t[n])},e.prototype.RemoveMatches=function(e){for(var t=this._localStorage.getKeysWithPrefix(""),n=0,r=t.length;n<r;n++)for(var o=t[n],i=0,a=e.length;i<a;i++)if(e[i].test(o)){this._localStorage.removeItem(o);break}},e.prototype.ValidateCurrentCache=function(){this._localStorage.getItem(e.cacheVersionKey)!=e.currentSchemaVersion&&(this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]),this._localStorage.setItem(e.cacheVersionKey,e.currentSchemaVersion))},e.defaultRefreshRateInDays=3,e.msPerDay=864e5,e.currentSchemaVersion="1",e.checkedCache=!1,e.cacheVersionKey="osfCacheVersion",e}();e.AppsDataCacheManager=n;var r=function(e){function t(t,n){return e.call(this,t,n)||this}return i(t,e),t.prototype.GetRefreshToken=function(n,r){var o=u.OUtil.formatString(t._refreshTokenCacheKey,n,r);return e.prototype.GetCacheItem.call(this,o)},t.prototype.AddRefreshToken=function(n,r,o){var i=u.OUtil.formatString(t._refreshTokenCacheKey,r,o);e.prototype.SetCacheItem.call(this,i,n)},t.prototype.RemoveAll=function(){e.prototype.RemoveAll.call(this,t._refreshTokenCachePrefixKey)},t.prototype.RemoveRefreshToken=function(n,r){var o=u.OUtil.formatString(t._refreshTokenCacheKey,n,r);e.prototype.RemoveCacheItem.call(this,o)},t._refreshTokenCacheKey="_OSF_PRIVATECATALOG_REFRESHTOKEN_{0}_{1}",t._refreshTokenCachePrefixKey="_OSF_PRIVATECATALOG_REFRESHTOKEN",t}(n);e.TokenCacheManager=r}(f||(f={})),function(e){var t="Error",n="ResponseTime",r="Result",o="OperationMetadata",a="ErrorResult",s="AssetId",c="CorrelationId",u=!0,l=function(){function e(e){this._table=e,this._fields={}}return Object.defineProperty(e.prototype,"Fields",{get:function(){return this._fields},enumerable:u,configurable:u}),Object.defineProperty(e.prototype,"Table",{get:function(){return this._table},enumerable:u,configurable:u}),e.prototype.SerializeFields=function(){},e.prototype.SetSerializedField=function(e,t){null!=t&&(this._serializedFields[e]=t.toString())},e.prototype.SerializeRow=function(){var e=this;return e._serializedFields={},e.SetSerializedField("Table",e._table),e.SerializeFields(),JSON.stringify(e._serializedFields)},e}();e.BaseUsageData=l;var d=function(e){var t="Stage11Time",n="Stage10Time",r="Stage9Time",o="Stage8Time",l="Stage7Time",d="Stage6Time",f="Stage5Time",p="Stage4Time",m="Stage3Time",h="Stage2Time",g="Stage1Time",v="InstanceId",y="ActivationInfo",b="AppInfo";function O(){return e.call(this,"AppLoadTime")||this}return i(O,e),Object.defineProperty(O.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,b,{get:function(){return this.Fields[b]},set:function(e){this.Fields[b]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,y,{get:function(){return this.Fields[y]},set:function(e){this.Fields[y]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,v,{get:function(){return this.Fields[v]},set:function(e){this.Fields[v]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,g,{get:function(){return this.Fields[g]},set:function(e){this.Fields[g]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,h,{get:function(){return this.Fields[h]},set:function(e){this.Fields[h]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,m,{get:function(){return this.Fields[m]},set:function(e){this.Fields[m]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,p,{get:function(){return this.Fields[p]},set:function(e){this.Fields[p]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,f,{get:function(){return this.Fields[f]},set:function(e){this.Fields[f]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,d,{get:function(){return this.Fields[d]},set:function(e){this.Fields[d]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),Object.defineProperty(O.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),O.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(c,e.CorrelationId),e.SetSerializedField(b,e.AppInfo),e.SetSerializedField(y,e.ActivationInfo),e.SetSerializedField(v,e.InstanceId),e.SetSerializedField(s,e.AssetId),e.SetSerializedField(g,e.Stage1Time),e.SetSerializedField(h,e.Stage2Time),e.SetSerializedField(m,e.Stage3Time),e.SetSerializedField(p,e.Stage4Time),e.SetSerializedField(f,e.Stage5Time),e.SetSerializedField(d,e.Stage6Time),e.SetSerializedField(l,e.Stage7Time),e.SetSerializedField(o,e.Stage8Time),e.SetSerializedField(r,e.Stage9Time),e.SetSerializedField(n,e.Stage10Time),e.SetSerializedField(t,e.Stage11Time),e.SetSerializedField(a,e.ErrorResult)},O}(l);e.AppLoadTimeUsageData=d;var f=function(e){var t="NotificationClickInfo";function n(){return e.call(this,"AppNotification")||this}return i(n,e),Object.defineProperty(n.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(n.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),n.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(c,e.CorrelationId),e.SetSerializedField(a,e.ErrorResult),e.SetSerializedField(t,e.NotificationClickInfo)},n}(l);e.AppNotificationUsageData=f;var p=function(e){function t(){return e.call(this,"AppManagementMenu")||this}return i(t,e),Object.defineProperty(t.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.AssetId),e.SetSerializedField(o,e.OperationMetadata),e.SetSerializedField(a,e.ErrorResult)},t}(l);e.AppManagementMenuUsageData=p;var m=function(e){var t="LastActiveTabCount",n="LastActiveTab",r="DialogState",o="TrustPageSessionTime",a="TotalSessionTime";function c(){return e.call(this,"InsertionDialogSession")||this}return i(c,e),Object.defineProperty(c.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(c.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(c.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(c.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(c.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(c.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),c.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(s,e.AssetId),e.SetSerializedField(a,e.TotalSessionTime),e.SetSerializedField(o,e.TrustPageSessionTime),e.SetSerializedField(r,e.DialogState),e.SetSerializedField(n,e.LastActiveTab),e.SetSerializedField(t,e.LastActiveTabCount)},c}(l);e.InsertionDialogSessionUsageData=m;var h=function(e){function t(){return e.call(this,"UploadFileDevCatelog")||this}return i(t,e),Object.defineProperty(t.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(t.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),t.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(c,e.CorrelationId),e.SetSerializedField(o,e.OperationMetadata),e.SetSerializedField(a,e.ErrorResult)},t}(l);e.UploadFileDevCatelogUsageData=h;var g=function(e){var t="AppSizeHeight",n="AppSizeWidth",r="IsAppCommand",o="AppTargetType",a="AppVersion",s="AppId",l="StoreType";function d(){return e.call(this,"UploadFileDevCatalogUsage")||this}return i(d,e),Object.defineProperty(d.prototype,c,{get:function(){return this.Fields[c]},set:function(e){this.Fields[c]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,l,{get:function(){return this.Fields[l]},set:function(e){this.Fields[l]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,s,{get:function(){return this.Fields[s]},set:function(e){this.Fields[s]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,a,{get:function(){return this.Fields[a]},set:function(e){this.Fields[a]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,o,{get:function(){return this.Fields[o]},set:function(e){this.Fields[o]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(d.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),d.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(c,e.CorrelationId),e.SetSerializedField(l,e.StoreType),e.SetSerializedField(s,e.AppId),e.SetSerializedField(a,e.AppVersion),e.SetSerializedField(o,e.AppTargetType),e.SetSerializedField(r,e.IsAppCommand),e.SetSerializedField(n,e.AppSizeWidth),e.SetSerializedField(t,e.AppSizeHeight)},d}(l);e.UploadFileDevCatalogUsageUsageData=g;var v=function(e){function o(){return e.call(this,"OneDriveCatalogGetAccessToken")||this}return i(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogGetAccessTokenUsageData=v;var y=function(e){function o(){return e.call(this,"OneDriveCatalogGetManifests")||this}return i(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogGetManifestsUsageData=y;var b=function(e){var o="id";function a(){return e.call(this,"OneDriveCatalogGetManifest")||this}return i(a,e),Object.defineProperty(a.prototype,o,{get:function(){return this.Fields.id},set:function(e){this.Fields.id=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(a.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),a.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(o,e.id),e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},a}(l);e.OneDriveCatalogGetManifestUsageData=b;var O=function(e){function o(){return e.call(this,"OneDriveCatalogInsertManifest")||this}return i(o,e),Object.defineProperty(o.prototype,r,{get:function(){return this.Fields[r]},set:function(e){this.Fields[r]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,n,{get:function(){return this.Fields[n]},set:function(e){this.Fields[n]=e},enumerable:u,configurable:u}),Object.defineProperty(o.prototype,t,{get:function(){return this.Fields[t]},set:function(e){this.Fields[t]=e},enumerable:u,configurable:u}),o.prototype.SerializeFields=function(){var e=this;e.SetSerializedField(r,e.Result),e.SetSerializedField(n,e.ResponseTime),e.SetSerializedField(t,e.Error)},o}(l);e.OneDriveCatalogInsertManifestUsageData=O}(a||(a={})),function(e){var t,n,r,o,i=null,s="wa",c=!0,l=!1;!function(e){var t="verboseEx",n="unexpected";e[e[n]=10]=n,e[e.warning=15]="warning",e[e.info=50]="info",e[e.verbose=100]="verbose",e[e[t]=200]=t}(t=e.ULSTraceLevel||(e.ULSTraceLevel={})),function(e){var t="msoulscat_Osf_UploadFileDevCatalogUsage",n="msoulscat_Osf_UploadFileDevCatelog",r="msoulscat_Osf_InsertionDialogSession",o="msoulscat_Osf_AppManagementMenu",i="msoulscat_Osf_Runtime",a="msoulscat_Osf_Notification",s="msoulscat_Osf_Latency";e[e[s]=1401]=s,e[e[a]=1402]=a,e[e[i]=1403]=i,e[e[o]=1404]=o,e[e[r]=1405]=r,e[e[n]=1406]=n,e[e[t]=1411]=t}(n=e.ULSCat||(e.ULSCat={})),function(e){var t="IsAnonymous",n="InsertionDialogClosed",r="ConfirmationDialogCancel";e[e[r]=256]=r,e[e[n]=512]=n,e[e[t]=1024]=t}(r||(r={})),function(e){var t="TrustPageVisited",n="Canceled",r="Inserted",o="Undefined";e[e[o]=0]=o,e[e[r]=1]=r,e[e[n]=2]=n,e[e.Closed=3]="Closed",e[e[t]=8]=t}(o||(o={}));var d=function(){function e(){this.timeValue=0}return e.prototype.Start=function(){this.timeValue=-(new Date).getTime(),this.finishedMeasurement=l},e.prototype.Stop=function(){this.timeValue<0&&(this.timeValue+=(new Date).getTime(),this.finishedMeasurement=c)},Object.defineProperty(e.prototype,"Finished",{get:function(){return this.finishedMeasurement},enumerable:c,configurable:c}),Object.defineProperty(e.prototype,"ElapsedTime",{get:function(){var e=this.timeValue;return!this.Finished&&e<0&&(e=Math.abs(e)-(new Date).getTime()),e},enumerable:c,configurable:c}),e}();e.LatencyStopwatch=d;var f=function(){};e.Context=f;var p=function(){function e(){}return e.SendULSTraceTag=function(e,t,n,r){Microsoft.Office.WebExtension.FULSSupported&&Diag.UULS.trace(r,e,t,n)},e}(),m=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){p.SendULSTraceTag(e.category,e.level,t.SerializeRow(),6062431)},e.category=n.msoulscat_Osf_Notification,e.level=t.info,e}();e.NotificationLogger=m;var h=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){p.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085957)},e.category=n.msoulscat_Osf_AppManagementMenu,e.level=t.info,e}();e.AppManagementMenuLogger=h;var g=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){p.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085958)},e.category=n.msoulscat_Osf_UploadFileDevCatelog,e.level=t.info,e}();e.UploadFileDevCatelogLogger=g;var v=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){p.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17834653)},e.category=n.msoulscat_Osf_UploadFileDevCatalogUsage,e.level=t.info,e}();e.UploadFileDevCatalogUsageLogger=v;var y=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){p.SendULSTraceTag(e.category,e.level,t.SerializeRow(),4748055)},e.category=n.msoulscat_Osf_Latency,e.level=t.info,e}();e.LatencyLogger=y;var b=function(){function e(){}return e.Instance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.LogData=function(t){p.SendULSTraceTag(e.category,e.level,t.SerializeRow(),17085959)},e.category=n.msoulscat_Osf_InsertionDialogSession,e.level=t.info,e}();e.InsertionDialogSessionLogger=b;var O=function(){function e(){}return e.LogNotification=function(e,t,n){var r=new a.AppNotificationUsageData;r.CorrelationId=e,r.ErrorResult=t,r.NotificationClickInfo=n,m.Instance().LogData(r)},e}();e.AppNotificationHelper=O;var S=function(){function e(){}return e.LogAppManagementMenuAction=function(e,t,n,o,i,c){var u=new a.AppManagementMenuUsageData,l=0===e.toLowerCase().indexOf(s)?parseInt(e.substring(2),10):parseInt(e,10);o&&(t|=r.InsertionDialogClosed),i&&(t|=r.IsAnonymous),u.AssetId=l,u.OperationMetadata=t,u.ErrorResult=c,h.Instance().LogData(u)},e}();e.AppManagementMenuHelper=S;var C=function(){function e(){}return e.LogUploadFileDevCatelogAction=function(e,t,n,r,o,i){var s=new a.UploadFileDevCatelogUsageData;s.CorrelationId=e,s.OperationMetadata=t,s.ErrorResult=i,g.Instance().LogData(s)},e}();e.UploadFileDevCatelogHelper=C;var A=function(){function e(){}return e.LogUploadFileDevCatalogUsageAction=function(e,t,n,r,o,i,s,c){var u=new a.UploadFileDevCatalogUsageUsageData;u.CorrelationId=e,u.StoreType=t,u.AppId=n,u.AppVersion=r,u.AppTargetType=o,u.IsAppCommand=i,u.AppSizeWidth=s,u.AppSizeHeight=c,v.Instance().LogData(u)},e}();e.UploadFileDevCatalogUsageHelper=A;var _=function(){var e="Stage11Time",r="Stage10Time",o="Stage9Time",s="Stage8Time",c="Stage7Time",u="Stage5Time",l="Stage4Time",f="Stage2Time",m="Stage1Time";function h(){}return h.GenerateActivationMessage=function(e,t){var n="";return e!=i&&(n+="ActivationRuntimeType: "+e.toString()+"|"),t!=i&&(n+="CorrelationId: "+t),n},h.ActivationStart=function(i,g,v,y,b,O){h.activatingNumber++,i.LoadTime=new a.AppLoadTimeUsageData,i.Timers={},i.LoadTime.CorrelationId=y,i.LoadTime.AppInfo=g,i.LoadTime.ActivationInfo=0,i.LoadTime.InstanceId=b,i.LoadTime.AssetId=v,i.LoadTime.Stage1Time=0,i.Timers[m]=new d,i.LoadTime.Stage2Time=0,i.Timers[f]=new d,i.LoadTime.Stage3Time=0,i.LoadTime.Stage4Time=0,i.Timers[l]=new d,i.LoadTime.Stage5Time=0,i.Timers[u]=new d,i.LoadTime.Stage6Time=h.activatingNumber,i.LoadTime.Stage7Time=0,i.Timers[c]=new d,i.LoadTime.Stage8Time=0,i.Timers[s]=new d,i.LoadTime.Stage9Time=0,i.Timers[o]=new d,i.LoadTime.Stage10Time=0,i.Timers[r]=new d,i.LoadTime.Stage11Time=0,i.Timers[e]=new d,i.LoadTime.ErrorResult=0,i.ActivationRuntimeType=O,h.StartStopwatch(i,m),p.SendULSTraceTag(n.msoulscat_Osf_Runtime,t.info,h.GenerateActivationMessage(O,y),19515419)},h.ActivationEnd=function(e){h.ActivateEndInternal(e)},h.PageStart=function(e){h.StartStopwatch(e,f)},h.PageLoaded=function(e){h.StopStopwatch(e,f)},h.ServerCallStart=function(e){h.StartStopwatch(e,l)},h.ServerCallEnd=function(e){h.StopStopwatch(e,l)},h.AuthenticationStart=function(e){h.StartStopwatch(e,u)},h.AuthenticationEnd=function(e){h.StopStopwatch(e,u)},h.EntitlementCheckStart=function(e){h.StartStopwatch(e,c)},h.EntitlementCheckEnd=function(e){h.StopStopwatch(e,c)},h.KilledAppsCheckStart=function(e){h.StartStopwatch(e,s)},h.KilledAppsCheckEnd=function(e){h.StopStopwatch(e,s)},h.AppStateCheckStart=function(e){h.StartStopwatch(e,o)},h.AppStateCheckEnd=function(e){h.StopStopwatch(e,o)},h.ManifestRequestStart=function(e){h.StartStopwatch(e,r)},h.ManifestRequestEnd=function(e){h.StopStopwatch(e,r)},h.OfficeJSStartToLoad=function(t){h.StartStopwatch(t,e)},h.OfficeJSLoaded=function(t){h.StopStopwatch(t,e)},h.SetAnonymousFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,0)},h.SetRetryCount=function(e,t){h.SetActivationInfoField(e,t,3,2)},h.SetManifestTrustCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,5)},h.SetManifestDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,7)},h.SetOmexHasEntitlementFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,9)},h.SetManifestDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,11)},h.SetAppStateDataCachedFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,13)},h.SetAppStateDataInvalidFlag=function(e,t){h.SetActivationInfoField(e,h.ConvertFlagToBit(t),2,15)},h.SetActivationRuntimeType=function(e,t){h.SetActivationInfoField(e,t,2,17)},h.SetErrorResult=function(e,t){e.LoadTime&&(e.LoadTime.ErrorResult=t,h.ActivateEndInternal(e))},h.SetBit=function(e,t,n,r){h.SetActivationInfoField(e,t,r||2,n)},h.StartStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Start(),h.UpdateActivatingNumber(e))},h.StopStopwatch=function(e,t){e.LoadTime&&e.Timers&&e.Timers[t]&&(e.Timers[t].Stop(),h.UpdateActivatingNumber(e))},h.ConvertFlagToBit=function(e){return e?2:1},h.SetActivationInfoField=function(e,t,n,r){e.LoadTime&&(h.UpdateActivatingNumber(e),e.LoadTime.ActivationInfo=h.SetBitField(e.LoadTime.ActivationInfo,t,n,r))},h.SetBitField=function(e,t,n,r){return e&~(Math.pow(2,n)-1<<r)|t<<r},h.UpdateActivatingNumber=function(e){e.LoadTime&&(e.LoadTime.Stage6Time=e.LoadTime.Stage6Time>h.activatingNumber?e.LoadTime.Stage6Time:h.activatingNumber)},h.ActivateEndInternal=function(e){if(e.LoadTime){if(h.StopStopwatch(e,m),e.Timers)for(var r in e.Timers)e.Timers[r].ElapsedTime!=i&&(e.LoadTime[r]=e.Timers[r].ElapsedTime);p.SendULSTraceTag(n.msoulscat_Osf_Runtime,t.info,h.GenerateActivationMessage(e.ActivationRuntimeType,e.LoadTime.CorrelationId),19515420),y.Instance().LogData(e.LoadTime),e.LoadTime=i,h.activatingNumber--}},h.activatingNumber=0,h}();e.AppLoadTimeHelper=_;var I=function(){var e=" AppCorrelationId:";function r(){}return r.LogProxyFailure=function(e,n,o){var a;e==i&&(e=""),a=u.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",e,n),Object.keys(o).forEach((function(e){var t=o[e];t!=i&&(t=t.toString()),a+=", "+e+":"+t})),p.SendULSTraceTag(r.category,t.warning,a,6062432)},r.LogExceptionTag=function(n,o,a,s){var c=n;o&&(o.name&&(c+=" Exception name:"+o.name+"."),o.paramName&&(c+=" Param name:"+o.paramName+"."),o.message&&(c+=" Message:"+o.message+"."),o.stack&&(c+=" [Stack:"+o.stack+"]")),a!=i&&(c+=e+a+"."),p.SendULSTraceTag(r.category,t.warning,c,s)},r.LogCommonMessageTag=function(n,o,a){o!=i&&(n+=e+o+"."),p.SendULSTraceTag(r.category,t.info,n,a)},r.category=n.msoulscat_Osf_Runtime,r}();e.RuntimeTelemetryHelper=I;var x=function(){function e(){}return e.LogInsertionDialogSession=function(e,t,n,r,i,c){var u=new a.InsertionDialogSessionUsageData,l=0===e.toLowerCase().indexOf(s)?parseInt(e.substring(2),10):parseInt(e,10),d=o.Undefined;d|=r?o.Inserted:o.Canceled,n>0&&(d|=o.TrustPageVisited),u.AssetId=l,u.TotalSessionTime=t,u.TrustPageSessionTime=n,u.DialogState=d,u.LastActiveTab=i,u.LastActiveTabCount=c,b.Instance().LogData(u)},e}();e.InsertionDialogSessionHelper=x;var E=function(){function e(){}return e.IsPrivateAddin=function(e,r,o,a,d){switch((e||"").toLowerCase()){case u.StoreType.OMEX:case u.StoreType.HardCodedPreinstall:case u.StoreType.FirstParty:case u.StoreType.Sdx:case u.StoreType.WopiCatalog:return l;case u.StoreType.SPCatalog:case u.StoreType.SPApp:case u.StoreType.FileSystem:case u.StoreType.Registry:case u.StoreType.OneDrive:case u.StoreType.UploadFileDevCatalog:return c;case u.StoreType.PrivateCatalog:return d&&0===d.toLowerCase().indexOf(s)?l:r&&0===r.toLowerCase().indexOf(s)?l:c;case u.StoreType.Exchange:var f=a!=i?a.toLowerCase():i;if(f&&"default"===f||"marketplace"===f||"preinstalled"===f||"marketplaceprivatecatalog"===f)return l;var m=o!=i?o.toLowerCase():i;return m&&"microsoft"===m||"microsoft corp"===m||"microsoft corp."===m||"microsoft corporation"===m?l:c;case u.StoreType.InMemory:default:return p.SendULSTraceTag(n.msoulscat_Osf_Notification,t.warning,"Unknown StoreType: "+e+" in function IsPrivateAddin.",571494615),c}},e.GetAssetId=function(t,n,r,o,i){return e.IsPrivateAddin(t,n,o,i)?e.privateAssetId:r},e.privateAssetId="PRIVATE",e}();e.PrivacyRules=E}(s||(s={})),function(e){var t,n=!0,i=!1,a=null,c=function(){function e(){this.m_osfControlId=a,this.m_isControlReady=i,this.m_queue=[]}return Object.defineProperty(e.prototype,"osfControlId",{get:function(){return this.m_osfControlId},set:function(e){this.m_osfControlId=e},enumerable:n,configurable:n}),Object.defineProperty(e.prototype,"isControlReady",{get:function(){return this.m_isControlReady},set:function(e){this.m_isControlReady=e},enumerable:n,configurable:n}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return 0===this.m_queue.length},enumerable:n,configurable:n}),e.prototype.queueAction=function(e,t){var n={eventData:e,actionSender:t};this.m_queue.push(n)},e.prototype.sendActions=function(){var e=this;return new Promise((function(t){window.setTimeout((function(){for(;e.m_queue.length>0;){var n=e.m_queue[0];e.m_queue.splice(0,1),e.sendAction(n)}t()}),0)}))},e.prototype.sendAction=function(e){var t=e.eventData,n=e.actionSender;t&&n&&this.m_isControlReady&&n(this.m_osfControlId,t)},e}();!function(e){e[e.Unknown=0]="Unknown",e[e.Host=1]="Host",e[e.Addin=2]="Addin"}(t||(t={}));var l=function(){var l="The Otel isn't available, couldn't call sendOtelEvent for logging the shortcuts telemetry",d="function",f="Couldn't get solutionId or storetype from the addinid",p="addinId",m="ownerType",h="undefined";function g(){}return g.init=function(){return g.s_usedShortcutAddins={},g.s_isCustomShortcutsEnabled=u.OUtil.getBooleanSetting("EnableCustomShortcuts"),e.ActionMetadataManager.init(n).then((function(){if(g.isAddinShortcutsPreferenceSettingHelperSupported())return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().loadShortcutsPreferenceMappingTable()}))},g.isCustomShortcutsEnabled=function(){return g.s_isCustomShortcutsEnabled},g.isConflictFound=function(e,t){return e&&t.length>0||!e&&t.length>1},g.isAddinShortcutsPreferenceSettingHelperSupported=function(){return typeof Common!==h&&Common.App&&Common.App.AppsForOffice&&Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper&&Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance()},g.tryDispatchShortcutKey=function(r,o,c,l,d,f,v){var y="Error: Invalid Parameter";try{if(!l)throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidParameter,y);if(!d)throw new e.OsfRuntimeError(e.OsfRuntimeErrorCode.invalidParameter,y);var b=g.s_isCustomShortcutsEnabled?g.getShortcutInfoArrayFromShortcutKey(r,o):e.ActionMetadataManager.getShortcutInfoArrayFromShortcutKey(r,o);return b&&0!==b.length?!c&&1===b.length&&b[0].addinId&&b[0].actionId?((!v||v==b[0].addinId)&&g.callActionHandlerAndLogUsage(l,b[0].addinId,b[0].actionId),n):g.isConflictFound(!!c,b)?(typeof Common!==h&&Common.App&&Common.App.AppsForOffice&&Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper?Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getSetting().then((function(h){if(h){var y=JSON.parse(h);if(y[o.toString()]){var O=y[o.toString()][r.toString()];if(O)if(O[m]==t.Addin){for(var S=i,C=0;C<b.length;C++)if(O[p]==b[C].addinId){S=n;break}if(S)return void((!v||v==O[p])&&g.callActionHandlerAndLogUsage(l,O[p],O.action));s.RuntimeTelemetryHelper.LogCommonMessageTag("Action owner do not exist",a,573125068)}else{if(O[m]==t.Host&&!v)return void d();s.RuntimeTelemetryHelper.LogCommonMessageTag("Action owner type isn't support",a,573125067)}}}var A=[];c&&A.push({addinId:a,addinName:a,action:a,actionDescription:c,ownerType:t.Host});for(C=0;C<b.length;C++){var _=new u.AddinIdInfo(b[C].addinId),I=u.OsfManifestManager.getCachedManifest(_.getSolutionId(),_.getSolutionVersion());I&&A.push({addinId:b[C].addinId,addinName:I._displayNames[I._UILocale.toLowerCase()]==a?I._displayNames[I._defaultLocale.toLocaleLowerCase()]:I._displayNames[I._UILocale.toLowerCase()],action:b[C].actionId,actionDescription:b[C].actionName,ownerType:t.Addin})}if(1==A.length){if(A[0].ownerType==t.Host)return d(),n;if(A[0].ownerType==t.Addin)return g.callActionHandlerAndLogUsage(l,A[0].addinId,A[0].action),n}var x={modifiers:r,keyCode:o,shortcutText:e.ShortcutsMappingTableManager.getShortcutText(r,o,e.ExtendedManifestUtility.getPlatformName()),shortcutDisplayInfoArray:A};f(x).then((function(e){e>=0&&x.shortcutDisplayInfoArray[e]&&g.enableShortcutKey(x.shortcutDisplayInfoArray[e].ownerType,x.shortcutDisplayInfoArray[e].addinId,x.shortcutDisplayInfoArray[e].action,r,o).then((function(){x.shortcutDisplayInfoArray[e].ownerType==t.Addin?(!v||v==x.shortcutDisplayInfoArray[e].addinId)&&g.callActionHandlerAndLogUsage(l,x.shortcutDisplayInfoArray[e].addinId,x.shortcutDisplayInfoArray[e].action):x.shortcutDisplayInfoArray[e].ownerType==t.Host&&!v&&d()})),setTimeout((function(){g.sendShortcutConflictInfoTelemetry(x,e)}),0)}))})):s.RuntimeTelemetryHelper.LogCommonMessageTag("AddinShortcutsPreferenceSettingHelper isn't ready",a,573125065),n):i:i}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Failed to disptach the shortcut key",e,a,573125064),i}},g.getShortcutInfoArrayFromShortcutKey=function(t,n){if(!g.isAddinShortcutsPreferenceSettingHelperSupported())throw OfficeExtension.WacRuntime.Utility.createInvalidOperationException();var r=[],o=Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getShortcutInfoArray(t,n);Array.isArray(o)&&o.length>0&&o.forEach((function(t){var n=e.ShortcutsMappingTableManager.getActionName(t.addinId,t.action);r.push({addinId:t.addinId,actionId:t.action,actionName:n})}));var i=e.ShortcutsMappingTableManager.getShortcutsMappingTable();if(i!=a&&i[n]!=a){var s=i[n][t];Array.isArray(s)&&s.length>0&&s.forEach((function(t){if(!Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().isActionCustomized(t.addinId,t.actionId)){var n=e.ShortcutsMappingTableManager.getActionName(t.addinId,t.actionId);r.push({addinId:t.addinId,actionId:t.actionId,actionName:n})}}))}return r},g.callActionHandlerAndLogUsage=function(e,t,n){e(t,n),setTimeout((function(){g.sendShortcutUsageTelemetry(t)}),0)},g.enableShortcutKey=function(e,t,n,r,o){return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().saveSetting(e,t,n,r,o)},g.sendQueuedActions=function(e){var t=g.getOrCreateAddinActionQueue(e);t&&(t.isControlReady=n,t.sendActions())},g.queueOrSendActionIfControlReady=function(e,t,n){var r=g.getOrCreateAddinActionQueue(e);r.isControlReady?r.isEmpty?n(e,t):(r.queueAction(t,n),r.sendActions()):r.queueAction(t,n)},g.getOrCreateAddinActionQueue=function(e){var t=g.s_actionQueues[e];return t||((t=new c).osfControlId=e,g.s_actionQueues[e]=t),t},g.sendShortcutUsageTelemetry=function(t){if(t){if(!g.s_usedShortcutAddins[t]){g.s_usedShortcutAddins[t]=n;var r=new u.AddinIdInfo(t);if(!r.getStoreTypeId()||!r.getSolutionId())return void s.RuntimeTelemetryHelper.LogCommonMessageTag(f,a,573125063);if("object"==typeof Otel&&typeof Otel.Telemetry===d&&typeof Otel.Telemetry.sendOtelEvent===d){var o={otelEvent:{eventName:"Office.Extensibility.Shortcuts.RuntimeInfo",dataFields:[{name:"shortcutBeingUsed",dataType:0,value:n},{name:"solutionId",dataType:1,value:r.getPrivacyCompliantSolutionId()},{name:"storeType",dataType:1,value:e.ManifestUtil.GetStoreTypeName(r.getStoreTypeId())}],telemetryProperties:e.TelemetryProperties}};Otel.Telemetry.sendOtelEvent(o)}else s.RuntimeTelemetryHelper.LogCommonMessageTag(l,a,573125062)}}else s.RuntimeTelemetryHelper.LogCommonMessageTag("AddinId is null",a,558724994)},g.sendShortcutConflictInfoTelemetry=function(r,o){var i,c=a,p=a;if(o>=0&&r.shortcutDisplayInfoArray.length>o&&r.shortcutDisplayInfoArray[o].ownerType==t.Addin){if(!r.shortcutDisplayInfoArray[o].addinId)return void s.RuntimeTelemetryHelper.LogCommonMessageTag("Couldn't get the addinid",a,558724993);var m=new u.AddinIdInfo(r.shortcutDisplayInfoArray[o].addinId);if(c=m.getPrivacyCompliantSolutionId(),p=e.ManifestUtil.GetStoreTypeName(m.getStoreTypeId()),!c||!p)return void s.RuntimeTelemetryHelper.LogCommonMessageTag(f,a,558724992)}"object"==typeof Otel&&typeof Otel.Telemetry===d&&typeof Otel.Telemetry.sendOtelEvent===d?i={otelEvent:{eventName:"Office.Extensibility.Shortcuts.ConflictInfo",dataFields:[{name:"FConflictWithExcel",dataType:0,value:r.shortcutDisplayInfoArray[0].ownerType==t.Host},{name:"ConflictVectorSize",dataType:2,value:r.shortcutDisplayInfoArray.length},{name:"KeyCode",dataType:2,value:r.keyCode},{name:"ModifierKeys",dataType:2,value:r.modifiers},{name:"SolutionId",dataType:1,value:c},{name:"StoreType",dataType:1,value:p}],telemetryProperties:e.TelemetryProperties}}:s.RuntimeTelemetryHelper.LogCommonMessageTag(l,a,573125061),o>=0?i&&(i.otelEvent.dataFields.push({name:"ExcelHostShortcutGotOverride",dataType:0,value:r.shortcutDisplayInfoArray[0].ownerType==t.Host&&r.shortcutDisplayInfoArray[o].ownerType!=t.Host}),Otel.Telemetry.sendOtelEvent(i)):i&&(i.otelEvent.dataFields.push({name:"UserCanceledConflictUI",dataType:0,value:n}),Otel.Telemetry.sendOtelEvent(i))},g.checkShortcutsInUse=function(r,o){var s="shortcuts";if(r==a)throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(s);if(o==a)throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException("isShortcutKeyUsedByHost");if(!g.isAddinShortcutsPreferenceSettingHelperSupported())throw OfficeExtension.WacRuntime.Utility.createInvalidOperationException();return Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getSetting().then((function(c){var u=a;c&&(u=JSON.parse(c));for(var l=[],d=0;d<r.length;++d){var f=e.ShortcutsMappingTableManager.convertStringToKeys(r[d]);if(f==a)throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(s);if(u&&u[f.virtualKey.toString()]){var p=u[f.virtualKey.toString()][f.modifierKeys.toString()];if(p&&(p[m]==t.Addin||p[m]==t.Host)){l.push(n);continue}}if(o(f.modifierKeys,f.virtualKey))l.push(n);else{var h=g.getShortcutInfoArrayFromShortcutKey(f.modifierKeys,f.virtualKey);Array.isArray(h)&&h.length>0?l.push(n):l.push(i)}}return l}))},g.getShortcuts=function(n){if(n==a||0===n.length)throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(p);if(!g.isAddinShortcutsPreferenceSettingHelperSupported())throw OfficeExtension.WacRuntime.Utility.createInvalidOperationException();return new Promise((function(r){var o=Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getShortcutsPreferenceMappingTable(),i={},s=function(r){var s=function(s){var c=o!=a&&o[r]!=a?o[r][s]:a;if(c&&c.ownerType==t.Addin&&c.addinId==n){var u=e.ShortcutsMappingTableManager.getShortcutText(parseInt(s),parseInt(r),e.ExtendedManifestUtility.getPlatformName());i[c.action]=u}else{var l=Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getShortcutInfoArray(s,r);Array.isArray(l)&&l.length>0&&l.forEach((function(t){if(t.addinId==n){var o=e.ShortcutsMappingTableManager.getShortcutText(parseInt(s),parseInt(r),e.ExtendedManifestUtility.getPlatformName());i[t.action]=o}}))}};for(var c in o[r])s(c)};for(var c in o)s(c);var u=e.ShortcutsMappingTableManager.getShortcutsMappingTable(),l=function(r){var s=function(s){var c=u[r][s];Array.isArray(c)&&c.length>0&&c.forEach((function(c){if(c.addinId==n&&!Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().isActionCustomized(c.addinId,c.actionId)){var u=o!=a&&o[r]!=a?o[r][s]:a,l=a;(!u||u.ownerType==t.Addin&&u.addinId==c.addinId&&u.action==c.actionId)&&(l=e.ShortcutsMappingTableManager.getShortcutText(c.modifierKeys,c.virtualKey,e.ExtendedManifestUtility.getPlatformName())),i[c.actionId]=l}}))};for(var c in u[r])s(c)};for(var c in u)l(c);r(i)}))},g.replaceShortcuts=function(n,i){return r(this,void 0,void 0,(function(){var r,s,c,u,l,d,f,m,h,v,y,b;return o(this,(function(o){switch(o.label){case 0:if(n==a||0===n.length)throw OfficeExtension.WacRuntime.Utility.createInvalidArgumentException(p);if(!g.isAddinShortcutsPreferenceSettingHelperSupported())throw OfficeExtension.WacRuntime.Utility.createInvalidOperationException();return[4,g.getShortcuts(n)];case 1:for(c in r=o.sent(),s=[],i)s.push(c);u=0,o.label=2;case 2:if(!(u<s.length))return[3,7];if(l=s[u],r[l]==a)throw OfficeExtension.WacRuntime.Utility.createInvalidOperationException();if(d=r[l],(f=e.ShortcutsMappingTableManager.convertStringToKeys(d))==a)throw OfficeExtension.WacRuntime.Utility.createInvalidOperationException;return(m=i[l])!=a?[3,4]:[4,Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().removeActionFromShortcutInfoArray(n,l)];case 3:return o.sent(),[3,6];case 4:if((h=e.ShortcutsMappingTableManager.convertStringToKeys(m))==a)throw OfficeExtension.WacRuntime.Utility.createInvalidOperationException;return f.modifierKeys==h.modifierKeys&&f.virtualKey==h.virtualKey?[3,6]:(Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().isActionCustomized(n,l)&&Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().removeActionFromShortcutInfoArray(n,l),v={ownerType:t.Addin,addinId:n,action:l},y=[v],b=Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().getShortcutInfoArray(h.modifierKeys,h.virtualKey),Array.isArray(b)&&b.length>0&&y.concat(b),[4,Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().setShortcutInfoArray(h.modifierKeys,h.virtualKey,y)]);case 5:o.sent(),o.label=6;case 6:return u++,[3,2];case 7:return[2]}}))}))},g.s_usedShortcutAddins={},g.s_actionQueues={},g.s_isCustomShortcutsEnabled=i,g}();e.ShortcutKeyDispatchManager=l}(f||(f={}));var l='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';u.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160",visio:"ZVO161",visiowebapp:"WAV161"},u.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4},u.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};var d,f;u.HostSpecificFileVersionDefault="16.00",u.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{android:"16.00",web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.02"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},visio:{web:"16.00",win32:"16.00"}},u.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote",Visio:"Visio"},u.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook",Mailbox:"Mailbox",Drawing:"Drawing"},u.HostPlatform={Web:"Web"},u.getAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case u.AppName.ExcelWebApp:t="excel.exe";break;case u.AppName.AccessWebApp:t="ZAC";break;case u.AppName.PowerpointWebApp:t="WAP";break;case u.AppName.WordWebApp:t="WAW";break;case u.AppName.OneNoteWebApp:t="WAO";break;case u.AppName.VisioWebApp:t="WAV";break;default:throw c.msAjaxDebug.trace(n),n}return t},u.getModernAppVerCode=function(e){var t,n="Invalid appName.";switch(e){case u.AppName.ExcelWebApp:t="WAC_Excel";break;case u.AppName.PowerpointWebApp:t="WAC_PowerPoint";break;case u.AppName.WordWebApp:t="WAC_Word";break;case u.AppName.OneNoteWebApp:t="WAC_OneNote";break;case u.AppName.OutlookWebApp:t="WAC_Outlook";break;case u.AppName.VisioWebApp:t="WAC_Visio";break;default:throw c.msAjaxDebug.trace(n),n}return t},u.getManifestHostType=function(e){var t;switch(e){case u.HostType.Excel:t=u.ManifestHostType.Workbook;break;case u.HostType.Word:t=u.ManifestHostType.Document;break;case u.HostType.PowerPoint:t=u.ManifestHostType.Presentation;break;case u.HostType.OneNote:t=u.ManifestHostType.Notebook;break;case u.HostType.Outlook:t=u.ManifestHostType.Mailbox;break;case u.HostType.Visio:t=u.ManifestHostType.Drawing;break;default:throw c.msAjaxDebug.trace("Invalid host type."),"Invalid hostType."}return t},u.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook",Drawing:"Drawing"},u.HostCapability={Excel:u.Capability.Workbook,Outlook:u.Capability.Mailbox,Access:u.Capability.Database,PowerPoint:u.Capability.Presentation,Word:u.Capability.Document,Sway:u.Capability.Sway,OneNote:u.Capability.Notebook,Visio:u.Capability.Drawing},u.OsfControlTarget={Undefined:-1,InContent:0,TaskPane:1,Contextual:2},u.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131,ReadWriteDocument:135},u.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8},u.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6},u.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",Exchange:"exchange",FileSystem:"filesystem",Registry:"registry",InMemory:"inmemory",OneDrive:"onedrive",PrivateCatalog:"excatalog",HardCodedPreinstall:"hardcodedpreinstall",FirstParty:"firstparty",UploadFileDevCatalog:"uploadfiledevcatalog",Sdx:"sdxcatalog",WopiCatalog:"wopicatalog"},u.StoreTypeEnum={MarketPlace:0,Catalog:1,SPApp:2,Exchange:3,FileSystem:4,Registry:5,OneDrive:9,PrivateCatalog:10,HardCodedPreinstall:11,FirstParty:12,Sdx:14,UploadFileDevCatalog:15,WopiCatalog:16},u.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"},u.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15,UserIsMinor:16},u.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4},u.OmexTrialType={None:0,Office:1,External:2},u.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"},u.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3},u.OmexRemoveAppStatus={Failed:0,Success:1},u.OfficeAppType={ContentApp:u.OsfControlTarget.InContent,TaskPaneApp:u.OsfControlTarget.TaskPane,MailApp:u.OsfControlTarget.Contextual},u.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"},u.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"},u.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"},u.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"},u.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1},u.UpnCheckCode={NotSet:0,Match:1,NotMatch:2},u.HostFrameTrustState={NotInitialized:0,NotImplemented:1,NotReady:2,Exempted:3,NotTrusted:4,Trusted:5},u.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2},u.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942},u.BWsaStreamTypes={Static:1},u.BWsaConfig={defaultMaxStreamRows:1e3},u.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR:-2147209295,E_PRIVACY_SERVICE_DISABLED_ADMIN:2147758792,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055,WAC_FirstPartyAddInListRequestFailure:1056,WAC_SDX_DMSRequestFailed:1058,WAC_SDX_AssetIdNotInDMSResponse:1059,WAC_CustomFunctionsRegistrationError:1060,WAC_WopiHostCheckStatusNotTrusted:1061,WAC_WopiHostCheckStatusNotReady:1062,WAC_AgaveIRMBlockError:1063},u.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10},u.OmexClientNames=function(){var e={},t=u.AppName;return e[t.ExcelWebApp]="WAC_Excel",e[t.WordWebApp]="WAC_Word",e[t.OutlookWebApp]="WAC_Outlook",e[t.AccessWebApp]="WAC_Access",e[t.PowerpointWebApp]="WAC_Powerpoint",e[t.OneNoteWebApp]="WAC_OneNote",e[t.VisioWebApp]="WAC_Visio",e}(),u.OmexAppVersions=function(){var e={},t=u.AppName;return e[t.ExcelWebApp]=u.AppVersion.excelwebapp,e[t.WordWebApp]=u.AppVersion.wordwebapp,e[t.OutlookWebApp]=u.AppVersion.outlookwebapp,e[t.AccessWebApp]=u.AppVersion.access,e[t.PowerpointWebApp]=u.AppVersion.powerpointwebapp,e[t.OneNoteWebApp]=u.AppVersion.onenotewebapp,e[t.VisioWebApp]=u.AppVersion.visiowebapp,e}(),u.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3},u.ManifestRequestTypes={Manifest:1,Etoken:2,Both:3},u.HostInfoFlags={None:0,SharedApp:1,CustomFunction:2,ProtectedDocDisable:4,ExperimentJsEnabled:8,PublicAddin:16},u.MaxAppContextLength=10240,u.HostFeatureGateFlags={None:0,Enable3rdPartySetAppContextInIFrameName:2},u.SdxAssetIds={Ideas:"fa000000029",ExperimentationSdx:"fa000000059"},u.ExtendedManifestSupportTokens={Requirements:"RequirementsToken",Locale:"LocaleToken",TokenReplaceRegex:"\\$\\{token\\.(\\w+)\\}",ResourceTokenRegEx:"^\\$\\{resource\\.([A-Za-z0-9_-]+)\\}$",ExtendedManifestLoggingPrefix:"Extended Manifest",ExtendedManifestResourcesLoggingPrefix:"Extended Manifest Resources",ActionIdMaxLength:32,ActionNameMaxLength:125},function(e){var t=null,n=function(){function n(){}return n.versionLessThan=function(e,t){return u.OsfManifestManager.versionLessThan(e,t)},n.ParseManifest=function(e,n,r){try{return new u.Manifest.Manifest(e,n)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest:",e,r,20306078),t}},n.constructAddInId=function(t,n,r,o){return e.MsAjaxString.format("{0}|{1}|{2}|{3}|{4}|||","2",t,n,this.GetStoreTypeId(r).toString(),o)},n.GetStoreTypeId=function(e){return e==u.StoreType.OMEX?u.StoreTypeEnum.MarketPlace:e==u.StoreType.SPCatalog?u.StoreTypeEnum.Catalog:e==u.StoreType.SPApp?u.StoreTypeEnum.SPApp:e==u.StoreType.Exchange?u.StoreTypeEnum.Exchange:e==u.StoreType.FileSystem?u.StoreTypeEnum.FileSystem:e==u.StoreType.Registry?u.StoreTypeEnum.Registry:e==u.StoreType.OneDrive?u.StoreTypeEnum.OneDrive:e==u.StoreType.PrivateCatalog?u.StoreTypeEnum.PrivateCatalog:e==u.StoreType.HardCodedPreinstall?u.StoreTypeEnum.HardCodedPreinstall:e==u.StoreType.FirstParty?u.StoreTypeEnum.FirstParty:e==u.StoreType.UploadFileDevCatalog?u.StoreTypeEnum.UploadFileDevCatalog:e==u.StoreType.WopiCatalog?u.StoreTypeEnum.WopiCatalog:-1},n.GetStoreTypeName=function(e){var n=parseInt(e);return n==u.StoreTypeEnum.MarketPlace?u.StoreType.OMEX:n==u.StoreTypeEnum.Catalog?u.StoreType.SPCatalog:n==u.StoreTypeEnum.SPApp?u.StoreType.SPApp:n==u.StoreTypeEnum.Exchange?u.StoreType.Exchange:n==u.StoreTypeEnum.FileSystem?u.StoreType.FileSystem:n==u.StoreTypeEnum.Registry?u.StoreType.Registry:n==u.StoreTypeEnum.OneDrive?u.StoreType.OneDrive:n==u.StoreTypeEnum.PrivateCatalog?u.StoreType.PrivateCatalog:n==u.StoreTypeEnum.HardCodedPreinstall?u.StoreType.HardCodedPreinstall:n==u.StoreTypeEnum.FirstParty?u.StoreType.FirstParty:n==u.StoreTypeEnum.UploadFileDevCatalog?u.StoreType.UploadFileDevCatalog:n==u.StoreTypeEnum.WopiCatalog?u.StoreType.WopiCatalog:t},n}();e.ManifestUtil=n;var r=function(){function n(){}return n.failed=function(n,r,o){if(n.status!=e.DataServiceResultCode.Succeeded){var i={status:n.status,httpStatus:n.httpStatus};return o!=t&&(i.value=o),r(i),!0}return!1},n.retry=function(e,t){void 0===t&&(t={});var n=t.retries,r=void 0===n?3:n,o=t.factor,i=void 0===o?2:o,a=t.minTimeout,s=void 0===a?300:a,c=t.maxTimeout,u=void 0===c?1/0:c;return new Promise((function(t,n){var o=function(a){e().then(t,(function(e){a>=r?n(e):setTimeout((function(){return o(a+1)}),Math.min(s*Math.pow(i,a),u))}))};o(0)}))},n.limitRate=function(e,t){var n=[],r=-1/0,o=function(){var i=n.shift();n.length>0&&setTimeout(o,t),r=performance.now(),e.apply(void 0,i)};return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];0===n.length&&setTimeout(o,Math.max(0,t-(performance.now()-r))),n.push(e)}},n.withCache=function(e,r,o){var i="localStorage",a="__OSF_AsyncCache_",c=r.forceUpdateCache,l=void 0!==c&&c,d=r.maxAgeInSecs,f=void 0===d?259200:d,p=r.useStaleCache,m=void 0!==p&&p;if(!l&&n.Cache.hasOwnProperty(e))return Promise.resolve({cacheType:"memory",value:n.Cache[e]});var h=a+e,g=a+e+"_stale",v="__OSF_AsyncCacheExpiry",y=Date.now();if(u.OUtil.getLocalStorage().isLocalStorageAvailable())try{if(y>=n.NextCheckExpiry){var b=JSON.parse(localStorage.getItem(v))||{},O=!1;for(var S in n.NextCheckExpiry=1/0,b)y>b[S]?(localStorage.removeItem(a+S),delete b[S],O=!0):n.NextCheckExpiry=Math.min(n.NextCheckExpiry,b[S]);O&&localStorage.setItem(v,JSON.stringify(b))}if(!l&&localStorage.hasOwnProperty(h))return Promise.resolve({cacheType:i,value:localStorage.getItem(h)})}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("failed to get key "+h,e,t,544617492)}return o().then((function(t){n.Cache[e]=t;try{var r=JSON.parse(localStorage.getItem(v))||{};r[e]=y+1e3*f,n.NextCheckExpiry=Math.min(n.NextCheckExpiry,r[e]),localStorage.setItem(v,JSON.stringify(r)),localStorage.setItem(h,t),localStorage.setItem(g,t)}catch(e){}return{cacheType:"none",value:t}}),(function(e){if(m&&u.OUtil.getLocalStorage().isLocalStorageAvailable()&&localStorage.hasOwnProperty(g))return s.RuntimeTelemetryHelper.LogCommonMessageTag("stale cache used for "+g,t,556066976),Promise.resolve({cacheType:i,value:localStorage.getItem(g)});throw e}))},n.fetch=function(e,n){return void 0===n&&(n={}),new Promise((function(r,o){var i=new XMLHttpRequest,a=n.method,s=void 0===a?"GET":a,c=n.headers,u=void 0===c?{}:c,l=n.body,d=void 0===l?t:l;for(var f in i.onreadystatechange=function(){4==i.readyState&&r({ok:i.status>=200&&i.status<=299,status:i.status,statusText:i.statusText,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(JSON.parse(i.responseText))}})},i.onerror=o,i.open(s,e,!0),u)i.setRequestHeader(f,u[f]);i.send(d)}))},n.Cache={},n.NextCheckExpiry=0,n}();e.AsyncUtil=r;var o=function(){function e(){}return e.register=function(e,t){this._registry[e]=t},e.resolve=function(e,n){var r=this,o=r._resolved[e];if(o!=t)return o;if((n=n||r._hostInfo)!=t){var i=r._registry[e];if(i==t)return t;r._resolved[e]=o=i(n)}return o},e.setHostContext=function(e){this._hostInfo=e},e.getHostContext=function(){return this._hostInfo},e._registry={},e._resolved={},e}();e.CatalogFactory=o}(f||(f={})),function(e){var t=function(){function t(e){this._initParams=e}return t.prototype.getEntitlementAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAndCacheManifest=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed,httpStatus:404})},t.prototype.activateAsync=function(t,n){var r=this;r._initParams&&r._initParams.loaderParams?r._initParams.controlStatus===u.OsfControlStatus.ActivationFailed?n.fail(r._initParams.loaderParams,r._initParams.controlStatus):n.notifyUser(r._initParams.loaderParams):n.fail(e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveActivationError_ERR,errorCode:u.ErrorStatusCodes.WAC_AgaveActivationError}),u.OsfControlStatus.ActivationFailed)},t.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed,httpStatus:403})},t.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed,httpStatus:403})},t}();e.ForbiddenCatalog=t}(f||(f={})),function(e){var t=function(){var e=null;function t(){}return t.defaultTitle=function(e){switch(e){case u.InfoType.Information:return Strings.OsfRuntime.L_AgaveInformationTitle_TXT;case u.InfoType.Error:return Strings.OsfRuntime.L_AgaveErrorTile_TXT;case u.InfoType.Warning:return Strings.OsfRuntime.L_AgaveWarningTitle_TXT}return Strings.OsfRuntime.L_AgaveInformationTitle_TXT},t.fillMissing=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?u.InfoType.Information:n.infoType,n.title=n.title||t.defaultTitle(n.infoType),n.buttonTxt=n.buttonTxt||Strings.OsfRuntime.L_OkButton_TXT,n.buttonCallback=n.buttonCallback||e,n.url=n.url||e,n.urlButtonTxt=n.urlButtonTxt||e,n.dismissCallback=n.dismissCallback||e,n.reDisplay=!n.dismissCallback,n.displayDeactive=n.displayDeactive==e||n.displayDeactive,n.detailView=n.detailView||!1,n.logAsError=n.logAsError||!1,n.highPriority=n.highPriority||!1,n.retryAll=n.retryAll||!1,n.errorCode=n.errorCode?n.errorCode:0,n},t.error=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?u.InfoType.Error:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.warning=function(n){return n.infoType=t.isNullOrUndefined(n.infoType)?u.InfoType.Warning:n.infoType,n.logAsError=n.logAsError==e||n.logAsError,t.fillMissing(n)},t.showNotification=function(e,n){e.notifyUser(t.fillMissing(n))},t.showError=function(e,n){e.notifyUser(t.error(n))},t.showWarning=function(e,n){e.notifyUser(t.warning(n))},t.failWithWarning=function(e,n,r){r=t.isNullOrUndefined(r)?u.OsfControlStatus.ActivationFailed:r,e.fail(t.warning(n),r)},t.failWithError=function(e,n,r){r=t.isNullOrUndefined(r)?u.OsfControlStatus.ActivationFailed:r,e.fail(t.error(n),r)},t.isNullOrUndefined=function(t){return t===e||void 0===t},t}();e.LoaderUtil=t}(f||(f={})),function(e){var t=function(){function t(e,t){this.osfControl=e,this.trusted=t}return t.prototype.getRequirementsChecker=function(){return this.osfControl._contextActivationMgr.getRequirementsChecker()},t.prototype.load=function(t,n){var r=null,o=this,i=o,a=performance.now();o.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted&&(o.osfControl._retryActivate=r,o.osfControl._contextActivationMgr.retryAll(t.entitlement.assetId)),o.osfControl._status!==u.OsfControlStatus.NotActivated&&o.osfControl.deActivate();var s=t.manifest,c=o.osfControl;if(c._etoken=t.eToken,c._manifest=s,c._sourceLocationOverrideUrl?c._iframeUrl=c._sourceLocationOverrideUrl:c._sourceLocationOverrideResourceId?c._iframeUrl=s.getSourceLocationOverrideByResourceId(c._sourceLocationOverrideResourceId):c._iframeUrl=s.getDefaultSourceLocation(c._contextActivationMgr.getFormFactor()),c._iframeUrl&&c.updateUrlsForSdx(t.manifestUrl),u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)&&t.entitlement!=r&&t.entitlement.storeType===u.StoreType.PrivateCatalog){var l=t.entitlement.addInStoreInfo;l&&(c._assetId=l.AssetId,c._assetStoreId=l.ContentMarket)}if(c._permission=s.getPermission(),c._appDomains=s.getAppDomains(),c.processManifestForCustomFunctions(s),s.getExtendedOverrides()){var d=o.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted;c.processManifestForExtendedOverrides(s,d)}if(n!=r&&(c._iframeUrl=n.decorateUrl(c._iframeUrl)),c.hostInfoFlags()&u.HostInfoFlags.ProtectedDocDisable&&!c.isFirstParty())e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AgaveProtectedDocError_ERR,detailView:!0,errorCode:u.ErrorStatusCodes.WAC_AgaveIRMBlockError});else if(c._contextActivationMgr._doesUrlHaveSupportedProtocol(c._iframeUrl)){n!=r&&n.preLoad(c,c._contextActivationMgr);var f=s.getDefaultDisplayName();c._isAddinCommands((function(e){e?(c._isvirtualOsfControl=!0,c.invokeVirtualOsfControlActivationCallback(s)):(i.osfControl._sdxTelemetryContext.iframeCreateStart=performance.now(),c._createIframeAndActivateOsfControl(f),i.osfControl._sdxTelemetryContext.iframeCreateEnd=performance.now())})),t.entitlement!=r&&t.entitlement.storeType===u.StoreType.Sdx&&e.SDXCatalog.recordActivity("IframeCreate",a,!0,[{name:"OsfControlId",string:c._id},{name:"AssetId",string:t.entitlement.assetId}]),n!=r&&n.postLoad(c,c._contextActivationMgr)}else e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AgaveManifestError_ERR,detailView:!0,errorCode:u.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT})},t.prototype.skipTrust=function(){var e=this;return e.osfControl._contextActivationMgr._autoTrusted||e.osfControl.getTrustNoPrompt()||e.osfControl._isOsfControlInEmbeddingMode(e.osfControl)},t.prototype.hasConsent=function(){return this.trusted||this.isInsertion()},t.prototype.isInsertion=function(){return this.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted},t.prototype.setRetryCall=function(e){this.osfControl._retryActivate=e},t.prototype.askForTrust=function(e,t){var n=this;this.osfControl._showTrustError(e.clientName,e.displayName,e.providerName,e.iconUrl,e.entitlement.storeType,(function(){n.restartActivation(),t()}),e.url,e.isSSOAddin)},t.prototype.askForUpgrade=function(e,t){var n=this;e.buttonCallback=function(){n.restartActivation(),t()},this.notifyUser(e)},t.prototype.fail=function(e,t){var n=this.osfControl;n._status=t,this.notifyUser(e),n._contextActivationMgr.raiseOsfControlStatusChange(n)},t.prototype.notifyUser=function(e){var t=this.osfControl;e.id=t._id,t._contextActivationMgr.displayNotification(e)},t.prototype.restartActivation=function(){this.osfControl._restartActivate()},t.prototype.isForCustomFunctionSandbox=function(){return this.osfControl.isCustomFunctionSandbox()},t.prototype.setIsUpgrading=function(e){this.osfControl.setIsUpgrading(e)},t.prototype.getIsUpgrading=function(){return this.osfControl.getIsUpgrading()},t.prototype.setUpgradingFailed=function(e){this.osfControl.setUpgradingFailed(e)},t}();e.OsfControlLoader=t}(f||(f={})),function(e){var t=function(){function e(e){this._requirementsChecker=e}return e.prototype.getRequirementsChecker=function(){return this._requirementsChecker},e.prototype.load=function(){},e.prototype.skipTrust=function(){return!1},e.prototype.hasConsent=function(){return!1},e.prototype.setRetryCall=function(){},e.prototype.askForTrust=function(){},e.prototype.askForUpgrade=function(){},e.prototype.fail=function(){},e.prototype.notifyUser=function(){},e.prototype.restartActivation=function(){},e.prototype.isForCustomFunctionSandbox=function(){return!1},e.prototype.setIsUpgrading=function(){},e.prototype.getIsUpgrading=function(){return!1},e.prototype.setUpgradingFailed=function(){},e}();e.PreCacher=t}(f||(f={})),function(e){var t=function(){var t=null;function n(){var e=this;e.isReady=!1,e.clientEndPoint=t,e.pendingCallbacks=[],e.iframe=t,e._pendingRequests={},e.conversationId=u.OUtil.generateConversationId()}return n.prototype.invokeProxyCommandAsync=function(n,r,o){var i=this,a=r||r.correlationId||"";this.prepareProxy((function(c){c.value!=t?i.invokeProxyMethodAsync(n,o,r):(s.RuntimeTelemetryHelper.LogExceptionTag("clientendpoint is invalid",t,a,18940552),o({status:e.DataServiceResultCode.ProxyNotReady}))}),(function(){s.RuntimeTelemetryHelper.LogExceptionTag("proxysetup failure",t,a,18940553),o({status:e.DataServiceResultCode.ProxyNotReady})}))},n.prototype.prepareProxy=function(){},n.prototype.doesUrlHaveSupportedProtocol=function(e){var n=!1;e&&(n=decodeURIComponent(e).match(/^https?:\/\/.+$/gi)!=t);return n},n.prototype.invokeProxyMethodAsync=function(n,r,o){var i,a=o||o.correlationId||"",c=[this.clientEndPoint._targetUrl,n];for(var l in o)("string"===(i=typeof o[l])||"number"===i||"boolean"===i)&&c.push(o[l]);var d=c.join("."),f=this._pendingRequests,p={onCompleted:r,methodName:n,correlationId:a},m=f[d];if(m)m.push(p);else{f[d]=[p];o||(o={}),o.officeVersion=u.Constants.ThreePartsFileVersion,this.clientEndPoint.invoke(n,(function(n,r){var o=t,i=0,a=e.DataServiceResultCode.Failed;0===n&&r.status&&(o=r.result,a=e.DataServiceResultCode.Succeeded);var c=f[d];delete f[d];for(var u=c.length,l=0;l<u;l++){var p=c.shift();try{r&&r.failureInfo&&(i=r.failureInfo.statusCode||t,r.failureInfo.result=r.result,s.RuntimeTelemetryHelper.LogProxyFailure(p.correlationId,p.methodName,r.failureInfo)),p.onCompleted({status:a,httpStatus:i,value:o})}catch(t){var m="invokeProxyMethodAsync failed";e.WACUtils.logExceptionToBrowserConsole(m,t),s.RuntimeTelemetryHelper.LogExceptionTag(m,t,p.correlationId,19015124)}}}),o)}},n}();e.ProxyBase=t}(f||(f={})),function(e){var t,n;!function(e){var t="ManifestRequest",n="KilledAppsCheck",r="AppStateCheck",o="EntitlementCheck",i="Authentication",a="ServerCall",s="Activation";e[e[s]=0]=s,e[e[a]=1]=a,e[e[i]=2]=i,e[e[o]=3]=o,e[e[r]=4]=r,e[e[n]=5]=n,e[e[t]=6]=t}(t=e.Activity||(e.Activity={})),function(e){var t="DmsRequestCachedFlag",n="ManifestRequestType",r="ActivationRuntimeType",o="AppStateDataInvalidFlag",i="AppStateDataCachedFlag",a="ManifestDataInvalidFlag",s="OmexHasEntitlementFlag",c="ManifestDataCachedFlag",u="ManifestTrustCachedFlag",l="RetryCount",d="AnonymousFlag";e[e[d]=0]=d,e[e[l]=1]=l,e[e[u]=2]=u,e[e[c]=3]=c,e[e[s]=4]=s,e[e[a]=5]=a,e[e[i]=6]=i,e[e[o]=7]=o,e[e[r]=8]=r,e[e[n]=9]=n,e[e[t]=10]=t}(n=e.FlagName||(e.FlagName={}));var r=function(){function r(e,t,n,r,o){var i=this;i.correlationId=e,i.perfContext=t,i.appInfo=n,i.assetId=r,i.instanceId=o}return r.prototype.startActivity=function(o){var i=this;switch(o){case t.Activation:var a=u.ActivationTypes.V2Enabled;return 0==(15&i.appInfo)&&e.S2SOmexCatalogService._requestHandler&&(a=u.ActivationTypes.V2S2SEnabled),s.AppLoadTimeHelper.ActivationStart(i.perfContext,i.appInfo,i.assetId,i.correlationId,i.instanceId,a),void i.setBits(n.ActivationRuntimeType,a)}s.AppLoadTimeHelper.StartStopwatch(i.perfContext,r.StopWatchName[o])},r.prototype.stopActivity=function(e){s.AppLoadTimeHelper.StopStopwatch(this.perfContext,r.StopWatchName[e])},r.prototype.setFlag=function(e,t){var n=t?2:1;this.setBits(e,n)},r.prototype.setBits=function(e,t){s.AppLoadTimeHelper.SetBit(this.perfContext,t,r.FlagOffsetMap[e],2)},r.FlagOffsetMap=[0,2,5,7,9,11,13,15,17,19,21],r.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"],r}();e.ActivationTelemetryContext=r;var o=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.AddinCommandsTelemetryContext=o;var i=function(){function e(e){this.correlationId=e}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.InsertDialogTelemetryContext=i;var a=function(){function e(){}return e.prototype.startActivity=function(){},e.prototype.stopActivity=function(){},e.prototype.setFlag=function(){},e.prototype.setBits=function(){},e}();e.SimpleTelemetryContext=a}(f||(f={})),function(e){var t=null,n=function(){var n=".";function r(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer)}return r.prototype.getEntitlementAsync=function(n,r,o){var i=this,a=i,s=[],c=[],l=n?i.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey():i.getUploadFileDevCatalogAddinsCacheKey(),d=i._cacheManager.GetCacheItem(l);d!=t&&(d.forEach((function(n){var r=a._cacheManager.GetCacheItem(a.getUploadFileDevCatalogManifestCacheKey(n));if(r!=t){var o=e.ManifestUtil.ParseManifest(r,a._initParam.appUILocale);if(o==t)return;var i={assetId:n,appVersion:o.getMarketplaceVersion(),storeId:"developer",storeType:u.StoreType.UploadFileDevCatalog,targetType:o.getTarget()};c.push(i),s.push(n)}})),s.length!=d.length&&(s.length>0?i._cacheManager.SetCacheItem(l,s):i._cacheManager.RemoveCacheItem(l))),o({status:e.DataServiceResultCode.Succeeded,value:c})},r.prototype.getAndCacheManifest=function(n,o,i,a){var s=this,c=u.OsfManifestManager.getCachedManifest(n.assetId,n.appVersion);if(c==t){var l=function(e,r,o){var i=s._cacheManager.GetCacheItem(s.getUploadFileDevCatalogManifestCacheKey(n.assetId));i==t&&e>=1?setTimeout((function(){return l(e-1,2*r,o)}),r):o(i)};l(r.GetManifestRetryLimit,r.GetManifestRetryWaitMs,(function(r){var o;r!=t&&(o=e.ManifestUtil.ParseManifest(r,s._initParam.appUILocale))!=t&&u.OsfManifestManager.cacheManifest(n.assetId,n.appVersion,o),a({status:o!=t?e.DataServiceResultCode.Succeeded:e.DataServiceResultCode.Failed,value:o})}))}else a({status:e.DataServiceResultCode.Succeeded,value:c})},r.prototype.activateAsync=function(n,r,o){var i=this;this.getAndCacheManifest(n,n.storeId,o,(function(a){if(a.status!=e.DataServiceResultCode.Succeeded)e.LoaderUtil.failWithError(r,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){r.restartActivation(),i.activateAsync(n,r,o)},errorCode:u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE});else{var s=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(s&&s.enableSingleSignOnForAddin&&!r.isForCustomFunctionSandbox())a.value;r.load({entitlement:n,eToken:"",manifest:a.value},t)}}))},r.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},r.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed})},r.prototype.validateAndCacheNewManifest=function(e,t,n,r){return!!this.validateAddinIdAndVersion(e,t)&&(this.cacheManifest(e,t,n,r),!0)},r.prototype.localCacheAddinCommands=function(e){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(),e)},r.prototype.validateAddinIdAndVersion=function(e,t){return r.idRegExp.test(e)&&r.versionRegExp.test(t)},r.prototype.cacheManifest=function(e,t,n,r){var o=this;u.OsfManifestManager.cacheManifest(e,t,r),o.cacheMyAddins(o.getUploadFileDevCatalogAddinsCacheKey(),e),o._cacheManager.SetCacheItem(o.getUploadFileDevCatalogManifestCacheKey(e),n)},r.prototype.cacheMyAddins=function(e,n){var r=this._cacheManager.GetCacheItem(e);r==t&&(r=[]),r.lastIndexOf(n)<0&&(r.push(n),this._cacheManager.SetCacheItem(e,r))},r.prototype.getUploadFileDevCatalogAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.myAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(){return r.UploadFileCatalogCacheKey.addinCommandsMyAddins+n+this._initParam.appName+n+this._initParam.userNameHashCode},r.prototype.getUploadFileDevCatalogManifestCacheKey=function(e){return r.UploadFileCatalogCacheKey.manifest+n+this._initParam.appName+n+e},r.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.",r.UploadFileCatalogCacheKey={myAddins:r.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:r.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:r.UploadFileCatalogCacheKeyPrefix+"Manifest"},r.idRegExp=new RegExp("[\\w-]+"),r.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}"),r.GetManifestRetryLimit=4,r.GetManifestRetryWaitMs=500,r}();e.CatalogFactory.register(u.StoreType.UploadFileDevCatalog,(function(r){return r.enableUploadFileDevCatalog?new n({appName:r.appName,appUILocale:r.appUILocale,userNameHashCode:r.userNameHashCode}):new e.ForbiddenCatalog(t)}));var r=function(){var t="Should never here";function n(e,t){this._catalog=e,this._storeType=t}return n.prototype.validateAndCacheNewManifest=function(){throw t},n.prototype.getEntitlementsAsync=function(t,n,r,o){this._catalog.getEntitlementAsync(n,new e.AddinCommandsTelemetryContext(u.OUtil.Guid.generateNewGuid()),(function(e){o(e.value)}),!1,r)},n.prototype.getManifestAsync=function(){throw t},n.prototype.localCacheAddinCommands=function(e,t,n,r){this._storeType==u.StoreType.UploadFileDevCatalog&&this._catalog.localCacheAddinCommands(t,n,r)},n}(),o=function(){function n(){}return n.createAddinDataProvider=function(n){var o=e.CatalogFactory.resolve(n);return o==t?t:new r(o,n)},n}();e.AddinDataProviderFactory=o}(f||(f={})),function(e){var t=null,n=function(){var n=!0,r=!1;function o(n,o){var i=this;void 0===o&&(o=t),i._omex=t,i._addinListReady=r,i._entitlements=[],i._appDetails={},i._getEntitlementCallback=t,i._approvedAddIns=t,i._hostInfo=n,i._appUILocale=n.appUILocale,i._cacheManager=o||new e.AppsDataCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer);try{i._approvedAddIns=JSON.parse(n.approvedAddinList)}catch(n){e.WACUtils.logExceptionToBrowserConsole("Fail to parse the JSON string of specified Approved Addins for Host",n),i._approvedAddIns=t}i.updateAddinList(n.wopiHostAddinList)}return o.prototype.getOmexCatalog=function(){var t=this;if(t._omex)return t._omex;var r,o=t._hostInfo.osfOmexBaseUrl.indexOf(u.Constants.ProtocolSeparator);r=o>=0?t._hostInfo.osfOmexBaseUrl.substr(o):u.Constants.ProtocolSeparator+t._hostInfo.osfOmexBaseUrl;var i=u.Constants.Https+r;return t._omex=new e.OmexCatalog({appName:t._hostInfo.appName,appUILocale:t._hostInfo.appUILocale,AppVersion:t._hostInfo.appVersion,clientMode:t._hostInfo.clientMode,docUrl:t._hostInfo.docUrl,omexBaseUrl:i,omexForceAnonymous:n}),t._omex},o.prototype.isAddinTrusted=function(e){return this._approvedAddIns&&e?-1==this._approvedAddIns.indexOf(e.toUpperCase())?r:n:r},o.prototype.updateAddinList=function(o){var i=this,a=i;i._entitlements=[];var s=t,c=r,l=r,d=r,f=r,p=r;try{s=JSON.parse(o)}catch(r){e.WACUtils.logExceptionToBrowserConsole("Fail to parse JSON string of Host Install Addins.",r),c=n,s=t}if(s)if(Array.isArray(s))for(var m=0,h=s;m<h.length;m++){var g=h[m];if(g.addinId){var v=void 0;if(g.type)try{v=u.OUtil.parseEnum(g.type,u.OfficeAppType)}catch(t){e.WACUtils.logExceptionToBrowserConsole("Incorrect targetType.",g.type),f=n;continue}else v=1;var y=u.OUtil.formatString(u.Constants.ConsentedCacheKey,g.addinId.toLowerCase(),u.StoreType.WopiCatalog,i._appUILocale),b=i.isAddinTrusted(g.addinId)||i._cacheManager.GetCacheItem(y,n)||r,O={assetId:g.addinId,storeType:u.StoreType.WopiCatalog,appVersion:"0.0.0.0",storeId:i._appUILocale,contentMarket:i._appUILocale,targetType:v,requireConsent:!b};i._entitlements.push(O)}else e.WACUtils.logExceptionToBrowserConsole("Required field missing: addinId.",g),d=n}else e.WACUtils.logExceptionToBrowserConsole("Received add-in list is not an array.",s),l=n;var S=i._entitlements.map((function(e){return e.assetId}));i.getOmexCatalog().getAppDetails(S,i._appUILocale,new e.SimpleTelemetryContext,(function(r){if(r.status!==e.DataServiceResultCode.Succeeded){var o=r.value.map((function(e){return e.assetId.toUpperCase()})),i=a._entitlements;a._entitlements=[];for(var s=0,u=i;s<u.length;s++){var m=u[s];-1==o.indexOf(m.assetId.toUpperCase())?(e.WACUtils.logExceptionToBrowserConsole("Can't find Office Add-in from Microsoft AppSource given addin ID.",m.assetId),p=n):a._entitlements.push(m)}}a._appDetails={};for(var h=0,g=r.value;h<g.length;h++)for(var v=g[h],y=0,b=a._entitlements;y<b.length;y++){m=b[y];if(v.assetId.toUpperCase()===m.assetId.toUpperCase()){v.storeType=m.storeType,a._appDetails[v.assetId.toUpperCase()]=v;break}}if(e.SDXCatalog.recordActivity("WopiCatalogUpdateAddinList",performance.now(),n,[{name:"JSONParseError",boolean:c},{name:"AddinListNotAnArray",boolean:l},{name:"RequiredFieldMissing",boolean:d},{name:"IncorrectTargetType:",boolean:f},{name:"AddinNoFound",boolean:p},{name:"AddinListNonEmpty",boolean:a._entitlements.length>0}]),a._addinListReady=n,a._getEntitlementCallback!=t){var O=a._getEntitlementCallback;a._getEntitlementCallback=t,O({status:e.DataServiceResultCode.Succeeded,value:a._entitlements})}}),r)},o.prototype.getEntitlementAsync=function(n,r,o){var i=this;if(i._addinListReady)o({status:e.DataServiceResultCode.Succeeded,value:i._entitlements});else if(r.startActivity(e.Activity.EntitlementCheck),i._getEntitlementCallback!=t){var a=i._getEntitlementCallback;i._getEntitlementCallback=function(t){r.stopActivity(e.Activity.EntitlementCheck),a(t),o(t)}}else i._getEntitlementCallback=function(t){r.stopActivity(e.Activity.EntitlementCheck),o(t)}},o.prototype.getAndCacheManifest=function(e,t,n,o,i){this.getOmexCatalog().getAndCacheManifest(e,t,n,o,i||r)},o.prototype.activateAsync=function(r,i,a){var s=this;a.startActivity(e.Activity.Activation);var c=this;this.isAddinEntitledAsync(r.assetId,(function(l){if(l.value){var d=u.OUtil.formatString(u.Constants.ConsentedCacheKey,r.assetId.toLowerCase(),r.storeType,r.storeId);s._cacheManager.SetCacheItem(d,n,o.ConsentedCacheRefreshRateInDays),c.getAndCacheManifest(r,s._appUILocale,a,(function(n){n.status===e.DataServiceResultCode.Succeeded?(a.stopActivity(e.Activity.Activation),i.load({entitlement:r,manifest:n.value,eToken:""},t)):(a.stopActivity(e.Activity.Activation),e.LoaderUtil.failWithError(i,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:u.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){i.restartActivation(),c.activateAsync(r,i,a)}}))}))}else a.stopActivity(e.Activity.Activation),e.LoaderUtil.showWarning(i,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){i.restartActivation(),c.activateAsync(r,i,a)},detailView:n,retryAll:n,errorCode:u.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}))},o.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},o.prototype.getAppDetails=function(t,n,o,i){var a=this;this.getEntitlementAsync(r,new e.SimpleTelemetryContext,(function(){for(var n=[],r=e.DataServiceResultCode.Succeeded,o=0,s=t;o<s.length;o++){var c=s[o].toUpperCase();a._appDetails[c]?n.push(a._appDetails[c]):r=e.DataServiceResultCode.Failed}i({status:r,value:n})}))},o.prototype.isAddinEntitledAsync=function(t,o){this.getEntitlementAsync(r,new e.SimpleTelemetryContext,(function(i){if(i.status===e.DataServiceResultCode.Succeeded)for(var a=t.toUpperCase(),s=0,c=i.value;s<c.length;s++){if(c[s].assetId.toUpperCase()===a)return void o({status:e.DataServiceResultCode.Succeeded,value:n})}o({status:e.DataServiceResultCode.Succeeded,value:r})}))},o.ConsentedCacheRefreshRateInDays=180,o}();e.WOPICatalog=n,e.CatalogFactory.register(u.StoreType.WopiCatalog,(function(r){var o="TRUSTCENTER_CATALOG_UNTRUSTED";if(r.allowExternalMarketplace&&r.osfOmexBaseUrl&&r.enableWopiCatalog)return e.WACUtils.logExceptionToBrowserConsole("Registered WOPICatalog",t),new n(r);e.WACUtils.logExceptionToBrowserConsole("Cannot register WOPICatalog allowExternalMarketplace is: ",r.allowExternalMarketplace),e.WACUtils.logExceptionToBrowserConsole("Cannot register WOPICatalog osfOmexBaseUrl is: ",r.osfOmexBaseUrl),e.WACUtils.logExceptionToBrowserConsole("Cannot register WOPICatalog enableWopiCatalog is: ",r.enableWopiCatalog);var i=!("undefined"==typeof Strings||Strings===t);return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({title:i?Strings.OsfRuntime.L_AgaveErrorTile_TXT:o,buttonTxt:i?Strings.OsfRuntime.L_OkButton_TXT:"OK",description:i?Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR:o,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:u.OsfControlStatus.ActivationFailed})}))}(f||(f={})),function(e){!function(e){var t="Unauthenticated",n="UnknownUserType",r="PrxoyUrlEmpty",o="ProxyNotReady",i="Succeeded";e[e[i]=1]=i,e[e.Failed=0]="Failed",e[e[o]=-1]=o,e[e[r]=-2]=r,e[e[n]=2]=n,e[e[t]=3]=t}(e.DataServiceResultCode||(e.DataServiceResultCode={}))}(f||(f={})),function(e){var t=function(){var t=null;function n(n,r){void 0===r&&(r=t),this._initParam=n,this._cacheManager=r||new e.AppsDataCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer)}return n.LogFirstPartyCatalogMonitoringError=function(e,n){s.RuntimeTelemetryHelper.LogExceptionTag("First Party Catalog Error AssetId: "+n+" Message: "+e,t,t,39068e3)},n.prototype.getEntitlementAsync=function(){throw new Error("in firstParty get Entitlementasync")},n.prototype.getAndCacheManifest=function(){throw new Error("in firstParty getAndCacheManifest")},n.prototype.removeAsync=function(){throw new Error("in firstParty removeAsync")},n.prototype.getAppDetails=function(){throw new Error("in firstParty getappDetails")},n.prototype.TryFallBackFirstPartyAddInList=function(r,o,i){var a=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!1);a?(n.LogFirstPartyCatalogMonitoringError("Falling back to stale 1st party add-ins list.",o),i({status:e.DataServiceResultCode.Succeeded,value:a})):i({status:e.DataServiceResultCode.Failed,value:t})},n.prototype.GetFirstyPartyAddInsInfo=function(n,r,o,i){var a=this,c=this._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1);if(c){var u={addInList:c,refreshRate:t};i({status:e.DataServiceResultCode.Succeeded,value:u})}else n.getFirstPartyAddInList((function(n){if(n.status==e.DataServiceResultCode.Succeeded){var c=t;try{c=e.OmexXmlProcessor.ProcessFirstPartyAddInList(n.value)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Problem parsing first party list.",e,r.correlationId,34366472),void a.TryFallBackFirstPartyAddInList(r,o,i)}a._cacheManager.SetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,c.addInList,c.refreshRate/e.CacheConsts.hourToDayConversionFactor),i({status:e.DataServiceResultCode.Succeeded,value:c})}else a.TryFallBackFirstPartyAddInList(r,o,i)}))},n.prototype.TryFallBackFirstPartyManifest=function(r,o,i){var a=this.ReadFirstPartyManifestFromLocalStorage(o,r);a?(n.LogFirstPartyCatalogMonitoringError("Falling back to stale manifest.",r),i({status:e.DataServiceResultCode.Succeeded,value:a})):i({status:e.DataServiceResultCode.Failed,value:t})},n.prototype.ReadFirstPartyManifestFromLocalStorage=function(n,r){var o=u.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r),i=this._cacheManager.GetCacheItem(o,!1);return i?e.ManifestUtil.ParseManifest(i,this._initParam.appUILocale,n.correlationId):t},n.prototype.GetCachedManifest=function(e,t){var n=u.OsfManifestManager.getCachedManifest(t,"");return n||(n=this.ReadFirstPartyManifestFromLocalStorage(e,t))&&u.OsfManifestManager.cacheManifest(t,"",n),n},n.prototype.GetFirstPartyManifest=function(t,n,r,o){var i=this,a=this.GetCachedManifest(n,r.assetId);if(!a||u.OsfManifestManager.versionLessThan(a.getMarketplaceVersion(),r.version)){var s=u.OUtil.formatString("{0}/{1}",this._initParam.firstPartyManifestCDNUrl,r.path);t.getFirstPartyManifest(s,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){var a=e.ManifestUtil.ParseManifest(t.value,i._initParam.appUILocale,n.correlationId);if(a){u.OsfManifestManager.cacheManifest(r.assetId,"",a);var s=u.OUtil.formatString(e.CacheConsts.firstPartyManifestCacheKey,r.assetId);i._cacheManager.SetCacheItem(s,t.value),o({status:e.DataServiceResultCode.Succeeded,value:a})}else i.TryFallBackFirstPartyManifest(r.assetId,n,o)}else i.TryFallBackFirstPartyManifest(r.assetId,n,o)}))}else o({status:e.DataServiceResultCode.Succeeded,value:a})},n.prototype.getDataService=function(n,r){var o=this,i=o;if(o._dataService==t){var a={status:e.DataServiceResultCode.Failed,value:t},s=function(t,n){t.status==e.DataServiceResultCode.Succeeded?(i._dataService=n,a.value=n,a.status=e.DataServiceResultCode.Succeeded,r(a)):(a.httpStatus=t.httpStatus,r(a))},c=e.ProxyBasedCatalogService.getFirstPartyInstance(o._initParam);c.prepareProxy(n.correlationId,(function(e){s(e,c)}))}else r({status:e.DataServiceResultCode.Succeeded,value:o._dataService})},n.prototype.createActivityScope=function(t,n){var r=this;this.getDataService(t,(function(o){if(!e.AsyncUtil.failed(o,n)){var i=o.value,a={cacheManager:r._cacheManager,cachePrefix:e.CacheConsts.anonymousCacheKeyPrefix,cid:i.getCID(),anonymous:!0,telemetryContext:t},s=i.createScope(a);n({status:e.DataServiceResultCode.Succeeded,value:s})}}))},n.prototype.activateAsync=function(r,o,i){var a=this,s=a;i.startActivity(e.Activity.Activation),i.startActivity(e.Activity.ServerCall);var c=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),l=c&&c.enableFirstPartySDXErrorMessages;if(a._cacheManager.GetCacheItem(e.CacheConsts.firstPartyAddinListCacheKey,!0,t,t,!1)){var d=a.GetCachedManifest(i,r.assetId);if(d)return i.stopActivity(e.Activity.ServerCall),void o.load({entitlement:r,manifest:d,eToken:""},t)}a.createActivityScope(i,(function(a){if(a.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Failed to create 1st party activity scope.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),s.activateAsync(r,o,i)},errorCode:u.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError});var c=a.value;s.GetFirstyPartyAddInsInfo(c,i,r.assetId,(function(a){if(a.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Failed get list of 1st party addIns.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),s.activateAsync(r,o,i)},errorCode:u.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});var d=a.value.addInList[r.assetId];if(!d)return n.LogFirstPartyCatalogMonitoringError("Could not find 1st party addin assetId in list.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),s.activateAsync(r,o,i)},errorCode:u.ErrorStatusCodes.WAC_FirstPartyAddInListRequestFailure});i.startActivity(e.Activity.ManifestRequest),s.GetFirstPartyManifest(c,i,d,(function(a){if(a.status!=e.DataServiceResultCode.Succeeded)return n.LogFirstPartyCatalogMonitoringError("Could not get 1st party manifest.",r.assetId),void e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),s.activateAsync(r,o,i)},errorCode:u.ErrorStatusCodes.WAC_AgaveManifestRequestFailure});i.stopActivity(e.Activity.ManifestRequest),i.stopActivity(e.Activity.ServerCall);var c=a.value;o.load({entitlement:r,manifest:c,eToken:""},t)}))}))}))},n}();e.FirstPartyCatalog=t,e.CatalogFactory.register(u.StoreType.FirstParty,(function(n){if(n.osfOmexBaseUrl&&n.firstPartyManifestCDNUrl){var r,o=n.osfOmexBaseUrl.indexOf(u.Constants.ProtocolSeparator);r=o>=0?n.osfOmexBaseUrl.substr(o):u.Constants.ProtocolSeparator+n.osfOmexBaseUrl;var i=u.Constants.Https+r;return new t({appName:n.appName,appUILocale:n.appUILocale,AppVersion:n.appVersion,clientMode:n.clientMode,docUrl:n.docUrl,omexBaseUrl:i,omexForceAnonymous:!0,firstPartyManifestCDNUrl:n.firstPartyManifestCDNUrl})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:u.OsfControlStatus.ActivationFailed})}))}(f||(f={})),function(e){var t=function(){var e="OMEX_clearCacheAsync",t="OMEX_removeCacheAsync",n="OMEX_getAppStateAsync",r="OMEX_getKilledAppsAsync",o="OMEX_getManifestAndETokenAsync";function i(){}return i.CheckProxyIsReady="OMEX_isProxyReady",i.Gated_GetManifestAndEToken=o,i.Gated_GetKilledApps=r,i.Gated_GetEntitlementSummary="OMEX_getEntitlementSummaryAsync",i.Gated_GetAppState=n,i.Gated_RemoveApp="OMEX_removeAppAsync",i.Gated_RemoveCache=t,i.Gated_ClearCache=e,i.UnGated_GetAppDetails="OMEX_getAppDetailsAsync",i.UnGated_GetRecommendations="OMEX_getRecommendationsAsync",i.UnGated_ClearCache=e,i.Anonymous_GetManifestAndEToken=o,i.Anonymous_GetKilledApps=r,i.Anonymous_GetAppState=n,i.Anonymous_RemoveCache=t,i.Anonymous_ClearCache=e,i.Anonymous_GetAuthNStatus="OMEX_getAuthNStatus",i.Anonymous_GetFirstPartyAddInList="OMEX_getFirstPartyAddInListAsync",i.Anonymous_GetFirstPartyManifest="OMEX_getFirstPartyManifestAsync",i}();e.OmexProxyMethods=t;var n=function(n){var r=null;function o(e){var t=n.call(this)||this;return t.osfOmexBaseUrl=e,t}return i(o,n),o.prototype.prepareProxy=function(e,t,n){var i=this;n&&(i.isReady=!1,o.resetProxy(i)),i.isReady?e({status:r,value:{clientEndpoint:i.clientEndPoint}}):i.clientEndPoint?i.pendingCallbacks.push([e,t]):i.createProxy(e,t)},o.resetProxy=function(e){Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(u.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=r),e.clientEndPoint=r},o.prototype.createProxy=function(n,i){var a=this;try{!a.doesUrlHaveSupportedProtocol(a.proxyUrl)&&i({status:r,value:{errorMessage:"Protocal of proxyUrl is not supported."}});var c=document.createElement("iframe");c.setAttribute("id",a.proxyName),c.setAttribute("name",a.proxyName);var l=a.proxyUrl+"?"+a.conversationId,d=window.location.origin;l=u.OUtil.addXdmInfoAsHash(l,a.conversationId+"|"+a.proxyName+"|"+d),l=u.OUtil.addSerializerVersionAsHash(l,u.SerializerVersion.Browser),l=u.OUtil.addFlightsAsHash(l,JSON.stringify(u.Flights)),c.setAttribute("src",l),c.setAttribute("scrolling","auto"),c.setAttribute("border","0"),c.setAttribute("width","0"),c.setAttribute("height","0"),c.setAttribute("style","position: absolute; left: -100px; top:0px;");var f=500;a.proxyName===u.Constants.OmexAnonymousServiceName&&u.OUtil.checkFlight(u.FlightNames.FirstPartyAnonymousProxyReadyCheckTimeout)&&(f=5e3),document.body.appendChild(c);var p=a,m=function(){if(p.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(p.conversationId,c.contentWindow,p.proxyUrl),p.clientEndPoint)p.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=p.pendingCallbacks.length;if(0!=n){var i=r;0===e&&t.status?(p.isReady=!0,i={status:r,value:{clientEndpoint:p.clientEndPoint}}):(o.resetProxy(p),i={status:r,value:{errorMessage:"OmexProxyBase::onIframeLoad::isProxyReadyCallback failed, error code "+e}});for(var a=0;a<n;a++){var s=p.pendingCallbacks.shift();p.isReady?s[0](i):s[1](i)}}}),{__timeout__:f});else{var e="Unexpected error, iframe loaded again after failing OMEX_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,r,r,18121820),i({status:r,value:{errorMessage:e}})}u.OUtil.set_entropy((new Date).getTime())};u.OUtil.addEventListener(c,"load",m),a.iframeOnload=m,a.pendingCallbacks.push([n,i]),a.iframe=c}catch(t){var h="Error creating client endpoint with proxyUrl = ["+a.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);i({status:r,value:{errorMessage:h}})}},o}(e.ProxyBase);e.OmexProxyBase=n}(f||(f={})),function(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n.proxyName=u.Constants.OmexAnonymousServiceName,n.proxyUrl=n.osfOmexBaseUrl+u.Constants.OmexAnonymousServiceExtension,n}return i(n,t),n.prototype.getManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetManifestAndEToken,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),n(t)}))},n.prototype.getFirstPartyAddInListAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyAddInList,t,(function(e){n(e)}))},n.prototype.getFirstPartyManifestAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetFirstPartyManifest,t,(function(e){n(e)}))},n.prototype.getAppStateAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAppState,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),n(t)}))},n.prototype.getKilledAppAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetKilledApps,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),n(t)}))},n.prototype.getAuthNStatusAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.Anonymous_GetAuthNStatus,t,n)},n}(e.OmexProxyBase);e.AnonymousOmexProxy=t}(f||(f={})),function(e){var t=function(t){var n=null;function r(e){var n=t.call(this,e)||this;return n.proxyName=u.Constants.OmexGatedServiceName,n.proxyUrl=n.osfOmexBaseUrl+u.Constants.OmexGatedServiceExtension,n}return i(r,t),r.prototype.getOmexEntitlementsAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetEntitlementSummary,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertEntitlementInfo(t.value)),r(t)}))},r.prototype.getManifestAndETokenAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetManifestAndEToken,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertClientAppInstallInfo(t.value)),r(t)}))},r.prototype.getAppStateAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetAppState,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppState(t.value)),r(t)}))},r.prototype.getKilledAppAsync=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_GetKilledApps,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertKilledAppsInfo(t.value)),r(t)}))},r.prototype.removeApps=function(t,r){this.invokeProxyCommandAsync(e.OmexProxyMethods.Gated_RemoveApp,t,(function(t){t.value!=n&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertRemoveAppResponse(t.value)),r(t)}))},r}(e.OmexProxyBase);e.GatedOmexProxy=t}(f||(f={})),function(e){var t,n="",r=null;!function(e){var t="AnonymousUser",n="AuthedUser",r="NotDetected";e[e[r]=0]=r,e[e[n]=1]=n,e[e[t]=2]=t}(t||(t={}));var o=function(){function o(n){var r=this;r.currentUserType=t.NotDetected,r.omexAuthNStatus=u.OmexAuthNStatus.NotAttempted,r.omexAuthConnectTries=1,r.initParams=n,r.gatedProxy=new e.GatedOmexProxy(n.omexBaseUrl),r.ungatedProxy=new e.UnGatedOmexProxy(n.omexBaseUrl),r.anonymousProxy=new e.AnonymousOmexProxy(n.omexBaseUrl)}return o.getInstance=function(e){return o._instance==r&&(o._instance=new o(e)),o._instance},o.getFirstPartyInstance=function(e){if(o._firstPartyInstance==r){var t=new o(e);t._isFirstParty=!0,t.omexAuthNStatus=u.OmexAuthNStatus.Anonymous,this._firstPartyInstance=t}return o._firstPartyInstance},o.prototype.prepareProxy=function(o,i){var a=this;o=o||n;this.ensureOmexProxySetUp(o,(function(n){var o;n&&n.status!=r?n.status:e.DataServiceResultCode.ProxyNotReady;n&&n.value&&(a._isFirstParty?o=!0:n.value.currentUserType&&(n.value.currentUserType==t.AuthedUser?o=!1:n.value.currentUserType==t.AnonymousUser&&(o=!0))),i({status:n.status,value:{anonymous:o}})}))},o.prototype.createScope=function(e){return new a(e,this)},o.prototype.getCID=function(){switch(this.currentUserType){case t.AuthedUser:return this._cid;case t.AnonymousUser:return n}throw"not initialized"},o.prototype.ensureOmexProxySetUp=function(o,i){var a=this;if(a.currentUserType==t.NotDetected||!a.anonymousProxy.isReady&&!a.gatedProxy.isReady){var c=a,l=function(){c.currentUserType=t.AuthedUser,i({status:e.DataServiceResultCode.Succeeded,value:c})},d=function(){c.omexAuthConnectTries<u.Constants.AuthenticatedConnectMaxTries?(c.omexAuthConnectTries++,c.omexAuthNStatus!==u.OmexAuthNStatus.CheckFailed?c.anonymousProxy.prepareProxy(f,m):c.gatedProxy.prepareProxy(l,d)):(s.RuntimeTelemetryHelper.LogExceptionTag("exceed maximum tries and fail",r,o,18657693),c.anonymousProxy.prepareProxy(p,m))},f=function(e){if(e&&e.value){c.anonymousProxy.getAuthNStatusAsync({correlationId:o},(function(e){if(e.status===u.ProxyCallStatusCode.Succeeded){var t=e.value;t==u.OmexAuthNStatus.Authenticated?(c.omexAuthNStatus=u.OmexAuthNStatus.Authenticated,c.gatedProxy.prepareProxy(l,d)):t!=u.OmexAuthNStatus.Anonymous&&t!=u.OmexAuthNStatus.Unknown||(c.omexAuthNStatus=u.OmexAuthNStatus.Anonymous,c.anonymousProxy.prepareProxy(p,m))}else s.RuntimeTelemetryHelper.LogExceptionTag("auth check failure.",r,o,18657694),c.omexAuthNStatus=u.OmexAuthNStatus.CheckFailed,c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(p,m):c.gatedProxy.prepareProxy(l,d)}))}else s.RuntimeTelemetryHelper.LogExceptionTag("GetAuthNStatus callback param invalid",r,o,18657695)},p=function(n){c.omexAuthNStatus==u.OmexAuthNStatus.NotAttempted?f(n):(c.currentUserType=t.AnonymousUser,i({status:e.DataServiceResultCode.Succeeded,value:c}))},m=function(t){var a=n;void 0!==t&&t.value&&t.value.errorMessage&&(a=t.value.errorMessage),s.RuntimeTelemetryHelper.LogExceptionTag("create anonymous proxy failure: "+a,r,o,18657696),i({status:e.DataServiceResultCode.ProxyNotReady})};c.initParams.omexForceAnonymous?c.anonymousProxy.prepareProxy(p,m):c.gatedProxy.prepareProxy(l,d)}else i({status:e.DataServiceResultCode.Succeeded,value:a})},o}();e.ProxyBasedCatalogService=o;var i=function(){function e(){}return e.dummyApplicationName="unused",e}(),a=function(){var o="contentMarket",a="assetID",l="applicationName",d="errors";function f(e,t){var r=this;r._build=u.Constants.FileVersion,r._catalogService=t,r._appVersion=u.OmexAppVersions[r._catalogService.initParams.appName],r._clientName=u.OmexClientNames[r._catalogService.initParams.appName],r._clientVersion=c.getClientVersionFromWACAppVersion(r._catalogService.initParams.AppVersion),r._correlationId=e.telemetryContext.correlationId||n}return f.prototype.getFirstPartyAddInList=function(e){var t=this.buildOmexRequestParameters();t[d]={},this._catalogService.anonymousProxy.getFirstPartyAddInListAsync(t,e)},f.prototype.getFirstPartyManifest=function(e,t){var n=this.buildOmexRequestParameters();n[d]={},n.manifestUrl=e,this._catalogService.anonymousProxy.getFirstPartyManifestAsync(n,t)},f.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},f.prototype.isUserTypeValid=function(e){return e!==t.NotDetected||(s.RuntimeTelemetryHelper.LogExceptionTag("userType is invalid.",r,this._correlationId,18657698),!1)},f.prototype.getEntitlementAsync=function(n,r,o){var a=this,s=a,c=a.buildOmexRequestParameters();c[l]=i.dummyApplicationName,c.appVersion=a._appVersion,c.clearEntitlement=o||!1;var u=a._catalogService.currentUserType;a.isUserTypeValid(u)?u===t.AuthedUser?a._catalogService.gatedProxy.getOmexEntitlementsAsync(c,(function(e){s.tryFail(e.status,e.httpStatus,r)||(s._catalogService._cid=e.value.cid,r(e))})):u===t.AnonymousUser&&r({status:e.DataServiceResultCode.Succeeded,value:{refreshRate2:0,entitlements:[]}}):r({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,entitlements:[]}})},f.prototype.getLastStoreUpdate=function(){},f.prototype.isStoreDisabled=function(t){t({status:e.DataServiceResultCode.Succeeded,value:!1})},f.prototype.getManifest=function(t,r,o){this.getETokenAndManifestInternal(t,r,u.ClientAppInfoReturnType.urlOnly,(function(t){var r=t&&t.value&&t.value.manifest?t.value.manifest:n,i=t&&t.value&&t.value.status2?t.value.status2:u.OmexClientAppStatus.ServerError,a=t?t.status:e.DataServiceResultCode.Failed;o({status:a,value:{status2:i,manifest:r}})}))},f.prototype.getEToken=function(e,t,n){this.getETokenAndManifestInternal(e,t,u.ClientAppInfoReturnType.etokenOnly,n)},f.prototype.getETokenAndManifest=function(e,t,n){this.getETokenAndManifestInternal(e,t,u.ClientAppInfoReturnType.both,n)},f.prototype.getAppState=function(r,i){var s=this,c=s,u=s.buildOmexRequestParameters();u[a]=r.assetId,u[o]=r.storeId,u[d]={};var l=s._catalogService.currentUserType;s.isUserTypeValid(l)?l===t.AuthedUser?s._catalogService.gatedProxy.getAppStateAsync(u,(function(e){c.tryFail(e.status,e.httpStatus,i)?c.logServiceCallResponseError("appstate",e.httpStatus):i(e)})):l===t.AnonymousUser&&s._catalogService.anonymousProxy.getAppStateAsync(u,i):i({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,assetId:n,productId:n,version:n,state2:-1}})},f.prototype.getKilledApps=function(n){var o=this,i=o,a=o.buildOmexRequestParameters(),s=o._catalogService.currentUserType;o.isUserTypeValid(s)?s===t.AuthedUser?o._catalogService.gatedProxy.getKilledAppAsync(a,(function(e){i.tryFail(e.status,e.httpStatus,n)?i.logServiceCallResponseError("killedapps",e.httpStatus):n(e)})):s===t.AnonymousUser&&o._catalogService.anonymousProxy.getKilledAppAsync(a,n):n({status:e.DataServiceResultCode.UnknownUserType,value:{refreshRate2:0,killedApps:r}})},f.prototype.getAppDetails=function(e,t,r){var i=this,s=this.buildOmexRequestParameters();s.assetid=n,s[a]=e.join(","),s[o]=t,this._catalogService.ungatedProxy.getAppDetailsAsync(s,(function(e){i.tryFail(e.status,e.httpStatus,r)?i.logServiceCallResponseError("appdetails",e.httpStatus):r(e)}))},f.prototype.removeApps=function(r,o){var i=this,s=i,c=i.buildOmexRequestParameters();c.assetid=n,c[a]=r.join(",");var u=i._catalogService.currentUserType;i.isUserTypeValid(u)?u===t.AuthedUser?i._catalogService.gatedProxy.removeApps(c,(function(e){s.tryFail(e.status,e.httpStatus,o)?s.logServiceCallResponseError("removeapps",e.httpStatus):o(e)})):u===t.AnonymousUser&&o({status:e.DataServiceResultCode.Succeeded,value:{removedApps:[]}}):o({status:e.DataServiceResultCode.UnknownUserType,value:{removedApps:[]}})},f.prototype.getETokenAndManifestInternal=function(s,c,d,f){var p=this,m=p,h=p.buildOmexRequestParameters();h[l]=i.dummyApplicationName,h[a]=s.assetId,h.clientAppInfoReturnType=d;var g=p._catalogService.currentUserType;p.isUserTypeValid(g)?g===t.AuthedUser&&d!=u.ClientAppInfoReturnType.urlOnly?(h.assetContentMarket=c,h.userContentMarket=s.storeId,h.expectedVersion=s.appVersion,p._catalogService.gatedProxy.getManifestAndETokenAsync(h,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifestandetoken",e.httpStatus):f(e)}))):(h[o]=s.storeId,h.clientAppInfoReturnType==u.ClientAppInfoReturnType.etokenOnly?f({status:e.DataServiceResultCode.Succeeded,value:{status2:u.OmexClientAppStatus.OK,etoken:n,manifest:r}}):p._catalogService.anonymousProxy.getManifestAsync(h,(function(e){m.tryFail(e.status,e.httpStatus,f)?m.logServiceCallResponseError("manifest",e.httpStatus):f(e)}))):f({status:e.DataServiceResultCode.UnknownUserType,value:{etoken:n,manifest:r}})},f.prototype.buildOmexRequestParameters=function(){var e=this;return{clientName:e._clientName,clientVersion:e._clientVersion,correlationId:e._correlationId,build:e._build}},f.prototype.logServiceCallResponseError=function(e,t){var n="proxybased request "+e+" failed";t&&(n+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(n,r,this._correlationId,18657697)},f}();e.ProxyBasedCatalogServiceScope=a;var c=function(){function e(){}return e.getClientVersionFromWACAppVersion=function(e){if(e){var t=e.split("."),n=parseInt(t[0],10),r=parseInt(t[1],10)||0;if(!(n<=15&&r<=0)){var o=u.Constants.FileVersion.split(".");return n+"."+r+"."+o[2]+"."+o[3]}}},e.getOmexEndPointPageUrl=function(e,t,n){return u.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",e,n,t)},e}();e.OmexUtils=c}(f||(f={})),function(e){var t=function(t){function n(e){var n=t.call(this,e)||this;return n.proxyName=u.Constants.OmexUnGatedServiceName,n.proxyUrl=n.osfOmexBaseUrl+u.Constants.OmexUnGatedServiceExtension,n}return i(n,t),n.prototype.getAppDetailsAsync=function(t,n){this.invokeProxyCommandAsync(e.OmexProxyMethods.UnGated_GetAppDetails,t,(function(t){null!=t.value&&t.status==e.DataServiceResultCode.Succeeded&&(t.value=e.OmexXmlProcessor.ConvertAppDetails(t.value)),n(t)}))},n}(e.OmexProxyBase);e.UnGatedOmexProxy=t}(f||(f={})),function(e){var t=!1,n=null,r=!0,o=function(){var o="cacheExpired";function i(e,t){var n=this;n._initParam=t,n._cacheManager=e.cacheManager,n._cachePrefix=e.cachePrefix,n._cid=e.cid,n._anonymous=e.anonymous,n._telemetryContext=e.telemetryContext}return i.prototype.GetCacheKeyPrefix=function(){return this._cachePrefix},i.prototype.getOmexEndPointPageUrl=function(t,n){return e.OmexUtils.getOmexEndPointPageUrl(this._initParam.omexBaseUrl,t,n)},i.prototype.getKilledApps=function(t,o,i){var a=this,s=a;a._telemetryContext.startActivity(e.Activity.KilledAppsCheck);var c=u.OUtil.formatString(e.CacheConsts.killedAppsCacheKey,a.GetCacheKeyPrefix());if(i)a._cacheManager.RemoveCacheItem(c);else{var l=a._cacheManager.GetCacheItem(c,r);if(l&&l.refreshRate2!=n)return a._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),void o({status:e.DataServiceResultCode.Succeeded,value:l})}t.getKilledApps((function(t){t.status==e.DataServiceResultCode.Succeeded?(s._telemetryContext.stopActivity(e.Activity.KilledAppsCheck),l=t.value,s._cacheManager.SetCacheItem(c,l,l.refreshRate/e.CacheConsts.hourToDayConversionFactor),o(t)):o(t)}))},i.prototype.getAppState=function(i,a,s,c){var l=this,d=l;l._telemetryContext.startActivity(e.Activity.AppStateCheck);var f,p=u.OUtil.formatString(e.CacheConsts.appStateCacheKey,l.GetCacheKeyPrefix(),a.storeId,a.assetId);if(c)l._cacheManager.RemoveCacheItem(p);else{var m={};if(f=l._cacheManager.GetCacheItem(p,r,m),l._telemetryContext.setFlag(e.FlagName.AppStateDataInvalidFlag,m[o]||t),f&&f.state2!=n)return l._telemetryContext.stopActivity(e.Activity.AppStateCheck),l._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,r),void s({status:e.DataServiceResultCode.Succeeded,value:f})}i.getAppState(a,(function(n){n.status==e.DataServiceResultCode.Succeeded?(d._telemetryContext.stopActivity(e.Activity.AppStateCheck),d._telemetryContext.setFlag(e.FlagName.AppStateDataCachedFlag,t),f=n.value,d._cacheManager.SetCacheItem(p,f,f.refreshRate2/e.CacheConsts.hourToDayConversionFactor),s(n)):s(n)}))},i.prototype.getManifest=function(i,a,s,c,l){var d=this,f=d;d._telemetryContext.startActivity(e.Activity.ManifestRequest);var p,m=u.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,a.assetId,a.storeId);if(l)d._cacheManager.RemoveCacheItem(m);else{var h={};if(p=d._cacheManager.GetCacheItem(m,r,h),d._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,h[o]||t),p&&p.status2!=n)return d._telemetryContext.stopActivity(e.Activity.ManifestRequest),d._telemetryContext.stopActivity(e.Activity.ServerCall),d._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,r),void c({status:e.DataServiceResultCode.Succeeded,value:{status2:p.status2,manifest:p.manifest}})}i.getManifest(a,s,(function(n){n.status==e.DataServiceResultCode.Succeeded&&n.value.status2==u.OmexClientAppStatus.OK?(f._telemetryContext.stopActivity(e.Activity.ManifestRequest),f._telemetryContext.stopActivity(e.Activity.ServerCall),f._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),f._telemetryContext.setBits(e.FlagName.ManifestRequestType,u.ManifestRequestTypes.Manifest),p={etoken:"",status2:n.value.status2,manifest:n.value.manifest},f._cacheManager.SetCacheItem(m,p,e.CacheConsts.manifestRefreshRate),c(n)):c(n)}))},i.prototype.removeApps=function(n,o,i){var a=this;n.removeApps(o,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){for(var o=".*",s=t,c=[],l=n.value.removedApps,d=0;d<l.length;++d)l[d].result2==u.OmexRemoveAppStatus.Success&&(c.push(new RegExp(u.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,o,l[d].assetId,o,o),"i")),s=r);s&&a._cacheManager.RemoveMatches(c),i(n)}else i(n)}))},i.prototype.getCachedETokenAndManifest=function(i){var a={},s=this._cacheManager.GetCacheItem(i,r,a);if(this._telemetryContext.setFlag(e.FlagName.ManifestDataInvalidFlag,a[o]||t),s){if(s.status2&&s.tokenExpirationDate2&&s.tokenExpirationDate2>(new Date).getTime())return s;s.etoken=n,s.tokenExpirationDate2=n,s.entitlementType=n}return s},i.prototype.getETokenAndManifest=function(o,i,a,c,l){var d=this,f=d;if(d._anonymous)d.getManifest(o,i,a,(function(t){e.AsyncUtil.failed(t,c)||c({status:t.status,value:{etoken:"",status2:t.value.status2,manifest:t.value.manifest}})}),l);else{d._telemetryContext.startActivity(e.Activity.ManifestRequest);var p,m=function(t,n){f._telemetryContext.stopActivity(e.Activity.ManifestRequest),f._telemetryContext.stopActivity(e.Activity.ServerCall),f._telemetryContext.setFlag(e.FlagName.ManifestDataCachedFlag,t),n&&f._telemetryContext.setBits(e.FlagName.ManifestRequestType,n)},h=u.OUtil.formatString(e.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,d._cid,i.assetId,i.storeId,a);if(l)d._cacheManager.RemoveCacheItem(h);else{if((p=d.getCachedETokenAndManifest(h))&&p.etoken&&p.manifest)return m(r),void c({status:e.DataServiceResultCode.Succeeded,value:p});var g=p?p.manifest:n;if(g==n||""==g){var v=u.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,i.assetId,i.storeId),y=d._cacheManager.GetCacheItem(v,r);y&&(g=y.manifest)}if(g)return void(p&&p.etoken?(m(r),p.manifest=g,c({status:e.DataServiceResultCode.Succeeded,value:p})):o.getEToken(i,a,(function(i){i.status===e.DataServiceResultCode.Succeeded&&i.value?u.OUtil.checkFlight(u.FlightTreatmentNames.AddinCommandRibbonCacheFixEnabled)?o.getEntitlementAsync(t,(function(r){if(r.status!==e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("getEntitlementAsync() failed after getEToken() succeeded",n,f._telemetryContext.correlationId,545009887),void c({status:e.DataServiceResultCode.Failed});m(t,u.ManifestRequestTypes.Etoken),(p=i.value).status2===u.OmexClientAppStatus.OK&&(f._cacheManager.SetCacheItem(h,p,e.CacheConsts.manifestRefreshRate),p.manifest=g),c(i)}),r):(m(t,u.ManifestRequestTypes.Etoken),(p=i.value).status2===u.OmexClientAppStatus.OK&&(f._cacheManager.SetCacheItem(h,p,e.CacheConsts.manifestRefreshRate),p.manifest=g),c(i)):c(i)})))}o.getETokenAndManifest(i,a,(function(i){i.status===e.DataServiceResultCode.Succeeded?u.OUtil.checkFlight(u.FlightTreatmentNames.AddinCommandRibbonCacheFixEnabled)?o.getEntitlementAsync(t,(function(r){if(r.status!==e.DataServiceResultCode.Succeeded)return s.RuntimeTelemetryHelper.LogExceptionTag("getEntitlementAsync() failed after getETokenAndManifest() succeeded",n,f._telemetryContext.correlationId,545009886),void c({status:e.DataServiceResultCode.Failed});m(t,u.ManifestRequestTypes.Both),i.value.status2===u.OmexClientAppStatus.OK&&f._cacheManager.SetCacheItem(h,i.value,e.CacheConsts.manifestRefreshRate),c(i)}),r):(m(t,u.ManifestRequestTypes.Both),i.value.status2===u.OmexClientAppStatus.OK&&f._cacheManager.SetCacheItem(h,i.value,e.CacheConsts.manifestRefreshRate),c(i)):c(i)}))}},i.prototype.getEntitlements=function(t,r,o,i){var a=this,s=a;a._telemetryContext.startActivity(e.Activity.EntitlementCheck);var c,u,l=function(){u!=n&&c!=n&&(c=c.filter((function(e){return u.every((function(t){return t.assetId!=e.assetId}))})),o({status:e.DataServiceResultCode.Succeeded,value:{entitlements:c,killed:u}}))};a._anonymous?(c=[],a._telemetryContext.stopActivity(e.Activity.EntitlementCheck),l()):t.getEntitlementAsync(r,(function(t){s._telemetryContext.stopActivity(e.Activity.EntitlementCheck),o!=n&&(e.AsyncUtil.failed(t,o)?o=n:(s._cid||(s._cid=t.value.cid),c=t.value.entitlements,l()))}),i),a.getKilledApps(t,(function(t){o!=n&&(u=t.status==e.DataServiceResultCode.Succeeded?t.value.killedApps:[],l())}))},i.prototype.activate=function(o,i,a){var c,l,d=this,f={assetId:i.assetId,appVersion:i.appVersion,storeId:i.storeId,storeType:i.storeType,targetType:i.targetType},p=t,m=this.getOmexEndPointPageUrl(f.assetId,f.storeId),h=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),g=function(l,p){switch(l.status2){case u.OmexClientAppStatus.OK:if(l.tokenExpirationDate2&&l.tokenExpirationDate2<=(new Date).getTime())return void e.LoaderUtil.failWithWarning(a,e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){return v()},errorCode:u.ErrorStatusCodes.E_TOKEN_EXPIRED}));var g=e.ManifestUtil.ParseManifest(l.manifest,d._initParam.appUILocale,d._telemetryContext.correlationId);if(g==n)return void e.LoaderUtil.failWithError(a,{infoType:u.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),v()},description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,errorCode:u.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT});var b=g.getMarketplaceVersion();if(u.OsfManifestManager.cacheManifest(f.assetId,i.appVersion,g),g.requirementsSupported===t||void 0===g.requirementsSupported&&!a.getRequirementsChecker().isManifestSupported(g)){g.requirementsSupported=t;var S;return S=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(a,{description:S,url:m,detailView:r,errorCode:u.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex})}g.requirementsSupported=r,d._telemetryContext.setFlag(e.FlagName.ManifestTrustCachedFlag,!p);var C=u.OUtil.formatString(u.Constants.ActivatedCacheKey,i.assetId.toLowerCase(),i.storeType,i.storeId);if(p&&!a.skipTrust(i)){var A=u.OmexClientNames[d._initParam.appName];if(!(d._anonymous&&d._cacheManager.GetCacheItem(C,t))&&!a.hasConsent(i)&&!a.isForCustomFunctionSandbox())return void a.askForTrust({anonymous:t,clientName:A,entitlement:f,displayName:g.getDefaultDisplayName(),providerName:g.getProviderName(),iconUrl:g.getDefaultIconUrl(),url:m,isSSOAddin:g.isSSOAddin()},(function(){d.restartActivationTelemetry(),d._cacheManager.SetCacheItem(C,r),d._anonymous?a.load({entitlement:f,manifest:g,eToken:l.etoken},n):d.getETokenAndManifest(o,f,f.storeId,(function(o){o.status==e.DataServiceResultCode.Succeeded&&o.value.status2==u.OmexClientAppStatus.OK?(o.value.version!=n&&e.ManifestUtil.versionLessThan(f.appVersion,o.value.version)&&(f.appVersion=o.value.version),u.OUtil.checkFlight(u.FlightTreatmentNames.AddinCommandRibbonCacheFixEnabled)?O(t):O(r)):e.LoaderUtil.failWithError(a,{infoType:u.InfoType.Error,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),v()},description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),errorCode:u.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure})}))}))}a.hasConsent(i)&&d._cacheManager.SetCacheItem(C,r);var _=c.version;e.ManifestUtil.versionLessThan(_,i.appVersion)&&(_=i.appVersion),e.ManifestUtil.versionLessThan(b,_)?(f.appVersion=_,e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),a.setIsUpgrading(r),a.setUpgradingFailed(t),v(r),y()},url:m,highPriority:r,displayDeactive:t,errorCode:u.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})):c.state2===u.OmexState.DeveloperWithdrawn?e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:u.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}):c.state2===u.OmexState.Flagged?e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,url:m,displayDeactive:t,errorCode:u.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED}):!d._anonymous&&l.entitlementType&&l.entitlementType.toLowerCase()===u.OmexEntitlementType.Trial&&(e.LoaderUtil.showNotification(a,{description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){return window.open(m)},reDisplay:r,highPriority:r,displayDeactive:t,errorCode:u.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE}),e.LoaderUtil.showNotification(a,{description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,reDisplay:r,highPriority:r,displayDeactive:t,errorCode:u.ErrorStatusCodes.S_USER_CLICKED_BUY})),a.load({entitlement:f,manifest:g,eToken:l.etoken},n);break;case u.OmexClientAppStatus.KilledAsset:e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:u.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});break;case u.OmexClientAppStatus.NoEntitlement:case u.OmexClientAppStatus.TrialNotSupported:case u.OmexClientAppStatus.LimitedTrial:case u.OmexClientAppStatus.EntitlementDeactivated:if(d._anonymous){e.LoaderUtil.failWithError(a,{title:Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,description:Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,buttonTxt:Strings.OsfRuntime.L_SignInButton_TXT,buttonCallback:function(){var e=window.location.href,t=d._initParam.omexBaseUrl+u.Constants.SignInRedirectUrl+encodeURIComponent(e);window.open(t)},errorCode:u.ErrorStatusCodes.E_USER_NOT_SIGNED_IN})}else{a.setRetryCall((function(){d.restartActivationTelemetry(),v(r)})),e.LoaderUtil.failWithWarning(a,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:function(){window.open(m),e.LoaderUtil.showWarning(a,{description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),v(r)},detailView:r,retryAll:r,errorCode:u.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})},errorCode:u.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}break;case u.OmexClientAppStatus.UnknownAssetId:e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,errorCode:u.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST});break;case u.OmexClientAppStatus.Expired:case u.OmexClientAppStatus.Invalid:e.LoaderUtil.failWithWarning(a,{description:Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),v()},errorCode:u.ErrorStatusCodes.E_TOKEN_EXPIRED});break;case u.OmexClientAppStatus.Revoked:e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:u.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE});break;case u.OmexClientAppStatus.VersionMismatch:f.appVersion=l.version,a.askForUpgrade(e.LoaderUtil.warning({description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,url:m,highPriority:r,logAsError:r,errorCode:u.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE}),(function(){d.restartActivationTelemetry(),a.setIsUpgrading(r),a.setUpgradingFailed(t),v(r)}));break;case u.OmexClientAppStatus.VersionNotSupported:e.LoaderUtil.failWithWarning(a,{description:Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,errorCode:u.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType},u.OsfControlStatus.UnsupportedStore);break;case u.OmexClientAppStatus.UserIsMinor:h&&h.enableDisplayBlockedMinorError&&e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR});break;default:s.RuntimeTelemetryHelper.LogExceptionTag("unknown clientAppStatus in manifestAndEtoken: "+l.status2,n,d._telemetryContext.correlationId,20030238),e.LoaderUtil.failWithError(a,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),v(r)},errorCode:u.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus})}},v=function(i){var s=l?l.contentMarket:f.storeId,m=function(n,o){return n.status!=e.DataServiceResultCode.Succeeded?h&&h.enableDisplayBlockedMinorError&&451===n.httpStatus?(e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}),r):(e.LoaderUtil.failWithError(a,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),v(i)},errorCode:o}),r):t};a.skipTrust(f)?d.getManifest(o,f,s,(function(e){if(m(e,u.ErrorStatusCodes.WAC_AgaveManifestRequestFailure))a.getIsUpgrading()&&(a.setUpgradingFailed(r),a.setIsUpgrading(t));else{if(i)return c=n,void S(r);a.getIsUpgrading()&&a.setIsUpgrading(t),g({etoken:"",status2:e.value.status2,manifest:e.value.manifest})}}),i):d.getETokenAndManifest(o,f,s,(function(e){if(m(e,u.ErrorStatusCodes.WAC_AgaveManifestAndEtokenRequestFailure))a.getIsUpgrading()&&(a.setUpgradingFailed(r),a.setIsUpgrading(t));else{if(i)return c=n,p=t,u.OUtil.checkFlight(u.FlightTreatmentNames.AddinCommandRibbonCacheFixEnabled)?O(t):O(r),void S(r);a.getIsUpgrading()&&a.setIsUpgrading(t),g(e.value)}}),i)},y=function(){var t=u.OUtil.formatString(e.CacheConsts.anonymousAppInstallInfoCacheKey,f.assetId,f.storeId);d._cacheManager.RemoveCacheItem(t)},b=function(){if(c!=n&&p){if(l!=n)return f.appVersion=l.version,void v();var t,s,h;if(c.state2===u.OmexState.Flagged?t=r:c.state2===u.OmexState.DeveloperWithdrawn?s=r:c.state2===u.OmexState.Withdrawn&&(h=r),!(t||s||h)||(e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveRetired_ERR,url:m,errorCode:u.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE}),!t))if(a.hasConsent(i))v();else{var y=l?l.contentMarket:f.storeId;d.getManifest(o,f,y,(function(t){t.status==e.DataServiceResultCode.Succeeded?g({etoken:"",status2:t.value.status2,manifest:t.value.manifest},r):e.LoaderUtil.failWithError(a,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),d.restartActivationTelemetry(),b()},errorCode:u.ErrorStatusCodes.WAC_AgaveManifestRequestFailure})}))}}},O=function(i){l=n,p=t,d.getEntitlements(o,t,(function(o){if(o.status!=e.DataServiceResultCode.Succeeded)return h&&h.enableDisplayBlockedMinorError&&451===o.httpStatus?void e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledForMinor_ERR,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_APP_BLOCKED_FOR_MINOR}):void e.LoaderUtil.failWithError(a,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),O(t)},errorCode:u.ErrorStatusCodes.WAC_AgaveEntitlementRequestFailure});o.value.killed.some((function(e){return e.assetId==f.assetId}))?e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:u.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED}):(o.value.entitlements.some((function(e){return e.assetId.toLowerCase()==f.assetId.toLowerCase()?(l=e,m=d.getOmexEndPointPageUrl(e.assetId,e.contentMarket),r):t})),d._telemetryContext.setFlag(e.FlagName.OmexHasEntitlementFlag,l!=n),p=r,b())}),i)},S=function(t){c=n,d.getAppState(o,f,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return c={state2:u.OmexState.OK,productId:n,assetId:f.assetId,version:f.appVersion,refreshRate2:0},void b();t.value.state2!==u.OmexState.Killed?(c=t.value,b()):e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,url:m,errorCode:u.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED})}),t)};S(),O(t)},i.prototype.restartActivationTelemetry=function(){var t=this;t._telemetryContext.startActivity(e.Activity.Activation),t._telemetryContext.startActivity(e.Activity.ServerCall),t._telemetryContext.setFlag(e.FlagName.AnonymousFlag,t._anonymous)},i}(),i=function(){function i(t,o){void 0===o&&(o=n),this._anonymous=r,this._initParam=t,this._cacheManager=o||new e.AppsDataCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer)}return i.prototype.GetCacheKeyPrefix=function(){return this._anonymous?e.CacheConsts.anonymousCacheKeyPrefix:e.WACUtils.CacheConstants.GatedCacheKeyPrefix},i.prototype.getOmexEndPointPageUrl=function(e,t){return u.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._initParam.omexBaseUrl,t,e)},i.prototype.getDataService=function(t,r){var o=this,i=o;if(o._dataService==n)if(o._dataServiceReady==n){o._dataServiceReady=r;var a={status:e.DataServiceResultCode.Failed,value:n},s=function(t,r){var o=i._dataServiceReady;i._dataServiceReady=n,t.status==e.DataServiceResultCode.Succeeded?(i._anonymous=t.value.anonymous,i._dataService=r,a.value=r,a.status=e.DataServiceResultCode.Succeeded,o(a)):(a.httpStatus=t.httpStatus,o(a))};t.startActivity(e.Activity.Authentication);var c=new e.S2SOmexCatalogService(o._initParam);c.initialize(t.correlationId,(function(n){if(n.status==e.DataServiceResultCode.Succeeded){var r=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();if(!r||!r.enableAnonymousUseLegacyCatalogService||!n.value.anonymous)return t.stopActivity(e.Activity.Authentication),void s(n,c)}t.setBits(e.FlagName.ActivationRuntimeType,u.ActivationTypes.V2Enabled);var o=e.ProxyBasedCatalogService.getInstance(i._initParam);o.prepareProxy(t.correlationId,(function(n){t.stopActivity(e.Activity.Authentication),t.setBits(e.FlagName.RetryCount,o.omexAuthConnectTries),s(n,o)}))}))}else{t.startActivity(e.Activity.Authentication);var l=o._dataServiceReady;o._dataServiceReady=function(n){t.stopActivity(e.Activity.Authentication),l(n),r(n)}}else r({status:e.DataServiceResultCode.Succeeded,value:o._dataService})},i.prototype.createActivityScope=function(t,r){var i=this;this.getDataService(t,(function(a){if(e.AsyncUtil.failed(a,r))s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data service.",n,t.correlationId,18657692);else{t.setFlag(e.FlagName.AnonymousFlag,i._anonymous);var c=a.value,u={cacheManager:i._cacheManager,cachePrefix:i.GetCacheKeyPrefix(),cid:c.getCID(),anonymous:i._anonymous,telemetryContext:t},l=c.createScope(u),d=new o(u,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:l,activityScope:d}})}}))},i.prototype.getEntitlementAsync=function(t,n,r,o,i){var a=this;this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,[])||(a._anonymous?r({status:e.DataServiceResultCode.Failed,httpStatus:403}):n.value.serviceScope.getEntitlementAsync(t,(function(t){if(!e.AsyncUtil.failed(t,r,[])){for(var n=t.value.entitlements,o=0;o<n.length;o++){var i=n[o],a=i;a.appVersion=i.version,a.storeId=i.contentMarket,a.storeType=u.StoreType.OMEX,a.targetType=u.OUtil.getTargetType(i.appSubType)}r({status:t.status,value:n})}}),o,i))}))},i.prototype.getAndCacheManifest=function(r,o,i,a,s){var c=this;s=s||t;var l=u.OsfManifestManager.getCachedManifest(r.assetId,r.appVersion);s||l==n?this.createActivityScope(i,(function(t){if(!e.AsyncUtil.failed(t,a)){var l=t.value.serviceScope;t.value.activityScope.getManifest(l,r,o,(function(t){if(!e.AsyncUtil.failed(t,a))if(t.value.status2==u.OmexClientAppStatus.OK){var o=e.ManifestUtil.ParseManifest(t.value.manifest,c._initParam.appUILocale,i.correlationId);o!=n?(u.OsfManifestManager.cacheManifest(r.assetId,r.appVersion,o),a({status:e.DataServiceResultCode.Succeeded,value:o})):a({status:e.DataServiceResultCode.Failed,value:o})}else a({status:e.DataServiceResultCode.Failed})}),s)}})):a({status:e.DataServiceResultCode.Succeeded,value:l})},i.prototype.activateAsync=function(t,n,o){var i=this;o.startActivity(e.Activity.Activation),o.startActivity(e.Activity.ServerCall),this.createActivityScope(o,(function(a){i.isStoreDisabled(o,(function(s){if(s.value===r)e.LoaderUtil.failWithError(n,{description:Strings.OsfRuntime.L_OmexStoreDisabledByAdmin,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED});else if(a.status!=e.DataServiceResultCode.Succeeded)return void e.LoaderUtil.failWithError(n,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveOmexCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),i.activateAsync(t,n,o)},errorCode:u.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}));var s=a.value.serviceScope;a.value.activityScope.activate(s,t,n)}))},i.prototype.removeAsync=function(t,n,r){this.createActivityScope(n,(function(n){if(!e.AsyncUtil.failed(n,r)){var o=n.value.serviceScope;n.value.activityScope.removeApps(o,t,r)}}))},i.prototype.getAppDetails=function(t,o,i,a,s){var c=this,l=c,d=[];if(s)c._cacheManager.RemoveAll(e.CacheConsts.ungatedCacheKeyPrefix);else{for(var f=t,p=[],m=0;m<f.length;++m){var h=u.OUtil.formatString(e.CacheConsts.appDetailKey,f[m]),g=c._cacheManager.GetCacheItem(h,r);g&&g.state2!=n?d.push(g):p.push(f[m])}if(0===p.length)return void a({status:e.DataServiceResultCode.Succeeded,value:d});t=p}c.createActivityScope(i,(function(n){e.AsyncUtil.failed(n,a,d)||n.value.serviceScope.getAppDetails(t,o,(function(t){if(!e.AsyncUtil.failed(t,a,d)){for(var n=t.value,r=0;r<n.length;++r){var o=n[r],i=u.OUtil.formatString(e.CacheConsts.appDetailKey,o.assetId);l._cacheManager.SetCacheItem(i,o),d.push(o)}t.value=d,a(t)}}))}))},i.prototype.isStoreDisabled=function(n,r){this.createActivityScope(n,(function(n){e.AsyncUtil.failed(n,r,t)||n.value.serviceScope.isStoreDisabled(r)}))},i}();e.OmexCatalog=i,e.CatalogFactory.register(u.StoreType.OMEX,(function(t){if(t.allowExternalMarketplace&&t.osfOmexBaseUrl){var n,o=t.osfOmexBaseUrl.indexOf(u.Constants.ProtocolSeparator);n=o>=0?t.osfOmexBaseUrl.substr(o):u.Constants.ProtocolSeparator+t.osfOmexBaseUrl;var a=u.Constants.Https+n;return u.OUtil.getQueryStringParamValue(window.location.search,u.Constants.OmexForceAnonymousParamName).toLowerCase()==u.Constants.OmexForceAnonymousParamValue.toLowerCase()&&(t.omexForceAnonymous=r),new i({appName:t.appName,appUILocale:t.appUILocale,AppVersion:t.appVersion,clientMode:t.clientMode,docUrl:t.docUrl,omexBaseUrl:a,omexForceAnonymous:t.omexForceAnonymous})}return new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED}),controlStatus:u.OsfControlStatus.ActivationFailed})}))}(f||(f={})),function(e){var t=function(){function e(){}return e.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.",e.ungatedCacheKeyPrefix="__OSF_OMEX.",e.manifestRefreshRate=1825,e.hourToDayConversionFactor=24,e.anonymousAppInstallInfoCacheKey=e.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}",e.firstPartyAddinListCacheKey=e.anonymousCacheKeyPrefix+"firstPartyAddInList",e.firstPartyManifestCacheKey=e.anonymousCacheKeyPrefix+"firstPartyManifest.{0}",e.killedAppsCacheKey="{0}killedApps",e.appStateCacheKey="{0}appState.{1}.{2}",e.appDetailKey="__OSF_OMEX.appDetails.{0}",e}();e.CacheConsts=t}(f||(f={})),function(e){var t=null,n=function(){function n(e,t,n){var r=this;r._handler=e,r._initParam=t,r._cacheManager=n.cacheManager,r._cachePrefix=n.cachePrefix,r._cid=n.cid,r._correlationId=n.telemetryContext.correlationId}return n.prototype.tryFail=function(t,n){return 200!=t&&(n({httpStatus:t,status:e.DataServiceResultCode.Failed}),!0)},n.prototype.getLastStoreUpdate=function(t){var n=this,r=n,o=n._initParam.appUILocale;n._handler.getLastStoreUpdate(o,n._correlationId,(function(n,o){r.tryFail(n,t)?r.logServiceCallResponseError("laststoreupdate",n):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessLastStoreUpdate(o)})}))},n.prototype.getEntitlementAsync=function(n,r,o,i){var a=this,s=a,c=u.OmexAppVersions[a._initParam.appName],l=u.OUtil.formatString(a._cachePrefix+e.WACUtils.CacheConstants.EntitlementsKey,c,a._cid);if(o)a._cacheManager.RemoveCacheItem(l);else{var d=a._cacheManager.GetCacheItem(l,!0,t,i);if(d!=t)return void r({status:e.DataServiceResultCode.Succeeded,value:d})}a._handler.getEntitlement(n,c,a._correlationId,(function(t,n){if(s.tryFail(t,r))s.logServiceCallResponseError("entitlement",t);else{var o=e.OmexXmlProcessor.ProcessEntitlement(n);o.cid=s._cid,s._cacheManager.SetCacheItem(l,o,o.refreshRate2/e.CacheConsts.hourToDayConversionFactor),r({status:e.DataServiceResultCode.Succeeded,value:o})}}))},n.prototype.getEToken=function(t,n,r){var o=this,i=n,a=t.storeId,s=t.assetId,c=t.appVersion;this._handler.getEToken(a,i,s,c,this._correlationId,(function(t,n){o.tryFail(t,r)?o.logServiceCallResponseError("etoken",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessClientAppInstallInfo(n,u.ClientAppInfoReturnType.etokenOnly)})}))},n.prototype.getETokenAndManifest=function(t,n,r){var o=this;this.getEToken(t,n,(function(i){i.status==e.DataServiceResultCode.Succeeded?o.getManifest(t,n,(function(t){if(t.status!=e.DataServiceResultCode.Succeeded)return i.status=t.status,i.httpStatus=t.httpStatus,void r(i);i.value.manifest=t.value.manifest,r(i)})):r(i)}))},n.prototype.getManifest=function(t,n,r){var o=n;this._handler.getManifest(o,t.assetId,this._correlationId,(function(t,n){r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ConvertAnonymousManifest(t,n)})}))},n.prototype.getAppState=function(t,n){var r=this,o=t.storeId+":"+t.assetId;this._handler.getAppState(o,this._correlationId,(function(t,o){r.tryFail(t,n)?r.logServiceCallResponseError("appstate",t):n({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppState(o)})}))},n.prototype.getKilledApps=function(t){var n=this;this._handler.getKilledApps(this._correlationId,(function(r,o){n.tryFail(r,t)?n.logServiceCallResponseError("killedapps",r):t({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessKilledApps(o)})}))},n.prototype.getAppDetails=function(t,n,r){var o=this;this._handler.getAppDetails(n,t.join(","),this._correlationId,(function(t,n){o.tryFail(t,r)?o.logServiceCallResponseError("appdetails",t):r({status:e.DataServiceResultCode.Succeeded,value:e.OmexXmlProcessor.ProcessAppDetails(n)})}))},n.prototype.removeApps=function(t,n){var r=this;this._handler.removeApps(t.join(","),this._correlationId,(function(t,o){if(r.tryFail(t,n))r.logServiceCallResponseError("removeapps",t);else{var i=e.OmexXmlProcessor.ProcessRemoveAppResponse(o);i.removedApps.some((function(e){return e.result2==u.OmexRemoveAppStatus.Success}))&&r.clearEntitlementCache(),n({status:e.DataServiceResultCode.Succeeded,value:i})}}))},n.prototype.clearEntitlementCache=function(){var t=new RegExp(u.OUtil.formatString(e.WACUtils.CacheConstants.EntitlementsKey,".*",".*"),"i");this._cacheManager.RemoveMatches([t])},n.prototype.isStoreDisabled=function(t){var n=this;this._handler.isStoreDisabled(this._correlationId,(function(r){if(200!=r&&403!=r&&401!=r)return n.logServiceCallResponseError("isStoreDisabled",r),void t({status:e.DataServiceResultCode.Failed,value:!1});t({status:e.DataServiceResultCode.Succeeded,value:401==r})}))},n.prototype.logServiceCallResponseError=function(e,n){var r="s2s request "+e+" failed";n&&(r+=":"+n),s.RuntimeTelemetryHelper.LogExceptionTag(r,t,this._correlationId,18657699)},n}();e.OmexCatalogServiceS2SScope=n;var r=function(){function r(e){this._cid="",this._initParam=e}return r.initRequestHandler=function(e){r._requestHandler==t&&(r._requestHandler=e)},r.prototype.getCID=function(){return this._cid},r.prototype.initialize=function(n,o){var i=this;r._requestHandler!=t?this._initParam.omexForceAnonymous?o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):r._requestHandler.getUserId(n,(function(r,a){200==r?(i._cid=a.trim(),o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!1}})):403==r?o({status:e.DataServiceResultCode.Succeeded,value:{anonymous:!0}}):(s.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+r,t,n,18657728),o({status:e.DataServiceResultCode.Failed,httpStatus:r}))})):o({status:e.DataServiceResultCode.Failed,httpStatus:404})},r.prototype.createScope=function(e){return new n(r._requestHandler,this._initParam,e)},r}();e.S2SOmexCatalogService=r}(f||(f={})),function(e){var t=function(){var e="description",t="provider",n="o:assets",r="contentMarket",o="appSubType",i="expirationDate",a="state",s="version",c="productId",d="assetId",f="o:asset",p="o:results",m="refreshRate",h=null;function g(){}return g.ProcessLastStoreUpdate=function(e){var t=new u.XmlProcessor(e,l).getDocumentElement().selectSingleNode("o:update");return t.firstChild!=h?Date.parse(t.firstChild.nodeValue):h},g.ProcessAppState=function(e){var t={},n=new u.XmlProcessor(e,l),r=n.getDocumentElement();n.readAttributes(r,{rr:m},t);var o=n.selectSingleNode(p),h=n.selectSingleNode("o:lang",o),v=n.selectSingleNode(f,h);return n.readAttributes(v,{assetid:d,prodid:c,ver:s,state:a,tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:i},t),g.ConvertAppState(t)},g.ProcessFirstPartyAddInList=function(e){var t={addInList:{},refreshRate:h},n=new u.XmlProcessor(e,l),r=n.getDocumentElement(),o=n.selectSingleNode("o:Apps",r),i=o.getAttribute("d1p1:rr");t.refreshRate=i?parseInt(i):0;for(var a=n.selectNodes("o:App",o),s=0;s<a.length;s++){var c=a[s],f={assetId:h,path:h,version:h};n.readAttributes(c,{assetid:d},f);var p=n.selectSingleNode("o:Path",c);f.path=p.text!=h?p.text:p.textContent!=h?p.textContent:p.nodeTypedValue;var m=n.selectSingleNode("o:Version",c);f.version=m.text!=h?m.text:m.textContent!=h?m.textContent:m.nodeTypedValue,t.addInList[f.assetId]=f}return t},g.ConvertAppState=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e.state2=e.state?parseInt(e.state):0,e.expirationDate2=g.GetTickByDate(e.expirationDate),e},g.ProcessEntitlement=function(e){var t={},n=new u.XmlProcessor(e,l),a=n.selectSingleNode("o:entitlementlist"),f=n.selectSingleNode("o:hdr",a);n.readAttributes(f,{pm:"billingMarket",pagesize:"pageSize",rr:m},t);for(var p,h,v=n.selectNodes("o:entitlement",n.selectSingleNode("o:entitlements",a)),y=[],b=0;b<v.length;++b)h={},p=v[b],n.readAttributes(p,{assetid:d,pid:c,ver:s,appst:o,cm:r,trlt:"licenseType",acqdate:"acquireDate",expiry2:i,attreq:"attentionRequired"},h),y.push(h);return t.entitlements=y,g.ConvertEntitlementInfo(t)},g.ConvertEntitlementInfo=function(e){for(var t=e.entitlements,n=0;n<t.length;++n){var r=t[n];r.appSubType2=r.appSubType?parseInt(r.appSubType):0,r.acquireDate2=g.GetTickByDate(r.acquireDate),r.expirationDate2=g.GetTickByDate(r.expirationDate),r.attentionRequired2="true"===r.attentionRequired}return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},g.ProcessKilledApps=function(e){var t={},r=new u.XmlProcessor(e,l),o=r.getDocumentElement();r.readAttributes(o,{rr:m},t);for(var i=[],a=r.selectSingleNode(n),s=r.selectNodes(f,a),p=0;p<s.length;++p){var h=s[p],v={};r.readAttributes(h,{assetid:d,pid:c},v),i.push({assetId:v.assetId,productId:v.productId})}return t.killedApps=i,g.ConvertKilledAppsInfo(t)},g.ConvertKilledAppsInfo=function(e){return e.refreshRate2=e.refreshRate?parseInt(e.refreshRate):0,e},g.ProcessClientAppInstallInfo=function(e,t){var o=new u.XmlProcessor(e,l),i=o.selectSingleNode(n),a=o.selectSingleNode(f,i),c={etoken:h,manifest:h};if(t===u.ClientAppInfoReturnType.urlOnly?o.readAttributes(a,{url:"url"},c):t===u.ClientAppInfoReturnType.etokenOnly?o.readAttributes(a,{etok:"etoken"},c):o.readAttributes(a,{url:"url",etok:"etoken"},c),o.readAttributes(a,{status:"status",cm:r,assetid:d,ver:s},c),t!=u.ClientAppInfoReturnType.urlOnly&&c.etoken){var p=new u.XmlProcessor(c.etoken,""),m=p.selectSingleNode("t",p.selectSingleNode("r"));p.readAttributes(m,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},c)}return g.ConvertClientAppInstallInfo(c)},g.ConvertClientAppInstallInfo=function(e){return e.status2=e.status?parseInt(e.status):0,e.tokenExpirationDate2=g.GetTickByDate(e.tokenExpirationDate),e},g.ProcessManifest=function(e){return{manifest:e}},g.ProcessRemoveAppResponse=function(e){for(var t,n,r={removedApps:[]},o=new u.XmlProcessor(e,l),i=(o.getDocumentElement(),o.selectSingleNode("o:apps",o.selectSingleNode("o:removedApps"))),a=o.selectNodes("o:app",i),s=0;s<a.length;++s)t=a[s],n={},o.readAttributes(t,{assetid:d,result:"result"},n),r.removedApps.push(n);return g.ConvertRemoveAppResponse(r)},g.ConvertRemoveAppResponse=function(e){for(var t=e.removedApps,n=0;n<t.length;++n){var r=t[n];r.result2=r.result?parseInt(r.result):0}return e},g.ProcessAppDetails=function(n){for(var r,i,c=new u.XmlProcessor(n,l),f=c.selectSingleNode(p),m=c.selectNodes("o:wainfo",f),h=[],v=0;v<m.length;++v)r=m[v],i={},c.readAttributes(r,{assetid:d,appid:"webApplicationId",defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:t,desc:e,icon:"iconUrl",ver:s,state:a,appst:o,appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},i),h.push(i);return g.ConvertAppDetails(h)},g.ConvertAppDetails=function(e){for(var t=0;t<e.length;++t){var n=e[t];n.defaultHeight2=n.defaultHeight?parseInt(n.defaultHeight):0,n.defaultWidth2=n.defaultWidth?parseInt(n.defaultWidth):0,n.state2=n.state?parseInt(n.state):0,n.appSubType2=n.appSubType?parseInt(n.appSubType):0}return e},g.ProcessRecommendations=function(n){for(var r,o,i,c=new u.XmlProcessor(n,l),f=c.selectSingleNode(p),m=c.selectNodes("o:wa",f),h=[],g=0;g<m.length;++g)r=m[g],i={},c.readAttributes(r,{assetid:d,title:"name",desc:e,icon:"iconUrl",ver:s,state:a,rat:"rating",dls:"downloads",prov:t},i),o=c.selectSingleNode("o:price",r),c.readAttributes(o,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},i),h.push(i);return h},g.ConvertAnonymousManifest=function(e,t){var n,r="";switch(e){case 200:n=u.OmexClientAppStatus.OK,r=t;break;case 204:case 1223:n=u.OmexClientAppStatus.NoEntitlement;break;case 400:n=u.OmexClientAppStatus.BadRequest;break;case 410:n=u.OmexClientAppStatus.KilledAsset;break;case 404:n=u.OmexClientAppStatus.UnknownAssetId;break;case 412:n=u.OmexClientAppStatus.VersionNotSupported;break;case 451:n=u.OmexClientAppStatus.UserIsMinor;break;default:n=u.OmexClientAppStatus.ServerError}return{status2:n,manifest:r}},g.GetTickByDate=function(e){return e?new Date(e).getTime():h},g}();e.OmexXmlProcessor=t}(f||(f={})),function(e){var t=function(){var t=null;function n(n,r,o,i){void 0===i&&(i=t),this._cacheManager=i||new e.AppsDataCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer),this._privateCatalogService=new e.PrivateCatalogService(u.OmexClientNames[n],u.OUtil.normalizeAppVersion(r)),this._uiLocale=o}return n.prototype.getEntitlementAsync=function(t,r,o,i){r.startActivity(e.Activity.EntitlementCheck),i&&(this._cacheManager.RemoveAll(n._addInsCacheKey),this._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey)),this.GetAddInList(t,r,(function(t){for(var i=[],a=0,s=t;a<s.length;a++){var c=s[a];c.addInState===n._addInOkState&&i.push(c)}r.stopActivity(e.Activity.EntitlementCheck),o({status:e.DataServiceResultCode.Succeeded,value:i})}),(function(e){o({status:e})}))},n.prototype.getAppDetails=function(r,o,i,a,s){var c=this,u=c;s&&c._cacheManager.RemoveAll(n._addInDetailsCacheKeyPrefix);for(var l=[],d=[],f=0;f<r.length;f++){var p=n.GetAppDetailsCacheKey(r[f].ProductId),m=c._cacheManager.GetCacheItem(p);m?l.push(m):d.push(r[f])}0!==d.length?c._privateCatalogService.GetManifests(d,t,t,i,(function(t){for(var r=0;r<t.length;r++){var o=u.ParseAndCacheManifest(t[r],i);if(o){var s=n.CreateAddInDetails(o);l.push(s);var c=n.GetAppDetailsCacheKey(s.assetId);u._cacheManager.SetCacheItem(c,s,n._addInDetailsRefreshRateDays)}}a({status:e.DataServiceResultCode.Succeeded,value:l})}),(function(e){a({status:e})})):a({status:e.DataServiceResultCode.Succeeded,value:l})},n.prototype.getAndCacheManifest=function(t,r,o,i){var a={ProductId:t.assetId,Version:t.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:t.storeId,ContentMarket:r}};this.GetManifest(a,o,(function(t){i({status:e.DataServiceResultCode.Succeeded,value:t})}),(function(e){i({status:e})}))},n.prototype.activateAsync=function(r,o,i){var a=this;i.startActivity(e.Activity.Activation);var s=this;this.GetAddInList(!1,i,(function(c){for(var l,d=/[{}]/g,f=0,p=c;f<p.length;f++){var m=p[f];if(r.assetId.replace(d,"").toLowerCase()===m.assetId.replace(d,"").toLowerCase()){l=m;break}}if(l)if(l.addInState===n._addInOkState){r.appVersion=l.appVersion,u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)&&(r.addInStoreInfo=l.addInStoreInfo);var h={ProductId:l.assetId,Version:l.appVersion,AddInState:n._addInOkState,StoreInfo:{AssetId:l.storeId,ContentMarket:""}};a.GetManifest(h,i,(function(e){o.load({entitlement:r,manifest:e,eToken:""},t)}),(function(){e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message,url:"",errorCode:u.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),s.activateAsync(r,o,i)}})}))}else e.LoaderUtil.failWithError(o,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,url:"",errorCode:u.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED});else e.LoaderUtil.showWarning(o,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),s._cacheManager.RemoveAll(n._addInsCacheKey),s._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),s.activateAsync(r,o,i)},detailView:!0,retryAll:!0,errorCode:u.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})}),(function(){e.LoaderUtil.showWarning(o,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveAdminManagedCatalogName),buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:function(){o.restartActivation(),s._cacheManager.RemoveAll(n._addInsCacheKey),s._cacheManager.RemoveCacheItem(n._lastCatalogUpdateKey),s.activateAsync(r,o,i)},detailView:!0,retryAll:!0,errorCode:u.ErrorStatusCodes.WAC_AgaveActivationError}),i.stopActivity(e.Activity.Activation)}))},n.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},n.GetAppDetailsCacheKey=function(e){return n._addInDetailsCacheKeyPrefix+u.OUtil.formatString(n._addInDetailsCacheKeySufix,e)},n.GetManifestCacheKey=function(e,t){return n._manifestCacheKeyPrefix+u.OUtil.formatString(n._manifestCacheKeySufix,e,t)},n.CreateAddInDetails=function(e){return{assetId:e.getMarketplaceID(),webApplicationId:e.getWebApplicationId(),defaultHeight2:e.getDefaultHeight()||0,defaultHeight:String(e.getDefaultHeight()||0),defaultWidth2:e.getDefaultWidth()||0,defaultWidth:String(e.getDefaultWidth()||0),name:e.getDefaultDisplayName(),provider:e.getProviderName(),description:e.getDefaultDescription(),iconUrl:e.getDefaultIconUrl(),version:e.getMarketplaceVersion(),state2:1,state:"1",appSubType2:e.getOmexTargetCode(),appSubType:String(e.getOmexTargetCode()),appVersions:void 0,requirements:e.getRequirementsXml(),hosts:e.getHostsXml(),highResolutionIconUrl:e.getDefaultHighResolutionIconUrl()}},n.prototype.GetAddInList=function(e,r,o,i){var a,s=this;e||!(a=this._cacheManager.GetCacheItem(n._addInsCacheKey))?this._privateCatalogService.GetAddInList(t,t,r,(function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],a=n.GetAppDetailsCacheKey(i.assetId),c=s._cacheManager.GetCacheItem(a);c&&c.version!==i.appVersion&&s._cacheManager.RemoveCacheItem(a)}s._cacheManager.SetCacheItem(n._addInsCacheKey,e,n._addInListRefreshRateDays),o(e)}),i):o(a)},n.prototype.GetManifest=function(r,o,i,a){var s=this,c=s;o.startActivity(e.Activity.ManifestRequest);var l=u.OsfManifestManager.getCachedManifest(r.ProductId,r.Version);if(l)return o.stopActivity(e.Activity.ManifestRequest),void i(l);var d=n.GetManifestCacheKey(r.ProductId,r.Version),f=s._cacheManager.GetCacheItem(d);if(f)return(l=new u.Manifest.Manifest(f,s._uiLocale))?(u.OsfManifestManager.cacheManifest(r.ProductId,r.Version,l),o.stopActivity(e.Activity.ManifestRequest),void i(l)):void a(e.DataServiceResultCode.Failed);s._privateCatalogService.GetManifests([r],t,t,o,(function(t){(l=c.ParseAndCacheManifest(t[0],o))?(u.OsfManifestManager.cacheManifest(r.ProductId,r.Version,l),o.stopActivity(e.Activity.ManifestRequest),i(l)):a(e.DataServiceResultCode.Failed)}),(function(e){a(e)}))},n.prototype.ParseAndCacheManifest=function(e,r){try{var o=new u.Manifest.Manifest(e,this._uiLocale),i=n.GetManifestCacheKey(o.getMarketplaceID(),o.getMarketplaceVersion());return this._cacheManager.SetCacheItem(i,e,n._addInManifestRefreshRateDays),o}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest retrieved from Private Catalog.",e,r.correlationId,19965729)}return t},n._addInsCacheKey="__OSF_PRIVATECATALOG_ADDINS",n._addInDetailsCacheKeyPrefix="__OSF_PRIVATECATALOG_ADDINDETAILS",n._addInDetailsCacheKeySufix="_{0}",n._manifestCacheKeyPrefix="__OSF_PRIVATECATALOG_MANIFEST",n._manifestCacheKeySufix="_{0}_{1}",n._lastCatalogUpdateKey="_OSF_PRIVATECATALOG_LASTUPDATE",n._addInListRefreshRateDays=1/24,n._addInDetailsRefreshRateDays=365,n._addInManifestRefreshRateDays=365,n._addInOkState="Ok",n}();e.PrivateCatalog=t,e.CatalogFactory.register(u.StoreType.PrivateCatalog,(function(n){return n.enablePrivateCatalog?new t(n.appName,n.appVersion,n.appUILocale):new e.ForbiddenCatalog({loaderParams:e.LoaderUtil.error({description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveCatalogNotEnabled_ERR,Strings.OsfRuntime.L_AgaveAdminManagedCatalogName),errorCode:u.ErrorStatusCodes.E_EXCHANGE_PRIVATE_CATALOG_DISABLED}),controlStatus:u.OsfControlStatus.ActivationFailed})}))}(f||(f={})),function(e){var t=function(){var t="Failed to parse response into PrivateCatalogServiceResponse object.",n=200,r=!0,o=null,i=!1;function a(e,t){this._clientCode=e,this._clientVersion=t}return a.initRequestHandler=function(t,n,s,c){void 0===c&&(c=i),a._requestHandler==o&&(a._requestHandler=t),a.authenticationProxy==o&&(a.authenticationProxy=n),a._isThirdPartyHostEnabled=s,a._resultCodeIsEnabled=c&&c===r,a._tokenCacheManager=new e.TokenCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer),a._cacheManager=new e.AppsDataCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer)},a.ParseAddInList=function(e,t){var n,r=[];try{n=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetAddIns reponse.",e,t.correlationId,19965730),o}if(!n||!n.AddIns)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetPrivateCatalogAddIns response could not be parsed.",t.correlationId,20194262),r;for(var i=0,c=n.AddIns;i<c.length;i++){var l=c[i];l.AddInState&&l.ProductId&&l.Version?(u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?r.push({assetId:l.ProductId,storeId:l.StoreInfo?l.StoreInfo.AssetId:"none",appVersion:l.Version,storeType:u.StoreType.PrivateCatalog,targetType:u.OsfControlTarget.Undefined,addInState:l.AddInState,contentMarket:l.StoreInfo?l.StoreInfo.ContentMarket:"",productId:l.ProductId,addInStoreInfo:l.StoreInfo}):r.push({assetId:l.ProductId,storeId:l.StoreInfo?l.StoreInfo.AssetId:"none",appVersion:l.Version,storeType:u.StoreType.PrivateCatalog,targetType:u.OsfControlTarget.Undefined,addInState:l.AddInState,contentMarket:l.StoreInfo?l.StoreInfo.ContentMarket:""}),a.StoreAuthenticationData(n)):s.RuntimeTelemetryHelper.LogCommonMessageTag(u.OUtil.formatString('Add-In metadata was missing some data. ID: "{0}", Version: "{1}", State: "{2}".',l.ProductId||"",l.Version||"",l.AddInState||""),t.correlationId,20194263)}return r},a.ParseAndCacheManifestList=function(e,t){var n,r=[];try{n=JSON.parse(e)}catch(e){return s.RuntimeTelemetryHelper.LogExceptionTag("Could not parse GetManifests reponse.",e,t.correlationId,19965731),o}if(!n||!n.Manifests)return s.RuntimeTelemetryHelper.LogCommonMessageTag("GetAddInManifests response could not be parsed.",t.correlationId,20194264),r;for(var i=0,c=n.Manifests;i<c.length;i++){var u=c[i];r.push(u)}return a.StoreAuthenticationData(n),r},a.StoreAuthenticationData=function(e){a._tokenCacheManager.AddRefreshToken(e.RefreshToken,e.UserId,e.TenantId),a._userId=e.UserId,a._tenantId=e.TenantId},a.prototype.GetLastPrivateCatalogUpdate=function(t,c,u,l,d){var f=this,p=0;a._requestHandler.getLastPrivateCatalogUpdate(this._clientCode,this._clientVersion,t,c,u.correlationId,(function(m,h){var g="GetLastPrivateCatalogUpdate response could not be parsed.",v="Could not parse GetLastPrivateCatalogUpdate reponse.";if(p++,a._resultCodeIsEnabled){if(m===n){var y=a.ParsePrivateCatalogServiceResponse(h,u);if(!y)return void d(e.DataServiceResultCode.Failed);if(1===y.ResponseCode){try{O=JSON.parse(h)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag(v,t,u.correlationId,42284249),void d(e.DataServiceResultCode.Failed)}return O&&O.LastUpdate?(a.StoreAuthenticationData(O),void l(O.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(g,u.correlationId,42284250),void d(e.DataServiceResultCode.Failed))}if(2===y.ResponseCode)if(S=a.TryGetRefreshToken(h,u))return void f.GetLastPrivateCatalogUpdate(o,S,u,l,d);if(2===y.ResponseCode||3===y.ResponseCode){var b=r;return setTimeout((function(){a.authenticationProxy.tryAuthorize((function(e){b&&(b=i,f.GetLastPrivateCatalogUpdate(e,o,u,l,d))}),(function(){if(b){b=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(b){b=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),a._authenticationTimeout)}return void a.HandleLogging(y,u,d)}}else{if(m===n){var O;try{O=JSON.parse(h)}catch(t){return s.RuntimeTelemetryHelper.LogExceptionTag(v,t,u.correlationId,22823177),void d(e.DataServiceResultCode.Failed)}return O&&O.LastUpdate?(a.StoreAuthenticationData(O),void l(O.LastUpdate)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(g,u.correlationId,22823178),void d(e.DataServiceResultCode.Failed))}if(403===m){var S;if(1==p)if(p++,(S=a.TryGetRefreshToken(h,u))!=o)return void f.GetLastPrivateCatalogUpdate(t,S,u,l,d);if(p>a._maxAuthenticationAttempts||t!=o)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate authentication loop occured.",o,u.correlationId,22823179),void d(e.DataServiceResultCode.Unauthenticated);p++;b=r;return setTimeout((function(){a.authenticationProxy.tryAuthorize((function(e){b&&(b=i,f.GetLastPrivateCatalogUpdate(e,c,u,l,d))}),(function(){b&&(b=i,d(e.DataServiceResultCode.Unauthenticated))}))}),0),void setTimeout((function(){b&&(b=i,d(e.DataServiceResultCode.Unauthenticated))}),5e3)}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetLastPrivateCatalogUpdate request failed with status code "+m,o,u.correlationId,22823180),d(e.DataServiceResultCode.Failed)}))},a.prototype.GetAddInList=function(t,c,u,l,d){var f=this,p=0;a._requestHandler.getPrivateCatalogAddIns(this._clientCode,this._clientVersion,t,c,u.correlationId,(function(m,h){if(p++,a._resultCodeIsEnabled){if(m===n){var g=a.ParsePrivateCatalogServiceResponse(h,u);if(!g)return void d(e.DataServiceResultCode.Failed);if(1===g.ResponseCode)return(y=a.ParseAddInList(h,u))?void l(y):void d(e.DataServiceResultCode.Failed);if(2===g.ResponseCode)if(b=a._tokenCacheManager.GetRefreshToken(g.UserId,g.TenantId))return void f.GetAddInList(o,b,u,l,d);if(2===g.ResponseCode||3===g.ResponseCode){var v=r;return setTimeout((function(){a.authenticationProxy.tryAuthorize((function(e){v&&(v=i,f.GetAddInList(e,o,u,l,d))}),(function(){if(v){v=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(v){v=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),a._authenticationTimeout)}return void a.HandleLogging(g,u,d)}}else{var y;if(m===n)return(y=a.ParseAddInList(h,u))?void l(y):void d(e.DataServiceResultCode.Failed);if(403===m){var b;if(1==p)if(p++,(b=a.TryGetRefreshToken(h,u))!=o)return void f.GetAddInList(t,b,u,l,d);if(p>a._maxAuthenticationAttempts||t!=o)return s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList authentication loop occured. Either authentication attempts count is greater than 2, or authorizationCode is not null. attemptsCount: "+p,o,u.correlationId,20497158),void d(e.DataServiceResultCode.Unauthenticated);p++;v=r;return setTimeout((function(){a.authenticationProxy.tryAuthorize((function(e){v&&(v=i,f.GetAddInList(e,c,u,l,d))}),(function(){if(v){v=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}))}),0),void setTimeout((function(){if(v){v=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;d(t)}}),5e3)}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetAddInList request failed with status code "+m,o,u.correlationId,20497159),d(e.DataServiceResultCode.Failed)}))},a.prototype.GetManifests=function(t,c,u,l,d,f){var p=this,m=0,h={AddIns:t,RefreshToken:u,ResponseCode:1,UserId:"",TenantId:""};a._requestHandler.getPrivateCatalogManifests(e.WACUtils.serializeObjectToString(h),c,u,l.correlationId,(function(h,g){if(m++,a._resultCodeIsEnabled){if(h===n){var v=a.ParsePrivateCatalogServiceResponse(g,l);if(!v)return void f(e.DataServiceResultCode.Failed);if(1===v.ResponseCode)return(b=a.ParseAndCacheManifestList(g,l))?void d(b):void f(e.DataServiceResultCode.Failed);if(2===v.ResponseCode)if(O=a.TryGetRefreshToken(g,l))return void p.GetManifests(t,o,O,l,d,f);if(2===v.ResponseCode||3===v.ResponseCode){var y=r;return setTimeout((function(){a.authenticationProxy.tryAuthorize((function(e){y&&(y=i,p.GetManifests(t,e,o,l,d,f))}),(function(){if(y){y=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;f(t)}}))}),0),void setTimeout((function(){if(y){y=i;var t=a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed;f(t)}}),a._authenticationTimeout)}return void a.HandleLogging(v,l,f)}}else{var b;if(h===n)return(b=a.ParseAndCacheManifestList(g,l))?void d(b):void f(e.DataServiceResultCode.Failed);if(403===h){var O;if(1==m)if(m++,(O=a.TryGetRefreshToken(g,l))!=o)return void p.GetManifests(t,c,O,l,d,f);return m>a._maxAuthenticationAttempts||c!=o?(s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests authentication loop occured.",o,l.correlationId,20497160),void f(e.DataServiceResultCode.Unauthenticated)):(m++,void a.authenticationProxy.tryAuthorize((function(e){p.GetManifests(t,e,u,l,d,f)}),(function(){f(e.DataServiceResultCode.Unauthenticated)})))}}s.RuntimeTelemetryHelper.LogExceptionTag("Private Catalog: GetManifests request failed with status code "+h,o,l.correlationId,20497161),f(e.DataServiceResultCode.Failed)}))},a.TryGetRefreshToken=function(e,n){var r;try{r=JSON.parse(e)}catch(e){s.RuntimeTelemetryHelper.LogCommonMessageTag(t,n.correlationId,40748691)}return r?a._tokenCacheManager.GetRefreshToken(r.UserId,r.TenantId):o},a.HandleLogging=function(t,n,r){return t?4===t.ResponseCode||5===t.ResponseCode?(5===t.ResponseCode?s.RuntimeTelemetryHelper.LogCommonMessageTag("PrivateCatalogService: User not authenticated.",o,42768075):s.RuntimeTelemetryHelper.LogExceptionTag("PrivateCatalogService: All authentication attempts failed. ResponseCode: "+t.ResponseCode,o,n.correlationId,42284252),void r(a._isThirdPartyHostEnabled?e.DataServiceResultCode.Unauthenticated:e.DataServiceResultCode.Failed)):((0===t.ResponseCode||7===t.ResponseCode)&&s.RuntimeTelemetryHelper.LogExceptionTag("Call to AddinServiceHandler failed. ResponseCode: "+t.ResponseCode,o,n.correlationId,42284253),6===t.ResponseCode&&s.RuntimeTelemetryHelper.LogCommonMessageTag("PrivateCatalogService: User not supported.",o,42284254),void r(e.DataServiceResultCode.Failed)):(s.RuntimeTelemetryHelper.LogExceptionTag("PrivateCatalogService.HandleLogging: parsedResponse object is null.",o,n.correlationId,42284251),void r(e.DataServiceResultCode.Failed))},a.ParsePrivateCatalogServiceResponse=function(e,n){var r;try{r=JSON.parse(e)}catch(e){s.RuntimeTelemetryHelper.LogCommonMessageTag(t,n.correlationId,42284255)}return r},a.SignOutUser=function(){s.RuntimeTelemetryHelper.LogCommonMessageTag(u.OUtil.formatString("PrivateCatalogService.SignOutUser: userId = {0}, tenantId = {1}",a._userId,a._tenantId),o,21616005),a._tokenCacheManager.RemoveRefreshToken(a._userId,a._tenantId),a.authenticationProxy.signOut((function(){a._cacheManager.RemoveAll(e.PrivateCatalog._addInsCacheKey),a._cacheManager.RemoveAll(e.PrivateCatalog._addInDetailsCacheKeyPrefix)}),(function(){s.RuntimeTelemetryHelper.LogCommonMessageTag("Private Catalog: Failed to sign out ",o,22316866)}))},a._maxAuthenticationAttempts=3,a._authenticationTimeout=3e3,a}();e.PrivateCatalogService=t}(f||(f={})),function(e){var t=function(){var t="requestIdleCallback",n="SDX Catalog Error AssetId: ",r=null,o="fetch",i=!1,a="",c="sdxPreloadStart",l=!0,d="errorMessage",f="manifestParseEnd",p="manifestParseStart",m="manifestRetrievalEnd",h="manifestRetrievalStart",g="packageListParseEnd",v="packageListParseStart",y="packageListRetrievalEnd",b="packageListRetrievalStart",O="activateAsyncStart",S="cachedUrls",C="Version",A="FFN",_="AssetId",I="OsfControlId",x="performanceTimestampOrigin";function E(){}return E.recordActivity=function(e,t,n,r){otel&&otel.sendActivityEvent&&otel.sendActivityEvent({name:"Office.Online.Sdx."+e,durationMs:performance.now()-t,succeeded:n,dataFields:r})},E.recordActivationActivity=function(e,t){var n="activationStart";E.recordActivity("Activation",t[n],e,[{name:"PerformanceTimestampOrigin",double:t[x]},{name:I,string:t.osfControlId},{name:_,string:t.assetId},{name:A,string:t.ffn},{name:C,string:t.version},{name:"SourceLocationOverrideResourceId",string:t.sourceLocationOverrideResourceId},{name:"IframeUrl",string:t.iframeUrl},{name:"CachedUrls",string:t[S]},{name:"ActivationStart",double:t[n]},{name:"ActivateAsyncStart",double:t[O]},{name:"PackageListRetrievalStart",double:t[b]},{name:"PackageListRetrievalEnd",double:t[y]},{name:"PackageListParseStart",double:t[v]},{name:"PackageListParseEnd",double:t[g]},{name:"ManifestRetrievalStart",double:t[h]},{name:"ManifestRetrievalEnd",double:t[m]},{name:"ManifestParseStart",double:t[p]},{name:"ManifestParseEnd",double:t[f]},{name:"IframeCreateStart",double:t.iframeCreateStart},{name:"IframeCreateEnd",double:t.iframeCreateEnd},{name:"GetAppContextStart",double:t.getAppContextStart},{name:"GetAppContextEnd",double:t.getAppContextEnd},{name:"IframeOnLoadReceived",double:t.iframeOnLoadReceived},{name:"ErrorMessage",string:t[d]},{name:"OfficeJsReadyDate",double:t.officeJsReadyDate},{name:"IsPreload",boolean:t.isPreload===l},{name:"SdxPreloadStart",string:t[c]}])},E.InitializeSdx=function(t){var n="Application",r=u.OUtil.getValue(t.flightingTreatmentVariables,{}),o=u.OUtil.getValue(t.generalParameters,{});if(E.appName=u.OUtil.getValue(o[n],"Unknown"),E.wacCdnRssUrl=u.OUtil.getValue(o.wacCdnRssUrl,a),"true"===r["Microsoft.Office.WordOnline.SdxAssetPrefetchWithOfficeNetIframe"]){var i=o.StaticContentUrl+"sdxprefetcher.htm";E.PrefetcherIframeOrigin=e.WACUtils.getDomainForUrl(i),E.PrefetcherIframeContentWindow=new Promise((function(e){var t=document.createElement("iframe");t.src=i,t.style.display="none",t.onload=function(){return e(t.contentWindow)},t.setAttribute("sandbox","allow-same-origin allow-scripts"),document.getElementsByTagName("body")[0].appendChild(t)}))}E.InitializeSdxList(o.SdxDmsUrl,o.SdxCdnUrl,o.UICulture,o[n],o.LoggableUserId,o.SessionStartInfoJson)},E.MarkSdxPreloadStart=function(e){var t=e.toLowerCase();E.SdxPreloadStart[t]=performance.now()},E.IsSdxPreloaded=function(e){var t=e.toLowerCase();return E.SdxPreloadStart.hasOwnProperty(t)},E.GetPackageList=function(t,n,a,c,l,d){var f="prefetchedDmsResponse";void 0===d&&(d=i);var p=window[o]||e.AsyncUtil.fetch,m={automation:"Dogfood",microsoft:"Microsoft",dogfood:"Dogfood"}[JSON.parse(l).AudienceGroup.toLowerCase()]||"Production",h="SDXPackageList_"+a+"_"+n.toLowerCase(),g=0;return e.AsyncUtil.Cache.hasOwnProperty(h)||void 0===window[f]||(e.AsyncUtil.Cache[h]=window[f],delete window[f]),e.AsyncUtil.withCache(h,{forceUpdateCache:d,maxAgeInSecs:3600,useStaleCache:!0},(function(){return e.AsyncUtil.retry((function(){++g;var e=u.OUtil.Guid.generateNewGuid();return s.RuntimeTelemetryHelper.LogCommonMessageTag("Making network call to DMS. DMSActivityId="+e,r,594629387),p(t,{method:"POST",body:JSON.stringify({Context:{Hosts:[a],ReactNativeVersion:"0.0.0.0",Channel:"DevMain",Capabilities:u.AppSpecificSetup.BuildRequirementsChecker()._getSupportedSetAsDmsCapabilities(),Ring:m,Platform:"Web",Locales:[n],ClientId:c},SyncId:0}),headers:{"Content-Type":"application/json",DMSActivityId:e}}).then((function(e){if(!e.ok)throw new Error(e.status+" - "+e.statusText);return e.text()}),(function(t){throw new Error("GetPackageList : dmsActivityId:"+e+" : "+t.message+" : fetch attempts "+g)}))}))}))},E.GetManifest=function(t,n,a,c){void 0===c&&(c=i);var l=window[o]||e.AsyncUtil.fetch,d=E.GetManifestCdnUrl(t,n),f=u.OUtil.hashCode(d);return e.AsyncUtil.withCache("SDXManifest_"+n.AssetId+"_"+n.FFN+"_"+n.Version+"_"+f,{forceUpdateCache:c,maxAgeInSecs:259200,useStaleCache:!0},(function(){return e.AsyncUtil.retry((function(){return s.RuntimeTelemetryHelper.LogCommonMessageTag("Making network call to CDN. Url="+d,r,594629386),l(d).then((function(e){if(!e.ok)throw new Error(e.status+" - "+e.statusText);return e.text()}),(function(e){throw new Error("GetManifest error: "+e.message)}))}))}))},E.GetManifestCdnUrl=function(e,t){return u.OUtil.formatString(e,t.AssetId,t.FFN,t.Version,"en-us")},E.IsAbsoluteUrl=function(e){return/^(?:[a-z]+:)?\/\//i.test(e)},E.ResolveUrl=function(e,t){if(E.IsAbsoluteUrl(t))return t;var n=e.lastIndexOf("/");return e.substr(0,n)+("/"===t.charAt(0)?a:"/")+t},E.UpdateManifestIconUrl=function(e,t,n){for(var r="en-US",o=0,i=["_iconUrls","_highResolutionIconUrls"];o<i.length;o++){var a=i[o];if(e[a])if(e[a][n])e[a][n]=E.ResolveUrl(t,e[a][n]);else if(e[a][r])e[a][n]=E.ResolveUrl(t,e[a][r]);else for(var s in e[a])if(e[a].hasOwnProperty(s)&&r.toLowerCase()==s.toLowerCase()){e[a][s]=E.ResolveUrl(t,e[a][s]);break}}},E.InitializeSdxList=function(e,t,n,o,i,a){var c=E.GetPackageList(e,n,u.getManifestHostType(o),i,a,l).then((function(e){var t=e.value;return JSON.parse(t).Packages}));c.then((function(e){return e.forEach((function(e){return E.requestIdleCallback(function(e){return function(){return E.GetManifest(t,e,n,l).catch((function(){}))}}(e))})),e}),(function(e){var t=u.OUtil.getLocalStorage().isLocalStorageAvailable();s.RuntimeTelemetryHelper.LogExceptionTag("Error in getting SDX package list:InitializeSdxList localStorage:"+t,e,r,594629385)})),E.SdxCdnManifestUrlByAssetId=c.then((function(e){var n={};return e.forEach((function(e){n[e.AssetId.toLowerCase()]=E.GetManifestCdnUrl(t,e)})),n}))},E.PrefetchUrl=function(t,n){var r="prefetch";if(void 0===n&&(n=i),!E.PrefetchedAssetSet.hasOwnProperty(t)){var a={start:performance.now()};if(E.PrefetchedAssetSet[t]=a,E.PrefetcherIframeContentWindow)E.PrefetcherIframeContentWindow.then((function(e){e.postMessage({action:r,type:"link",urls:[t]},E.PrefetcherIframeOrigin)}));else if(n){var s=document.createElement("link");s.rel=r,s.href=t,s.onload=function(){a.end=performance.now()},document.head.appendChild(s)}else{var c=window[o]||e.AsyncUtil.fetch;E.requestIdleCallback((function(){c(t,{mode:"no-cors"}).then((function(){a.end=performance.now()}))}))}}},E.ResolveRelativeUrl=function(e,t){return E.SdxCdnManifestUrlByAssetId.then((function(n){var o=n[t.toLowerCase()];if(o==r)throw new Error("Unable to find manifestUrl");return E.ResolveUrl(o,e)}))},E.PrefetchAsset=function(e,t,n,o){var s=e.match(E.OfficeJsEntryRegex);if(s===r){var c=i;"iframeUrl:"===e.slice(0,10)&&(e=e.slice(10),c=l),E.IsAbsoluteUrl(e)?E.PrefetchUrl(e,c):c?E.ResolveRelativeUrl(e,o).then((function(e){return E.PrefetchUrl(e,l)}),(function(){})):E.ResolveRelativeUrl(e,o).then((function(e){return E.PrefetchUrl(e,i)}),(function(){}))}else{var d=s[1],f=s[2],p="https://appsforoffice.microsoft.com/lib/"+s[3]+"/hosted/",m=n.toLowerCase(),h=u.HostSpecificFileVersionMap[m].web||u.HostSpecificFileVersionDefault;E.PrefetchUrl(a+p+d),E.PrefetchUrl(a+p+m+"-web-"+h+(f||a)+".js"),E.PrefetchUrl(p+"en-us/office_strings.js"),E.PrefetchUrl(p+"telemetry/oteljs_agave.js"),E.PrefetchUrl(p+"webauth/webauth.implicit.js")}},E.PrefetchSdxAssets=function(e,t,n,o){var c="Microsoft.Office.OEP.",u=e.SdxAssetsToPrefetchMapping;if(u!=r&&!E.IsSdxPreloaded(o)){var d=[],f=[];try{d=JSON.parse(t[c+o.toUpperCase()+".SdxPrefetchAssetsToAdd"]||"[]"),f=JSON.parse(t[c+o.toUpperCase()+".SdxPrefetchAssetsToRemove"]||"[]")}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Error in parsing the sdx prefetch override flighting treatment variables.",e,r,593052824)}if("Word"===n){var p;try{p=JSON.parse(u)[o.toLowerCase()]}catch(e){return void E.LogSDXCatalogMonitoringError("Parsing SdxAssetsToPrefetchMapping failed.",o)}if(Array.isArray(p))for(var m=0,h=p;m<h.length;m++){var g=h[m];-1===f.indexOf(g)&&E.PrefetchAsset(g,e,n,o)}else for(var v=0,y=Object.keys(p);v<y.length;v++){var b=y[v],O=i;if(b===a)O=l;else{var S=b.split("=="),C=S[0],A=S[1];e[C]==A?O=l:t["Microsoft.Office."+C]==A&&(O=l)}if(O)for(var _=0,I=p[b];_<I.length;_++){g=I[_];-1===f.indexOf(g)&&E.PrefetchAsset(g,e,n,o)}}for(var x=0,T=d;x<T.length;x++){g=T[x];E.PrefetchAsset(g,e,n,o)}}}},E.AddWacSettingParametersToIframeUrl=function(e,t){var n=document.createElement("a");n.href=e;var r=Object.keys(t).map((function(e){return"wacSetting"+e+"="+encodeURIComponent(t[e].toString())})).join("&"),o=n.search.length>1?n.search.substr(1)+"&":a;return n.search=o+r,n.href},E.activateAsync=function(t,o,T,w,M,k){var j="WasCachedInMemory",P="PackageListRetrieval";T.startActivity(e.Activity.Activation),k[O]=performance.now(),k.assetId=t.assetId.toUpperCase();var R=e.CatalogFactory.getHostContext();s.RuntimeTelemetryHelper.LogCommonMessageTag("Start activating SDX with assetId: "+t.assetId+".",T.correlationId,37291606),T.startActivity(e.Activity.ServerCall);var N=r,D=performance.now();k[b]=performance.now(),E.GetPackageList(R.sdxDmsUrl,R.appUILocale,u.getManifestHostType(R.hostType),M.clientId,M.sessionStartInfoJson).then((function(e){var t=e.cacheType,n=e.value;k[y]=performance.now(),k[v]=performance.now();var r={cacheType:t,packages:JSON.parse(n).Packages};return k[g]=performance.now(),r})).then((function(e){var t=e.cacheType,n=e.packages;return E.recordActivity(P,D,l,[{name:I,string:T.instanceId},{name:j,bool:"memory"==t}]),n}),(function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("Error in getting SDX package list:activateAsync",e,r,556066975),k[y]=performance.now(),E.recordActivity(P,D,i,[{name:I,string:T.instanceId},{name:j,bool:i}]),e.sdxErrorCode=u.ErrorStatusCodes.WAC_SDX_DMSRequestFailed,e})).then((function(e){if((N=e.filter((function(e){return e.AssetId.toLowerCase()==t.assetId.toLowerCase()}))[0])==r){var n=new Error('Unable to find SDX "'+t.assetId+'" in the package list.');throw n.sdxErrorCode=u.ErrorStatusCodes.WAC_SDX_AssetIdNotInDMSResponse,n}return N})).then((function(t){var n="ManifestRetrieval";T.startActivity(e.Activity.ManifestRequest);var o=performance.now();return k[h]=performance.now(),k.ffn=t.FFN,k.version=t.Version,E.GetManifest(R.sdxCdnUrl,t,R.appUILocale).then((function(e){var r=e.cacheType,i=e.value;return k[m]=performance.now(),E.recordActivity(n,o,l,[{name:I,string:T.instanceId},{name:_,string:t.AssetId},{name:A,string:t.FFN},{name:C,string:t.Version},{name:j,bool:"memory"==r}]),i}),(function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("Error in getting Manifest:activateAsync",e,r,554235264),k[m]=performance.now(),E.recordActivity(n,o,i,[{name:I,string:T.instanceId},{name:_,string:t.AssetId},{name:A,string:t.FFN},{name:C,string:t.Version},{name:j,bool:i}]),e.sdxErrorCode=u.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,e}))})).then((function(t){k[p]=performance.now();var n=e.ManifestUtil.ParseManifest(t,R.appUILocale,T.correlationId);if(k[f]=performance.now(),E.recordActivity("ManifestParse",k[p],n!=r,[{name:I,string:T.instanceId},{name:_,string:N.AssetId},{name:A,string:N.FFN},{name:C,string:N.Version}]),n==r){var o=new Error("Unable to parse manifest.");throw o.sdxErrorCode=u.ErrorStatusCodes.WAC_AgaveManifestRequestFailure,o}return u.OsfManifestManager.cacheManifest(N.AssetId,a,n),n})).then((function(n){T.stopActivity(e.Activity.ServerCall),T.stopActivity(e.Activity.ManifestRequest);var i=E.GetManifestCdnUrl(R.sdxCdnUrl,N);E.UpdateManifestIconUrl(n,i,R.appUILocale),k[S]=JSON.stringify(E.PrefetchedAssetSet),k[c]=JSON.stringify(E.SdxPreloadStart),k[x]=Date.now()-performance.now(),o.load({entitlement:t,manifest:n,eToken:a,manifestUrl:i},r)}),(function(a){if(k[d]=a.toString(),k[S]=JSON.stringify(E.PrefetchedAssetSet),k[c]=JSON.stringify(E.SdxPreloadStart),k[x]=Date.now()-performance.now(),e.SDXCatalog.recordActivationActivity(i,k),s.RuntimeTelemetryHelper.LogExceptionTag(n+t.assetId,a,r,39068003),a.sdxErrorCode!=r){var u=e.HostFeatureEnabledInfo.getHostFeatureEnabledInfo(),l=u&&u.enableFirstPartySDXErrorMessages;e.LoaderUtil.failWithError(o,{title:l?Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty:Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:l?Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty:Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){o.restartActivation(),E.activateAsync(t,o,T,w,M,k)},errorCode:a.sdxErrorCode})}}))},E.LogSDXCatalogMonitoringError=function(e,t){s.RuntimeTelemetryHelper.LogExceptionTag(n+t+" Message: "+e,r,r,594350788)},E.appName="Unknown",E.wacCdnRssUrl=a,E.PrefetchedAssetSet={},E.OfficeJsEntryRegex=/^(office(\.debug)?\.js)@(1|1\.0|1\.1|beta)$/i,E.SdxPreloadStart={},E.PrefetcherIframeContentWindow=r,E.PrefetcherIframeOrigin=r,E.requestIdleCallback=window[t]?window[t].bind(window):e.AsyncUtil.limitRate((function(e){return e()}),50),E}();e.SDXCatalog=t}(f||(f={})),function(e){var t=!1,n=null,r=!0,o=function(){function o(e,t){this._initParam=t,this._cacheManager=e.cacheManager,this._telemetryContext=e.telemetryContext}return o.prototype.getManifest=function(o,i,a,s){var c=this,l=c;c._telemetryContext.startActivity(e.Activity.ManifestRequest);var d=u.OsfManifestManager.getCachedManifest(i.OfficeExtensionID,i.OfficeExtensionVersion);if(d)return c._telemetryContext.stopActivity(e.Activity.ManifestRequest),c._telemetryContext.stopActivity(e.Activity.ServerCall),void a({status:e.DataServiceResultCode.Succeeded,value:{manifest:d,cached:r}});i.EncodedAbsUrl?o.getManifest(i.EncodedAbsUrl,i.OfficeExtensionID,i.OfficeExtensionVersion,(function(r){if(l._telemetryContext.stopActivity(e.Activity.ManifestRequest),l._telemetryContext.stopActivity(e.Activity.ServerCall),r.status==e.DataServiceResultCode.Succeeded){var o=e.ManifestUtil.ParseManifest(r.value.manifest,l._initParam.appUILocale,l._telemetryContext.correlationId);o==n&&(r.status=e.DataServiceResultCode.Failed),a({status:r.status,value:{manifest:o,cached:t}})}else a({status:r.status,value:{manifest:n,cached:t}})}),s):a({status:e.DataServiceResultCode.Failed,value:{manifest:n,cached:t}})},o.prototype.activate=function(o,i,a){var s,c=this,l={assetId:i.assetId,appVersion:i.appVersion,storeId:i.storeId,storeType:i.storeType,targetType:i.targetType},d=function(o,s){var d=o.manifest,f=d.getMarketplaceVersion();if(u.OsfManifestManager.cacheManifest(i.assetId,i.appVersion,d),o.cached&&e.ManifestUtil.versionLessThan(f,i.appVersion))m(r);else{if(d.requirementsSupported===t||void 0===d.requirementsSupported&&!a.getRequirementsChecker().isManifestSupported(d)){d.requirementsSupported=t;var p;return p=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,void e.LoaderUtil.failWithError(a,{description:p,detailView:r,errorCode:u.ErrorStatusCodes.WAC_AgaveRequirementsError})}if(d.requirementsSupported=r,s&&!a.skipTrust(i)){var h=u.OUtil.formatString(u.Constants.ActivatedCacheKey,i.assetId.toLowerCase(),i.storeType,i.storeId),g=u.OmexClientNames[c._initParam.applicationName];if(!c._cacheManager.GetCacheItem(h,t)&&!a.hasConsent(i)&&!a.isForCustomFunctionSandbox())return void a.askForTrust({anonymous:n,clientName:g,entitlement:l,displayName:d.getDefaultDisplayName(),providerName:d.getProviderName(),iconUrl:d.getDefaultIconUrl(),isSSOAddin:d.isSSOAddin()},(function(){c._cacheManager.SetCacheItem(h,r),a.load({entitlement:l,manifest:d,eToken:n},n)}))}a.hasConsent(i)&&c._cacheManager.SetCacheItem(h,r),a.load({entitlement:l,manifest:d,eToken:n},n)}},f=function(t){c.getManifest(o,s,(function(n){n.status===e.DataServiceResultCode.Succeeded&&n.value.manifest?d(n.value,r):e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),f(t)},errorCode:u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),t)},p=function(t){s?s.OfficeExtensionKillbit?e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,errorCode:u.ErrorStatusCodes.E_OEM_EXTENSION_KILLED}):f(t):e.LoaderUtil.failWithError(a,{description:Strings.OsfRuntime.L_AgaveNotExist_ERR,buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),c._telemetryContext.startActivity(e.Activity.Activation),c._telemetryContext.startActivity(e.Activity.ServerCall),m(r)},errorCode:u.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST})},m=function(r){s=n,c._telemetryContext.startActivity(e.Activity.EntitlementCheck),o.getEntitlementAsync(t,i.targetType,(function(t){if(t.status==e.DataServiceResultCode.Succeeded){c._telemetryContext.stopActivity(e.Activity.EntitlementCheck);for(var o,i=n,d=t.value.entitlements,f=0;f<d.length;f++)(o=d[f]).OfficeExtensionID&&l.assetId&&o.OfficeExtensionID.toLowerCase()==l.assetId.toLowerCase()&&(i&&!e.ManifestUtil.versionLessThan(i.OfficeExtensionVersion,o.OfficeExtensionVersion)||(i=o));s=i,p(r)}else e.LoaderUtil.failWithError(a,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveMyOrganizationCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){a.restartActivation(),c._telemetryContext.startActivity(e.Activity.Activation),c._telemetryContext.startActivity(e.Activity.ServerCall),m()},errorCode:u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE})}),r)};m()},o}(),i=function(){function i(t,r){var o=this;void 0===r&&(r=n),o._appDataService={},o._catalogUrlDataService={},o._initParam=t,o._cacheManager=r||new e.AppsDataCacheManager(u.OUtil.getLocalStorage(),new e.SafeSerializer)}return i.prototype.getDataService=function(e,t,n){this.getDataServiceInternal(this._appDataService,e,t,n)},i.prototype.getCatalogUrlDataService=function(e,t,n){this.getDataServiceInternal(this._catalogUrlDataService,e,t,n)},i.prototype.getDataServiceInternal=function(t,r,o,i){if(t[r]==n&&(t[r]={spCatalogService:n,spCatalogServiceReady:n}),t[r].spCatalogService==n)if(t[r].spCatalogServiceReady==n){t[r].spCatalogServiceReady=i;var a={status:e.DataServiceResultCode.Failed,value:n},s=function(o,i){var s=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=n,o.status==e.DataServiceResultCode.Succeeded?(t[r].spCatalogService=i,a.value=i,a.status=e.DataServiceResultCode.Succeeded,s(a)):(a.httpStatus=o.httpStatus,s(a))};o.startActivity(e.Activity.Authentication);var c=e.SPCatalogProxyBasedCatalogService.getInstance(this._initParam);c.prepareProxy(r,o.correlationId,(function(t){o.stopActivity(e.Activity.Authentication),s(t,c)}))}else{var u=t[r].spCatalogServiceReady;t[r].spCatalogServiceReady=function(e){u(e),i(e)}}else i({status:e.DataServiceResultCode.Succeeded,value:t[r].spCatalogService})},i.prototype.createActivityScope=function(t,n,r){var i=this;this.getDataService(t,n,(function(a){if(!e.AsyncUtil.failed(a,r)){var s=a.value,c={cacheManager:i._cacheManager,storeId:t,telemetryContext:n},u=s.createScope(c),l=new o(c,i._initParam);r({status:e.DataServiceResultCode.Succeeded,value:{serviceScope:u,activityScope:l}})}}))},i.prototype.getEntitlementAsync=function(t,r,o,i,a,s){var c=this,l=function(a){a.status===e.DataServiceResultCode.Succeeded?(c.myOrgCatalogUrl=a.value,c.createActivityScope(a.value,r,(function(r){e.AsyncUtil.failed(r,o,[])||r.value.serviceScope.getEntitlementAsync(t,n,(function(t){if(!e.AsyncUtil.failed(t,o,[])){for(var n=t.value.entitlements,r=0;r<n.length;r++){var i=n[r];i.assetId=i.OfficeExtensionID,i.appVersion=i.OfficeExtensionVersion,i.storeId=c.myOrgCatalogUrl,i.storeType=u.StoreType.SPCatalog,i.targetType=u.OfficeAppType[i.OEType]}o({status:t.status,value:n})}}),i)}))):o({status:a.status,value:n})};(s=s||this.myOrgCatalogUrl||n)?l({status:e.DataServiceResultCode.Succeeded,value:s}):this.getSPCatalogUrl(r,l)},i.prototype.getAndCacheManifest=function(o,i,a,s){var c=this;this.getEntitlementAsync(r,a,(function(t){if(u.OUtil.writeProfilerMark(u.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),t.status===e.DataServiceResultCode.Succeeded&&t.value){for(var r=t.value,i=r.length,l=n,d=0;d<i;d++){var f=r[d];f.OfficeExtensionID&&o.assetId&&f.OfficeExtensionID.toLowerCase()===o.assetId.toLowerCase()&&(l&&!u.OsfManifestManager.versionLessThan(l.OfficeExtensionVersion,f.OfficeExtensionVersion)||(l=f))}l!=n?c.createActivityScope(c.myOrgCatalogUrl,a,(function(t){e.AsyncUtil.failed(t,s)||t.value.activityScope.getManifest(t.value.serviceScope,l,(function(e){s({status:e.status,value:e.value.manifest})}))})):s({status:e.DataServiceResultCode.Failed,value:n})}else s({status:e.DataServiceResultCode.Failed,value:n})}),t,0,o.storeId)},i.prototype.isUpnMatchAsync=function(t,n,r){var o=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,n,(function(){e.SPCatalogProxyBasedCatalogService.getInstance(o._initParam).isUpnMatchAsync(t,o._initParam.spBaseUrl,n.correlationId,r)}))},i.prototype.activateAsync=function(t,n,r){var o=this;r.startActivity(e.Activity.Activation),r.startActivity(e.Activity.ServerCall),this.createActivityScope(t.storeId,r,(function(i){if(i.status==e.DataServiceResultCode.Succeeded){var a=i.value.serviceScope;i.value.activityScope.activate(a,t,n)}else e.LoaderUtil.failWithError(n,{description:u.OUtil.formatString(Strings.OsfRuntime.L_AgaveServerConnectionToCatalogFailed_ERR,Strings.OsfRuntime.L_AgaveMyOrganizationCatalogName),buttonTxt:Strings.OsfRuntime.L_RetryButton_TXT,buttonCallback:function(){n.restartActivation(),o.activateAsync(t,n,r)},errorCode:u.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError})}))},i.prototype.removeAsync=function(t,n,r){r({status:e.DataServiceResultCode.Failed})},i.prototype.getAppDetails=function(t,n,r,o){o({status:e.DataServiceResultCode.Failed})},i.prototype.getSPCatalogUrl=function(t,n){var r=this;this.getCatalogUrlDataService(this._initParam.spBaseUrl,t,(function(){e.SPCatalogProxyBasedCatalogService.getInstance(r._initParam).getSPCatalogUrl(r._initParam.spBaseUrl,t.correlationId,n)}))},i}();e.CatalogFactory.register(u.StoreType.SPCatalog,(function(e){return new i({applicationName:u.HostCapability[e.hostType],AppVersion:e.appVersion,clientMode:e.clientMode,appUILocale:e.appUILocale,spBaseUrl:e.spBaseUrl,docUrl:e.docUrl})}))}(f||(f={})),function(e){var t=function(){function e(){}return e.CheckProxyIsReady="OEM_isProxyReady",e.GetEntitlementSummary="OEM_getEntitlementSummaryAsync",e.GetManifest="OEM_getManifestAsync",e.GetSPCatalogUrl="OEM_getSPCatalogUrlAsync",e.IsUpnMatch="OEM_isUpnMatchAsync",e}();e.SPCatalogProxyMethods=t;var n=function(){function e(){this.iframeProxies={},this.iframeProxyCount=0}return e.iframeNamePrefix="__officeExtensionProxy",e}();e.IframeProxyGroup=n;var r=function(r){var o=null;function a(e,t){var n=r.call(this)||this;return n.proxyUrl=e,n.iframeProxyGroup=t,n}return i(a,r),a.prototype.getEntitlementsAsync=function(e,n){this.invokeProxyCommandAsync(t.GetEntitlementSummary,e,n)},a.prototype.getManifestAsync=function(e,n){this.invokeProxyCommandAsync(t.GetManifest,e,n)},a.prototype.getSPCatalogUrlAsync=function(e,n){this.invokeProxyCommandAsync(t.GetSPCatalogUrl,e,n)},a.prototype.isUpnMatchAsync=function(e,n){this.invokeProxyCommandAsync(t.IsUpnMatch,e,n)},a.prototype.prepareProxy=function(e,t){var n=this;n.isReady?e({status:o,value:{clientEndpoint:n.clientEndPoint}}):n.clientEndPoint?n.pendingCallbacks.push([e,t]):n.createProxy(e,t)},a.resetProxy=function(e){delete e.iframeProxyGroup.iframeProxies[e.proxyUrl],e.iframeProxyGroup.iframeProxyCount=e.iframeProxyGroup.iframeProxyCount-1,Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e.conversationId)&&Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e.conversationId),e.iframe&&(u.OUtil.removeEventListener(e.iframe,"load",e.iframeOnload),e.iframe.parentNode.removeChild(e.iframe),e.iframe=o),e.clientEndPoint=o},a.prototype.createProxy=function(r,i){var c=this;try{if(!c.doesUrlHaveSupportedProtocol(c.proxyUrl))return void i({status:o,value:{errorMessage:"Protocal of proxyUrl is not supported."}});c.iframeProxyGroup.iframeProxies[c.proxyUrl]=c,c.iframeProxyGroup.iframeProxyCount=c.iframeProxyGroup.iframeProxyCount+1;var l=c.proxyUrl,d=l.length;"/"===l.charAt(d-1)&&(l=l.substr(0,d-1));var f=document.createElement("iframe"),p=n.iframeNamePrefix+c.iframeProxyGroup.iframeProxyCount;f.setAttribute("id",p),f.setAttribute("name",p);var m=l+"/_layouts/15/OfficeExtensionManager.aspx?"+c.conversationId,h=window.location.origin;m=u.OUtil.addXdmInfoAsHash(m,c.conversationId+"|"+p+"|"+h),m=u.OUtil.addSerializerVersionAsHash(m,u.SerializerVersion.Browser),m=u.OUtil.addFlightsAsHash(m,JSON.stringify(u.Flights)),f.setAttribute("scrolling","auto"),f.setAttribute("border","0"),f.setAttribute("width","0"),f.setAttribute("height","0"),f.setAttribute("style","position: absolute; left: -100px; top:0px;");var g=c;document.body.appendChild(f);var v=function(){if(g.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(g.conversationId,f.contentWindow,g.proxyUrl),g.clientEndPoint)g.clientEndPoint.invoke(t.CheckProxyIsReady,(function(e,t){var n=o;0===e&&t.status?(g.isReady=!0,n={status:o,value:{clientEndpoint:g.clientEndPoint}}):(a.resetProxy(g),n={status:o,value:{errorMessage:"isProxyReadyCallback failed, error code "+e}});for(var r=g.pendingCallbacks.length,i=0;i<r;i++){var s=g.pendingCallbacks.shift();g.isReady?s[0](n):s[1](n)}}),{__timeout__:2e3});else{var e="Unexpected error, iframe loaded again after failing OEM_isProxyReady";s.RuntimeTelemetryHelper.LogExceptionTag(e,o,o,18657365),i({status:o,value:{errorMessage:e}})}};u.OUtil.addEventListener(f,"load",v),f.setAttribute("src",m),c.iframeOnload=v,c.pendingCallbacks.push([r,i]),c.iframe=f}catch(t){var y="Error creating client endpoint with proxyUrl = ["+c.proxyUrl+"], msg:"+e.WACUtils.serializeObjectToString(t);i({status:o,value:{errorMessage:y}})}},a}(e.ProxyBase);e.SPCatalogProxy=r}(f||(f={})),function(e){var t="webUrl",n=null,r=function(){function r(t){this.proxyRetries={},this.initParams=t,this.iframeProxyGroup=new e.IframeProxyGroup}return r.getInstance=function(e){return r._instance==n&&(r._instance=new r(e)),r._instance},r.prototype.prepareProxy=function(t,r,o){r=r||"";this.proxyRetries[t]=1,this.ensureSPCatalogProxySetUp(t,r,(function(t){t&&t.status!=n?t.status:e.DataServiceResultCode.ProxyNotReady;o({status:t.status})}))},r.prototype.createScope=function(e){return new o(e,this)},r.prototype.getSPCatalogUrl=function(r,o,i){var a=this;this.prepareProxy(r,o,(function(){var l;if(r)if(l=a.iframeProxyGroup.iframeProxies[r]){var d={};d[t]=r,l.getSPCatalogUrlAsync(d,(function(t){var r="getspcatalogurl failed";t.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(r,n,o,19015125),c.msAjaxDebug.trace(r)),i(t)}))}else s.RuntimeTelemetryHelper.LogExceptionTag(u.OUtil.formatString("getspcatalogurl proxy not found, webUrl: {0}",r),n,o,19969545),i({status:e.DataServiceResultCode.ProxyNotReady});else s.RuntimeTelemetryHelper.LogExceptionTag("getspcatalogurl proxy URL empty",n,o,595190872),i({status:e.DataServiceResultCode.PrxoyUrlEmpty})}))},r.prototype.isUpnMatchAsync=function(r,o,i,a){var l=this;this.prepareProxy(o,i,(function(){var d;if(o)if(d=l.iframeProxyGroup.iframeProxies[o]){var f={};f.upn=r,f[t]=o,d.isUpnMatchAsync(f,(function(t){var r="isUpnMatchAsync failed";t.status!==e.DataServiceResultCode.Succeeded&&(s.RuntimeTelemetryHelper.LogExceptionTag(r,n,i,588814302),c.msAjaxDebug.trace(r)),a(t)}))}else s.RuntimeTelemetryHelper.LogExceptionTag(u.OUtil.formatString("isUpnMatchAsync proxy not found, webUrl: {0}",o),n,i,588814303),a({status:e.DataServiceResultCode.ProxyNotReady});else s.RuntimeTelemetryHelper.LogExceptionTag("isUpnMatchAsync proxy URL empty",n,i,588814301),a({status:e.DataServiceResultCode.PrxoyUrlEmpty})}))},r.prototype.ensureSPCatalogProxySetUp=function(t,r,o){if(!t)return s.RuntimeTelemetryHelper.LogExceptionTag("proxyUrl is null",n,r,19969546),void o({status:e.DataServiceResultCode.Failed});var i=this.iframeProxyGroup.iframeProxies[t];if(i||(i=new e.SPCatalogProxy(t,this.iframeProxyGroup)),i.isReady)o({status:e.DataServiceResultCode.Succeeded});else{var a=this,c=function(){o({status:e.DataServiceResultCode.Succeeded})},l=function(){a.proxyRetries[t]<u.Constants.AuthenticatedConnectMaxTries?(a.proxyRetries[t]++,i.prepareProxy(c,l)):(s.RuntimeTelemetryHelper.LogExceptionTag("sp exceed maximum tries and fail",n,r,18940555),o({status:e.DataServiceResultCode.ProxyNotReady}))};i.prepareProxy(c,l)}},r}();e.SPCatalogProxyBasedCatalogService=r;var o=function(){var r="clearCache";function o(e,t){this._catalogService=t,this.proxyUrl=e.storeId,this._correlationId=e.telemetryContext.correlationId||""}return o.prototype.tryFail=function(t,n,r){return t!=e.DataServiceResultCode.Succeeded&&(r({status:t}),!0)},o.prototype.getEntitlementAsync=function(e,n,o,i){var a=this,s=a,c=a._catalogService.iframeProxyGroup.iframeProxies[a.proxyUrl],u={};u[t]=a.proxyUrl,u.applicationName=a._catalogService.initParams.applicationName,u.officeExtentionTarget=n,u[r]=i||!1,u.supportedManifestVersions={"1.0":!0,1.1:!0},c.getEntitlementsAsync(u,(function(e){s.tryFail(e.status,e.httpStatus,o)?s.logServiceCallResponseError("entitlement",e.httpStatus):o(e)}))},o.prototype.getLastStoreUpdate=function(){},o.prototype.getManifest=function(e,t,n,o,i){var a=this,s=this._catalogService.iframeProxyGroup.iframeProxies[this.proxyUrl],c={};c.manifestUrl=e,c.id=t,c.version=n,c[r]=i,s.getManifestAsync(c,(function(e){a.tryFail(e.status,e.httpStatus,o)?a.logServiceCallResponseError("manifest",e.httpStatus):o(e)}))},o.prototype.isUpnMatchAsync=function(e,n){var r=this,o=r,i=r._catalogService.iframeProxyGroup.iframeProxies[r.proxyUrl],a={};a.upn=e,a[t]=r.proxyUrl,i.isUpnMatchAsync(a,(function(e){o.tryFail(e.status,e.httpStatus,n)?o.logServiceCallResponseError("isUpnMatch",e.httpStatus):n(e)}))},o.prototype.logServiceCallResponseError=function(e,t){var r="spproxy request "+e+" failed";t&&(r+=":"+t),s.RuntimeTelemetryHelper.LogExceptionTag(r,n,this._correlationId,18940556)},o}();e.SPCatalogProxyBasedCatalogServiceScope=o}(f||(f={})),u.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3},u.NotificationType={TrustYellowBar:0,TrustPromptTaskpane:3,TrustPromptContent:4},u.OmexMessageType={TabExit:1,ButtonClick:2,PageLoad:3},u._ErrorUXHelper=function(e){var t="progress_",n="input,a,button",r="moe-infobar-button2_",o=!0,i="moe-infobar-button_",a="moe-infobar-button",c=!1,l="button",d="moe-infobar-dismiss_",p="moe-infobar-dismiss",m="moe-infobar-message",h="moe-infobar-message_",g="moe-infobar-title",v="span",y="moe-infobar-message-div",b="moe-infobar-secinfo",O="moe-infobar-info",S="moe-infobar-warning",C="moe-infobar-error",A="moe-infobar-button-cell",_="moe-infobar-top-right-cell",I="moe-infobar-message-cell",x="moe-infobar-top-left-cell",E="presentation",T="role",w="moe-infobar-infotable",M="table",k="moe-infobar-body",j="alt",P=null,R="100%",N="center",D="no-repeat",F="alpha(opacity=100)",L="1",U="white",B="url(",H="onclick",V="tabindex",z="image",W="type",G="input",q="id",K="moe-background",X="class",Q="div",J="moe-trust-prompt-table_",Y="notificationbackground_",Z="moe-infobar-body_",$="agavedefaulticon96x96.png",ee="moe_status_icons.png",te="progress.gif",ne="img",re=e,oe=re.getOsfOmexBaseUrl(),ie="omexNotificationIframeClassName";u.OUtil.loadCSS(re.getLocalizedCSSFilePath("moeerrorux.css")),document.createElement(ne).src=re.getLocalizedImageFilePath(te),document.createElement(ne).src=re.getLocalizedImageFilePath(ee),document.createElement(ne).src=re.getLocalizedImageFilePath($);var ae={},se=0,ce=function(e){for(var t,n=e.childNodes.length,r=0;r<n;)"iframe"===(t=e.childNodes.item(r)).tagName.toLowerCase()?r++:(e.removeChild(t),n--)},ue=function(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)},le=function(e,t){var n;u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveStage2Start),n=t?Z+e:Y+e;var r=we(e);r&&ae[e][0].highPriority&&se--,ue(n),r&&ae[e].shift(),u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveStage2End)},de=function(e){u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveStage2Start);var t=J+e.id,n=we(e.id);n&&ae[e.id][0].highPriority&&se--,ue(t),n&&ae[e.id].shift(),u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveStage2End)},fe=function(e){u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage1Start),ce(e.div);var t=document.createElement(Q);t.setAttribute(X,K),t.setAttribute(q,"icon_"+e.id);var n=document.createElement(G);n.setAttribute(q,"iconImg_"+e.id),n.setAttribute(W,z),n.setAttribute(V,"0"),n.src=re.getLocalizedImageFilePath(ee);var r,o,i;n.setAttribute(H,"getIntoStage2(params)"),u.OUtil.attachClickHandler(n,(function(){!function(e){e.sqmDWords[1]|=2,Ae(e.id);var t=f.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}(e)})),t.appendChild(n),e.displayDeactive&&(t.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",t.style.backgroundColor=U,t.style.opacity=L,t.style.filter=F,t.style.backgroundRepeat=D,t.style.backgroundPosition=N,t.style.height=R),e.infoType===u.InfoType.Error?(r="moe-status-error-icon",o="iconImg_error_"+e.id,i=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===u.InfoType.Warning?(r="moe-status-warning-icon",o="iconImg_warning_"+e.id,i=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===u.InfoType.Information?(r="moe-status-info-icon",o="iconImg_info_"+e.id,i=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(r="moe-status-secinfo-icon",o="iconImg_secinfo_"+e.id,i=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=P&&9==parseFloat(RegExp.$1)&&(r+="_ie"),n.setAttribute(X,r),n.setAttribute(q,o),n.setAttribute(j,i),0!=e.div.childNodes.length?e.div.insertBefore(t,e.div.childNodes[0]):e.div.appendChild(t),Ie(e.id,u.AgaveHostAction.TabIn),u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage1End)},pe=function(e){u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage2Start),ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,f=document.getElementById(n);null==f&&((f=document.createElement(Q)).setAttribute(X,k),f.setAttribute(q,n));var J=document.createElement(Q);J.innerHTML=t,f.setAttribute("title",J.textContent),J=P;var te=document.createElement(M);te.setAttribute(X,w),te.setAttribute(T,E);for(var oe=0;oe<3;oe++)te.insertRow(oe).setAttribute(T,E);var ie=te.rows;ie[0].insertCell(0),ie[0].insertCell(1),ie[0].insertCell(2),ie[0].cells[1].setAttribute("rowSpan","2"),ie[1].insertCell(0),ie[1].insertCell(1),ie[2].insertCell(0),ie[2].insertCell(1),ie[2].insertCell(2),ie[0].cells[0].setAttribute(X,x),ie[0].cells[1].setAttribute(X,I),ie[0].cells[2].setAttribute(X,_),ie[2].cells[1].setAttribute(X,A);var ae,se,ue=document.createElement(ne);ue.src=re.getLocalizedImageFilePath(ee),e.infoType===u.InfoType.Error?(ae=C,se=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===u.InfoType.Warning?(ae=S,se=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===u.InfoType.Information?(ae=O,se=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(ae=b,se=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),ue.setAttribute(X,ae),ue.setAttribute(j,se),ie[0].cells[0].appendChild(ue);var de=document.createElement("a");de.setAttribute(X,y),de.setAttribute(V,L);var fe=document.createElement(v);fe.setAttribute(X,g),fe.innerHTML=e.title;var pe=h+e.id,me=document.getElementById(pe);null==me&&((me=document.createElement(v)).setAttribute(X,m),me.setAttribute(q,pe)),me.innerHTML=e.description,de.appendChild(fe),de.appendChild(me),ie[0].cells[1].appendChild(de);var he=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},ge=function(){e.sqmDWords[1]|=8,he(e),!e.reDisplay&&le(e.id,e.displayDeactive),Ae(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},ve=document.createElement(G);ve.setAttribute(W,z),ve.setAttribute("src",re.getLocalizedImageFilePath(ee)),ve.setAttribute(X,p),ve.setAttribute(q,d+e.id),ve.setAttribute(V,"0"),ve.setAttribute(j,Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT),ve.setAttribute(T,l),ve.setAttribute(H,"handleDismiss();"),u.OUtil.attachClickHandler(ve,ge),ie[0].cells[2].appendChild(ve),e.detailView=c;var ye=document.createElement(l);if(ye.setAttribute(X,a),ye.innerHTML=e.buttonTxt,ye.setAttribute(q,i+e.id),ye.setAttribute(V,L),ye.setAttribute(W,l),e.buttonCallback){ye.setAttribute(H,"handleButtonClick()"),u.OUtil.attachClickHandler(ye,(function(){if(e.sqmDWords[1]|=4,he(e),le(e.id,c),Ae(e.id),Te(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=P,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else ye.setAttribute(H,"handleDismiss()"),u.OUtil.attachClickHandler(ye,ge);if(ie[2].cells[1].appendChild(ye),e.url){var be=document.createElement(l);be.setAttribute(X,a),be.innerHTML=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,be.setAttribute(q,r+e.id),be.setAttribute(H,"moreInfoButtonClick()"),u.OUtil.attachClickHandler(be,(function(){e.sqmDWords[1]|=4,he(e),e.sqmDWords[1]=1,window.open(e.url)})),be.setAttribute(V,L),be.setAttribute(W,l),ie[2].cells[1].appendChild(be)}f.appendChild(te);var Oe=document.createElement(Q);Oe.setAttribute(X,K),Oe.setAttribute(q,Y+e.id),e.displayDeactive&&(Oe.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",Oe.style.backgroundColor=U,Oe.style.opacity=L,Oe.style.filter=F,Oe.style.backgroundRepeat=D,Oe.style.backgroundPosition=N,Oe.style.height=R),Oe.appendChild(f),0!=e.div.childNodes.length?e.div.insertBefore(Oe,e.div.childNodes[0]):e.div.appendChild(Oe),Ie(e.id,u.AgaveHostAction.TabIn),u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage2End)},me=function(e){u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var t=e.description;e.title.length>100&&(e.title=e.title.substring(0,99)),e.description.length>255&&(e.description=e.description.substring(0,254));var n=Z+e.id,r=document.getElementById(n);null==r&&((r=document.createElement(Q)).className=k,r.id=n),r.title=t,e.iframeNotificationUrl?r.appendChild(ve(e,r)):r.appendChild(ge(e));var o=document.createElement(Q);o.className=K,o.id=Y+e.id,e.displayDeactive&&(o.style.backgroundImage=B+re.getLocalizedImageFilePath($)+")",o.style.backgroundColor=U,o.style.opacity=L,o.style.filter=F,o.style.backgroundRepeat=D,o.style.backgroundPosition=N,o.style.height=R),o.appendChild(r),0!=e.div.childNodes.length?e.div.insertBefore(o,e.div.childNodes[0]):e.div.appendChild(o),Ie(e.id,u.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show infobar, error message: ",e,P,23455900)}u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage2End)},he=function(e){var t="moe-trust-prompt-description-id";u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage2Start);try{ce(e.div);var n=function(e){function t(e,t){var n=e.insertRow(-1);n.className="moe-trust-prompt-row "+t,n.setAttribute(T,E),n.insertCell(-1).className="moe-trust-prompt-cell"}e.id;var n=J+e.id,r=document.getElementById(n);r===P&&((r=document.createElement(M)).id=n,r.className="moe-trust-prompt-table",r.setAttribute(T,E)),t(r.createTHead(),"moe-trust-prompt-header");var o=r.createTBody();return t(o,"moe-trust-prompt-preview"),t(o,"moe-trust-prompt-description"),t(r.createTFoot(),"moe-trust-prompt-footer"),r}(e),r=n.rows,i=function(e){var t=document.createElement("p");return t.innerHTML=e.notificationType===u.NotificationType.TrustPromptContent?e.name:e.title,t.className="moe-trust-prompt-header-title",t}(e);r[0].cells[0].appendChild(i);var a=function(e){var t=document.createElement(ne);return t.src=e.icon,t.className="moe-trust-prompt-preview-img",t.setAttribute(j,e.iconTitle),t}(e),c=function(e){var t=document.createElement("p");return t.innerHTML=e.name,t.className="moe-trust-prompt-preview-title",t}(e),d=function(e){var t=document.createElement("p");return t.innerHTML=e.provider,t.className="moe-trust-prompt-preview-sub",t}(e);r[1].cells[0].appendChild(a),r[1].cells[0].appendChild(c),r[1].cells[0].appendChild(d);var f=function(e){var n=document.createElement("p");return n.innerHTML=e.description,n.className="moe-trust-prompt-description-text",n.id=t,n}(e);r[2].cells[0].appendChild(f);var p=function(){var n,r=document.createElement(l);return r.textContent=e.buttonTxt,r.className="moe-trust-prompt-button moe-trust-prompt-button-primary moe-trust-prompt-buttons-action",r.id="moe-trust-prompt-buttons-action_"+e.id,r.tabIndex=0,r.type=l,r.setAttribute("aria-describedby",t),n=e.buttonCallback?function(){if(e.sqmDWords[1]|=4,Oe(e),de(e),Ae(e.id),Te(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=P,re.retryAll(t._marketplaceID)}e.buttonCallback()}:function(){e.sqmDWords[1]|=8,Oe(e),!e.reDisplay&&de(e),Ae(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},u.OUtil.attachClickHandler(r,n),r}();if(r[3].cells[0].appendChild(p),e.url!==P){var m=function(e){var t=document.createElement(l);return t.textContent=e.urlButtonTxt||Strings.OsfRuntime.L_MoreInfoButton_TXT,t.className="moe-trust-prompt-button moe-trust-prompt-buttons-url",t.id="moe-trust-prompt-buttons-url_"+e.id,t.tabIndex=0,t.type=l,u.OUtil.attachClickHandler(t,(function(){e.sqmDWords[1]|=4,Oe(e),window.open(e.url)})),t}(e);r[3].cells[0].appendChild(m)}var h=function(e){var t=document.createElement(Q);t.className="moe-trust-prompt-collapse cui-ctl-iconContainer cui-img-cont-float cui-img-16by16";var n=document.createElement(ne);switch(e.clientName){case"WAC_Powerpoint":n.src=re.getLocalizedImageFilePath("per.png"),n.className="per_UpChevron_16x16x32";break;case"WAC_Word":n.src=re.getLocalizedImageFilePath("we.png"),n.className="we_UpChevron_16x16x32";break;case"WAC_Excel":n.src=re.getLocalizedImageFilePath("EwaEdit.png"),n.className="ewaboot_UpChevron16"}return n.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.appendChild(n),u.OUtil.attachClickHandler(t,(function(){var t="collapsed";e.collapsed===o?e.div.classList.remove(t):e.div.classList.add(t),e.collapsed=!e.collapsed})),t}(e);0!=e.div.childNodes.length?e.div.insertBefore(n,e.div.childNodes[0]):e.div.appendChild(n),e.div.appendChild(h),e.div.style.overflowY="auto",e.div.classList.add("moe-trust-prompt"),e.div.classList.add(e.clientName),e.div.classList.add(e.notificationType===u.NotificationType.TrustPromptContent?"content-add-in":"taskpane-add-in"),Ie(e.id,u.AgaveHostAction.TabIn)}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Failed to show trust prompt, error message: ",e,P,38592974)}u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderStage2End)},ge=function(e){var t=ye(e),n=t.rows;n[0].cells[0].appendChild(be(e));var s=document.createElement("a");s.className=y,s.tabIndex=1;var d=document.createElement(v);d.className=g,d.textContent=e.title;var f=h+e.id,p=document.getElementById(f);null==p&&((p=document.createElement(v)).className=m,p.id=f),p.textContent=e.description,s.appendChild(d),s.appendChild(p),n[0].cells[1].appendChild(s);var b=function(){Se(e)},O=Ce(e);u.OUtil.attachClickHandler(O,b),n[0].cells[2].appendChild(O),e.detailView=c;var S=document.createElement(l);if(S.className=a,S.textContent=e.buttonTxt,S.id=i+e.id,S.tabIndex=1,S.type=l,e.buttonCallback){u.OUtil.attachClickHandler(S,(function(){if(e.sqmDWords[1]|=4,Oe(e),le(e.id,c),Ae(e.id),Te(e.id),e.retryAll===o){var t=re.getOsfControl(e.id);t._retryActivate=P,re.retryAll(t._marketplaceID)}e.buttonCallback()}))}else u.OUtil.attachClickHandler(S,b);if(n[2].cells[1].appendChild(S),e.url){var C=document.createElement(l);C.className=a,C.textContent=e.urlButtonTxt?e.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT,C.id=r+e.id,u.OUtil.attachClickHandler(C,(function(){e.sqmDWords[1]|=4,Oe(e),e.sqmDWords[1]=1,window.open(e.url)})),C.tabIndex=1,C.type=l,n[2].cells[1].appendChild(C)}return t},ve=function(e,t){var n="message",r=ye(e),i=r.rows,a=document.createElement("iframe");window.getComputedStyle(e.div,P);a.width=R,a.frameBorder="0",a.className=ie,a.src=e.iframeNotificationUrl,i[0].cells[1].appendChild(a);var l="moe-hovered";t.addEventListener("mouseenter",(function(){u.OUtil.addClass(t,l),a.contentWindow.postMessage(u.AgaveHostAction.MouseEnter,oe)})),t.addEventListener("mouseleave",(function(){u.OUtil.removeClass(t,l),a.contentWindow.postMessage(u.AgaveHostAction.MouseLeave,oe)})),e.detailView=c;var d=P,f=Ce(e);return u.OUtil.attachClickHandler(f,(function(){Se(e),window.removeEventListener(n,d)})),i[0].cells[2].appendChild(f),f.addEventListener("keydown",(function(e){9==e.keyCode&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),a.contentWindow.postMessage(u.AgaveHostAction.TabInShift,oe))})),e.buttonCallback&&(d=function(t){try{if(t.source==a.contentWindow){var r=JSON.parse(t.data),i=parseInt(r[u.OmexMessageKeys.MessageType]),l=parseInt(r[u.OmexMessageKeys.MessageValue]);if(i==u.OmexMessageType.ConsentResult){if(le(e.id,c),Ae(e.id),Te(e.id),e.retryAll===o&&(e.notificationType==u.NotificationType.TrustYellowBar||e.notificationType==u.NotificationType.ConsentYellowBar&&l==u.ConsentResultCode.Success)){var p=re.getOsfControl(e.id);p._retryActivate=P,re.retryAll(p._marketplaceID)}window.removeEventListener(n,d),e.buttonCallback(l)}else i==u.OmexMessageType.TabExit&&(l==u.AgaveHostAction.TabExitShift&&re._notifyHost?re._notifyHost(e.id,u.AgaveHostAction.TabExitShift):l==u.AgaveHostAction.TabExit&&(window.focus(),f.focus()))}}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Exception in receivedMessageHandler: ",e,P,23455901)}},window.addEventListener(n,d)),r},ye=function(e){var t=document.createElement(M);t.className=w,t.setAttribute(T,E);for(var n=e.iframeNotificationUrl?1:3,r=0;r<n;r++){t.insertRow(r).setAttribute(T,E)}var o=t.rows;return o[0].insertCell(0),o[0].insertCell(1),o[0].insertCell(2),o[0].cells[1].setAttribute("rowSpan","2"),o[0].cells[0].setAttribute(X,x),o[0].cells[1].setAttribute(X,I),o[0].cells[2].setAttribute(X,_),e.iframeNotificationUrl==P&&(o[1].insertCell(0),o[1].insertCell(1),o[2].insertCell(0),o[2].insertCell(1),o[2].insertCell(2),o[2].cells[1].setAttribute(X,A)),o[0].cells[0].appendChild(be(e)),t},be=function(e){var t,n,r=document.createElement(ne);return r.src=re.getLocalizedImageFilePath(ee),e.infoType===u.InfoType.Error?(t=C,n=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT):e.infoType===u.InfoType.Warning?(t=S,n=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT):e.infoType===u.InfoType.Information?(t=O,n=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT):(t=b,n=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT),r.className=t,r.alt=n,r},Oe=function(e){var t=re.getOsfControl(e.id);s.AppNotificationHelper.LogNotification(t._appCorrelationId,e.sqmDWords[0],e.sqmDWords[1])},Se=function(e){e.sqmDWords[1]|=8,Oe(e),!e.reDisplay&&le(e.id,e.displayDeactive),Ae(e.id),e.reDisplay?Ee(e):Te(e.id),e.dismissCallback&&e.dismissCallback()},Ce=function(e){var t=document.createElement(G);return t.type=z,t.src=re.getLocalizedImageFilePath(ee),t.className=p,t.id=d+e.id,t.tabIndex=0,t.alt=Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT,t.setAttribute(T,l),t},Ae=function(e){var t=re.getOsfControl(e);t&&(t._controlFocus=o)},_e=function(e){var t=re.getOsfControl(e);if(t&&!we(e))if(t.getStatus()===u.OsfControlStatus.Activated&&t.getPageStatus()===u.OsfControlPageStatus.Ready)t.notifyAgave(u.AgaveHostAction.TabIn);else{var n="_trySetFocusInAppContent$newCallback";if(t._notifyHostIFrameOnLoaded&&t._notifyHostIFrameOnLoaded.newCallbackIdentity&&t._notifyHostIFrameOnLoaded.newCallbackIdentity===n)return;var r=function(e){return function(){if(e)try{e()}catch(e){}t.getStatus()===u.OsfControlStatus.Activated&&t.getPageStatus()===u.OsfControlPageStatus.Ready&&t.notifyAgave(u.AgaveHostAction.TabIn),t._notifyHostIFrameOnLoaded=e}}(t._notifyHostIFrameOnLoaded);r.newCallbackIdentity=n,t._notifyHostIFrameOnLoaded=r}},Ie=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(we(e)){var o=ae[e][0];if(o&&o.div)if(o.iframeNotificationUrl!=P){var i=o.div.getElementsByClassName(ie)[0];i&&(i.contentWindow.postMessage(u.AgaveHostAction.TabIn,oe),re._notifyHost&&re._notifyHost(e,u.AgaveHostAction.SelectWithError))}else{var a=o.div.querySelectorAll(n);if(a&&a.length>0){var s=a[0];s instanceof HTMLElement&&(window.focus(),s.focus(),re._notifyHost&&re._notifyHost(e,u.AgaveHostAction.SelectWithError))}}}else r.notifyAgave(t)},xe=function(e,t){var r=re.getOsfControl(e);if(r&&r._controlFocus)if(we(e)){var o=ae[e][0];if(o&&o.div){var i=o.div.querySelectorAll(n);if(i&&i.length>0){var a=i.length>1?i[1]:i[0];a instanceof HTMLElement&&(window.focus(),a.focus(),re._notifyHost&&re._notifyHost(e,u.AgaveHostAction.SelectWithError))}}}else r._controlFocus=c,re._notifyHost(e,t)},Ee=function(e){if(e.notificationType!==u.NotificationType.TrustPromptContent&&e.notificationType!==u.NotificationType.TrustPromptTaskpane)if(null==e.detailView||e.detailView===c)e.sqmDWords[1]=0,fe(e);else{e.sqmDWords[1]=1;var t=f.HostFeatureEnabledInfo.getHostFeatureEnabledInfo();t&&t.enableSingleSignOnForAddin?me(e):pe(e)}else he(e)},Te=function(e){if(we(e)){var t=ae[e][0];Ee(t)}else _e(e)},we=function(e){return ae[e]&&ae[e].length>0};return{showProgress:function(e,n){try{if(u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderLoadingAnimationStart),!document.getElementById(t+n)){ae[n]=[];var r=document.createElement(Q);r.setAttribute(X,K),r.setAttribute(q,t+n),r.style.backgroundColor="rgba(255, 255, 255, 0.5)",r.style.opacity=L,r.style.filter=F,r.style.height=R;var o=document.createElement(Q);o.style.width=R,o.style.height=R,o.style.backgroundImage=B+re.getLocalizedImageFilePath(te)+")",o.style.backgroundRepeat=D,o.style.backgroundPosition=N,r.appendChild(o),e.appendChild(r)}u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(e){}},showNotification:function(e){e.sqmDWords=[e.errorCode,0],delete e.errorCode,null==e.highPriority&&(e.highPriority=e.infoType===u.InfoType.Error?o:c),null==e.reDisplay&&(e.reDisplay=e.infoType===u.InfoType.Error?o:c);var t=ae[e.id];void 0===t&&(t=[],ae[e.id]=t),e.highPriority===c?t.push(e):(t.splice(se,0,e),se++),(1===ae[e.id].length||e.highPriority)&&Ee(t[0])},showICon:function(e){fe(e)},removeDOMElement:function(e){ue(e)},removeProgressDiv:function(e,n){u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveLoadingAnimationStart),e.ownerDocument.getElementById(t+n)&&ce(e),u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(e){!function(e){u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveStage1Start),ue("icon_"+e),u.OUtil.writeProfilerMark(u.NotificationUxPerfMarker.RemoveStage1End)}(e)},removeInfoBarDiv:function(e,t){le(e,t)},dismissMessages:function(e){!function(e){if(ae[e]){if(ae[e].length>0){var t=ae[e][0].div;ce(t)}delete ae[e]}}(e)},getHTMLEncodedString:function(e){return function(e){var t=document.createElement(Q),n=document.createTextNode(e);return t.appendChild(n),t.innerHTML}(e)},purgeOsfControlNotification:function(e){var t=ae[e],n=re.getOsfControl(e);t&&t.length>0&&n&&s.AppNotificationHelper.LogNotification(e,t[0].sqmDWords[0],t[0].sqmDWords[1])},focusOnNotificationUx:function(e,t){Ae(e),Ie(e,t)},focusOnNotificationUxShiftIn:function(e,t){Ae(e),xe(e,t)},appHasNotifications:function(e){return we(e)}}},function(e){var t,n="web",r="default";!function(e){e[e[r]=0]=r,e[e[n]=1]=n,e[e.windows=2]="windows",e[e.mac=3]="mac"}(t||(t={}));var o=function(){var o="resources.default",i="resources",a="string",c=null;function l(){}return l.ensureFinalExtendedOverridesUrls=function(t,n){var r=t.getExtendedOverrides();r.hasFinalUrls||(r.url=e.ExtendedManifestUtility.ensureFinalExtendedOverridesUrl(t.getExtendedOverrides().url,t,n),t.getExtendedOverrides().resourcesUrl&&(r.resourcesUrl=e.ExtendedManifestUtility.ensureFinalExtendedOverridesUrl(t.getExtendedOverrides().resourcesUrl,t,n)),r.hasFinalUrls=r.url&&(r.resourcesUrl||!t.getExtendedOverrides().resourcesUrl))},l.ensureFinalExtendedOverridesUrl=function(e,t,n){var r=l.computeUrlTokens(t,n),o=l.substituteUrlTokens(e,r),i=u.OUtil.parseUrl(o);return i.protocol&&i.hostname&&i.host&&i.pathname?o:(s.RuntimeTelemetryHelper.LogCommonMessageTag("Invalid ExtendedOverrides Url",c,570828176),c)},l.computeUrlTokens=function(e,t){for(var n=e.getExtendedOverridesTokens(),r={},o=0;o<n.length;++o)n[o].type==u.ExtendedManifestSupportTokens.Requirements?r[n[o].name]=l.computeRequirementsToken(n[o],t):n[o].type==u.ExtendedManifestSupportTokens.Locale?r[n[o].name]=l.computeLocaleToken(n[o],t):r[n[o].name]=n[o].defaultValue;return r},l.computeRequirementsToken=function(e,t){for(var n=e.defaultValue,r=e.overrides,o=0;o<r.length;++o)t._requirementsChecker._checkSets(r[o].data.sets)&&t._requirementsChecker._checkMethods(r[o].data.methods)&&(n=r[o].value);return n},l.computeLocaleToken=function(e,t){for(var n=e.defaultValue.toLowerCase(),r=t.getAppUILocale().toLowerCase(),o=r.replace(/-.+/,"-*"),i=e.overrides,a=0;a<i.length;++a){var s=i[a];if(r==s.data){n=s.value;break}o==s.data&&(n=s.value)}return n},l.substituteUrlTokens=function(e,t){return e.replace(new RegExp(u.ExtendedManifestSupportTokens.TokenReplaceRegex,"g"),(function(e,n,r,o){return l.substituteMatchWithTokenValue(e,n,r,o,t)}))},l.downloadContent=function(t){return new Promise((function(n,r){u.OUtil.xhrGet(t,(function(o){o?n(o):r(new e.OsfRuntimeError(e.OsfRuntimeErrorCode.downloadError,"No content downloaded from "+t))}),(function(e){r(e)}))}))},l.substituteMatchWithResourceValue=function(t,n,r,o){if(r&&"object"==typeof r[n])return r[n].value;if(o&&"object"==typeof o[n])return o[n].value;throw s.RuntimeTelemetryHelper.LogExceptionTag("Missing Extended Manifest Resource Token value",c,c,573125021),new e.OsfRuntimeError(e.OsfRuntimeErrorCode.tokenError,"Missing Extended Manifest Resource token value")},l.replaceResourceTokens=function(e,t,n){var r=new RegExp(u.ExtendedManifestSupportTokens.ResourceTokenRegEx);return e.replace(r,(function(e,r){return l.substituteMatchWithResourceValue(e,r,t,n)}))},l.constructExtendedManifest=function(e,t){var o=void 0;e.resources&&(o=e.resources[r]);var i=e.shortcuts,a=e.actions;if(i)for(var u=0;u<i.length;u++)i[u].key[n]&&(i[u].key[n]=l.replaceResourceTokens(i[u].key[n],t,o)),i[u].key[r]&&(i[u].key[r]=l.replaceResourceTokens(i[u].key[r],t,o)),!i[u].key[r]&&!i[u].key[n]&&s.RuntimeTelemetryHelper.LogExceptionTag("Error: No valid platform for shortcut",c,c,c);if(a)for(u=0;u<a.length;u++)a[u].name=l.replaceResourceTokens(a[u].name,t,o);return{shortcuts:i,actions:a}},l.substituteMatchWithTokenValue=function(t,n,r,o,i){var u="Missing ExtendedOverrides Token value";if(typeof i[n]===a)return i[n];throw s.RuntimeTelemetryHelper.LogExceptionTag(u,c,c,573125020),new e.OsfRuntimeError(e.OsfRuntimeErrorCode.tokenError,u)},l.validateExtendedOverrides=function(t){var n,a=[],l=t.resources,d=t.shortcuts,f=t.actions,p=new RegExp(u.ExtendedManifestSupportTokens.ResourceTokenRegEx),m=new RegExp(".*\\$\\{resource\\.([A-Za-z0-9_-]+)\\}.*"),h=e.ExtendedManifestUtility.validateShortcuts(d,p,m),g=e.ExtendedManifestUtility.validateActions(f,p,m,h.neededActionIds);if(a=h.errors.concat(g.errors),n=h.tokens.concat(h.tokens),h.needsResources&&g.needsResources)if(l)if(Object.keys(l).length>1&&a.push(e.ExtendedManifestValidationErrorMessages.invalidProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,i,"1 locale",Object.keys(l).length+" locales")),l[r]){var v=e.ExtendedManifestUtility.validateExtendedOverridesResources(l[r],n,!1);a=a.concat(v)}else a.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,o));else a.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,i));return a.length>0&&s.RuntimeTelemetryHelper.LogExceptionTag("Invalid extended manifest",c,c,573125019),{errors:a,tokens:n,needsResources:!1}},l.validateShortcuts=function(n,r,o){var i="shortcuts[",s=[],c=!1,l=[],d={};if(n)for(var f=0;f<n.length;++f)if(n[f].action?d[n[f].action]=!0:s.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,i+f+"].action")),n[f].key)for(var p in n[f].key)p in t?r.test(n[f].key[p])?(l.push(n[f].key[p]),c=!0):o.test(n[f].key[p])?s.push(e.ExtendedManifestValidationErrorMessages.invalidValue(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,i+f+"].key."+p,n[f].key[p])):typeof n[f].key[p]!==a&&s.push(e.ExtendedManifestValidationErrorMessages.invalidType(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,i+f+"].key.",a,typeof n[f].key[p])):s.push(e.ExtendedManifestValidationErrorMessages.invalidValue(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,i+f+"].key",p));else s.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,i+f+"].key"));return{errors:s,tokens:l,needsResources:c,neededActionIds:d}},l.validateActions=function(t,n,r,o){var i="].name",s="Extended Manifest",c="].id",l="actions[",d=[],f=[],p=!1,m={};if(t)for(var h=0;h<t.length;++h)t[h].id?((t[h].id.length>u.ExtendedManifestSupportTokens.ActionIdMaxLength||t[h].id.length<1)&&d.push(e.ExtendedManifestValidationErrorMessages.invalidLength(s,l+h+c,u.ExtendedManifestSupportTokens.ActionIdMaxLength)),o[t[h].id]&&delete o[t[h].id],m[t[h].id]?d.push(e.ExtendedManifestValidationErrorMessages.duplicateValue(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,l+h+c,t[h].id)):m[t[h].id]=!0):d.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,l+h+c)),t[h].type||(t[h].type="ExecuteFunction"),t[h].name?t[h].name.length>u.ExtendedManifestSupportTokens.ActionNameMaxLength||t[h].name.length<1?d.push(e.ExtendedManifestValidationErrorMessages.invalidLength(s,l+h+i,u.ExtendedManifestSupportTokens.ActionNameMaxLength)):n.test(t[h].name)?(f.push(t[h].name),p=!0):r.test(t[h].name)?d.push(e.ExtendedManifestValidationErrorMessages.invalidValue(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,l+h+i,t[h].name)):typeof t[h].name!==a&&d.push(e.ExtendedManifestValidationErrorMessages.invalidType(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,l+h+i,a,typeof t[h].name)):d.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,l+h+i));for(var g=Object.keys(o),v=0;v<g.length;v++)d.push(e.ExtendedManifestValidationErrorMessages.actionNotFound(g[v]));return{errors:d,tokens:f,needsResources:p}},l.validateExtendedOverridesResources=function(t,n,r){var a=[];if(!t)return a;for(var l=Object.keys(t),d=new RegExp(u.ExtendedManifestSupportTokens.ResourceTokenRegEx),f=0,p=n;f<p.length;f++){var m=p[f],h=d.exec(m)[1],g=t[h];g?g.value||(r?a.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestResourcesLoggingPrefix,"resources["+l.indexOf(h)+"].value")):a.push(e.ExtendedManifestValidationErrorMessages.missingRequiredProperty(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,"resources.default["+l.indexOf(h)+"].value"))):r?a.push(e.ExtendedManifestValidationErrorMessages.missingRequiredValue(u.ExtendedManifestSupportTokens.ExtendedManifestResourcesLoggingPrefix,i,m)):a.push(e.ExtendedManifestValidationErrorMessages.missingRequiredValue(u.ExtendedManifestSupportTokens.ExtendedManifestLoggingPrefix,o,m))}return a.length>0&&s.RuntimeTelemetryHelper.LogExceptionTag("Invalid extended manifest resources",c,c,573125018),a},l.validateAndSubstituteExtendedManifestTokens=function(t,n){var r=e.ExtendedManifestUtility.validateExtendedOverrides(t),o=e.ExtendedManifestUtility.validateExtendedOverridesResources(n,r.tokens,!0),i=r.errors.concat(o);if(0==i.length)return e.ExtendedManifestUtility.constructExtendedManifest(t,n);throw new e.OsfMultiError(e.OsfRuntimeErrorCode.invalidExtendedOverride,i)},l.getPlatformName=function(){var t=navigator.userAgent;return t.indexOf("Windows")>=0||t.indexOf("CrOS")>=0||t.indexOf("SunOS")>=0||t.indexOf("Linux")>=0?e.ShortcutsMappingTableManager.s_shortcutPlatformWin32:t.indexOf("Macintosh")>=0||t.indexOf("Mac OS X")>=0?e.ShortcutsMappingTableManager.s_shortcutPlatformMac:(s.RuntimeTelemetryHelper.LogCommonMessageTag("Unknown platform or operating system, the userAgent info is: "+t,c,572610773),c)},l}();e.ExtendedManifestUtility=o}(f||(f={})),function(e){var t=function(){var e=", expected = ",t=", value = ",n="[";function r(){}return r.missingRequiredProperty=function(e,t){return n+e+"] [Parsing] [Missing Required Property] property = "+t},r.invalidValue=function(e,r,o){return n+e+"] [Parsing] [Invalid Value] property = "+r+t+o},r.invalidType=function(r,o,i,a){return n+r+"] [Parsing] [Invalid Type] property = "+o+e+i+t+a},r.invalidProperty=function(r,o,i,a){return n+r+"] [Parsing] [Invalid Property] property = "+o+e+i+t+a},r.missingRequiredValue=function(t,r,o){return n+t+"] [Parsing] [Missing Required Value] property = "+r+e+o},r.actionNotFound=function(e){return"[Extended Manifest] [Parsing] [Action Not Found] Unable to find the action with id: "+e},r.duplicateValue=function(e,r,o){return n+e+"] [Parsing] [Duplicate Value] property = "+r+t+o},r.invalidLength=function(e,t,r){return n+e+"] [Parsing] [Invalid Length] "+t+" must be between 1 and "+r+" characters long"},r}();e.ExtendedManifestValidationErrorMessages=t}(f||(f={})),function(e){var t=function(){function e(){}return e.setHostFeatureEnabledInfo=function(e){this._hostFeatureEnabledInfo=e},e.getHostFeatureEnabledInfo=function(){return this._hostFeatureEnabledInfo},e}();e.HostFeatureEnabledInfo=t}(f||(f={})),function(e){var t=null,n="catch",r=function(){function e(){}return e.prototype.get=function(e,r){return this.openTransaction(e).then((function(t){return new Promise((function(n,o){var i=t.objectStore(e).get(r);i.onsuccess=function(e){var t=e.target.result;n(t)},i.onerror=function(e){o(e)}}))}))[n]((function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data from indexedDB",e,t,554256611),e}))},e.prototype.set=function(e,r,o){return this.openTransaction(e).then((function(t){return new Promise((function(n,i){var a=t.objectStore(e).put(o,r);a.onsuccess=function(){n()},a.onerror=function(e){i(e)}}))}))[n]((function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("failed to set data into indexedDB",e,t,554256610),e}))},e.prototype.remove=function(e,r){return this.openTransaction(e).then((function(t){return new Promise((function(n,o){var i=t.objectStore(e).delete(r);i.onsuccess=function(){n()},i.onerror=function(e){o(e)}}))}))[n]((function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("failed to remove data from indexedDB",e,t,554256609),e}))},e.prototype.openDB=function(e){var r=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.indexedDB;return new Promise((function(t,n){var o=r.open(e);o.onupgradeneeded=function(){var t=o.result;!t.objectStoreNames.contains(e)&&t.createObjectStore(e)},o.onsuccess=function(){var e=o.result;t(e)},o.onerror=function(e){n(e)}}))[n]((function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("failed to open indexedDB",e,t,554256608),e}))},e.prototype.openTransaction=function(e){return this.openDB(e).then((function(t){return t.transaction(e,"readwrite")}))[n]((function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("failed to open transaction",e,t,554256607),e}))},e}(),o=function(){function e(){}return e.prototype.get=function(e,t){var n=localStorage.getItem(e.concat("_",t));return Promise.resolve(n)},e.prototype.set=function(e,t,n){return localStorage.setItem(e.concat("_",t),n),Promise.resolve()},e.prototype.remove=function(e,t){return localStorage.removeItem(e.concat("_",t)),Promise.resolve()},e}(),i=function(){var e="undefined",i="The browser does not support Web Storage";function a(){this.indexedDB=window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB||window.indexedDB}return a.get=function(e,r){var o=this.getOrCreateOsfCache();return o?o.get(e,r)[n]((function(e){return s.RuntimeTelemetryHelper.LogExceptionTag("failed to get data from osfCache",e,t,554256606),Promise.resolve(t)})):(s.RuntimeTelemetryHelper.LogCommonMessageTag(i,t,573125017),Promise.resolve(t))},a.set=function(e,r,o){var a=this.getOrCreateOsfCache();return a?a.set(e,r,o)[n]((function(e){return s.RuntimeTelemetryHelper.LogExceptionTag("failed to set data into osfCache",e,t,554256605),Promise.resolve(t)})):(s.RuntimeTelemetryHelper.LogCommonMessageTag(i,t,573125016),Promise.resolve(t))},a.remove=function(e,r){var o=this.getOrCreateOsfCache();return o?o.remove(e,r)[n]((function(e){return s.RuntimeTelemetryHelper.LogExceptionTag("failed to remove data frome osfCache",e,t,554256604),Promise.resolve(t)})):(s.RuntimeTelemetryHelper.LogCommonMessageTag(i,t,572926163),Promise.resolve(t))},a.isIndexedDBSupported=function(){return!u.OUtil.getBooleanSetting("IsSafariWithIndexedDBDisabled")&&(typeof indexedDB!=e&&"function"==typeof indexedDB.open)},a.getOrCreateOsfCache=function(){return a.instance==t&&(a.isIndexedDBSupported()?a.instance=new r:typeof localStorage!=e&&(a.instance=new o)),a.instance},a.c_osfCacheTableName="OSF.Cache",a.c_extendedManifestTableName="OSF.ExtendedManifest",a.c_extendedManifestResourcesTableName="OSF.ExtendedManifestResources",a}();e.OsfCache=i}(f||(f={})),u.OUtil.setNamespace("AppSpecificSetup",u),u.ContextActivationManager=function(e){var t="0",n="osfControl for the given ID doesn't exist.",r="object",o="DevConsoleEnabled",i="IsReactMLR",a="string",l=null,d=!0,p=!1,m=this,h=m;if(u.OUtil.validateParamObject(e,{appName:{type:Number,mayBeNull:p},appVersion:{type:String,mayBeNull:p},clientMode:{type:Number,mayBeNull:p},appUILocale:{type:String,mayBeNull:p},dataLocale:{type:String,mayBeNull:p},osfOmexBaseUrl:{type:String,mayBeNull:d},devCatalogUrl:{type:String,mayBeNull:d},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:d},sdxCdnUrl:{type:String,mayBeNull:d},sdxDmsUrl:{type:String,mayBeNull:d},spBaseUrl:{type:String,mayBeNull:d},docUrl:{type:String,mayBeNull:d},hostControl:{type:Object,mayBeNull:d},pageBaseUrl:{type:String,mayBeNull:d},lcid:{type:String,mayBeNull:d},formFactor:{type:String,mayBeNull:d},controlStatusChanged:{type:Object,mayBeNull:d},notifyHost:{type:Object,mayBeNull:d},allowExternalMarketplace:{type:Boolean,mayBeNull:d},localizedScriptsUrl:{type:String,mayBeNull:d},localizedImagesUrl:{type:String,mayBeNull:d},localizedStylesUrl:{type:String,mayBeNull:d},localizedResourcesUrl:{type:String,mayBeNull:d},trustAgaves:{type:Boolean,mayBeNull:d},enableAddinCommands:{type:Boolean,mayBeNull:d},enableBlackForestRedirect:{type:Boolean,mayBeNull:d},enableMyOrg:{type:Boolean,mayBeNull:d},enableMyApps:{type:Boolean,mayBeNull:d},enableDevCatalog:{type:Boolean,mayBeNull:d},enableOneDriveCatalog:{type:Boolean,mayBeNull:d},enablePrivateCatalog:{type:Boolean,mayBeNull:d},enableTaskpaneUpgradeToAppCommand:{type:Boolean,mayBeNull:d},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:d},enableV1RedirectApis:{type:Boolean,mayBeNull:d},omexForceAnonymous:{type:Boolean,mayBeNull:d},userNameHashCode:{type:Number,mayBeNull:d},hostFullVersion:{type:String,mayBeNull:d},envCode:{type:String,mayBeNull:d},showSignOutFromPrivateCatalogMessage:{type:Boolean,mayBeNull:d},enableSingleSignOnForAddin:{type:Boolean,mayBeNull:d},firstPartySingleSignOnWhitelist:{type:String,mayBeNull:d},enableServiceDeliveredExperience:{type:Boolean,mayBeNull:d},hideAppsExtensionUrl:{type:String,mayBeNull:d},enableInsertDialogAccessibilityFix:{type:Boolean,mayBeNull:d},disableLogging:{type:Boolean,mayBeNull:d},enableDisplayBlockedMinorError:{type:Boolean,mayBeNull:d},enableFirstPartySSO:{type:Boolean,mayBeNull:d},disableAppsForOfficeThirdParty:{type:Boolean,mayBeNull:d},wacSessionId:{type:String,mayBeNull:d},enableFirstPartySDXErrorMessages:{type:Boolean,mayBeNull:d},isHostDocumentDomain:{type:Boolean,mayBeNull:d},enableRichApiCellEditDelay:{type:Boolean,mayBeNull:d},wopiHostOriginFromPostMessage:{type:String,mayBeNull:d},wopiHostOriginFromWacPropBag:{type:String,mayBeNull:d},"wacIsEmbedded ":{type:Boolean,mayBeNull:d},"accessibilityAllowFocusAddinTaskpane ":{type:Boolean,mayBeNull:d},disableMicrophonePermission:{type:Boolean,mayBeNull:d},agaveAddinUploadEnabled:{type:Boolean,mayBeNull:d},featureGateFlag:{type:Number,mayBeNull:d},isReactRibbonEnabled:{type:Boolean,mayBeNull:d},enableDisplayUILocaleQueryString:{type:Boolean,mayBeNull:d},isSafariWithIndexedDBDisabled:{type:Boolean,mayBeNull:d},enableCustomShortcuts:{type:Boolean,mayBeNull:d}},l),m._osfOmexBaseUrl=e.osfOmexBaseUrl,m._devCatalogUrl=e.devCatalogUrl,m._sdxCdnUrl=e.sdxCdnUrl,m._sdxDmsUrl=e.sdxDmsUrl,m._firstPartyManifestCDNUrl=e.firstPartyManifestCDNUrl,m._oneDriveCatalogBaseApiUrl=e.oneDriveCatalogBaseApiUrl,m._spBaseUrl=e.spBaseUrl,m._myOrgCatalogUrl=l,m._enableAddinCommands=e.enableAddinCommands||p,m._enableBlackForestRedirect=e.enableBlackForestRedirect||p,m._enableInsertDialogAccessibilityFix=e.enableInsertDialogAccessibilityFix||p,m._enableFirstPartySDXErrorMessages=e.enableFirstPartySDXErrorMessages||p,m._enableMyOrg=e.enableMyOrg||p,m._enableMyApps=e.enableMyApps||p,m._enableDevCatalog=e.enableDevCatalog||p,m._enableOneDriveCatalog=e.enableOneDriveCatalog||p,m._enablePrivateCatalog=e.enablePrivateCatalog||p,m._showSignOutFromPrivateCatalogMessage=e.showSignOutFromPrivateCatalogMessage||p,m._enableTaskpaneUpgradeToAppCommand=e.enableTaskpaneUpgradeToAppCommand||p,m._enableUploadFileDevCatalog=e.enableUploadFileDevCatalog||p,m._enableV1RedirectApis=e.enableV1RedirectApis||p,m._appName=e.appName,m._appVersion=e.appVersion,m._clientMode=e.clientMode,m._appUILocale=e.appUILocale,m._dataLocale=e.dataLocale,m._docUrl=e.docUrl,m._hostControl=e.hostControl,m._formFactor=e.formFactor||u.FormFactor.Default,m._pageBaseUrl=e.pageBaseUrl,m._lcid=e.lcid,m._controlStatusChanged=e.controlStatusChanged,m._notifyHost=e.notifyHost||function(){},m._allowExternalMarketplace=e.allowExternalMarketplace,m._localizedScriptsUrl=e.localizedScriptsUrl,m._localizedImagesUrl=e.localizedImagesUrl,m._localizedStylesUrl=e.localizedStylesUrl,m._localizedResourcesUrl=e.localizedResourcesUrl,m._autoTrusted=e.trustAgaves,m._omexForceAnonymous=e.omexForceAnonymous||p,m._userNameHashCode=e.userNameHashCode||0,m._hostFullVersion=e.hostFullVersion,m._wacHostEnvironment=e.envCode,m._enableSingleSignOnForAddin=e.enableSingleSignOnForAddin||p,m._enableFirstPartySSO=e.enableFirstPartySSO||p,m._enableServiceDeliveredExperience=e.enableServiceDeliveredExperience||d,m._hideAppsExtensionUrl=m._osfOmexBaseUrl+e.hideAppsExtensionUrl,m._disableLogging=e.disableLogging||p,m._enableDisplayBlockedMinorError=e.enableDisplayBlockedMinorError||p,m._disableAppsForOfficeThirdParty=e.disableAppsForOfficeThirdParty||p,m._isHostDocumentDomain=e.isHostDocumentDomain||p,m._enableRichApiCellEditDelay=e.enableRichApiCellEditDelay||p,m._loggableUserId=e.loggableUserId,m._sessionStartInfoJson=e.sessionStartInfoJson,m._firstPartySingleSignOnWhitelist=e.firstPartySingleSignOnWhitelist,m._wopiHostOriginFromPostMessage=e.wopiHostOriginFromPostMessage,m._wopiHostOriginFromWacPropBag=e.wopiHostOriginFromWacPropBag,m._wacIsEmbedded=e.wacIsEmbedded,m._enableWopiHostCheck=e.isHostFrameTrustCheckEnabledForAddIns||p,m._enableUpnCheck=e.isUpnCheckEnabled||p,m._wacUpn=e.wacUpn,m._hostInstallAddInsIsEnabled=e.hostInstallAddInsIsEnabled||p,m._approvedAddIns=e.approvedAddIns,m._hostInstallAddIns=e.hostInstallAddIns,m._accessibilityAllowFocusAddinTaskpane=e.accessibilityAllowFocusAddinTaskpane,m._disableMicrophonePermission=e.disableMicrophonePermission||p,m._oAuthManager=l,m._agaveAddinUploadEnabled=e.agaveAddinUploadEnabled||p,m._isHostFrameTrusted=e.isHostFrameTrusted||u.HostFrameTrustState.NotInitialized,m._hostFeatureGateFlag=e.hostFeatureGateFlag||u.HostFeatureGateFlags.None,m._isReactRibbonEnabled=e.isReactRibbonEnabled||p,m._enableDisplayUILocaleQueryString=e.enableDisplayUILocaleQueryString||p,m._enableSetFocusOnTaskpaneOnUserAction=e.enableSetFocusOnTaskpaneOnUserAction||p,m._isSafariWithIndexedDBDisabled=e.isSafariWithIndexedDBDisabled,m._enableCustomShortcuts=e.enableCustomShortcuts,m._enable3rdPartySetAppContextInIframeName=m._hostFeatureGateFlag&u.HostFeatureGateFlags.Enable3rdPartySetAppContextInIFrameName,m._appSettings=e.appSettings||{},m._singleSignOnSettings=e.singleSignOnSettings||{},m._flightingTreatmentVariables=e.flightingTreatmentVariables||{},m.getBooleanAppSetting=function(e,t){var n=e&&t&&void 0!==e[t]&&e[t]&&(typeof e[t]===a&&"TRUE"===e[t].toUpperCase()||"boolean"==typeof e[t]&&e[t]);return void 0!==n?n:p},m.addAppSettingAsFlights=function(e,t,n){this.getBooleanAppSetting(e,t)&&u.OUtil.pushFlight(n)},m._enableWopiHostCheck=m._enableWopiHostCheck||m.getBooleanAppSetting(m._appSettings,"WopiHostCheckForAddinsIsEnabled"),m._hostAllowedSdxEmbedding=e.hostAllowedSdxEmbedding||p,m._hostAllowedOfficeStore=e.hostAllowedOfficeStore||p,m._enableWopiHostCheck||(m._hostAllowedSdxEmbedding=d,m._hostAllowedOfficeStore=d),m._upnCheckResult=u.UpnCheckCode.NotSet,f.HostFeatureEnabledInfo.setHostFeatureEnabledInfo(e),m._pageBaseUrl&&"/"!==m._pageBaseUrl.charAt(m._pageBaseUrl.length-1)&&(m._pageBaseUrl=m._pageBaseUrl+"/"),m._localizedResourcesUrl&&"/"!==m._localizedResourcesUrl.charAt(m._localizedResourcesUrl.length-1)&&(m._localizedResourcesUrl=m._localizedResourcesUrl+"/"),m._clientId=u.OUtil.getUniqueId(),m._cachedOsfControls={},m._notReadyOsfControls={},m._notReadyOsfControlsIndex=0,m._iframeAttributeBag={},m._serviceEndPoint=l,m._serviceEndPointInternal=l,m._internalConversationId=l,m._iframeProxies={},m._iframeProxyCount=0,m._iframeNamePrefix="__officeExtensionProxy",m._webUrl=l,m._wsa=l,m._insertDialogDiv=l,m._hasPreloadedOfficeJs=p,m._contextMgrCorrelationId=e.wacSessionId||u.OUtil.Guid.generateNewGuid(),s.RuntimeTelemetryHelper.LogCommonMessageTag("_contextMgrCorrelationId :"+m._contextMgrCorrelationId,l,20194265),s.RuntimeTelemetryHelper.LogCommonMessageTag("ContextActivationManager Constructor isHostFrameTrusted param:"+e.isHostFrameTrusted,m._contextMgrCorrelationId,572926162),s.RuntimeTelemetryHelper.LogCommonMessageTag("Host is enabled to install AddIns provided by host:"+m._hostInstallAddInsIsEnabled,m._contextMgrCorrelationId,572926161),s.RuntimeTelemetryHelper.LogCommonMessageTag("Host is enabled to use AddIns:"+m._hostAllowedSdxEmbedding,m._contextMgrCorrelationId,571736203),s.RuntimeTelemetryHelper.LogCommonMessageTag("Host is enabled to install AddIns provided by Office Store:"+m._hostAllowedOfficeStore,m._contextMgrCorrelationId,571736202),m._hostType=l,m._hostPlatform=l,m._hostSpecificFileVersion=l,m._requirementsChecker=new u.RequirementsChecker,m._onClickInstallOsfControl=l,m._osfOmexBaseUrl){var g,v=m._osfOmexBaseUrl.indexOf(u.Constants.ProtocolSeparator);g=v>=0?m._osfOmexBaseUrl.substr(v):u.Constants.ProtocolSeparator+m._osfOmexBaseUrl;var y=u.Constants.Https+g,b=u.Constants.Https+g;u.OUtil.getQueryStringParamValue(window.location.search,u.Constants.OmexForceAnonymousParamName).toLowerCase()==u.Constants.OmexForceAnonymousParamValue.toLowerCase()?(m._omexAuthNStatus=u.OmexAuthNStatus.Anonymous,m._omexForceAnonymous=d):m._omexAuthNStatus=u.OmexAuthNStatus.NotAttempted,m._omexGatedWSProxy={proxyUrl:y+u.Constants.OmexGatedServiceExtension,proxyName:u.Constants.OmexGatedServiceName,isReady:p,clientEndPoint:l,pendingCallbacks:[]},m._omexWSProxy={proxyUrl:b+u.Constants.OmexUnGatedServiceExtension,proxyName:u.Constants.OmexUnGatedServiceName,isReady:p,clientEndPoint:l,pendingCallbacks:[]},m._omexAnonymousWSProxy={proxyUrl:y+u.Constants.OmexAnonymousServiceExtension,proxyName:u.Constants.OmexAnonymousServiceName,isReady:p,clientEndPoint:l,pendingCallbacks:[]},m._omexBillingMarket=l,m._omexEndPointBaseUrl=b}function O(e,t){try{return JSON.parse(e)[t].toLowerCase()}catch(e){return}}var S=O(e.sessionStartInfoJson,"AudienceGroup"),C=parseInt(O(e.sessionStartInfoJson,"Ring")),A=O(e.sessionStartInfoJson,"SessionOrigin");"automation"!==S&&"bluechicken"!==A&&("number"!=typeof C||C>=-2)&&u.OUtil.pushFlight(u.FlightNames.AddinEnforceHttps),m._enableSetFocusOnTaskpaneOnUserAction&&u.OUtil.pushFlight(u.FlightNames.SetFocusToTaskpaneIsEnabled),m._enableDisplayUILocaleQueryString=m._enableDisplayUILocaleQueryString||m.getBooleanAppSetting(m._appSettings,"DisplayUILocaleQueryStringIsEnabled"),m._agaveAddinUploadEnabled=m._agaveAddinUploadEnabled||m.getBooleanAppSetting(m._appSettings,"AgaveAddinUploadEnabled"),m._uiHostSupportsAuthTokenAddinList=m._singleSignOnSettings?m._singleSignOnSettings.UiHostSupportsAuthTokenAddinList:l,m.addAppSettingAsFlights(m._appSettings,"AddinRibbonIdAllowUnknown",u.FlightNames.AddinRibbonIdAllowUnknown),m.addAppSettingAsFlights(m._appSettings,"AddinActionDefinitionHybridMode",u.FlightNames.AddinActionDefinitionHybridMode),m.addAppSettingAsFlights(m._appSettings,"ManifestParserDevConsoleEnabled",u.FlightNames.ManifestParserDevConsoleLog),m.addAppSettingAsFlights(m._appSettings,"UseActionIdForUILessCommand",u.FlightNames.UseActionIdForUILessCommand),m.addAppSettingAsFlights(m._appSettings,"RequirementSetRibbonApiOnePointTwo",u.FlightNames.RequirementSetRibbonApiOnePointTwo),m.addAppSettingAsFlights(m._appSettings,"ShortcutInfoArrayInUserPreferenceData",u.FlightNames.ShortcutInfoArrayInUserPreferenceData);for(var _=u.TestFlightStart;_<=u.TestFlightEnd;_++){var I="OSFTestFlight"+_;m.addAppSettingAsFlights(m._appSettings,I,_)}var x=m._appSettings.FlightingTreatmentVariables;if(x){if(typeof x==a)try{x=JSON.parse(x)}catch(e){x={};s.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error parsing flightTreatmentsAppSettings JSON.",e,m._appCorrelationId,19203548)}}else x=m._appSettings.flightingTreatmentVariables||{};for(var E in u.FlightTreatmentNames){var T=u.FlightTreatmentNames[E];u.OUtil.getBooleanFromDictionary(x,T)&&u.OUtil.pushFlight(T)}if(u.OUtil.getValue(m._flightingTreatmentVariables["Microsoft.Office.OEP.FirstPartyAnonymousProxyReadyCheckTimeoutEnabled"],p)&&u.OUtil.pushFlight(u.FlightNames.FirstPartyAnonymousProxyReadyCheckTimeout),u.Settings.IsReactRibbonEnabled=m._isReactRibbonEnabled,u.Settings[i]=m.getBooleanAppSetting(m._appSettings,i),u.Settings.IsSafariWithIndexedDBDisabled=m._isSafariWithIndexedDBDisabled,u.Settings.EnableCustomShortcuts=m._enableCustomShortcuts,u.OUtil.checkFlight(u.FlightNames.ManifestParserDevConsoleLog)&&(u.Settings[o]=m.getBooleanAppSetting(m._appSettings,o)),"RibbonGroupIdMap"in u&&"RibbonGroupIdMapCommonMLR"in u)for(var w in u.RibbonGroupIdMap)u.RibbonGroupIdMapCommonMLR[w]=u.RibbonGroupIdMap[w];m._isFromWacAutomation=function(){if(void 0!==this._isFromWacAutomation&&this._isFromWacAutomation!==l)return this._isFromWacAutomation;try{for(var e=window,t=void 0;e!==t;){if(!e.location||!e.location.search)return p;if(e.location.search.toLowerCase().indexOf("automation=1")>=0)return d;t=e,e=e.parent}}catch(e){return p}return p}(),u.OsfManifestManager._setUILocale(m._appUILocale);var M=m;if(M.getContextForEmbeddingPage=function(){var e=0;if(M._hostSpecificFileVersion&&-1!=M._hostSpecificFileVersion.indexOf(".")){var t=M._hostSpecificFileVersion.split("."),n=t[1];isNaN(n)||(e=parseInt(t[1]))}var r=M._requirementsChecker._getSupportedSet();return{appName:M._appName,appVersion:M._appVersion,appUILocal:M._appUILocale,dataLocale:M._dataLocale,docUrl:M._docUrl||window.location.href,clientMode:M._clientMode,minorVersion:e,requirements:r}},m._enableServiceDeliveredExperience)var k=function(e){var t=e&&e.contextId?M.getOsfControl(e.contextId):l;switch(e.id){case u.MessageIDs.FetchBundleUrl:if(!t._agaveEndPoint){var n=t._conversationId+u.SharedConstants.NotificationConversationIdSuffix;t._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(n,t._frame.contentWindow,t._iframeUrl)}if(t._bundleUrl){var r={id:u.MessageIDs.LoadReactBundle,bundleUrl:t._bundleUrl};t.sendMessageToSdx(r)}break;case u.MessageIDs.LoadBundleSuccess:t._pageStatus=u.OsfControlPageStatus.Ready,t._contextActivationMgr._ErrorUXHelper&&t._contextActivationMgr._ErrorUXHelper.removeProgressDiv(t._div,t._id);break;case u.MessageIDs.LoadBundleError:break;default:c.msAjaxDebug.trace("MessageID: "+e.id+" onMessageFromSdx got wrong message.")}};var j=function(e){if(e.strUrl){var t=u.OUtil.parseUrl(e.strUrl);if(t&&("http:"==t.protocol||"https:"==t.protocol))return void window.open(e.strUrl,"",e.strWindowFeatures)}s.RuntimeTelemetryHelper.LogCommonMessageTag("Silent fail for window.open.",this._contextMgrCorrelationId,572926160)},P=function(e,t){e.hasOwnProperty("fromInsertDialog")&&!e.fromInsertDialog||M._insertDialogDiv!=l&&2==M._insertDialogDiv.childNodes.length&&M._insertDialogDiv.removeChild(M._insertDialogDiv.lastChild);var n,r=u.OUtil.Guid.generateNewGuid(),o=new f.InsertDialogTelemetryContext(r);u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?e.storeType==u.StoreTypeEnum.MarketPlace?n={storeType:u.StoreType.OMEX,storeId:M._osfOmexBaseUrl}:e.storeType==u.StoreTypeEnum.Catalog?n={storeType:u.StoreType.SPCatalog,storeId:M._myOrgCatalogUrl}:e.storeType==u.StoreTypeEnum.OneDrive&&(n={storeType:u.StoreType.OneDrive,storeId:M._oneDriveCatalogBaseApiUrl}):e.storeType==u.StoreTypeEnum.MarketPlace?n={storeType:u.StoreType.OMEX,storeLocator:M._osfOmexBaseUrl}:e.storeType==u.StoreTypeEnum.Catalog?n={storeType:u.StoreType.SPCatalog,storeLocator:M._myOrgCatalogUrl}:e.storeType==u.StoreTypeEnum.OneDrive&&(n={storeType:u.StoreType.OneDrive,storeLocator:M._oneDriveCatalogBaseApiUrl});var i=e.refresh,a={assetId:"",contentMarket:"",anonymous:p,clientEndPoint:l,clearCache:i,clearKilledApps:p,referenceInUse:n,hostType:M._hostType};if(e&&e.storeType==u.StoreTypeEnum.MarketPlace){a.clientVersion=M._getClientVersionForOmex(),a.clientVersion&&(a.clientName=M._getClientNameForOmex(),a.appVersion=M._getAppVersionForOmex());(d=f.CatalogFactory.resolve(u.StoreType.OMEX)).getEntitlementAsync(p,o,Function.createDelegate(M,(function(e){if(e.status==f.DataServiceResultCode.Succeeded&&e.value){for(var n,r=e.value,a=r.length,s={},c=[],p=0;p<a;p++)s[(n=r[p]).contentMarket]?s[n.contentMarket].push(n.assetId):s[n.contentMarket]=[n.assetId];i&&H(r),0===a&&t({errorCode:u.InvokeResultCode.S_OK});var m=0,h=function(e,n){if(e.status==f.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&e.value.length>0)for(var r=e.value,o=M.getRequirementsChecker(),i=0;i<r.length;i++){if(o.isEntitlementFromOmexSupported(r[i])){var s=[];s.push(r[i].name),s.push(r[i].assetId),s.push(r[i].description),s.push(u.OUtil.getTargetType(r[i].appSubType)),s.push(u.OUtil.normalizeAppVersion(r[i].version)),s.push(r[i].assetId),s.push(u.StoreType.OMEX),s.push(parseInt(r[i].defaultWidth)),s.push(parseInt(r[i].defaultHeight)),s.push(r[i].iconUrl),s.push(r[i].provider),s.push(n),s.push(u.StoreType.OMEX),s.push(r[i].webApplicationId),c.push(s)}m++}if(m===a){var l={value:c,errorCode:u.InvokeResultCode.S_OK};t(l)}},g=function(e,t){d.getAppDetails(e,t,o,(function(e){Function.createDelegate(M,h)(e,t)}),i)};for(var v in s)g(s[v],v)}else{var y={value:l,errorCode:u.InvokeResultCode.E_USER_NOT_SIGNED_IN};t(y)}})),i)}else if(e&&e.storeType==u.StoreTypeEnum.Catalog){var s=f.CatalogFactory.resolve(u.StoreType.SPCatalog);s.myOrgCatalogUrl=M._myOrgCatalogUrl;s.getEntitlementAsync(p,o,Function.createDelegate(M,(function(e){var r;if(u.OUtil.writeProfilerMark(u.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd),e.status==f.DataServiceResultCode.Succeeded&&e.value){for(var o,i=e.value,a=i.length,s=[],c=0,d=M.getRequirementsChecker(),p=0;p<a;p++)if(o=i[p],d.isEntitlementFromCorpCatalogSupported(o)){var m=[];m.push(o.Title),m.push(o.OfficeExtensionID),m.push(o.OfficeExtensionDescription),m.push(u.OfficeAppType[o.OEType]),m.push(u.OUtil.normalizeAppVersion(o.OfficeExtensionVersion)),m.push(o.OfficeExtensionID),m.push(u.StoreType.SPCatalog),m.push(parseInt(o.OfficeExtensionDefaultWidth.toString())),m.push(parseInt(o.OfficeExtensionDefaultHeight.toString())),m.push(o.OfficeExtensionIcon),m.push(o.OEProviderName),u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?m.push(n.storeId):m.push(n.storeLocator),m.push(u.StoreType.SPCatalog),s.push(m),c++}r=c>0?{value:s,errorCode:u.InvokeResultCode.S_OK}:{value:l,errorCode:u.InvokeResultCode.E_CATALOG_NO_APPS}}else r=!u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)&&!n.storeLocator||u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)&&!n.storeId?{value:l,errorCode:u.InvokeResultCode.E_CATALOG_NO_APPS}:{value:l,errorCode:u.InvokeResultCode.E_GENERIC_ERROR};t(r)})),i)}else if(e&&e.storeType==u.StoreTypeEnum.OneDrive){u.OsfManifestManager.getOneDriveEntitlementsAsync(a,(function(e){var n;e.statusCode===u.ProxyCallStatusCode.Succeeded&&e.value&&(n={value:e.value.entitlements,errorCode:u.InvokeResultCode.S_OK},t(n))}))}else if(e&&e.storeType==u.StoreTypeEnum.PrivateCatalog){var d;(d=f.CatalogFactory.resolve(u.StoreType.PrivateCatalog)).getEntitlementAsync(p,o,Function.createDelegate(M,(function(e){if(e.status!=f.DataServiceResultCode.Unauthenticated)if(e.status===f.DataServiceResultCode.Succeeded&&e.value){var n=e.value;if(0!==n.length){var r;r=n.map((function(e){return{ProductId:e.assetId,AddInState:e.addInState,Version:e.appVersion}}));var a=[];d.getAppDetails(r,"",o,Function.createDelegate(M,(function(e){if(e.status===f.DataServiceResultCode.Succeeded&&e.value&&e.value.length&&0!==e.value.length){for(var n=e.value,r=M.getRequirementsChecker(),o=0;o<n.length;o++)if(r.isEntitlementFromOmexSupported(n[o])){var i=[];i.push(n[o].name),i.push(n[o].assetId),i.push(n[o].description),i.push(u.OUtil.getTargetType(n[o].appSubType)),i.push(u.OUtil.normalizeAppVersion(n[o].version)),i.push(n[o].assetId),i.push(u.StoreType.PrivateCatalog),i.push(parseInt(n[o].defaultWidth)),i.push(parseInt(n[o].defaultHeight)),i.push(n[o].iconUrl),i.push(n[o].provider),i.push(u.StoreType.PrivateCatalog),i.push(u.StoreType.PrivateCatalog),a.push(i)}t({value:a,errorCode:u.InvokeResultCode.S_OK})}else t({value:l,errorCode:u.InvokeResultCode.E_CATALOG_REQUEST_FAILED})})),i)}else t({errorCode:u.InvokeResultCode.E_CATALOG_NO_APPS})}else t({value:l,errorCode:u.InvokeResultCode.E_CATALOG_REQUEST_FAILED});else t({value:l,errorCode:u.InvokeResultCode.E_USER_NOT_SIGNED_IN})})),i)}else c.msAjaxDebug.trace("Unknown store type.")};m._onClickInstallOsfControl=function(e){if(M._enableUploadFileDevCatalog){c.msAjaxDebug.trace("onClickInstallOsfControl!");try{u.OUtil.validateParamObject(e,{manifest:{type:String,mayBeNull:p}},l);var n=new u.Manifest.Manifest(e.manifest,M.getAppUILocale()),r=n.getMarketplaceID(),o=n.getMarketplaceVersion();if(f.CatalogFactory.resolve(u.StoreType.UploadFileDevCatalog).validateAndCacheNewManifest(r,o,e.manifest,n)){var i={id:r,targetType:n.getTarget(),appVersion:o,currentStoreType:u.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:r,assetStoreId:u.StoreType.UploadFileDevCatalog,width:parseInt(n.getDefaultWidth()||t),height:parseInt(n.getDefaultHeight()||t),isAddinCommands:n._isAddinCommandsManifest(u.getManifestHostType(M._hostType))};u.OUtil.validateParamObject(i,{id:{type:String,mayBeNull:p},targetType:{type:Number,mayBeNull:p},appVersion:{type:String,mayBeNull:p},width:{type:Number,mayBeNull:d},height:{type:Number,mayBeNull:d}},l),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,i.currentStoreType,i.assetId,i.appVersion,i.targetType,i.isAddinCommands,i.width,i.height),M._notifyHost(t,u.AgaveHostAction.InsertAgave,i)}else M._notifyHost(t,u.AgaveHostAction.NotifyHostError,l)}catch(e){var a="Invalid manifest from addincommands dev catalog.";return f.WACUtils.logExceptionToBrowserConsole(a,e),s.RuntimeTelemetryHelper.LogExceptionTag(a,e,this._appCorrelationId,554235235),void M._notifyHost(t,u.AgaveHostAction.NotifyHostError,l)}}};var R=function(e){c.msAjaxDebug.trace("onClickRefreshfAddinCommands!"),M._notifyHost(t,u.AgaveHostAction.RefreshAddinCommands,e)},N=function(e){var t=u.OUtil.Guid.generateNewGuid(),n=new f.InsertDialogTelemetryContext(t),r=f.CatalogFactory.resolve(u.StoreType.OMEX),o=new f.PreCacher(M.getRequirementsChecker()),i={assetId:e.assetId,storeType:u.StoreType.OMEX,storeId:e.storeId,appVersion:"",targetType:l};r.activateAsync(i,o,n)},D=function(e,t){if(M._enableSingleSignOnForAddin&&e.webApplicationId)U(e,t);else{var n={assetId:e.id,clientVersion:M._getClientVersionForOmex(),clientName:M._getClientNameForOmex(),clientEndPoint:M._omexGatedWSProxy.clientEndPoint},r=M._insertDialogDiv,o={errorCode:u.InvokeResultCode.E_OEM_REMOVED_FAILED,forceRefreshEntitlements:p},i=u.OUtil.Guid.generateNewGuid(),a=new f.InsertDialogTelemetryContext(i);f.CatalogFactory.resolve(u.StoreType.OMEX).removeAsync([n.assetId],a,(function(i){var a=0;if(i.status==f.DataServiceResultCode.Succeeded&&i.value&&i.value.removedApps&&i.value.removedApps.length>0){for(var c=i.value.removedApps,l=u.InvokeResultCode.E_OEM_REMOVED_FAILED,m=0;m<c.length;m++)if(c[m].assetId==n.assetId){c[m].result==u.OmexRemoveAppStatus.Success&&(l=u.InvokeResultCode.S_OK);break}l==u.InvokeResultCode.S_OK&&(a=M.untrustOsfControls(e),F(n.assetId),L(n.assetId)),o.errorCode=l}var h=!document.documentElement.contains(r);s.AppManagementMenuHelper.LogAppManagementMenuAction(n.assetId,u.AppManagementAction.Remove,a,h,p,o.errorCode),o.forceRefreshEntitlements=d,t(o)}))}},F=function(e){var n={solutionId:e};M._appName==u.AppName.ExcelWebApp&&M._notifyHost(t,u.AgaveHostAction.UninstallCustomFunctions,n)},L=function(e){var t=l;for(var n in M._cachedOsfControls){var r=M._cachedOsfControls[n];if(r._marketplaceID.toLowerCase()==e.toLowerCase()){t=r;break}}if(!u.OUtil.isNullOrUndefined(t)&&!u.OUtil.isNullOrUndefined(t._manifest)&&u.OsfManifestManager.manifestContainsExtendedOverrides(t._manifest)){var o=f.ManifestUtil.constructAddInId(t._marketplaceID,t._marketplaceVersion,t._storeType,t._storeLocator);f.OsfExtendedManifestCache.clear(o),Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper.instance().clearSettingByAddinId(o)}},U=function(e,n){var r=M._hideAppsExtensionUrl+"&"+u.OmexPageParameterKeys.AppName+"="+u.getModernAppVerCode(M._appName)+"&"+u.OmexPageParameterKeys.AssetId+"="+e.id+"&"+u.OmexPageParameterKeys.AppCorrelationId+"="+M._contextMgrCorrelationId,o=document.createElement("iframe");o.setAttribute("id","serviceExtensionIframe"),o.setAttribute("src",r),o.setAttribute("scrolling","auto"),o.setAttribute("border",t),o.setAttribute("width",t),o.setAttribute("height",t),o.setAttribute("style","position: absolute; left: -100px; top:0px;"),document.body.appendChild(o);var i=M._insertDialogDiv,a=function(t){if(t.source==o.contentWindow){var r={errorCode:u.InvokeResultCode.E_OEM_REMOVED_FAILED,forceRefreshEntitlements:p};document.body.removeChild(o),window.removeEventListener("message",a);var c=0,l=JSON.parse(t.data),f=parseInt(l[u.OmexRemoveAddinMessageKeys.RemoveAddinResultCode]),m=u.InvokeResultCode.E_OEM_REMOVED_FAILED;if(f===u.OmexRemoveAddinResultCode.Success){for(var h=l[u.OmexRemoveAddinMessageKeys.RemoveAddinResultValue],g=0;g<h.length;g++)if(h[g]==e.id){m=u.InvokeResultCode.S_OK;break}m==u.InvokeResultCode.S_OK&&(c=M.untrustOsfControls(e),B(e.id),F(e.id)),r.errorCode=m}var v=!document.documentElement.contains(i);s.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,u.AppManagementAction.Remove,c,v,p,r.errorCode),r.forceRefreshEntitlements=d,n(r)}};window.addEventListener("message",a)},B=function(e){var t=".*",n=[];n.push(new RegExp(u.OUtil.formatString(f.WACUtils.CacheConstants.EntitlementsKey,t,t),"i")),n.push(new RegExp(u.OUtil.formatString(f.WACUtils.CacheConstants.AuthenticatedAppInstallInfoCacheKey,t,e,t,t),"i")),f.WACUtils.removeMatchesFromLocalStorage(n)},H=function(e){for(var t,n=[],r=e.length,o=0;o<r;o++){t=e[o];var i=u.OUtil.formatString(f.WACUtils.CacheConstants.AppStateCacheKey,f.WACUtils.CacheConstants.GatedCacheKeyPrefix,t.contentMarket,t.assetId),a=u.OUtil.formatString(f.WACUtils.CacheConstants.AppInstallInfoKey,f.WACUtils.CacheConstants.AnonymousCacheKeyPrefix,t.assetId,t.contentMarket),s=u.OUtil.formatString(f.WACUtils.CacheConstants.AppDetailKey,f.WACUtils.CacheConstants.UngatedCacheKeyPrefix,t.assetId),c=u.OUtil.formatString(f.WACUtils.CacheConstants.ActivatedCacheKey,t.assetId.toLowerCase(),u.StoreType.OMEX,t.contentMarket),l=u.OUtil.formatString("{0}.{1}.{2}",t.assetId,t.storeId,t.contentMarket);n[i]=d,n[a]=d,n[s]=d,n[c]=d,n[l]=d}for(var p=u.OUtil.getLocalStorage(),m=p.getKeysWithPrefix("__OSF_"),h=(o=0,m.length);o<h;o++){var g=m[o];if(0==g.indexOf(f.WACUtils.CacheConstants.GatedCacheKeyPrefix+f.WACUtils.CacheConstants.AppState)||0==g.indexOf(f.WACUtils.CacheConstants.AnonymousCacheKeyPrefix+f.WACUtils.CacheConstants.AppInstallInfo)||0==g.indexOf(f.WACUtils.CacheConstants.UngatedCacheKeyPrefix+f.WACUtils.CacheConstants.AppDetails)||0==g.indexOf(f.WACUtils.CacheConstants.ActivatedCacheKeyPrefix))n[g]!=d&&p.removeItem(g);else if(0==g.indexOf(f.WACUtils.CacheConstants.GatedCacheKeyPrefix+f.WACUtils.CacheConstants.AppinstallAuthenticated)){var v=g.replace(f.WACUtils.CacheConstants.GatedCacheKeyPrefix+f.WACUtils.CacheConstants.AppinstallAuthenticated,"");n[v=v.substring(v.indexOf(".")+1)]!=d&&p.removeItem(g)}}};if(m._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(m._clientId),m._serviceEndPoint._onHandleRequestError=function(e,t){var n,o,i,c="DdaMethod";e&&(n=e._data)&&((o=typeof(o=typeof n===r&&typeof n[c]===r?n[c].ControlId:typeof n===r?n[0]:n)===a?o:l)&&(i=M.getOsfControl(o))&&(i._pageStatus="Failed origin check"===t?u.OsfControlPageStatus.FailedOriginCheck:"Access Denied"===t?u.OsfControlPageStatus.FailedPermissionCheck:u.OsfControlPageStatus.FailedHandleRequest,s.RuntimeTelemetryHelper.LogExceptionTag(t,l,i.getCorrelationId(),19203549)))},m._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",(function(e,t){var o=typeof e===a?e:typeof e===r&&e.length>0?e[0]:l;(!o||!t)&&s.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",l,l,19203545);var i=M.getOsfControl(o);if(!i)throw c.msAjaxDebug.trace(n),s.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",l,l,19203546),c.msAjaxError.argument("contextId");i._sdxTelemetryContext.getAppContextStart=performance.now(),i._iframeOnGetAppContextDelegate&&i._iframeOnGetAppContextDelegate(),s.AppLoadTimeHelper.OfficeJSLoaded(i._telemetryContext),t(i.getAppContext()),i._pageStatus=u.OsfControlPageStatus.Ready,i._pageIsReadyTimerExpired&&s.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",l,i.getCorrelationId(),19203547),i._contextActivationMgr._ErrorUXHelper&&i._contextActivationMgr._ErrorUXHelper.removeProgressDiv(i._div,i._id),i.ensureAgaveEndPoint(),M._enableSetFocusOnTaskpaneOnUserAction?(i._focusOnIframeWhenLoaded||i.getStatus()===u.OsfControlStatus.Activated&&i.getPageStatus()===u.OsfControlPageStatus.Ready&&i.getInitializationReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted)&&i._frame.contentWindow.focus():i._focusOnIframeWhenLoaded&&i._frame.contentWindow.focus(),s.AppLoadTimeHelper.ActivationEnd(i._telemetryContext),i._sdxTelemetryContext.getAppContextEnd=performance.now(),i._timer&&(window.clearTimeout(i._timer),i._timer=l),i._iframeIsLoaded&&i._notifyHostIFrameOnLoaded()}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",(function(e){e&&2==e.length||!(e&&3==e.length&&(e[1]===u.AgaveHostAction.UpdateTargetUrl||e[1]===u.AgaveHostAction.SendTelemetryEvent||e[1]===u.AgaveHostAction.SendCustomerContent||e[1]===u.AgaveHostAction.SendMessage||e[1]===u.AgaveHostAction.LaunchExtensionComponent||e[1]===u.AgaveHostAction.StopExtensionComponent||e[1]===u.AgaveHostAction.RestartExtensionComponent||e[1]===u.AgaveHostAction.EnableTaskPaneHeaderButton||e[1]===u.AgaveHostAction.DisableTaskPaneHeaderButton||e[1]===u.AgaveHostAction.RefreshRibbonGallery||e[1]===u.AgaveHostAction.OfficeJsReady||e[1]===u.AgaveHostAction.KeyboardShortcuts))&&c.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var t=e[0],r=e[1],o=M.getOsfControl(t);if(o)if(r===u.AgaveHostAction.TabExitShift||r===u.AgaveHostAction.ExitNoFocusableShift)M._ErrorUXHelper.focusOnNotificationUxShiftIn(t,r);else if(r===u.AgaveHostAction.UpdateTargetUrl){var i=e[2];o.checkAppDomains(i)&&o.updateAgaveEndPointTargetUrl(i)}else if(r===u.AgaveHostAction.SendTelemetryEvent||r===u.AgaveHostAction.SendCustomerContent){var a=e[2];o._contextActivationMgr._notifyHost(t,r,a)}else if(r===u.AgaveHostAction.LaunchExtensionComponent){var s=e[2];o._contextActivationMgr._notifyHost(t,r,s)}else if(r===u.AgaveHostAction.RestartExtensionComponent){var d=e[2];if(d.InstanceToken){var f=o._contextActivationMgr._cachedOsfControls[d.InstanceToken];if(f)f.refresh();else if(d.LaunchProperties&&d.LaunchProperties.OptionalProperties){var p=d.Id.Id,m=d.LaunchProperties.OptionalProperties.SourceLocationOverrideResourceId;o._contextActivationMgr.refreshOsfControl(p,m)}}}else if(r===u.AgaveHostAction.StopExtensionComponent){var h=e[2];o._contextActivationMgr._notifyHost(t,r,h)}else if(r==u.AgaveHostAction.SendMessage){for(var g in o._contextActivationMgr._cachedOsfControls)if(g!=o.getID()){var v=o._contextActivationMgr._cachedOsfControls[g];if(v.getStoreLocator()==o.getStoreLocator()&&v.getStoreType()==o.getStoreType()){var y=e[2];v.getOwnerAddinAssetId()!=l&&v.getOwnerAddinAssetId()==o.getOwnerAddinAssetId()?v.notifyAgave(u.AgaveHostAction.SendMessage,y):v.getMarketplaceID()==o.getMarketplaceID()&&v.notifyAgave(u.AgaveHostAction.SendMessage,y)}}}else if(r==u.AgaveHostAction.EnableTaskPaneHeaderButton){var b=e[2];o._contextActivationMgr._notifyHost(t,r,b)}else if(r==u.AgaveHostAction.RefreshRibbonGallery){var O=e[2];o._contextActivationMgr._notifyHost(t,r,O)}else if(r==u.AgaveHostAction.OfficeJsReady){var S=e[2];o._sdxTelemetryContext.officeJsReadyDate=S,o._iframeOnGetAppContextDelegate&&o._iframeOnGetAppContextDelegate()}else if(r==u.AgaveHostAction.KeyboardShortcuts){var C=e[2];o._contextActivationMgr._notifyHost(t,r,C)}else o._contextActivationMgr._notifyHost?o._contextActivationMgr._notifyHost(t,r):c.msAjaxDebug.trace("No notifyHost provided by the host.");else c.msAjaxDebug.trace(n)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",j,Microsoft.Office.Common.InvokeType.async,p),m._enableServiceDeliveredExperience&&m._serviceEndPoint.registerMethod("Office_sendMessageToHost",k,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(m._clientId+u.Constants.EndPointInternalSuffix),m._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",P,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",(function(e){if(e&&e.storeType!=u.StoreTypeEnum.PrivateCatalog){var n=window.location.href,r=M._osfOmexBaseUrl+u.Constants.SignInRedirectUrl+encodeURIComponent(n);window.location.assign(r)}else f.PrivateCatalogService.authenticationProxy.getSignInUrl((function(e){window.top.location.replace(e)}),(function(){M._notifyHost(t,u.AgaveHostAction.NotifyHostError,l)}))}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignOut",(function(e){e&&e.storeType==u.StoreTypeEnum.PrivateCatalog&&f.PrivateCatalogService.SignOutUser(),R(e,l)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",(function(e){if(e.pageUrl){var t={strUrl:e.pageUrl,strWindowName:l,strWindowFeatures:l};j(t)}}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",(function(e){c.msAjaxDebug.trace("onClickInsertOsfControl!"),M._notifyHost(t,u.AgaveHostAction.InsertAgave,e)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",m._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",R,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",(function(){c.msAjaxDebug.trace("onClickCancelDialog!"),M._notifyHost(t,u.AgaveHostAction.CancelDialog),M._internalConversationId&&(M._serviceEndPointInternal.unregisterConversation(M._internalConversationId),M._internalConversationId=l)}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",D,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",(function(e){switch(e.datapointName){case u.DataPointNames.AppManagementMenu:u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?(e.id=e.id||e.assetId,u.OUtil.validateParamObject(e,{id:{type:String,mayBeNull:p},operationMetadata:{type:Number,mayBeNull:p},hrStatus:{type:Number,mayBeNull:p}},l),s.AppManagementMenuHelper.LogAppManagementMenuAction(e.id,e.operationMetadata,0,p,p,e.hrStatus)):(u.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:p},operationMetadata:{type:Number,mayBeNull:p},hrStatus:{type:Number,mayBeNull:p}},l),s.AppManagementMenuHelper.LogAppManagementMenuAction(e.assetId,e.operationMetadata,0,p,p,e.hrStatus));break;case u.DataPointNames.InsertionDialogSession:u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?(e.id=e.id||e.assetId,u.OUtil.validateParamObject(e,{id:{type:String,mayBeNull:p},totalSessionTime:{type:Number,mayBeNull:p},trustPageSessionTime:{type:Number,mayBeNull:p},appInserted:{type:Boolean,mayBeNull:p},lastActiveTab:{type:Number,mayBeNull:p},lastActiveTabCount:{type:Number,mayBeNull:p}},l),s.InsertionDialogSessionHelper.LogInsertionDialogSession(e.id,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount)):(u.OUtil.validateParamObject(e,{assetId:{type:String,mayBeNull:p},totalSessionTime:{type:Number,mayBeNull:p},trustPageSessionTime:{type:Number,mayBeNull:p},appInserted:{type:Boolean,mayBeNull:p},lastActiveTab:{type:Number,mayBeNull:p},lastActiveTabCount:{type:Number,mayBeNull:p}},l),s.InsertionDialogSessionHelper.LogInsertionDialogSession(e.assetId,e.totalSessionTime,e.trustPageSessionTime,e.appInserted,e.lastActiveTab,e.lastActiveTabCount));break;case u.DataPointNames.UploadFileDevCatelog:u.OUtil.validateParamObject(e,{operationMetadata:{type:Number,mayBeNull:p},hrStatus:{type:Number,mayBeNull:p}},l),s.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,e.operationMetadata,0,p,p,e.hrStatus);break;case u.DataPointNames.UploadFileDevCatalogUsage:u.OUtil.validateParamObject(e,{currentStoreType:{type:String,mayBeNull:p},id:{type:String,mayBeNull:d},appVersion:{type:String,mayBeNull:d},appTargetType:{type:Number,mayBeNull:p},isAppCommand:{type:String,mayBeNull:p},appSizeWidth:{type:Number,mayBeNull:d},appSizeHeight:{type:Number,mayBeNull:d}},l),s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,e.currentStoreType,e.Id,e.appVersion,e.appTargetType,e.isAppCommand,e.appSizeWidth,e.appSizeHeight)}}),Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",N,Microsoft.Office.Common.InvokeType.async,p),m._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppCommandsAddin",(function(e){var n=M.getOsfControl(e.id);n?n._isAddinCommands((function(n){n&&M._notifyHost(t,u.AgaveHostAction.RemoveAppCommandsAddin,{assetId:e.id})})):c.msAjaxDebug.trace("osfControl for the given ID doesn't exist:"+e.id)}),Microsoft.Office.Common.InvokeType.async,p),u.AppSpecificSetup._setupFacade(m._hostControl,m,m._serviceEndPoint,m._serviceEndPointInternal),e.hostType=m._hostType,e.spBaseUrl=m._spBaseUrl,e.wopiHostAddinList=m._hostInstallAddIns,e.approvedAddinList=m._approvedAddIns,e.enableWopiCatalog=m._hostInstallAddInsIsEnabled,f.CatalogFactory.setHostContext(e),m._localeStringLoadingPendingCallbacks=[],m._localizedScriptsUrl&&"null/"!=m._localizedScriptsUrl){m._loadLocaleString(Function.createDelegate(m,(function(){this._ErrorUXHelper=new u._ErrorUXHelper(this)})))}m.queryEntitlementDetails=function(e){P(e,e.callbackFunc)},m._getOmexData=function(e){N(e)},m._removeAppForInsertDialog=function(e){D(e,e.callbackFunc)};m._enableUpnCheck&&m._enableMyOrg&&m._spBaseUrl!=l&&!f.WACUtils.isTeamsWebView()&&function(e,t){var n="wacUpn is null.",r=function(e){var n=d;f.WACUtils.logExceptionToBrowserConsole("Check UPN result: "+e.value,l),e.status===f.DataServiceResultCode.Succeeded?n=e.value:s.RuntimeTelemetryHelper.LogCommonMessageTag("Upn Check failed.",l,572926159),t(n)},o=f.CatalogFactory.resolve(u.StoreType.SPCatalog);o!=l&&e!=l?o.isUpnMatchAsync(e,new f.SimpleTelemetryContext,r):(e==l&&(f.WACUtils.logExceptionToBrowserConsole(n,l),s.RuntimeTelemetryHelper.LogCommonMessageTag(n,l,572926158)),e==l&&s.RuntimeTelemetryHelper.LogCommonMessageTag("spcatalog is null.",l,572926157),r({status:f.DataServiceResultCode.Failed,value:p}))}(m._wacUpn,(function(e){h._upnCheckResult=e?u.UpnCheckCode.Match:u.UpnCheckCode.NotMatch}))},u.ContextActivationManager.prototype={insertOsfControl:function(e){var t=!0,n=!1,r=this;u.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},storeType:{type:String,mayBeNull:n},alternateReference:{type:Object,mayBeNull:t},settings:{type:Object,mayBeNull:t},reason:{type:String,mayBeNull:t},osfControlType:{type:Number,mayBeNull:t},snapshotUrl:{type:String,mayBeNull:t},preactivationCallback:{type:Object,mayBeNull:t},virtualOsfControlActivationCallback:{type:Object,mayBeNull:t},isvirtualOsfControl:{type:Boolean,mayBeNull:t},isDialog:{type:Boolean,mayBeNull:t},hostCustomMessage:{type:String,mayBeNull:t},isForUILessAction:{type:Boolean,mayBeNull:t},ownerAddinAssetId:{type:String,mayBeNull:t},ownerAddinStoreType:{type:String,mayBeNull:t},sourceLocationOverrideUrl:{type:String,mayBeNull:t},focusOnIframeWhenLoaded:{type:Boolean,mayBeNull:t},featureGates:{type:Object,mayBeNull:t},activationStart:{type:Number,mayBeNull:t},hostInfoFlags:{type:Number,mayBeNull:t},sharedRuntimeId:{type:String,mayBeNull:t},initialDisplayMode:{type:Number,mayBeNull:t},containsShortcuts:{type:String,mayBeNull:t},exchangeExtensionProviderName:{type:String,mayBeNull:t},exchangeExtensionType:{type:String,mayBeNull:t}},null);var o=u.OsfControl.isFirstPartyStoreString(e.storeType);if(!r._disableAppsForOfficeThirdParty||o){var i={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,alternateReference:e.alternateReference,settings:e.settings,reason:e.reason,osfControlType:e.osfControlType,snapshotUrl:e.snapshotUrl,contextActivationMgr:r,preactivationCallback:e.preactivationCallback,virtualOsfControlActivationCallback:e.virtualOsfControlActivationCallback,isvirtualOsfControl:e.isvirtualOsfControl,isDialog:e.isDialog,hostCustomMessage:e.hostCustomMessage,isForUILessAction:e.isForUILessAction,ownerAddinAssetId:e.ownerAddinAssetId,sourceLocationOverrideResourceId:e.sourceLocationOverrideResourceId,sourceLocationOverrideUrl:e.sourceLocationOverrideUrl,ownerAddinStoreType:e.ownerAddinStoreType,focusOnIframeWhenLoaded:e.focusOnIframeWhenLoaded,featureGates:e.featureGates,activationStart:e.activationStart,hostInfoFlags:e.hostInfoFlags,sharedRuntimeId:e.sharedRuntimeId,initialDisplayMode:e.initialDisplayMode,containsShortcuts:e.containsShortcuts,exchangeExtensionProviderName:e.exchangeExtensionProviderName,exchangeExtensionType:e.exchangeExtensionType},a=r.getSQMAgaveUsage(i.storeType,i.osfControlType,i.reason,e.marketplaceID),c=new u.OsfControl(i);c._sqmDWords[0]=a[0],c._sqmDWords[1]=a[1],c._contextActivationMgr._ErrorUXHelper&&c._contextActivationMgr._ErrorUXHelper.showProgress(c._div,c._id);return r._loadLocaleString(Function.createDelegate(r,(function(){var e="OsfControl activation lifecycle: OsfControl active got called for controlId: ";c.activate({isInsertOsfControl:t}),u.OUtil.checkFlight("Microsoft.Office.SharedOnline.IsPrivateAddin")?s.RuntimeTelemetryHelper.LogCommonMessageTag(e+s.PrivacyRules.GetAssetId(i.ownerAddinStoreType||i.storeType,i.store,i.id),this._contextMgrCorrelationId,594356321):s.RuntimeTelemetryHelper.LogCommonMessageTag(e+c._id,this._contextMgrCorrelationId,562442708)}))),c}},insertDialogControl:function(e){var t=!1;u.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:t},id:{type:String,mayBeNull:t},dialogUrl:{type:String,mayBeNull:t},marketplaceID:{type:String,mayBeNull:t},marketplaceVersion:{type:String,mayBeNull:t},appDomains:{type:Array,mayBeNull:t},store:{type:String,mayBeNull:t},storeType:{type:String,mayBeNull:t},ownerAddinAssetId:{type:String,mayBeNull:!0},ownerAddinStoreType:{type:String,mayBeNull:!0},agaveName:{type:String,mayBeNull:!0}},null);var n={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,ownerAddinAssetId:e.ownerAddinAssetId,ownerAddinStoreType:e.ownerAddinStoreType,isDialog:!0,contextActivationMgr:this};new u.OsfControl(n).createIframeForDialogControl(e.agaveName,e.dialogUrl,e.appDomains)},insertBlankControlWithErrorUX:function(e,t){var n=!1,r=this;u.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:n},id:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:!0},storeType:{type:String,mayBeNull:n}},null);var o={div:e.div,id:e.id,marketplaceID:e.marketplaceID,marketplaceVersion:e.marketplaceVersion,store:e.store,storeType:e.storeType,osfControlType:e.osfControlType,contextActivationMgr:r,isvirtualOsfControl:n},i=new u.OsfControl(o);i._contextActivationMgr.registerOsfControl(i);var a=function(e,t){var r,o="",i="",a="",s=n;e.status===f.DataServiceResultCode.Succeeded&&e.value&&(o=(r=e.value).getDefaultDisplayName(),i=r.getProviderName(),a=r.getDefaultIconUrl(),s=r.isSSOAddin()),t(o,i,a,s)},s=f.OmexUtils.getOmexEndPointPageUrl(r.getOsfOmexBaseUrl(),e.marketplaceID,e.store),c=f.CatalogFactory.resolve(e.storeType.toLowerCase());if(null!=c){var l={assetId:e.marketplaceID,appVersion:e.marketplaceVersion,storeType:e.storeType,storeId:e.store,targetType:null},d=u.OmexClientNames[r._appName];c.getAndCacheManifest(l,r._storeLocator,new f.AddinCommandsTelemetryContext(i.getCorrelationId()),(function(n){a(n,(function(n,r,o,a){i._showTrustError(d,n,r,o,e.storeType,t,s,a)}))}))}},purgeDialogControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&(n._conversationId&&this._getServiceEndPoint().unregisterConversation(n._conversationId),this.unregisterOsfControl(n))},dispose:function(){var e=this;e._serviceEndPoint&&(e._serviceEndPoint.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId),e._serviceEndPoint=null),e._serviceEndPointInternal&&(e._serviceEndPointInternal.dispose(),Microsoft.Office.Common.XdmCommunicationManager.deleteServiceEndPoint(e._clientId+u.Constants.EndPointInternalSuffix),e._serviceEndPointInternal=null)},setLocalizedUrl:function(e,t,n){var r=this,o=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:!1},{name:"imageUrl",type:String,mayBeNull:!1},{name:"styleUrl",type:String,mayBeNull:!1}]);if(o)throw o;if(r._localizedScriptsUrl=e,r._localizedImagesUrl=t,r._localizedStylesUrl=n,r._localizedScriptsUrl&&"null/"!=r._localizedScriptsUrl){var i=function(){this._ErrorUXHelper||(this._ErrorUXHelper=new u._ErrorUXHelper(this))};r._loadLocaleString(Function.createDelegate(r,i))}},getOsfControlStatus:function(e){var t=this._cachedOsfControls[e];return t?t.getStatus():u.OsfControlStatus.InvalidOsfControl},hostCheckReadyHandler:function(e,t){var n=this;if(null!=n._isHostFrameTrusted&&null!=n._notReadyOsfControlsIndex){null!=t&&(n._isHostFrameTrusted=t),s.RuntimeTelemetryHelper.LogCommonMessageTag("Host frame check set :"+JSON.stringify(t),n._contextMgrCorrelationId,595354008);for(var r=0;r<n._notReadyOsfControlsIndex;r++){var o=n._notReadyOsfControls[r];o&&o.refresh()}}},activateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.activate()},deActivateOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;var n=this._cachedOsfControls[e];void 0!==n&&n.deActivate()},purgeOsfControl:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(s.RuntimeTelemetryHelper.LogCommonMessageTag("OsfControl activation lifecycle: purgeOsfControl for controlId: "+e,this._contextMgrCorrelationId,594356320),r.purge(t))},purgeOsfControlNotifications:function(){for(var e in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(e)},untrustOsfControls:function(e){var t=this,n=0,r=function(e){return function(){e.activate({hasConsent:!0})}},o=u.OUtil.formatString(u.Constants.ActivatedCacheKey,e.id.toLowerCase(),e.currentStoreType,e.storeId);for(var i in t._deleteCachedFlag(o),t._cachedOsfControls){var a=t._cachedOsfControls[i];if(a._marketplaceID.toLowerCase()==e.id.toLowerCase()){t._ErrorUXHelper.purgeOsfControlNotification(a._id),a.deActivate();var s=f.OmexUtils.getOmexEndPointPageUrl(t.getOsfOmexBaseUrl(),a._marketplaceID,e.storeId),c=u.OmexClientNames[t._appName];a._showTrustError(c,e.displayName,e.providerName,e.iconUrl,e.currentStoreType,r(a),s),n++}}return n},retryAll:function(e){var t=this;for(var n in t._cachedOsfControls){var r=t._cachedOsfControls[n];r._marketplaceID.toLowerCase()==e.toLowerCase()&&r._retryActivate&&(t._ErrorUXHelper.purgeOsfControlNotification(r._id),t._ErrorUXHelper.removeInfoBarDiv(n,!1),r._retryActivate(),r._retryActivate=null)}},validateAndCacheNewDevAddinManifest:function(e){var t=this;t._getDevAddinManifestContent(e,t._validateAndCacheNewDevAddinManifest.bind(t),t._notifyHost.bind(t))},_getDevAddinManifestContent:function(e,t,n){var r;try{(r=new XMLHttpRequest).onreadystatechange=function(){return 4==r.readyState&&200==r.status?t(r.responseText):4==r.readyState&&0==r.status?n("0",u.AgaveHostAction.InsertDevManifestError,{manifestUrl:e}):void 0},r.open("GET",e,!0),r.send()}catch(t){var o="Cannot access developer manifest url.";return f.WACUtils.logExceptionToBrowserConsole(o,t),s.RuntimeTelemetryHelper.LogExceptionTag(o,t,this._appCorrelationId,572926156),n("0",u.AgaveHostAction.InsertDevManifestError,{manifestUrl:e})}},_validateAndCacheNewDevAddinManifest:function(e){var t="developer",n=this;try{var r=new u.Manifest.Manifest(e,n.getAppUILocale()),o=r.getMarketplaceID(),i=r.getMarketplaceVersion(),a=f.CatalogFactory.resolve(u.StoreType.UploadFileDevCatalog);if(a.validateAndCacheNewManifest(o,i,e,r)){var c={id:o,targetType:r.getTarget(),appVersion:i,currentStoreType:u.StoreType.UploadFileDevCatalog,storeId:t,assetId:o,assetStoreId:u.StoreType.UploadFileDevCatalog,width:parseInt(r.getDefaultWidth()||"0"),height:parseInt(r.getDefaultHeight()||"0"),isAddinCommands:r._isAddinCommandsManifest(u.getManifestHostType(n._hostType))};return u.OUtil.validateParamObject(c,{id:{type:String,mayBeNull:!1},targetType:{type:Number,mayBeNull:!1},appVersion:{type:String,mayBeNull:!1},width:{type:Number,mayBeNull:!0},height:{type:Number,mayBeNull:!0}},null),a.localCacheAddinCommands(o,i,t),u.OUtil.getLocalStorage().setItem(o,"true"),n._notifyHost("0",u.AgaveHostAction.InsertDevManifest,c)}return n._notifyHost("0",u.AgaveHostAction.NotifyHostError,null)}catch(e){var l="Invalid developer addin manifest.";return f.WACUtils.logExceptionToBrowserConsole(l,e),s.RuntimeTelemetryHelper.LogExceptionTag(l,e,n._appCorrelationId,572926155),n._notifyHost("0",u.AgaveHostAction.NotifyHostError,null)}},getOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1}]);if(t)throw t;return this._cachedOsfControls[e]},getOsfControls:function(){var e=[];for(var t in this._cachedOsfControls)e.push(this._cachedOsfControls[t]);return e},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},isStoreDisabled:function(e){this._loadLocaleString(Function.createDelegate(this,(function(){var t=f.CatalogFactory.resolve(u.StoreType.OMEX),n=u.OUtil.Guid.generateNewGuid(),r=new f.InsertDialogTelemetryContext(n);if(t instanceof f.OmexCatalog)t.isStoreDisabled(r,e);else{e({value:!1,status:200})}})))},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(e){this._controlStatusChanged&&this._controlStatusChanged(e)},registerOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._cachedOsfControls[e.getID()]=e},registerNotReadyOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;this._notReadyOsfControls[this._notReadyOsfControlsIndex]=e,this._notReadyOsfControlsIndex++},unregisterOsfControl:function(e){var t=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:!1}]);if(t)throw t;delete this._cachedOsfControls[e.getID()]},setIframeAttributeBag:function(e){this._iframeAttributeBag=e},displayNotification:function(e){var t=null,n=!0,r=!1,o=this;u.OUtil.validateParamObject(e,{infoType:{type:Number,mayBeNull:r},id:{type:String,mayBeNull:r},title:{type:String,mayBeNull:r},description:{type:String,mayBeNull:r},url:{type:String,mayBeNull:n},icon:{type:String,mayBeNull:n},buttonTxt:{type:String,mayBeNull:n},buttonCallback:{type:Function,mayBeNull:n},dismissCallback:{type:Function,mayBeNull:n},"displayDeactive ":{type:Boolean,mayBeNull:n},highPriority:{type:Boolean,mayBeNull:n},detailView:{type:Boolean,mayBeNull:n},reDisplay:{type:Boolean,mayBeNull:n},logAsError:{type:Boolean,mayBeNull:n},errorCode:{type:Number,mayBeNull:n},retryAll:{type:Boolean,mayBeNull:n},iframeNotificationUrl:{type:String,mayBeNull:n},notificationType:{type:Number,mayBeNull:n}},t),e.errorCode||(e.errorCode=0);var i=o._cachedOsfControls[e.id];if(i)if(i._isvirtualOsfControl){if(e.errorCode==u.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED||e.errorCode==u.ErrorStatusCodes.E_OEM_EXTENSION_KILLED)return void o.purgeOsfControl(e.id,n);if(null==e.highPriority&&(e.highPriority=e.infoType===u.InfoType.Error?n:r),e.highPriority===r)i._notificationParams.push(e);else{for(var a=i._notificationParams,c=0;c<a.length;c++)if(!a[c].highPriority){a.splice(c,0,e),a=t;break}a!=t&&a.push(e)}!i._isvirtualOsfControlCallbackInvoked&&i.ensureToGetVirtualOsfControlManifest((function(e){i.invokeVirtualOsfControlActivationCallback(e)})),!i._isManifestProcessedForCustomFunctions&&i.ensureToGetVirtualOsfControlManifest((function(e){i.processManifestForCustomFunctions(e)}))}else{if(e.logAsError&&(s.AppLoadTimeHelper.SetErrorResult(i._telemetryContext,e.errorCode),o._notifyHostError)){var l={errorCode:e.errorCode};o._notifyHostError(e.id,u.AgaveHostAction.NotifyHostError,l)}(e.displayDeactive||e.iframeNotificationUrl!=t)&&(e.detailView=n),e.div=i._div,o._ErrorUXHelper&&o._ErrorUXHelper.showNotification(e)}},dismissMessages:function(e){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(e)},notifyAgave:function(e,t){var n=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:!1},{name:"actionId",type:Number,mayBeNull:!1}]);if(n)throw n;var r=this._cachedOsfControls[e];void 0!==r&&(t===u.AgaveHostAction.CtrlF6In||t===u.AgaveHostAction.TabIn||t===u.AgaveHostAction.Select?this._ErrorUXHelper.focusOnNotificationUx(e,t):t===u.AgaveHostAction.TabInShift&&r._pageStatus!==u.OsfControlPageStatus.Ready?this._ErrorUXHelper.focusOnNotificationUxShiftIn(e,t):r.notifyAgave(t))},setWSA:function(e){var t=this;t._wsa=e,t._wsa&&(t._wsa.createStreamUnobfuscated(u.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,u.BWsaStreamTypes.Static,2,u.BWsaConfig.defaultMaxStreamRows),t._wsa.createStreamUnobfuscated(u.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,u.BWsaStreamTypes.Static,4,u.BWsaConfig.defaultMaxStreamRows))},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(e,t,n,r){var o,i;switch(e.toLowerCase()){case u.StoreType.OMEX:o=0;break;case u.StoreType.SPCatalog:o=1;break;case u.StoreType.FileSystem:o=2;break;case u.StoreType.Registry:o=3;break;case u.StoreType.Exchange:o=4;break;case u.StoreType.SPApp:o=5;break;case u.StoreType.FirstParty:o=6;break;case u.StoreType.Sdx:o=7;break;case u.StoreType.InMemory:o=8;break;case u.StoreType.OneDrive:o=9;break;case u.StoreType.PrivateCatalog:o=10;break;case u.StoreType.HardCodedPreinstall:o=11;break;case u.StoreType.UploadFileDevCatalog:o=12;break;case u.StoreType.WopiCatalog:o=13;break;default:o=15}switch(t){case u.OsfControlType.DocumentLevel:i=1;break;case u.OsfControlType.ContainerLevel:i=0;break;default:i=2}var a=7;if(n&&n.toLowerCase)switch(n.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():a=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():a=1}var s=0;0!==r.toLowerCase().indexOf("wa")&&0!==r.toLowerCase().indexOf("fa")||(s=r&&r.length>2?parseInt(r.substring(2),10):0,isNaN(s)&&(s=0));return[a<<8|i<<4|o,s]},isMyOrgReady:function(e){var t=this;if(t._enableMyOrg)if(t._spBaseUrl&&t._iframeProxies&&t._iframeProxies[t._spBaseUrl]&&t._iframeProxies[t._spBaseUrl].clientEndPoint)e({isReady:!0,clientEndPoint:t._iframeProxies[t._spBaseUrl].clientEndPoint});else{t._createSharePointIFrameProxy(t._spBaseUrl,(function(t){e(t?{isReady:!0,clientEndPoint:t}:{isReady:!1})}))}else e({isReady:!1})},openInputUrlDialog:function(e){var t="style",n=document.createElement("p"),r="title-p";n.setAttribute("id",r),"ltr"==document.documentElement.getAttribute("dir")?n.setAttribute(t,"padding: 26px 0px 10px 26px;"):n.setAttribute(t,"padding: 26px 26px 10px 0px;"),n.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):",e.appendChild(n);var o=document.createElement("div"),i=document.createElement("input");i.setAttribute("type","url"),i.setAttribute("id","url-input"),i.setAttribute("aria-labelledby",r),i.setAttribute("data-lpignore","true"),"ltr"==document.documentElement.getAttribute("dir")?i.setAttribute(t,"margin-left: 26px; height: 18px; width: calc(100% - 141px); vertical-align: middle;"):i.setAttribute(t,"margin-right: 26px; height: 18px; width: calc(100% - 141px); vertical-align: middle;"),o.appendChild(i);var a=this,c=function(e){var t=new u.Manifest.Manifest(e,a.getAppUILocale());!u.OsfManifestManager.hasManifest(t.getMarketplaceID(),t.getMarketplaceVersion())&&u.OsfManifestManager.cacheManifest(t.getMarketplaceID(),t.getMarketplaceVersion(),t);var n={id:t.getMarketplaceID(),targetType:t.getTarget(),appVersion:t.getMarketplaceVersion(),currentStoreType:u.StoreType.Registry,storeId:"developer",assetId:t.getMarketplaceID(),assetStoreId:u.StoreType.Registry,width:t.getDefaultWidth()||0,height:t.getDefaultHeight()||0,isAddinCommands:t._isAddinCommandsManifest(u.getManifestHostType(a._hostType))};s.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,n.currentStoreType,n.id,n.appVersion,n.targetType,n.isAddinCommands,n.width,n.height),a._notifyHost("0",u.AgaveHostAction.InsertAgave,n)},l=function(e){alert("Error when requesting manifest file: "+e)},d=document.createElement("input");d.setAttribute("type","button"),d.setAttribute("id","devcat-insert-button"),d.setAttribute("value","Insert"),d.setAttribute("class","WACButton WACDialogButtonNormal"),u.OUtil.addEventListener(d,"click",(function(){u.OUtil.xhrGet(a._devCatalogUrl+"/"+i.value,c,l)})),o.appendChild(d),e.appendChild(o)},launchInsertDialog:function(e,t,n){var r=null,o="100%";0!=e.childNodes.length&&e.removeChild(e.childNodes.item(0));var i,a=u.OUtil.Guid.generateNewGuid(),c=new f.InsertDialogTelemetryContext(a);if(this._enableDevCatalog){(i=document.createElement("div")).style.width=o,i.style.height="80%",e.appendChild(i);var l=document.createElement("div");l.style.width=o,l.style.height="20%",e.appendChild(l),this.openInputUrlDialog(l)}else i=e;var d=this;d._insertDialogDiv=i;var p=document.createElement("div");p.style.width=o,p.style.height=o,p.style.backgroundImage="url("+d.getLocalizedImageFilePath("progress.gif")+")",p.style.backgroundRepeat="no-repeat",p.style.backgroundPosition="center",i.appendChild(p);!function(e,t){if(d._enableMyOrg)try{u.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:!1}},t);d.isMyOrgReady((function(n){n.isReady?(e.clientEndPoint=n.clientEndPoint,f.CatalogFactory.resolve(u.StoreType.SPCatalog).getSPCatalogUrl(c,(function(n){t({statusCode:n.status,value:n.value,context:e})}))):t({statusCode:u.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}))}catch(n){return s.RuntimeTelemetryHelper.LogExceptionTag("Error when getting corporate catalog url:",n,this._appCorrelationId,34719254),void t({statusCode:u.InvokeResultCode.E_GENERIC_ERROR,value:r,context:e})}else t({statusCode:u.InvokeResultCode.E_CATALOG_NO_APPS,value:r,context:e})}({webUrl:d._spBaseUrl},(function(e){var a=document.createElement("iframe");a.setAttribute("id","InsertDialog"),a.setAttribute("src","about:blank"),a.setAttribute("width",o),a.setAttribute("height",o),a.setAttribute("marginHeight","0"),a.setAttribute("marginWidth","0"),a.setAttribute("frameBorder","0"),a.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups"),"undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime&&a.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var c=r,l=[];d.isStoreDisabled((function(o){var f="WFEVersion",p='"}',m='], "url":"',h=",";d._hostAllowedOfficeStore||(o.value=!0);var g='{ "IsUploadFileDevCatalogEnabled":'+d._enableUploadFileDevCatalog+h+'"isStoreDisabled":'+o.value+h+'"showSignOutFromPrivateCatalogMessage":'+d._showSignOutFromPrivateCatalogMessage+h+'"enableInsertDialogAccessibilityFix":'+d._enableInsertDialogAccessibilityFix+h+'"isBlackForestRedirectEnabled":'+d._enableBlackForestRedirect+h+'"isHostDocumentDomain":'+d._isHostDocumentDomain+h+'"agaveAddinUploadEnabled":'+d._agaveAddinUploadEnabled+" }";if(d.isExternalMarketplaceAllowed()){var v='{ "provValues":[0,0,0,'+(d._enableMyApps?u.InvokeResultCode.S_OK.toString():u.InvokeResultCode.S_HIDE_PROVIDER.toString())+m+d._osfOmexBaseUrl+'", "client":"'+d._getClientNameForOmex()+'", "'+u.OmexPageParameterKeys.AuthType+'":'+d._getAuthTypeForHideAppsExtensionUrl()+"}";l.push('"myApp":'+v),s.RuntimeTelemetryHelper.LogCommonMessageTag("isExternalMarketplaceAllowed is true, myApp tab show firstly.",d._contextMgrCorrelationId,20194266)}if(e&&e.value!=r){if(d._enableMyOrg){d._myOrgCatalogUrl=e.value;var y='{ "provValues":[1,1,0,'+e.statusCode+m+e.value+p;l.push('"myOrg":'+y)}if(d._enableOneDriveCatalog&&-1!=document.cookie.indexOf("OneDriveCatalog=true")){d._myOneDriveCatalogUrl=e.value;var b='{ "provValues":[9,9,0,0], "url":"'+e.value+p;l.push('"myOneDrive":'+b)}}if(d._enablePrivateCatalog){var O='{"provValues":[10,10,0,0], "client":"'+d._getClientNameForOmex()+p;l.push('"privateCatalog":'+O)}l.length>0&&(c="{"+l.join(", ")+"}"),d._internalConversationId&&d._serviceEndPointInternal.unregisterConversation(d._internalConversationId);var S=d.getClientId()+"_"+d.getDocUrl(),C=u.OUtil.getFrameName(S),A=u.OUtil.generateConversationId();d._internalConversationId=u.OUtil.generateConversationId(),a.setAttribute("name",C);var _=r;n!=r&&(_='{ "navigationMode":'+n.navigationMode+', "navigationModeParameter": "'+n.assetId+'", "category":"'+n.category+p);var I=window.location.origin,x="",E=[A,encodeURIComponent(I),d._appVersion,u.getAppVerCode(d._appName),d.getLcid(),u.Constants.FileVersion,encodeURIComponent(c),t,encodeURIComponent(g),encodeURIComponent(_),d._contextMgrCorrelationId],T=u.Constants.FileVersion;try{var w=JSON.parse(d._sessionStartInfoJson);if("string"!=typeof w[f])throw new Error("WFEVersion is unavailable in session start info.");T=w[f]}catch(e){s.RuntimeTelemetryHelper.LogExceptionTag("Could not get the web frontend version.",e,d._contextMgrCorrelationId,570770309)}x=d._localizedResourcesUrl?d._localizedResourcesUrl+"WefGallery.htm?b="+encodeURIComponent(T):d._pageBaseUrl+d.getLcid()+"/WefGallery.htm?b="+encodeURIComponent(T);var M=u.OUtil.addXdmInfoAsHash(x,E.join("|"));M=u.OUtil.addFlightsAsHash(M,JSON.stringify(u.Flights)),d._serviceEndPointInternal.registerConversation(A,M),a.setAttribute("src",M),d._insertDialogDiv?(0!=i.childNodes.length&&i.removeChild(i.childNodes.item(0)),i.appendChild(a)):(i.insertBefore(a,i.firstChild),d._insertDialogDiv=i)}))}))},activateAgavesBlockedBySandboxNotSupport:function(){for(var e in this._cachedOsfControls){var t=this._cachedOsfControls[e];t._status===u.OsfControlStatus.NotSandBoxSupported&&t.activate()}},setRequirementsChecker:function(e){this._requirementsChecker=e},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(e){return!!this._ErrorUXHelper&&this._ErrorUXHelper.appHasNotifications(e)},refreshOsfControl:function(e,t){var n=this;for(var r in n._cachedOsfControls)if(n._cachedOsfControls[r]&&e==n._cachedOsfControls[r]._marketplaceID&&t==n._cachedOsfControls[r]._sourceLocationOverrideResourceId){n._cachedOsfControls[r].refresh();break}},isAddinActivated:function(e){for(var t in this._cachedOsfControls)if(this._cachedOsfControls[t]&&e==this._cachedOsfControls[t]._marketplaceID)return!0;return!1},_doesUrlHaveSupportedProtocol:function(e){var t=!1;e&&(t=null!=decodeURIComponent(e).match(/^https?:\/\/.+$/gi));return t},_loadLocaleString:function(e){var t=this;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){for(var n=t._localeStringLoadingPendingCallbacks.length,r=0;r<n;r++){t._localeStringLoadingPendingCallbacks.shift()()}e()}else{t._localeStringLoadingPendingCallbacks.push(e);var o=t._localeStringLoadingPendingCallbacks;if(1===o.length){t._loadStringScript((function(){for(var e=o.length,t=0;t<e;t++){var n=o.shift();"function"==typeof n&&n()}}))}}},_loadStringScript:function(e){var t=this,n=this.getLocalizedScriptsUrl();n+=u.Constants.StringResourceFile;var r=0,o=function(){var i=null;if("undefined"!=typeof Strings&&Strings&&Strings.OsfRuntime){if(r>0){a=u.OUtil.formatString("osfruntime_strings loaded after {0} retries.",r);s.RuntimeTelemetryHelper.LogExceptionTag(a,i,i,20306077)}e()}else{if(++r<3)return void setTimeout((function(){u.OUtil.loadScript(n,o)}),750*r);t._localeStringLoadingPendingCallbacks.length=0;var a=u.OUtil.formatString("The locale, {0}, provided by the host app is not supported. Url: {1}",t.getLcid(),n);s.RuntimeTelemetryHelper.LogExceptionTag(a,i,i,20306076)}};u.OUtil.loadScript(n,o)},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(e,t){return u.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,t,e)},_getManifestAndTargetByConversationId:function(e){for(var t in this._cachedOsfControls){var n=this._cachedOsfControls[t];if(e===n._getConversationId()){var r=n.getStoreType()==u.StoreType.FirstParty?"":n.getMarketplaceVersion();return{manifest:n.getManifest()||u.OsfManifestManager.getCachedManifest(n.getMarketplaceID()),version:r,target:n.getOsfControlType()}}}return null},_createSharePointIFrameProxy:function(e,t){var n=null,r=this;if(r._doesUrlHaveSupportedProtocol(e)){var o=e.length;"/"===e.charAt(o-1)&&(e=e.substr(0,o-1));var i=r._iframeProxies[e];if(i)i.isReady?t(i.clientEndPoint):i.pendingCallbacks.push(t);else{var a=u.OUtil.generateConversationId(),c=document.createElement("iframe");r._iframeProxyCount=r._iframeProxyCount+1;var l=r._iframeNamePrefix+r._iframeProxyCount;c.setAttribute("id",l),c.setAttribute("name",l);var d=e+"/_layouts/15/OfficeExtensionManager.aspx?"+a,f=window.location.origin;d=u.OUtil.addXdmInfoAsHash(d,a+"|"+l+"|"+f),d=u.OUtil.addSerializerVersionAsHash(d,u.SerializerVersion.Browser),d=u.OUtil.addFlightsAsHash(d,JSON.stringify(u.XdmFlights)),c.setAttribute("scrolling","auto"),c.setAttribute("border","0"),c.setAttribute("width","0"),c.setAttribute("height","0"),c.setAttribute("style","position: absolute; left: -100px; top:0px;"),c.setAttribute("title",Strings.OsfRuntime.L_AddinsCatalogIframeTitle_TXT);var p=r,m=function(t,r){var o,i=p._iframeProxies[e];if(i&&0===t&&r.status?(i.isReady=!0,o=i.clientEndPoint):(delete p._iframeProxies[e],Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(a)?(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(a),u.OUtil.removeEventListener(c,"load",h),c.parentNode.removeChild(c)):s.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",n,n,19203550),o=n),i)for(var l=i.pendingCallbacks.length,d=0;d<l;d++){i.pendingCallbacks.shift()(o)}},h=function(){p._iframeProxies[e]&&(p._iframeProxies[e].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(a,c.contentWindow,e),p._iframeProxies[e].clientEndPoint.invoke("OEM_isProxyReady",m,{__timeout__:2e3}))};document.body.appendChild(c),u.OUtil.addEventListener(c,"load",h),c.setAttribute("src",d),r._iframeProxies[e]={clientEndPoint:n,isReady:!1,pendingCallbacks:[t]}}}else t(n)},_getClientVersionForOmex:function(){if(this._appVersion){var e=this._appVersion.split("."),t=parseInt(e[0],10),n=parseInt(e[1],10)||0;if(!(t<=15&&n<=0)){var r=u.Constants.FileVersion.split(".");return t+"."+n+"."+r[2]+"."+r[3]}}},_getClientNameForOmex:function(){return u.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return u.OmexAppVersions[this._appName]},_setCachedFlag:function(e){var t=u.OUtil.getLocalStorage();t&&t.setItem(e,"true")},_getCachedFlag:function(e){var t=u.OUtil.getLocalStorage();if(t)return!!t.getItem(e)},_deleteCachedFlag:function(e){var t=u.OUtil.getLocalStorage();t&&t.removeItem(e)},_getAuthTypeForHideAppsExtensionUrl:function(){var e=u.OUtil.getQueryStringParamValue(this._hideAppsExtensionUrl,u.OmexPageParameterKeys.AuthType);return e||u.AuthType.Anonymous},isAddinCommandsAsync:function(e,t){var n=null,r=!1;u.OUtil.validateParamObject(e,{marketplaceId:{type:String,mayBeNull:r},marketplaceVersion:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},storeId:{type:String,mayBeNull:r},targetData:{type:Object,mayBeNull:r},clearCache:{type:Boolean,mayBeNull:!0}},n);var o=e.storeType.toLowerCase(),i={contextActivationMgr:n,referenceInUse:n},a=e.clearCache||r;try{u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?i.referenceInUse={solutionId:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeId:e.storeId}:i.referenceInUse={id:e.marketplaceId,version:e.marketplaceVersion,storeType:e.storeType,storeLocator:e.storeId},i.contextActivationMgr=this;var c=function(o){o!=n&&o.statusCode==f.DataServiceResultCode.Succeeded&&o.value!=n?t(!0,o.value._isAddinCommandsManifest(u.getManifestHostType(i.contextActivationMgr._hostType)),e):t(r,r,e)};if(u.StoreType.OMEX===o||u.StoreType.UploadFileDevCatalog===o||u.StoreType.SPCatalog===o||u.StoreType.PrivateCatalog===o||u.StoreType.WopiCatalog===o){var l,d=f.CatalogFactory.resolve(o);l=u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?{assetId:i.referenceInUse.solutionId,storeType:o,storeId:i.referenceInUse.storeId,appVersion:i.referenceInUse.version,targetType:n}:{assetId:i.referenceInUse.id,storeType:o,storeId:i.referenceInUse.storeLocator,appVersion:i.referenceInUse.version,targetType:n};var p=u.OUtil.Guid.generateNewGuid(),m=new f.AddinCommandsTelemetryContext(p);d.getAndCacheManifest(l,l.storeId,m,(function(e){c({statusCode:e.status,value:e.value})}),a)}else t(!0,r,e)}catch(o){s.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",o,n,19203552),t(r,r,e)}},setOAuthManager:function(e){this._oAuthManager=e},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getDevManifestInvalidUrlErrorString:function(e){return u.OUtil.formatString(Strings.OsfRuntime.L_DeveloperAddinManifestInvalidUrl_Message,e)},getUserNameHashCode:function(){return this._userNameHashCode},ownerAddinControlRecreated:function(e,t){for(var n in this._cachedOsfControls){var r=this._cachedOsfControls[n];r._ownerAddinAssetId&&r._ownerAddinStoreType&&r._ownerAddinAssetId==e&&r._ownerAddinStoreType==t&&r.setOwnerAddinControlRecreated(!0)}}},u.OsfControl=function(e){var t=null,n=!0,r=!1,o=this;e.solutionId=e.solutionId||e.marketplaceID,e.version=e.version||e.marketplaceVersion,e.storeId=e.storeId||e.store,e.ownerAddinSolutionId=e.ownerAddinSolutionId||e.ownerAddinAssetId,u.OUtil.validateParamObject(e,{div:{type:Object,mayBeNull:r},contextActivationMgr:{type:Object,mayBeNull:r},id:{type:String,mayBeNull:r},solutionId:{type:String,mayBeNull:r},version:{type:String,mayBeNull:r},storeType:{type:String,mayBeNull:r},storeId:{type:String,mayBeNull:r},assetId:{type:String,mayBeNull:n},assetStoreId:{type:String,mayBeNull:n},ownerAddinSolutionId:{type:String,mayBeNull:n},ownerAddinStoreType:{type:String,mayBeNull:n},settings:{type:Object,mayBeNull:n},reason:{type:String,mayBeNull:n},osfControlType:{type:Number,mayBeNull:n},snapshotUrl:{type:String,mayBeNull:n},preactivationCallback:{type:Object,mayBeNull:n},virtualOsfControlActivationCallback:{type:Object,mayBeNull:n},isvirtualOsfControl:{type:Boolean,mayBeNull:n},isDialog:{type:Boolean,mayBeNull:n},hostCustomMessage:{type:String,mayBeNull:n},isForUILessAction:{type:Boolean,mayBeNull:n},sourceLocationOverrideResourceId:{type:String,mayBeNull:n},sourceLocationOverrideUrl:{type:String,mayBeNull:n},focusOnIframeWhenLoaded:{type:Boolean,mayBeNull:n},featureGates:{type:Object,mayBeNull:n},hostInfoFlags:{type:Number,mayBeNull:n},sharedRuntimeId:{type:String,mayBeNull:n},initialDisplayMode:{type:Number,mayBeNull:n},exchangeExtensionProviderName:{type:String,mayBeNull:n},exchangeExtensionType:{type:String,mayBeNull:n},marketplaceID:{type:String,mayBeNull:n},marketplaceVersion:{type:String,mayBeNull:n},store:{type:String,mayBeNull:n},alternateReference:{type:Object,mayBeNull:n},ownerAddinAssetId:{type:String,mayBeNull:n}},t),o._div=e.div,o._sourceLocationOverrideResourceId=e.sourceLocationOverrideResourceId,o._sourceLocationOverrideUrl=e.sourceLocationOverrideUrl,o._contextActivationMgr=e.contextActivationMgr,o._id=e.id,o._solutionId=e.solutionId,o._version=e.version,o._storeId=e.storeId,o._storeType=e.storeType.toLowerCase(),o._assetId=e.assetId,o._assetStoreId=e.assetStoreId,o._ownerAddinSolutionId=e.ownerAddinSolutionId||t,o._ownerAddinStoreType=e.ownerAddinStoreType||t,o._marketplaceID=o._solutionId,o._marketplaceVersion=o._version,o._storeLocator=o._storeId,o._alternateReference=e.alternateReference,o._ownerAddinAssetId=o._ownerAddinSolutionId,o._settings=e.settings||{},o._reason=null==e.reason?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:e.reason,o._osfControlType=null==e.osfControlType?u.OsfControlType.DocumentLevel:e.osfControlType,o._snapshotUrl=e.snapshotUrl,o._status=u.OsfControlStatus.NotActivated,o._iframeIsLoaded=r,o._iframeLoadedNotified=r,o._notificationParams=[],o._iframeUrl=t,o._permission=t,o._conversationId=t,o._manifestUrl=t,o._pageStatus=u.OsfControlPageStatus.NotStarted,o._pageIsReadyTimerExpired=r,o._timer=t,o._retryLoadingNum=2,o._timer1=t,o._retryCheckingNum=2,o._autoRetryCheckingNum=2,o._frame=t,o._agaveEndPoint=t,o._etoken="",o._sqmDWords=[0,0],o._preactivationCallback=e.preactivationCallback,o._telemetryContext={},o._controlFocus=r,o._agavePageUrl=t,o._agaveWindowName=t,o._manifest=t,o._virtualOsfControlActivationCallback=e.virtualOsfControlActivationCallback,o._isvirtualOsfControl=null==e.isvirtualOsfControl?r:e.isvirtualOsfControl,o._isvirtualOsfControlCallbackInvoked=r,o._isManifestProcessedForCustomFunctions=r,o._processManifestForExtendedOverridesPromise=t,o._isDialog=null==e.isDialog?r:e.isDialog,o._hostCustomMessage=e.hostCustomMessage,o._isUpgrading=r,o._isUpgradingFailed=r,o._focusOnIframeWhenLoaded=null==e.focusOnIframeWhenLoaded?r:e.focusOnIframeWhenLoaded,o._featureGates=e.featureGates||{},o._hostInfoFlags="number"==typeof e.hostInfoFlags?e.hostInfoFlags:0,o._sharedRuntimeId=null==e.sharedRuntimeId?t:e.sharedRuntimeId,o._initialDisplayMode=null==e.initialDisplayMode?0:e.initialDisplayMode,o._appContextIsSetToIframeName=r,o._sdxTelemetryContext={},o._contextActivationMgr._enableServiceDeliveredExperience&&(o._bundleUrl=t,o._sdxIframeTemplateUrl="https://osf-agave/rtm/sdx/index.html"),o._isUILessAddInCommands=!!e.isForUILessAction,u.OUtil.isiOS()&&(o._div.style.webkitOverflowScrolling="touch",o._div.style.overflow="auto"),o._appCorrelationId=o._contextActivationMgr._contextMgrCorrelationId||u.OUtil.Guid.generateNewGuid(),o._iframeOnLoadDelegate=Function.createDelegate(o,o._iframeOnLoad),o._retryActivate=t,o._onKeyDownEventDelegate=Function.createDelegate(o,o._onKeydownEvent),o._ownerAddinControlRecreated=r,o._exchangeExtensionProviderName=e.exchangeExtensionProviderName,o._exchangeExtensionType=e.exchangeExtensionType},u.OsfControl.isFirstPartyStoreString=function(e){if(e){var t=e.toLowerCase();return t===u.StoreType.FirstParty||t===u.StoreType.Sdx}return!1},u.OsfControl.isFirstPartyStoreEnum=function(e){return!!e&&(e==u.StoreTypeEnum.FirstParty||e==u.StoreTypeEnum.Sdx)},u.OsfControl.prototype={activate:function(e){var t=null,n=this;if(n._status!==u.OsfControlStatus.Activated)if(n._contextActivationMgr.registerOsfControl(n),u.OUtil.addEventListener(n._div,"keydown",n._onKeyDownEventDelegate),(e=e||{}).hostType=n._contextActivationMgr._hostType,e.osfControl=e.osfControl||n,u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?e.referenceInUse=e.referenceInUse||{solutionId:n._solutionId,version:n._version,storeType:n._storeType,storeId:n._storeId}:e.referenceInUse=e.referenceInUse||{id:n._solutionId,version:n._version,storeType:n._storeType,storeLocator:n._storeId},e.correlationId=e.osfControl._appCorrelationId,e.isInsertOsfControl=!!e.isInsertOsfControl&&e.isInsertOsfControl,1==e.isInsertOsfControl){if(!n._contextActivationMgr._hostAllowedSdxEmbedding||n._checkWopiHost(n._contextActivationMgr._enableWopiHostCheck))return void n.invokePreactivationCompletedCallback();var r=f.ManifestUtil.constructAddInId(n._solutionId,n._version,n._storeType,n._storeId),o=new u.AddinIdInfo(r);n._contextActivationMgr._enableMyOrg&&n._contextActivationMgr._spBaseUrl!=t&&n._contextActivationMgr._wacUpn==t&&s.RuntimeTelemetryHelper.LogCommonMessageTag("WAC UPN in Sharepoint is null, assetID:"+o.getPrivacyCompliantSolutionId(),n._contextActivationMgr._contextMgrCorrelationId,592852928),n._contextActivationMgr._enableUpnCheck&&n._contextActivationMgr._enableMyOrg&&n._contextActivationMgr._spBaseUrl!=t?(n._contextActivationMgr._wacUpn==t&&(s.RuntimeTelemetryHelper.LogCommonMessageTag("CheckUpnInSPO failed because WAC UPN is null, assetId: "+o.getPrivacyCompliantSolutionId(),n._contextActivationMgr._contextMgrCorrelationId,572926154),n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_SPO_NotSignIn_Error_ERR,t,t,t,t,t,t,u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted)),n._contextActivationMgr._upnCheckResult===u.UpnCheckCode.NotMatch?(s.RuntimeTelemetryHelper.LogCommonMessageTag("CheckUpnInSPO failed, assetId: "+o.getPrivacyCompliantSolutionId(),n._contextActivationMgr._contextMgrCorrelationId,572926153),n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,t,t,t,t,t,t,u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted)):n.activateInternal(e)):n.activateInternal(e)}else n.activateInternal(e);else n.invokePreactivationCompletedCallback()},activateInternal:function(e){var t=":/content?access_token=",n="/root:/Manifests/",r="ONO_Onboarding_CorrelationId :",o="isPreload",i="sourceLocationOverrideResourceId",a="Microsoft.Office.OEP.FA000000059.SourceLocationOverrideResourceId",c=!0,l=null,d=this,p=d;try{if(!d._doesBrowserSupportRequiredFeatures())return d._contextActivationMgr._enableFirstPartySDXErrorMessages&&d.isFirstParty()?d._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(d,d._refresh),l,l,l,c,u.ErrorStatusCodes.E_BROWSER_VERSION):d._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(d,d._refresh),l,l,l,c,u.ErrorStatusCodes.E_BROWSER_VERSION),void d.invokePreactivationCompletedCallback();var m=document.createElement("iframe"),h="sandbox"in m;m=l;var g=!1,v=u.OUtil.getLocalStorage();if(v&&(g=v.getItem(u.Constants.IgnoreSandBoxSupport)),d._contextActivationMgr._autoTrusted&&!h&&!g)return d._contextActivationMgr._ErrorUXHelper.removeProgressDiv(d._div,d._id),d._status=u.OsfControlStatus.NotSandBoxSupported,d._contextActivationMgr._enableFirstPartySDXErrorMessages&&d.isFirstParty()?d._contextActivationMgr.displayNotification({id:d._id,infoType:u.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN_FirstParty,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR_FirstParty,icon:l,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT_FirstParty,buttonCallback:Function.createCallback(d._activateAgavesBlockedBySandboxNotSupport,d._contextActivationMgr),url:u.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:l,reDisplay:c,displayDeactive:c,errorCode:u.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:c}):d._contextActivationMgr.displayNotification({id:d._id,infoType:u.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,icon:l,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(d._activateAgavesBlockedBySandboxNotSupport,d._contextActivationMgr),url:u.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:l,reDisplay:c,displayDeactive:c,errorCode:u.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:c}),void d.invokePreactivationCompletedCallback();d.startActivate();var y=d,b=e.referenceInUse,O="1B4CD97F-DBFE-4C1A-B4C4-FC163B4F9693";if(b.storeType===u.StoreType.OMEX||b.storeType===u.StoreType.UploadFileDevCatalog||b.storeType===u.StoreType.SPCatalog||b.storeType===u.StoreType.PrivateCatalog||b.storeType===u.StoreType.FirstParty||b.storeType===u.StoreType.Sdx||b.storeType===u.StoreType.WopiCatalog){var S=new f.OsfControlLoader(d,e.hasConsent),C=new f.ActivationTelemetryContext(d.getCorrelationId(),d._telemetryContext,d._sqmDWords[0],d._sqmDWords[1],d._id);if(b.storeType===u.StoreType.Sdx)if(u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)){if(b.solutionId.toLowerCase()===u.SdxAssetIds.ExperimentationSdx)(A=d._contextActivationMgr._flightingTreatmentVariables[a])!=l&&(d._sourceLocationOverrideResourceId=A),d._sdxTelemetryContext[i]=d._sourceLocationOverrideResourceId;1==d._initialDisplayMode&&(d._sdxTelemetryContext[o]=c),f.SDXCatalog.activateAsync({assetId:b.solutionId,storeId:b.storeId,appVersion:b.version,storeType:b.storeType,targetType:""},S,C,d._contextActivationMgr.getRequirementsChecker(),{clientId:d._contextActivationMgr._loggableUserId,sessionStartInfoJson:d._contextActivationMgr._sessionStartInfoJson},d._sdxTelemetryContext)}else{var A;if(b.id.toLowerCase()===u.SdxAssetIds.ExperimentationSdx)(A=d._contextActivationMgr._flightingTreatmentVariables[a])!=l&&(d._sourceLocationOverrideResourceId=A),d._sdxTelemetryContext[i]=d._sourceLocationOverrideResourceId;1==d._initialDisplayMode&&(d._sdxTelemetryContext[o]=c),f.SDXCatalog.activateAsync({assetId:b.id,storeId:b.storeLocator,appVersion:b.version,storeType:b.storeType,targetType:""},S,C,d._contextActivationMgr.getRequirementsChecker(),{clientId:d._contextActivationMgr._loggableUserId,sessionStartInfoJson:d._contextActivationMgr._sessionStartInfoJson},d._sdxTelemetryContext)}else{var _=e.noTargetType||e.osfControl.getOsfControlType()===u.OsfControlTarget.TaskPane?l:e.osfControl.getOsfControlType(),I=f.CatalogFactory.resolve(b.storeType);u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?I.activateAsync({assetId:b.solutionId,storeId:b.storeId,appVersion:b.version,storeType:b.storeType,targetType:b.storeType===u.StoreType.SPCatalog?_:""},S,C):I.activateAsync({assetId:b.id,storeId:b.storeLocator,appVersion:b.version,storeType:b.storeType,targetType:b.storeType===u.StoreType.SPCatalog?_:""},S,C)}return void d.invokePreactivationCompletedCallback()}if(u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?b.solutionId===O&&s.RuntimeTelemetryHelper.LogCommonMessageTag(r+d.getCorrelationId(),l,23381916):b.id===O&&s.RuntimeTelemetryHelper.LogCommonMessageTag(r+d.getCorrelationId(),l,544219483),s.AppLoadTimeHelper.ActivationStart(d._telemetryContext,d._sqmDWords[0],d._sqmDWords[1],d.getCorrelationId(),d._id,u.ActivationTypes.V2Enabled),s.AppLoadTimeHelper.ServerCallStart(d._telemetryContext),b.storeType===u.StoreType.Exchange||b.storeType===u.StoreType.InMemory)u.OsfManifestManager.getManifestAsync(e,(function(e){e.statusCode===u.ProxyCallStatusCode.Succeeded&&e.value&&!p._etoken&&(p._etoken=e.value.getInMemoryEToken()||""),p._onGetManifestCompleted(e)}));else if(b.storeType===u.StoreType.Registry&&d._contextActivationMgr._enableDevCatalog||b.storeType===u.StoreType.HardCodedPreinstall)if(e.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened||b.storeType===u.StoreType.Registry&&d._contextActivationMgr._enableDevCatalog&&!u.OsfManifestManager.hasManifestForControl(e)){var x=function(t){var n=new u.Manifest.Manifest(t,y._contextActivationMgr.getAppUILocale());if(e.osfControl!=l&&e.osfControl._sharedRuntimeId!=l&&e.osfControl._sharedRuntimeId.length>0){var r=u.OsfManifestManager.getSharedRuntimeManifestCacheKey(e.osfControl._solutionId,e.osfControl._sharedRuntimeId);!u.OsfManifestManager.hasManifest(r,e.osfControl._version)&&u.OsfManifestManager.cacheManifest(r,e.osfControl._version,n)}!u.OsfManifestManager.hasManifest(n.getMarketplaceID(),n.getMarketplaceVersion())&&u.OsfManifestManager.cacheManifest(n.getMarketplaceID(),n.getMarketplaceVersion(),n),u.OsfManifestManager.getManifestAsync(e,Function.createDelegate(y,y._onGetManifestCompleted))},E=function(e){alert("Error when requesting manifest file: "+e)};u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?u.OUtil.xhrGet(d._contextActivationMgr._devCatalogUrl+"/"+b.solutionId+".xml",x,E):u.OUtil.xhrGet(d._contextActivationMgr._devCatalogUrl+"/"+b.id+".xml",x,E)}else{if(e.osfControl!=l&&e.osfControl._sharedRuntimeId!=l&&e.osfControl._sharedRuntimeId.length>0){var T=u.OsfManifestManager.getSharedRuntimeManifestCacheKey(e.osfControl._solutionId,e.osfControl._sharedRuntimeId);if(!u.OsfManifestManager.hasManifest(T,e.osfControl._version)){var w=u.OsfManifestManager.getCachedManifest(e.osfControl._solutionId,e.osfControl._version);u.OsfManifestManager.cacheManifest(T,e.osfControl._version,w)}}u.OsfManifestManager.getManifestAsync(e,Function.createDelegate(d,d._onGetManifestCompleted))}else if(b.storeType===u.StoreType.OneDrive&&d._contextActivationMgr._enableOneDriveCatalog){var M,k=function(t){var n=new u.Manifest.Manifest(t,y._contextActivationMgr.getAppUILocale());u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?u.OsfManifestManager.cacheManifest(b.solutionId,n.getMarketplaceVersion(),n):u.OsfManifestManager.cacheManifest(b.id,n.getMarketplaceVersion(),n),u.OsfManifestManager.getManifestAsync(e,Function.createDelegate(y,y._onGetManifestCompleted))},j=function(){y._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(y,y._refresh),l,l,l,l,u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},P=window.location.protocol+"//"+window.location.host;u.OneDriveOAuth.setHostCallbackUri(P),M=u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?d._contextActivationMgr._oneDriveCatalogBaseApiUrl+n+b.solutionId+t:d._contextActivationMgr._oneDriveCatalogBaseApiUrl+n+b.id+t;u.OneDriveOAuth.getAccessToken((function(e){M+=e,u.OUtil.xhrGet(M,k,j)}),(function(){y._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(y,y._refresh),l,l,l,l,u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}))}else b.storeType===u.StoreType.SPApp?(s.AppLoadTimeHelper.EntitlementCheckStart(d._telemetryContext),e.baseUrl=d._contextActivationMgr.getPageBaseUrl(),e.pageUrl=d._contextActivationMgr._docUrl,e.webUrl=d._contextActivationMgr._webUrl,e.appWebUrl=d._contextActivationMgr._webUrl,u.OsfManifestManager.getSPAppEntitlementsAsync(e,Function.createDelegate(d,d._onGetEntitlementsCompleted))):b.storeType===u.StoreType.FileSystem||b.storeType===u.StoreType.Registry||b.storeType===u.StoreType.HardCodedPreinstall?d._showActivationWarning(u.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,l,l,l,l,u.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):b.storeType===u.StoreType.OneDrive?d._showActivationWarning(u.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,l,l,l,l,u.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType):d._showActivationError(u.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,l,l,l,l,l,l,u.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}catch(e){var R="Error getting app data.";f.WACUtils.logExceptionToBrowserConsole(R,e),s.RuntimeTelemetryHelper.LogExceptionTag(R,e,d.getCorrelationId(),18420419),d._contextActivationMgr._enableFirstPartySDXErrorMessages&&d.isFirstParty()?d._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(d,d._refresh),l,l,l,l,u.ErrorStatusCodes.WAC_AgaveOsfControlActivationError):d._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(d,d._refresh),l,l,l,l,u.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}d.invokePreactivationCompletedCallback()},createIframeForDialogControl:function(e,t,n){for(var r=this;r._div.childNodes.length>0;)r._div.removeChild(r._div.childNodes.item(0));var o=r._createIframeForControl(e);r._iframeUrl=t,r._appDomains=n,r._setIframeAttribute(o,t),r._div.appendChild(o),r._contextActivationMgr.registerOsfControl(r)},deActivate:function(){var e=null,t=this;try{if(u.OUtil.writeProfilerMark(u.OsfControlActivationPerfMarker.DeactivationStart),t._contextActivationMgr.dismissMessages(t._id),t._retryActivate=e,t._status!==u.OsfControlStatus.NotActivated){for(t._agaveEndPoint&&(Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(t._agaveEndPoint._conversationId),t._agaveEndPoint=e),t._frame&&(u.OUtil.removeEventListener(t._frame,"load",t._iframeOnLoadDelegate),t._frame=e),t._timer&&(window.clearTimeout(t._timer),t._timer=e);t._div.childNodes.length>0;)t._div.removeChild(t._div.childNodes.item(0));t._status=u.OsfControlStatus.NotActivated,t._conversationId&&t._contextActivationMgr._getServiceEndPoint().unregisterConversation(t._conversationId),t._contextActivationMgr.raiseOsfControlStatusChange(t)}t._controlFocus=!1,u.OUtil.removeEventListener(t._div,"keydown",t._onKeyDownEventDelegate),t._iframeIsLoaded=!1,t._iframeLoadedNotified=!1,u.OUtil.writeProfilerMark(u.OsfControlActivationPerfMarker.DeactivationEnd)}catch(e){var n="Deactivate failed.";f.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),18420420)}},startActivate:function(){var e=this;for(e._controlFocus=!0,e._pageStatus=u.OsfControlPageStatus.Loading,e._sdxTelemetryContext={activationStart:performance.now(),performanceTimestampOrigin:Date.now()-performance.now(),osfControlId:e._id},u.OUtil.writeProfilerMark(u.OsfControlActivationPerfMarker.ActivationStart),e._frame&&(u.OUtil.removeEventListener(e._frame,"load",e._iframeOnLoadDelegate),e._frame=null);e._div.childNodes.length>0;)e._div.removeChild(e._div.childNodes.item(0));e._contextActivationMgr._ErrorUXHelper.showProgress(e._div,e._id)},refresh:function(){this._refresh()},_restartActivate:function(){this.deActivate(),this.startActivate(),this.invokePreactivationCompletedCallback()},purge:function(e){var t=this,n=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:!1}]);if(n)throw n;try{t._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(t._id),t.deActivate(),e&&u.OsfManifestManager.purgeManifest(t._solutionId,t._version),t._contextActivationMgr.unregisterOsfControl(t)}catch(e){var r="Purge failed.";f.WACUtils.logExceptionToBrowserConsole(r,e),s.RuntimeTelemetryHelper.LogExceptionTag(r,e,t.getCorrelationId(),18420421)}},invokeVirtualOsfControlActivationCallback:function(e){var t=this;try{t._virtualOsfControlActivationCallback&&(t._virtualOsfControlActivationCallback(t,e),t._isvirtualOsfControlCallbackInvoked=!0)}catch(e){var n="invokeVirtualOsfControlActivationCallback failed.";f.WACUtils.logExceptionToBrowserConsole(n,e),s.RuntimeTelemetryHelper.LogExceptionTag(n,e,t.getCorrelationId(),36496280)}},ensureToGetVirtualOsfControlManifest:function(e){var t=null,n=this,r=n;if(n._manifest)e(n._manifest);else{var o={assetId:n._solutionId,appVersion:n._version,storeType:n._storeType,storeId:n._storeId,targetType:t},i=function(n){var o=t;n.status===f.DataServiceResultCode.Succeeded&&n.value?o=n.value:r._status=u.OsfControlStatus.ActivationFailed,e(o)},a=f.CatalogFactory.resolve(o.storeType);a!=t?a.getAndCacheManifest(o,n._storeId,new f.AddinCommandsTelemetryContext(n.getCorrelationId()),i):(alert("AddinCommands is not supported in "+o.storeType+" store."),i({status:f.DataServiceResultCode.Failed,value:t}))}},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getSolutionId:function(){return this._solutionId},getMarketplaceID:function(){return this._solutionId},getVersion:function(){return this._version},getMarketplaceVersion:function(){return this._version},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(e){this._settings=e},getReason:function(){return this._reason==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted},getInitializationReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSharedRuntimeId:function(){return this._sharedRuntimeId},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},isFirstParty:function(){return u.OsfControl.isFirstPartyStoreString(this._storeType)},hostInfoFlags:function(){return this._hostInfoFlags},updateAgaveEndPointTargetUrl:function(e){this.ensureAgaveEndPoint(),this._agaveEndPoint&&(this._agaveEndPoint._targetUrl=e)},getStoreId:function(){return this._storeId},getStoreLocator:function(){return this._storeId},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;return this._settings[e]},addProperty:function(e,t){var n=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1},{name:"value",type:String,mayBeNull:!1}]);if(n)throw n;this._settings[e]=t},removeProperty:function(e){var t=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:!1}]);if(t)throw t;delete this._settings[e]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},checkAppDomains:function(e){var t=Microsoft.Office.Common.XdmCommunicationManager.checkUrlWithAppDomains(this._appDomains,e);return t||this.isTargetSubdomainOfSourceLocation(e)},isTargetSubdomainOfSourceLocation:function(e){return Microsoft.Office.Common.XdmCommunicationManager.isTargetSubdomainOfSourceLocation(this._agavePageUrl,e)},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){this._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return!1},getEToken:function(){return this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,[e,t])},sendMessageToSdx:function(e,t){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_sendMessageToSdx",t,e)},isUILessAddInCommands:function(){return this._isUILessAddInCommands},getOwnerAddinSolutionId:function(){return this._ownerAddinSolutionId},getOwnerAddinAssetId:function(){return this._ownerAddinSolutionId},getOwnerAddinStoreType:function(){return this._ownerAddinStoreType},getFeatureGates:function(){return this._featureGates},getOwnerAddinControlRecreated:function(){return this._ownerAddinControlRecreated},setOwnerAddinControlRecreated:function(e){this._ownerAddinControlRecreated=e},_onKeydownEvent:function(e){var t="input, button, a",n=this;if(e.preventDefault=e.preventDefault||function(){e.returnValue=!1},117==e.keyCode&&(e.ctrlKey||e.metaKey)){e.preventDefault(),e.stopPropagation();var r=u.AgaveHostAction.CtrlF6Exit;e.shiftKey&&(r=u.AgaveHostAction.CtrlF6ExitShift),n._contextActivationMgr._notifyHost(n._id,r)}else if(9==e.keyCode){e.preventDefault(),e.stopPropagation();var o=n._div.querySelectorAll(t);if(0==o.length)return;u.OUtil.focusToNextTabbable(o,e.target||e.srcElement,e.shiftKey)||(e.shiftKey?n._contextActivationMgr._notifyHost(n._id,u.AgaveHostAction.TabExitShift):n._agaveEndPoint?n.notifyAgave(u.AgaveHostAction.TabIn):n._contextActivationMgr._notifyHost(n._id,u.AgaveHostAction.TabExit))}else if(27==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,u.AgaveHostAction.EscExit);else if(113==e.keyCode)e.preventDefault(),n._contextActivationMgr._notifyHost(n._id,u.AgaveHostAction.F2Exit);else if(13==e.keyCode||32==e.keyCode)for(var i=n._div.querySelectorAll(t),a=0;a<i.length;a++){var s=e.target||e.srcElement;if(i[a]===s)return e.preventDefault(),e.stopPropagation(),void s.click()}else e.preventDefault(),e.stopPropagation()},_onGetEntitlementsCompleted:function(e){var t=null,n=this;if(e.statusCode===u.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.EntitlementCheckEnd(n._telemetryContext);for(var r,o=e.context.referenceInUse,i=e.value.entitlements,a=i.length,c=t,l=0;l<a;l++)r=i[l],u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?r.OfficeExtensionID&&o.solutionId&&r.OfficeExtensionID.toLowerCase()===o.solutionId.toLowerCase()&&(c&&!n._lessThan(c.OfficeExtensionVersion,r.OfficeExtensionVersion)||(c=r)):r.OfficeExtensionID&&o.id&&r.OfficeExtensionID.toLowerCase()===o.id.toLowerCase()&&(c&&!n._lessThan(c.OfficeExtensionVersion,r.OfficeExtensionVersion)||(c=r));(r=c)?r.OfficeExtensionKillbit?n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,t,t,t,t,t,t,u.ErrorStatusCodes.E_OEM_EXTENSION_KILLED):(e.context.manifestUrl=r.EncodedAbsUrl,e.context.appInstanceId=r.AppInstanceID,e.context.productId=r.ProductID,e.context.appInstanceId?u.OsfManifestManager.getAppInstanceInfoByIdAsync(e.context,Function.createDelegate(n,n._onGetAppInstanceInfoByIdCompleted)):u.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(n,n._onGetManifestCompleted))):n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback((function(e){e.osfControl._refresh(e)}),{clearCache:!0,referenceInUse:e.context.referenceInUse,osfControl:e.context.osfControl}),t,t,t,t,u.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST)}else n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var t=null,n=this;if(e.statusCode===u.ProxyCallStatusCode.Succeeded&&e.value){var r=e.value,o=e.context;r.AppWebFullUrl&&(o.appWebUrl=r.AppWebFullUrl),o.clientId=r.AppPrincipalId,o.remoteAppUrl=r.RemoteAppUrl,o.appWebUrl&&o.productId?u.OsfManifestManager.getSPTokenByProductIdAsync(o,Function.createDelegate(n,n._onGetSPTokenByProductIdCompleted)):u.OsfManifestManager.getManifestAsync(o,Function.createDelegate(n,n._onGetManifestCompleted))}else n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(e){e.statusCode===u.ProxyCallStatusCode.Succeeded&&e.value&&(this._etoken=e.value),u.OsfManifestManager.getManifestAsync(e.context,Function.createDelegate(this,this._onGetManifestCompleted))},_retryActivation:function(){var e=this;e._retryLoadingNum--,e._pageStatus===u.OsfControlPageStatus.Ready||e._retryLoadingNum<=0?(e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id),e._retryLoadingNum=2):e._refresh()},_iframeOnLoad:function(){var e="Stage1Time",t="Stage11Time",n=this,r=n;n._iframeIsLoaded=!0,n._appContextIsSetToIframeName&&r._contextActivationMgr._ErrorUXHelper&&(r._contextActivationMgr._ErrorUXHelper.removeProgressDiv(r._div,r._id),r._pageStatus=u.OsfControlPageStatus.Ready,n._contextActivationMgr._enableSetFocusOnTaskpaneOnUserAction?r._frame&&r._frame.contentWindow&&(r._focusOnIframeWhenLoaded||r.getStatus()===u.OsfControlStatus.Activated&&r.getPageStatus()===u.OsfControlPageStatus.Ready&&r.getInitializationReason()===Microsoft.Office.WebExtension.InitializationReason.Inserted)&&r._frame.contentWindow.focus():r._focusOnIframeWhenLoaded&&r._frame&&r._frame.contentWindow&&r._frame.contentWindow.focus(),r.ensureAgaveEndPoint(),n._telemetryContext.Timers&&n._telemetryContext.Timers[t]&&!n._telemetryContext.Timers[t].Finished&&s.AppLoadTimeHelper.OfficeJSLoaded(n._telemetryContext)),s.AppLoadTimeHelper.PageLoaded(n._telemetryContext),n._appContextIsSetToIframeName&&r._contextActivationMgr._ErrorUXHelper&&n._telemetryContext.Timers&&n._telemetryContext.Timers[e]&&!n._telemetryContext.Timers[e].Finished&&s.AppLoadTimeHelper.ActivationEnd(n._telemetryContext);r._pageStatus!==u.OsfControlPageStatus.Ready?r._timer=window.setTimeout((function(){!function(e){var t=null;if(e){if(e._contextActivationMgr._ErrorUXHelper&&(u.OUtil.writeProfilerMark(u.OsfControlActivationPerfMarker.SelectionTimeout),e._contextActivationMgr._ErrorUXHelper.removeProgressDiv(e._div,e._id)),e._pageStatus!==u.OsfControlPageStatus.Ready){if(2===e._retryLoadingNum){var n=u.ErrorStatusCodes.WAC_AgaveActivationError;switch(e._pageStatus){case u.OsfControlPageStatus.FailedOriginCheck:n=u.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case u.OsfControlPageStatus.FailedPermissionCheck:n=u.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case u.OsfControlPageStatus.FailedHandleRequest:n=u.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}if(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()){var r="Timeout loading contents in iframe. Error: "+n;e._storeType.toLowerCase()==u.StoreType.FirstParty.toLowerCase()?f.FirstPartyCatalog.LogFirstPartyCatalogMonitoringError(r,e._solutionId):e._storeType.toLowerCase()==u.StoreType.Sdx.toLowerCase()&&f.SDXCatalog.LogSDXCatalogMonitoringError(r,e._solutionId),e._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR_FirstParty,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else e._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,n)}else if(1===e._retryLoadingNum)if(e._contextActivationMgr._enableFirstPartySDXErrorMessages&&e.isFirstParty()){r="User retry failed to load contents in iframe.";e._storeType.toLowerCase()==u.StoreType.FirstParty.toLowerCase()?f.FirstPartyCatalog.LogFirstPartyCatalogMonitoringError(r,e._solutionId):e._storeType.toLowerCase()==u.StoreType.Sdx.toLowerCase()&&f.SDXCatalog.LogSDXCatalogMonitoringError(r,e._solutionId),e._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR_FirstParty,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,u.ErrorStatusCodes.WAC_ActivateAttempLoading)}else e._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(e,e._retryActivation),t,t,t,t,u.ErrorStatusCodes.WAC_ActivateAttempLoading)}else e._notifyHostIFrameOnLoaded();e._timer&&(window.clearTimeout(e._timer),e._timer=t),e._pageIsReadyTimerExpired=!0}}(r)}),5e3*r._retryLoadingNum+1):r._notifyHostIFrameOnLoaded()},_handleNotReady:function(){var e=null,t="CheckWopiHost IsHostFrameTrusted Value:",n=this,r=!0;return n._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotInitialized||n._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotReady?(n._contextActivationMgr.registerNotReadyOsfControl(n),n._timer1=window.setTimeout((function(){!function(n){if(n){if(n._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotInitialized||n._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotReady)if(n._autoRetryCheckingNum>=0)n._autoRetryCheckingNum--,s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,572926152),n._refresh();else if(n._retryCheckingNum>=0){n._retryCheckingNum--,s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,572926151);u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady;n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UnknownHost_Error_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),e,e,e,e,u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady)}else{s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,572926150);u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady;n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UnknownHost_Error_ERR,e,e,e,e,e,e,u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotReady)}else s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,572926149),n._status==u.OsfControlStatus.NotActivated&&n._refresh();n._timer1&&(window.clearTimeout(n._timer1),n._timer1=e)}}(n)}),5e3*(n._retryCheckingNum+1))):n._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotTrusted||n._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotImplemented?(s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,572926148),n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,e,e,e,e,e,e,u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted),n._timer1&&(window.clearTimeout(n._timer1),n._timer1=e)):(s.RuntimeTelemetryHelper.LogCommonMessageTag(t+n._contextActivationMgr._isHostFrameTrusted,n._contextActivationMgr._contextMgrCorrelationId,572926147),r=!1,n._timer1&&(window.clearTimeout(n._timer1),n._timer1=e)),r},_checkWopiHost:function(e){var t=null,n="CheckWopiHost IsHostFrameTrusted Value:",r=this,o=!1,i=r;return e&&(i._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotTrusted||i._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotImplemented?(s.RuntimeTelemetryHelper.LogCommonMessageTag(n+r._contextActivationMgr._isHostFrameTrusted,r._contextActivationMgr._contextMgrCorrelationId,572926146),i._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_UntrustedHost_Error_ERR,t,t,t,t,t,t,u.ErrorStatusCodes.WAC_WopiHostCheckStatusNotTrusted),o=!0,i._timer1&&(window.clearTimeout(i._timer1),i._timer1=t)):r._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotInitialized||r._contextActivationMgr._isHostFrameTrusted===u.HostFrameTrustState.NotReady?o=i._handleNotReady():i._timer1&&(window.clearTimeout(i._timer1),i._timer1=t)),s.RuntimeTelemetryHelper.LogCommonMessageTag(n+r._contextActivationMgr._isHostFrameTrusted,r._contextActivationMgr._contextMgrCorrelationId,595354007),o},_isOsfControlInEmbeddingMode:function(e){var t=!1;try{t=null!=e.getContainingDiv().parentNode.parentNode.id.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/gi)}catch(e){f.WACUtils.logExceptionToBrowserConsole("_isOsfControlInEmbeddingMode error.",e)}return t},_createIframeAndActivateOsfControl:function(e){var t=this;s.RuntimeTelemetryHelper.LogCommonMessageTag("IFrame Created"+t._iframeUrl,t._contextActivationMgr._contextMgrCorrelationId,594356319);var n=t._createIframeForControl(e);t._activate(n,t._iframeUrl)},_createIframeForControl:function(e){var t,n=this,r=document.createElement("iframe");for(var o in r.setAttribute("id",n._id),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("frameborder","0"),r.setAttribute("allowfullscreen","true"),t=n._contextActivationMgr._enableFirstPartySDXErrorMessages&&n.isFirstParty()?e:Strings.OsfRuntime.L_IframeTitle_TXT+" "+e,r.setAttribute("title",t),r.style.msUserSelect="element",n._setSandboxAttribute(r),n._contextActivationMgr._iframeAttributeBag)r.setAttribute(o,n._contextActivationMgr._iframeAttributeBag[o]);return n._frame=r,r},_setSandboxAttribute:function(e){var t="allow-scripts allow-forms allow-same-origin allow-popups allow-popups-to-escape-sandbox allow-modals allow-downloads";u.OUtil.checkFlight("Microsoft.Office.SharedOnline.AllowStorageAccessByUserActivationOnIFrame")&&(t+=" allow-storage-access-by-user-activation"),e.setAttribute("sandbox",t);var n="geolocation;camera";this._contextActivationMgr._disableMicrophonePermission||(n+=";microphone"),this._contextActivationMgr._accessibilityAllowFocusAddinTaskpane&&(n+=";focus-without-user-activation *"),e.setAttribute("allow",n)},_onGetManifestCompleted:function(e){var t=null,n=this;if(e.statusCode===u.ProxyCallStatusCode.Succeeded&&e.value){s.AppLoadTimeHelper.ManifestRequestEnd(n._telemetryContext),s.AppLoadTimeHelper.ServerCallEnd(n._telemetryContext);var r=e.value,o=e.context,i=o.referenceInUse,a=i.storeType,c=r.getDefaultDisplayName();if(n._manifest=r,o.manifestCached&&!o.retried){var l=r.getMarketplaceVersion();if(n._lessThan(l,i.version)&&a===u.StoreType.SPApp)return void n._refresh({clearCache:!0,referenceInUse:i,osfControl:o.osfControl,retried:!0})}if(!1===r.requirementsSupported||void 0===r.requirementsSupported&&!n._contextActivationMgr.getRequirementsChecker().isManifestSupported(r)){r.requirementsSupported=!1;var d,p;return d=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR,p=u.ErrorStatusCodes.WAC_AgaveRequirementsError,void n._showActivationError(u.OsfControlStatus.ActivationFailed,d,t,t,null,t,t,!0,p)}if(r.requirementsSupported=!0,n._iframeUrl=r.getDefaultSourceLocation(n._contextActivationMgr.getFormFactor()),n._iframeUrl&&n.updateUrlsForSdx(),n._permission=r.getPermission(),n._appDomains=r.getAppDomains(),a===u.StoreType.SPApp&&n._iframeUrl&&(o.clientId&&(n._iframeUrl=n._iframeUrl.replace(/~clientid/gi,o.clientId)),o.appWebUrl&&(n._iframeUrl=n._iframeUrl.replace(/~appweburl/gi,o.appWebUrl)),o.remoteAppUrl&&(n._iframeUrl=n._iframeUrl.replace(/~remoteappurl/gi,o.remoteAppUrl))),!n._contextActivationMgr._doesUrlHaveSupportedProtocol(n._iframeUrl))return void n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,t,t,t,t,t,t,u.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);n.processManifestForCustomFunctions(r),n._isvirtualOsfControl?!o.showNewerVersion&&n.invokeVirtualOsfControlActivationCallback(r):n._createIframeAndActivateOsfControl(c)}else s.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+f.WACUtils.serializeObjectToString(e),t,t,18420422),n._showActivationError(u.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(n,n._refresh),t,t,t,t,u.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},isCurrentLocaleDefaultLocale:function(e){return e.getDefaultLocale().toLowerCase()!=this._contextActivationMgr.getAppUILocale().toLowerCase()},processManifestForExtendedOverrides:function(e,t){var n=this;return n._processManifestForExtendedOverridesPromise&&!n._isUpgrading?n._processManifestForExtendedOverridesPromise:(n._processManifestForExtendedOverridesPromise=n.processManifestForExtendedOverridesInternal(e,t),n._processManifestForExtendedOverridesPromise)},processManifestForExtendedOverridesInternal:function(e,t){var n=null,r=this,o=r;if(r._isManifestProcessedForExtendedOverrides&&!r._isUpgrading)return Promise.resolve(n);if(!e)return Promise.resolve(n);if(r.getInitializationReason()!==Microsoft.Office.WebExtension.InitializationReason.Inserted&&r.getInitializationReason()!==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened)return Promise.resolve(n);r._isManifestProcessedForExtendedOverrides=!0;try{if(!e.getExtendedOverrides().url){var i="Missing extendedOverrides url info for manifest contains ExtendedOverrides node";return s.RuntimeTelemetryHelper.LogExceptionTag(i,n,r.getCorrelationId(),572926145),Promise.reject(i)}f.ExtendedManifestUtility.ensureFinalExtendedOverridesUrls(e,r._contextActivationMgr)}catch(e){i="Failed to construct ExtendedOverrides";return s.RuntimeTelemetryHelper.LogExceptionTag(i,e,r.getCorrelationId(),572926144),Promise.reject(i)}if(e.getExtendedOverrides().hasFinalUrls&&!f.OsfExtendedManifestCache.wasExtendedManifestAlreadyFetched(e._id)){var a=[f.ExtendedManifestUtility.downloadContent(e.getExtendedOverrides().url)];return e.getExtendedOverrides().resourcesUrl&&e.getDefaultLocale().toLowerCase()!=r._contextActivationMgr.getAppUILocale().toLowerCase()&&a.push(f.ExtendedManifestUtility.downloadContent(e.getExtendedOverrides().resourcesUrl)),Promise.all(a).then((function(e){if(e.length<1||e.length>2){var r="Invalid number of files fetched.";throw s.RuntimeTelemetryHelper.LogExceptionTag(r,n,o.getCorrelationId(),572926115),r}var i=JSON.parse(e[0]),a=n;2==e.length&&(a=JSON.parse(e[1]));var c=f.ExtendedManifestUtility.validateAndSubstituteExtendedManifestTokens(i,a);if(!c){r="Did not get a validated extended manifest.";throw s.RuntimeTelemetryHelper.LogExceptionTag(r,n,o.getCorrelationId(),572926114),r}var l=f.ManifestUtil.constructAddInId(o._solutionId,o._version,o._storeType,o._storeId);return f.ShortcutsMappingTableManager.validateExtendedManifestShortcutKeys(c,l,!0).then((function(){t&&f.AddinShortcutsPreferenceSettingHelper.clearSettingsByExtendedManifest(c),f.OsfExtendedManifestCache.set(l,JSON.stringify(c));var e=new u.AddinIdInfo(l);o.sendParseExtendedManifestTelemetry(c.shortcuts,e.getPrivacyCompliantSolutionId(),o._storeType)})),n})).catch((function(e){throw s.RuntimeTelemetryHelper.LogExceptionTag("Promise rejected.",e,o.getCorrelationId(),572926113),e}))}return Promise.resolve(n)},sendParseExtendedManifestTelemetry:function(e,t,n){var r="function";if("object"==typeof Otel&&typeof Otel.Telemetry===r&&typeof Otel.Telemetry.sendOtelEvent===r){var o={otelEvent:{eventName:"Office.Extensibility.ExtendedManifest.ParseExtendedManifest",dataFields:[{name:"ContainsShortcut",dataType:0,value:e},{name:"SolutionId",dataType:1,value:t},{name:"StoreType",dataType:1,value:n}],telemetryProperties:f.TelemetryProperties}};Otel.Telemetry.sendOtelEvent(o)}else s.RuntimeTelemetryHelper.LogCommonMessageTag("The Otel isn't available, couldn't call sendOtelEvent for logging the shortcuts telemetry",null,572926112)},isCustomFunctionSandbox:function(){var e=this;if("object"==typeof e._settings&&"number"==typeof e._settings.length)for(var t=0;t<e._settings.length;t++)if("object"==typeof e._settings[t]&&"number"==typeof e._settings[t].length&&"string"==typeof e._settings[t][0]&&"string"==typeof e._settings[t][1]&&"customfunctionaddinid"==e._settings[t][0].toLowerCase())return!0;return!1},processManifestForCustomFunctions:function(e){var t=this,n=t;if((!t._isManifestProcessedForCustomFunctions||t._isUpgrading)&&(t._isManifestProcessedForCustomFunctions=!0,e&&e.containsCustomFunctionsForAppHost(t._contextActivationMgr._hostType))){var r=u.getManifestHostType(t._contextActivationMgr._hostType),o=t._contextActivationMgr.getFormFactor(),i=new f.Parser.ParsingContext(r,o,null,e),a=new f.Parser.AddinCommandsManifestParser(r,o),s={assetId:t._solutionId,appVersion:t._version,storeType:t._storeType,storeId:t._storeId,targetType:null},l={setErrorMessageForAddin:function(e,t){c.msAjaxDebug.trace("Error parsing app manifest: "+t)}},d=a.parseExtensions(s,e,l);if("object"==typeof d.ExtensionPoints&&"number"==typeof d.ExtensionPoints.length)for(var p=e.isXLLCompatible(),m=0;m<d.ExtensionPoints.length;m++)if("CustomFunctions"===d.ExtensionPoints[m].type){var h=d.ExtensionPoints[m],g=function(){var t={osfControl:n,locale:n._getCustomFunctionsLocale(e),invariantNamespace:n._getCustomFunctionsInvariantNamespace(i,h.namespaceResId),namespace:i.resources.ShortStrings[h.namespaceResId],metadataUrl:i.resources.Urls[h.metadataResId],title:e.getDefaultDisplayName(),isXllCompatible:p,manifest:e._xmlProcessor.getNodeXml(e._xmlProcessor.getDocumentElement())};n._contextActivationMgr._notifyHost(n._id,u.AgaveHostAction.InstallCustomFunctions,t)};t.isCustomFunctionSandbox()?(t._iframeUrl=i.resources.Urls[h.pageResId],t._isUpgrading&&g()):g();break}}},setIsUpgrading:function(e){this._isUpgrading=e},getIsUpgrading:function(){return this._isUpgrading},setUpgradingFailed:function(e){this._isUpgradingFailed=e},getUpgradingFailed:function(){return this._isUpgradingFailed},updateUrlsForSdx:function(e){var t=this;if(t.isFirstParty()){var n=".js",r=t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n,o=/^(?:[a-z]+:)?\/\//i.test(t._iframeUrl);if(r||!o){var i=void 0,a=r?"index.html":t._iframeUrl;if(null!==e){var s=e.lastIndexOf("/");-1!==s&&(i=e.substr(0,s)+"/"+a)}r&&(t._bundleUrl=t._iframeUrl),t._iframeUrl=null!=i?i:t._sdxIframeTemplateUrl}}},updateUrlsForSdxBundle:function(e){var t=this;if(t._contextActivationMgr._enableServiceDeliveredExperience){var n=".js";t._iframeUrl.substr(t._iframeUrl.length-n.length,n.length).toLowerCase()===n&&(t._bundleUrl=t._iframeUrl,t._iframeUrl=null!=e?e:t._sdxIframeTemplateUrl)}},_getCustomFunctionsLocale:function(e){return e._UILocale?e._UILocale.toLocaleLowerCase():e._defaultLocale?e._defaultLocale.toLocaleLowerCase():""},_getCustomFunctionsInvariantNamespace:function(e,t){var n=e.manifest._xmlProcessor.selectSingleNode("o:OfficeApp"),r=e.selectSingleNode(n,["ov:VersionOverrides","ov:Resources","bt:ShortStrings","bt:String [@id = '"+t+"']"]);return r?r.getAttribute("DefaultValue"):null},_lessThan:function(e,t){return u.OsfManifestManager.versionLessThan(e,t)},_showTrustError:function(e,t,n,r,o,i,a,s){var c=null,l=this,d=u.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,t||"");d=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var f=u.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,n||"");f=l._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(f),s=null==s?!!l.getManifest()&&l.getManifest().isSSOAddin():s;var p=Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,m=Strings.OsfRuntime.L_AgaveTrustAddIn_INFO,h=Strings.OsfRuntime.L_TrustButton_TXT,g=l._osfControlType===u.OsfControlType.DocumentLevel?u.NotificationType.TrustPromptContent:u.NotificationType.TrustPromptTaskpane;l._retryActivate=i,l._contextActivationMgr.displayNotification({id:l._id,infoType:u.InfoType.SecurityInfo,clientName:e,name:t||c,provider:n,title:p,description:m,icon:r||c,buttonTxt:h,buttonCallback:i,url:a||c,dismissCallback:c,reDisplay:!0,displayDeactive:!0,logAsError:!0,retryAll:!0,errorCode:u.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED,iframeNotificationUrl:null,notificationType:g})},_showActivationError:function(e,t,n,r,o,i,a,s,c){var l=!0,d=null,f=this;if(f._status=e,f._contextActivationMgr._enableFirstPartySDXErrorMessages&&f.isFirstParty())var p={id:f._id,infoType:u.InfoType.Error,status:e,title:a||Strings.OsfRuntime.L_AgaveErrorTile_TXT_FirstParty,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:o||d,dismissCallback:i||d,reDisplay:!i&&l,displayDeactive:l,detailView:!!s&&l,logAsError:l,errorCode:c||0};else p={id:f._id,infoType:u.InfoType.Error,status:e,title:a||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:t,icon:d,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||d,url:o||d,dismissCallback:i||d,reDisplay:!i&&l,displayDeactive:l,detailView:!!s&&l,logAsError:l,errorCode:c||0};f._contextActivationMgr.displayNotification(p),f._contextActivationMgr.raiseOsfControlStatusChange(f)},_showActivationWarning:function(e,t,n,r,o,i,a){var s=!0,c=null,l=this;if(l._status=e,l._contextActivationMgr._enableFirstPartySDXErrorMessages&&l.isFirstParty())var d={id:l._id,infoType:u.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT_FirstParty,description:t,icon:c,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||c,url:o||c,dismissCallback:i||c,reDisplay:!i&&s,displayDeactive:s,logAsError:s,errorCode:a||0};else d={id:l._id,infoType:u.InfoType.Warning,status:e,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:t,icon:c,buttonTxt:n||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:r||c,url:o||c,dismissCallback:i||c,reDisplay:!i&&s,displayDeactive:s,logAsError:s,errorCode:a||0};l._contextActivationMgr.displayNotification(d),l._contextActivationMgr.raiseOsfControlStatusChange(l)},_refresh:function(e){this.deActivate(),this.activate(e)},_activateAgavesBlockedBySandboxNotSupport:function(e){e.activateAgavesBlockedBySandboxNotSupport();var t=u.OUtil.getLocalStorage();t&&t.setItem(u.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(e){this._contextActivationMgr._setCachedFlag(e)},_getCachedFlag:function(e){return this._contextActivationMgr._getCachedFlag(e)},_deleteCachedFlag:function(e){this._contextActivationMgr._deleteCachedFlag(e)},_notifyHostIFrameOnLoaded:function(){var e=this;e._contextActivationMgr._changeGateOnPageReadyFix?e._contextActivationMgr._notifyHost&&!e._iframeLoadedNotified&&(e._contextActivationMgr._notifyHost(e._id,u.AgaveHostAction.PageIsReady),e._iframeLoadedNotified=!0):e._contextActivationMgr._notifyHost&&e._contextActivationMgr._notifyHost(e._id,u.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var t=document.createElement("a");t.href=e;var n=this.getEToken(),r=u.Constants.ETokenParameterName+"="+encodeURIComponent(u.OUtil.encodeBase64(n)),o=t.search.length>1?t.search.substr(1)+"&":"";t.search=o+r;var i=t.href;return t=null,i},_addAsQueryParameter:function(e,t,n){var r=document.createElement("a");r.href=e;var o=encodeURIComponent(t)+"="+encodeURIComponent(n),i=r.search.length>1?r.search.substr(1)+"&":"";r.search=i+o;var a=r.href;return r=null,a},_activate:function(e,t){var n="OsfControlId",r=!0,o=this,i=o;if(s.AppLoadTimeHelper.PageStart(o._telemetryContext),o._storeType===u.StoreType.Sdx){var a=performance.now(),c=!1,l=!1,d=!1,p=function(){d||(d=r,s.RuntimeTelemetryHelper.LogCommonMessageTag("SDX Activation Duration = "+(performance.now()-i._sdxTelemetryContext.activationStart)+".",null,42271587),f.SDXCatalog.recordActivationActivity(r,i._sdxTelemetryContext),i._solutionId.toLowerCase()===u.SdxAssetIds.ExperimentationSdx&&setTimeout((function(){return i.deActivate()}),6e4))};o._iframeOnLoadDelegate=Function.createDelegate(o,(function(){var e=this;e._sdxTelemetryContext.iframeOnLoadReceived=performance.now(),c||(c=r,f.SDXCatalog.recordActivity("PageLoad",a,r,[{name:n,string:e._id},{name:"AssetId",string:e._solutionId}]),l&&p()),e._iframeOnLoad.apply(e,arguments)})),o._iframeOnGetAppContextDelegate=function(){l||(l=r,f.SDXCatalog.recordActivity("OfficeJsReady",a,r,[{name:n,string:i._id},{name:"AssetId",string:i._solutionId}]),c&&p())}}o._setIframeAttribute(e,t),o._pageIsReadyTimerExpired=!1,u.OUtil.addEventListener(e,"load",o._iframeOnLoadDelegate),o._div.appendChild(e),o._status=u.OsfControlStatus.Activated,u.OUtil.writeProfilerMark(u.OsfControlActivationPerfMarker.ActivationEnd),o._contextActivationMgr.raiseOsfControlStatusChange(o),s.AppLoadTimeHelper.OfficeJSStartToLoad(o._telemetryContext)},_setIframeAttribute:function(e,t){var n=this;n._storeType!==u.StoreType.Sdx?t=n._addETokenAsQueryParameter(t):n._contextActivationMgr._enableDisplayUILocaleQueryString&&n.isFirstParty()&&(t=n._addAsQueryParameter(t,u.Constants.DisplayLanguageParameterName,n._contextActivationMgr._appUILocale));var r=n._contextActivationMgr.getClientId()+"_"+n._contextActivationMgr.getDocUrl()+"_"+n._id,o=u.OUtil.getFrameName(r);n._conversationId=u.OUtil.generateConversationId();var i=n._hostInfoFlags;u.OUtil.checkFlight(u.FlightTreatmentNames.LogAllAddinsAsPublic)&&(i|=u.HostInfoFlags.PublicAddin),u.OUtil.checkFlight(u.FlightTreatmentNames.IsPrivateAddin)&&(s.PrivacyRules.IsPrivateAddin(n._ownerAddinStoreType||n._storeType,n._storeId,n._exchangeExtensionProviderName,n._exchangeExtensionType,n._assetId)||(i|=u.HostInfoFlags.PublicAddin));var a=[n._contextActivationMgr._hostType,n._contextActivationMgr._hostPlatform,n._contextActivationMgr._hostSpecificFileVersion,n._contextActivationMgr._appUILocale,n.getCorrelationId(),n._isDialog?"isDialog":null,n._contextActivationMgr._disableLogging?"disableLogging":null,i].join("|"),c=t,l=window.location.origin;if(void 0===l||l&&"null"===l){var d=u.OUtil.parseUrl(window.location.href);l=d.protocol+"//"+d.hostname+(d.port?":"+d.port:"")}var p=n._conversationId+"|"+n._id+"|"+(l.indexOf("$")>=0?encodeURIComponent(l):l),m={};if(m[u.WindowNameItemKeys.BaseFrameName]=o,m[u.WindowNameItemKeys.HostInfo]=a,m[u.WindowNameItemKeys.XdmInfo]=p,m[u.WindowNameItemKeys.SerializerVersion]=u.SerializerVersion.Browser,m[u.WindowNameItemKeys.Flights]=JSON.stringify(u.Flights),n._solutionId.toLowerCase()===u.SdxAssetIds.ExperimentationSdx&&n.addProperty("sdxTelemetryContext",JSON.stringify(n._sdxTelemetryContext)),n._contextActivationMgr._enable3rdPartySetAppContextInIframeName||n.isFirstParty()){var h=n.getAppContext(),g=JSON.stringify(h).length;s.RuntimeTelemetryHelper.LogCommonMessageTag("AppContext length is: "+g,n.getCorrelationId(),593896220),g<u.MaxAppContextLength?(m[u.WindowNameItemKeys.AppContext]=h,n._appContextIsSetToIframeName=!0):s.RuntimeTelemetryHelper.LogCommonMessageTag("We got a huge appContext exceeding maximum, appContext length is: "+g,n.getCorrelationId(),593896219)}var v=u.OUtil.getLocalStorage();if(v){var y="CustomFunctionsRuntimeLogging",b=v.getItem(y);b&&(m[y]=b)}n._contextActivationMgr._getServiceEndPoint().registerConversation(n._conversationId,c,n._appDomains),e.setAttribute("src",c),n._sdxTelemetryContext.iframeUrl=c,n._agaveWindowName=f.WACUtils.serializeObjectToString(m),e.setAttribute("name",n._agaveWindowName),u.OUtil.addClass(e,"AddinIframe"),n._agavePageUrl=c},getAppContext:function(){var e=this,t=e.getEToken(),n=0;if(e._contextActivationMgr._hostSpecificFileVersion&&-1!=e._contextActivationMgr._hostSpecificFileVersion.indexOf(".")){var r=e._contextActivationMgr._hostSpecificFileVersion.split("."),o=r[1];isNaN(o)||(n=parseInt(r[1]))}var i=e._contextActivationMgr._requirementsChecker._getSupportedSet(),a=new u.OfficeAppContext(e.getSolutionId(),e._contextActivationMgr._appName,e._contextActivationMgr._appVersion,e._contextActivationMgr._appUILocale,e._contextActivationMgr._dataLocale,e._contextActivationMgr._docUrl||window.location.href,e._contextActivationMgr._clientMode,e.getSettings(),e.getReason(),e.getOsfControlType(),t,e._appCorrelationId,e.getID(),!1,!0,n,i,e.getHostCustomMessage(),e._contextActivationMgr._hostFullVersion||u.Constants.FileVersion,window.innerHeight,window.innerWidth,e.getManifest()?e.getManifest().getDefaultDisplayName():null,e._appDomains,void 0,e.getFeatureGates(),void 0,e._initialDisplayMode);a._wacHostEnvironment=e._contextActivationMgr._wacHostEnvironment||"0",a._isFromWacAutomation=!!e._contextActivationMgr._isFromWacAutomation,a._addInSourceLocationSubdomainAllowedIsEnabled=!0,a._addInSourceUrl=e._agavePageUrl,a._appSettings=e._contextActivationMgr._appSettings;var s=e._contextActivationMgr._uiHostSupportsAuthTokenAddinList;if(s){var c=e.getSolutionId();c&&(c=c.toLowerCase());for(var l=0;l<s.length;l++)if(c===s[l]){a._wopiHostOriginForSingleSignOn=e._contextActivationMgr._wopiHostOriginFromWacPropBag;break}}return a},ensureAgaveEndPoint:function(){var e=this;if(!e._agaveEndPoint){var t=e._conversationId+u.SharedConstants.NotificationConversationIdSuffix;e._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(t,e._frame.contentWindow,e._iframeUrl)}},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var e=!1;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{get:function(){return this.desc},set:function(e){this.desc=e}}),e=!0}catch(e){}return e},_isAddinCommands:function(e){var t=this;if(t._isvirtualOsfControl)e(!0);else if(t._contextActivationMgr._enableAddinCommands&&t._contextActivationMgr._enableTaskpaneUpgradeToAppCommand&&null!=t._virtualOsfControlActivationCallback){var n={marketplaceId:t._solutionId,marketplaceVersion:t._version,storeType:t._storeType,storeId:t._storeId,targetData:{}};t._contextActivationMgr.isAddinCommandsAsync(n,(function(t,n){e(n)}))}else e(!1)}},function(e){var t=function(){var t=null;function n(){}return n.getAll=function(){var r=[],o=[];return e.OsfCache.get(e.OsfCache.c_osfCacheTableName,n.c_osfExtendedManifestIdsCacheKey).then((function(n){return n?(JSON.parse(n).forEach((function(t){o.push(e.OsfCache.get(e.OsfCache.c_extendedManifestTableName,t).then((function(e){if(e){var n={addinId:t,extendedManifest:JSON.parse(e)};r.push(n)}})))})),Promise.all(o)):t})).then((function(){return r}))},n.get=function(n){return e.OsfCache.get(e.OsfCache.c_extendedManifestTableName,n).then((function(e){return e?{addinId:n,extendedManifest:JSON.parse(e)}:t}))},n.set=function(t,r){var o=this,i=JSON.stringify(JSON.parse(r)),a=[];return e.OsfCache.get(e.OsfCache.c_osfCacheTableName,n.c_osfExtendedManifestIdsCacheKey).then((function(e){return e?(a=JSON.parse(e)).indexOf(t)<0?(a.push(t),o.setExtendedManifestHelper(a,t,i,!1)):o.setExtendedManifestHelper(a,t,i,!0):(a.push(t),o.setExtendedManifestHelper(a,t,i,!1))}))},n.clear=function(r){var o=this,i=[];return e.OsfCache.get(e.OsfCache.c_osfCacheTableName,n.c_osfExtendedManifestIdsCacheKey).then((function(e){var n="The addin to be removed isn't in cache";if(e){var a=(i=JSON.parse(e)).indexOf(r);if(!(a<0))return i.splice(a,1),o.clearExtendedManifestHelper(i,r);s.RuntimeTelemetryHelper.LogCommonMessageTag(n,t,572926110)}else s.RuntimeTelemetryHelper.LogCommonMessageTag(n,t,572926111)}))},n.wasExtendedManifestAlreadyFetched=function(e){return n.s_fetchedExtendedManifestIdsInMemory&&n.s_fetchedExtendedManifestIdsInMemory.indexOf(e)>=0},n.onChanged=function(e){n.s_onCacheChangedCallbacks.push(e)},n.clearExtendedManifestHelper=function(t,r){return e.OsfCache.remove(e.OsfCache.c_extendedManifestTableName,r).then((function(){var o=n.s_fetchedExtendedManifestIdsInMemory.indexOf(r);return n.s_fetchedExtendedManifestIdsInMemory.splice(o,1),e.OsfCache.set(e.OsfCache.c_osfCacheTableName,n.c_osfExtendedManifestIdsCacheKey,JSON.stringify(t)).then((function(){n.processCallbacks()}))}))},n.setExtendedManifestHelper=function(t,r,o,i){return i?e.OsfCache.get(e.OsfCache.c_extendedManifestTableName,r).then((function(t){if(o!=t)return e.OsfCache.set(e.OsfCache.c_extendedManifestTableName,r,o).then((function(){n.processCallbacks()}))})):e.OsfCache.set(e.OsfCache.c_extendedManifestTableName,r,o).then((function(){return n.s_fetchedExtendedManifestIdsInMemory.push(r),e.OsfCache.set(e.OsfCache.c_osfCacheTableName,n.c_osfExtendedManifestIdsCacheKey,JSON.stringify(t)).then((function(){n.processCallbacks()}))}))},n.processCallbacks=function(){n.s_onCacheChangedCallbacks.forEach((function(e){e()}))},n.c_osfExtendedManifestIdsCacheKey="OsfExtendedManifestIds",n.s_fetchedExtendedManifestIdsInMemory=[],n.s_onCacheChangedCallbacks=[],n}();e.OsfExtendedManifestCache=t,t.onChanged((function(){e.ActionMetadataManager.init(!1)}))}(f||(f={})),u.OUtil.setNamespace("Manifest",u),u.Manifest.HostApp=function(e){this._appName=e,this._minVersion=null},u.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(e){this._minVersion=e}},u.Manifest.ExtensionSettings=function(){this._sourceLocations={},this._defaultHeight=null,this._defaultWidth=null},u.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(e,t){this._sourceLocations[e.toLocaleLowerCase()]=t},_setDefaultWidth:function(e){this._defaultWidth=e},_setDefaultHeight:function(e){this._defaultHeight=e}},u.Manifest.WebAppInfoAuthorization=function(){this._resource=null,this._scopes=null},u.Manifest.WebAppInfoAuthorization.prototype={getResource:function(){return this._resource},getScopes:function(){return this._scopes}},u.Manifest.EquivalentAddins=function(){this._equivalentAddins=[]},u.Manifest.EquivalentAddins.prototype={isXLLCompatible:function(){for(var e=0;e<this._equivalentAddins.length;e++)if(this._equivalentAddins[e].isXLLCompatible())return!0;return!1},add:function(e){this._equivalentAddins.push(e)},getEquivalentAddins:function(){return this._equivalentAddins}},u.Manifest.EquivalentAddin=function(){this._progId=null,this._fileName=null,this._type=null},u.Manifest.EquivalentAddin.prototype={getProgId:function(){return this._progId},getFileName:function(){return this._fileName},getType:function(){return this._type},isXLLCompatible:function(){return"XLL"==this._type},isComAddin:function(){return"COM"==this._type}},function(e){e[e.Short=0]="Short",e[e.Long=1]="Long"}(d||(d={})),u.Manifest.Runtimes=function(){this._runtimes=[]},u.Manifest.Runtimes.prototype={getSharedRuntime:function(e){var t=null,n=this;if(e==t||n._runtimes==t)return t;for(var r=0;r<n._runtimes.length;r++)if(n._runtimes[r]!=t&&n._runtimes[r].Resid===e)return n._runtimes[r];return t},add:function(e){if(null!=e&&null!=this._runtimes){if(null!=this.getSharedRuntime(e.Resid))throw c.msAjaxError.argument("Manifest parser failure: cannot have same Resid for different runtime.");this._runtimes.push(e)}},getRuntimes:function(){return this._runtimes}},u.Manifest.Runtime=function(){this.Resid=null,this.LifeTime=d.Short},u.Manifest.Manifest=function(e,t){var n=null,r="ov:VersionOverrides",o="VersionOverrides",i="xsi:type",a="o:OfficeApp",s="1.1",l=this;if(l._UILocale=t||"en-us","string"==typeof e){var p;l._displayNames={},l._descriptions={},l._iconUrls={},l._extensionSettings={},l._highResolutionIconUrls={},l._versionOverrides={},l._ribbonExtensionControls={},l._xmlProcessor=new u.XmlProcessor(e,u.ManifestNamespaces[s]),l._xmlProcessor.selectSingleNode(a)?(p=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Hosts",h);e._hosts=e._parseHosts(t),t&&(e._hostsXml=t.xml||t.outerHTML);t=e._xmlProcessor.selectSingleNode("o:Requirements",h),e._requirements=e._parseRequirements(t),t&&(e._requirementsXml=t.xml||t.outerHTML);(t=e._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",h))&&e._parseLocaleAwareSettings(t,Function.createDelegate(e,e._addHighResolutionIconUrl))},l._manifestSchemaVersion=u.ManifestSchemaVersion[s]):(l._xmlProcessor=new u.XmlProcessor(e,u.ManifestNamespaces["1.0"]),p=function(){var e=this,t=e._xmlProcessor.selectSingleNode("o:Capabilities",h),n=e._xmlProcessor.selectNodes("o:Capability",t);e._capabilities=e._parseCapabilities(n)},l._manifestSchemaVersion=u.ManifestSchemaVersion["1.0"]);var m=l._xmlProcessor.getDocumentElement();l._target=u.OUtil.parseEnum(m.getAttribute(i),u.OfficeAppType);var h=l._xmlProcessor.selectSingleNode(a);if(m=l._xmlProcessor.selectSingleNode("o:Id",h),l._id=l._xmlProcessor.getNodeValue(m),!new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i").test(l._id))throw c.msAjaxError.argument("Manifest");m=l._xmlProcessor.selectSingleNode("o:Version",h);try{l._version=l.complementVersion(l._xmlProcessor.getNodeValue(m))}catch(e){l._version=l._xmlProcessor.getNodeValue(m)}if(m=l._xmlProcessor.selectSingleNode("o:ProviderName",h),l._providerName=l._xmlProcessor.getNodeValue(m),m=l._xmlProcessor.selectSingleNode("o:IdIssuer",h),l._idIssuer=l._parseIdIssuer(m),(m=l._xmlProcessor.selectSingleNode("o:AlternateId",h))&&(l._alternateId=l._xmlProcessor.getNodeValue(m)),m=l._xmlProcessor.selectSingleNode("o:DefaultLocale",h),l._defaultLocale=l._xmlProcessor.getNodeValue(m),m=l._xmlProcessor.selectSingleNode("o:DisplayName",h),l._parseLocaleAwareSettings(m,Function.createDelegate(l,l._addDisplayName)),m=l._xmlProcessor.selectSingleNode("o:Description",h),l._parseLocaleAwareSettings(m,Function.createDelegate(l,l._addDescription)),m=l._xmlProcessor.selectSingleNode("o:AppDomains",h),l._appDomains=l._parseAppDomains(m),(m=l._xmlProcessor.selectSingleNode("o:IconUrl",h))&&l._parseLocaleAwareSettings(m,Function.createDelegate(l,l._addIconUrl)),(m=l._xmlProcessor.selectSingleNode("o:Signature",h))&&(l._signature=l._xmlProcessor.getNodeValue(m)),l._parseExtensionSettings(),m=l._xmlProcessor.selectSingleNode("o:Permissions",h),l._permissions=l._parsePermission(m),l._allowSnapshot=!0,(m=l._xmlProcessor.selectSingleNode("o:AllowSnapshot",h))&&(l._allowSnapshot=l._parseBooleanNode(m)),l._manifestSchemaVersion===u.ManifestSchemaVersion[s]){var g="ov:";if(l._target==u.OfficeAppType.ContentApp&&(g="c:"),m=l._xmlProcessor.selectSingleNode(g+o,h)){var v=l._xmlProcessor.selectSingleNode(g+"WebApplicationInfo",m);if(v){var y=l._xmlProcessor.selectSingleNode(g+"Resource",v);l._webApplicationResource=l._xmlProcessor.getNodeValue(y);var b=l._xmlProcessor.selectSingleNode(g+"Id",v);l._webApplicationId=l._xmlProcessor.getNodeValue(b);var O=l._xmlProcessor.selectSingleNode(g+"MsaId",v);l._webApplicationMsaId=O?l._xmlProcessor.getNodeValue(O):l._webApplicationId;var S=l._xmlProcessor.selectSingleNode(g+"Scopes",v);l._webApplicationScopes=l._parseWebApplicationScopes(S,g),l._webApplicationAuthorizations=l._parseWebAppInfoAuthorizations(v,g)}}}if(l._manifestSchemaVersion===u.ManifestSchemaVersion[s]&&l._target==u.OfficeAppType.TaskPaneApp){g="ov:";if(m=l._xmlProcessor.selectSingleNode(g+o,h)){var C=l._xmlProcessor.selectSingleNode(g+"EquivalentAddins",m);l._equivalentAddins=l._parseEquivalentAddins(C,g)}}if(l._manifestSchemaVersion===u.ManifestSchemaVersion[s])(A=l._xmlProcessor.selectSingleNode(r,h))&&(l._manifestSourceLocationOverrides=l._parseSourceLocationOverrides(A));if(l._manifestSchemaVersion===u.ManifestSchemaVersion[s]&&l._target==u.OfficeAppType.TaskPaneApp){var A,_=l._xmlProcessor.selectSingleNode("o:ExtendedOverrides",h);if(_!=n&&l._parseExtendedOverrides(_),(A=l._xmlProcessor.selectSingleNode(r,h))!==n){var I=l._xmlProcessor.selectSingleNode("ov:Hosts",A);if(I!==n){var x=l._xmlProcessor.selectNodes("ov:Host",I);if(x!==n)for(var E=x.length,T=0;T<E;T++){var w=x[T].getAttribute(i);if("Document"===w||"Workbook"===w||"Presentation"===w){l._versionOverrides[w]={};var M=l._xmlProcessor.selectSingleNode("ov:Runtimes",x[T]);if(M)l._versionOverrides[w]._runtimes=l._parseRuntimes(M);else{var k=new u.Manifest.Runtime;k.Resid="OEP.SharedRuntime.Url",k.LifeTime=d.Long;var j=new u.Manifest.Runtimes;j.add(k),l._versionOverrides[w]._runtimes=j}var P=new f.Parser.AddinCommandsManifestParser(w,"DesktopFormFactor"),R=new f.Parser.AddinCommandsManifestParser(w,"AllFormFactors"),N={setErrorMessageForAddin:function(e){c.msAjaxDebug.trace("Error parsing app manifest: "+e)}},D={assetId:l._id,appVersion:l._version,storeType:n,storeId:n,targetType:n},F=P.parseExtensions(D,l,N),L=R.parseExtensions(D,l,N);l._versionOverrides[w]._addinCommandsExtensionPoints=F.ExtensionPoints,l._versionOverrides[w]._functionFileResid=F.functionFileResid,l._versionOverrides[w]._customFunctionExtensionPoint=L.ExtensionPoints[0],l._versionOverrides[w]._showTaskpaneControls=l._retrieveAppCommandShowTaskpaneControls(w),l._validateShowTaskpaneSharedRuntime(w),l._generateRibbonExtensionControlMap(w)}}}}}p.apply(l)}else e(l)},u.Manifest.Manifest.prototype={getSourceLocationOverrideByResourceId:function(e){return e&&this._manifestSourceLocationOverrides?this._manifestSourceLocationOverrides[e]:null},getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(e){return this._displayNames[e.toLocaleLowerCase()]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(e){return this._descriptions[e]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(e){return this._iconUrls[e]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(e,t){return this._getExtensionSetting(t).getSourceLocations()[e.toLocaleLowerCase()]},getDefaultSourceLocation:function(e){var t=this._getExtensionSetting(e).getSourceLocations();return this._getDefaultValue(t)},getDefaultWidth:function(e){return this._getExtensionSetting(e).getDefaultWidth()},getDefaultHeight:function(e){return this._getExtensionSetting(e).getDefaultHeight()},getTarget:function(){return this._target},getOmexTargetCode:function(){switch(this._target){case u.OfficeAppType.ContentApp:return 2;case u.OfficeAppType.TaskPaneApp:return 1;case u.OfficeAppType.MailApp:return 3;default:return 0}},getPermission:function(){return this._permissions},hasPermission:function(e){return(this._permissions&e)===e},getHosts:function(){return this._hosts},getHostsXml:function(){return this._hostsXml},getRequirements:function(){return this._requirements},getRequirementsXml:function(){return this._requirementsXml},getHighResolutionIconUrl:function(e){return this._highResolutionIconUrls[e]},getDefaultHighResolutionIconUrl:function(){return this._getDefaultValue(this._highResolutionIconUrls)},getAppDomains:function(){return this._appDomains},getInMemoryEToken:function(){return this._inMemoryEToken},isAllowSnapshot:function(){return this._allowSnapshot},addManifestUrl:function(e){var t=f.WACUtils.getDomainForUrl(e);-1===this._appDomains.indexOf(t)&&this._appDomains.push(t)},getWebApplicationResource:function(){return this._webApplicationResource},getWebApplicationId:function(){return this._webApplicationId},getWebApplicationMsaId:function(){return this._webApplicationMsaId},getWebApplicationScopes:function(){return this._webApplicationScopes},getWebApplicationAuthorizations:function(){return this._webApplicationAuthorizations},getEquivalentAddins:function(){return this._equivalentAddins?this._equivalentAddins.getEquivalentAddins():[]},isXLLCompatible:function(){return!!this._equivalentAddins&&this._equivalentAddins.isXLLCompatible()},isSSOAddin:function(){return!!this._webApplicationResource&&!!this._webApplicationId},containsAddinCommands:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t&&null!=this._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",t))return!0;return!1},getRibbonExtensionControlMap:function(){return this._ribbonExtensionControls},getExtendedOverrides:function(){return this._extendedOverrides},getExtendedOverridesTokens:function(){return this._extendedOverridesTokens?this._extendedOverridesTokens:[]},containsCustomFunctions:function(e){var t=this._getCurrentHostTypeNode(e);if(null!==t){var n=this._xmlProcessor.selectSingleNode("ov:AllFormFactors",t);if(null!==n){var r=this._xmlProcessor.selectNodes("ov:ExtensionPoint",n);if(null!==r)for(var o=r.length,i=0;i<o;i++){if("CustomFunctions"===r[i].getAttribute("xsi:type"))return!0}}}return!1},containsCustomFunctionsForAppHost:function(e){var t=u.getManifestHostType(e);return e!=u.HostType.Outlook&&this.containsCustomFunctions(t)},getSharedRuntimeForCustomFunctions:function(e){var t=null;if(e==t||this._versionOverrides==t)return t;var n=this._versionOverrides[e];return n==t||n._customFunctionExtensionPoint==t||n._runtimes==t?t:n._runtimes.getSharedRuntime(n._customFunctionExtensionPoint.pageResId)},getSharedRuntimeForTaskpane:function(e,t){var n=null;if(e==n||t==n||this._versionOverrides==n)return n;var r=this._versionOverrides[e];if(r==n||r._showTaskpaneControls==n||r._runtimes==n)return n;var o=n;return this._iterateAppCommandShowTaskpaneControls(r._showTaskpaneControls,(function(e){return e!=n&&e.action!=n&&((e.action.taskpaneId===t||e.id===t)&&(o=e.action.sourceLocationResid,!0))})),o==n?n:r._runtimes.getSharedRuntime(o)},getTaskpaneIdByRuntimeId:function(e,t){var n=null;if(e==n||t==n||this._versionOverrides==n)return n;var r=this._versionOverrides[e];if(r==n||r._showTaskpaneControls==n||r._runtimes==n)return n;var o=n;return this._iterateAppCommandShowTaskpaneControls(r._showTaskpaneControls,(function(e){return e!=n&&e.action!=n&&(e.action.sourceLocationResid===t&&(o=e.action.taskpaneId,!0))})),o},getSharedRuntimeById:function(e,t){var n=null;if(this._versionOverrides==n)return n;var r=this._versionOverrides[e];return r==n||r._runtimes==n?n:r._runtimes.getSharedRuntime(t)},getSharedRuntimeForAppCmdsExecuteFunction:function(e){var t=null;if(e==t||this._versionOverrides==t)return t;var n=this._versionOverrides[e];return n==t||n._runtimes==t?t:n._runtimes.getSharedRuntime(n._functionFileResid)},getSharedRuntimeId:function(e,t,n){var r=t?this.getSharedRuntimeForAppCmdsExecuteFunction(e):this.getSharedRuntimeForTaskpane(e,n);return null!==r?r.Resid:null},sharedRuntimeHasShortLifeTime:function(e,t){var n=null;if(e===n||t===n||this._versionOverrides===n)return!1;var r=this._versionOverrides[e];if(r===n||r._runtimes===n)return!1;var o=r._runtimes.getSharedRuntime(t);return o!==n&&o.LifeTime===d.Short},complementVersion:function(e){return RegExp("^[0-9]{1,5}(\\.[0-9]{1,5}){3}$").test(e)||(RegExp("^[0-9]{1,5}(\\.[0-9]{1,5}){2}$").test(e)?e+=".0":RegExp("^[0-9]{1,5}\\.[0-9]{1,5}$").test(e)?e+=".0.0":RegExp("^[0-9]{1,5}$").test(e)&&(e+=".0.0.0")),e},_iterateAppCommandShowTaskpaneControls:function(e,t){if(null!=e&&null!=t)for(var n=0;n<e.length&&!t(e[n]);n++);},_generateRibbonExtensionControlMap:function(e){var t=null,n=this;if(e==t||n._versionOverrides==t)return t;var r=n._versionOverrides[e];if(r!=t&&r._addinCommandsExtensionPoints!=t)for(var o=r._addinCommandsExtensionPoints.length,i=0;i<o;i++){var a=r._addinCommandsExtensionPoints[i];if("PrimaryCommandSurface"===a.type&&a.tabs)for(var s=0;s<a.tabs.length;s++){var c=a.tabs[s];n._ribbonExtensionControls[c.id]=c,n._addRibbonControlsToMap(c)}}},_addRibbonControlsToMap:function(e){if(e&&e.children)for(var t=0;t<e.children.length;t++){var n=e.children[t];!n||n instanceof f.Parser.MenuControl||(this._ribbonExtensionControls[n.id]=n),this._addRibbonControlsToMap(n)}},_retrieveAppCommandShowTaskpaneControls:function(e){var t=null,n=this;if(e==t||n._versionOverrides==t)return t;var r=n._versionOverrides[e],o=[];if(r!=t&&r._addinCommandsExtensionPoints!=t)for(var i=r._addinCommandsExtensionPoints.length,a=0;a<i;a++){var s=r._addinCommandsExtensionPoints[a];if(s!=t)if("PrimaryCommandSurface"===s.type){if(s.tabs==t)continue;for(var c=0;c<s.tabs.length;c++){var u=s.tabs[c];if(u!=t&&u.children!=t)for(var l=0;l<u.children.length;l++){var d=u.children[l];d!=t&&d.children!=t&&n._getShowTaskpaneControlsFromControlsParent(d,o)}}}else if("ContextMenu"===s.type){if(s.children==t)continue;var f=s.children[0];if(f==t||f.children==t)continue;n._getShowTaskpaneControlsFromControlsParent(f,o)}}return o},_getShowTaskpaneControlsFromControlsParent:function(e,t){var n="ShowTaskpane",r=null;if(e!=r&&e.children!=r&&t!=r)for(var o=0;o<e.children.length;o++){var i=e.children[o];if(i!=r)if("Button"===i.controlType)i.action!=r&&i.actionType===n&&t.push(i);else{if(i.children==r)continue;for(var a=0;a<i.children.length;a++){var s=i.children[a];s!=r&&s.action!=r&&s.actionType===n&&t.push(s)}}}},_validateShowTaskpaneSharedRuntime:function(e){var t=null;if(e!=t&&this._versionOverrides!=t){var n=this._versionOverrides[e];if(n!=t&&n._runtimes!=t&&n._showTaskpaneControls!=t){var r=[];this._iterateAppCommandShowTaskpaneControls(n._showTaskpaneControls,(function(e){var o="Manifest parser failure: resid and taskpaneid not correct";if(e==t||e.action==t)return!1;var i=n._runtimes.getSharedRuntime(e.action.sourceLocationResid),a=t;if(i==t||i.LifeTime!=d.Long){if(e.action.taskpaneId==t)return!1}else a=i.Resid;for(var s=[e.action.taskpaneId,a],u=!0,l=0;l<r.length;l++){if(r[l][0]==s[0]&&r[l][1]==s[1]){if(s[0]==t)throw c.msAjaxError.argument(o);u=!1;break}if(r[l][1]==s[1]&&r[l][1]!=t||r[l][0]==s[0]&&r[l][0]!=t)throw u=!1,c.msAjaxError.argument(o)}return u&&r.push(s),!1}))}}},_getDefaultValue:function(e){var t,n=this;if(n._UILocale&&(t=e[n._UILocale]||e[n._UILocale.toLocaleLowerCase()]||void 0),!t&&n._defaultLocale&&(t=e[n._defaultLocale]||e[n._defaultLocale.toLocaleLowerCase()]||void 0),!t){var r;for(var o in e){r=o;break}t=e[r]}return t},_getExtensionSetting:function(e){var t,n=this;if(void 0!==n._extensionSettings[e])t=n._extensionSettings[e];else for(var r in n._extensionSettings){t=n._extensionSettings[r];break}return t},_addDisplayName:function(e,t){this._displayNames[e.toLocaleLowerCase()]=t},_addDescription:function(e,t){this._descriptions[e]=t},_addIconUrl:function(e,t){this._iconUrls[e]=t},_parseLocaleAwareSettings:function(e,t){if(!e)throw c.msAjaxError.argument("Manifest");var n=e.getAttribute("DefaultValue");t(this._defaultLocale,n);var r=this._xmlProcessor.selectNodes("o:Override",e);if(r)for(var o=r.length,i=0;i<o;i++){var a=r[i];t(a.getAttribute("Locale"),a.getAttribute("Value"))}},_parseBooleanNode:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e).toLowerCase();return"true"===t||"1"===t}return!1},_parseIdIssuer:function(e){if(e){var t=this._xmlProcessor.getNodeValue(e);return u.OUtil.parseEnum(t,u.ManifestIdIssuer)}return u.ManifestIdIssuer.Custom},_parseCapabilities:function(e){for(var t,n=[],r=0;r<e.length;r++){t=e[r].getAttribute("Name"),t=u.OUtil.parseEnum(t,u.Capability),n.push(t)}return n},_parsePermission:function(e){if(!e)throw c.msAjaxError.argument("Manifest");var t=this._xmlProcessor.getNodeValue(e);return u.OUtil.parseEnum(t,u.OsfControlPermission)},_parseExtensionSettings:function(){var e,t,n,r=this,o=r;for(var i in u.FormFactor){var a=r._xmlProcessor.selectSingleNode("o:OfficeApp");if(t=r._xmlProcessor.selectSingleNode("o:"+u.FormFactor[i],a)){e=new u.Manifest.ExtensionSettings,n=r._xmlProcessor.selectSingleNode("o:SourceLocation",t);r._parseLocaleAwareSettings(n,(function(t,n){e._addSourceLocation(t,n),o.addManifestUrl(n)})),(n=r._xmlProcessor.selectSingleNode("o:RequestedWidth",t))&&e._setDefaultWidth(r._xmlProcessor.getNodeValue(n)),(n=r._xmlProcessor.selectSingleNode("o:RequestedHeight",t))&&e._setDefaultHeight(r._xmlProcessor.getNodeValue(n)),r._extensionSettings[i]=e}}if(!e)throw c.msAjaxError.argument("Manifest")},_parseHosts:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Host",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseWebApplicationScopes:function(e,t){var n=[];if(e)for(var r=this._xmlProcessor.selectNodes(t+"Scope",e),o=0;o<r.length;o++)n.push(this._xmlProcessor.getNodeValue(r[o]));return n},_parseWebAppInfoAuthorizations:function(e,t){var n=this,r=[],o=n._xmlProcessor.selectSingleNode(t+"Authorizations",e);if(o){var i=n._xmlProcessor.selectNodes(t+"Authorization",o);if(i)for(var a=0;a<i.length;a++){var s=i[a],c=new u.Manifest.WebAppInfoAuthorization,l=n._xmlProcessor.selectSingleNode(t+"Resource",s);l&&(c._resource=n._xmlProcessor.getNodeValue(l));var d=n._xmlProcessor.selectSingleNode(t+"Scopes",s);if(d){var f=n._xmlProcessor.selectNodes(t+"Scope",d);if(f){for(var p=[],m=0;m<f.length;m++){var h=f[m];p.push(n._xmlProcessor.getNodeValue(h))}c._scopes=p}}r.push(c)}}return r},_parseRequirements:function(e){var t=this,n={sets:[],methods:[]};if(e){var r=t._xmlProcessor.selectSingleNode("o:Sets",e);n.sets=t._parseSets(r);var o=t._xmlProcessor.selectSingleNode("o:Methods",e);n.methods=t._parseMethods(o)}return n},_parseSets:function(e){var t=[];if(e)for(var n=e.getAttribute("DefaultMinVersion"),r=this._xmlProcessor.selectNodes("o:Set",e),o=0;o<r.length;o++){var i=r[o],a=i.getAttribute("MinVersion");t.push({name:i.getAttribute("Name"),version:a||n})}return t},_parseMethods:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:Method",e),r=0;r<n.length;r++)t.push(n[r].getAttribute("Name"));return t},_parseSourceLocationOverrides:function(e){var t={};if(e){var n=this._xmlProcessor.selectSingleNode("ov:Resources",e);if(n){var r=this._xmlProcessor.selectSingleNode("bt:Urls",n);if(r){var o=this._xmlProcessor.selectNodes("bt:Url",r);if(o)for(var i=0;i<o.length;i++){var a=o[i],s=a.getAttribute("id"),c=a.getAttribute("DefaultValue");s&&c&&(t[s]=c)}}}}return t},_parseAppDomains:function(e){var t=[];if(e)for(var n=this._xmlProcessor.selectNodes("o:AppDomain",e),r=0;r<n.length;r++){var o=f.WACUtils.getDomainForUrl(this._xmlProcessor.getNodeValue(n[r]));-1===t.indexOf(o)&&t.push(o)}return t},_parseRuntimes:function(e){var t=null;if(e==t)return t;var n=new u.Manifest.Runtimes,r=this._xmlProcessor.selectNodes("ov:Runtime",e);if(r==t)return t;for(var o=0;o<r.length;o++){var i=this._parseRuntime(r[o]);n.add(i)}return n},_parseRuntime:function(e){if(null==e)return null;var t=new u.Manifest.Runtime;return t.Resid=e.getAttribute("resid"),"long"===e.getAttribute("lifetime")?t.LifeTime=d.Long:t.LifeTime=d.Short,t},_parseEquivalentAddins:function(e,t){var n=new u.Manifest.EquivalentAddins;if(e)for(var r=this._xmlProcessor.selectNodes(t+"EquivalentAddin",e),o=0;o<r.length;o++){var i=this._parseEquivalentAddin(r[o],t);n.add(i)}return n},_parseEquivalentAddin:function(e,t){var n=this,r=new u.Manifest.EquivalentAddin;if(e){var o=n._xmlProcessor.selectSingleNode(t+"ProgId",e);o&&(r._progId=n._xmlProcessor.getNodeValue(o));var i=n._xmlProcessor.selectSingleNode(t+"FileName",e);i&&(r._fileName=n._xmlProcessor.getNodeValue(i));var a=n._xmlProcessor.selectSingleNode(t+"Type",e);if(!a)throw c.msAjaxError.argument("Manifest");var s=""+n._xmlProcessor.getNodeValue(a);r._type=s.toUpperCase()}return r},_parseExtendedOverrides:function(e){var t="xsi:type",n=this;n._extendedOverrides={url:e.getAttribute("Url"),resourcesUrl:e.getAttribute("ResourcesUrl"),hasFinalUrls:!1};var r=n._xmlProcessor.selectSingleNode("o:Tokens",e);if(null!=r){var o=n._xmlProcessor.selectNodes("o:Token",r);if(null!=o){for(var i=[],a=0;a<o.length;a++){var s=o[a],c=n._xmlProcessor.selectNodes("o:Override",s),l=[],d=s.getAttribute(t);if(d==u.ExtendedManifestSupportTokens.Requirements)for(var f=0;f<c.length;f++){var p=n._xmlProcessor.selectSingleNode("o:Requirements",c[f]),m={value:c[f].getAttribute("Value"),data:n._parseRequirements(p)};l.push(m)}else if(d==u.ExtendedManifestSupportTokens.Locale)for(f=0;f<c.length;f++){m={value:c[f].getAttribute("Value"),data:c[f].getAttribute("Locale").toLowerCase()};l.push(m)}var h={name:s.getAttribute("Name"),defaultValue:s.getAttribute("DefaultValue"),type:s.getAttribute(t),overrides:l};i.push(h)}n._extendedOverridesTokens=i}}},_addHighResolutionIconUrl:function(e,t){this._highResolutionIconUrls[e]=t},_isAddinCommandsManifest:function(e){return this.containsAddinCommands(e)||this.containsCustomFunctions(e)},_getCurrentHostTypeNode:function(e){var t=null,n=this,r=n._xmlProcessor.selectSingleNode("o:OfficeApp");if(r!==t&&n.getManifestSchemaVersion()===u.ManifestSchemaVersion[1.1]){var o=n._xmlProcessor.selectSingleNode("ov:VersionOverrides",r);if(o!==t){var i=n._xmlProcessor.selectSingleNode("ov:Hosts",o);if(i!==t){var a=n._xmlProcessor.selectNodes("ov:Host",i);if(a!==t)for(var s=a.length,c=0;c<s;c++){if(a[c].getAttribute("xsi:type")===e)return a[c]}}}}return t}},u.OsfManifestManager=function(){var e="undefined",t="marketplaceVersion",n="marketplaceID",r="string",o=!0,i=null,a=!1,c={},l="en-us",d={};function p(e,t){return e+"_"+t}return{getManifestAsync:function(e,t){var n="OEM_getManifestAsync",l="getManifestAsync failed:",d="Invalid manifest in getManifestAsync.",m=this;if(u.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a}},t),u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)){var h=m,g=(S=e.referenceInUse).solutionId;e.osfControl!=i&&e.osfControl._sharedRuntimeId!=i&&e.osfControl._sharedRuntimeId.length>0&&(g=u.OsfManifestManager.getSharedRuntimeManifestCacheKey(S.solutionId,e.osfControl._sharedRuntimeId));var v=p(g,S.version),y=c[v];if(e.manifestCached=a,y)e.manifestCached=o,h.manifestContainsDownloadResources(y)?h.downloadResourcesAsync(e,t,y,v):t({statusCode:u.ProxyCallStatusCode.Succeeded,value:y,context:e});else if(e.clientEndPoint&&e.manifestUrl){s.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);var b=function(n){var a;if(n.statusCode===u.ProxyCallStatusCode.Succeeded&&n.value)try{var c;a=n.context.osfControl,typeof n.value===r?(n.context.manifestCached=o,c=n.value):(n.context.manifestCached=n.value.cached,c=n.value.manifest),s.AppLoadTimeHelper.SetManifestDataCachedFlag(a._telemetryContext,n.value.cached),n.value=new u.Manifest.Manifest(c,a._contextActivationMgr.getAppUILocale()),u.OsfManifestManager.cacheManifest(S.solutionId,S.version,n.value)}catch(e){var p;n.value=i,a&&(p=a._appCorrelationId);var m=d;f.WACUtils.logExceptionToBrowserConsole(m,e),s.RuntimeTelemetryHelper.LogExceptionTag(m,e,p,18420423)}else s.RuntimeTelemetryHelper.LogExceptionTag(l+f.WACUtils.serializeObjectToString(n),i,i,18420424);h.manifestContainsDownloadResources(y)?h.downloadResourcesAsync(e,t,n.value,v):t(n)},O={manifestUrl:e.manifestUrl,id:S.solutionId,version:S.version,clearCache:e.clearCache||a};m._invokeProxyMethodAsync(e,n,b,O)}else t({statusCode:u.ProxyCallStatusCode.Failed,value:i,context:e})}else{var S;h=m,g=(S=e.referenceInUse).id;e.osfControl!=i&&e.osfControl._sharedRuntimeId!=i&&e.osfControl._sharedRuntimeId.length>0&&(g=u.OsfManifestManager.getSharedRuntimeManifestCacheKey(S.id,e.osfControl._sharedRuntimeId));v=p(g,S.version),y=c[v];if(e.manifestCached=a,y)e.manifestCached=o,h.manifestContainsDownloadResources(y)?h.downloadResourcesAsync(e,t,y,v):t({statusCode:u.ProxyCallStatusCode.Succeeded,value:y,context:e});else if(e.clientEndPoint&&e.manifestUrl){s.AppLoadTimeHelper.ManifestRequestStart(e.osfControl._telemetryContext);b=function(n){var a;if(n.statusCode===u.ProxyCallStatusCode.Succeeded&&n.value)try{var c;a=n.context.osfControl,typeof n.value===r?(n.context.manifestCached=o,c=n.value):(n.context.manifestCached=n.value.cached,c=n.value.manifest),s.AppLoadTimeHelper.SetManifestDataCachedFlag(a._telemetryContext,n.value.cached),n.value=new u.Manifest.Manifest(c,a._contextActivationMgr.getAppUILocale()),u.OsfManifestManager.cacheManifest(S.id,S.version,n.value)}catch(e){var p;n.value=i,a&&(p=a._appCorrelationId);var m=d;f.WACUtils.logExceptionToBrowserConsole(m,e),s.RuntimeTelemetryHelper.LogExceptionTag(m,e,p,544219482)}else s.RuntimeTelemetryHelper.LogExceptionTag(l+f.WACUtils.serializeObjectToString(n),i,i,544219481);h.manifestContainsDownloadResources(y)?h.downloadResourcesAsync(e,t,n.value,v):t(n)},O={manifestUrl:e.manifestUrl,id:S.id,version:S.version,clearCache:e.clearCache||a};m._invokeProxyMethodAsync(e,n,b,O)}else t({statusCode:u.ProxyCallStatusCode.Failed,value:i,context:e})}},manifestContainsDownloadResources:function(e){return this.manifestContainsExtendedOverrides(e)},manifestContainsExtendedOverrides:function(e){return"object"==typeof e&&"function"==typeof e.getExtendedOverrides&&"object"==typeof e.getExtendedOverrides()},downloadResourcesAsync:function(e,t,n,r){this.manifestContainsExtendedOverrides(n)&&this.downloadExtendedOverridesAsync(e,t,n,r)},downloadExtendedOverridesAsync:function(e,t,n,r){var o=this,a=function(e,t,n,a){var c=e.osfControl._appCorrelationId;f.WACUtils.logExceptionToBrowserConsole(a,n),s.RuntimeTelemetryHelper.LogExceptionTag(a,n,c,573125015),o._cachedManifests&&o._cachedManifests[r]&&(o._cachedManifests[r]=void 0),t({statusCode:u.ProxyCallStatusCode.Failed,value:i,context:e})};!this.manifestContainsExtendedOverrides(n)&&a(e,t,"Unreachable","Unreachable code path executed!");try{var c=e.osfControl.getInitializationReason()==Microsoft.Office.WebExtension.InitializationReason.Inserted;e.osfControl.processManifestForExtendedOverrides(n,c).then((function(){return function(e,t,n){t({statusCode:u.ProxyCallStatusCode.Succeeded,value:n,context:e})}(e,t,n)})).catch((function(n){return a(e,t,n,"Invalid ExtendedOverrides content.")}))}catch(n){a(e,t,n,"Unexpected exception from OsfControlV2.processManifestForExtendedOverrides()")}},getAppInstanceInfoByIdAsync:function(e,t){u.OUtil.validateParamObject(e,{webUrl:{type:String,mayBeNull:a},appInstanceId:{type:String,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},t);var n={webUrl:e.webUrl,appInstanceId:e.appInstanceId,clearCache:e.clearCache||a};this._invokeProxyMethodAsync(e,"OEM_getSPAppInstanceInfoByIdAsync",t,n)},getSPTokenByProductIdAsync:function(e,t){u.OUtil.validateParamObject(e,{appWebUrl:{type:String,mayBeNull:a},productId:{type:String,mayBeNull:a}},t);var n=this;e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.appWebUrl,(function(r){if(r){var o={webUrl:e.appWebUrl,productId:e.productId,clearCache:e.clearCache||a,clientEndPoint:r};n._invokeProxyMethodAsync(e,"OEM_getSPTokenByProductIdAsync",t,o)}else t({statusCode:u.ProxyCallStatusCode.ProxyNotReady,value:i,context:e})}))},getSPAppEntitlementsAsync:function(e,t){var n="/";if(u.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},baseUrl:{type:String,mayBeNull:a},pageUrl:{type:String,mayBeNull:a},webUrl:{type:String,mayBeNull:o}},t),e.webUrl)this.getCorporateCatalogEntitlementsAsync(e,t);else{var r=document.createElement("a");r.href=e.pageUrl;var s=r.pathname,c=s.split(n),l=c.length-1,d=r.href.substring(0,r.href.length-s.length);d&&d.charAt(d.length-1)!==n&&(d+=n);for(var f=[d],p=0;p<l;p++)c[p]&&(d=d+c[p]+n,f.push(d));r=i;var m=this,h=e.osfControl._contextActivationMgr,g=f.pop(),v=function(e){if(e.statusCode===u.ProxyCallStatusCode.Succeeded){var r=e.value;r&&r.charAt(r.length-1)!==n&&(r+=n),h._webUrl=r,e.context.webUrl=r,e.context.appWebUrl=r,m.getCorporateCatalogEntitlementsAsync(e.context,t)}else t(e)},y=function(n){if(n){e.clientEndPoint=n;var r={pageUrl:e.pageUrl,baseUrl:g,clearCache:e.clearCache||a};m._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",v,r)}else f.length>0?(g=f.pop(),h._createSharePointIFrameProxy(g,y)):t({statusCode:u.ProxyCallStatusCode.Failed,value:i,context:e})};h._createSharePointIFrameProxy(g,y)}},getOneDriveEntitlementsAsync:function(e,t){var n,r,o="Content-Type",i="/root:/Manifests";u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?(n=e.referenceInUse.storeId,r=e.referenceInUse.storeId+i):(n=e.referenceInUse.storeLocator,r=e.referenceInUse.storeLocator+i);var a=u.OneDriveOAuth.getAccessTokenFromCookie(),s="?access_token="+a,c=r+s,l=new XMLHttpRequest,d=new XMLHttpRequest;l.onreadystatechange=function(){var t="/children";if(4==l.readyState&&200==l.status){var n,r=JSON.parse(l.response).id;n=u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?e.referenceInUse.storeId+"/items/"+r+t+s:e.referenceInUse.storeLocator+"/items/"+r+t+s,d.open("GET",n),d.setRequestHeader(o,"json"),d.send()}};var f=[],p=0,m=0,h=function(){p==m&&t({statusCode:u.ProxyCallStatusCode.Succeeded,value:{entitlements:f},context:e})},g=function(e,t){m++;var n=t;try{var r=new u.Manifest.Manifest(e.responseText),o=[];o.push(r.getDefaultDisplayName()),o.push(n),o.push(r.getDefaultDescription()),o.push(r.getTarget()),o.push(r.getMarketplaceVersion()),o.push(n),o.push(u.StoreType.OneDrive),o.push(r.getDefaultWidth()||0),o.push(r.getDefaultHeight()||0),o.push(r.getDefaultIconUrl()),o.push(r.getProviderName()),o.push(r.getDefaultLocale()),o.push(u.StoreType.OneDrive),f.push(o)}catch(e){}h()},v=function(){m++,h()};d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){for(var e=JSON.parse(d.responseText),t=0;t<e.value.length;t++)if(".xml"==e.value[t].name.substr(e.value[t].name.length-4).toLowerCase()){var r=n+"/root:/Manifests/"+e.value[t].name+":/content?access_token="+a;u.OUtil.xhrGetFull(r,e.value[t].name,g,v),p++}h()}},l.open("GET",c),l.setRequestHeader(o,"json"),l.send()},getCorporateCatalogEntitlementsAsync:function(e,t){u.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},webUrl:{type:String,mayBeNull:a}},t),s.AppLoadTimeHelper.AuthenticationStart(e.osfControl._telemetryContext);var n=this,r=0,c=function(l){if(l){s.AppLoadTimeHelper.AuthenticationEnd(e.osfControl._telemetryContext),e.clientEndPoint=l;var d={webUrl:e.webUrl,applicationName:u.HostCapability[e.hostType],officeExtentionTarget:e.noTargetType||e.osfControl.getOsfControlType()===u.OsfControlTarget.TaskPane?i:e.osfControl.getOsfControlType(),clearCache:e.clearCache||a,supportedManifestVersions:{"1.0":o,1.1:o}};n._invokeProxyMethodAsync(e,"OEM_getEntitlementSummaryAsync",t,d)}else r<u.Constants.AuthenticatedConnectMaxTries?(r++,setTimeout((function(){e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,c)}),500)):t({statusCode:u.ProxyCallStatusCode.ProxyNotReady,value:i,context:e})};e.osfControl._contextActivationMgr._createSharePointIFrameProxy(e.webUrl,c)},_invokeProxyMethodAsync:function(e,t,n,o){var a,c=[o.clientEndPoint?o.clientEndPoint._targetUrl:e.clientEndPoint._targetUrl,t];for(var l in o)((a=typeof o[l])===r||"number"===a||"boolean"===a)&&c.push(o[l]);var p=c.join("."),m=d,h={onCompleted:n,context:e,methodName:t},g=m[p];if(g)g.push(h);else{m[p]=[h];var v=e.clientEndPoint;o.clientEndPoint&&(v=o.clientEndPoint,delete o.clientEndPoint),e.referenceInUse&&e.referenceInUse.storeType===u.StoreType.OMEX&&(o.officeVersion=u.Constants.ThreePartsFileVersion),v.invoke(t,(function(e,t){var n=i,r=u.ProxyCallStatusCode.Failed;0===e&&t.status&&(n=t.result,r=u.ProxyCallStatusCode.Succeeded);var o=m[p];delete m[p];for(var a=o.length,c=0;c<a;c++){var l,d=o.shift();try{d.context&&d.context.osfControl&&(l=d.context.osfControl._appCorrelationId),t&&t.failureInfo&&s.RuntimeTelemetryHelper.LogProxyFailure(l,d.methodName,t.failureInfo),d.onCompleted({statusCode:r,value:n,context:d.context})}catch(e){var h="_invokeProxyMethodAsync failed.";f.WACUtils.logExceptionToBrowserConsole(h,e),s.RuntimeTelemetryHelper.LogExceptionTag(h,e,l,18420425)}}}),o)}},removeOmexCacheAsync:function(e,t){u.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},t);var n,r=e.referenceInUse;u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?(n={applicationName:e.hostType,assetID:r.solutionId,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||a,clearToken:e.clearToken||a,clearAppState:e.clearAppState||a,clearManifest:e.clearManifest||a,appVersion:e.appVersion},e.anonymous?n.contentMarket=r.storeId:(n.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,n.userContentMarket=r.storeId)):(n={applicationName:e.hostType,assetID:r.id,officeExtentionTarget:e.osfControl.getOsfControlType(),clearEntitlement:e.clearEntitlement||a,clearToken:e.clearToken||a,clearAppState:e.clearAppState||a,clearManifest:e.clearManifest||a,appVersion:e.appVersion},e.anonymous?n.contentMarket=r.storeLocator:(n.assetContentMarket=e.osfControl._omexEntitlement.contentMarket,n.userContentMarket=r.storeLocator)),this._invokeProxyMethodAsync(e,"OMEX_removeCacheAsync",t,n)},purgeManifest:function(r,o){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(i)throw i;var s=p(r,o);typeof c[s]!=e&&delete c[s]},cacheManifestFromXml:function(e,r,o,i){var s=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a},{name:"manifestXml",type:String,mayBeNull:a},{name:"uiLocale",type:String,mayBeNull:a}]);if(s)throw s;this.cacheManifest(e,r,new u.Manifest.Manifest(o,i))},cacheManifest:function(e,r,o){var i=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a},{name:"manifest",type:Object,mayBeNull:a}]);if(i)throw i;var s=p(e,r);o._UILocale=o._UILocale||l,c[s]=o},hasManifest:function(r,i){var s=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(s)throw s;var u=p(r,i);return typeof c[u]!=e?o:a},hasManifestForControl:function(e){return u.OUtil.validateParamObject(e,{referenceInUse:{type:Object,mayBeNull:a}},i),u.OUtil.checkFlight(u.FlightTreatmentNames.OSFSolutionRefactor)?this.hasManifest(e.referenceInUse.solutionId,e.referenceInUse.version):this.hasManifest(e.referenceInUse.id,e.referenceInUse.version)},getCachedManifest:function(e,r){var o=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:t,type:String,mayBeNull:a}]);if(o)throw o;var i=p(e,r);return c[i]},getSharedRuntimeManifestCacheKey:function(e,t){var r=Function._validateParams(arguments,[{name:n,type:String,mayBeNull:a},{name:"sharedRuntimeId",type:String,mayBeNull:a}]);if(r)throw r;return e+t},versionLessThan:function(e,t){for(var n,r,o=e.split("."),i=t.split("."),s=Math.min(o.length,i.length),c=0;c<s;c++)try{if((n=parseFloat(o[c]))!=(r=parseFloat(i[c])))return n<r}catch(e){}if(o.length>=i.length)return a;s=i.length;var u=0;for(c=o.length;c<s;c++){try{r=parseFloat(i[c])}catch(e){r=0}u+=r}return u>0},_setUILocale:function(e){l=e}}}(),u.AddinIdInfo=function(e){var t=null,n=e.split("|");8!=n.length&&s.RuntimeTelemetryHelper.LogCommonMessageTag("OSF.AddinIdInfo.constructor: Unexpected format of the addinId",t,573125014);var r=n[0],o=n[1],i=n[2],a=n[3],c=n[4],l=t;return"2"!=r&&s.RuntimeTelemetryHelper.LogCommonMessageTag("OSF.AddinIdInfo.constructor: Unexpected format version: "+r+".",t,573125013),{getSolutionId:function(){return o},getSolutionVersion:function(){return i},getFormatVersion:function(){return r},getStoreTypeId:function(){return a},getStoreLocation:function(){return c},getPrivacyCompliantSolutionId:function(){return l==t&&u.OUtil.checkFlight("Microsoft.Office.SharedOnline.IsPrivateAddin")&&(l=s.PrivacyRules.GetAssetId(f.ManifestUtil.GetStoreTypeName(a),c,o)),l==t?o:l},needToRestoreManifest:function(){return a==u.StoreTypeEnum.Registry.toString()}}},function(e){!function(e){var t="missingModifierKey",n="invalidParameter",r="downloadError",o="invalidKeyCode",i="invalidExtendedOverride",a="tokenError";e[e.Invalid=0]="Invalid",e[e[a]=1]=a,e[e[i]=2]=i,e[e[o]=3]=o,e[e[r]=4]=r,e[e[n]=5]=n,e[e[t]=6]=t}(e.OsfRuntimeErrorCode||(e.OsfRuntimeErrorCode={}));var t=function(e){function t(n,r){var o=e.call(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o.code=n,o.name="OsfRuntimeError",o}return i(t,e),t}(Error);e.OsfRuntimeError=t;var n=function(e){function t(n,r){var o=e.call(this,n,"Multiple Errors")||this;return Object.setPrototypeOf(o,t.prototype),o.messages=r,r.forEach((function(e){})),o}return i(t,e),t}(t);e.OsfMultiError=n}(f||(f={})),u.ManifestSchemaVersion={"1.0":"1.0",1.1:"1.1"},u.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',1.1:'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides" xmlns:c="http://schemas.microsoft.com/office/contentappversionoverrides"'},u.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3},u.RequirementsChecker=function(e,t,n,r,o){var i=this;i.setCapabilities(e),i.setHosts(t),i.setRequirements(n),i.setSupportedControlTargets(r),i.setSupportedOmexAppVersions(o),i.setFilteringEnabled(!1)},u.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(e){if(!this.isFilteringEnabled())return!0;if(!e)return!1;switch(e.getManifestSchemaVersion()||u.ManifestSchemaVersion["1.0"]){case u.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(e);case u.ManifestSchemaVersion[1.1]:return this._checkManifest1_1(e);default:return!1}},isEntitlementFromOmexSupported:function(e){var t,n=this;if(!n.isFilteringEnabled())return!0;if(!e)return!1;switch(e.appSubType){case"1":t=u.OsfControlTarget.TaskPane;break;case"2":t=u.OsfControlTarget.InContent;break;case"3":t=u.OsfControlTarget.Contextual;break;case"4":t=u.OsfControlTarget.TaskPane;break;default:return!1}if(!n._checkControlTarget(t))return!1;if(!e.requirements&&!e.hosts)return!e.hasOwnProperty("appVersions")||void 0===e.appVersions||n._checkOmexAppVersions(e.appVersions);var r,o,i,a,s=new u.Manifest.Manifest((function(){}));return e.requirements&&(s._xmlProcessor=new u.XmlProcessor(e.requirements,u.ManifestNamespaces[1.1]),o=s._xmlProcessor.getDocumentElement()),r=s._parseRequirements(o),e.hosts&&(s._xmlProcessor=new u.XmlProcessor(e.hosts,u.ManifestNamespaces[1.1]),a=s._xmlProcessor.getDocumentElement()),i=s._parseHosts(a),n._checkHosts(i)&&n._checkSets(r.sets)&&n._checkMethods(r.methods)},isEntitlementFromCorpCatalogSupported:function(e){var t=this;if(!t.isFilteringEnabled())return!0;if(!e)return!1;var n=u.OfficeAppType[e.OEType];if(!t._checkControlTarget(n))return!1;var r,o,i,a,s,c=new u.Manifest.Manifest((function(){}));e.OfficeExtensionCapabilitiesXML&&(c._xmlProcessor=new u.XmlProcessor(e.OfficeExtensionCapabilitiesXML,u.ManifestNamespaces[1.1]),a=c._xmlProcessor.getDocumentElement(),o=(s=c._parseRequirements(a)).sets,i=s.methods,r=c._parseHosts(a));return t._checkHosts(r)&&t._checkSets(o)&&t._checkMethods(i)},setCapabilities:function(e){this._supportedCapabilities=this._scalarArrayToObject(e)},setHosts:function(e){this._supportedHosts=this._scalarArrayToObject(e)},setRequirements:function(e){var t=this;t._supportedSets=e&&t._arrayToSetsObject(e.sets)||{},t._supportedMethods=e&&t._scalarArrayToObject(e.methods)||{}},setSupportedControlTargets:function(e){this._supportedControlTargets=this._scalarArrayToObject(e)},setSupportedOmexAppVersions:function(e){this._supportedOmexAppVersions=e&&e.slice?e.slice(0):[]},setFilteringEnabled:function(e){this._filteringEnabled=!!e},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(e){return this._checkCapabilities(e.getCapabilities())},_checkCapabilities:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedCapabilities[e[t]])return!0;return!1},_checkManifest1_1:function(e){var t=e.getRequirements()||{};return this._checkHosts(e.getHosts())&&this._checkSets(t.sets)&&this._checkMethods(t.methods)},_checkHosts:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(this._supportedHosts[e[t]])return!0;return!1},_checkSets:function(e){var t=this;if(!e||0===e.length)return!0;for(var n=0;n<e.length;n++){var r=e[n],o=t._supportedSets[r.name.toLowerCase()];if(!o)return!1;if(r.version&&(t._compareVersionStrings(o.minVersion||t.defaultMinMaxVersion,r.version)>0||t._compareVersionStrings(o.maxVersion||t.defaultMinMaxVersion,r.version)<0))return!1}return!0},_checkMethods:function(e){if(!e||0===e.length)return!0;for(var t=0;t<e.length;t++)if(!this._supportedMethods[e[t]])return!1;return!0},_checkControlTarget:function(e){return null!=e&&this._supportedControlTargets[e]},_checkOmexAppVersions:function(e){if(!e)return!1;for(var t=0;t<this._supportedOmexAppVersions.length;t++)if(e.indexOf(this._supportedOmexAppVersions[t])>=0)return!0;return!1},_scalarArrayToObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++)null!=e[n]&&(t[e[n]]=!0);return t},_arrayToSetsObject:function(e){var t={};if(e&&e.length)for(var n=0;n<e.length;n++){var r=e[n];r&&null!=r.name&&(t[r.name.toLowerCase()]=r)}return t},_getSupportedSet:function(){for(var e={},t=Object.getOwnPropertyNames(this._supportedSets),n=0;n<t.length;n++){var r=this._supportedSets[t[n]];e[r.name.toLowerCase()]=r.maxVersion||this.defaultMinMaxVersion}return"undefined"!=typeof JSON?JSON.stringify(e):e},_getSupportedSetAsDmsCapabilities:function(){var e=this;return Object.getOwnPropertyNames(this._supportedSets).map((function(t){var n=e._supportedSets[t];return{Name:n.name.toLowerCase(),Version:n.maxVersion||e.defaultMinMaxVersion}}))},_compareVersionStrings:function(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length),r=0;r<n;r++){var o=parseInt(e[r],10)||0,i=parseInt(t[r],10)||0;if(o!==i)return o-i}return 0}},f.appSpecificCheckOrigin=function(e,t,n,r){try{return!(!(t&&t.source&&t.source.location&&t.source.location.pathname)||t.source.location.pathname.indexOf("projection.aspx")<0&&t.source.location.href!=window.location.href)&&r(e,n)}catch(e){return!1}};var p=window;p.OfficeExt=f,p.Telemetry=s},4828:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1734);function o(e){const t=Object(r.a)();return t.runningContextualAddinCommand&&t.runningContextualAddinCommand.controlId===e?t.runningContextualAddinCommand:null}},4829:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(43),n.e(611)]).then(n.bind(null,10789)));let i=new r.b(o,e=>e.getAdditionalPropertiesFromServer),a=new r.b(o,e=>e.getItemProperties),s=new r.b(o,e=>e.cleanUpByItemId)},491:function(e,t,n){var r=n(1273);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},4910:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="WeatherSunnyRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M8.5 1.5a.5.5 0 00-1 0v1a.5.5 0 001 0v-1zM3.76 3.05a.5.5 0 00-.71.7l.7.71a.5.5 0 00.71-.7l-.7-.71zm9.19.7a.5.5 0 10-.7-.7l-.71.7a.5.5 0 00.7.71l.71-.7zM1.5 7.5a.5.5 0 000 1h1a.5.5 0 000-1h-1zm12 0a.5.5 0 000 1h1a.5.5 0 000-1h-1zm-9.04 4.74a.5.5 0 10-.7-.7l-.71.7a.5.5 0 10.7.71l.71-.7zm7.78-.7a.5.5 0 00-.7.7l.7.71a.5.5 0 10.71-.7l-.7-.71zM8.5 13.5a.5.5 0 00-1 0v1a.5.5 0 001 0v-1zM8 4a4 4 0 100 8 4 4 0 000-8zM5 8a3 3 0 116 0 3 3 0 01-6 0z"})),displayName:"WeatherSunnyRegular"});Object(o.registerIcons)({icons:{WeatherSunnyRegular:r.createElement(a,null)}})},4929:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.slice():[]}t.a=e=>e&&0!==e.length?e.filter(e=>!!e).reduce((e,t)=>[...e,...r(t)],[]):[]},4937:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.FlightDisabled=1]="FlightDisabled",e[e.TemporarilyAutoblocked=2]="TemporarilyAutoblocked",e[e.PermanentlyAutoblocked=3]="PermanentlyAutoblocked"}(r||(r={}))},4956:function(e,t,n){"use strict";var r=n(10288),o=n(7007);function i(e){const t=Object(r.a)(e);return Object(o.a)()[t]}var a=n(7008);function s(e){return e.isActionable&&e.control.Action.SupportsPersistence}var c=n(6),u=n(1797),l=n(5767),d=n(6797);let f=!1;async function p(e){if(Object(l.b)()&&e!==u.a.AppointmentAttendee&&e!==u.a.AppointmentOrganizer&&!f){const e=await Object(d.b)(),t=JSON.parse(e);t.addins&&(f=!0,t.addins.forEach(e=>{if(function(e){return!Object(c.k)(e.mode)&&!Object(c.k)(e.addinId)&&!Object(c.k)(e.commandId)}(e)){let t={addinId:e.addinId,commandId:e.commandId};Object(o.a)()[e.mode]=t}}))}}function m(){return f}function h(e){return{addinId:e.get_ExtensionId(),commandId:e.control.Id}}var g=n(1810);function v(e){let t=Object.keys(Object(o.a)());for(let n=0;n<t.length;n++){const r=t[n],i=Object(o.a)()[r];i&&e.indexOf(i.addinId)<0&&(Object(a.b)(r,null),Object(g.gb)(i.addinId))}}var y=function(e){const t=i(u.a.MessageRead),n=i(u.a.MessageCompose);return!!(t&&e.get_ExtensionId()===t.addinId&&e.get_Id().indexOf(t.commandId)>=0)||!!(n&&e.get_ExtensionId()===n.addinId&&e.get_Id().indexOf(n.commandId)>=0)};n.d(t,"c",(function(){return i})),n.d(t,"h",(function(){return a.a})),n.d(t,"a",(function(){return s})),n.d(t,"f",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return v})),n.d(t,"d",(function(){return y}))},496:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"f",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n(68),o=n(250);function i(e){Object(r.b)(e&&"Document"===e.kind,45);var t=e.definitions.filter((function(e){return"FragmentDefinition"!==e.kind})).map((function(e){if("OperationDefinition"!==e.kind)throw new r.a(46);return e}));return Object(r.b)(t.length<=1,47),e}function a(e){return i(e),e.definitions.filter((function(e){return"OperationDefinition"===e.kind}))[0]}function s(e){return e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&e.name})).map((function(e){return e.name.value}))[0]||null}function c(e){return e.definitions.filter((function(e){return"FragmentDefinition"===e.kind}))}function u(e){var t=a(e);return Object(r.b)(t&&"query"===t.operation,48),t}function l(e){Object(r.b)("Document"===e.kind,49),Object(r.b)(e.definitions.length<=1,50);var t=e.definitions[0];return Object(r.b)("FragmentDefinition"===t.kind,51),t}function d(e){var t;i(e);for(var n=0,o=e.definitions;n<o.length;n++){var a=o[n];if("OperationDefinition"===a.kind){var s=a.operation;if("query"===s||"mutation"===s||"subscription"===s)return a}"FragmentDefinition"!==a.kind||t||(t=a)}if(t)return t;throw new r.a(52)}function f(e){var t=Object.create(null),n=e&&e.variableDefinitions;return n&&n.length&&n.forEach((function(e){e.defaultValue&&Object(o.j)(t,e.variable.name,e.defaultValue)})),t}},4989:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3);let o=Object(r.createStore)("appDrawerStore",{appServiceApps:[],hasFetchedAppData:!1});o()},4991:function(e,t,n){"use strict";n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"g",(function(){return p}));const r="27797656-b5ea-4db3-8043-0230f0b4d6d6",o="translate.buttonDesktop1_1",i="https://ogma.osi.office.net/outlooktranslatorapp/desktop",a="https://ogma.osi.office.net",s="https://ogma.osi.office.net/outlooktranslatorapp/desktop",c="1.0.8.1",u="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon64x64.png",l="Translator",d="Help you translate messages in your preferred language across devices",f="Microsoft",p="https://ogma.osi.office.net/outlooktranslatorapp/Images/TranslateIcon128x128.png"},4994:function(e){e.exports=JSON.parse('{"a":"ona"}')},4995:function(e){e.exports=JSON.parse('{"a":"vna"}')},5021:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="AppsAddInRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M13 1.5a.5.5 0 00-1 0V3h-1.5a.5.5 0 000 1H12v1.5a.5.5 0 001 0V4h1.5a.5.5 0 000-1H13V1.5zM3.75 2C2.78 2 2 2.78 2 3.75v8.5c0 .97.78 1.75 1.75 1.75h8.5c.97 0 1.75-.78 1.75-1.75v-3c0-.97-.78-1.75-1.75-1.75H8.5V3.75C8.5 2.78 7.72 2 6.75 2h-3zM7.5 8.5V13H3.75a.75.75 0 01-.75-.75V8.5h4.5zm0-4.75V7.5H3V3.75c0-.41.34-.75.75-.75h3c.41 0 .75.34.75.75zM12.25 13H8.5V8.5h3.75c.41 0 .75.34.75.75v3c0 .41-.34.75-.75.75z"})),displayName:"AppsAddInRegular"});Object(o.registerIcons)({icons:{AppsAddInRegular:r.createElement(a,null)}})},5022:function(e){e.exports=JSON.parse('{"accCheckerMenuItemText":"Npa"}')},5027:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4252),o=n(4421);function i(e,t){return function(e,t){for(let n=0;n<t.length;n++)if(a(t[n],e))return t[n];return null}((e||[]).concat(t||[]),Object(r.a)(!0))}function a(e,t){if(t&&t.length>0)for(let n of t)if(n&&Object(o.a)(e,n.EmailAddress))return!0;return!1}},5131:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1692);function o(e,t){var n,o,i;let a="";if(e){const s=r.u.items.get(null===(n=e.referenceItemId)||void 0===n?void 0:n.Id);switch(t){case"smartReply":(null===(o=null==s?void 0:s.SmartReplyData)||void 0===o?void 0:o.ExtractionID)&&(a=s.SmartReplyData.ExtractionID);break;case"smartDoc":(null===(i=null==s?void 0:s.SmartDocData)||void 0===i?void 0:i.EntityId)&&(a=s.SmartDocData.EntityId)}}return a}},5132:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade","errorMessageExceededHourlyMessageLimit","errorMessageExceededMaxRecipientLimit","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimit","errorMessageExceededMessageLimitShowTierUpgrade","errorMessageMessageSubmissionBlocked","errorMessageMessageBlocked","errorMessageTimeout","errorMessageThrottled","errorMessageTransientError","errorMessageItemNoLongerExistToSave","errorMessageItemNoLongerExistToSend","errorMessageQuotaExceededMessageCanNotBeSaved","errorMessageQuotaExceededMessageCanNotBeSent","errorMessageSubmissionQuotaExceededMessageCanNotBeSent","errorMessageMessageCanNotBeSaved","errorMessageMessageCanNotBeSent","errorMessageNoPermissionToSendAs","errorMessageNoRecipentsMailCanNotBeSend","errorMessageInvalidSenderMailCanNotBeSend","warningMessageNoPermissionToPerformAction","error500","error503","errorFailedToFetch","errorSessionTimeout","errorMailboxStoreUnavailable","errorMessageErrorWithDetail","smimeEncodeError","smimeBccForkingFailedError"]},5133:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r="<div id=appendonsend></div>";function o(e){let t="";return"HTML"==e&&(t+=r),t}},5134:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1912),o=n(2104),i=n(47);function a(e){const t=[];return null==e||e.forEach(e=>{const n=Object(r.a)(e);if(!n)return;const a=function(e){switch(e){case 4:return 4;case 3:return 3;case 6:return 6;case 5:return 5;case 2:return 2;case 1:return 1;default:return 0}}(n.permissionLevel),s=Object(i.j)("cmp-prague")&&function(e){switch(e){case 4:case 3:case 6:case 5:return!0;default:return!1}}(a)&&Object(o.a)(n.fileName);if(1===a||2===a||s){const e={ProviderType:"OneDrivePro",Url:n.url,PermissionType:a};t.push(e)}}),t}},514:function(e,t,n){"use strict";var r,o,i,a;n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),function(e){e[e.NotStarted=0]="NotStarted",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.Error=3]="Error"}(r||(r={})),function(e){e[e.AAD=0]="AAD",e[e.MSA=1]="MSA"}(o||(o={})),function(e){e.UserMailbox="UserMailbox",e.GroupMailbox="GroupMailbox",e.TeamsMailbox="TeamsMailbox",e.PublicMailbox="PublicMailbox",e.SharedMailbox="SharedMailbox",e.ArchiveMailbox="ArchiveMailbox"}(i||(i={})),function(e){e.Office365="Office365",e.OutlookDotCom="Outlook",e.Google="Google",e.ICloud="ICloud",e.Yahoo="Yahoo"}(a||(a={}))},516:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(132),o=n(13);function i(){return Object(r.a)("acctmonaccounts")&&Object(o.i)("acctmonaccounts")}},517:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.normal=0]="normal",e[e.largeHeader=1]="largeHeader",e[e.close=2]="close"}(r||(r={}))},518:function(e,t,n){"use strict";(function(e){var r=n(247),o=n(1012),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i?r.a.Buffer:void 0,c=(s?s.isBuffer:void 0)||o.a;t.a=c}).call(this,n(709)(e))},520:function(e,t,n){"use strict";var r=n(347),o=n(306),i="[object Arguments]";var a=function(e){return Object(o.a)(e)&&Object(r.a)(e)==i},s=Object.prototype,c=s.hasOwnProperty,u=s.propertyIsEnumerable,l=a(function(){return arguments}())?a:function(e){return Object(o.a)(e)&&c.call(e,"callee")&&!u.call(e,"callee")};t.a=l},521:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(834),o=n(377),i=n(408);function a(e,t){t||(t=Object(i.a)());for(let n=0;n<t.length;n++){let r=t[n];if(r.Name.toLowerCase()===e.toLowerCase())return o.a.colorCodeColorValueMap[r.Color.toString()]}return s()}function s(){return o.a.colorCodeColorValueMap[r.a]}},522:function(e,t,n){"use strict";var r=n(328),o=Object(r.a)(Object,"create");var i=function(){this.__data__=o?o(null):{},this.size=0};var a=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},s="__lodash_hash_undefined__",c=Object.prototype.hasOwnProperty;var u=function(e){var t=this.__data__;if(o){var n=t[e];return n===s?void 0:n}return c.call(t,e)?t[e]:void 0},l=Object.prototype.hasOwnProperty;var d=function(e){var t=this.__data__;return o?void 0!==t[e]:l.call(t,e)},f="__lodash_hash_undefined__";var p=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=o&&void 0===t?f:t,this};function m(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}m.prototype.clear=i,m.prototype.delete=a,m.prototype.get=u,m.prototype.has=d,m.prototype.set=p;var h=m,g=n(474),v=n(475);var y=function(){this.size=0,this.__data__={hash:new h,map:new(v.a||g.a),string:new h}};var b=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var O=function(e,t){var n=e.__data__;return b(t)?n["string"==typeof t?"string":"hash"]:n.map};var S=function(e){var t=O(this,e).delete(e);return this.size-=t?1:0,t};var C=function(e){return O(this,e).get(e)};var A=function(e){return O(this,e).has(e)};var _=function(e,t){var n=O(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function I(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}I.prototype.clear=y,I.prototype.delete=S,I.prototype.get=C,I.prototype.has=A,I.prototype.set=_;t.a=I},5241:function(e,t,n){"use strict";function r(e,t,n){return`Addin_${e}_${t}_${n}`}var o,i=n(6576),a=n(1785),s=n(2571),c=n(1926);function u(e=null){return{error:o.Success,data:e}}function l(e){return{error:o.Failed,errorCode:e}}function d(e,t){return!f(e)&&(t(l(c.a.InsufficientItemPermissions)),!0)}function f(e){if(!e.isSharedItem||!e.getSharedProperties)return!0;if(!e.isSharedItem())return!0;return e.getSharedProperties().delegatePermissions.EditOwn}!function(e){e[e.Success=0]="Success",e[e.Failed=1]="Failed"}(o||(o={}));var p=n(1810),m=n(2452);async function h(e,t,n){const o=Object(a.c)(e),d=Object(p.w)(t),h=r(e,d,n);if(!Object(m.f)(h))return l(c.b.NotificationKeyNotFound);const g=Object(m.e)(h).Persistent;if(g&&!f(o))return l(c.b.InsufficientItemPermissions);o.removeNotificationMessage(h),Object(m.h)(h);try{g&&await Object(i.a)(e,d)}catch(e){if(e instanceof s.a)return l(e.errorCode)}return u()}function g(e){switch(e){case 0:return"informationalMessage";case 2:return"errorMessage";case 1:return"progressIndicator";case 3:return"insightMessage"}return""}async function v(e,t,n,o,d,g,v,y=null,b=!1,O=null){const S=Object(a.c)(e);if(!S)return l(c.b.InvalidSelection);const C=Object(p.w)(t),A=r(e,C,o);!function(e,t,n){const o=Object(p.m)(t);if(!o)return;const i=o.get_Id(),a=r(e,n,i);Object(m.f)(a)&&h(e,t,i)}(e,t,C);let _=!1;if(Object(m.f)(A)){if(b)return l(c.b.DuplicateNotificationKey);_=Object(m.e)(A).Persistent}else if(Object(m.g)(e,C,O))return l(c.b.NumberOfNotificationsExceeded);const I=function(e,t,n,r,o,i,a){return{ExtensionId:e,Persistent:!!t||2===r,Key:n,Type:r,Message:o,Icon:i,Actions:a||null}}(C,n,o,d,g,y,O);if(!f(S)&&I.Persistent)return l(c.b.InsufficientItemPermissions);Object(m.a)(e,C,A,I),S.addNotificationMessage(A,v);try{(_||I.Persistent)&&await Object(i.a)(e,C)}catch(e){if(e instanceof s.a)return l(e.errorCode)}return u()}function y(e){try{const t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("style");if(n&&n.length>0)for(let e=0;e<n.length;e++)n[e]&&(n[e].innerHTML="");return t.body.textContent||""}catch(e){return""}}var b=n(7009),O=n(1797);function S(e){return Object(a.d)(e)}function C(e,t,n){return e&&e.match(function(e,t){let n,r="g";t&&(r="ig");try{n=new RegExp(e,r)}catch(e){return null}return n}(t,n))}var A=n(805);const _=255;function I(e){for(let n of e){var t=n.length;if(t<=0||t>_)return!0}return!1}var x=n(1130);var E=n(3940);var T=n(5320),w=n(326);function M(e,t,n){const r=p.j.EnabledAddinCommands;if(!r)return null;for(const o of r.getExtensionPoint(n))if(o.Id==e&&o.AddinCommands.size>0)for(const e of o.AddinCommands.values())if(e.control.Id==t)return e;return null}var k=n(71),j=n(3643);const P=/^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;function R(e){return P.test(e)}function N(e){const t=[];return e.forEach(e=>{R(e.address)&&t.push({Name:e.name,EmailAddress:e.address})}),t}const D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},F=/[&<>"'\/]/g;var L=n(35);function U(e){return(t={input:e},Object(L.a)("SanitizeHtml",t,n)).catch(B);var t,n}function B(){return null}const H="<div>",V="</div>";async function z(e){const t=await U(e);return null==t?null:function(e){let t=e.trim();return t.substr(0,H.length).toLowerCase()==H&&t.substr(t.length-V.length,V.length).toLowerCase()==V&&(t=t.substring(H.length,t.length-V.length)),t}(t)}var W=n(99);let G=null;function q(e){G=e}function K(){return G}var X,Q=function(e,t){const n=K();n&&n(e,t)},J=n(404);!function(e){e[e.Success=0]="Success",e[e.OperationNotSupported=5e3]="OperationNotSupported",e[e.InternalError=5001]="InternalError",e[e.NotSsoAgave=13e3]="NotSsoAgave",e[e.UserNotSignedIn=13001]="UserNotSignedIn",e[e.UserAborted=13002]="UserAborted",e[e.InvalidResourceUrl=13004]="InvalidResourceUrl",e[e.InvalidGrant=13005]="InvalidGrant",e[e.ClientError=13006]="ClientError",e[e.AddinIsAlreadyRequestingToken=13008]="AddinIsAlreadyRequestingToken",e[e.SSOUnsupportedPlatform=13012]="SSOUnsupportedPlatform"}(X||(X={}));var Y=n(290);const Z="bc59ab01-8403-45c6-8796-ac3ef710b3e3",$="/owa/extSSO.aspx";function ee(e,t,n){const r=Object(p.I)(e),o=Object(Y.resolve)(window.location.origin,$);try{Object(J.getAccessTokenOnBehalfOfResource)(Z,o,r,t,n,te)}catch(e){te(e,void 0)}}function te(e,t){t?Q(null,t):Q(function(e){let t=X.ClientError;return e&&(e.indexOf(J.AdalErrorCode.NoUserLogin)>=0?t=X.UserNotSignedIn:e.indexOf(J.AdalErrorCode.InvalidResourceUrl)>=0?t=X.InvalidResourceUrl:e.indexOf(J.AdalErrorCode.NoPreAuth)>=0||e.indexOf(J.AdalErrorCode.NotConsent)>=0?t=X.InvalidGrant:e.indexOf(J.AdalErrorCode.UserAborted)>=0&&(t=X.UserAborted)),t}(e)),q(null)}const ne=1e6;async function re(e,t,n,r,o,i){const s=n.appendTxt||""===n.appendTxt?n.appendTxt:n.data;if(s.length>ne)return void r(l(c.a.OoeInvalidDataFormat));const d=null==i?void 0:i();let f=null;if(n.coercionType===gn.a.Html){if(f=await z(s),null==f)return void r(l(c.a.HtmlSanitizationFailure));if(function(e){for(var t=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("img"),n=0;n<t.length;n++){var r=t[n].getAttribute("src");if(r=decodeURIComponent(r)){const e=r.lastIndexOf(".");if(-1!==e&&"svg"===r.substring(e+1).toLowerCase())return!0}}return!1}(f))return void r(l(X.OperationNotSupported))}else{f="HTML"!==Object(a.c)(e).getBodyType()||n.appendOnSend?s:s.replace(F,(function(e){return D[e]}))}var p,m;if(n.appendOnSend)n.appendOnSend.txt=f,o(n.appendOnSend);else{if(i){const e=i();if(m=e,!(null==(p=d)&&null==m||null!=p&&null!=m&&p.data===m.data&&p.sourceProperty===m.sourceProperty&&p.startPosition===m.startPosition&&p.endPosition===m.endPosition))return void r(l(c.a.CursorPositionChanged))}o(f),"Firefox"===Object(W.a)().browser&&document.activeElement.blur()}r(u())}var oe=n(5322),ie=n(47);const ae=5e3;var se,ce=n(10528);function ue(e,t,n,r){!function(e){const{taskPanes:t}=Object(p.u)();for(let n of t.values())for(let t of n.values())if(t.controlId===e)return!0;return!1}(t)?function(e){return Object(p.u)().runningContextualAddinCommand&&Object(p.u)().runningContextualAddinCommand.controlId===e}(t)&&Object(p.fb)():Object(b.a)(t),r(u())}function le(e,t,n,r){if(!n.itemId)return void r(l());Object(a.c)(e).displayAppointmentForm(n.itemId),r(u())}async function de(e,t,n,r){const o=Object(a.c)(e);await o.displayMessageForm(n.itemId),r(u())}!function(e){e[e.MaxRecipientsOnDisplayNewAppointment=100]="MaxRecipientsOnDisplayNewAppointment",e[e.MaxSubjectLength=255]="MaxSubjectLength",e[e.MaxBodyLengthOnDisplayApis=32768]="MaxBodyLengthOnDisplayApis",e[e.MaxLocationLengthOnDisplayNewAppointment=255]="MaxLocationLengthOnDisplayNewAppointment",e[e.MaxAttachmentNumberOnDisplayApis=100]="MaxAttachmentNumberOnDisplayApis",e[e.MaxRecipientsPerCall=100]="MaxRecipientsPerCall"}(se||(se={}));var fe=se;const pe=e=>"string"==typeof e?{Name:e,EmailAddress:e}:{Name:e.name,EmailAddress:e.address};var me=e=>e?e.map(pe):[];function he(e,t,n,r){if(!n||(ge((o=n).requiredAttendees,fe.MaxRecipientsOnDisplayNewAppointment)||ge(o.optionalAttendees,fe.MaxRecipientsOnDisplayNewAppointment)||ge(o.subject,fe.MaxSubjectLength)||ge(o.body,fe.MaxBodyLengthOnDisplayApis)||ge(o.location,fe.MaxLocationLengthOnDisplayNewAppointment)))return void r(l());var o;Object(a.c)(e).displayNewAppointmentForm(me(n.requiredAttendees),me(n.optionalAttendees),n.start,n.end,n.location,n.resources,n.subject,n.body),r(u())}function ge(e,t){return e&&e.length>t}function ve(e){switch(e[0]){case"file":return function(e){return{id:e[2],name:e[1],attachmentType:E.a.File,isInline:e[3]}}(e);case"item":return function(e){return{id:e[2],name:e[1],attachmentType:E.a.Item,isInline:!1}}(e);default:return null}}async function ye(e,t,n,r){let o=!1;const[i,s,c]=[n.toRecipients,n.ccRecipients,n.bccRecipients].map(e=>e?e.length>fe.MaxRecipientsPerCall?(o=!0,null):function(e){const t=[];return e.forEach(e=>{R(e)&&t.push({Name:e,EmailAddress:e,MailboxType:"OneOff",RoutingType:"SMTP"})}),t}(e):[]);if(o)return void r(l());let d="";if(n.subject){if(n.subject.length>fe.MaxSubjectLength)return void r(l());d=n.subject}let f="";if(n.htmlBody){if(n.htmlBody.length>fe.MaxBodyLengthOnDisplayApis)return void r(l());if(f=await z(n.htmlBody),null==f)return void r(l())}let p=[];if(n.attachments){if(n.attachments.length>fe.MaxAttachmentNumberOnDisplayApis)return void r(l());p=n.attachments.map(ve)}const m=Object(a.c)(e);await m.displayNewMessageForm(i,s,c,d,f,p),r(u())}async function be(e,t,n,r,o){let i="",s=[];if(n.htmlBody){if(n.htmlBody.length>fe.MaxBodyLengthOnDisplayApis)return void r(l());if(i=await z(n.htmlBody),null==i)return void r(l())}if(n.attachments){if(n.attachments.length>fe.MaxAttachmentNumberOnDisplayApis)return void r(l());s=n.attachments.map(ve)}const c=Object(a.c)(e);await c.displayReplyForm(await c.getItemId(),o,i,s),r(u())}async function Oe(e,t,n,r){await be(e,0,n,r,!0)}async function Se(e,t,n,r){try{await Oe(e,0,n,r)}catch(e){r(l(e.message.search("ErrorInvalidIdMalformed")<0?e:c.b.ItemNotFound))}}async function Ce(e,t,n,r){await be(e,0,n,r,!1)}async function Ae(e,t,n,r){try{await Ce(e,0,n,r)}catch(e){r(l(e.message.search("ErrorInvalidIdMalformed")<0?e:c.b.ItemNotFound))}}n(3572);function _e(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"EwsProxyRequestParameters:#Exchange"},n)),Object(L.a)("ExecuteEwsProxy",e,t)}var Ie=n(6);const xe="Token type is not supported for caching: {0}";var Ee=n(3183),Te=n(3135),we=n(261);const Me="CallerIdentity",ke="ScopedToken",je="ExtensionRestApiCallback",Pe="ExtensionCallback";const Re=15,Ne={},De={};function Fe(e,t){Be(t.TokenType)[e]=function(e){return{cacheTime:Date.now(),token:e}}(t)}function Le(e,t){const n=Be(t);if(function(e,t){const n=Be(t);n[e]&&function(e){const t=Date.now()-e.cacheTime,n=1e3*(e.token.TTL-Re)*60;return t>=n}(n[e])&&delete n[e];return!!n[e]}(e,t)){return n[e].token}return null}function Ue(e){return e==Me||e==Pe}function Be(e){switch(e){case Me:return Ne;case Pe:return De;default:throw Object(Ie.c)(xe,e)}}const He="Success";async function Ve(e,t,n){if(Ue(t)){const n=Le(e.get_ExtensionId(),t);if(n)return n}const r=[];let o;Le(e.get_ExtensionId(),Me)||r.push(Me),2!=e.get_RequestedCapabilities()||Le(e.get_ExtensionId(),Pe)||r.push(Pe),t!=je&&t!=ke||r.push(t);try{o=await function(e,t,n){const r=new Array(t.length);t.forEach((t,o)=>r[o]={TokenType:t,Id:e,Scope:n});const o=Object(Te.a)({TokenRequests:r});return Object(Ee.a)({Header:Object(we.b)(),Body:o})}(e.get_ExtensionId(),r,n)}catch(e){return null}const i=function(e){return e.Body.ResponseMessages.Items.forEach(ze),e.Body.ResponseMessages.Items}(o);return We(t)(i)}function ze(e){"NoError"==e.ResponseCode&&e.ResponseClass==He&&Ue(e.Token.TokenType)&&Fe(e.Token.Id,e.Token)}const We=e=>t=>{const n=t.filter(Ge(e))[0];return n?n.Token:null},Ge=e=>t=>"NoError"==t.ResponseCode&&t.ResponseClass==He&&t.Token.TokenType==e;const qe=1e6;const Ke="Error",Xe="accessToken";function Qe(e){return{[Ke]:e}}function Je(e){if(!e)return;let t;try{let n=new URL(e);if(!n||"https:"!=n.protocol)return;t=n.host}catch(n){let r=document.createElement("a");if(r.href=e,"https:"!==r.protocol)return;let o=e=>"/"===e.substring(e.length-1,e.length);""!==r.pathname&&"/"!==r.pathname||o(e)||(e+="/");let i=r.protocol+"//"+r.hostname+(o(r.hostname)?"":"/")+r.pathname+r.search+r.hash,a=r.protocol+"//"+r.host+(o(r.host)?"":"/")+r.pathname+r.search+r.hash;e!=i&&e!=a||(t="443"==r.port?r.hostname:r.host)}return t}var Ye=n(296);var Ze=n(282),$e=n(1713),et=n(2776);async function tt(e,t,n){let r=null,o=await t.getItem(),i=!1;if(o.Attachments.length>0){for(let e of o.Attachments){let o=e.AttachmentOriginalUrl,a=e.AttachmentId.Id;if("ReferenceAttachment:#Exchange"===e.__type&&n===o){let t=e;return r={format:E.b.Url,content:t.AttachLongPathName},i=!0,r}if(n===a)return r=await t.getAttachmentContent(n),i=!0,r}if(!i)return r}return r}var nt=n(955),rt=n(954),ot=n(905);const it="Success";function at(e,t,n){const r=e.map(e=>Object(ot.a)({Id:e}));return Object(nt.a)({Header:Object(we.b)(),Body:Object(rt.a)({ItemShape:t,ItemIds:r,ShapeName:n})}).then(e=>(function(e){if(e.ResponseClass==it){return e.Items[0]}return{}})(e.Body.ResponseMessages.Items[0]))}var st=n(707),ct=n(1701);function ut(){return Object(st.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ct.a)({FieldURI:"NormalizedBody"})]})}function lt(e,t){return{wasSuccessful:e,token:t}}const dt="ParentItemId:";var ft;!function(e){e[e.Message=1]="Message",e[e.Appointment=2]="Appointment",e[e.MeetingRequest=3]="MeetingRequest",e[e.MessageCompose=4]="MessageCompose",e[e.AppointmentCompose=5]="AppointmentCompose"}(ft||(ft={}));var pt=ft;var mt=n(16),ht=n(307),gt=n.n(ht);function vt(e,t,n){if(!e)return{};const r={Addresses:e.Addresses?e.Addresses.map(e=>e.Address):[],Urls:e.Urls?e.Urls.map(e=>e.Url):[],PhoneNumbers:e.PhoneNumbers?e.PhoneNumbers:[]};return r.IsLegacyExtraction=function(e){return!(e.EntityDocument||e.PropertyExistence&&e.PropertyExistence.TextEntityExtractions)}(t),0!=n.get_RequestedCapabilities()&&(r.Contacts=e.Contacts?e.Contacts:[],r.EmailAddresses=e.EmailAddresses?e.EmailAddresses.map(e=>e.EmailAddress):[],r.MeetingSuggestions=e.MeetingSuggestions?e.MeetingSuggestions.map(bt.bind(r)):[],r.TaskSuggestions=e.TaskSuggestions?e.TaskSuggestions:[]),r}function yt(e,t){for(const n of t){const t=C(e,n,!0);if(t&&t.length>0)return!0}return!1}function bt(e){const t=this.IsLegacyExtraction,n=Object(mt.toJS)(gt()({},e));return n.EndTime=t?Ot(n.EndTime):new Date(n.EndTime).getTime(),n.StartTime=t?Ot(n.StartTime):new Date(n.StartTime).getTime(),n}function Ot(e){const t=new Date(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),n.getTime()}function St(e){let t={};return e&&Object.keys(e).forEach(n=>{e[n]&&(t[n]=function(e){return Object(p.u)().contextualCalloutState.selectedTerms.filter(t=>e.indexOf(t)>=0)}(e[n]))}),t}function Ct(e){return at([e.ItemId.Id],Object(st.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(ct.a)({FieldURI:"EntityExtractionResult"})]}),null)}async function At(e,t,n,r){if(!t.EntityExtractionResult&&function(e){return e.PropertyExistence&&(e.PropertyExistence.ExtractedAddresses||e.PropertyExistence.ExtractedContacts||e.PropertyExistence.ExtractedEmails||e.PropertyExistence.ExtractedMeetings||e.PropertyExistence.ExtractedPhones||e.PropertyExistence.ExtractedTasks||e.PropertyExistence.ExtractedUrls)}(t))try{const e=await Ct(t);Object(p.pb)(t,e.EntityExtractionResult)}catch(e){}if(t.EntityExtractionResult&&(r.entities=vt(t.EntityExtractionResult,t,n),r.entities)){const e=JSON.parse(JSON.stringify(r.entities));r.selectedEntities=function(e,t){const n={};return e&&t&&(e.Addresses&&(n.Addresses=e.Addresses.filter(e=>yt(e,t))),e.MeetingSuggestions&&(n.MeetingSuggestions=e.MeetingSuggestions.filter(e=>yt(e.MeetingString,t))),e.TaskSuggestions&&(n.TaskSuggestions=e.TaskSuggestions.filter(e=>yt(e.TaskString,t))),e.PhoneNumbers&&(n.PhoneNumbers=e.PhoneNumbers.filter(e=>yt(e.OriginalPhoneString,t))),e.Urls&&(n.Urls=e.Urls.filter(e=>yt(e,t))),e.Contacts&&(n.Contacts=e.Contacts.filter(e=>yt(e.ContactString,t))),e.EmailAddresses&&(n.EmailAddresses=e.EmailAddresses.filter(e=>yt(e,t)))),n}(e,Object(p.u)().contextualCalloutState.selectedTerms)}const o=function(e,t){const n=Object(p.y)(e);return(null==n?void 0:n.contextualEvaluationResults)&&n.contextualEvaluationResults.has(t)?n.contextualEvaluationResults.get(t):null}(e,n.get_ExtensionId());return o&&(r.filteredEntities=o.filteredEntityMatches,r.regExMatches=o.regExMatches,r.selectedRegExMatches=St(r.regExMatches)),r}var _t,It,xt=n(6134);!function(e){e[e.Other=0]="Other",e[e.DistributionList=1]="DistributionList",e[e.User=2]="User",e[e.ExternalUser=3]="ExternalUser"}(_t||(_t={})),function(e){e[e.Unknown=0]="Unknown",e[e.Organizer=1]="Organizer",e[e.Tentative=2]="Tentative",e[e.Accept=3]="Accept",e[e.Decline=4]="Decline",e[e.NoResponseReceived=5]="NoResponseReceived"}(It||(It={}));const Et=e=>({address:e.EmailAddress,name:e.Name,recipientType:Mt(e.MailboxType)}),Tt=e=>{const t=Et(e.Mailbox);return t.appointmentResponse=function(e){switch(e){case"Organizer":return It.Organizer;case"Tentative":return It.Tentative;case"Accept":return It.Accept;case"Decline":return It.Decline;case"NoResponseReceived":return It.NoResponseReceived;default:return It.Unknown}}(e.ResponseType),t},wt=e=>e?e.map(e=>Tt(e)):[];function Mt(e){switch(e){case"PublicDL":case"PrivateDL":case"PublicFolder":return _t.DistributionList;case"Mailbox":case"Contact":return _t.User;case"OneOff":return _t.ExternalUser;default:return _t.Other}}var kt=n(8583),jt=n(88),Pt=n(57),Rt=n(2);function Nt(e,t,n,r){return r=function(e,t){return t.hostVersion=Object(Rt.u)()||"debug",t.owaView="mouse",t.timeZoneOffsets=Object(jt.e)(),t}(0,r=function(e,t){return t.extensionId=e.get_ExtensionId(),t.marketplaceContentMarket=e.get_MarketPlaceContentMarket(),t.permissionLevel=e.get_RequestedCapabilities(),t.marketplaceAssetId=e.get_MarketPlaceAssetId(),t.entryPointUrl=e.get_EntryPoint(),t.consentMetadata=e.get_ConsentMetaData(),t.endNodeUrl=e.get_EndNodeUrl(),t}(t,r)),0!=t.get_RequestedCapabilities()&&(r=function(e,t){return t.userDisplayName=Object(Pt.k)(),t.userEmailAddress=Object(Pt.l)(),t.userTimeZone=Object(Pt.o)(),t.userProfileType=Object(kt.a)(),t.restUrl=Object(p.t)().RestUrl,t.ewsUrl=Object(p.t)().EwsUrl,t}(0,r)),e.isSharedItem&&e.getSharedProperties&&(r.isFromSharedFolder=e.isSharedItem()),r.shouldRunNewCodeForFlags|=1,r}const Dt="0xe1d";async function Ft(e,t,n,r){const[o,i]=await Promise.all([e.getItem(),e.getItemId()]);return r.id=i,r.isRead=!0,r.itemType=pt.Message,r.itemClass=o.ItemClass,r.subject=o.Subject,r.normalizedSubject=function(e,t){if(!e.ExtendedProperty)return null;for(let n=0;n<e.ExtendedProperty.length;n++){const r=e.ExtendedProperty[n];if((null==r?void 0:r.ExtendedFieldURI)&&r.ExtendedFieldURI.PropertyTag===t)return r.Value}return null}(o,Dt),r.conversationId=o.ConversationId.Id,r.internetMessageId=o.InternetMessageId,r.dateTimeCreated=o.DateTimeCreated?new Date(o.DateTimeCreated).getTime():null,r.dateTimeModified=o.LastModifiedTime?new Date(o.LastModifiedTime).getTime():null,r.dateTimeSent=o.DateTimeSent?new Date(o.DateTimeSent).getTime():null,r.attachments=o.Attachments?Object(E.f)(o.Attachments):[],r=await At(n,o,t,r),0!=t.get_RequestedCapabilities()&&(r.from=o.From?Et(o.From.Mailbox):null,r.sender=o.Sender?Et(o.Sender.Mailbox):null,r.to=o.ToRecipients?o.ToRecipients.map(Et):[],r.cc=o.CcRecipients?o.CcRecipients.map(Et):[],r.bcc=o.BccRecipients?o.BccRecipients.map(Et):[],function(e){return 0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Request")||0==e.ItemClass.indexOf("IPM.Schedule.Meeting.Canceled")}(o)&&(r=await async function(e,t){const n=await e.getItem();t.itemType=pt.MeetingRequest,t.location=n.Location.DisplayName,t.start=n.Start,t.end=n.End,t.to=n.RequiredAttendees?n.RequiredAttendees.map(Tt):[],t.cc=n.OptionalAttendees?n.OptionalAttendees.map(Tt):[],t.resources=n.Resources?n.Resources.map(Tt):[],t.seriesId=await e.getSeriesId();const r=await e.getRecurrence();return t.recurrence=Object(xt.a)({recurrenceType:r,timeZone:n.StartTimeZoneId,startTime:new Date(n.Start),endTime:new Date(n.End)}),t}(e,r))),r}async function Lt(e,t){let n={};const r=Object(a.c)(t),o=(Object(p.y)(t),Object(p.m)(e));switch(n=Nt(r,o,0,n),r.mode){case O.a.MeetingRequest:case O.a.MessageRead:n=await Ft(r,o,t,n);break;case O.a.MessageCompose:n=function(e,t){return t.itemType=pt.MessageCompose,t.conversationId=e.getConversationId(),t.isRead=!1,t}(r,n);break;case O.a.AppointmentAttendee:n=await async function(e,t,n,r){r.itemType=pt.Appointment;const o=await e.getItem();r.id=o.ItemId.Id,r.end=o.End,r.start=o.Start,r.location=o.Location?o.Location.DisplayName:"",r.dateTimeCreated=o.DateTimeCreated?new Date(o.DateTimeCreated):null,r.dateTimeModified=o.LastModifiedTime?new Date(o.LastModifiedTime):null,r.itemClass=o.ItemClass,r.subject=o.Subject,r.normalizedSubject=o.Subject,r.organizer=Tt(o.Organizer);const i=wt(o.RequiredAttendees);r.to=function(e,t){if(t){if(!e.some(e=>e.address.toLowerCase()===t.address.toLowerCase()))return e.concat(t)}return e}(i,r.organizer),r.cc=wt(o.OptionalAttendees),r.attachments=o.Attachments?Object(E.f)(o.Attachments):[];const a=await e.getRecurrence();return r.recurrence=Object(xt.a)({recurrenceType:a,timeZone:o.StartTimeZoneId,startTime:new Date(o.Start),endTime:new Date(o.End)}),r.resources=wt(o.Resources),r.seriesId=await e.getSeriesId(),r=await At(n,o,t,r)}(r,o,t,n);break;case O.a.AppointmentOrganizer:n=await async function(e,t){return t.itemType=pt.AppointmentCompose,t.seriesId=await e.getSeriesId(),t}(r,n)}return n}const Ut=500;var Bt;!function(e){e[e.Start=1]="Start",e[e.End=2]="End"}(Bt||(Bt={}));var Ht=Bt;var Vt=n(1735);function zt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"LoadExtensionCustomPropertiesParameters:#Exchange"},n))),Object(L.a)("LoadExtensionCustomProperties",e,t)}function Wt(e,t,n){return{errorMessage:e,wasSuccessful:t,customProperties:n}}var Gt=n(4456);function qt(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"RegisterConsentJsonRequest:#Exchange"},n)),Object(L.a)("RegisterConsent",e,t)}function Kt(e,t){const n=(r={Id:e,ConsentState:t},Object.assign({__type:"RegisterConsentRequest:#Exchange"},r));var r;return qt({Header:Object(we.b)(),Body:n})}var Xt=n(2654),Qt=n(225),Jt=n(2386);function Yt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"SaveExtensionCustomPropertiesParameters:#Exchange"},n))),Object(L.a)("SaveExtensionCustomProperties",e,t)}function Zt(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"SaveExtensionSettingsParameters:#Exchange"},n))),Object(L.a)("SaveExtensionSettings",e,t)}const $t=32768;const en=255;const tn=12e4;var nn;!function(e){e[e.GetInitialData=1]="GetInitialData",e[e.GetUserIdentityToken=2]="GetUserIdentityToken",e[e.EwsRequest=5]="EwsRequest",e[e.LoadCustomProperties=3]="LoadCustomProperties",e[e.SaveCustomProperties=4]="SaveCustomProperties",e[e.DisplayNewAppointmentForm=7]="DisplayNewAppointmentForm",e[e.DisplayMessageForm=8]="DisplayMessageForm",e[e.DisplayAppointmentForm=9]="DisplayAppointmentForm",e[e.DisplayReplyForm=10]="DisplayReplyForm",e[e.DisplayReplyAllForm=11]="DisplayReplyAllForm",e[e.GetCallbackToken=12]="GetCallbackToken",e[e.SetBodySelectedDataAsync=13]="SetBodySelectedDataAsync",e[e.GetBodyTypeAsync=14]="GetBodyTypeAsync",e[e.GetRecipientsAsync=15]="GetRecipientsAsync",e[e.AddFileAttachmentAsync=16]="AddFileAttachmentAsync",e[e.SetSubjectAsync=17]="SetSubjectAsync",e[e.GetSubjectAsync=18]="GetSubjectAsync",e[e.AddItemAttachmentAsync=19]="AddItemAttachmentAsync",e[e.RemoveAttachmentAsync=20]="RemoveAttachmentAsync",e[e.SetRecipientsAsync=21]="SetRecipientsAsync",e[e.AddRecipientsAsync=22]="AddRecipientsAsync",e[e.BodyPrependAsync=23]="BodyPrependAsync",e[e.GetTimeAsync=24]="GetTimeAsync",e[e.SetTimeAsync=25]="SetTimeAsync",e[e.GetLocationAsync=26]="GetLocationAsync",e[e.SetLocationAsync=27]="SetLocationAsync",e[e.GetSelectedDataAsync=28]="GetSelectedDataAsync",e[e.SetSelectedDataAsync=29]="SetSelectedDataAsync",e[e.DisplayReplyFormWithAttachments=30]="DisplayReplyFormWithAttachments",e[e.DisplayReplyAllFormWithAttachments=31]="DisplayReplyAllFormWithAttachments",e[e.SaveAsync=32]="SaveAsync",e[e.AddNotificationMessageAsync=33]="AddNotificationMessageAsync",e[e.GetAllNotificationMessagesAsync=34]="GetAllNotificationMessagesAsync",e[e.ReplaceNotificationMessageAsync=35]="ReplaceNotificationMessageAsync",e[e.RemoveNotificationMessageAsync=36]="RemoveNotificationMessageAsync",e[e.GetBodyAsync=37]="GetBodyAsync",e[e.SetBodyAsync=38]="SetBodyAsync",e[e.RegisterConsentAsync=40]="RegisterConsentAsync",e[e.Close=41]="Close",e[e.CloseApp=42]="CloseApp",e[e.DisplayNewMessageForm=44]="DisplayNewMessageForm",e[e.EventCompleted=94]="EventCompleted",e[e.CloseContainer=97]="CloseContainer",e[e.GetAccessTokenAsync=98]="GetAccessTokenAsync",e[e.GetInitializationContextAsync=99]="GetInitializationContextAsync",e[e.AppendOnSendAsync=100]="AppendOnSendAsync",e[e.GetRecurrenceAsync=103]="GetRecurrenceAsync",e[e.SetRecurrenceAsync=104]="SetRecurrenceAsync",e[e.GetFromAsync=107]="GetFromAsync",e[e.GetSharedPropertiesAsync=108]="GetSharedPropertiesAsync",e[e.MESSAGE_PARENT_DISPID=144]="MESSAGE_PARENT_DISPID",e[e.SEND_MESSAGE_DIALOG_DISPID=145]="SEND_MESSAGE_DIALOG_DISPID",e[e.GetAttachmentsAsync=149]="GetAttachmentsAsync",e[e.AddBase64FileAttachmentAsync=148]="AddBase64FileAttachmentAsync",e[e.GetAttachmentContentAsync=150]="GetAttachmentContentAsync",e[e.GetInternetHeadersAsync=151]="GetInternetHeadersAsync",e[e.SetInternetHeadersAsync=152]="SetInternetHeadersAsync",e[e.RemoveInternetHeadersAsync=153]="RemoveInternetHeadersAsync",e[e.GetEnhancedLocationsAsync=154]="GetEnhancedLocationsAsync",e[e.AddEnhancedLocationsAsync=155]="AddEnhancedLocationsAsync",e[e.RemoveEnhancedLocationsAsync=156]="RemoveEnhancedLocationsAsync",e[e.GetCategoriesAsync=157]="GetCategoriesAsync",e[e.AddCategoriesAsync=158]="AddCategoriesAsync",e[e.RemoveCategoriesAsync=159]="RemoveCategoriesAsync",e[e.GetMasterCategoriesAsync=160]="GetMasterCategoriesAsync",e[e.AddMasterCategoriesAsync=161]="AddMasterCategoriesAsync",e[e.RemoveMasterCategoriesAsync=162]="RemoveMasterCategoriesAsync",e[e.GetItemIdAsync=164]="GetItemIdAsync",e[e.GetAllInternetHeadersAsync=168]="GetAllInternetHeadersAsync",e[e.SaveSettingsRequest=404]="SaveSettingsRequest",e[e.SetSignatureAsync=173]="SetSignatureAsync",e[e.GetComposeTypeAsync=174]="GetComposeTypeAsync",e[e.IsClientSignatureEnabledAsync=175]="IsClientSignatureEnabledAsync",e[e.DisableClientSignatureAsync=176]="DisableClientSignatureAsync",e[e.displayNewAppointmentFormAsync=177]="displayNewAppointmentFormAsync",e[e.displayNewMessageFormAsync=178]="displayNewMessageFormAsync",e[e.displayMessageFormAsync=179]="displayMessageFormAsync",e[e.displayAppointmentFormAsync=180]="displayAppointmentFormAsync",e[e.displayReplyFormWithAttachmentsAsync=181]="displayReplyFormWithAttachmentsAsync",e[e.displayReplyAllFormWithAttachmentsAsync=182]="displayReplyAllFormWithAttachmentsAsync",e[e.displayReplyFormAsync=183]="displayReplyFormAsync",e[e.displayReplyAllFormAsync=184]="displayReplyAllFormAsync",e[e.setSessionDataAsync=185]="setSessionDataAsync",e[e.getSessionDataAsync=186]="getSessionDataAsync",e[e.getAllSessionDataAsync=187]="getAllSessionDataAsync",e[e.clearSessionDataAsync=188]="clearSessionDataAsync",e[e.removeSessionDataAsync=189]="removeSessionDataAsync"}(nn||(nn={}));class rn{constructor(e,t){this.apiMethodDelegate=e,this.apiPermissionRequired=t}}const on={[nn.GetInitialData]:new rn((async function(e,t,n,r){const o=await Lt(t,e);Object(j.p)(!0,Object(p.m)(t),e,Object(p.s)(t),Object(p.H)(e,t),t),r(o)}),0),[nn.EwsRequest]:new rn((async function(e,t,n,r){const{body:o}=n;if(!o||o.length>qe)return void r(l(c.b.GenericResponseError));const i=Object(p.m)(t),a=await Ve(i,Pe);if(a)try{r(function(e){return{wasProxySuccessful:e.WasProxySuccessful,errorMessage:e.ErrorMessage,statusCode:e.StatusCode,statusDescription:e.StatusDescription,body:e.Body}}(await function(e,t,n){return _e({Body:e,Token:t,ExtensionId:n})}(o,a.TokenValue,i.get_ExtensionId())))}catch(e){r(l(c.b.GenericResponseError))}else r(l(c.b.GenericTokenError))}),2),[nn.GetRecipientsAsync]:new rn((function(e,t,n,r){let o=[];o=Object(a.c)(e).getRecipients(n.recipientField).slice(0,Ut).map(e=>({name:e.Name,address:e.EmailAddress,recipientType:Mt(e.MailboxType)})),r(u(o))}),1),[nn.GetSubjectAsync]:new rn((function(e,t,n,r){r(u(Object(a.c)(e).getSubject()||""))}),1),[nn.SetSubjectAsync]:new rn((function(e,t,n,r){if(n.subject.length>en)return void r(l(null));const o=Object(a.c)(e);d(o,r)||(o.setSubject(n.subject),r(u()))}),3),[nn.SetRecipientsAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e);if(d(o,r))return;const i=N(n.recipientArray);try{o.setRecipients(n.recipientField,i),r(u())}catch(e){r(l(e.errorCode))}}),3),[nn.AddRecipientsAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e);if(d(o,r))return;const i=N(n.recipientArray);try{o.addRecipients(n.recipientField,i),r(u())}catch(e){r(l(e.errorCode))}}),3),[nn.SaveSettingsRequest]:new rn((async function(e,t,n,r){const o=n[0],i=JSON.stringify(o);var a,s,d;if(i.length>$t)r(l(c.b.GenericSettingsError));else try{const n=Object(p.m)(t);await(a=n.get_ExtensionId(),s=n.get_Version(),d=i,Zt({request:{ExtensionId:a,ExtensionVersion:s,Settings:d}})),Object(p.qb)(e,t,i),r(u())}catch(e){r(l(c.b.GenericSettingsError))}}),0),[nn.GetAccessTokenAsync]:new rn((function(e,t,n,r){if(Object(Ye.a)())return void r(Qe(X.SSOUnsupportedPlatform));if(!function(e){return!!Object(p.I)(e)}(t))return void r(Qe(X.NotSsoAgave));if(K())return void r(Qe(X.AddinIsAlreadyRequestingToken));if(Object(p.L)(Object(p.o)(Object(p.C)(t),e)))return void r(Qe(X.InternalError));if(function(e,t){let n=Object(p.I)(e);n&&(n=n.toLowerCase().replace("api://","https://"));let r=Je(n),o=Je(t),i=Je(window.location.href);return!r||!o||r.toLowerCase()!=o.toLowerCase()&&o!=i}(t,n.SecurityOrigin))return void r(Qe(X.InvalidResourceUrl));let i=n.allowConsentPrompt;if(n.forMSGraphAccess){const e=Object(p.m)(t);if(Object(p.T)(null==e?void 0:e.get_MarketPlaceAssetId(),null==e?void 0:e.get_OriginString(),null==e?void 0:e.get_TypeString()))return void r(Qe(X.SSOUnsupportedPlatform));i=!1}!function(e){q(e)}((e,t)=>{r(e?Qe(e):function(e){return{[Ke]:o.Success,[Xe]:e}}(t))}),ee(t,n.authChallenge,i)}),1),[nn.GetCallbackToken]:new rn((async function(e,t,n,r){const o=Object(p.m)(t),i=await async function(e){const t=a.c(e),n=await t.getItemId();if(!n)return;return dt+n}(e),s=n.isRest?je:ke;if(!function(e,t){return e==je&&2==t}(s,o.get_RequestedCapabilities())&&!i)return void r(l(c.b.CallSaveAsyncBeforeToken));const u=await Ve(o,s,i);r(u?lt(!0,u.TokenValue):l(c.b.GenericTokenError))}),1),[nn.GetUserIdentityToken]:new rn((async function(e,t,n,r){const o=Object(p.m)(t),i=await Ve(o,Me);r(i?lt(!0,i.TokenValue):l(c.b.GenericTokenError))}),1),[nn.MESSAGE_PARENT_DISPID]:new rn((function(e,t,n,r){Object(Gt.d)(Gt.a.DISPLAY_DIALOG_DISPID,t,n,()=>{r(u())})}),0),[nn.SEND_MESSAGE_DIALOG_DISPID]:new rn((function(e,t,n,r){Object(Gt.d)(Gt.a.DIALOG_PARENT_MESSAGE_RECEIVED,t,n,()=>{r(u())})}),0),[nn.SetBodyAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);if(d(o,r))return;const i=n.coercionType==gn.a.Html?"HTML":"Text";await re(e,0,n,r,e=>o.setBody(e,i))}),1),[nn.GetBodyAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=o.mode;let s=null;if(i==O.a.MessageRead||i==O.a.AppointmentAttendee)try{s=await async function(e){if(!Object(ie.j)("addin-getBodyAsyncApi-update-fix")){if(!e.NormalizedBody){const t=await at([e.ItemId.Id],ut(),"ItemNormalizedBody");e.NormalizedBody=t.NormalizedBody}return e.NormalizedBody.Value}return(await at([e.ItemId.Id],ut(),"ItemNormalizedBody")).NormalizedBody.Value}(await o.getItem())}catch(e){return void r(l(c.a.GenericResponseError))}else i!=O.a.MessageCompose&&i!=O.a.AppointmentOrganizer||(s=o.getBody());n.coercionType==gn.a.Text&&(s=y(s)),r(u(s))}),1),[nn.GetBodyTypeAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e).getBodyType();r(u(o&&o.toLowerCase()||null))}),1),[nn.BodyPrependAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);d(o,r)||(n.coercionType!==gn.a.Html||"Text"!==o.getBodyType()?await re(e,0,n,r,o.prependBody):r(l(c.a.OoeInvalidDataFormat)))}),3),[nn.Close]:new rn(ce.a,0),[nn.CloseApp]:new rn(ue,0),[nn.CloseContainer]:new rn(ue,0),[nn.DisplayMessageForm]:new rn(de,1),[nn.displayMessageFormAsync]:new rn((async function(e,t,n,r){try{await de(e,0,n,r)}catch(e){r(l(e.message.search("ErrorInvalidIdMalformed")<0?e:c.b.ItemNotFound))}}),1),[nn.DisplayReplyAllForm]:new rn(Oe,1),[nn.displayReplyAllFormAsync]:new rn(Se,1),[nn.DisplayReplyAllFormWithAttachments]:new rn(Oe,1),[nn.displayReplyAllFormWithAttachmentsAsync]:new rn(Se,1),[nn.DisplayReplyForm]:new rn(Ce,1),[nn.displayReplyFormAsync]:new rn(Ae,1),[nn.DisplayReplyFormWithAttachments]:new rn(Ce,1),[nn.displayReplyFormWithAttachmentsAsync]:new rn(Ae,1),[nn.DisplayAppointmentForm]:new rn(le,1),[nn.displayAppointmentFormAsync]:new rn((async function(e,t,n,r){try{const t=Object(a.c)(e);await t.checkItemId(n.itemId),le(e,0,n,r)}catch(e){r(l(e.message.search("ErrorInvalidIdMalformed")<0?e:c.b.ItemNotFound))}}),1),[nn.DisplayNewAppointmentForm]:new rn(he,1),[nn.displayNewAppointmentFormAsync]:new rn((function(e,t,n,r){try{he(e,0,n,r)}catch(e){r(l(e.message.search("ErrorInvalidIdMalformed")<0?e:c.b.ItemNotFound))}}),1),[nn.DisplayNewMessageForm]:new rn(ye,1),[nn.displayNewMessageFormAsync]:new rn((async function(e,t,n,r){try{await ye(e,0,n,r)}catch(e){r(l(e.message.search("ErrorInvalidIdMalformed")<0?e:c.b.ItemNotFound))}}),1),[nn.EventCompleted]:new rn((function(e,t,n,r){OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(t,n)}),0),[nn.GetSelectedDataAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e).getSelectedData();o?(n.coercionType==gn.a.Text&&(o.data=y(o.data)),r(u(o))):r(l(c.a.InvalidSelection))}),1),[nn.SetSelectedDataAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);if(d(o,r))return;const i=o.getSelectedData();null!=i?n.coercionType!==gn.a.Html||"subject"!==i.sourceProperty&&("body"!==i.sourceProperty||"Text"!==o.getBodyType())?await re(e,0,n,r,o.setSelectedData,o.getSelectedData):r(l(c.a.OoeInvalidDataFormat)):r(l(c.a.InvalidSelection))}),3),[nn.SetBodySelectedDataAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);d(o,r)||await re(e,0,n,r,o.setBodySelectedData,o.getSelectedData)}),0),[nn.SaveAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e);d(o,r)||o.saveItem().then(async e=>{var t;r(e?u(Object(ie.j)("fwk-immutable-ids")?null===(t=await Object(Xt.b)([e],Jt.a.EwsId,Object(Qt.d)().userIdentity,Xt.a.Addins))||void 0===t?void 0:t[0]:e):l(c.a.SaveError))})}),3),[nn.LoadCustomProperties]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=await o.getItemId();if(!i)return void r(Wt("",!0,"{}"));const s=Object(p.w)(t);let u;try{if(o.isSharedItem&&o.getSharedProperties&&o.isSharedItem()&&o.isRemoteItem()){u=o.getSharedProperties().owner}const e=await function(e,t,n){return zt({request:{ExtensionId:e,ItemId:t}},n?{headers:Object(Vt.e)(n)}:{})}(s,i,u);let t=e.CustomProperties;t&&(t=t.trim()),t||(t="{}"),r(Wt(e.ErrorMessage,e.WasSuccessful,t))}catch(e){r(l(c.b.GenericResponseError))}}),1),[nn.SaveCustomProperties]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=Object(p.w)(t),s=JSON.stringify(n.customProperties);let f,m=await o.getItemId();try{if(d(o,r))return;if(!m){const e=o;m=await e.saveItem()}if(o.isSharedItem&&o.getSharedProperties&&o.isSharedItem()&&o.isRemoteItem()){f=o.getSharedProperties().owner}(await function(e,t,n,r){return Yt({request:{ExtensionId:e,ItemId:t,CustomProperties:r}},n?{headers:Object(Vt.e)(n)}:{})}(i,m,f,s)).WasSuccessful?r(u()):r(l(c.b.GenericResponseError))}catch(e){r(l(c.b.GenericResponseError))}}),1),[nn.AddNotificationMessageAsync]:new rn((async function(e,t,n,r){let o,i,u=!1;const d=Object(a.c)(e).mode;if(3===n.type&&!n.actions)return void r(l(c.a.InvalidParameterValueError));if(3===n.type&&n.actions){u=!0;const e=Object(p.m)(t).get_ExtensionId();switch(d){case O.a.MessageRead:case O.a.AppointmentAttendee:return void r(l(c.a.OperationNotSupported));case O.a.MessageCompose:case O.a.AppointmentOrganizer:if(o=M(e,n.actions[0].commandId,d),!o)return void r(l(c.a.InvalidParameterValueError));i={NotificationActionData:n.actions[0],CustomButtonAction:o,CustomButtonIcon:o.get_Size16Icon()}}}const f=Object(p.C)(t),m=await v(e,t,n.persistent,n.key,n.type,n.message,f,n.icon,!0,i),h=Object(p.m)(t);Object(k.o)("ShowNotificationBar",{Id:Object(j.m)(h.get_MarketPlaceAssetId(),h.get_ExtensionId(),h.get_ProviderName(),h.get_TypeString()),DisplayName:h.get_ExtensionDisplayName(),Scenario:Object(p.B)(e),extPoint:Object(p.s)(t),IsClickableInfobar:u,error:m instanceof s.a?JSON.stringify(m):"",mode:d}),r(m)}),1),[nn.GetAllNotificationMessagesAsync]:new rn((function(e,t,n,r){r(u(Object(a.c)(e).getNotificationMessageIds().reduce((e,t)=>{const n=Object(m.e)(t);return n&&e.push(function(e){return Object.assign({key:e.Key,type:g(e.Type),message:e.Message,icon:e.Icon},e.Persistent&&2!==e.Type&&{persistent:!0})}(n)),e},[])))}),1),[nn.RemoveNotificationMessageAsync]:new rn((async function(e,t,n,r){r(await h(e,t,n.key))}),1),[nn.ReplaceNotificationMessageAsync]:new rn((async function(e,t,n,r){let o,i,u=!1;const d=Object(a.c)(e).mode;if(3===n.type&&!n.actions)return void r(l(c.a.InvalidParameterValueError));if(3===n.type&&n.actions){u=!0;const e=Object(p.m)(t).get_ExtensionId();switch(d){case O.a.MessageRead:case O.a.AppointmentAttendee:return void r(l(c.a.OperationNotSupported));case O.a.MessageCompose:case O.a.AppointmentOrganizer:if(o=M(e,n.actions[0].commandId,d),!o)return void r(l(c.a.InvalidParameterValueError));i={NotificationActionData:n.actions[0],CustomButtonAction:o,CustomButtonIcon:o.get_Size16Icon()}}}const f=Object(p.C)(t),m=await v(e,t,n.persistent,n.key,n.type,n.message,f,n.icon,!1,i),h=Object(p.m)(t);Object(k.o)("ShowNotificationBar",{Id:Object(j.m)(h.get_MarketPlaceAssetId(),h.get_ExtensionId(),h.get_ProviderName(),h.get_TypeString()),DisplayName:null==h?void 0:h.get_ExtensionDisplayName(),Scenario:Object(p.B)(e),extPoint:Object(p.s)(t),IsClickableInfobar:u,error:m instanceof s.a?JSON.stringify(m):"",mode:d}),r(m)}),1),[nn.AddItemAttachmentAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);try{if(d(o,r))return;const e=await o.addItemAttachment(n.name,n.itemId,n.isInline);r(e?u(e):l(c.a.AttachmentUploadGeneralFailure))}catch(e){r(l(e))}}),3),[nn.AddFileAttachmentAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);try{if(d(o,r))return;const e=await o.addFileAttachment(n.name,n.uri,n.isInline);r(e?u(e):l(c.a.AttachmentUploadGeneralFailure))}catch(e){r(l(c.a.AttachmentUploadGeneralFailure))}}),3),[nn.AddBase64FileAttachmentAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);try{const e=await o.addFileAttachmentFromBase64(n.base64String,n.name,n.isInline);r(e?u(e):l(c.a.AttachmentUploadGeneralFailure))}catch(e){r(l(e.errorCode))}}),3),[nn.RemoveAttachmentAsync]:new rn((async function(e,t,n,r){if(n&&n.attachmentIndex)try{const t=Object(a.c)(e);if(d(t,r))return;await t.removeAttachment(n.attachmentIndex),r(u())}catch(e){r(l(e.errorCode))}else r(l(c.a.InvalidAttachmentId))}),3),[nn.GetCategoriesAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=o.mode;let s=null,d=null;try{switch(i){case O.a.MessageRead:s=await o.getCategoriesItem();break;case O.a.MessageCompose:return void r(l(c.b.OperationNotSupported));case O.a.AppointmentAttendee:case O.a.AppointmentOrganizer:s=await o.getCategoriesItem();break;default:Object(x.a)(i)}if(null==s)return void r(l(c.b.GenericResponseError));d=function(e){let t=[];for(let n of e){let e={displayName:n.Name,color:T.a[n.Color]};t.push(e)}return t}(s),r(u(d))}catch(e){r(l(e.errorCode))}}),1),[nn.AddCategoriesAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=o.mode,s=(await A.u.import())();if(function(e,t){for(let n of e){if(0===t.filter(e=>e.Name===n).length)return!0}return!1}(n.categories,s)||I(n.categories))return void r(l(c.a.InvalidCategoryError));const d=(f=n.categories,p=[],f.forEach(e=>{let t=!1;for(let n of p)n===e&&(t=!0);t||p.push(e)}),p);var f,p;try{switch(i){case O.a.MessageRead:await o.addCategoriesItemRead(d);break;case O.a.MessageCompose:return void r(l(c.a.OperationNotSupported));case O.a.AppointmentAttendee:await o.addCategoriesItemRead(d);break;case O.a.AppointmentOrganizer:await o.addCategoriesItemCompose(d);break;default:Object(x.a)(i)}r(u())}catch(e){r(l(e.errorCode))}}),1),[nn.RemoveCategoriesAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=o.mode;if(I(n.categories))r(l(c.a.InvalidCategoryError));else try{switch(i){case O.a.MessageRead:await o.removeCategoriesItemRead(n.categories);break;case O.a.MessageCompose:return void r(l(c.a.OperationNotSupported));case O.a.AppointmentAttendee:await o.removeCategoriesItemRead(n.categories);break;case O.a.AppointmentOrganizer:await o.removeCategoriesItemCompose(n.categories);break;default:Object(x.a)(i)}r(u())}catch(e){r(l(e.errorCode))}}),1),[nn.GetAttachmentContentAsync]:new rn((async function(e,t,n,r){if(!n||!n.id)return void r(l(c.a.InvalidAttachmentId));let o=null;const i=Object(a.c)(e),s=i.mode;var d=!1;const f=Object($e.a)({Id:n.id});if(Object(et.a)(f.model)){const e=f.model.EmbeddedItemClass;if(e&&"IPM.Note"!==e&&"IPM.Appointment"!==e)return void r(l(c.a.AttachmentTypeNotSupported))}switch(s){case O.a.MessageRead:d=!0,o=await tt(d,i,n.id);break;case O.a.MessageCompose:o=await i.getAttachmentContent(n.id);break;case O.a.AppointmentAttendee:d=!1,o=await tt(d,i,n.id);break;case O.a.AppointmentOrganizer:o=await i.getAttachmentContent(n.id);break;default:Object(Ze.a)(s)}if(null!=o)try{r(u(o))}catch(e){r(l(c.a.InvalidAttachmentId))}else r(l(c.a.InvalidAttachmentId))}),1),[nn.GetAttachmentsAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);let i=null,s=[];switch(o.mode){case O.a.MessageCompose:case O.a.AppointmentOrganizer:i=await o.getAttachments()}if(null!=i){s=i.map(e=>({id:e.id,name:e.name,contentType:e.contentType,size:e.size,attachmentType:e.attachmentType,isInline:e.isInline,url:e.url?e.url:void 0}));try{r(u(s))}catch(e){r(l(e.errorCode))}}else r(l(c.a.GenericResponseError))}),1),[nn.RegisterConsentAsync]:new rn((async function(e,t,n,r){const{consentState:o}=n,i=Object(p.w)(t);if(i&&o)try{Object(p.nb)(e,t,o);const n=await Kt(i,o);if("NoError"===n.Body.ResponseCode&&"Success"===n.Body.ResponseClass)return void r(u());r(l(c.b.GenericResponseError))}catch(e){r(l(c.b.GenericResponseError))}else r(l(c.b.GenericResponseError))}),0),[nn.GetLocationAsync]:new rn((function(e,t,n,r){r(u(Object(a.c)(e).getLocation()||""))}),1),[nn.SetLocationAsync]:new rn((function(e,t,n,r){if(null==n.location)return void r(l(null));const o=Object(a.c)(e);d(o,r)||(o.setLocation(n.location),r(u()))}),3),[nn.GetTimeAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e);let i=null;n.TimeProperty===Ht.Start?i=o.getStartTime():n.TimeProperty===Ht.End&&(i=o.getEndTime()),r(u(i))}),1),[nn.SetTimeAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e);if(d(o,r))return;const i=new Date(n.time);if(n.TimeProperty===Ht.Start)o.setStartTime(i);else if(n.TimeProperty===Ht.End){if(!o.setEndTime(i))return void r(l(c.a.InvalidEndTime))}r(u())}),3),[nn.GetInitializationContextAsync]:new rn((function(e,t,n,r){const{taskPanes:o}=Object(p.u)();for(let t of o.values())for(let n of t.values())n.hostItemIndex===e&&(void 0).push(t);let i="";[...(void 0).values()].forEach(e=>{e.initializationContext&&(i=e.initializationContext)}),r(null!=i&&null!=i?u(i):l())}),1),[nn.GetFromAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e).getFrom();r(o?u({name:o.Name,address:o.EmailAddress}):l())}),1),[nn.GetSharedPropertiesAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=o.getSharedProperties();let s,c;if(o.isRemoteItem()){c=i.owner;try{s=await(l=i.owner,new Promise((e,t)=>{if(l){const n="https://outlook.office365.com/autodiscover/autodiscover.json/v1.0/"+l+"?Protocol=REST",r=new XMLHttpRequest;r.open("GET",n),r.onload=function(){if(200===r.status){const t=JSON.parse(this.response).Url;e(t)}else t(new Error("Request failed with status "+r.status+". Message: "+r.responseText))},r.send()}else t(new Error("smtpAddress is null or empty"))}))}catch(e){s=void 0}}else c=Object(Pt.l)(),s=Object(p.t)().RestUrl;var l;r(u({delegatePermissions:function(e){let t=0;e.Read&&(t+=E.d.Read);e.Create&&(t+=E.d.Create);e.DeleteOwn&&(t+=E.d.DeleteOwn);e.DeleteAll&&(t+=E.d.DeleteAll);e.EditOwn&&(t+=E.d.EditOwn);e.EditAll&&(t+=E.d.EditAll);return t}(i.delegatePermissions),owner:i.owner,targetRestUrl:s,targetMailbox:c}))}),1),[nn.GetRecurrenceAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=await o.getRecurrence();r(u(Object(xt.a)({recurrenceType:i,timeZone:o.getTimeZoneName(),endTime:o.getEndTime(),startTime:o.getStartTime()})))}),1),[nn.SetRecurrenceAsync]:new rn((async function(e,t,n,r){if(!Object(xt.c)(n.recurrenceData))return void r(l(c.a.InvalidRecurrence));const o=Object(a.c)(e);if(d(o,r))return;if(null!=await o.getSeriesId())return void r(l(c.a.SetRecurrenceOnInstance));const i=Object(xt.b)(n.recurrenceData);null==i?o.setRecurrence(null):(Object(ie.j)("addin-fix-recurrenceTimezone")||o.setTimeZoneName(i.timeZone),o.setStartTime(i.startTime),o.setEndTime(i.endTime),Object(ie.j)("addin-fix-recurrenceTimezone")&&o.setTimeZoneName(i.timeZone),o.setRecurrence(i.recurrenceType)),r(u())}),3),[nn.GetInternetHeadersAsync]:new rn((async function(e,t,n,r){if(!n||!Object(E.i)(n.internetHeaderKeys))return void r(l());const o=Object(a.c)(e);r(u(await o.getInternetHeaders(n.internetHeaderKeys)))}),1),[nn.SetInternetHeadersAsync]:new rn((function(e,t,n,r){if(!n||!Object(E.h)(n.internetHeaderNameValuePairs))return void r(l());const o=Object(a.c)(e);d(o,r)||(o.setInternetHeaders(n.internetHeaderNameValuePairs),r(u()))}),1),[nn.RemoveInternetHeadersAsync]:new rn((async function(e,t,n,r){if(!n||!Object(E.i)(n.internetHeaderKeys))return void r(l());const o=Object(a.c)(e);d(o,r)||(await o.removeInternetHeaders(n.internetHeaderKeys),r(u()))}),1),[nn.AppendOnSendAsync]:new rn((async function(e,t,n,r){const o=Object(p.m)(t);if(!o)return void r(l(c.a.GenericResponseError));if((o.get_ExtendedPermissions()?o.get_ExtendedPermissions().map((function(e){return e.toLowerCase()})):[]).indexOf("appendonsend")<=-1)return void r(l(c.a.MissingExtendedPermissionsForAPIError));const i=Object(a.c)(e),s=i.mode;if(!Object(ie.j)("rp-appendOnSend")||s==O.a.MessageRead||s==O.a.AppointmentAttendee)return void r(l(c.a.OperationNotSupported));const u=n.appendTxt;if(u&&u.length>ae)return void r(l(c.a.OoeInvalidDataFormat));if(d(i,r))return;if(n.coercionType===gn.a.Html&&"Text"===i.getBodyType())return void r(l(c.a.OoeInvalidDataFormat));const f=Object(p.w)(t);if(null==f||Object(oe.a)(f,t))return void r(l(c.a.ApiCallNotSupportedByExtensionPoint));let m={id:f,typ:n.coercionType,txt:u};n.appendOnSend=m,await re(e,0,n,r,i.appendOnSend)}),3),[nn.GetEnhancedLocationsAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e).getEnhancedLocations();!o||o.length<=0?r(u([])):r(u(o.map(E.g)))}),1),[nn.AddEnhancedLocationsAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e);if(!d(o,r))if(n&&Object(E.j)(n.enhancedLocations))try{await o.addEnhancedLocations(n.enhancedLocations),r(u())}catch(e){r(l())}else r(l())}),3),[nn.RemoveEnhancedLocationsAsync]:new rn((function(e,t,n,r){const o=Object(a.c)(e);n&&Object(E.j)(n.enhancedLocations)?(o.removeEnhancedLocations(n.enhancedLocations),r(u())):r(l())}),3),[nn.GetMasterCategoriesAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=o.mode;let s=[],d=null;try{switch(i){case O.a.MessageRead:case O.a.MessageCompose:s=await o.getCategoriesMailbox();break;case O.a.AppointmentAttendee:case O.a.AppointmentOrganizer:s=await o.getCategoriesMailbox();break;default:Object(x.a)(i)}if(null==s||null==s)return void r(l(c.b.GenericResponseError));d=s.map(e=>({displayName:e.Name,color:T.a[e.Color]})),r(u(d))}catch(e){r(l(e.errorCode))}}),2),[nn.AddMasterCategoriesAsync]:new rn((async function(e,t,n,r){try{const t=Object(a.c)(e);if(t.isSharedItem())return void r(l(c.b.InsufficientItemPermissions));var o;if(!(o=function(e,t){var n=[];return e.forEach(e=>{var t=e.Name.length;if(0===t||t>255)return null;let r=!1;for(let t=0;t<n.length;t++)n[t].Name==e.Name&&(n[t].Color=e.Color,r=!0);r||n.push(e)}),n}(n.categoryDetails.map(e=>({Name:e.displayName,Id:Object(w.a)(),Color:T.a[e.color]})))))return void r(l(c.b.InvalidCategoryError));if(function(e){let t=Object(A.o)();for(let n=0;n<e.length;n++){if(t.filter(t=>t.Name===e[n].Name).length>0)return!0}return!1}(o))return void r(l(c.b.DuplicateCategoryError));r(await t.addCategoriesMailbox(o)?u():l(c.b.GenericResponseError))}catch(e){r(l(e.errorCode))}}),2),[nn.RemoveMasterCategoriesAsync]:new rn((async function(e,t,n,r){try{const t=Object(a.c)(e);if(t.isSharedItem())return void r(l(c.b.InsufficientItemPermissions));for(let e=0;e<n.categories.length;e++){var o=n.categories[e].length;if(0===o||o>255)return void r(l(c.b.InvalidCategoryError))}r(await t.removeCategoriesMailbox(n.categories)?u():l(c.b.GenericResponseError))}catch(e){r(l())}}),2),[nn.GetItemIdAsync]:new rn((function(e,t,n,r){Object(a.c)(e).getItemId().then(e=>{r(e?u(e):l(c.a.ItemNotSavedError))}).catch(()=>{r(l(c.a.InternalServerError))})}),1),[nn.GetAllInternetHeadersAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=await o.getAllInternetHeaders();r(null==i?l(c.a.GenericResponseError):u(i))}),1),[nn.SetSignatureAsync]:new rn((async function(e,t,n,r){if(!Object(ie.j)("addin-signatureScenario"))return void r(l(c.a.OperationNotSupported));if(n.data.length>tn)return void r(l(c.a.OoeInvalidDataFormat));const o=Object(a.c)(e);if(n.coercionType===gn.a.Html&&"Text"===o.getBodyType())return void r(l(c.a.OoeInvalidDataFormat));if(d(o,r))return;if(o.mode!==O.a.MessageCompose)return void r(l(X.OperationNotSupported));await re(e,0,n,r,e=>o.setSignature(e))}),3),[nn.GetComposeTypeAsync]:new rn((async function(e,t,n,r){if(!Object(ie.j)("addin-signatureScenario"))return void r(l(c.b.OperationNotSupported));const o=Object(a.c)(e),i=o.mode;try{if(i!==O.a.MessageCompose)return void r(l(c.b.OperationNotSupported));{let e;e=o.getComposeTypeAndCoercionType(),r(u(e))}}catch(e){r(l(e.errorCode))}}),1),[nn.IsClientSignatureEnabledAsync]:new rn((async function(e,t,n,r){if(!Object(ie.j)("addin-signatureScenario"))return void r(l(c.b.OperationNotSupported));const o=Object(a.c)(e),i=o.mode;try{if(i!==O.a.MessageCompose)return void r(l(c.b.OperationNotSupported));{let e;e=o.isClientSignatureEnabled(),r(u(e))}}catch(e){r(l(e.errorCode))}}),1),[nn.DisableClientSignatureAsync]:new rn((async function(e,t,n,r){if(!Object(ie.j)("addin-signatureScenario"))return void r(l(c.b.OperationNotSupported));const o=Object(a.c)(e),i=o.mode;try{if(i===O.a.MessageCompose){let e;return e=await o.disableClientSignature(),void r(u(e))}return void r(l(c.b.OperationNotSupported))}catch(e){r(l(e.errorCode))}}),3),[nn.setSessionDataAsync]:new rn((async function(e,t,n,r){const o=Object(a.c)(e),i=Object(p.m)(t);if(i&&o)try{o.setSessionDataState(n.name,n.value,i.get_Id()),r(u())}catch(e){r(l(e))}else r(l())}),3),[nn.getSessionDataAsync]:new rn((async function(e,t,n,r){const o=Object(p.m)(t),i=Object(a.c)(e);if(o&&i)try{r(u(i.getSessionDataState(n.name,o.get_Id())))}catch(e){r(l(e))}else r(l())}),3),[nn.getAllSessionDataAsync]:new rn((async function(e,t,n,r){const o=Object(p.m)(t),i=Object(a.c)(e);if(o&&i)try{r(u(i.getAllSessionDataState(o.get_Id())))}catch(e){r(l(e))}else r(l())}),3),[nn.clearSessionDataAsync]:new rn((async function(e,t,n,r){const o=Object(p.m)(t),i=Object(a.c)(e);if(o&&i)try{i.clearSessionDataState(o.get_Id()),r(u())}catch(e){r(l(e))}else r(l())}),3),[nn.removeSessionDataAsync]:new rn((async function(e,t,n,r){const o=Object(p.m)(t),i=Object(a.c)(e);if(o&&i)try{i.removeSessionDataState(n.name,o.get_Id()),r(u())}catch(e){r(l(e))}else r(l())}),3)},an=[nn.DisplayAppointmentForm,nn.DisplayMessageForm,nn.DisplayNewAppointmentForm,nn.DisplayNewMessageForm,nn.MESSAGE_PARENT_DISPID];var sn=n(8227);let cn;function un(e,t,n,r,o){if(!on[t]||!on[t].apiMethodDelegate)return;const i=on[t].apiMethodDelegate,a=Object(p.m)(n),s="ExecuteApiMethod";if(!S(e))return Object(k.o)("ExtExecuteApiMethodNoItemFailure",[t]),void o(l(c.b.GenericResponseError));if(!function(e,t){const n=Object(p.m)(e);var r=!1,o=null==n?void 0:n.get_RequestedCapabilities();switch(t){case 0:r=!0;break;case 1:1!=o&&3!=o&&2!=o||(r=!0);break;case 3:3!=o&&2!=o||(r=!0);break;case 2:2==o&&(r=!0)}return r}(n,on[t].apiPermissionRequired))return Object(k.o)("ExtExecuteApiMethodInsufficientPermissions",[t]),void o(l(c.b.InsufficientItemPermissions));const u=function(e,t){const n=Object(p.m)(e),r=Object(p.N)(n),o=an.includes(t);return!(!r||!o)}(n,t);if(Object(ie.j)("addin-autoRun")&&u)return Object(k.o)("ExtExecuteApiMethodNotSupportedInAutorun",[t]),void o(l(c.b.ApiCallNotSupportedByExtensionPoint));let d=Object(sn.a)();try{cn=r=>{let i=null;r&&(r.errorCode?i=r.errorCode:r.Error&&(i=r.Error));let c=Object(sn.a)();Object(k.o)(s,{dispId:t,Id:Object(j.m)(a.get_MarketPlaceAssetId(),a.get_ExtensionId(),a.get_ProviderName(),a.get_TypeString()),DisplayName:a.get_ExtensionDisplayName(),owa_1:Object(Rt.m)(),owa_2:Object(p.B)(e),extPoint:Object(p.s)(n),owa_4:a.get_Type(),apiExecutionTime:c-d,isAutoRun:Object(p.N)(a),errorCode:i}),o(r)},i(e,n,r,cn)}catch(r){let i=Object(sn.a)();Object(k.o)(s,{dispId:t,Id:Object(j.m)(a.get_MarketPlaceAssetId(),a.get_ExtensionId(),a.get_ProviderName(),a.get_TypeString()),DisplayName:a.get_ExtensionDisplayName(),owa_1:Object(Rt.m)(),owa_2:Object(p.B)(e),extPoint:Object(p.s)(n),owa_4:a.get_Type(),apiExecutionTime:i-d,isAutoRun:Object(p.N)(a),error:JSON.stringify(r)}),o(l(c.b.InternalServerError))}}function ln(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetAllClientExtensionsNotificationsJsonRequest:#Exchange"},n)),Object(L.a)("GetAllClientExtensionsNotifications",e,t)}function dn(e){const t=(n={ItemId:e},Object.assign({__type:"GetAllClientExtensionsNotificationsRequest:#Exchange"},n));var n;return ln({Header:Object(we.b)(),Body:t})}async function fn(e,t){const n=Object(a.c)(e),o={Id:await n.getItemId()};if(!n.addNotificationMessage)return;Object(m.c)(e).map(e=>n.addNotificationMessage(e,t));const s=await dn(o).catch(pn);if(s){(s.Body.Apps||[]).forEach(o=>{let a=!1;o.Notifications.forEach(i=>{const s={ExtensionId:o.Id,Persistent:!0,Key:i.Key,Type:i.Type,Message:i.Message,Icon:i.Icon};2===i.Type&&(s.Persistent=!1,a=!0);const c=r(e,o.Id,i.Key);Object(m.a)(e,o.Id,c,s),n.addNotificationMessage(c,t)}),a&&Object(i.a)(e,o.Id)})}}function pn(){return null}var mn=n(4829);async function hn(e,t,n){const o=Object(a.c)(e);let s=null;if(!o.addNotificationMessage)return;Object(m.c)(e).map(e=>o.addNotificationMessage(e,t));try{const e=await mn.c.import();s=await e(n,"WebExtNotifications")}catch(e){}if(s){(s.Apps||[]).forEach(n=>{var a;let s=!1;null===(a=null==n?void 0:n.app)||void 0===a||a.Notifications.forEach(i=>{const a={ExtensionId:n.app.Id,Persistent:!0,Key:i.Key,Type:i.Type,Message:i.Message,Icon:i.Icon};2===i.Type&&(a.Persistent=!1,s=!0);const c=r(e,n.app.Id,i.Key);Object(m.a)(e,n.app.Id,c,a),o.addNotificationMessage(c,t)}),s&&Object(i.a)(e,n.app.Id)})}}var gn=n(2272);n.d(t,"c",(function(){return v})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return b.a})),n.d(t,"f",(function(){return m.b})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return C})),n.d(t,"i",(function(){return un})),n.d(t,"j",(function(){return Ct})),n.d(t,"k",(function(){return fn})),n.d(t,"l",(function(){return hn})),n.d(t,"m",(function(){return h})),n.d(t,"b",(function(){return Lt})),n.d(t,"a",(function(){return gn.a}))},525:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return u}));var r=n(300),o=new(n(433).a),i=new WeakMap;function a(e){var t=i.get(e);return t||i.set(e,t={vars:new Set,dep:Object(r.b)()}),t}function s(e){a(e).vars.forEach((function(t){return t.forgetCache(e)}))}function c(e){a(e).vars.forEach((function(t){return t.attachCache(e)}))}function u(e){var t=new Set,n=new Set,r=function(s){if(arguments.length>0){if(e!==s){e=s,t.forEach((function(e){a(e).dep.dirty(r),l(e)}));var c=Array.from(n);n.clear(),c.forEach((function(t){return t(e)}))}}else{var u=o.getValue();u&&(i(u),a(u).dep(r))}return e};r.onNextChange=function(e){return n.add(e),function(){n.delete(e)}};var i=r.attachCache=function(e){return t.add(e),a(e).vars.add(r),r};return r.forgetCache=function(e){return t.delete(e)},r}function l(e){e.broadcastWatches&&e.broadcastWatches()}},526:function(e,t,n){"use strict";var r,o=n(1),i=n(0),a=n(906),s=n(36);!function(e){e[e.Full=0]="Full",e[e.Simple=1]="Simple",e[e.None=2]="None"}(r||(r={}));let c=class extends i.Component{constructor(e){super(e),this.state={}}componentDidCatch(e,t){var n,r;null===(r=(n=this.props).onError)||void 0===r||r.call(n,e,t),this.props.suppressErrorReport||(e.component=!0,e.diagnosticInfo=(e.diagnosticInfo||"")+t.componentStack,Object(s.d)(e)),this.setState({error:e})}render(){const{error:e}=this.state,{children:t,type:n,windowIcons:o}=this.props;if(e){if(n==r.None)return null;if(n==r.Simple||!this.props.fullErrorComponent)return i.createElement("div",null,e);const t=this.props.fullErrorComponent;return i.createElement(t,Object.assign({error:e,windowIcons:o},this.props.fullErrorComponentProps))}return t}};c=Object(o.__decorate)([a.observer],c),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return r}))},5274:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="ImmersiveReaderRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M1 3.5C1 2.67 1.67 2 2.5 2H6c.82 0 1.54.4 2 1 .46-.6 1.18-1 2-1h3.5c.83 0 1.5.67 1.5 1.5v3.7a1.5 1.5 0 00-1-.18V3.5a.5.5 0 00-.5-.5H10c-.83 0-1.5.67-1.5 1.5v3.88L7.88 9H7.5V4.5C7.5 3.67 6.83 3 6 3H2.5a.5.5 0 00-.5.5v9c0 .28.22.5.5.5h3.58c.14.37.41.68.77.85-.27.1-.55.15-.85.15H2.5A1.5 1.5 0 011 12.5v-9zm9.7 4.54c.18.08.3.26.3.46v6a.5.5 0 01-.85.35L8.29 13H7.5a.5.5 0 01-.5-.5v-2c0-.28.22-.5.5-.5h.8l1.85-1.85a.5.5 0 01.54-.11zm3.95.16c.12.16.29.45.44.87.26.68.41 1.5.41 2.43 0 .94-.15 1.75-.4 2.43-.16.42-.33.7-.45.87a.5.5 0 01-.85-.52l.12-.19a5.9 5.9 0 00.58-2.6 5.9 5.9 0 00-.58-2.58l-.07-.11a.5.5 0 11.8-.6zm-1.7 1.08a5.5 5.5 0 01.55 2.22 4.9 4.9 0 01-.55 2.22.5.5 0 11-.9-.44l.08-.17.15-.4c.14-.42.22-.83.22-1.21s-.08-.8-.22-1.22a4.6 4.6 0 00-.23-.56.5.5 0 11.9-.44z"})),displayName:"ImmersiveReaderRegular"});Object(o.registerIcons)({icons:{ImmersiveReaderRegular:r.createElement(a,null)}})},5275:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="FolderMailRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M2 4v6c0 1.1.9 2 2 2h1v-1H4a1 1 0 01-1-1V5.5h2.75a.5.5 0 00.34-.13L7.59 4H12a1 1 0 011 1v2h.5c.17 0 .34.02.5.05V5a2 2 0 00-2-2H7.18l-1.12-.89A.5.5 0 005.75 2H4a2 2 0 00-2 2zm1 0a1 1 0 011-1h1.57l.87.7-.88.8H3V4zm3.01 5.3l4.5 2.63L15 9.5V9.5c0-.83-.67-1.5-1.5-1.5h-6c-.76 0-1.4.57-1.49 1.3zM15 10.64l-4.26 2.3a.5.5 0 01-.5 0L6 10.44v3.05c0 .83.67 1.5 1.5 1.5h6c.83 0 1.5-.67 1.5-1.5v-2.86z"})),displayName:"FolderMailRegular"});Object(o.registerIcons)({icons:{FolderMailRegular:r.createElement(a,null)}})},5296:function(e){e.exports=JSON.parse('{"a":"yna"}')},5307:function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return s}));const r="msip_labels",o="X-MS-Exchange-Organization-ModifySensitivityLabel",i="00000000-0000-0000-0000-000000000000",a="Standard",s="Privileged"},5308:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(38);function o(e){return e===Object(r.a)().SessionSettings.UserEmailAddress}},5309:function(e,t,n){"use strict";var r=n(702);t.a=Object(r.action)("setIsDirty")((function(e,t=!0){e.isDirty=t}))},5320:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.None=-1]="None",e[e.Preset0=0]="Preset0",e[e.Preset1=1]="Preset1",e[e.Preset2=2]="Preset2",e[e.Preset3=3]="Preset3",e[e.Preset4=4]="Preset4",e[e.Preset5=5]="Preset5",e[e.Preset6=6]="Preset6",e[e.Preset7=7]="Preset7",e[e.Preset8=8]="Preset8",e[e.Preset9=9]="Preset9",e[e.Preset10=10]="Preset10",e[e.Preset11=11]="Preset11",e[e.Preset12=12]="Preset12",e[e.Preset13=13]="Preset13",e[e.Preset14=14]="Preset14",e[e.Preset15=15]="Preset15",e[e.Preset16=16]="Preset16",e[e.Preset17=17]="Preset17",e[e.Preset18=18]="Preset18",e[e.Preset19=19]="Preset19",e[e.Preset20=20]="Preset20",e[e.Preset21=21]="Preset21",e[e.Preset22=22]="Preset22",e[e.Preset23=23]="Preset23",e[e.Preset24=24]="Preset24"}(r||(r={}))},5322:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(3343);function o(e,t){const n=Object(r.a)(t);return!!n&&n.get_Id()===e+"ItemSend"}},5366:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(4304);function o(){return typeof globalThis!==r.l&&globalThis?globalThis:typeof self!==r.l&&self?self:typeof window!==r.l&&window?window:typeof e!==r.l&&e?e:null}function i(e){throw new TypeError(e)}function a(e){var t=r.c;if(t)return t(e);if(null==e)return{};var n=typeof e;function o(){}return n!==r.j&&n!==r.h&&i("Object prototype may only be an Object:"+e),o[r.k]=e,new o}}).call(this,n(190))},5367:function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return h}));var r=n(3226),o=n(2285),i=4294967296,a=4294967295,s=!1,c=123456789,u=987654321;function l(e){e<0&&(e>>>=0),c=123456789+e&a,u=987654321-e&a,s=!0}function d(){try{var e=2147483647&Object(o.f)();l((Math.random()*i^e)+e)}catch(e){}}function f(e){return e>0?Math.floor(p()/a*(e+1))>>>0:0}function p(e){var t,n=Object(r.c)()||Object(r.h)();return n&&n.getRandomValues?t=n.getRandomValues(new Uint32Array(1))[0]&a:Object(r.o)()?(s||d(),t=h()&a):t=Math.floor(i*Math.random()|0),e||(t>>>=0),t}function m(e){e?l(e):d()}function h(e){var t=((u=36969*(65535&u)+(u>>16)&a)<<16)+(65535&(c=18e3*(65535&c)+(c>>16)&a))>>>0&a|0;return e||(t>>>=0),t}},5405:function(e){e.exports=JSON.parse('{"a":"hna"}')},5407:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="TranslateRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M11.49 4.1a.5.5 0 10-.98-.2l-.19.95c-.44.02-.87.01-1.29-.02a.5.5 0 10-.07 1c.4.03.8.04 1.21.03-.05.4-.08.78-.1 1.14a3.73 3.73 0 00-1.83 1.67c-.4.8-.36 1.73.2 2.3.38.39.92.43 1.4.32.21-.05.43-.13.65-.24l.04.12a.5.5 0 10.94-.35l-.12-.37a5.13 5.13 0 001.56-2.91c.1.03.2.06.28.1.44.19.7.52.81.91.2.77-.22 1.92-1.68 2.48a.5.5 0 10.36.94c1.83-.7 2.65-2.31 2.29-3.68a2.36 2.36 0 00-1.38-1.57 2.91 2.91 0 00-.6-.19V6.5a.5.5 0 00-1-.02c-.28.02-.58.07-.9.15l.1-.83c.66-.07 1.32-.17 1.92-.31a.5.5 0 00-.23-.98c-.48.12-1 .2-1.53.26l.14-.67zM9.13 9.11c.16-.32.45-.66.91-.96.01.75.08 1.38.18 1.9-.22.14-.42.23-.6.27-.3.06-.43 0-.47-.05-.17-.18-.29-.6-.02-1.16zM11.9 7.5c-.15.7-.44 1.29-.79 1.74a11.6 11.6 0 01-.07-1.55 5.31 5.31 0 01.86-.2z"}),r.createElement("path",{d:"M5.5 4.8a3.7 3.7 0 00-2.73.25l-.01.01h-.01a.5.5 0 00.5.88.93.93 0 01.13-.07 2.77 2.77 0 011.83-.11c.4.11.58.34.67.6.08.23.1.48.11.76-.19-.04-.41-.07-.65-.1a3.9 3.9 0 00-2.37.35c-1.46.9-1.25 3.18.46 3.7.76.24 1.5.06 2.07-.19.17-.07.34-.15.5-.24V11a.5.5 0 101 0V7.44c0-.38 0-.92-.17-1.4A1.9 1.9 0 005.49 4.8zM6 8.14v1.34a5.9 5.9 0 01-.9.48c-.46.2-.94.3-1.38.16-.84-.26-.98-1.43-.23-1.9.4-.24 1.07-.28 1.74-.2.3.03.57.08.77.12z"})),displayName:"TranslateRegular"});Object(o.registerIcons)({icons:{TranslateRegular:r.createElement(a,null)}})},5425:function(e){e.exports=JSON.parse('{"a":"Mpa"}')},5426:function(e){e.exports=JSON.parse('{"popoutsOpenInNewWindow":"nna"}')},5427:function(e){e.exports=JSON.parse('{"a":"ena"}')},5439:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));const r=(e=!1,t=!1,n=0)=>({shouldEncryptMessageAsSmime:e,shouldSignMessageAsSmime:t,signingCertRawData:null,errorCode:n,errorContext:0,smimeBccForkingMode:0,currentBccRecipientIndex:-1});function o(e){switch(e){case 6:return r(!0,!1);case 10:case 11:return r(!1,!0);case 12:case 13:case 14:return r(!0,!0);case-1:case 0:default:return r()}}},5440:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(20);const o=new r.c(()=>n.e(801).then(n.bind(null,9020))),i=Object(r.d)(o,e=>e.HipCheckModal)},5441:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.recipients)?e.recipients.length:0}n.d(t,"a",(function(){return r}))},5596:function(e,t,n){"use strict";var r=n(20),o=n(2132),i=n(4195),a=n(47);function s(){return Object(a.j)("honeybee-sonora")&&Object(a.j)("honeybee-sonora-mentions-plugin")&&Object(i.a)()}function c(){return Object(a.j)("honeybee-sonora")&&Object(a.j)("honeybee-sonora-mentions-plugin-calendar")&&Object(i.a)()}n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));const u=new r.c(()=>Promise.all([n.e(4),n.e(9),n.e(14),n.e(16),n.e(316)]).then(n.bind(null,19499))),l=Object(o.a)(u,e=>e.SonoraMentionsPlugin,"SonoraMentions",e=>11==e.eventType)},563:function(e,t,n){"use strict";var r,o;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(r||(r={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(o||(o={}))},5635:function(e){e.exports=JSON.parse('{"showFrom":"ina"}')},5636:function(e){e.exports=JSON.parse('{"switchToPlainTextMenuItem":"fna"}')},564:function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var r=n(20),o=n(916);n.d(t,"a",(function(){return o.a}));const i=new r.c(()=>Promise.all([n.e(1),n.e(2),n.e(3),n.e(4),n.e(534)]).then(n.bind(null,1566)));let a=new r.b(i,e=>e.confirmAction);function s(e,t,n,r){return a.import().then(o=>o(e,t,n,r))}},5642:function(e){e.exports=JSON.parse('{"a":"Cpa"}')},565:function(e,t,n){"use strict";var r=n(347),o=n(252),i="[object AsyncFunction]",a="[object Function]",s="[object GeneratorFunction]",c="[object Proxy]";t.a=function(e){if(!Object(o.a)(e))return!1;var t=Object(r.a)(e);return t==a||t==s||t==i||t==c}},5658:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(47),o=n(5596);function i(e){return Object(o.b)()?e.sonoraMentions:Object(r.j)("mc-editor-oa")?e.oa:e.mentionsPicker}},5659:function(e,t,n){"use strict";function r(e){let t=[];return e.toRecipientWell&&t.push(e.toRecipientWell),e.ccRecipientWell&&t.push(e.ccRecipientWell),e.bccRecipientWell&&t.push(e.bccRecipientWell),t}n.d(t,"a",(function(){return r}))},566:function(e,t,n){"use strict";var r=n(719),o=n(942),i=n(402);t.a=function(e){return Object(i.a)(e)?Object(r.a)(e):Object(o.a)(e)}},567:function(e,t,n){"use strict";var r=n(721);n.o(r,"ApolloClient")&&n.d(t,"ApolloClient",(function(){return r.ApolloClient})),n.o(r,"ApolloLink")&&n.d(t,"ApolloLink",(function(){return r.ApolloLink})),n.o(r,"ApolloProvider")&&n.d(t,"ApolloProvider",(function(){return r.ApolloProvider})),n.o(r,"InMemoryCache")&&n.d(t,"InMemoryCache",(function(){return r.InMemoryCache})),n.o(r,"Observable")&&n.d(t,"Observable",(function(){return r.Observable})),n.o(r,"execute")&&n.d(t,"execute",(function(){return r.execute})),n.o(r,"gql")&&n.d(t,"gql",(function(){return r.gql})),n.o(r,"isApolloError")&&n.d(t,"isApolloError",(function(){return r.isApolloError})),n.o(r,"makeVar")&&n.d(t,"makeVar",(function(){return r.makeVar})),n.o(r,"useApolloClient")&&n.d(t,"useApolloClient",(function(){return r.useApolloClient})),n.o(r,"useLazyQuery")&&n.d(t,"useLazyQuery",(function(){return r.useLazyQuery})),n.o(r,"useMutation")&&n.d(t,"useMutation",(function(){return r.useMutation})),n.o(r,"useQuery")&&n.d(t,"useQuery",(function(){return r.useQuery}));var o=n(997);n.o(o,"ApolloClient")&&n.d(t,"ApolloClient",(function(){return o.ApolloClient})),n.o(o,"ApolloLink")&&n.d(t,"ApolloLink",(function(){return o.ApolloLink})),n.o(o,"ApolloProvider")&&n.d(t,"ApolloProvider",(function(){return o.ApolloProvider})),n.o(o,"InMemoryCache")&&n.d(t,"InMemoryCache",(function(){return o.InMemoryCache})),n.o(o,"Observable")&&n.d(t,"Observable",(function(){return o.Observable})),n.o(o,"execute")&&n.d(t,"execute",(function(){return o.execute})),n.o(o,"gql")&&n.d(t,"gql",(function(){return o.gql})),n.o(o,"isApolloError")&&n.d(t,"isApolloError",(function(){return o.isApolloError})),n.o(o,"makeVar")&&n.d(t,"makeVar",(function(){return o.makeVar})),n.o(o,"useApolloClient")&&n.d(t,"useApolloClient",(function(){return o.useApolloClient})),n.o(o,"useLazyQuery")&&n.d(t,"useLazyQuery",(function(){return o.useLazyQuery})),n.o(o,"useMutation")&&n.d(t,"useMutation",(function(){return o.useMutation})),n.o(o,"useQuery")&&n.d(t,"useQuery",(function(){return o.useQuery}))},568:function(e,t,n){"use strict";t.a=function(e){return e}},569:function(e,t,n){"use strict";var r=n(993);n.d(t,"execute",(function(){return r.a}));var o=n(724);n.d(t,"ApolloLink",(function(){return o.a}));var i=n(996);n.o(i,"ApolloProvider")&&n.d(t,"ApolloProvider",(function(){return i.ApolloProvider})),n.o(i,"useApolloClient")&&n.d(t,"useApolloClient",(function(){return i.useApolloClient})),n.o(i,"useLazyQuery")&&n.d(t,"useLazyQuery",(function(){return i.useLazyQuery})),n.o(i,"useMutation")&&n.d(t,"useMutation",(function(){return i.useMutation})),n.o(i,"useQuery")&&n.d(t,"useQuery",(function(){return i.useQuery}))},570:function(e,t,n){"use strict";var r=9007199254740991;t.a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},572:function(e,t,n){"use strict";var r=n(1),o=n(1309),i=new Map,a=new Map,s=!1;function c(e){return e.replace(/[\s,]+/g," ").trim()}function u(e){var t=new Set,n=[];return e.definitions.forEach((function(e){if("FragmentDefinition"===e.kind){var r=e.name.value,o=c((s=e.loc).source.body.substring(s.start,s.end)),i=a.get(r);i&&!i.has(o)||i||a.set(r,i=new Set),i.add(o),t.has(o)||(t.add(o),n.push(e))}else n.push(e);var s})),Object(r.__assign)(Object(r.__assign)({},e),{definitions:n})}function l(e){var t=c(e);if(!i.has(t)){var n=Object(o.a)(e,{experimentalFragmentVariables:s});if(!n||"Document"!==n.kind)throw new Error("Not a valid GraphQL document.");i.set(t,function(e){var t=new Set(e.definitions);t.forEach((function(e){e.loc&&delete e.loc,Object.keys(e).forEach((function(n){var r=e[n];r&&"object"==typeof r&&t.add(r)}))}));var n=e.loc;return n&&(delete n.startToken,delete n.endToken),e}(u(n)))}return i.get(t)}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];"string"==typeof e&&(e=[e]);var r=e[0];return t.forEach((function(t,n){t&&"Document"===t.kind?r+=t.loc.source.body:r+=t,r+=e[n+1]})),l(r)}var f,p={gql:d,resetCaches:function(){i.clear(),a.clear()},disableFragmentWarnings:function(){!1},enableExperimentalFragmentVariables:function(){s=!0},disableExperimentalFragmentVariables:function(){s=!1}};(f=d||(d={})).gql=p.gql,f.resetCaches=p.resetCaches,f.disableFragmentWarnings=p.disableFragmentWarnings,f.enableExperimentalFragmentVariables=p.enableExperimentalFragmentVariables,f.disableExperimentalFragmentVariables=p.disableExperimentalFragmentVariables,d.default=d,t.a=d},573:function(e,t,n){"use strict";var r=Object.prototype;t.a=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},574:function(e,t,n){"use strict";var r=n(347),o=n(570),i=n(306),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var s=function(e){return Object(i.a)(e)&&Object(o.a)(e.length)&&!!a[Object(r.a)(e)]},c=n(930),u=n(812),l=u.a&&u.a.isTypedArray,d=l?Object(c.a)(l):s;t.a=d},575:function(e,t,n){"use strict";var r=n(578);t.a=function(e,t,n){"__proto__"==t&&r.a?Object(r.a)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},5767:function(e,t,n){"use strict";var r=n(296);function o(){return!Object(r.a)()}function i(){return!Object(r.a)()}n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}))},577:function(e,t,n){"use strict";var r=9007199254740991,o=/^(?:0|[1-9]\d*)$/;t.a=function(e,t){var n=typeof e;return!!(t=null==t?r:t)&&("number"==n||"symbol"!=n&&o.test(e))&&e>-1&&e%1==0&&e<t}},5772:function(e,t,n){"use strict";var r=n(4682),o=n(5307),i=function(e){switch(e.labelApplyMethod){case r.a.Manual:return o.d;case r.a.Default:case r.a.Automatic:default:return o.e}},a=n(1873),s=n(467),c=n(38),u=n(7),l=n(4340);n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));const d="MSIP_Label";function f(e,t){let{selectedCLPLabel:n,nonTenantLabelString:r}=e;const i=m(e);if(i&&h(o.b,i,t),!n&&!r)return;const a=p(e);h(o.c,a,t),Object(l.c)(n)}function p(e){let{selectedCLPLabel:t,nonTenantLabelString:n}=e;const r=Object(c.a)().SessionSettings.ExternalDirectoryTenantGuid;let o="";if(t){o=function(e,t){let n="";return n=Object.keys(e).map(n=>`${d}_${t.id}_${n}=${e[n]};`).join(""),n}({Enabled:"True",SiteId:r,SetDate:Object(u.vb)(Object(u.Ub)()),Name:t.displayName,ContentBits:0,Method:i(e)},t)}return n?n+o:o}function m(e){let{selectedCLPLabel:t,originalCLPLabel:n}=e;if(!t&&!n)return;let r=t&&!n&&t.isDefault;return`${n&&!r?n.id:o.a};${t?t.id:o.a}`}function h(e,t,n){const r=Object(a.a)({ExtendedFieldURI:Object(s.a)({PropertyName:e,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:t});n.ExtendedProperty?n.ExtendedProperty.push(r):n.ExtendedProperty=[r]}},5773:function(e,t,n){"use strict";var r=n(16),o=n(7),i=n(5308),a=n(38),s=n(5772),c=n(282);var u=n(5658);function l(e,t,n){var i,a,l,p,v;const y=t?function(e){switch(e){case 0:return"New";case 1:return"Reply";case 2:return"ReplyAll";case 3:return"Forward";case 4:return"EditDraft";case 5:case 6:return Object(c.a)(e)}}(t.operation):function(e){switch(e.__type){case"ReplyToItem:#Exchange":return"Reply";case"ReplyAllToItem:#Exchange":return"ReplyAll";case"ForwardItem:#Exchange":return"Forward";case"Message:#Exchange":default:return"New"}}(e),b={ToRecipients:null!==(i=e.ToRecipients)&&void 0!==i?i:[],CcRecipients:null!==(a=e.CcRecipients)&&void 0!==a?a:[],BccRecipients:null!==(l=e.BccRecipients)&&void 0!==l?l:[],Subject:null!==(p=e.Subject)&&void 0!==p?p:"",Body:e.Body?{Value:e.Body.Value,DataUriCount:e.Body.DataUriCount,BodyType:e.Body.BodyType}:void 0,NewBodyContent:e.NewBodyContent?{Value:e.NewBodyContent.Value,DataUriCount:e.NewBodyContent.DataUriCount,BodyType:e.NewBodyContent.BodyType}:void 0,Importance:null!==(v=e.Importance)&&void 0!==v?v:"Normal",IsReadReceiptRequested:!!e.IsReadReceiptRequested,IsDeliveryReceiptRequested:!!e.IsDeliveryReceiptRequested,UpdateResponseItemId:e.UpdateResponseItemId,ReferenceItemId:e.ReferenceItemId,ReferenceItemDocumentId:e.ReferenceItemDocumentId,operation:y,replyTargetMailboxInfo:null!=n?n:void 0};if(t){const n=Object(u.a)(t);return Object.assign(Object.assign({},b),{atMentionedRecipients:d(n),recipientsAddedViaAtMention:n.mentionsAddedRecipients?Object(r.toJS)(n.mentionsAddedRecipients):void 0,connectedAccountSharingGuid:f(t),deferredSendTime:t.deferredSendTime?Object(o.vb)(t.deferredSendTime):void 0,clpLabelModifificationHeader:Object(s.a)(t.protectionViewState.clpViewState),clpLabelProperty:Object(s.b)(t.protectionViewState.clpViewState),messageClassification:m(t),originalSmtpFromAddress:h(t),sendAs:g(t),internetHeaders:t.addin.internetHeaders?(O=t.addin.internetHeaders,[...O.keys()].map(e=>({headerName:e,headerValue:O.get(e)}))):void 0,internetHeadersToRemove:t.addin.keysOfInternetHeadersToBeRemoved,appendOnSend:t.addin.appendOnSend,draftComposeType:t.addin.draftComposeType,DocLinks:e.DocLinks,isReportedFalsePositive:t.policyTipsViewState.isReportedFalsePositive,isOverridden:t.policyTipsViewState.isOverridden,overrideJustification:t.policyTipsViewState.overrideJustification})}return b;var O}function d(e){const{atMentionTuples:t}=e;return t?Object.keys(t).map(e=>{return{key:e,emailAddress:t[e].EmailAddress}}):[]}function f(e){var t,n,r;const o=null===(r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(o){const e=p(o);return null==e?void 0:e.SubscriptionGuid}}function p(e){const t=Object(a.a)().SessionSettings.ConnectedAccountInfos;if(t)for(let n=0;n<t.length;n++){const r=t[n];if(r.EmailAddress==e)return r}}function m(e){const t=e.protectionViewState.classificationViewState;return t.messageClassification?Object.assign(Object.assign({},t.messageClassification),{isClassified:!0}):void 0}function h(e){var t,n,r;const o=null===(r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(o&&!Object(i.a)(o))return o}function g(e){var t,n;const r=null===(n=null===(t=e.fromViewState)||void 0===t?void 0:t.from)||void 0===n?void 0:n.email;if(r){const e=p(r.EmailAddress);return e?{MailboxType:r.MailboxType,RoutingType:"SMTP",EmailAddress:r.EmailAddress,Name:e.DisplayName}:r}}n.d(t,"a",(function(){return l}))},578:function(e,t,n){"use strict";var r=n(328),o=function(){try{var e=Object(r.a)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.a=o},581:function(e,t,n){"use strict";var r=n(247).a.Uint8Array;t.a=r},5811:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="PersonProhibitedRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M10.5 15a4.5 4.5 0 110-9 4.5 4.5 0 010 9zm-2.8-2.4l4.9-4.9a3.5 3.5 0 00-4.9 4.9zm.7.7a3.5 3.5 0 004.9-4.9l-4.9 4.9zm-2.18.66C3.55 13.66 2 11.8 2 10v-.5C2 8.67 2.67 8 3.5 8h2.1c-.16.32-.3.65-.4 1H3.5a.5.5 0 00-.5.5v.5c0 1.13.88 2.33 2.5 2.8.2.42.44.8.72 1.16zm3.4-8.9a2.75 2.75 0 10-3.3 1.86c.32-.37.68-.7 1.08-.97a1.76 1.76 0 01-2.15-1.7 1.75 1.75 0 113 1.23c.43-.2.89-.33 1.38-.41z"})),displayName:"PersonProhibitedRegular"});Object(o.registerIcons)({icons:{PersonProhibitedRegular:r.createElement(a,null)}})},5859:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="EmojiRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M6.25 7.75a.75.75 0 100-1.5.75.75 0 000 1.5z"}),r.createElement("path",{d:"M6.14 9.67a.5.5 0 10-.75.66 3.5 3.5 0 005.22 0 .5.5 0 00-.75-.66 2.5 2.5 0 01-3.72 0z"}),r.createElement("path",{d:"M10.5 7A.75.75 0 119 7a.75.75 0 011.5 0z"}),r.createElement("path",{d:"M14 8A6 6 0 102 8a6 6 0 0012 0zM3 8a5 5 0 1110 0A5 5 0 013 8z"})),displayName:"EmojiRegular"});Object(o.registerIcons)({icons:{EmojiRegular:r.createElement(a,null)}})},586:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(25),o=n(68);function i(e,t){var n=t,i=[];return e.definitions.forEach((function(e){if("OperationDefinition"===e.kind)throw new o.a(42);"FragmentDefinition"===e.kind&&i.push(e)})),void 0===n&&(Object(o.b)(1===i.length,43),n=i[0].name.value),Object(r.a)(Object(r.a)({},e),{definitions:Object(r.f)([{kind:"OperationDefinition",operation:"query",selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:n}}]}}],e.definitions)})}function a(e){void 0===e&&(e=[]);var t={};return e.forEach((function(e){t[e.name.value]=e})),t}function s(e,t){switch(e.kind){case"InlineFragment":return e;case"FragmentSpread":var n=t&&t[e.name.value];return Object(o.b)(n,44),n;default:return null}}},5861:function(e){e.exports=JSON.parse('{"setImportance":"jna"}')},5862:function(e){e.exports=JSON.parse('{"showMessageOptions":"gna"}')},5864:function(e){e.exports=JSON.parse('{"a":"Gpa","b":"Hpa"}')},5865:function(e){e.exports=JSON.parse('{"a":"mna"}')},5866:function(e){e.exports=JSON.parse('{"a":"kna"}')},5867:function(e,t,n){"use strict";var r=n(0),o=n(8),i=n(325);t.a="ClipboardArrowRightRegular";const a=Object(i.a)({Svg:e=>r.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),r.createElement("path",{d:"M5.09 2c.2-.58.76-1 1.41-1h3c.65 0 1.2.42 1.41 1h.59c.83 0 1.5.67 1.5 1.5v2.1c-.32-.16-.65-.3-1-.4V3.5a.5.5 0 00-.5-.5h-.59c-.2.58-.76 1-1.41 1h-3a1.5 1.5 0 01-1.41-1H4.5a.5.5 0 00-.5.5v10c0 .28.22.5.5.5h1.76c.31.38.67.72 1.08 1H4.5A1.5 1.5 0 013 13.5v-10C3 2.67 3.67 2 4.5 2h.59zM6.5 2a.5.5 0 000 1h3a.5.5 0 000-1h-3zm8.5 8.5a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm-2.15.35a.5.5 0 00.15-.35.5.5 0 00-.15-.35l-2-2a.5.5 0 00-.7.7L11.29 10H8.5a.5.5 0 000 1h2.8l-1.15 1.15a.5.5 0 00.7.7l2-2z"})),displayName:"ClipboardArrowRightRegular"});Object(o.registerIcons)({icons:{ClipboardArrowRightRegular:r.createElement(a,null)}})},5886:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(47),o=n(467);function i(e){var t;Object(r.j)("cmp-clp")&&(null===(t=e.AdditionalProperties)||void 0===t||t.push(Object(o.a)({PropertyName:"msip_labels",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})))}},5893:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1692);function o(e){var t,n;if(e){const o=r.u.items.get(null===(t=e.referenceItemId)||void 0===t?void 0:t.Id);if(o){const e=null===(n=null==o?void 0:o.stampedLanguage)||void 0===n?void 0:n.language;return e||""}}return""}},5894:function(e,t,n){"use strict";function r(e,t){if(e){const t=e.split("=");if(e.indexOf("500")>=0)return"error500";if(e.indexOf("503")>=0)return"error503";if(e.indexOf("Failed to fetch")>=0)return"errorFailedToFetch";t.length>1&&(e=t[1])}switch(e){case"ErrorSessionTimeout":return"errorSessionTimeout";case"ErrorMailboxStoreUnavaiable":return"errorMailboxStoreUnavailable";case"ErrorSendAsDenied":return"errorMessageNoPermissionToSendAs";case"ErrorRightsManagementPermanentException":return null;case"ErrorSubmissionQuotaExceeded":return"errorMessageSubmissionQuotaExceededMessageCanNotBeSent";case"ErrorAccountSuspend":return"errorMessageAccountSuspend";case"ErrorExceededMaxRecipientLimit":return"errorMessageExceededMaxRecipientLimit";case"ErrorExceededMessageLimit":return"errorMessageExceededMessageLimit";case"ErrorExceededHourlyMessageLimit":return"errorMessageExceededHourlyMessageLimit";case"ErrorMessageBlocked":return"errorMessageMessageBlocked";case"ErrorMessageSubmissionBlocked":return"errorMessageMessageSubmissionBlocked";case"ErrorAccountSuspendShowTierUpgrade":return"errorMessageAccountSuspendShowTierUpgrade";case"ErrorExceededMaxRecipientLimitShowTierUpgrade":return"errorMessageExceededMaxRecipientLimitShowTierUpgrade";case"ErrorExceededMessageLimitShowTierUpgrade":return"errorMessageExceededMessageLimitShowTierUpgrade";case"ErrorMessageTimeout":return"errorMessageTimeout";case"ErrorMessageThrottled":return"errorMessageThrottled";case"ErrorMessageTransientError":return"errorMessageTransientError";case"ErrorItemNotFound":return t?"errorMessageItemNoLongerExistToSend":"errorMessageItemNoLongerExistToSave";case"ErrorAccessDenied":return"warningMessageNoPermissionToPerformAction";case"SmimeEncodeError":return"smimeEncodeError";case"ErrorQuotaExceeded":return t?"errorMessageQuotaExceededMessageCanNotBeSent":"errorMessageQuotaExceededMessageCanNotBeSaved";default:return t?"errorMessageMessageCanNotBeSent":"errorMessageMessageCanNotBeSaved"}}n.d(t,"a",(function(){return r}))},5895:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(905);function o(e){return e?Object(r.a)({Id:e.Id,ChangeKey:e.ChangeKey}):null}},5896:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1873),o=n(467),i=n(2197),a=n(2404);function s(e){return Object(a.a)({Path:Object(o.a)(e.ExtendedFieldURI),Item:Object(i.a)({ExtendedProperty:[Object(r.a)(e)]})})}},5929:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(1797),o=n(7009),i=n(3);let a=l();function s(){return a}function c(e){a=e}function u(){a=l()}function l(){return{hostItemIndex:null,mode:r.a.Unknown}}Object(i.orchestrator)(o.b,u)},5979:function(e,t,n){"use strict";var r=n(5895),o=n(2662),i=n(4292),a=n(4555),s=n(5439),c=n(6305);const u=new RegExp("<img[^>]*\\s+src=[\"']data:image\\/[^<]+;base64,\\s*[a-zA-Z0-9+\\/=&#;]+[\"'][^>]*>","gi");function l(e){let t=0;if(e){const n=e.match(u);t=n?n.length:0}return t}const d=new RegExp('<IMG[^>]+?ORIGINALSRC\\s*=\\s*"[\\s\\S]+?"[\\s\\S]*?>',"gim"),f=new RegExp('\\sSRC\\s*=\\s*"DATA:[\\s\\S]+?"',"im"),p=new RegExp('\\sORIGINALSRC\\s*=\\s*"',"im");function m(e,t){return e?e.replace(d,(function(e){return e=e.replace(f,""),t&&(e=e.replace(p,' src="')),e})):e}var h=n(38),g=n(3971),v=n(1873),y=n(467);const b=35356;var O=n(7);const S="0x3FEF";function C(e,t){if(t.ExtendedProperty){let n=e.length;for(;n--&&t.ExtendedProperty.length>0;){let r=t.ExtendedProperty.length;for(;r--;)if(e[n]===t.ExtendedProperty[r].ExtendedFieldURI.PropertyName){t.ExtendedProperty.splice(r,1);break}}}}function A(e,t,n){var r,o;n?C(["AppendOnSend"],t):e.appendOnSend&&e.appendOnSend.length>0&&(r=e.appendOnSend,(o=t).ExtendedProperty||(o.ExtendedProperty=[]),o.ExtendedProperty.push(Object(v.a)({Value:JSON.stringify(r),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"AppendOnSend",PropertyType:"String"})})))}function _(e,t){e.internetHeaders.size>0&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);for(const n of e.keys())t.ExtendedProperty.push(Object(v.a)({Value:e.get(n),ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"InternetHeaders",PropertyName:n,PropertyType:"String"})}))}(e.internetHeaders,t),e.keysOfInternetHeadersToBeRemoved.length>0&&C(e.keysOfInternetHeadersToBeRemoved,t)}function I(e,t,n){n?C(["ComposeType"],t):null!==e.draftComposeType&&function(e,t){t.ExtendedProperty||(t.ExtendedProperty=[]);t.ExtendedProperty.push(Object(v.a)({Value:e,ExtendedFieldURI:Object(y.a)({DistinguishedPropertySetId:"Common",PropertyName:"ComposeType",PropertyType:"String"})}))}(e.draftComposeType,t)}var x=n(3839),E=n(6306),T=n(3),w=Object(T.mutatorAction)("clearKeysOfInternetHeadersToBeRemoved",e=>{e.keysOfInternetHeadersToBeRemoved=[]}),M=n(905),k=n(702);function j(e){e&&(e.isDirty=!1)}var P=Object(k.action)("updateComposeItemId")((function(e,t,n,r){e&&(e.itemId?e.itemId.ChangeKey=n:e.itemId=Object(M.a)({Id:t,ChangeKey:n}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,j(e.toRecipientWell),j(e.ccRecipientWell),j(e.bccRecipientWell)))})),R=n(3140),N=n(5133),D=n(2108),F=n(47),L=n(1679),U=n(2263),B=n(5134),H=n(6),V=n(5772),z=n(3765),W=n(1747),G=n(4320);var q=n(5998),K=n(6578),X=n(1735),Q=n(707);var J=n(1701),Y=n(35);function Z(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"PostGroupItemJsonRequest:#Exchange"},n)),Object(Y.a)("PostGroupItem",e,t)}var $=n(261),ee=n(2499);function te(e,t,n,r,o,i){const a=(s=Object.assign({ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:"SendAndSaveCopy",Items:[t],TimeFormat:r,ItemShape:Object(Q.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(J.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ee.a)()),Object.assign({__type:"PostGroupItemRequest:#Exchange"},s));var s;return i&&(a.ItemShape.ReturnOnlyInternetMessageId=!0),(null==o?void 0:o.IsOwner)&&(a.ComplianceId=o.RmsTemplateId?o.RmsTemplateId.toUpperCase():"0"),a}function ne(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"PostUnifiedGroupItemJsonRequest:#Exchange"},n)),Object(Y.a)("PostUnifiedGroupItem",e,t)}function re(e,t,n,r,o){const i=(a={ModernGroupEmailAddress:{EmailAddress:e,MailboxType:"GroupMailbox"},SkipGroupSyncDelivery:!0,ClientSupportsIrm:!0,Item:t,ItemShape:Object(Q.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(J.a)({FieldURI:"ItemLastModifiedTime"})]})},Object.assign({__type:"PostUnifiedGroupItemRequest:#Exchange"},a));var a;return o&&(i.ItemShape.ReturnOnlyInternetMessageId=!0),i}var oe=n(5896),ie=n(4793),ae=n(2926);function se(e,t){return Object(ae.a)({Path:Object(y.a)({DistinguishedPropertySetId:e,PropertyName:t,PropertyType:"String"})})}var ce=n(2405),ue=n(3087),le=n(3072);function de(e,t,n,r){const o=function(e,t,n,r){var o;const i=[];e.MimeContent&&i.push(Object(ie.a)("MimeContent",e.MimeContent));const a=[Object(ie.a)("ToRecipients",e.ToRecipients),Object(ie.a)("CcRecipients",e.CcRecipients),Object(ie.a)("BccRecipients",e.BccRecipients),Object(ie.a)("Subject",e.Subject),Object(ie.a)("Body",e.Body),Object(ie.a)("Importance",e.Importance),Object(ie.a)("IsReadReceiptRequested",e.IsReadReceiptRequested),Object(ie.a)("IsDeliveryReceiptRequested",e.IsDeliveryReceiptRequested)];(null===(o=e.Attachments)||void 0===o?void 0:o.length)&&a.push(Object(ie.a)("Attachments",e.Attachments)),e.ItemClass&&a.push(Object(ie.a)("ItemClass",e.ItemClass)),e.From&&a.push(Object(ie.a)("From",e.From)),r.length>0&&r.map(e=>{a.push(se("InternetHeaders",e))}),t&&a.push(se("Common","AppendOnSend")),e.MentionsEx&&a.push(Object(ie.a)("MentionsEx",e.MentionsEx)),e.PendingSocialActivityTagIds&&a.push(Object(ie.a)("PendingSocialActivityTagIds",e.PendingSocialActivityTagIds)),e.Sensitivity&&a.push(Object(ie.a)("Sensitivity",e.Sensitivity)),e.ExtendedProperty&&e.ExtendedProperty.map(e=>{a.push(Object(oe.a)(e))}),t&&e.DocLinks&&e.DocLinks.length>0&&a.push(Object(ie.a)("DocLinks",e.DocLinks));const s=Object(ce.a)({Updates:[...i,...a],ItemId:Object(M.a)({Id:e.ItemId.Id,ChangeKey:e.ItemId.ChangeKey})}),c=Object(ue.a)(Object.assign({ItemChanges:[s],ConflictResolution:"AlwaysOverwrite",ClientSupportsIrm:!0,SendCalendarInvitationsOrCancellations:"SendToNone",MessageDisposition:t?"SendAndSaveCopy":"SaveOnly",SuppressReadReceipts:!1,ComposeOperation:"newMail",PromoteInlineAttachments:!1,SendOnNotFoundError:!0,ItemShape:Object(Q.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(J.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(ee.a)()));return(null==n?void 0:n.IsOwner)&&(c.ComplianceId=n.RmsTemplateId?n.RmsTemplateId.toUpperCase():"0"),c}(e,t,n,r);return Object(le.a)({Header:Object($.b)(),Body:o}).then(e=>e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout")))}var fe=n(1890),pe=n(1693);const me="InternetHeaders",he="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification",ge="X-Ms-Exchange-Organization-Dlp-FalsePositive";var ve=n(2519);function ye(e){if(!e)return null;const{IRMData:t}=e;return!t||t.RmsTemplateId&&!ve.b.rmsTemplates.get(t.RmsTemplateId)?null:t}function be(e){return Object.assign({__type:"ApproveRequestItem:#Exchange"},e)}var Oe=n(1989),Se=n(2197);function Ce(e){return Object.assign({__type:"RejectRequestItem:#Exchange"},e)}var Ae=n(6308),_e=n(6309),Ie=n(296),xe=n(3766),Ee=n(2906),Te=n(2637),we=n(20);const Me=new we.c(()=>n.e(1940).then(n.bind(null,19933))),ke=new we.b(Me,e=>e.loadAtMentionsData);var je=n(5658),Pe=n(5308);const Re="X-MS-Exchange-Organization-ClientSubmitSmtp-OriginalFrom";var Ne=n(2793),De=n(6601);const Fe={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SaveDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}},{kind:"ObjectField",name:{kind:"Name",value:"requestIMIOnly"},value:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]},Le={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SaveSmartReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"saveSmartReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}},{kind:"ObjectField",name:{kind:"Name",value:"requestIMIOnly"},value:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]},Ue={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SendDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}},{kind:"ObjectField",name:{kind:"Name",value:"requestIMIOnly"},value:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]},Be={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"SendSmartReply"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itemId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ItemId"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendSmartReply"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"itemId"},value:{kind:"Variable",name:{kind:"Name",value:"itemId"}}},{kind:"ObjectField",name:{kind:"Name",value:"requestIMIOnly"},value:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]};var He=n(705),Ve=n(5773);function ze(e,t){return e?t?Be:Ue:t?Le:Fe}var We=n(704),Ge=n(3124),qe=n(71);n.d(t,"c",(function(){return $e})),n.d(t,"b",(function(){return et})),n.d(t,"a",(function(){return tt}));const Ke='<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" style="display:none;"> P {{margin-top:0;margin-bottom:0;}} </style></head><body dir="{0}">{1}</body></html>',Xe="IPM.Note";function Qe(e){let t=e.content,n=0;if("HTML"==e.bodyType){const r=nt(e);t=m(t),n=l(t),t=Object(H.c)(Ke,r,t)}const r=Object(Oe.a)({BodyType:e.bodyType,Value:t});let o;r.DataUriCount=n;const i={Subject:e.subject||"",Importance:e.importance,Sensitivity:e.sensitivity};var a;return a=Object.assign(Object.assign({},i),{Body:r}),o=Object.assign({__type:"PostItem:#Exchange"},a),e.itemId&&(o.ItemId=e.itemId),e.fromViewState&&function(e,t){const n=e.from;t.From=Object(g.a)({Mailbox:n.email})}(e.fromViewState,o),o}const Je=async e=>{if(Object(Ee.a)(e.smimeViewState))return null;const t=(await D.h.import())(e.attachmentWell,e.content,e.bodyType,!0);return(null==t?void 0:t.length)?(await Ne.i.import())(t):null};function Ye(e,t){let n=e.content,o=0;const i=Object(Ee.a)(e.smimeViewState);if(e.useSmartResponse&&(n+=Object(N.a)(e.bodyType)),"HTML"==e.bodyType){const t=nt(e);n=m(n,i),o=l(n),n=Object(H.c)(Ke,t,n),Object(qe.o)("SentMessageBodySize",{bodySize:e.content.length})}const s=Object(Oe.a)({BodyType:e.bodyType,Value:n});s.DataUriCount=o;const c=Object(r.a)(e.itemId),u=Object(r.a)(e.referenceItemId);let d,f=[],p=[],C=[];if(e.smimeViewState&&0!=e.smimeViewState.smimeBccForkingMode){const{smimeBccForkingMode:t}=e.smimeViewState;switch(t){case 1:f=Object(a.a)(e.toRecipientWell),p=Object(a.a)(e.ccRecipientWell);break;case 2:if(e.bccRecipientWell){const t=e.smimeViewState.currentBccRecipientIndex;C=[Object(a.a)(e.bccRecipientWell)[t]]}break;case 3:e.bccRecipientWell&&(C=Object(a.a)(e.bccRecipientWell))}}else f=Object(a.a)(e.toRecipientWell),p=Object(a.a)(e.ccRecipientWell),C=Object(a.a)(e.bccRecipientWell);const A={Subject:e.subject||"",Importance:e.importance,IsReadReceiptRequested:e.isReadReceiptRequested,IsDeliveryReceiptRequested:e.isDeliveryReceiptRequested,ToRecipients:f,CcRecipients:p,BccRecipients:C,Sensitivity:e.sensitivity};let _;return e.useSmartResponse?(_=2==e.operation?Ae.a:_e.a,d=_(Object.assign(Object.assign({},A),{UpdateResponseItemId:c,ReferenceItemId:u,ReferenceItemDocumentId:e.referenceItemDocumentId||0,NewBodyContent:s}))):5==e.operation||6==e.operation?(_=5==e.operation?be:Ce,d=_(Object.assign(Object.assign({},A),{ReferenceItemId:u,ItemId:c,Body:s}))):(d=Object(Se.a)(Object.assign(Object.assign({},A),{Body:s})),e.itemId&&(d.ItemId=e.itemId)),e.fromViewState&&function(e,t){const n=e.from;if(n){let e=!1;const r=Object(h.a)().SessionSettings.ConnectedAccountInfos;if(r)for(let o=0;o<r.length;o++){const i=r[o];if(i.EmailAddress==n.email.EmailAddress){e=!0;const r=Object(v.a)({Value:i.SubscriptionGuid,ExtendedFieldURI:Object(y.a)({PropertyId:b,DistinguishedPropertySetId:"Sharing",PropertyType:"CLSID"})});t.ExtendedProperty?t.ExtendedProperty.push(r):t.ExtendedProperty=[r],t.From=Object(g.a)({Mailbox:{MailboxType:n.email.MailboxType,RoutingType:"SMTP",EmailAddress:n.email.EmailAddress,Name:i.DisplayName}});break}}e||(t.From=Object(g.a)({Mailbox:n.email}))}}(e.fromViewState,d),e.deferredSendTime&&function(e,t){if(e){const n=Object(v.a)({Value:Object(O.vb)(e),ExtendedFieldURI:Object(y.a)({PropertyTag:S,PropertyType:"SystemTime"})});t.ExtendedProperty?t.ExtendedProperty.push(n):t.ExtendedProperty=[n]}}(e.deferredSendTime,d),d}async function Ze(e,t){var n;let r,u;const l=Object(h.a)().UserOptions.TimeFormat;if(Object(z.a)(e)){const n=e;r=Qe(e),u=await Object(q.a)(r,e.bodyType,t,l,e.isInlineCompose,ye(e.protectionViewState),n.publicFolderId)}else{r=Ye(e),r.Attachments=await Je(e),_(e.addin,r),A(e.addin,r,t),I(e.addin,r,t);const{protectionViewState:n}=e;if(Object(F.j)("cmp-clp")&&!Object(x.a)(e)){const{clpViewState:e}=n;Object(V.c)(e,r)}if((null==n?void 0:n.classificationViewState)&&function(e,t){const{messageClassification:n}=e;if(!n)return;t.ExtendedProperty||(t.ExtendedProperty=[]),Object.keys(n).forEach(e=>{const r=G.b[e];r&&t.ExtendedProperty.push(Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:n[e]}))});const r=G.b.IsClassified;t.ExtendedProperty.push(Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyId:r.id,DistinguishedPropertySetId:"Common",PropertyType:r.propertyType}),Value:"true"}))}(n.classificationViewState,r),Object(o.a)()&&function(e,t){var n,r;const o=null===(r=null===(n=null==e?void 0:e.from)||void 0===n?void 0:n.email)||void 0===r?void 0:r.EmailAddress;if(o&&!Object(Pe.a)(o)){const e=Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyName:Re,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:o});t.ExtendedProperty?t.ExtendedProperty.push(e):t.ExtendedProperty=[e]}}(e.fromViewState,r),e.suggestedAttachmentSessionId){const t=Object(v.a)({ExtendedFieldURI:Object(y.a)({PropertyName:"suggested_attachment_session_id",DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"}),Value:e.suggestedAttachmentSessionId});r.ExtendedProperty?r.ExtendedProperty.push(t):r.ExtendedProperty=[t]}const d=Object(je.a)(e),f=(null==d?void 0:d.atMentionTuples)&&Object.keys(d.atMentionTuples).length>0?await ke.import():null;if(null==f||f(d,t,r),Object(Ee.a)(e.smimeViewState))try{const n=function(e,t,n){const r=e.smimeViewState||Object(s.a)(),{docViewAttachments:o,inlineAttachments:u}=e.attachmentWell,l=Object(c.a)(r);let d;return d=o.slice(0),d.push(...u),{smimeViewState:r,message:t,fromAddress:Object(i.a)(),isSend:n,composeId:e.composeId,toRecipients:l?Object(a.a)(e.toRecipientWell):[],ccRecipients:l?Object(a.a)(e.ccRecipientWell):[],attachments:d}}(e,r,t);await Ne.p.import().then(e=>e(n))}catch(e){const t=new Error;return t.message=e.message==xe.a?xe.a:"SmimeEncodeError: "+e.message,Promise.reject(t)}else if(e.itemId){const t=Object(pe.b)().items.get(e.itemId.Id);t&&Object(Te.b)(t.ItemClass)&&(r.ItemClass=Xe)}if(t){(function(e){const t=[];if(e.isReportedFalsePositive){const e={ExtendedFieldURI:{PropertyName:ge,PropertyType:"String",DistinguishedPropertySetId:me},Value:""};t.push(e)}if(e.isOverridden){const n={ExtendedFieldURI:{PropertyName:he,PropertyType:"String",DistinguishedPropertySetId:me},Value:e.overrideJustification};t.push(n)}return t})(e.policyTipsViewState).map(e=>(function(e,t){null==e.ExtendedProperty?e.ExtendedProperty=[t]:e.ExtendedProperty.push(t)})(r,e))}u=await function(e,t,n,r){var o,i;if(Object(x.a)(e)){if(r&&3!=e.operation){if(Object(Ie.a)()||e.itemId||t.RightsManagementLicenseData||(null===(o=e.protectionViewState)||void 0===o?void 0:o.IRMData))return function(e,t,n,r,o,i){const a=te(e,t,0,r,o,i),s={headers:Object(X.e)(null,"GroupMailbox")};return Z({Header:Object($.b)(),Body:a},s).then(e=>e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout")))}(e.groupId,t,e.bodyType,n,ye(e.protectionViewState),e.isInlineCompose);const r=Object(U.n)(e.groupId);return function(e,t,n,r,o,i){const a=re(e,t,0,0,i);return ne({Header:Object($.b)(),Body:a},o).then(e=>e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout")))}(e.groupId,t,e.bodyType,0,Object(We.a)(r),e.isInlineCompose)}{const r=1==e.operation||2==e.operation;if(!e.itemId&&r||e.useSmartResponse)return Object(K.a)(e.groupId,t,e.bodyType,!1,n,e.isInlineCompose)}}const a=Object(W.c)(),s=!(!a||a.treeType!==L.l&&a.treeType!==L.c);if(r){const n=Object(B.a)(null===(i=e.attachmentWell)||void 0===i?void 0:i.sharingLinkIds);n&&n.length>0&&(t.DocLinks=n)}let c;t.ShouldIgnoreChangeKey=Object(F.j)("mon-cmp-experimentalGraphQLCompose");const u=ye(e.protectionViewState);(function(e,t,n){return Object(F.j)("mon-cmp-experimentalGraphQLCompose")&&Object(De.b)(e.operation)&&!Object(Ee.a)(e.smimeViewState)&&!(t.Attachments&&t.Attachments.length>0)&&!n})(e,t,u)&&(c=e.itemId?async function(e,t,n){const r=Object(He.a)(),o=Object(Ve.a)(e,n),i=function(e,t,n){return t?n?e.sendSmartReply:e.sendDraft:n?e.saveSmartReply:e.saveDraft}((await r.mutate({variables:{draft:o,itemId:n.itemId,requestIMIOnly:n.isInlineCompose},mutation:ze(t,n.useSmartResponse)})).data,t,n.useSmartResponse);return{ResponseMessages:{Items:[{Items:i.draft?[Object.assign({},i.draft)]:null,ResponseClass:"Success"}]}}}(t,r,e):Object(De.a)(t,r,e));c||(c=e.useSmartResponse||!e.itemId?Object(q.a)(t,e.bodyType,r,n,e.isInlineCompose,u,null,s):de(t,r,u,e.addin.keysOfInternetHeadersToBeRemoved));return c}(e,r,l,t)}w(e.addin);const d=(null===(n=null==u?void 0:u.ResponseMessages)||void 0===n?void 0:n.Items)?u.ResponseMessages.Items[0]:u&&!u.ResponseMessages?u:null;if(d&&"Success"==d.ResponseClass)return Promise.resolve(d);{let t;return function(e,t){var n;if(e){Object(E.d)(e.WasclUpgradeToPremiumUrl,e.AccountRecoveryFlowUrl);const r=(null===(n=e.ResponseMessages)||void 0===n?void 0:n.Items)?e.ResponseMessages.Items[0]:null;!r||"ErrorExceededMessageLimit"!=r.ResponseCode&&"ErrorExceededHourlyMessageLimit"!=r.ResponseCode&&"ErrorExceededMessageLimitShowTierUpgrade"!=r.ResponseCode||Object(Ge.b)(t,!0)}}(u,e),d?(t=new Error(d.ResponseCode),t.messageText=d.MessageText):t=new Error("Unrecognized response"),Promise.reject(t)}}function $e(e){return Ze(e,!0)}function et(e){return Ze(e,!1)}function tt(e,t){if(Object(fe.a)(e)){const n=function(e){var t;if(null==e?void 0:e.Items)return e.Items[0];if(null===(t=e)||void 0===t?void 0:t.Item)return e.Item;return null}(e);return n&&(Object(Ee.a)(t.smimeViewState)||D.h.import().then(e=>{const r=e(t.attachmentWell,t.content,t.bodyType,!0);r.length&&Ne.r.import().then(e=>e(r,n.Attachments,Object(M.a)({Id:t.composeId})))}),n.ItemId&&(P(t,n.ItemId.Id,n.ItemId.ChangeKey,n.LastModifiedTime),n.Body&&Object(x.a)(t)&&(t.lastSavedMessageBody=n.Body.Value)),n.InternetMessageId&&Object(R.a)(t.conversationId,t.itemId?t.itemId.Id:null,n.InternetMessageId)),!0}return!1}function nt(e){return e.textDirection||(Object(H.i)()?"rtl":"ltr")}},5998:function(e,t,n){"use strict";var r=n(4679),o=n(47),i=n(2620),a=n(2287),s=n(38),c=n(2844),u=n(611),l=n(707),d=n(1701),f=n(1788),p=n(4255),m=n(261),h=n(2499),g=n(704);function v(e,t,n,v,y,b,O,S,C,A){var _;const I=function(e,t,n,i,a,s,p,m,g){const v="PostItem:#Exchange"==e.__type?"newPost":"newMail",y=p?Object(f.a)({BaseFolderId:Object(u.a)({Id:p})}):null,b=Object(c.a)(Object.assign({ClientSupportsIrm:!0,ComposeOperation:v,MessageDisposition:n?"SendAndSaveCopy":"SaveOnly",Items:[e],TimeFormat:i,SendOnNotFoundError:!0,RemoteExecute:m,ItemShape:Object(l.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(d.a)({FieldURI:"ItemLastModifiedTime"})]}),SavedItemFolderId:null!=y?y:void 0,SuppressMarkAsReadOnReplyOrForward:Object(o.j)("tri-suppressMarkReadBehaviorOnRF")&&g},Object(h.a)()));return(null==s?void 0:s.IsOwner)&&(b.ComplianceId=s.RmsTemplateId?s.RmsTemplateId.toUpperCase():"0"),n?a&&b.ItemShape&&(b.ItemShape.ReturnOnlyInternetMessageId=!0):(b.ItemShape=Object(r.a)(t),b.ShapeName="MailCompose"),b}(e,t,n,v,y,b,O,S,C);let x;if(A&&(x=Object(g.a)(A)),"PostItem:#Exchange"==e.__type&&O){const e=a.a.folderTable.get(O);if(e){const t=e.replicaList?e.replicaList[0]:null===(_=Object(s.a)().SessionSettings)||void 0===_?void 0:_.DefaultPublicFolderMailbox;if(t){const e=Object(i.a)(t);x=Object(g.a)(e)}}}return Object(p.a)({Header:Object(m.b)(),Body:I},x).then(e=>e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout")))}n.d(t,"a",(function(){return v}))},6010:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"n",(function(){return v})),n.d(t,"j",(function(){return y})),n.d(t,"m",(function(){return b})),n.d(t,"q",(function(){return O})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return C})),n.d(t,"i",(function(){return A})),n.d(t,"e",(function(){return _})),n.d(t,"f",(function(){return I})),n.d(t,"k",(function(){return x})),n.d(t,"b",(function(){return w})),n.d(t,"c",(function(){return M})),n.d(t,"d",(function(){return k})),n.d(t,"r",(function(){return j})),n.d(t,"l",(function(){return R})),n.d(t,"p",(function(){return N}));var r,o=n(4304),i=n(5366),a=n(4622),s=n(3226),c=n(2285),u=n(4623),l=n(7762),d=n(5367),f="1DS-Web-JS-3.1.7",p="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",m="withCredentials",h=((r={})[0]=a.b.Unspecified,r[2]=a.b.Double,r[1]=a.b.String,r[3]=a.b.Bool,r[4098]=a.b.Double,r[4097]=a.b.String,r[4099]=a.b.Bool,r),g=(Boolean(Object(s.d)()),Boolean(Object(s.k)()));function v(e){return!(""===e||Object(c.r)(e))}function y(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function b(e){return!!(e&&Object(c.s)(e)&&e>=a.a.Normal&&e<=a.a.Immediate)}function O(e,t,n){if(!t&&!v(t)||"string"!=typeof e)return null;var r=typeof t;if("string"===r||"number"===r||"boolean"===r||Object(c.k)(t))t={value:t};else if("object"!==r||t.hasOwnProperty("value")){if(Object(c.r)(t.value)||""===t.value||!Object(c.u)(t.value)&&!Object(c.s)(t.value)&&!Object(c.l)(t.value)&&!Object(c.k)(t.value))return null}else t={value:n?JSON.stringify(t):t};if(Object(c.k)(t.value)&&!T(t.value))return null;if(!Object(c.r)(t.kind)){if(Object(c.k)(t.value)||!E(t.kind))return null;t.value=t.value.toString()}return t}function S(e,t,n){var r=-1;if(!Object(c.x)(e))if(t>0&&(32===t?r=8192:t<=13&&(r=t<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(n))-1===r&&(r=0),r|=n;else{var o=h[P(e)]||-1;-1!==r&&-1!==o?r|=o:o===a.b.Double&&(r=o)}return r}function C(e){return Object(u.b)(null)?A(Object(u.d)(null),e):""}function A(e,t,n){var r;return void 0===n&&(n=!0),e&&(r=e.get(t),n&&r&&decodeURIComponent&&(r=decodeURIComponent(r))),r||""}function _(e){void 0===e&&(e="D");var t=Object(l.c)();return"B"===e?t="{"+t+"}":"P"===e?t="("+t+")":"N"===e&&(t=t.replace(/-/g,"")),t}function I(e,t,n,r,i){var a={},s=!1,u=0,l=arguments.length,d=arguments;for("[object Boolean]"===Object[o.k].toString.call(d[0])&&(s=d[0],u++);u<l;u++){e=d[u];Object(c.z)(e,(function(e,t){s&&t&&Object(c.t)(t)?Object(c.k)(t)?(a[e]=a[e]||[],Object(c.a)(t,(function(t,n){t&&Object(c.t)(t)?a[e][n]=I(!0,a[e][n],t):a[e][n]=t}))):a[e]=I(!0,a[e],t):a[e]=t}))}return a}var x=l.e;function E(e){return e===a.c.NotSet||e>a.c.NotSet&&e<=a.c.Pii_IPV4AddressLegacy||e===a.c.CustomerContent_GenericContent}function T(e){return e.length>0}function w(e){var t=Object(l.a)("pagehide",e);return Object(l.a)("visibilitychange",(function(t){var n=Object(s.d)();e&&n&&"hidden"===n.visibilityState&&e(t)}))||t}function M(e){var t=Object(l.a)("pageshow",e);return Object(l.a)("visibilitychange",(function(t){var n=Object(s.d)();e&&n&&"visible"===n.visibilityState&&e(t)}))||t}function k(e){var t=Object(l.a)("beforeunload",e);return t=Object(l.a)("unload",e)||t,Object(l.a)("pagehide",e)||t}function j(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=x()}function P(e){var t=0;if(null!=e){var n=typeof e;"string"===n?t=1:"number"===n?t=2:"boolean"===n?t=3:n===o.j&&(t=4,Object(c.k)(e)?(t=4096,e.length>0&&(t|=P(e[0]))):Object(c.j)(e,"value")&&(t=8192|P(e.value)))}return t}o.l,o.j,o.l,c.a,c.b,c.c,c.d,c.B,c.J,s.p,c.u,c.s,c.l,c.o,c.k,c.t,c.H,s.m,c.J,s.r,u.b,u.e,c.y,l.a,c.F,c.z,c.w,c.x,c.r,c.j,c.o,c.t,c.m,c.k,c.n,c.u,c.s,c.l,c.J,c.a,c.b,c.c,c.d,c.H,i.b,c.B,c.y,l.a,c.f,s.o,l.c,l.e,l.d,d.d,d.c,d.b,d.a,l.b;function R(){return!!Object(s.e)("chrome")}function N(e,t,n,r,o){function i(e,t,n){try{e[t]=n}catch(e){}}void 0===r&&(r=!1),void 0===o&&(o=!1);var a=new XMLHttpRequest;return r&&i(a,p,r),n&&i(a,m,n),a.open(e,t,!o),n&&i(a,m,n),a}},6028:function(e){e.exports=JSON.parse('{"a":"Ipa","b":"Jpa"}')},6029:function(e){e.exports=JSON.parse('{"a":"Lna"}')},6030:function(e){e.exports=JSON.parse('{"a":"Kna"}')},6031:function(e){e.exports=JSON.parse('{"a":"Jna"}')},6032:function(e){e.exports=JSON.parse('{"a":"Hna"}')},6033:function(e){e.exports=JSON.parse('{"a":"zna"}')},6034:function(e){e.exports=JSON.parse('{"a":"lna"}')},6035:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(57);function o(){return!Object(r.r)()}},6037:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),o=n(3363),i=n(4461),a=n(4119),s=n(6010),c=1,u=function(e,t){var n=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var u=[],l=!1,d={name:"DiagnosticLevel",processEvent:function(e){var t=e.eventFlags.diagnosticLevel;return l||10===t||110===t||120===t}},f={},p=Object(s.e)(),m=(new Date).getTime().toString(),h=function(e,t){if(1===t.eventType)return a.b;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},g=function(e,t){var s,c=Object(i.c)(e);if(function(e){for(var t=function(t){var n=u[t];if(!n.processEvent(e))return Object(o.b)(2,1,(function(){return e.eventName+" suppressed by "+n.name})),{value:!1}},n=0;n<u.length;n++){var r=t(n);if("object"==typeof r)return r.value}return!0}(c)){n.eventsProcessed++;var l=((s=c.timestamp)?new Date(s):new Date).toISOString(),d={"Event.Sequence":{value:n.eventsProcessed,propertyType:4},"Event.Name":c.eventName,"Event.Source":"OTelJS","Event.Time":{value:l,propertyType:9}};Object(a.c)(d,c.dataFields,{prependDataToken:!0,customerContentEnabled:1===t.eventType}),d["Event.Id"]=p+"."+n.eventsProcessed;var g="custom";c.eventContract&&(c.eventContract.name&&(d["Event.Contract"]=c.eventContract.name,g+="."+c.eventContract.name.toLowerCase().replace(/\./g,"_")),Object(a.c)(d,c.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===t.eventType}));var v={iKey:h(c,t),name:c.eventName,data:d,time:l,baseType:g,ext:{sdk:{seq:n.eventsProcessed,epoch:m}}};return n.usePartAPlugin||(v.data=Object(r.__assign)(Object(r.__assign)({},v.data),f)),v}};this.getOneDSTelemetryEvent=function(e){return g(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(t.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=c&&1===e.telemetryProperties.customerContentType)return g(e,{eventType:1})},this.addPreprocessor=function(e){u.push(e)},this.addPersistentDataFields=function(e){Object(a.c)(f,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){l=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,t.enableOptionalEvents&&(l=!0),this.addPersistentDataFields(e),this.addPreprocessor(d)}},6062:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(6),o=n(3538),i=n(326),a=n(4354),s=n(59),c=n(3044);function u(e,t,n){return e&&Object(c.c)(a.d.TXPSettingsLoad,function(e,t){return{entryPoint:e,entityType:t}}(t,n)),Object(s.b)().then(e=>(e["cache-control"]="no-store",Object(o.b)(Object(r.c)(a.a,a.f),Object(i.a)(),!0,e,null)))}},6088:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1833),o=n(1777),i=n(1696);function a(e){const t=[];for(const n of e){let e=null;n.attachmentType==r.a.Item?e={fileType:o.a.MailItem,name:n.name,size:n.size,itemId:n.id}:n.attachmentType==r.a.File&&(e={fileType:o.a.Uri,name:n.name,size:n.size,uri:n.id,type:Object(i.b)(n.id)}),e&&t.push({file:e,isInline:n.isInline})}return t}},611:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"FolderId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6134:function(e,t,n){"use strict";var r=n(7);const o=60,i=6e4;function a(e){const t=e.split("-");return{year:parseInt(t[0]),month:parseInt(t[1]),day:parseInt(t[2])}}function s(e){const t=Number(e).toFixed(2);return Number(t)}const c="Monday",u="Tuesday",l="Wednesday",d="Thursday",f="Friday",p="Saturday",m="Sunday",h=[c,u,l,d,f].join(" "),g=[p,m].join(" "),v=[h,g].join(" ");function y(e){switch(e){case"mon":return c;case"tue":return u;case"wed":return l;case"thu":return d;case"fri":return f;case"sat":return p;case"sun":return m;case"weekday":return h;case"weekendDay":return g;case"day":return v}return""}function b(e){switch(e){case c:return"mon";case u:return"tue";case l:return"wed";case d:return"thu";case f:return"fri";case p:return"sat";case m:return"sun";case h:return"weekday";case g:return"weekendDay";case v:return"day"}return""}var O=n(88);const S="January",C="February",A="March",_="April",I="May",x="June",E="July",T="August",w="September",M="October",k="November",j="December";function P(e){switch(e){case"jan":return S;case"feb":return C;case"mar":return A;case"apr":return _;case"may":return I;case"jun":return x;case"jul":return E;case"aug":return T;case"sep":return w;case"oct":return M;case"nov":return k;case"dec":return j}return""}function R(e){switch(e){case S:return"jan";case C:return"feb";case A:return"mar";case _:return"apr";case I:return"may";case x:return"jun";case E:return"jul";case T:return"aug";case w:return"sep";case M:return"oct";case k:return"nov";case j:return"dec"}return""}const N="First",D="Second",F="Third",L="Fourth",U="Last";function B(e){switch(e){case"first":return N;case"second":return D;case"third":return F;case"fourth":return L;case"last":return U}return""}function H(e){switch(e){case N:return"first";case D:return"second";case F:return"third";case L:return"fourth";case U:return"last"}return""}function V(e){if(null==e.recurrenceType)return null;const t=function(e){const{startTime:t,endTime:n,recurrenceType:c,timeZone:u}=e,l=a(c.RecurrenceRange.StartDate),d=(n.getTime()-t.getTime())/i;let f,p=Object(r.Vb)(u,t.valueOf()).toString().split("T")[1].split(":");f=s(p[0])*o+s(p[1]);let m={startYear:l.year,startMonth:l.month,startDay:l.day,startTimeMin:f,durationMin:d};if(c.RecurrenceRange.EndDate){const e=a(c.RecurrenceRange.EndDate);m=Object.assign(Object.assign({},m),{endDay:e.day,endMonth:e.month,endYear:e.year})}else m.noEndDate=!0;return m}(e),n={name:e.timeZone,offset:Object(O.h)(e.startTime,e.timeZone)},c=e.recurrenceType.RecurrencePattern;switch(c.__type){case"DailyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval},recurrenceType:"daily",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"WeeklyRecurrence:#Exchange":return function(e,t,n){if(1===e.Interval&&"weekday"===b(e.DaysOfWeek))return{recurrenceProperties:void 0,recurrenceType:"weekday",seriesTimeJson:t,recurrenceTimeZone:n};return{recurrenceProperties:{interval:e.Interval,days:e.DaysOfWeek.split(" ").map(b),firstDayOfWeek:b(e.FirstDayOfWeek)},recurrenceType:"weekly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"AbsoluteMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfMonth:e.DayOfMonth},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"RelativeMonthlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:e.Interval,dayOfWeek:b(e.DaysOfWeek),weekNumber:H(e.DayOfWeekIndex)},recurrenceType:"monthly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"AbsoluteYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfMonth:e.DayOfMonth,month:R(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n);case"RelativeYearlyRecurrence:#Exchange":return function(e,t,n){return{recurrenceProperties:{interval:0,dayOfWeek:b(e.DaysOfWeek),weekNumber:H(e.DayOfWeekIndex),month:R(e.Month)},recurrenceType:"yearly",seriesTimeJson:t,recurrenceTimeZone:n}}(c,t,n)}return null}const z=60;function W(e,t,n,r){const o=Math.floor(r/z);return r-=o*z,new Date(Date.UTC(e,t-1,n,o,r))}function G(e,t){switch(e){case"daily":return function(e){return{__type:"DailyRecurrence:#Exchange",Interval:e.interval}}(t);case"weekday":return{__type:"WeeklyRecurrence:#Exchange",Interval:1,FirstDayOfWeek:"Monday",DaysOfWeek:"Monday Tuesday Wednesday Thursday Friday"};case"weekly":return function(e){return{__type:"WeeklyRecurrence:#Exchange",Interval:e.interval,FirstDayOfWeek:y(e.firstDayOfWeek),DaysOfWeek:e.days.map(y).join(" ")}}(t);case"monthly":return function(e){return e.dayOfMonth?{__type:"AbsoluteMonthlyRecurrence:#Exchange",DayOfMonth:e.dayOfMonth,Interval:e.interval}:{__type:"RelativeMonthlyRecurrence:#Exchange",Interval:e.interval,DaysOfWeek:y(e.dayOfWeek),DayOfWeekIndex:B(e.weekNumber)}}(t);case"yearly":return function(e){return e.dayOfMonth?{__type:"AbsoluteYearlyRecurrence:#Exchange",Month:P(e.month),DayOfMonth:e.dayOfMonth}:{__type:"RelativeYearlyRecurrence:#Exchange",Month:P(e.month),DaysOfWeek:y(e.dayOfWeek),DayOfWeekIndex:B(e.weekNumber)}}(t);default:return null}}function q(e){const t=K(e.startYear,e.startMonth,e.startDay);if(e.noEndDate)return{__type:"NoEndRecurrence:#Exchange",StartDate:t};return{__type:"EndDateRecurrence:#Exchange",StartDate:t,EndDate:K(e.endYear,e.endMonth,e.endDay)}}function K(e,t,n){return`${e}-${X(t)}-${X(n)}`}function X(e){return e<10?`0${e}`:`${e}`}var Q=n(57);function J(e){if(null==e)return null;const{seriesTimeJson:t,recurrenceProperties:n,recurrenceType:r,recurrenceTimeZone:o}=e,{startDay:i,startMonth:a,startYear:s,startTimeMin:c,durationMin:u}=t;var l;return l=o?o.name:Object(Q.o)(),{recurrenceType:{__type:"RecurrenceType:#Exchange",RecurrenceRange:q(t),RecurrencePattern:G(r,n)},timeZone:l,startTime:W(s,a,i,c),endTime:W(s,a,i,c+u)}}function Y(e){let t=null;e&&(t=JSON.parse(JSON.stringify(e)));let n=null==t?void 0:t.seriesTimeJson;return n&&(n.startTimeMinutes=n.startTimeMin,n.durationMinutes=n.durationMin,delete n.startTimeMin,delete n.durationMin,delete t.seriesTimeJson,t.seriesTime=n),t}function Z(e,t,n){return e>=1601&&t>=1&&t<=12&&n>=1&&n<=31}function $(e,t,n){var r=new Date;return r.setFullYear(e),r.setMonth(t-1),r.setDate(n),r}function ee(e){return null==e||!!e.recurrenceType&&(!(!e.seriesTimeJson||!function(e){if(!e)return!1;if(!Z(e.startYear,e.startMonth,e.startDay))return!1;if(!e.noEndDate){if(!Z(e.endYear,e.endMonth,e.endDay))return!1;if($(e.startYear,e.startMonth,e.startDay)>=$(e.endYear,e.endMonth,e.endDay))return!1}return!(e.startTimeMin<0||e.durationMin<0)}(e.seriesTimeJson))&&!!function(e,t){switch(e){case"daily":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;return!0}(t);case"weekly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.days||e.days.length<1)return!1;if(!e.firstDayOfWeek)return!1;return!0}(t);case"monthly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"yearly":return function(e){if(!e)return!1;if(!e.interval||e.interval<1)return!1;if(!e.month)return!1;if(e.dayOfMonth&&!e.dayOfWeek&&!e.weekNumber)return!0;if(e.dayOfWeek&&e.weekNumber&&!e.dayOfMonth)return!0;return!1}(t);case"weekday":return!t}}(e.recurrenceType,e.recurrenceProperties))}n.d(t,"a",(function(){return V})),n.d(t,"b",(function(){return J})),n.d(t,"d",(function(){return Y})),n.d(t,"c",(function(){return ee}))},614:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(132),o=n(13);function i(){return Object(r.a)("acctmonaccounts")&&Object(o.i)("acctmonaccounts")}function a(){return i()||!Object(r.a)("acctmonaccounts")&&Object(o.i)("accountsapi")}},615:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(8),o=n(127),i=n(297),a=Object(o.c)((function(e,t){var n,o,a,s=Object(i.a)(e),c={root:{padding:"0 4px",height:"40px",color:e.palette.neutralPrimary,backgroundColor:"transparent",border:"1px solid transparent",selectors:(n={},n[r.HighContrastSelector]={borderColor:"Window"},n)},rootHovered:{color:e.palette.themePrimary,selectors:(o={},o[r.HighContrastSelector]={color:"Highlight"},o)},iconHovered:{color:e.palette.themePrimary},rootPressed:{color:e.palette.black},rootExpanded:{color:e.palette.themePrimary},iconPressed:{color:e.palette.themeDarker},rootDisabled:{color:e.palette.neutralTertiary,backgroundColor:"transparent",borderColor:"transparent",selectors:(a={},a[r.HighContrastSelector]={color:"GrayText"},a)},rootChecked:{color:e.palette.black},iconChecked:{color:e.palette.themeDarker},flexContainer:{justifyContent:"flex-start"},icon:{color:e.palette.themeDarkAlt},iconDisabled:{color:"inherit"},menuIcon:{color:e.palette.neutralSecondary},textContainer:{flexGrow:0}};return Object(r.concatStyleSets)(s,c,t)}))},617:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),o=n(0),i=n(298),a=n(398),s=n(507),c=n(615),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.styles,n=e.theme;return o.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:"ms-Button--action ms-Button--command",styles:Object(c.a)(n,t),onRenderDescription:a.b}))},t=Object(r.__decorate)([Object(s.a)("ActionButton",["theme","styles"],!0)],t)}(o.Component)},618:function(e,t,n){"use strict";function r(e,t){for(var n,r=/\r\n|[\n\r]/g,o=1,i=t+1;(n=r.exec(e.body))&&n.index<t;)o+=1,i=t+1-(n.index+n[0].length);return{line:o,column:i}}n.d(t,"a",(function(){return r}))},620:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.zero=0]="zero",e[e.medium=1]="medium",e[e.long=2]="long"}(r||(r={}))},624:function(e,t,n){"use strict";var r=n(632),o=n(3),i=Object(o.createStore)("nonBootUserConfiguration",{nonBootUserConfiguration:null})(),a=n(128);let s,c=Object(o.mutatorAction)("setNonBootUserConfiguration",(function(e){i.nonBootUserConfiguration=e}));function u(){return Object(a.b)()?Promise.resolve({}):i.nonBootUserConfiguration?Promise.resolve(i.nonBootUserConfiguration):(s||(s=Object(r.a)().then(e=>(c(e),e)).catch(e=>{throw s=void 0,e})),s)}var l=u;function d(){return i.nonBootUserConfiguration||u(),i.nonBootUserConfiguration}function f(){const{IsEdu:e=!1}=d()||{};return e}function p(){const{ExternalInOutlookEnabled:e=!1}=d()||{};return e}n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"a",(function(){return p}))},625:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(220);function i(e,t){var n=r.useRef(t);return n.current||(n.current=Object(o.a)(e)),n.current}},6267:function(e){e.exports=JSON.parse('{"a":"Ema","c":"Fma","d":"Gma","h":"Hma","j":"Ima","g":"Jma","f":"Kma","i":"Lma","l":"Mma","k":"Nma","m":"Oma","n":"Pma","o":"Qma","p":"Rma","q":"Sma","r":"Tma","s":"Uma","u":"Vma","t":"Wma","v":"Xma","x":"Yma","y":"Zma","z":"_ma","A":"$ma","b":"ana","w":"bna","e":"cna"}')},6269:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.mutatorAction)("switchToReadWriteRecipient",(function(e){e.showCompactRecipientWell=!1}))},630:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t,n,r,o){this.message=e,this.path=t,this.query=n,this.clientOnly=r,this.variables=o}},6305:function(e,t,n){"use strict";function r(e){if(e.smimeBccForkingMode){const{smimeBccForkingMode:t}=e;return 2===t||3===t}return!1}n.d(t,"a",(function(){return r}))},6306:function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var r=n(6307),o=n(6),i=n(2101),a=n(5440),s=n(3434);let c="",u="";function l(e,t){e&&(c=e),t&&(u=t)}function d(e){return{text:Object(o.b)(r.a),action:()=>{Object(i.a)(e,["errorMessageExceededMessageLimit","errorMessageExceededMaxRecipientLimit"]),window.open(c)}}}let f=null;function p(e,t){return{text:Object(o.b)(r.b),action:()=>{null===f&&([f]=Object(s.a)(a.a,t),f.then(({success:t})=>{f=null,t&&function(e){Object(i.a)(e,["errorMessageMessageSubmissionBlocked","errorMessageExceededMaxRecipientLimitShowTierUpgrade","errorMessageExceededMessageLimitShowTierUpgrade"])}(e)},e=>{f=null}))}}}function m(e){return{text:Object(o.b)(r.b),action:()=>{Object(i.a)(e,["errorMessageAccountSuspend","errorMessageAccountSuspendShowTierUpgrade"]),window.open(u)}}}},6307:function(e){e.exports=JSON.parse('{"a":"kma","b":"lma"}')},6308:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ReplyAllToItem:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6309:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ReplyToItem:#Exchange"},e)}n.d(t,"a",(function(){return r}))},6313:function(e,t,n){"use strict";var r=n(1058),o=n(3);t.a=Object(o.mutatorAction)("showCcWell",e=>{e.ccRecipientWell||(e.ccRecipientWell=Object(r.a)(e.toRecipientWell.findPeopleFeedbackManager,[]))})},632:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(35);function o(e){return Object(r.a)("GetOwaNonBootUserConfiguration",{},e)}},636:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(68),o=function(e,t){var n;try{n=JSON.stringify(e)}catch(e){var o=new r.a(23);throw o.parseError=e,o}return n}},644:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(499),o=n(443);function i(e,t){var n,i,a;void 0===t&&(t={});var s=Object(r.a)({},e,t,{semanticColors:Object(o.a)(t.palette,t.effects,t.semanticColors,void 0===t.isInverted?e.isInverted:t.isInverted)});if((null===(n=t.palette)||void 0===n?void 0:n.themePrimary)&&!(null===(i=t.palette)||void 0===i?void 0:i.accent)&&(s.palette.accent=t.palette.themePrimary),t.defaultFontStyle)for(var c=0,u=Object.keys(s.fonts);c<u.length;c++){var l=u[c];s.fonts[l]=Object(r.a)(s.fonts[l],t.defaultFontStyle,null===(a=null==t?void 0:t.fonts)||void 0===a?void 0:a[l])}return s}},645:function(e,t,n){"use strict";var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;t.a=r},6451:function(e){e.exports=JSON.parse('{"b":"Sna","a":"Tna","c":"Una","g":"Vna","f":"Wna","d":"Xna","e":"Yna"}')},6452:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(163);function o(e){return"exfc_"+(e==window?"main":Object(r.a)())}function i(e){var t;return e==window?"exfc_main":null===(t=null==e?void 0:e.document.querySelector('[id^="exfc_"]'))||void 0===t?void 0:t.id}},646:function(e,t,n){"use strict";var r=n(16),o=n(3);t.a=Object(o.createStore)("appPaneUnderlayViewState",{isShown:new r.ObservableMap,shrinkable:new r.ObservableMap})},6462:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6088),o=n(2096);function i(e,t,n,i,a,s){const c={operation:0,bodyType:"HTML",subject:i,newContent:a,to:e,cc:t,bcc:n,preferAsyncSend:!0,attachmentFilesToUpload:Object(r.a)(s)};o.k.importAndExecute(c,2)}},6573:function(e,t,n){"use strict";var r=n(1810);const o="permission";n(3572);var i=n(47);const a="DefaultSettings",s="0",c={cache:function(e,t){const{addinCommand:n}=e;let c,u;const d="Preinstalled"===n.get_TypeString()&&2!==n.get_ConsentState()?function(e){const t=function(e){switch(e){case 1:return"ReadItem";case 2:return"ReadWriteMailbox";case 3:return"ReadWriteItem";default:return"Restricted"}}(e),n=Object(r.t)().ConsentUrl;let i;if(n.indexOf("?")>0){const e=n.split("?");i=`${e[0]}?${o}=${t}&${e[1]}`}else if(n.indexOf("#")>0){const e=n.split("#");i=`${e[0]}?${o}=${t}#${e[1]}`}else i=`${n}?${o}=${t}`;return i}(n.get_RequestedCapabilities()):n.get_EntryPoint();u=l(d,t),c=function(e,t,n){const r=n._sourceLocations[t];return new OSF.Manifest.Manifest(t=>{if(t._id=e.get_Id(),t._version=e.get_Version(),t._extensionSettings={},t._displayNames={},t._defaultLocale="",t._displayNames[s]=e.get_ExtensionDisplayName(),t._extensionSettings[a]=n,Object(i.j)("addin-appDomainsDuplicateRemove")){const n=[...e.get_AppDomains()];t._appDomains=function(e,t){const n=Object.entries(e),r=new Map(n.map(e=>-1!==e[1].indexOf("//")?[e[1].split("//")[1],!0]:[e[1],!0]));let o=-1!==t.indexOf("//")?t.split("//")[1].split("/")[0]:t.split("/")[0];if(r.has(o))return e;return e.push(t),e}(n,r)}else t._appDomains=[...e.get_AppDomains(),r]})}(n,t,u),OSF.OsfManifestManager.cacheManifest(n.get_ExtensionId(),n.get_Version(),c)}},u={cache:function(e,t){const{addinCommand:n,controlId:r,sourceLocation:o}=e,i=function(e,t,n,r){const o=OSF.OsfManifestManager.getCachedManifest(e.get_ExtensionId(),e.get_Version()),i=OfficeExt.AddinCommandsManifestManager.createManifestForAddinAction(o,r,null,t);return i._extensionSettings={},i._extensionSettings[a]=l(r,n),i}(n,r,t,o);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(i,r,n.get_Version())}};function l(e,t){const n=new OSF.Manifest.ExtensionSettings;return n._sourceLocations={},n._sourceLocations[t]=e,n}var d=n(11814),f=n(6);const p=e=>()=>{window.open(e.get_EndNodeUrl())};function m(e){switch(e){case 0:case 3:case 1:return 2;case 2:default:return 0}}var h=n(2);const g={sets:[{name:"mailbox",maxVersion:"1.11"},{name:"IdentityAPI",maxVersion:"1.3"},{name:"DialogAPI",maxVersion:"1.2"},{name:"DialogOrigin",maxVersion:"1.2"},{name:"react"}]};const v=["progress.gif","agavedefaulticon96x96.png","moe_status_icons.png"],y=["moeerrorux.css"],b="resources/images/osfruntime/",O="resources/styles/osfruntime/";function S(e,t,n){t.getLocalizedCSSFilePath=C(y,Object(h.I)()+O),t.getLocalizedImageFilePath=C(v,Object(h.I)()+b),t._notifyHostError=t._notifyHost,t._hostType="Outlook",t._hostPlatform="Web",t._hostSpecificFileVersion="16.01",t.getRequirementsChecker().setRequirements(g)}function C(e,t){return n=>{let r=e.filter(e=>n==e)[0];return r=function(e){if(!Object(f.i)())return e;switch(e){case"moeerrorux.css":return"moerroruxrtl.css";default:return e}}(r),r?t+r:""}}var A=n(5241),_=n(4456);const I=e=>(t,n)=>{if(t){const r=t.ApiParams,o=j(t.MethodData.ControlId),i=t.MethodData.DispatchId;Object(A.i)(e,i,o,r,n)}},x=(e,t,n)=>{Object(_.c)(e,n,t)},E=(e,t,n)=>{n.controlId=j(n.controlId),n.eventDispId=function(e){if(e==_.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID)return _.a.DISPLAY_DIALOG_DISPID;return e}(n.eventDispId),Object(_.j)(n,t)},T=[{name:"GetInitialData",isBlocking:!0,action:I},{name:"executeMethod",isBlocking:!1,action:e=>(t,n)=>{if(t){const r=j(t.DdaMethod.ControlId),o=t.DdaMethod.DispatchId;Object(A.i)(e,o,r,t,n)}}},{name:"ExecuteMethod",isBlocking:!1,action:I}];function w(e){return[{name:"appCommandInvoked",registerAction:OfficeExt.AddinCommandsRuntimeManager.registerEvent,unregisterAction:OfficeExt.AddinCommandsRuntimeManager.unregisterEvent},{name:"dialogMessageReceived",registerAction:x,unregisterAction:E},{name:"dialogParentMessageReceived",registerAction:x,unregisterAction:E},{name:"dialogNotificationShown",registerAction:x,unregisterAction:E},{name:"olkItemSelectedChanged",registerAction:x,unregisterAction:E},{name:"olkAppointmentTimeChanged",registerAction:x,unregisterAction:E},{name:"olkRecipientsChanged",registerAction:x,unregisterAction:E},{name:"olkRecurrenceChanged",registerAction:x,unregisterAction:E},{name:"olkEnhancedLocationsChanged",registerAction:x,unregisterAction:E},{name:"olkAttachmentsChanged",registerAction:x,unregisterAction:E}]}function M(e,t){T.forEach(n=>{t.registerMethod(n.name,n.action(e),Microsoft.Office.Common.InvokeType.async,n.isBlocking)}),w().forEach(e=>{t.registerEventEx(e.name,e.registerAction,Microsoft.Office.Common.InvokeType.asyncRegisterEvent,e.unregisterAction,Microsoft.Office.Common.InvokeType.asyncUnregisterEvent)})}function k(e,t){T.forEach(e=>t.unregisterMethod(e.name)),w().forEach(e=>t.unregisterEvent(e.name))}function j(e){const{activeDialogs:t}=Object(r.u)();for(let n of t.values())if(n&&n.controlId===e)return n.parentControlId;return e}var P=n(1785),R=n(8583);function N(e,t,n){const{addinCommand:o,controlId:a,isDialog:s}=t,c=o.get_Settings()?JSON.parse(o.get_Settings()):{},u=function(e,t){var n;const o=Object(P.c)(t);return JSON.stringify({userType:Object(R.a)(),userId:Object(h.t)(),extensionType:e.get_TypeString(),module:Object(h.m)(),deployment:Object(h.E)(),scenario:Object(r.B)(t),clientVersion:Object(h.u)(),isPinned:null===(n=null==o?void 0:o.isAddinPinned)||void 0===n?void 0:n.call(o,e.get_ExtensionId()),react:!0,disableLogging:!1})}(o,e);let l=0;return Object(i.j)("addin-logAllAddinsAsPublic")&&(l|=16),{div:n,id:a,marketplaceID:s?a:o.get_ExtensionId(),marketplaceVersion:o.get_Version(),settings:c,store:"",hostCustomMessage:u,isDialog:s,isVirtualOsfControl:!1,hostInfoFlags:l,storeType:OSF.StoreType.Exchange,storeId:o.get_MarketPlaceAssetId(),assetId:o.get_ExtensionId(),exchangeExtensionProviderName:o.get_ProviderName(),exchangeExtensionType:o.get_TypeString()}}var D=n(3643),F=n(71);const L="User",U="Organization",B=1042;class H{constructor(e,t,n,r,o,a,s){var c,u;this.notifyHost=async(e,t,n)=>{const r=this.notifyHostActions;if(r){const o=r[t];o&&await o(e,n)}},this.hostItemIndex=e,this.addinCommandTelemetry=s,this.contextActivationManager=(c=Object(f.e)(),u=this.notifyHost,OSF.AppSpecificSetup._setupFacade=S,new OSF.ContextActivationManager({appName:64,appVersion:"16.01",clientMode:1,appUILocale:c,lcid:c,notifyHost:u,dataLocale:"",hostControl:{},localizedScriptsUrl:OSF.getLocalizedStringsFilePath(),docUrl:"",appSettings:{flightingTreatmentVariables:{"Microsoft.Office.SharedOnline.IsPrivateAddin":Object(i.j)("addin-isPrivateAddin"),"Microsoft.Office.SharedOnline.UpdateChangeForLaunchEvent":Object(i.j)("addin-updateChangeForLaunchEvent"),"Microsoft.Office.SharedOnline.AllowStorageAccessByUserActivationOnIFrame":!0}}})),this.notifyHostActions=r||{},this.onInsertOsfControlAction=o,this.onDisplayNotificationAction=a,this.manifestCacheProvider=t;const l=this.notifyHostActions[8];this.targetWindow=n,this.notifyHostActions[8]=(e,t)=>(l&&l(e,t),this.notifyHostError(e,t),this.tryTerminateUiLessAddin(t.errorCode,e,this.targetWindow),Promise.resolve()),this.notifyHostActions[23]=this.sendTelemetryEvent.bind(this),this.notifyHostActions[38]=this.sendCustomerContentEvent.bind(this)}insertOsfControl(e,t){M(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.activeOsfControl=e,this.extensionContainer=t,this.manifestCacheProvider.cache(e,Object(f.e)()),this.contextActivationManager.insertOsfControl(N(this.hostItemIndex,this.activeOsfControl,t))}purgeOsfControl(){if(this.activeOsfControl&&this.extensionContainer){const{controlId:e}=this.activeOsfControl;k(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),Object(_.b)(e),this.contextActivationManager.purgeOsfControl(e,!1),this.activeOsfControl=null,this.extensionContainer=null}}onInsertOsfControl(){var e;const t=null===(e=this.activeOsfControl)||void 0===e?void 0:e.addinCommand;(t.get_OriginString()==L||t.get_OriginString()==U)&&r.j.Context&&r.j.Context.IsInOrgMarketplaceRole&&this.tryDisplayNotification(t.get_AppStatus(),t.get_LicenseType()),this.onInsertOsfControlAction&&this.onInsertOsfControlAction()}notifyAgave(e){const{controlId:t}=this.activeOsfControl;this.contextActivationManager.notifyAgave(t,e)}updateHostItemIndex(e){k(this.hostItemIndex,this.contextActivationManager._serviceEndPoint),this.hostItemIndex=e,M(e,this.contextActivationManager._serviceEndPoint)}dispose(){this.contextActivationManager.dispose(),this.contextActivationManager=null}notifyHostError(e,t){var n;Object(D.p)(!1,null===(n=this.activeOsfControl)||void 0===n?void 0:n.addinCommand,this.hostItemIndex,Object(r.s)(e),this.addinCommandTelemetry,e,t.errorCode)}async sendTelemetryEvent(e,t){const n=Object(D.o)(t),{addinCommand:r,controlId:o}=this.activeOsfControl;Object(D.c)(n,r,this.hostItemIndex,o),n.iKey&&await F.l.importAndExecute(n.iKey,n)}async sendCustomerContentEvent(e,t){if(!Object(i.j)("addin-sendCustomerContent"))return;const n=Object(D.n)(t),{addinCommand:r,controlId:o}=this.activeOsfControl;Object(D.c)(n,r,this.hostItemIndex,o),n.iKey&&await F.k.importAndExecute(n.iKey,n)}displayNotification(e){this.contextActivationManager.displayNotification(e),this.onDisplayNotificationAction&&this.onDisplayNotificationAction(e)}tryDisplayNotification(e,t){const{addinCommand:n,controlId:r}=this.activeOsfControl;if(e){const t=function(e,t,n){let r="",o="",i=!1,a=!1;switch(n){case"1.0":r=Object(f.b)(d.b),o=Object(f.b)(d.l),i=!0,a=!0;break;case"1.1":r=Object(f.b)(d.c),o=Object(f.b)(d.l),i=!0,a=!0;break;case"1.2":r=Object(f.b)(d.d),o=Object(f.b)(d.l),i=!0,a=!0;break;case"2.0":r=Object(f.b)(d.e),o=Object(f.b)(d.l);break;case"2.1":r=Object(f.b)(d.f),o=Object(f.b)(d.l);break;case"3.0":r=Object(f.b)(d.g),o=Object(f.b)(d.k);break;case"3.1":r=Object(f.b)(d.h),o=Object(f.b)(d.k);break;case"3.2":r=Object(f.b)(d.i),o=Object(f.b)(d.k);break;case"3.3":r=Object(f.b)(d.j),o=Object(f.b)(d.k);break;default:return null}return{infoType:1,id:e,title:Object(f.b)(d.m),description:r,buttonTxt:o,buttonCallback:p(t),detailView:i,displayDeactive:a,reDisplay:!0}}(r,n,e);t&&this.displayNotification(t)}else 1==t&&this.displayNotification(function(e,t){return{infoType:2,id:t,title:Object(f.b)(d.n),description:Object(f.b)(d.o),buttonTxt:Object(f.b)(d.a),buttonCallback:()=>{window.open(e.get_EndNodeUrl())},reDisplay:!0}}(n,r))}tryTerminateUiLessAddin(e,t,n){if(e==B){let e={allowEvent:!1};Object(r.ib)(t,this.hostItemIndex,r.d.TimedOut,n,e)}}}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return H}))},6576:function(e,t,n){"use strict";var r=n(2571),o=n(1926),i=n(35);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"UpdateClientExtensionNotificationsJsonRequest:#Exchange"},n)),Object(i.a)("UpdateClientExtensionNotifications",e,t)}var s=n(261);function c(e,t,n){const r=(o={ItemId:t,Id:e,Notifications:n},Object.assign({__type:"UpdateClientExtensionNotificationsRequest:#Exchange"},o));var o;return a({Header:Object(s.b)(),Body:r})}var u=n(1785),l=n(2452);async function d(e,t){const n=Object(u.c)(e),i={Id:await n.getItemId()};if(!i.Id)throw new r.a(o.b.CannotPersistPropertyInUnsavedDraftError);const a=Object(l.d)(e,t),s=Object.keys(a).map(e=>{const t=a[e];return{Key:t.Key,Type:t.Type,Message:t.Message,Icon:t.Icon}});await c(t,i,s).catch(e=>{throw new r.a(o.b.PersistedNotificationArraySaveError)})}n.d(t,"a",(function(){return d}))},6578:function(e,t,n){"use strict";var r=n(4679);var o=n(707),i=n(1701),a=n(35);function s(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"CreateResponseFromModernGroupJsonRequest:#Exchange"},n)),Object(a.a)("CreateResponseFromModernGroup",e,t)}var c=n(261),u=n(2499);function l(e,t,n,a,s,c){const l=(d=Object.assign({ClientSupportsIrm:!0,ComposeOperation:"newPost",MessageDisposition:a?"SendAndSaveCopy":"SaveOnly",Items:[t],TimeFormat:s,ItemShape:Object(o.a)({BaseShape:"IdOnly",AdditionalProperties:[Object(i.a)({FieldURI:"ItemLastModifiedTime"})]})},Object(u.a)()),Object.assign({__type:"CreateResponseFromModernGroupRequest:#Exchange"},d));var d;return a?c&&(l.ItemShape.ReturnOnlyInternetMessageId=!0):(l.ItemShape=Object(r.a)(n),l.ShapeName="MailCompose"),l.GroupSmtpAddress=e,l}function d(e,t,n,r,o,i){const a=l(e,t,n,r,o,i);return s({Header:Object(c.b)(),Body:a}).then(e=>e?Promise.resolve(e.Body):Promise.reject(new Error("ErrorSessionTimeout")))}n.d(t,"a",(function(){return d}))},6601:function(e,t,n){"use strict";const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"CreateDraft"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"draft"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"DraftInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSend"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"suppressServerMarkReadOnReplyOrForward"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"createDraft"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"draft"},value:{kind:"Variable",name:{kind:"Name",value:"draft"}}},{kind:"ObjectField",name:{kind:"Name",value:"isSend"},value:{kind:"Variable",name:{kind:"Name",value:"isSend"}}},{kind:"ObjectField",name:{kind:"Name",value:"suppressServerMarkReadOnReplyOrForward"},value:{kind:"Variable",name:{kind:"Name",value:"suppressServerMarkReadOnReplyOrForward"}}},{kind:"ObjectField",name:{kind:"Name",value:"requestIMIOnly"},value:{kind:"Variable",name:{kind:"Name",value:"requestIMIOnly"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"draft"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"Subject"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Attachments"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwsTypeName"}},{kind:"Field",name:{kind:"Name",value:"AttachmentId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"AttachmentOriginalUrl"}},{kind:"Field",name:{kind:"Name",value:"ContentId"}},{kind:"Field",name:{kind:"Name",value:"ContentLocation"}},{kind:"Field",name:{kind:"Name",value:"ContentType"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"IsInline"}},{kind:"Field",name:{kind:"Name",value:"IsInlineToNormalBody"}},{kind:"Field",name:{kind:"Name",value:"IsInlineToUniqueBody"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Size"}},{kind:"Field",name:{kind:"Name",value:"Thumbnail"}},{kind:"Field",name:{kind:"Name",value:"ThumbnailMimeType"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReferenceAttachment"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ProviderType"}},{kind:"Field",name:{kind:"Name",value:"WebUrl"}},{kind:"Field",name:{kind:"Name",value:"AttachLongPathName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Value"}}]}},{kind:"Field",name:{kind:"Name",value:"InternetMessageId"}}]}}]}}]}}]};var o=n(705),i=n(5773);async function a(e,t,n,a,s){const c=Object(o.a)(),u=Object(i.a)(e,n,s),l=await c.mutate({variables:{draft:u,isSend:t,suppressServerMarkReadOnReplyOrForward:a,requestIMIOnly:!!(null==n?void 0:n.isInlineCompose)},mutation:r});return{ResponseMessages:{Items:[{Items:[Object.assign({},l.data.createDraft.draft)],ResponseClass:"Success"}]}}}function s(e){switch(e){case 0:case 1:case 2:case 3:case 4:return!0;case 5:case 6:return!1}}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}))},6676:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"f",(function(){return s})),n.d(t,"i",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"c",(function(){return d}));const r="/ows/beta/OutlookCloudSettings/settings/account",o="Roaming_Signature_List",i="Roaming_New_Signature",a="Roaming_Reply_Signature",s="signaturehtml",c="signaturetxt",u=o.toLowerCase(),l=i.toLowerCase(),d=a.toLowerCase()},669:function(e,t,n){"use strict";var r=n(646),o=n(3);let i=Object(o.action)("setAppPaneUnderlayVisibility",(e,t,n,r)=>({key:e,isShown:t,shrinkable:n,underlayViewState:r}));Object(o.mutator)(i,e=>{let t=e.underlayViewState||Object(r.a)();e.isShown?t.shrinkable.set(e.key,e.shrinkable):t.shrinkable.delete(e.key),t.isShown.set(e.key,e.isShown)}),t.a=i},6724:function(e,t,n){"use strict";function r(e){const t=e&&e.Action;return t&&!!t.SourceLocation}function o(e){const t=e&&e.Action;return t&&!!t.FunctionName}function i(e){return!!e&&!!e.MenuItems}n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}))},6734:function(e){e.exports=JSON.parse('{"a":"esa"}')},6797:function(e,t,n){"use strict";var r=n(326),o=n(327);const i="/ows/api/beta/PersistedAddins";function a(e,t,n){const a=Object(r.a)();Object(o.d)(i,{Addin:{mode:e,addinId:t,commandId:n}},a)}var s=n(283);async function c(){const e=Object(r.a)(),t=await Object(o.b)(i,e,!0);return Object(s.a)(t.status)?t.text():"{}"}var u=n(35);function l(e,t){var n;return void 0===e.request||e.request.__type||(e.request=(n=e.request,Object.assign({__type:"GetExtensibilityContextParameters:#Exchange"},n))),Object(u.a)("GetExtensibilityContext",e,t)}var d=n(6);const f=3;let p=3e3;const m=3,h=!0,g="1.11",v="1.1";async function y(e){try{return await(a=e==f?0:p,new Promise((e,t)=>{setTimeout(()=>{e()},a)})),await(t=m,n=Object(d.f)(),r=h,o=g,i=v,l({request:{FormFactor:t,ClientLanguage:n,IncludeDisabledExtensions:r,ApiVersionSupported:o,ClientOverrideVersion:i}}))}catch(t){if(0==e)throw t}var t,n,r,o,i,a;return y(--e)}function b(){return y(f)}n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return b}))},68:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return f}));var r=n(1),o="Invariant Violation",i=Object.setPrototypeOf,a=void 0===i?function(e,t){return e.__proto__=t,e}:i,s=function(e){function t(n){void 0===n&&(n=o);var r=e.call(this,"number"==typeof n?o+": "+n+" (see https://github.com/apollographql/invariant-packages)":n)||this;return r.framesToPop=1,r.name=o,a(r,t.prototype),r}return Object(r.__extends)(t,e),t}(Error);function c(e,t){if(!e)throw new s(t)}var u=["log","warn","error","silent"],l=u.indexOf("log");function d(e){return function(){u.indexOf(e)}}function f(e){var t=u[l];return l=Math.max(0,u.indexOf(e)),t}!function(e){e.log=d("log"),e.warn=d("warn"),e.error=d("error")}(c||(c={}))},7005:function(e,t){e.exports={am:"am-et",ar:"ar-sa",bg:"bg-bg","bn-in":"bn-in",ca:"ca-es",cs:"cs-cz",cy:"cy-gb",da:"da-dk",de:"de-de",el:"el-gr",en:"en-us",es:"es-es","es-mx":"es-mx",et:"et-ee",eu:"eu-es",fa:"fa-ir",fi:"fi-fi",fil:"fil-ph",fr:"fr-fr","fr-ca":"fr-ca",gl:"gl-es",gu:"gu-in",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",is:"is-is",it:"it-it",ja:"ja-jp",kk:"kk-kz",kn:"kn-in",ko:"ko-kr","lo-la":"lo-la",lt:"lt-lt",lv:"lv-lv",ml:"ml-in",mr:"mr-in",ms:"ms-my",nl:"nl-nl","nn-no":"nn-no",no:"nb-no",pl:"pl-pl",pt:"pt-br","pt-pt":"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr:"sr-latn-rs","sr-cyrl":"sr-cyrl-rs",sv:"sv-se",sw:"sw-ke",ta:"ta-in",te:"te-in",th:"th-th",tr:"tr-tr",uk:"uk-ua",ur:"ur-pk",vi:"vi-vn","zh-hans":"zh-cn","zh-hant":"zh-tw"}},7006:function(e,t,n){"use strict";n.d(t,"h",(function(){return o})),n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"f",(function(){return d}));var r=n(1810);function o(e){return a(e)?s(e).isMenu:e.AddinCommands.size>1}function i(e){return!!a(e)&&s(e).isActionable}function a(e){return 1==e.AddinCommands.size}function s(e){return e.AddinCommands.size>0?[...e.AddinCommands.values()][0]:null}function c(e){if(a(e)){return s(e).control.Supertip.Title}return""}function u(e){let t=e.DisplayName;if(a(e)){t+=" - "+s(e).control.Supertip.Title}return t}function l(e,t,n){const o=r.j.EnabledAddinCommands;if(!o)return null;for(const r of o.getExtensionPoint(n))if(r.Id==e&&r.AddinCommands.size>0)for(const e of r.AddinCommands.values())if(e.control.Id==t)return e;return null}function d(e){return r.j.compliance.isMinor&&function(e){return!function(e){return"Default"===e.get_TypeString()}(e)&&!function(e){return"Organization"===e.get_OriginString()}(e)&&!function(e){return"Private"===e.get_TypeString()}(e)}(e)}},7007:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const r={};function o(){return r}},7008:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(10288),o=n(7007),i=n(6797);function a(e,t){s(Object(r.a)(e),t)}function s(e,t){const n=t?t.addinId:"",r=t?t.commandId:"";Object(o.a)()[e]=t||void 0,Object(i.c)(e,n,r)}},7009:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(1785),o=n(1810),i=n(3);const a=Object(i.action)("resetNavigationState");function s(e){let t=Object(o.F)(e);if(!t)return;const n=t.hostItemIndex,i=t.targetWindow,s=Object(o.G)(e);"Persistent"==s&&a(),Object(o.hb)(s,n,i);const c=Object(r.c)(n);c&&c.closeTaskPane&&c.closeTaskPane()}},7010:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(1810);function o(e,t){const n=Object(r.E)("NonPersistent",e,t);!n||e&&n.hostItemIndex!==e||Object(r.hb)("NonPersistent",e,t)}},7011:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n(5767),i=n(6573);class a extends r.Component{constructor(e,t){super(e,t),this.refCallback=e=>{e&&(this.extensionContainer=e,this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer))},this.handlerContainerOnFocus=()=>{this.notifyAgave(11)},this.osfControlAdapter=this.props.osfControlAdapter?this.props.osfControlAdapter:new i.c(e.hostItemIndex,e.manifestCacheProvider,e.targetWindow,e.notifyHostActions,e.onInsertOsfControl,e.onDisplayNotification,e.addinCommandTelemetry)}componentDidMount(){this.osfControlAdapter.onInsertOsfControl()}UNSAFE_componentWillReceiveProps(e){Object(o.b)()&&this.isNewHostItemIndex(e)&&this.osfControlAdapter.updateHostItemIndex(e.hostItemIndex)}shouldComponentUpdate(e){return this.isNewOsfControl(e)}componentWillUpdate(){this.osfControlAdapter.purgeOsfControl()}componentDidUpdate(){this.osfControlAdapter.onInsertOsfControl()}componentWillUnmount(){this.osfControlAdapter.purgeOsfControl(),this.osfControlAdapter.dispose(),this.osfControlAdapter=null}notifyAgave(e){this.osfControlAdapter.notifyAgave(e)}isNewOsfControl(e){return this.props.controlId!=e.controlId}isNewHostItemIndex(e){return this.props.hostItemIndex!=e.hostItemIndex}render(){return this.extensionContainer&&this.osfControlAdapter.insertOsfControl(this.props,this.extensionContainer),r.createElement("div",{ref:this.refCallback,style:this.props.style,className:this.props.className,onFocus:this.handlerContainerOnFocus})}}},703:function(e,t,n){"use strict";function r(e){return null==e||0==e.trim().length}n.d(t,"a",(function(){return r}))},704:function(e,t,n){"use strict";function r(e,t){return e?Object.assign({mailboxInfo:e},t):null!=t?t:void 0}n.d(t,"a",(function(){return r}))},705:function(e,t,n){"use strict";var r=n(567),o=n(964),i=n(953);let a=!0;const s=()=>{a=!1},c=()=>({Query:{fields:{userConfiguration:{read(e,{args:t,toReference:n}){if(e)return e;if(a){const e=!0;return n(Object(i.a)(null==t?void 0:t.id),e)}return n({__typename:"UserConfiguration",id:t.id})}}}},UserConfiguration:{fields:{ApplicationSettings:{merge:!0},AttachmentPolicy:{merge:!0},Favorites:{merge:!0},MasterCategoryList:{merge:!0},PolicySettings:{merge:!0},PrimeSettings:{merge:!0},SafetyUserOptions:{merge:!0},SegmentationSettings:{merge:!0},SessionSettings:{merge:!0},SmimeAdminSettings:{merge:!0},TenantThemeData:{merge:!0},UserOptions:{merge:!0},ViewStateConfiguration:{merge:!0}}}});var u=n(921);var l=n(71);const d="ApolloNotInitialized";let f=null,p=null;function m(){if(!f){const e=new Error(d);throw e.addQueue=!0,e}return f}function h(e){if(!f)return Object(l.o)(d,{s:e,cs:(new Error).stack}),p}function g({lazyLinks:e,context:t}){return p=e.then(e=>(f=function({links:e,context:t}){const n={watchQuery:{fetchPolicy:"no-cache"},query:{fetchPolicy:"no-cache"}},i=c(),a=new r.ApolloClient({cache:new r.InMemoryCache({possibleTypes:o.a,typePolicies:Object(u.a)(i)}),defaultOptions:n});return t.client=a,a.setLink(r.ApolloLink.from(e)),a}({links:e,context:t}),f)),p}var v=n(0);function y(e){return()=>v.createElement(r.ApolloProvider,{client:m()},e())}n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return h})),n.d(t,"e",(function(){return y})),n.d(t,"d",(function(){return s}))},706:function(e,t,n){"use strict";var r=n(3),o=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1,userIdentity:""})();t.a=o},707:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemResponseShape:#Exchange"},e)}n.d(t,"a",(function(){return r}))},708:function(e,t,n){"use strict";var r=n(719),o=n(252),i=n(573);var a=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},s=Object.prototype.hasOwnProperty;var c=function(e){if(!Object(o.a)(e))return a(e);var t=Object(i.a)(e),n=[];for(var r in e)("constructor"!=r||!t&&s.call(e,r))&&n.push(r);return n},u=n(402);t.a=function(e){return Object(u.a)(e)?Object(r.a)(e,!0):c(e)}},709:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},711:function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(190))},712:function(e,t,n){"use strict";var r=n(720),o=Object(r.a)(Object.getPrototypeOf,Object);t.a=o},713:function(e,t,n){"use strict";var r=n(718),o=n.n(r);let i,a;async function s(){try{i||(i=fetch(o.a));const e=await i;return a||(a=e.text()),a}catch(e){throw i=void 0,a=void 0,e}}function c(e){return e}n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return"DefaultUserConfig"})),n.d(t,"b",(function(){return s}))},714:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return i}));var r="function"==typeof Symbol&&null!=Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Symbol&&null!=Symbol.asyncIterator?Symbol.asyncIterator:"@@asyncIterator",i="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag"},715:function(e,t,n){"use strict";var r=n(315);const o=n.n(r)()("Profile",{profileId:"",profileName:"",accountSources:[]});t.a=o},718:function(e,t,n){e.exports=n.p+"../resources/graphql/schema.all.min-bceb7e9db1d7169983b4eed839783dbc.graphql"},719:function(e,t,n){"use strict";var r=n(962),o=n(520),i=n(262),a=n(518),s=n(577),c=n(574),u=Object.prototype.hasOwnProperty;t.a=function(e,t){var n=Object(i.a)(e),l=!n&&Object(o.a)(e),d=!n&&!l&&Object(a.a)(e),f=!n&&!l&&!d&&Object(c.a)(e),p=n||l||d||f,m=p?Object(r.a)(e.length,String):[],h=m.length;for(var g in e)!t&&!u.call(e,g)||p&&("length"==g||d&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||Object(s.a)(g,h))||m.push(g);return m}},720:function(e,t,n){"use strict";t.a=function(e,t){return function(n){return e(t(n))}}},721:function(e,t,n){"use strict";var r=n(822);n.d(t,"ApolloClient",(function(){return r.a}));var o=n(994);n.o(o,"ApolloLink")&&n.d(t,"ApolloLink",(function(){return o.ApolloLink})),n.o(o,"ApolloProvider")&&n.d(t,"ApolloProvider",(function(){return o.ApolloProvider})),n.o(o,"execute")&&n.d(t,"execute",(function(){return o.execute})),n.o(o,"useApolloClient")&&n.d(t,"useApolloClient",(function(){return o.useApolloClient})),n.o(o,"useLazyQuery")&&n.d(t,"useLazyQuery",(function(){return o.useLazyQuery})),n.o(o,"useMutation")&&n.d(t,"useMutation",(function(){return o.useMutation})),n.o(o,"useQuery")&&n.d(t,"useQuery",(function(){return o.useQuery}));var i=n(309);n.d(t,"isApolloError",(function(){return i.b}));var a=n(1289);n.d(t,"InMemoryCache",(function(){return a.a}));var s=n(525);n.d(t,"makeVar",(function(){return s.c}));var c=n(995);n.o(c,"ApolloLink")&&n.d(t,"ApolloLink",(function(){return c.ApolloLink})),n.o(c,"ApolloProvider")&&n.d(t,"ApolloProvider",(function(){return c.ApolloProvider})),n.o(c,"execute")&&n.d(t,"execute",(function(){return c.execute})),n.o(c,"useApolloClient")&&n.d(t,"useApolloClient",(function(){return c.useApolloClient})),n.o(c,"useLazyQuery")&&n.d(t,"useLazyQuery",(function(){return c.useLazyQuery})),n.o(c,"useMutation")&&n.d(t,"useMutation",(function(){return c.useMutation})),n.o(c,"useQuery")&&n.d(t,"useQuery",(function(){return c.useQuery}));var u=n(569);n.o(u,"ApolloLink")&&n.d(t,"ApolloLink",(function(){return u.ApolloLink})),n.o(u,"ApolloProvider")&&n.d(t,"ApolloProvider",(function(){return u.ApolloProvider})),n.o(u,"execute")&&n.d(t,"execute",(function(){return u.execute})),n.o(u,"useApolloClient")&&n.d(t,"useApolloClient",(function(){return u.useApolloClient})),n.o(u,"useLazyQuery")&&n.d(t,"useLazyQuery",(function(){return u.useLazyQuery})),n.o(u,"useMutation")&&n.d(t,"useMutation",(function(){return u.useMutation})),n.o(u,"useQuery")&&n.d(t,"useQuery",(function(){return u.useQuery}));var l=n(439);n.d(t,"Observable",(function(){return l.a}));var d=n(68),f=n(572);n.d(t,"gql",(function(){return f.a})),Object(d.c)("log")},723:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),o=n.n(r),i=new(n(1113).a?WeakMap:Map);function a(){var e=i.get(o.a.createContext);return e||((e=o.a.createContext({})).displayName="ApolloContext",i.set(o.a.createContext,e)),e}},724:function(e,t,n){"use strict";var r=n(25),o=n(68),i=n(439);var a=n(496);function s(e,t){return t?t(e):i.a.of()}function c(e){return"function"==typeof e?new l(e):e}function u(e){return e.request.length<=1}n.d(t,"a",(function(){return l}));!function(e){function t(t,n){var r=e.call(this,t)||this;return r.link=n,r}Object(r.c)(t,e)}(Error);var l=function(){function e(e){e&&(this.request=e)}return e.empty=function(){return new e((function(){return i.a.of()}))},e.from=function(t){return 0===t.length?e.empty():t.map(c).reduce((function(e,t){return e.concat(t)}))},e.split=function(t,n,r){var o=c(n),a=c(r||new e(s));return u(o)&&u(a)?new e((function(e){return t(e)?o.request(e)||i.a.of():a.request(e)||i.a.of()})):new e((function(e,n){return t(e)?o.request(e,n)||i.a.of():a.request(e,n)||i.a.of()}))},e.execute=function(e,t){return e.request(function(e,t){var n=Object(r.a)({},e);return Object.defineProperty(t,"setContext",{enumerable:!1,value:function(e){n="function"==typeof e?Object(r.a)(Object(r.a)({},n),e(n)):Object(r.a)(Object(r.a)({},n),e)}}),Object.defineProperty(t,"getContext",{enumerable:!1,value:function(){return Object(r.a)({},n)}}),t}(t.context,function(e){var t={variables:e.variables||{},extensions:e.extensions||{},operationName:e.operationName,query:e.query};return t.operationName||(t.operationName="string"!=typeof t.query?Object(a.g)(t.query)||void 0:""),t}(function(e){for(var t=["query","operationName","variables","extensions","context"],n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];if(t.indexOf(i)<0)throw new o.a(26)}return e}(t))))||i.a.of()},e.concat=function(t,n){var r=c(t);if(u(r))return r;var o=c(n);return u(o)?new e((function(e){return r.request(e,(function(e){return o.request(e)||i.a.of()}))||i.a.of()})):new e((function(e,t){return r.request(e,(function(e){return o.request(e,t)||i.a.of()}))||i.a.of()}))},e.prototype.split=function(t,n,r){return this.concat(e.split(t,n,r||new e(s)))},e.prototype.concat=function(t){return e.concat(this,t)},e.prototype.request=function(e,t){throw new o.a(21)},e.prototype.onError=function(e,t){if(t&&t.error)return t.error(e),!1;throw e},e.prototype.setOnError=function(e){return this.onError=e,this},e}()},725:function(e,t,n){"use strict";var r=n(25),o=n(68),i=n(212),a=n(207),s=n(749),c=n(496),u=Object.prototype.toString;function l(e){return function e(t,n){switch(u.call(t)){case"[object Array]":if((n=n||new Map).has(t))return n.get(t);var r=t.slice(0);return n.set(t,r),r.forEach((function(t,o){r[o]=e(t,n)})),r;case"[object Object]":if((n=n||new Map).has(t))return n.get(t);var o=Object.create(Object.getPrototypeOf(t));return n.set(t,o),Object.keys(t).forEach((function(r){o[r]=e(t[r],n)})),o;default:return t}}(e)}var d=n(1308),f=n(439),p=n(1074),m=n(1591),h=function(){function e(e,t,n,r){this.observer=e,this.options=t,this.fetch=n,this.shouldFetch=r}return e.prototype.reobserve=function(e,t){e?this.updateOptions(e):this.updatePolling();var n=this.fetch(this.options,t);return this.concast&&this.concast.removeObserver(this.observer,!0),n.addObserver(this.observer),(this.concast=n).promise},e.prototype.updateOptions=function(e){return Object.assign(this.options,Object(m.a)(e)),this.updatePolling(),this},e.prototype.stop=function(){this.concast&&(this.concast.removeObserver(this.observer),delete this.concast),this.pollingInfo&&(clearTimeout(this.pollingInfo.timeout),this.options.pollInterval=0,this.updatePolling())},e.prototype.updatePolling=function(){var e=this,t=this.pollingInfo,n=this.options.pollInterval;if(n){if((!t||t.interval!==n)&&(Object(o.b)(n,20),!1!==this.shouldFetch)){(t||(this.pollingInfo={})).interval=n;var r=function(){e.pollingInfo&&(e.shouldFetch&&e.shouldFetch()?e.reobserve({fetchPolicy:"network-only",nextFetchPolicy:e.options.fetchPolicy||"cache-first"},a.a.poll).then(i,i):i())},i=function(){var t=e.pollingInfo;t&&(clearTimeout(t.timeout),t.timeout=setTimeout(r,t.interval))};i()}}else t&&(clearTimeout(t.timeout),delete this.pollingInfo)},e}();n.d(t,"a",(function(){return g}));var g=function(e){function t(t){var n=t.queryManager,o=t.queryInfo,i=t.options,u=e.call(this,(function(e){return u.onSubscribe(e)}))||this;u.observers=new Set,u.subscriptions=new Set,u.observer={next:function(e){(u.lastError||u.isDifferentFromLastResult(e))&&(u.updateLastResult(e),Object(s.a)(u.observers,"next",e))},error:function(e){u.updateLastResult(Object(r.a)(Object(r.a)({},u.lastResult),{error:e,errors:e.graphQLErrors,networkStatus:a.a.error,loading:!1})),Object(s.a)(u.observers,"error",u.lastError=e)}},u.isTornDown=!1,u.options=i,u.queryId=n.generateQueryId();var l=Object(c.f)(i.query);return u.queryName=l&&l.name&&l.name.value,u.queryManager=n,u.queryInfo=o,u}return Object(r.c)(t,e),Object.defineProperty(t.prototype,"variables",{get:function(){return this.options.variables},enumerable:!1,configurable:!0}),t.prototype.result=function(){var e=this;return new Promise((function(t,n){var r={next:function(n){t(n),e.observers.delete(r),e.observers.size||e.queryManager.removeQuery(e.queryId),setTimeout((function(){o.unsubscribe()}),0)},error:n},o=e.subscribe(r)}))},t.prototype.getCurrentResult=function(e){void 0===e&&(e=!0);var t=this.lastResult,n=this.queryInfo.networkStatus||t&&t.networkStatus||a.a.ready,o=Object(r.a)(Object(r.a)({},t),{loading:Object(a.b)(n),networkStatus:n});if(this.isTornDown)return o;var i=this.options.fetchPolicy,s=void 0===i?"cache-first":i;if("no-cache"===s||"network-only"===s)delete o.partial;else if(!o.data||!this.queryManager.transform(this.options.query).hasForcedResolvers){var c=this.queryInfo.getDiff();o.data=c.complete||this.options.returnPartialData?c.result:void 0,c.complete?(o.networkStatus!==a.a.loading||"cache-first"!==s&&"cache-only"!==s||(o.networkStatus=a.a.ready,o.loading=!1),delete o.partial):o.partial=!0}return e&&this.updateLastResult(o),o},t.prototype.isDifferentFromLastResult=function(e){return!Object(i.a)(this.lastResultSnapshot,e)},t.prototype.getLastResult=function(){return this.lastResult},t.prototype.getLastError=function(){return this.lastError},t.prototype.resetLastResults=function(){delete this.lastResult,delete this.lastResultSnapshot,delete this.lastError,this.isTornDown=!1},t.prototype.resetQueryStoreErrors=function(){this.queryManager.resetErrors(this.queryId)},t.prototype.refetch=function(e){var t={pollInterval:0},n=this.options.fetchPolicy;return"no-cache"!==n&&"cache-and-network"!==n&&(t.fetchPolicy="network-only",t.nextFetchPolicy=n||"cache-first"),e&&!Object(i.a)(this.options.variables,e)&&(t.variables=this.options.variables=Object(r.a)(Object(r.a)({},this.options.variables),e)),this.newReobserver(!1).reobserve(t,a.a.refetch)},t.prototype.fetchMore=function(e){var t=this,n=Object(r.a)(Object(r.a)({},e.query?e:Object(r.a)(Object(r.a)(Object(r.a)({},this.options),e),{variables:Object(r.a)(Object(r.a)({},this.options.variables),e.variables)})),{fetchPolicy:"no-cache"}),o=this.queryManager.generateQueryId();return n.notifyOnNetworkStatusChange&&(this.queryInfo.networkStatus=a.a.fetchMore,this.observe()),this.queryManager.fetchQuery(o,n,a.a.fetchMore).then((function(r){var o=r.data,i=e.updateQuery;return i?t.updateQuery((function(e){return i(e,{fetchMoreResult:o,variables:n.variables})})):t.queryManager.cache.writeQuery({query:n.query,variables:n.variables,data:o}),r})).finally((function(){t.queryManager.stopQuery(o),t.reobserve()}))},t.prototype.subscribeToMore=function(e){var t=this,n=this.queryManager.startGraphQLSubscription({query:e.document,variables:e.variables,context:e.context}).subscribe({next:function(n){var r=e.updateQuery;r&&t.updateQuery((function(e,t){var o=t.variables;return r(e,{subscriptionData:n,variables:o})}))},error:function(t){e.onError&&e.onError(t)}});return this.subscriptions.add(n),function(){t.subscriptions.delete(n)&&n.unsubscribe()}},t.prototype.setOptions=function(e){return this.reobserve(e)},t.prototype.setVariables=function(e){if(Object(i.a)(this.variables,e))return this.observers.size?this.result():Promise.resolve();if(this.options.variables=e,!this.observers.size)return Promise.resolve();var t=this.options.fetchPolicy,n=void 0===t?"cache-first":t,r={fetchPolicy:n,variables:e};return"cache-first"!==n&&"no-cache"!==n&&"network-only"!==n&&(r.fetchPolicy="cache-and-network",r.nextFetchPolicy=n),this.reobserve(r,a.a.setVariables)},t.prototype.updateQuery=function(e){var t,n=this.queryManager,r=e(n.cache.diff({query:this.options.query,variables:this.variables,previousResult:null===(t=this.lastResult)||void 0===t?void 0:t.data,returnPartialData:!0,optimistic:!1}).result,{variables:this.variables});r&&(n.cache.writeQuery({query:this.options.query,data:r,variables:this.variables}),n.broadcastQueries())},t.prototype.startPolling=function(e){this.getReobserver().updateOptions({pollInterval:e})},t.prototype.stopPolling=function(){this.reobserver&&this.reobserver.updateOptions({pollInterval:0})},t.prototype.updateLastResult=function(e){var t=this.lastResult;return this.lastResult=e,this.lastResultSnapshot=this.queryManager.assumeImmutableResults?e:l(e),Object(d.a)(e.errors)||delete this.lastError,t},t.prototype.onSubscribe=function(e){var t=this;if(e===this.observer)return function(){};try{var n=e._subscription._observer;n&&!n.error&&(n.error=v)}catch(e){}var r=!this.observers.size;return this.observers.add(e),this.lastError?e.error&&e.error(this.lastError):this.lastResult&&e.next&&e.next(this.lastResult),r&&this.reobserve().catch((function(e){})),function(){t.observers.delete(e)&&!t.observers.size&&t.tearDownQuery()}},t.prototype.getReobserver=function(){return this.reobserver||(this.reobserver=this.newReobserver(!0))},t.prototype.newReobserver=function(e){var t=this,n=this.queryManager,o=this.queryId;return n.setObservableQuery(this),new h(this.observer,e?this.options:Object(r.a)({},this.options),(function(e,r){return n.setObservableQuery(t),n.fetchQueryObservable(o,e,r)}),!n.ssrMode&&function(){return!Object(a.b)(t.queryInfo.networkStatus)})},t.prototype.reobserve=function(e,t){return this.isTornDown=!1,this.getReobserver().reobserve(e,t)},t.prototype.observe=function(){this.observer.next(this.getCurrentResult(!1))},t.prototype.hasObservers=function(){return this.observers.size>0},t.prototype.tearDownQuery=function(){this.isTornDown||(this.reobserver&&(this.reobserver.stop(),delete this.reobserver),this.subscriptions.forEach((function(e){return e.unsubscribe()})),this.subscriptions.clear(),this.queryManager.stopQuery(this.queryId),this.observers.clear(),this.isTornDown=!0)},t}(f.a);function v(e){}Object(p.a)(g)},726:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(1017),o=n(976);const i={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:r.a.None,members:[]};function a(e,t){return Object.assign(Object.assign({},i),{isValid:!0,displayText:Object(o.a)(e,t)})}},727:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(4);const o=new r.b(()=>n.e(850).then(n.bind(null,1569)));let i=new r.a(o,e=>e.initOwaAccountSourceListStore),a=new r.a(o,e=>e.addConnectedAccount),s=new r.a(o,e=>e.removeConnectedAccount),c=new r.a(o,e=>e.updateConnectedAccountState)},728:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const r=["\t","\n","\v","\f","\r"," ","","","","","","","","","","","","","","","\u2028","\u2029","","","","","","","","","","\u2028","\u2029","","","","","","","","","","",""];let o=null;const i=e=>{if(!e)return!0;return null===o&&(o=new Set,r.forEach(e=>o.add(e))),e.split("").every(e=>o.has(e))}},729:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(645);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=10,a=2;function s(e){return c(e,[])}function c(e,t){switch(o(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var n=[].concat(t,[e]),o=function(e){var t=e[String(r.a)];if("function"==typeof t)return t;if("function"==typeof e.inspect)return e.inspect}(e);if(void 0!==o){var s=o.call(e);if(s!==e)return"string"==typeof s?s:c(s,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>a)return"[Array]";for(var n=Math.min(i,e.length),r=e.length-n,o=[],s=0;s<n;++s)o.push(c(e[s],t));1===r?o.push("... 1 more item"):r>1&&o.push("... ".concat(r," more items"));return"["+o.join(", ")+"]"}(e,n);return function(e,t){var n=Object.keys(e);if(0===n.length)return"{}";if(t.length>a)return"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var n=e.constructor.name;if("string"==typeof n&&""!==n)return n}return t}(e)+"]";return"{ "+n.map((function(n){return n+": "+c(e[n],t)})).join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}},7340:function(e,t,n){"use strict";var r=n(8524),o=n(2648),i=n(7010),a=n(1810);function s(e,t){const n=Object(a.E)("Persistent",e,t);!n||e&&n.hostItemIndex!==e||Object(a.hb)("Persistent",e,t)}var c=n(8846),u=n(0),l=n(173),d=n(23),f=n(6451),p=n(6),m=n(10529),h=n(2374),g=n(11812),v=n.n(g),y=Object(d.a)((function(e){return u.createElement("div",{className:v.a.divContainer},u.createElement("div",null,Object(p.b)(f.b)," ",u.createElement("a",{href:"",onClick:t=>{t.stopPropagation(),t.preventDefault(),e.onClickUninstall&&e.onClickUninstall(),Object(h.a)()}},Object(p.b)(f.a))))})),b=n(617),O=n(1264),S=n(6573),C=n(1148),A=n(334),_=n(3533),I=n(7006),x=n(7011),E=(n(3572),n(11815)),T=n.n(E);var w=Object(d.a)((function(e){const t=u.useRef(),n=()=>{t.current.focus()},r=Object(a.u)();if(!r.runningContextualAddinCommand)return u.createElement("div",null);const o=r.contextualCalloutState.contextualAnchor,{hostItemIndex:i,addinCommand:s}=r.runningContextualAddinCommand,c=s,l=(d=r.contextualCalloutState.activeContextualAddinCommands,f=c,d.map(e=>{const t=e.get_Id()===f.get_Id();return{key:e.get_Id(),className:t&&T.a.selected,text:e.detectedEntity.Label,onClick:k(e)}}));var d,f;const p={height:c.detectedEntity.RequestedHeight?c.detectedEntity.RequestedHeight+"px":"350px"},m={};m[13]=n,m[14]=n,m[15]=M;const h=Object(I.f)(c)?u.createElement(y,{onClickUninstall:M}):u.createElement(x.a,{addinCommand:r.runningContextualAddinCommand.addinCommand,controlId:r.runningContextualAddinCommand.controlId,hostItemIndex:i,manifestCacheProvider:S.a,style:p,notifyHostActions:m});return u.createElement(C.a,{gapSpace:0,target:o,onDismiss:M,setInitialFocus:!0,calloutWidth:parseInt("570px"),beakWidth:19,className:T.a.divContainer},u.createElement(A.a,{className:T.a.appIcon,iconName:"OfficeAddinsLogo"}),u.createElement("div",{className:T.a.divider}),u.createElement(_.a,{componentRef:e=>{t.current=e},items:l,className:T.a.contextualBar,onRenderItem:j,onRenderOverflowButton:P}),u.createElement("div",{className:T.a.contextualAddinFrame},h))}));function M(){const{runningContextualAddinCommand:e,activeDialogs:t,contextualCalloutState:n}=Object(a.u)(),{hostItemIndex:r}=e;t.get(r)||(n.contextualAnchor.focus(),Object(a.fb)())}function k(e){return()=>{const{hostItemIndex:t,addinCommand:n}=Object(a.u)().runningContextualAddinCommand;e.get_Id()!==n.get_Id()&&Object(m.a)(t,e)}}function j(e){return u.createElement(b.a,{className:e.className,onClick:e.onClick,text:e.text,ariaLabel:e.text})}function P(e){return u.createElement(O.a,{menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:Object(p.b)(f.c)})}var R=n(11817),N=n(395),D=n(1563),F=n(517),L=n(4456),U=n(1900),B=n(6452),H=n(11818),V=n.n(H),z=Object(d.a)((function(e){const t=u.useContext(U.a),n=Object(B.a)(t),r=Object(a.u)().frameworkComponentHostItemIndexMap.get(n),o=r?r.hostItemIndex:null,i=Object(a.o)(t,o),s=Object(a.u)().activeDialogs.get(i),c=u.useCallback(()=>W(s.parentControlId),[null==s?void 0:s.parentControlId]);if(!s)return u.createElement("div",{className:V.a.divContainer});if(s.isOpen&&1==s.dialogType){const e=Object(a.m)(s.parentControlId),t=null==e?void 0:e.get_ExtensionDisplayName(),n={height:s.heightInPercentage+"vh",width:s.widthInPercentage+"vw",overflow:"hidden"};let r=Object(p.b)(R.a);r&&(r=r.replace("{0}",t));const o={};return o[15]=W,u.createElement(D.a,{responsiveMode:N.a.small,hidden:!s.isOpen,onDismiss:c,dialogContentProps:{type:F.a.close,title:t,closeButtonAriaLabel:r},modalProps:{isBlocking:!0,containerClassName:V.a.dialogContainer},forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},u.createElement(x.a,{addinCommand:e,controlId:s.controlId,isDialog:!0,hostItemIndex:s.hostItemIndex,sourceLocation:s.url,manifestCacheProvider:S.b,notifyHostActions:o,style:n}))}return u.createElement("div",{className:V.a.divContainer})}));function W(e){Object(L.j)({eventDispId:L.a.DISPLAY_DIALOG_DISPID,controlId:e})}var G=n(10199),q=n(11830),K=n.n(q),X=Object(d.a)((function(e){const t=u.useContext(U.a),n=Object(a.o)(t,e.hostItemIndex),r=a.j.activeDialogs.get(n);let o=!1;r&&r.parentControlId==e.controlId&&2==r.dialogType&&(o=!0);const i=e.addinCommand,s=i.get_ConsentState(),c=i.get_Type(),l=2!=s&&"Preinstalled"==c?K.a.consentContainer:K.a.uiLessContainer,d=o?"":K.a.hiddenContainer;return u.createElement(D.a,{hidden:!1,onDismiss:()=>{Object(L.j)({eventDispId:L.a.DIALOG_NOTIFICATION_SHOWN_IN_ADDIN_DISPID,controlId:e.controlId})},dialogContentProps:{type:F.a.normal,title:i.get_ExtensionDisplayName()},modalProps:{isBlocking:o,containerClassName:K.a.dialogContainer,className:d},forceFocusInsideTrap:o,containerClassName:K.a.dialogContainer,isClickableOutsideFocusTrap:!0},u.createElement("div",{className:l},e.children))})),Q=n(1),J=n(11832),Y=n(906),Z=n(5241),$=n(3643),ee=n(11833),te=n.n(ee);let ne=class extends u.Component{constructor(e,t){super(e,t),this.addDisplayNotification=e=>{Object(Z.c)(this.props.hostItemIndex,this.props.controlId,!1,`${this.props.extendedAddinCommand.addinCommand.get_Id()}${this.infoBarId++}`,Object(S.d)(e.infoType),e.description,this.props.targetWindow)},this.addGenericErrorNotification=()=>{const e=Object(p.c)(Object(p.b)(J.b),this.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName());Object(Z.c)(this.props.hostItemIndex,this.props.controlId,!1,this.props.extendedAddinCommand.addinCommand.get_Id(),2,e,this.props.targetWindow,this.props.extendedAddinCommand.addinCommand.get_Size16Icon())},this.invokeAppCommand=(e,t)=>{this.props.extendedAddinCommand.addinCommandTelemetry.setExecutionStartTime();let n=this.props.extendedAddinCommand.addinCommand.getControl();e&&(n=e,Object(a.jb)(this.props.controlId));const r=n.Action.FunctionName,o=Object.assign(Object.assign({source:{id:n.Id}},e?t:this.props.extendedAddinCommand.launchEventArgs),{hasExistingCommandInQueue:!!e});this.props.disableProgressBar||this.addProgressNotification(),OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(this.props.controlId,r,o,this.onEventCompleted),Object(a.N)(this.props.extendedAddinCommand.addinCommand)&&Object($.v)(this.props.extendedAddinCommand.addinCommand,this.props.hostItemIndex,this.props.controlId)},this.onEventCompleted=(e,t)=>{const n=t?t.completedContext:void 0,r=Object(a.o)(this.props.targetWindow,this.props.hostItemIndex);Object(a.N)(this.props.extendedAddinCommand.addinCommand)?e!=a.d.TimedOut&&Object(a.U)(this.props.extendedAddinCommand,this.props.controlId,this.props.hostItemIndex,e,this.props.targetWindow,n):(this.props.disableProgressBar||this.removeProgressNotification(),e!=a.d.Success&&Object(a.M)(r)&&this.addGenericErrorNotification(),Object(a.ib)(this.props.controlId,this.props.hostItemIndex,e,this.props.targetWindow,n))},this.infoBarId=0,Object(a.N)(e.extendedAddinCommand.addinCommand)&&Object(a.u)().activeAutorunUilessFrames.set(e.controlId,this)}removeProgressNotification(){Object(Z.m)(this.props.hostItemIndex,this.props.controlId,this.props.extendedAddinCommand.addinCommand.get_Id())}addProgressNotification(){const e=Object(p.c)(Object(p.b)(J.a),this.props.extendedAddinCommand.addinCommand.get_ExtensionDisplayName(),this.props.extendedAddinCommand.addinCommand.get_Label());Object(Z.c)(this.props.hostItemIndex,this.props.controlId,!1,this.props.extendedAddinCommand.addinCommand.get_Id(),1,e,this.props.targetWindow)}render(){const e={};return e[8]=this.addGenericErrorNotification,u.createElement(x.a,{addinCommand:this.props.extendedAddinCommand.addinCommand,addinCommandTelemetry:this.props.extendedAddinCommand.addinCommandTelemetry,controlId:this.props.controlId,hostItemIndex:this.props.hostItemIndex,manifestCacheProvider:S.a,onInsertOsfControl:this.invokeAppCommand,onDisplayNotification:this.addDisplayNotification,notifyHostActions:e,className:te.a.uiLessContainer,targetWindow:this.props.targetWindow})}};ne=Object(Q.__decorate)([Y.observer],ne);var re=ne;var oe=Object(d.a)((function(e){const t=[],n=u.useContext(U.a);return Object(a.u)().runningUILessExtendedAddinCommands.forEach((e,r)=>{const o=JSON.parse(r);e.forEach((e,r)=>{e.addinCommandTelemetry.setExecutionInitTime();const i=e.addinCommand,s=Object(a.N)(i);t.push(u.createElement(X,{hostItemIndex:o.hostItemIndex,controlId:r,addinCommand:i,key:r},u.createElement(re,{extendedAddinCommand:e,controlId:r,hostItemIndex:o.hostItemIndex,disableProgressBar:s,targetWindow:n})))})}),u.createElement("div",null,t)})),ie=n(317),ae=n(9692),se=n(1979);function ce(e,t,n){const r=n.document;let o=Object(B.a)(n),i=r.getElementById(o);null==i?(o=Object(B.b)(n),i=r.createElement("div"),i.id=o,Object(a.rb)(o,t,n),r.body.appendChild(i),l.render(u.createElement(u.StrictMode,null,u.createElement(ie.b,{window:n},u.createElement(U.a.Provider,{value:n},u.createElement(le,{renderTaskPaneInPanel:e})))),i)):Object(a.rb)(o,t,n)}function ue(e=window,t=!1){if(t||e!=window){const n=e.document,r=Object(B.a)(e);let o=n.getElementById(r);if(null==o)return;if(Object(a.rb)(r),l.unmountComponentAtNode(o),n.body.removeChild(o),t){const t=Object(se.a)(e),n=null==t?void 0:t.underlay;Object(ae.a)(n)}}}function le(e){return u.createElement(u.Fragment,null,e.renderTaskPaneInPanel&&u.createElement(G.a,{renderTaskPaneInPanel:!0}),u.createElement(oe,null),u.createElement(w,null),u.createElement(z,null))}var de=n(10530),fe=n(10531),pe=n(138);function me(e){const t=e.map(he);return t.push(function(){const e=Object(fe.a)();return{key:e.key,name:e.name,itemType:e.itemType,iconProps:e.iconProps}}()),t}function he(e){return{key:e.Id,name:e.DisplayName,itemType:pe.a.Normal,iconProps:Object(de.a)(e.IconUrl)}}var ge=n(47),ve=n(7696),ye=n(54);var be=(e,t,n,r)=>{if(!Object(ge.j)("addin-autoRun"))return;const o=Object(a.q)(t).map(e=>new ve.d(e,new ve.b,n));Object(a.e)(o,e,n,r),1==t?function e(t,n,r,o){if(n<1)return;!function(e,t){var n;const r=null===(n=Object(a.E)("Persistent",e,t))||void 0===n?void 0:n.controlId;if(!r)return!1;return!document.getElementById(r)}(t,o)?Object(a.V)(t,o):Object(ye.a)(r).then(()=>{e(t,n-1,r,o)})}(e,3,1e3,n):Object(a.V)(e,n)};n.d(t,"f",(function(){return r.a})),n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return i.a})),n.d(t,"i",(function(){return s})),n.d(t,"g",(function(){return c.a})),n.d(t,"e",(function(){return ce})),n.d(t,"h",(function(){return ue})),n.d(t,"c",(function(){return me})),n.d(t,"d",(function(){return be}))},737:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return v}));var r=n(25),o=n(300),i=n(68),a=n(250),s=n(1113),c=n(586),u=n(187),l=n(525);function d(e){return void 0!==e.args?e.args:e.field?Object(a.a)(e.field,e.variables):null}var f=function(e,t){var n=e.__typename,r=e.id,o=e._id;if("string"==typeof n&&(t&&(t.keyObject=void 0!==r?{id:r}:void 0!==o?{_id:o}:void 0),void 0===r&&(r=o),void 0!==r))return n+":"+("number"==typeof r||"string"==typeof r?r:JSON.stringify(r))},p=function(){},m=function(e,t){return t.fieldName},h=function(e,t,n){return(0,n.mergeObjects)(e,t)},g=function(e,t){return t},v=function(){function e(e){this.config=e,this.typePolicies=Object.create(null),this.toBeAdded=Object.create(null),this.supertypeMap=new Map,this.fuzzySubtypes=new Map,this.rootIdsByTypename=Object.create(null),this.rootTypenamesById=Object.create(null),this.usingPossibleTypes=!1,this.config=Object(r.a)({dataIdFromObject:f},e),this.cache=this.config.cache,this.setRootTypename("Query"),this.setRootTypename("Mutation"),this.setRootTypename("Subscription"),e.possibleTypes&&this.addPossibleTypes(e.possibleTypes),e.typePolicies&&this.addTypePolicies(e.typePolicies)}return e.prototype.identify=function(e,t,n){var r=t&&n?Object(a.c)(e,t,n):e.__typename;if(r===this.rootTypenamesById.ROOT_QUERY)return["ROOT_QUERY"];for(var o,i={typename:r,selectionSet:t,fragmentMap:n},s=r&&this.getTypePolicy(r),c=s&&s.keyFn||this.config.dataIdFromObject;c;){var u=c(e,i);if(!Array.isArray(u)){o=u;break}c=S(u)}return o=o?String(o):void 0,i.keyObject?[o,i.keyObject]:[o]},e.prototype.addTypePolicies=function(e){var t=this;Object.keys(e).forEach((function(n){var o=e[n],i=o.queryType,a=o.mutationType,s=o.subscriptionType,c=Object(r.e)(o,["queryType","mutationType","subscriptionType"]);i&&t.setRootTypename("Query",n),a&&t.setRootTypename("Mutation",n),s&&t.setRootTypename("Subscription",n),u.c.call(t.toBeAdded,n)?t.toBeAdded[n].push(c):t.toBeAdded[n]=[c]}))},e.prototype.updateTypePolicy=function(e,t){var n=this,r=this.getTypePolicy(e),o=t.keyFields,i=t.fields;function a(e,t){e.merge="function"==typeof t?t:!0===t?h:!1===t?g:e.merge}a(r,t.merge),r.keyFn=!1===o?p:Array.isArray(o)?S(o):"function"==typeof o?o:r.keyFn,i&&Object.keys(i).forEach((function(t){var r=n.getFieldPolicy(e,t,!0),o=i[t];if("function"==typeof o)r.read=o;else{var s=o.keyArgs,c=o.read,u=o.merge;r.keyFn=!1===s?m:Array.isArray(s)?O(s):"function"==typeof s?s:r.keyFn,"function"==typeof c&&(r.read=c),a(r,u)}r.read&&r.merge&&(r.keyFn=r.keyFn||m)}))},e.prototype.setRootTypename=function(e,t){void 0===t&&(t=e);var n="ROOT_"+e.toUpperCase(),r=this.rootTypenamesById[n];t!==r&&(Object(i.b)(!r||r===e,1),r&&delete this.rootIdsByTypename[r],this.rootIdsByTypename[t]=n,this.rootTypenamesById[n]=t)},e.prototype.addPossibleTypes=function(e){var t=this;this.usingPossibleTypes=!0,Object.keys(e).forEach((function(n){t.getSupertypeSet(n,!0),e[n].forEach((function(e){t.getSupertypeSet(e,!0).add(n);var r=e.match(u.a);r&&r[0]===e||t.fuzzySubtypes.set(e,new RegExp(e))}))}))},e.prototype.getTypePolicy=function(e){var t=this;if(!u.c.call(this.typePolicies,e)){var n=this.typePolicies[e]=Object.create(null);n.fields=Object.create(null);var o=this.supertypeMap.get(e);o&&o.size&&o.forEach((function(e){var o=t.getTypePolicy(e),i=o.fields,a=Object(r.e)(o,["fields"]);Object.assign(n,a),Object.assign(n.fields,i)}))}var i=this.toBeAdded[e];return i&&i.length&&i.splice(0).forEach((function(n){t.updateTypePolicy(e,n)})),this.typePolicies[e]},e.prototype.getFieldPolicy=function(e,t,n){if(e){var r=this.getTypePolicy(e).fields;return r[t]||n&&(r[t]=Object.create(null))}},e.prototype.getSupertypeSet=function(e,t){var n=this.supertypeMap.get(e);return!n&&t&&this.supertypeMap.set(e,n=new Set),n},e.prototype.fragmentMatches=function(e,t,n,r){var o=this;if(!e.typeCondition)return!0;if(!t)return!1;var i=e.typeCondition.name.value;if(t===i)return!0;if(this.usingPossibleTypes&&this.supertypeMap.has(i))for(var a=this.getSupertypeSet(t,!0),s=[a],c=function(e){var t=o.getSupertypeSet(e,!1);t&&t.size&&s.indexOf(t)<0&&s.push(t)},l=!(!n||!this.fuzzySubtypes.size),d=0;d<s.length;++d){var f=s[d];if(f.has(i))return a.has(i)||a.add(i),!0;f.forEach(c),l&&d===s.length-1&&Object(u.e)(e.selectionSet,n,r)&&(l=!1,!0,this.fuzzySubtypes.forEach((function(e,n){var r=t.match(e);r&&r[0]===t&&c(n)})))}return!1},e.prototype.hasKeyArgs=function(e,t){var n=this.getFieldPolicy(e,t,!1);return!(!n||!n.keyFn)},e.prototype.getStoreFieldName=function(e){var t,n=e.typename,r=e.fieldName,o=this.getFieldPolicy(n,r,!1),i=o&&o.keyFn;if(i&&n)for(var s={typename:n,fieldName:r,field:e.field||null,variables:e.variables},c=d(e);i;){var l=i(c,s);if(!Array.isArray(l)){t=l||r;break}i=O(l)}return void 0===t&&(t=e.field?Object(a.i)(e.field,e.variables):Object(a.b)(r,d(e))),!1===t?r:r===Object(u.b)(t)?t:r+":"+t},e.prototype.readField=function(e,t){var n=e.from;if(n&&(e.field||e.fieldName)){if(void 0===e.typename){var r=t.store.getFieldValue(n,"__typename");r&&(e.typename=r)}var o=this.getStoreFieldName(e),i=Object(u.b)(o),s=t.store.getFieldValue(n,o),c=this.getFieldPolicy(e.typename,i,!1),d=c&&c.read;if(d){var f=y(this,n,e,t,t.store.getStorage(Object(a.f)(n)?n.__ref:n,o));return l.a.withValue(this.cache,d,[s,f])}return s}},e.prototype.getMergeFunction=function(e,t,n){var r=this.getFieldPolicy(e,t,!1),o=r&&r.merge;return!o&&n&&(o=(r=this.getTypePolicy(n))&&r.merge),o},e.prototype.runMergeFunction=function(e,t,n,r,o){var i=n.field,a=n.typename,s=n.merge;return s===h?b(r.store.getFieldValue)(e,t):s===g?t:s(e,t,y(this,void 0,{typename:a,fieldName:i.name.value,field:i,variables:r.variables},r,o||Object.create(null)))},e}();function y(e,t,n,o,i){var s=e.getStoreFieldName(n),c=Object(u.b)(s),l=n.variables||o.variables,f=o.store,p=f.getFieldValue,m=f.toReference,h=f.canRead;return{args:d(n),field:n.field||null,fieldName:c,storeFieldName:s,variables:l,isReference:a.f,toReference:m,storage:i,cache:e.cache,canRead:h,readField:function(n,i){var a="string"==typeof n?{fieldName:n,from:i}:Object(r.a)({},n);return void 0===a.from&&(a.from=t),void 0===a.variables&&(a.variables=l),e.readField(a,o)},mergeObjects:b(p)}}function b(e){return function(t,n){if(Array.isArray(t)||Array.isArray(n))throw new i.a(2);if(t&&"object"==typeof t&&n&&"object"==typeof n){var o=e(t,"__typename"),a=e(n,"__typename");return!(o&&a&&o!==a)&&Object(u.f)(t)&&Object(u.f)(n)?Object(r.a)(Object(r.a)({},t),n):n}return n}}function O(e){return function(t,n){return t?n.fieldName+":"+JSON.stringify(C(t,e,!1)):n.fieldName}}function S(e){var t=new o.a(s.a);return function(n,r){var o;if(r.selectionSet&&r.fragmentMap){var i=t.lookupArray([r.selectionSet,r.fragmentMap]);o=i.aliasMap||(i.aliasMap=function e(t,n){var r=Object.create(null),o=new Set([t]);return o.forEach((function(t){t.selections.forEach((function(t){if(Object(a.d)(t)){if(t.alias){var i=t.alias.value,s=t.name.value;if(s!==i)(r.aliases||(r.aliases=Object.create(null)))[s]=i}if(t.selectionSet)(r.subsets||(r.subsets=Object.create(null)))[t.name.value]=e(t.selectionSet,n)}else{var u=Object(c.b)(t,n);u&&o.add(u.selectionSet)}}))})),r}(r.selectionSet,r.fragmentMap))}var s=r.keyObject=C(n,e,!0,o);return r.typename+":"+JSON.stringify(s)}}function C(e,t,n,r){var o,a=Object.create(null);return t.forEach((function(t){if(Array.isArray(t)){if("string"==typeof o){var s=r&&r.subsets,c=s&&s[o];a[o]=C(e[o],t,n,c)}}else{var l=r&&r.aliases,d=l&&l[t]||t;u.c.call(e,d)?a[o=t]=e[d]:(Object(i.b)(!n,3),o=void 0)}})),a}},743:function(e,t,n){"use strict";function r(e){var t=e.split(/\r\n|[\n\r]/g),n=i(e);if(0!==n)for(var r=1;r<t.length;r++)t[r]=t[r].slice(n);for(var a=0;a<t.length&&o(t[a]);)++a;for(var s=t.length;s>a&&o(t[s-1]);)--s;return t.slice(a,s).join("\n")}function o(e){for(var t=0;t<e.length;++t)if(" "!==e[t]&&"\t"!==e[t])return!1;return!0}function i(e){for(var t,n=!0,r=!0,o=0,i=null,a=0;a<e.length;++a)switch(e.charCodeAt(a)){case 13:10===e.charCodeAt(a+1)&&++a;case 10:n=!1,r=!0,o=0;break;case 9:case 32:++o;break;default:r&&!n&&(null===i||o<i)&&(i=o),r=!1}return null!==(t=i)&&void 0!==t?t:0}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1===e.indexOf("\n"),o=" "===e[0]||"\t"===e[0],i='"'===e[e.length-1],a="\\"===e[e.length-1],s=!r||i||a||n,c="";return!s||r&&o||(c+="\n"+t),c+=t?e.replace(/\n/g,"\n"+t):e,s&&(c+="\n"),'"""'+c.replace(/"""/g,'\\"""')+'"""'}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a}))},744:function(e,t,n){"use strict";var r=n(3);const o=Object(r.action)("POPOUT_READING_PANE",(e,t,n,r,o)=>({itemId:e,conversationId:t,internetMessageId:n,mailboxInfo:r,data:o}));t.a=o},745:function(e){e.exports=JSON.parse('{"a":"t3b","b":"u3b"}')},746:function(e,t,n){var r=n(1275);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},749:function(e,t,n){"use strict";function r(e,t,n){var r=[];e.forEach((function(e){return e[t]&&r.push(e)})),r.forEach((function(e){return e[t](n)}))}n.d(t,"a",(function(){return r}))},750:function(e,t,n){"use strict";function r(e,t){if(!Boolean(e))throw new Error(t)}n.d(t,"a",(function(){return r}))},754:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(50),o={label:r.p,audio:r.b,video:r.z,ol:r.r,li:r.q,a:r.a,button:r.e,input:r.o,textarea:r.w,select:r.t,option:r.s,table:r.u,tr:r.y,th:r.x,td:r.v,colGroup:r.f,col:r.g,form:r.i,iframe:r.l,img:r.n};function i(e,t,n){var i=e&&o[e]||r.k;return Object(r.j)(t,i,n)}},7684:function(e,t,n){"use strict";var r=n(1797);class o{constructor(e){this.addinFactory=e}activate(e){return new Promise((t,n)=>{const o=new Map;Object.values(r.a).filter(e=>isNaN(Number(r.a[e]))).forEach(t=>{o.set(t,[]),e.forEach(e=>{const n=this.addinFactory.CreateAddinIfEntryPointSupported(e,t);n&&o.get(t).push(n)})}),t(o)})}}var i=n(4149),a=n(7340);var s=n(1810),c=n(7696),u=n(4956);function l(e,t){const n=new c.c;return t.activate(e).then(e=>{Object.values(r.a).forEach(t=>{n.setExtensionPoint(e.get(t),t)})}).then(()=>{n.isInitialized=!0,Object(s.Z)(n),function(e){const t={};[r.a.MessageRead,r.a.MessageCompose,r.a.AppointmentAttendee,r.a.AppointmentOrganizer].forEach(n=>{const r=e.getExtensionPoint(n);t[n]=Object(a.c)(r)}),Object(i.n)(t)}(n);const t=e.map(e=>e.Id);Object(u.g)(t)})}var d=n(6797),f=n(5767),p=n(47),m=n(36),h=n(9);const g="previousAdminAddins";function v(e){let t=[];for(const n of e){let e={addinId:n};t.push(e)}Object(h.e)(window,g,JSON.stringify(t))}var y=n(38);const b=864e5;function O(e){let t=function(e){let t=[];for(const n of e)if(n.Enabled&&n.ExtensionPointCollection&&"Organization"===n.OriginString){let e=n.Id.toLowerCase();t.push(e)}return t}(e);if(!Object(h.b)(window,g))return v(t),function(){let e=new Date(Object(y.a)().MailboxCreateDate);return Date.now()-e.getTime()<b}()||Object(p.j)("addin-exp-testPinOldAdminAddins")?t:[];let n=function(){const e=Object(h.a)(window,g);if(!e)return[];let t;try{t=JSON.parse(e)}catch(t){return m.h.warn("Unable to parse adminAddins data: "+e),[]}return t.map(e=>e.addinId)}(),r=t.filter(e=>n.indexOf(e)<0);return v(t),r}var S=n(3643);var C=n(1686),A=n(3);let _=Object(A.action)("updateMailSurfaceOptions",(e,t,n)=>({mailOptions:e,mailReadSurfaceAddinsToPin:t,mailComposeSurfaceAddinsToPin:n}));Object(A.mutator)(_,e=>{for(const t of e.mailReadSurfaceAddinsToPin)e.mailOptions.readSurfaceAddins.push(t),Object(S.s)(t,!0,r.a.MessageRead);for(const t of e.mailComposeSurfaceAddinsToPin)e.mailOptions.composeSurfaceAddins.push(t),Object(S.s)(t,!0,r.a.MessageCompose);C.i.importAndExecute(C.d.SurfaceActions,e.mailOptions)});var I=_;let x=Object(A.action)("updateCalendarSurfaceOptions",(e,t)=>({calendarOptions:e,calendarSurfaceAddinsToPin:t}));Object(A.mutator)(x,e=>{for(const t of e.calendarSurfaceAddinsToPin)e.calendarOptions.calendarSurfaceAddins.push(t),Object(S.s)(t,!0,r.a.AppointmentOrganizer);C.i.importAndExecute(C.d.CalendarSurfaceAddins,e.calendarOptions)});var E=x;async function T(e,t){if(t.length<=0)return;let n=await C.j.import(),o=await n(C.d.SurfaceActions),i=function(e,t,n){if(n.length>=3)return[];let o,i=n.length,a=[];for(const c of t){const t=c.toLowerCase();if(i>=3)break;if(!n.includes(t))for(const n of e){if(t!=n.Id.toLowerCase())continue;if(!n.ExtensionPointCollection)continue;if(Object(s.x)(n.ExtensionPointCollection,r.a.MessageRead)){a.push(t),++i,o?Object(S.t)(c,"NewAdminDeployment","MissNotSelected",r.a.MessageRead):o=t;break}}}return Object(s.tb)(o),a}(e,t,o.readSurfaceAddins),a=function(e,t,n){if(n.length>=3)return[];let o,i=n.length,a=[];for(const c of t){const t=c.toLowerCase();if(i>=3)break;if(!n.includes(t))for(const n of e){if(t!=n.Id.toLowerCase())continue;if(!n.ExtensionPointCollection)continue;if(Object(s.x)(n.ExtensionPointCollection,r.a.MessageCompose)){a.push(t),++i,o?Object(S.t)(c,"NewAdminDeployment","MissNotSelected",r.a.MessageCompose):o=t;break}}}return Object(s.sb)(o),a}(e,t,o.composeSurfaceAddins),c=await n(C.d.CalendarSurfaceAddins),u=function(e,t,n){if(n.length>=3)return[];let o,i=n.length,a=[];for(const c of t){const t=c.toLowerCase();if(i>=3)break;if(!n.includes(t))for(const n of e){if(t!=n.Id.toLowerCase())continue;if(!n.ExtensionPointCollection)continue;let e=Object(s.x)(n.ExtensionPointCollection,r.a.AppointmentAttendee),u=Object(s.x)(n.ExtensionPointCollection,r.a.AppointmentOrganizer);if(e||u){a.push(t),++i,o?Object(S.t)(c,"NewAdminDeployment","MissNotSelected",r.a.AppointmentOrganizer):o=t;break}}}return Object(s.mb)(o),a}(e,t,c.calendarSurfaceAddins);(i.length>0||a.length>0)&&I(o,i,a),u.length>0&&E(c,u)}let w=[],M=[],k=[],j=[];async function P(e){const t=function(e){let t=[];for(const n of e)if(n.Enabled&&n.ExtensionPointCollection&&"Organization"===n.OriginString){let e=n.Id.toLowerCase();n.ExtensionPointCollection.MessageReadCommandSurface&&(null==w||w.push(e)),n.ExtensionPointCollection.MessageComposeCommandSurface&&(null==M||M.push(e)),n.ExtensionPointCollection.AppointmentOrganizerCommandSurface&&(null==k||k.push(e)),n.ExtensionPointCollection.AppointmentAttendeeCommandSurface&&(null==j||j.push(e)),t.push(e)}return t}(e);if(!t)return;const n=await C.j.import(),o=await n(C.d.SurfaceActions),i=R(r.a.MessageRead,t,o.readSurfaceAddins);i.length>0&&Object(s.wb)(i,r.a.MessageRead);const a=R(r.a.MessageCompose,t,o.composeSurfaceAddins);a.length>0&&Object(s.wb)(a,r.a.MessageCompose);let c=await n(C.d.CalendarSurfaceAddins);const u=R(r.a.AppointmentOrganizer,t,c.calendarSurfaceAddins);u.length>0&&Object(s.wb)(u,r.a.AppointmentOrganizer);const l=R(r.a.AppointmentAttendee,t,c.calendarSurfaceAddins);l.length>0&&Object(s.wb)(l,r.a.AppointmentAttendee)}function R(e,t,n){let o=[],i=[];switch(e){case r.a.MessageRead:i=w.concat();break;case r.a.MessageCompose:case r.a.AppointmentOrganizer:i=M.concat();break;case r.a.AppointmentAttendee:i=j.concat()}if(t.forEach(e=>{i.includes(e)&&o.push(e)}),!n||0==n.length)return o;let a=[];return o.forEach(e=>{n.includes(e)||a.push(e)}),a}var N=n(296);function D(){return!Object(N.a)()}n.d(t,"a",(function(){return L}));let F=!1;function L(){return new Promise(async(e,t)=>{if((F||Object(s.O)())&&!Object(s.P)())return void Object(s.xb)(e);Object(s.bb)(!1),U(!0);let n=[];const r=new o(new s.c(new s.b));let i=null;try{i=await Object(d.a)()}catch(e){m.d(e)}if(Object(s.ab)(i),i=Object(s.t)(),null!==i&&Object(f.a)()&&Object(s.X)(i.GenericInfo),n=function(e){return(null==e?void 0:e.Extensions)?e.Extensions.filter(e=>e.Enabled&&null!=e.ExtensionPointCollection):[]}(i),D()&&(Object(p.j)("addin-exp-findNewAdminAddins")||Object(p.j)("addin-exp-pinNewAdminAddins")||Object(p.j)("addin-exp-pinNewAdminAddinsFRECallout"))){let e=function(e){let t=O(e);if(t.length<=0)return[];Object(s.lb)(!0);for(const e of t)Object(S.r)(e);return t}(n);(Object(p.j)("addin-exp-pinNewAdminAddins")||Object(p.j)("addin-exp-pinNewAdminAddinsFRECallout"))&&T(n,e)}D()&&(Object(p.j)("addin-exp-awarenessNudge")||Object(p.j)("addin-exp-awarenessNudgeCusBtn")||Object(p.j)("addin-exp-awarenessNudgeWaterDropNudge"))&&P(n),await l(n,r),U(!1),e()})}function U(e){F=e}},7696:function(e,t,n){"use strict";var r=n(1810),o=n(1797);class i{constructor(){this.getAutoRunAddinsByLaunchEventType=e=>{const t=this.getAddinsForMode(o.a.LaunchEvent);let n=[],r=[];return n=this.autoRunAddinsIndexMapping.get(e),n&&n.map(e=>{r.push(t[e])}),r},this.setAutoRunAddinsMapping=e=>{e.forEach((e,t)=>{[...e.AddinCommands.values()].forEach(e=>{const n=null==e?void 0:e.getLaunchEventType();n&&this.setAutoRunAddinMapForLaunchEventType(n,t)})})},this.setAutoRunAddinMapForLaunchEventType=(e,t)=>{this.autoRunAddinsIndexMapping.has(e)?this.autoRunAddinsIndexMapping.get(e).push(t):this.autoRunAddinsIndexMapping.set(e,[t])},this.isInitialized=!1,this.appointmentAttendeeAddins=[],this.appointmentOrganizerAddins=[],this.detectedEntityAddins=[],this.messageReadAddins=[],this.messageComposeAddins=[],this.meetingRequestAddins=[],this.eventsAddins=[],this.autoRunAddins=[],this.autoRunAddinsIndexMapping=new Map}getExtensionPoint(e,t){let n=this.getAddinsForMode(e);return t&&n&&(n=Object(r.l)(n)),n}setExtensionPoint(e,t){switch(t){case o.a.MeetingRequest:this.meetingRequestAddins=e;break;case o.a.AppointmentAttendee:this.appointmentAttendeeAddins=e;break;case o.a.AppointmentOrganizer:this.appointmentOrganizerAddins=e;break;case o.a.DetectedEntity:this.detectedEntityAddins=e;break;case o.a.MessageCompose:this.messageComposeAddins=e;break;case o.a.MessageRead:this.messageReadAddins=e;break;case o.a.TrapOnSendEvent:this.eventsAddins=e;break;case o.a.LaunchEvent:this.autoRunAddins=e,this.setAutoRunAddinsMapping(e)}}getAddinsForMode(e){switch(e){case o.a.MeetingRequest:return this.meetingRequestAddins;case o.a.AppointmentAttendee:return this.appointmentAttendeeAddins;case o.a.AppointmentOrganizer:return this.appointmentOrganizerAddins;case o.a.DetectedEntity:return this.detectedEntityAddins;case o.a.MessageCompose:return this.messageComposeAddins;case o.a.MessageRead:return this.messageReadAddins;case o.a.TrapOnSendEvent:return this.eventsAddins;case o.a.LaunchEvent:return this.autoRunAddins;default:return null}}}var a=n(8227);class s{setExecutionInitTime(){this.executionInitTime=Object(a.a)()}setExecutionStartTime(){this.executionStartTime=Object(a.a)()}setExecutionEndTime(){this.executionEndTime=Object(a.a)()}setQueuePushTime(){this.queuePushTime=Object(a.a)()}setQueuePopTime(){this.queuePopTime=Object(a.a)()}getExecutionInitTime(){return this.executionInitTime}getExecutionStartTime(){return this.executionStartTime}getExecutionEndTime(){return this.executionEndTime}getQueuePushTime(){return this.queuePushTime}getQueuePopTime(){return this.queuePopTime}}class c{constructor(e,t,n){this.addinCommand=e,this.addinCommandTelemetry=t,this.controlId=Object(r.N)(e)?null:Object(r.z)(),this.targetWindow=n}}class u{setExecutionInitTime(){this.executionInitTime=Object(a.a)()}setExecutionStartTime(){this.executionStartTime=Object(a.a)()}setExecutionEndTime(){this.executionEndTime=Object(a.a)()}getExecutionInitTime(){return this.executionInitTime}getExecutionStartTime(){return this.executionStartTime}getExecutionEndTime(){return this.executionEndTime}}n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u}))},7713:function(e,t,n){"use strict";var r,o,i,a,s,c,u,l,d,f,p=n(2875);o=r||(r={}),i="Office.System.Result",o.getFields=function(e,t){var n=[];return n.push(Object(p.c)(e+".Code",t.code)),void 0!==t.type&&n.push(Object(p.d)(e+".Type",t.type)),void 0!==t.tag&&n.push(Object(p.c)(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(Object(p.a)(e+".IsExpected",t.isExpected)),n.push(Object(p.d)("zC.Activity.Result",i)),n},(s=a||(a={})).contractName="Office.System.Activity",s.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(Object(p.d)("Activity.CV",e.cV)),t.push(Object(p.c)("Activity.Duration",e.duration)),t.push(Object(p.c)("Activity.Count",e.count)),t.push(Object(p.c)("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(Object(p.a)("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,r.getFields("Activity.Result",e.result)),t.push(Object(p.d)("zC.Activity",s.contractName)),t},(c||(c={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(p.d)(e+".Id",t.id)),void 0!==t.version&&n.push(Object(p.d)(e+".Version",t.version)),void 0!==t.sessionId&&n.push(Object(p.d)(e+".SessionId",t.sessionId)),n},(u||(u={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(Object(p.d)(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(Object(p.d)(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(Object(p.d)(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(Object(p.d)(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(Object(p.d)(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(Object(p.a)(e+".IsAnonymous",t.isAnonymous)),n},(l||(l={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(Object(p.d)(e+".Name",t.name)),void 0!==t.state&&n.push(Object(p.d)(e+".State",t.state)),n},(d||(d={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(Object(p.c)(e+".Id",t.id)),void 0!==t.name&&n.push(Object(p.d)(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(Object(p.d)(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(Object(p.d)(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(Object(p.d)(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(Object(p.c)(e+".TimeOffsetMs",t.timeOffsetMs)),n},function(e){e.getFields=function(e,t){var n=[];return n.push(Object(p.d)(e+".ErrorGroup",t.errorGroup)),n.push(Object(p.c)(e+".Tag",t.tag)),void 0!==t.code&&n.push(Object(p.c)(e+".Code",t.code)),void 0!==t.id&&n.push(Object(p.c)(e+".Id",t.id)),void 0!==t.count&&n.push(Object(p.c)(e+".Count",t.count)),n}}(f||(f={})),n.d(t,"a",(function(){return m}));var m,h=a,g=r,v=f,y=l,b=c,O=d,S=u;!function(e){!function(e){!function(e){e.Activity=h,e.Result=g,e.Error=v,e.Funnel=y,e.Host=b,e.User=S,e.UserAction=O}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(m||(m={}))},7761:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(4304),o=n(5366),i=((Object(o.a)()||{}).Symbol,(Object(o.a)()||{}).Reflect,r.a||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])r.f[r.i].call(t,i)&&(e[i]=t[i]);return e}),a=function(e,t){return(a=r.b.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t[r.i](n)&&(e[n]=t[n])})(e,t)};function s(e,t){function n(){this.constructor=e}typeof t!==r.h&&null!==t&&Object(o.c)("Class extends value "+String(t)+" is not a constructor or null"),a(e,t),e[r.k]=null===t?Object(o.b)(t):(n[r.k]=t[r.k],new n)}function c(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e}},7762:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return h}));var r,o=n(4304),i=n(5366),a=n(4623),s=n(3226),c=n(2285),u=n(5367),l=null;o.l;function d(e,t){var n=!1,r=Object(s.k)();r&&(n=Object(c.e)(r,e,t),n=Object(c.e)(r.body,e,t)||n);var o=Object(s.d)();return o&&(n=Object(c.e)(o,e,t)||n),n}function f(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(v,(function(e){var t=0|Object(u.d)(15);return("x"===e?t:3&t|8).toString(16)}))}function p(){var e=Object(s.j)();return e&&e.now?e.now():Object(c.f)()}function m(e){void 0===e&&(e=22);for(var t=Object(u.c)()>>>0,n=0,r="";r.length<e;)n++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===n&&(t=(Object(u.c)()<<2&4294967295|3&t)>>>0,n=0);return r}function h(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",r=0;r<4;r++)n+=t[15&(e=Object(u.c)())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var o=t[8+(3&Object(u.c)())|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+o+n.substr(16,3)+n.substr(19,12)}var g={_canUseCookies:void 0,isTypeof:c.w,isUndefined:c.x,isNullOrUndefined:c.r,hasOwnProperty:c.j,isFunction:c.o,isObject:c.t,isDate:c.m,isArray:c.k,isError:c.n,isString:c.u,isNumber:c.s,isBoolean:c.l,toISOString:c.J,arrForEach:c.a,arrIndexOf:c.b,arrMap:c.c,arrReduce:c.d,strTrim:c.H,objCreate:i.b,objKeys:c.B,objDefineAccessors:c.y,addEventHandler:d,dateNow:c.f,isIE:s.o,disableCookies:function(){y().setEnabled(!1)},newGuid:f,perfNow:p,newId:m,randomValue:u.d,random32:u.c,mwcRandomSeed:u.b,mwcRandom32:u.a,generateW3CId:h},v=/[xy]/g;c.e,c.e,c.g,c.g;function y(e,t){var n=Object(a.a)(e,t),o=g._canUseCookies;return null===l&&(l=[],r=o,Object(c.y)(g,"_canUseCookies",(function(){return r}),(function(e){r=e,Object(c.a)(l,(function(t){t.setEnabled(e)}))}))),-1===Object(c.b)(l,n)&&l.push(n),Object(c.l)(o)&&n.setEnabled(o),Object(c.l)(r)&&n.setEnabled(r),n}},7907:function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var r=n(2927),o=n(327),i=n(6676),a=n(38);const s=621355968e9,c=1e4,u="encoding:utf-8",l={"x-outlook-client":"owa",Accept:"application/json","x-overridetimestamp":!0};function d(e){const t=[];e.forEach((e,n)=>{t.push(...function(e){var t,n;const r=null===(t=e.html)||void 0===t?void 0:t.name,o=e.txt?e.txt.value:"";return[h(r,null===(n=e.html)||void 0===n?void 0:n.value,"Blob","RoamingSetting","htm",!0,"roaming_signature_list"),h(r,o,"Blob","RoamingSetting","txt",!0,"roaming_signature_list")]}(e))}),t.length>0&&Object(o.d)(i.a,t,void 0,!0,Object.assign(Object.assign({},l),{"x-islargesetting":!0}))}function f(){const{roamingSignatureMap:e}=r.b,t=[];e.forEach(e=>{var n;(null===(n=e.html)||void 0===n?void 0:n.name)&&t.push(e.html.name)});const n=[h(i.g,t.join(),"BlobArray","RoamingSetting",i.g,!1)];Object(o.d)(i.a,n,void 0,!0,l)}function p(e){const t=[h(i.d,e,"String","RoamingSetting",i.d,!1)];Object(o.d)(i.a,t,void 0,!0,l)}function m(e){const t=[h(i.b,e,"String","RoamingSetting",i.b,!1)];Object(o.d)(i.a,t,void 0,!0,l)}function h(e,t,n,r,o,i,l){var d;const f={name:e,value:t,type:n,scope:null===(d=Object(a.a)().SessionSettings)||void 0===d?void 0:d.UserEmailAddress,itemClass:r,timestamp:s+Date.now()*c,secondaryKey:o,metadata:u};return l&&(f.parentSetting=l),i&&(f["value@is.Large"]=i),f}},80:function(e,t,n){"use strict";var r=n(3);function o(e,t){return(t=t||{}).dp=e,t}function i(e,t,n){return Object(r.action)(e,(...r)=>{const i=t?t(...r):{},a=n?n(i,...r):{name:e};return a.name=a.name||e,a.options=a.options||{isCore:!0},o(a,i)})}function a(e){const{value:t,exactMatches:n=[0,1,2,3,4,5],buckets:r=[10,15,25,50,100]}=e;if(0===r.length)throw new Error("getAggregationBucket: buckets cannot be an empty array");if(n[0]&&t<n[0])return`<${n[0]}`;if(n.includes(t))return`${t}`;for(let e=0;e<r.length;e++)if(t<=r[e])return`${e>0?r[e-1]+1:n[n.length-1]+1||"0"}-${r[e]}`;return`${r[r.length-1]+1}+`}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a}))},804:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(16),o=n(0);function i(e){return{get:e}}function a(e,t){return Object(o.useMemo)(()=>Object(r.computed)(e),t).get()}},805:function(e,t,n){"use strict";var r=n(20),o=n(377),i=n(0),a=n(71),s=n(23);var c=Object(s.a)((function(e){const{categoryContainerClass:t,categories:n,categoryWellContainerClass:r,onCategoryClicked:o,categoryList:s}=e;!function(e){i.useEffect(()=>{Object(a.o)("Category_Well_TotalCategories",[e.length],{sessionSampleRate:10})},[e])}(n);const c=i.useCallback(({categoryName:e,isLastInWell:n})=>i.createElement(C,{actionSource:"CategoryWell",category:e,containerClassName:t,isLastInWell:n,onCategoryClicked:o,categoryList:s}),[t,o,s]),u=[...n].reverse();return i.createElement("div",{className:r},u.map((e,t)=>i.createElement(c,{key:e,categoryName:e,isLastInWell:t===n.length-1})))})),u=n(804),l=n(521),d=n(408),f=n(1264),p=n(745),m=n(6),h=n(47),g=n(131),v=n(829),y=n(491),b=n.n(y),O=n(166);const S=n.n(O).a.bind(b.a);var C=Object(s.a)((function(e){const t=i.useRef(),n=Object(u.b)(()=>Object(l.a)(e.category,e.categoryList?e.categoryList:Object(d.a)()),[e.category,e.categoryList]),{textColor:r,primaryColor:o,secondaryColor:s}=n,c=Object(h.j)("mon-densities"),y={backgroundColor:o,borderColor:s,color:r,cursor:e.onCategoryClicked?"pointer":"initial"},O=e.category,C=S(e.containerClassName,e.isLastInWell?b.a.lastCategoryContainer:b.a.categoryContainer,e.showCategoryRemove?b.a.categoryMaxWidth:b.a.categoryMaxWidthWithButton),A=S(b.a.categoryName,c&&Object(g.e)()),_=i.useCallback(t=>{t.stopPropagation(),e.onRemoveCategoryClicked(O)},[e.onRemoveCategoryClicked,e.category]),I=Object(u.b)(()=>{if(e.showCategoryRemove){const e=v.b.tryImportForRender(),t=v.a.tryImportForRender();if(t&&e)return e(s,t(r),r)}return null},[n,e.showCategoryRemove]),x={iconProps:{iconName:"Cancel"},className:b.a.removeCategoryButton,onClick:_,ariaLabel:Object(m.c)(Object(m.b)(p.a),O),title:Object(m.c)(Object(m.b)(p.a),O),styles:{icon:{color:r,backgroundColor:o,fontSize:"12px"},iconHovered:{backgroundColor:s,color:I},rootPressed:{backgroundColor:s,color:I},rootHovered:{backgroundColor:s,color:I}}};return i.createElement("div",{ref:e=>t.current=e,key:O,className:C,style:y,title:Object(m.c)(Object(m.b)(p.b),O),onMouseEnter:()=>{e.onCategoryClicked&&(t.current.style.borderColor=r)},onMouseLeave:()=>{e.onCategoryClicked&&(t.current.style.borderColor=s)},onClick:t=>{e.onCategoryClicked&&(Object(a.o)("Category_Well_Click",[e.actionSource]),e.onCategoryClicked(t,e.category,e.actionSource))}},i.createElement("span",{className:A},O),e.showCategoryRemove&&i.createElement(f.a,Object.assign({},x)))})),A=(n(192),n(63)),_=n(1038),I=n.n(_);function x(e){let t=[];return t.push({key:"CategoryMenuItemDiv",onRender:()=>i.createElement(W,{mailboxInfo:e.mailboxInfo,onAfterCreateNewCategory:e.onAfterCreateNewCategory,addFavoriteCategory:e.addFavoriteCategory,onCheckedCategoryClicked:e.onCheckedCategoryClicked,onUncheckedCategoryClicked:e.onUncheckedCategoryClicked,actionSource:e.actionSource,categoryList:e.categoryList,categoriesToCheck:e.getCategoriesToCheck(),dismissMenu:e.dismissMenu,shouldShowSearchBox:e.shouldShowSearchBox,shouldShowManageCategories:e.shouldShowManageCategories,shouldShowClearCategories:e.getShouldShowClearCategories(),manageCategoriesDisabled:e.manageCategoriesDisabled,createNewCategoryDisabled:e.createNewCategoryDisabled,onManageCategoryClicked:e.onManageCategoryClicked,onClearCategoriesClicked:e.onClearCategoriesClicked})}),{className:I.a.categoryMenu,styles:{title:{},container:{},root:{width:e.width?e.width+"px":null},header:{},list:{}},directionalHintFixed:!1,items:t,onMenuDismissed:()=>z.importAndExecute(),shouldFocusOnMount:!e.shouldShowSearchBox,useTargetWidth:e.useTargetWidth,coverTarget:e.coverTarget,directionalHint:e.directionalHint?e.directionalHint:A.a.bottomLeftEdge,focusZoneProps:{shouldInputLoseFocusOnArrowKey:e=>!0},calloutProps:{className:"customScrollBar"}}}var E=n(981),T=n(979),w=n(814);function M(e){return 1===Object(d.a)().filter(t=>t.Id===e).length}var k=n(815),j=n(977);n.d(t,"r",(function(){return R})),n.d(t,"w",(function(){return N})),n.d(t,"B",(function(){return D})),n.d(t,"u",(function(){return F})),n.d(t,"y",(function(){return L})),n.d(t,"t",(function(){return U})),n.d(t,"A",(function(){return B})),n.d(t,"s",(function(){return H})),n.d(t,"x",(function(){return V})),n.d(t,"v",(function(){return z})),n.d(t,"e",(function(){return W})),n.d(t,"c",(function(){return G})),n.d(t,"b",(function(){return q})),n.d(t,"z",(function(){return K})),n.d(t,"p",(function(){return o.b})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return C})),n.d(t,"h",(function(){return l.a})),n.d(t,"j",(function(){return x})),n.d(t,"l",(function(){return E.a})),n.d(t,"o",(function(){return d.a})),n.d(t,"g",(function(){return T.a})),n.d(t,"n",(function(){return w.b})),n.d(t,"m",(function(){return w.a})),n.d(t,"q",(function(){return M})),n.d(t,"i",(function(){return k.a})),n.d(t,"k",(function(){return k.b})),n.d(t,"d",(function(){return j.a}));const P=new r.c(()=>Promise.all([n.e(4),n.e(12),n.e(92),n.e(494)]).then(n.bind(null,19468))),R=new r.a(P,e=>e.addMasterCategories),N=new r.a(P,e=>e.removeMasterCategories),D=(new r.a(P,e=>e.changeMasterCategories),new r.a(P,e=>e.updateLastTimeUsedMasterCategories)),F=new r.a(P,e=>e.getMasterCategoryList),L=new r.a(P,e=>e.setInitialCategoryDialogViewState),U=(new r.a(P,e=>e.addCategory),new r.a(P,e=>e.fetchCategoryDetails)),B=new r.a(P,e=>e.subscribeToCategoryNotifications),H=new r.a(P,e=>e.applyCategoryOperationHelper),V=new r.a(P,e=>e.setBlockedCategoryNames),z=new r.a(P,e=>e.onMenuDismissed),W=Object(r.d)(P,e=>e.CategoryMenu),G=Object(r.d)(P,e=>e.CategoryDialog),q=Object(r.d)(P,e=>e.CategoryColorPickerHost),K=new r.a(P,e=>e.showCategoryDialog);Object(r.d)(P,e=>e.CategoryMenuItem)},806:function(e,t,n){"use strict";var r=n(20),o=n(263),i=n(966),a=n(289);function s(e){const t=Object(o.a)();for(const n of t.tabs)if(n.type!==a.a.Primary&&n.type!==a.a.SxS&&n.data==e)return n;return null}function c(e){const t=Object(o.a)();for(const n of t.tabs)if(n.sxsId===e)return n.id;return null}function u(e){var t,n;const r=Object(o.a)();for(const o of r.tabs)if(o.type!==a.a.Primary&&o.type!==a.a.SxS&&(null===(n=null===(t=o.data)||void 0===t?void 0:t.id)||void 0===n?void 0:n.Id)==e)return!0;return!1}function l(e,t){var n,r;const i=Object(o.a)();for(const o of i.tabs)if(o.type!==a.a.Primary&&o.type!==a.a.SxS&&(null===(r=null===(n=o.data)||void 0===n?void 0:n.id)||void 0===r?void 0:r.Id)==e&&o.id!=t)return!0;return!1}function d(e){switch(e.type){case a.a.SecondaryReadingPane:return e.data.subject;default:return null}}var f=n(967);n(989);function p(e){for(const t of Object(o.a)().tabs)if(t.id===e)return t.firstRibbonRenderCompleted;return!1}var m=n(3),h=n(1057);Object(m.mutator)(h.a,e=>{for(const t of Object(o.a)().tabs)t.id===e.tabId&&(t.firstRibbonRenderCompleted=!0)}),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return b})),n.d(t,"n",(function(){return O})),n.d(t,"l",(function(){return S})),n.d(t,"m",(function(){return C})),n.d(t,"k",(function(){return A})),n.d(t,"f",(function(){return o.a})),n.d(t,"p",(function(){return o.b})),n.d(t,"d",(function(){return i.a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"r",(function(){return u})),n.d(t,"o",(function(){return l})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return a.a})),n.d(t,"q",(function(){return f.b})),n.d(t,"e",(function(){return p}));const g=new r.c(()=>n.e(766).then(n.bind(null,19806)));let v=new r.a(g,e=>e.activateTab),y=new r.a(g,e=>e.addTab),b=new r.a(g,e=>e.closeTab),O=new r.a(g,e=>e.setTabIsShown),S=new r.a(g,e=>e.reloadSecondaryTabAsDeeplink),C=new r.a(g,e=>e.setFirstRenderCompleted),A=new r.b(g,e=>e.getTabById)},807:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.Parent=0]="Parent",e[e.Self=1]="Self"}(r||(r={}))},810:function(e,t,n){"use strict";function r(e){var t;if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;const n="MAPIPDL"===e.RoutingType&&(null===(t=e.ItemId)||void 0===t?void 0:t.Id)||e.EmailAddress;return`${e.RoutingType}:${n}`}n.d(t,"a",(function(){return r}))},812:function(e,t,n){"use strict";(function(e){var r=n(711),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&r.a.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();t.a=s}).call(this,n(709)(e))},813:function(e,t,n){var r=n(1261);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},814:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(377);function o(e){var t;const n=null===(t=Object(r.b)().categoryDetails.get(e))||void 0===t?void 0:t.unreadCount;return n||0}function i(e){var t;const n=null===(t=Object(r.b)().categoryDetails.get(e))||void 0===t?void 0:t.totalCount;return n||0}},815:function(e,t,n){"use strict";function r(e,t){const n=t.filter(t=>t.Name===e);return n.length>0?n[0].Id:null}function o(e,t){const n=t.filter(t=>t.Id===e);return n.length>0?n[0].Name:null}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},817:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(618);function o(e){return i(e.source,Object(r.a)(e.source,e.start))}function i(e,t){var n=e.locationOffset.column-1,r=s(n)+e.body,o=t.line-1,i=e.locationOffset.line-1,c=t.line+i,u=1===t.line?n:0,l=t.column+u,d="".concat(e.name,":").concat(c,":").concat(l,"\n"),f=r.split(/\r\n|[\n\r]/g),p=f[o];if(p.length>120){for(var m=Math.floor(l/80),h=l%80,g=[],v=0;v<p.length;v+=80)g.push(p.slice(v,v+80));return d+a([["".concat(c),g[0]]].concat(g.slice(1,m+1).map((function(e){return["",e]})),[[" ",s(h-1)+"^"],["",g[m+1]]]))}return d+a([["".concat(c-1),f[o-1]],["".concat(c),p],["",s(l-1)+"^"],["".concat(c+1),f[o+1]]])}function a(e){var t=e.filter((function(e){e[0];return void 0!==e[1]})),n=Math.max.apply(Math,t.map((function(e){return e[0].length})));return t.map((function(e){var t,r=e[0],o=e[1];return s(n-(t=r).length)+t+(o?" | "+o:" |")})).join("\n")}function s(e){return Array(e+1).join(" ")}},818:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(78);function o(e){for(var t,n=[],o=Object(r.a)(e)||document;e!==o.body;){for(var i=0,a=e.parentElement.children;i<a.length;i++){var s=a[i];s!==e&&"true"!==(null===(t=s.getAttribute("aria-hidden"))||void 0===t?void 0:t.toLowerCase())&&n.push(s)}if(!e.parentElement)break;e=e.parentElement}return n.forEach((function(e){e.setAttribute("aria-hidden","true")})),function(){!function(e){e.forEach((function(e){e.setAttribute("aria-hidden","false")}))}(n),n=[]}}},8217:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4795),o=n(4199),i=n(2024);function a(e,t){return i.c.import().then(n=>{n(e,(e,n,i)=>{if(e.getContent(1)==t)return null;const a=Object(r.a)(t,e.getDocument(),i);return e.addUndoSnapshot(()=>{e.setContent("",!1),e.insertNode(a,{position:0,updateCursor:!0,replaceSelection:!1,insertOnNewLine:!1})},o.a),a?i.createRange(a,-3):null},(e,n,r)=>({value:t,selectionStart:0,selectionEnd:0}))})}},8218:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2300);function o(e){let t=null;return Object(r.b)(e,e=>{const n=e.getSelectionRange();if(n){const r=n.cloneContents();let o=e.getDocument().createElement("div");o.appendChild(r),t={data:o.innerHTML,sourceProperty:"body",startPosition:n.startOffset,endPosition:n.endOffset}}},e=>{const{value:n,selectionStart:r,selectionEnd:o}=e;t={data:n.substring(r,o),sourceProperty:"body",startPosition:r,endPosition:o}}),t}},822:function(e,t,n){"use strict";var r=n(25),o=n(68),i=n(724),a=n(993),s=n(1591),c="3.3.21",u=n(839),l=n(439),d=n(636),f=n(1071),p=n(1073),m=n(1068),h=n(837),g=n(1072);var v=n(1287),y=function(e){void 0===e&&(e={});var t=e.uri,n=void 0===t?"/graphql":t,o=e.fetch,a=e.includeExtensions,s=e.useGETForQueries,c=e.includeUnusedVariables,y=void 0!==c&&c,b=Object(r.e)(e,["uri","fetch","includeExtensions","useGETForQueries","includeUnusedVariables"]);Object(m.a)(o),o||(o=fetch);var O={http:{includeExtensions:a},options:b.fetchOptions,credentials:b.credentials,headers:b.headers};return new i.a((function(e){var t=Object(f.a)(e,n),i=e.getContext(),a={};if(i.clientAwareness){var c=i.clientAwareness,m=c.name,b=c.version;m&&(a["apollographql-client-name"]=m),b&&(a["apollographql-client-version"]=b)}var S,C=Object(r.a)(Object(r.a)({},a),i.headers),A={http:i.http,options:i.fetchOptions,credentials:i.credentials,headers:C},_=Object(h.b)(e,h.a,O,A),I=_.options,x=_.body;if(x.variables&&!y){var E=new Set(Object.keys(x.variables));Object(u.c)(e.query,{Variable:function(e,t,n){n&&"VariableDefinition"!==n.kind&&E.delete(e.name.value)}}),E.size&&(x.variables=Object(r.a)({},x.variables),E.forEach((function(e){delete x.variables[e]})))}if(!I.signal){var T=Object(g.a)(),w=T.controller,M=T.signal;(S=w)&&(I.signal=M)}if(s&&!e.query.definitions.some((function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation}))&&(I.method="GET"),"GET"===I.method){var k=function(e,t){var n=[],r=function(e,t){n.push(e+"="+encodeURIComponent(t))};if("query"in t&&r("query",t.query),t.operationName&&r("operationName",t.operationName),t.variables){var o=void 0;try{o=Object(d.a)(t.variables,"Variables map")}catch(e){return{parseError:e}}r("variables",o)}if(t.extensions){var i=void 0;try{i=Object(d.a)(t.extensions,"Extensions map")}catch(e){return{parseError:e}}r("extensions",i)}var a="",s=e,c=e.indexOf("#");-1!==c&&(a=e.substr(c),s=e.substr(0,c));var u=-1===s.indexOf("?")?"?":"&";return{newURI:s+u+n.join("&")+a}}(t,x),j=k.newURI,P=k.parseError;if(P)return Object(v.a)(P);t=j}else try{I.body=Object(d.a)(x,"Payload")}catch(P){return Object(v.a)(P)}return new l.a((function(n){return o(t,I).then((function(t){return e.setContext({response:t}),t})).then(Object(p.a)(e)).then((function(e){return n.next(e),n.complete(),e})).catch((function(e){"AbortError"!==e.name&&(e.result&&e.result.errors&&e.result.data&&n.next(e.result),n.error(e))})),function(){S&&S.abort()}}))}))},b=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,y(t).request)||this;return n.options=t,n}return Object(r.c)(t,e),t}(i.a),O=n(212),S=n(1113);function C(e){return e.errors&&e.errors.length>0||!1}var A=n(1308),_=n(496),I=n(1593),x=n(1307),E=n(749),T=n(1074);function w(e){return e&&"function"==typeof e.then}var M=function(e){function t(t){var n=e.call(this,(function(e){return n.addObserver(e),function(){return n.removeObserver(e)}}))||this;return n.observers=new Set,n.addCount=0,n.promise=new Promise((function(e,t){n.resolve=e,n.reject=t})),n.handlers={next:function(e){null!==n.sub&&(n.latest=["next",e],Object(E.a)(n.observers,"next",e))},error:function(e){var t=n.sub;null!==t&&(t&&Promise.resolve().then((function(){return t.unsubscribe()})),n.sub=null,n.latest=["error",e],n.reject(e),Object(E.a)(n.observers,"error",e))},complete:function(){if(null!==n.sub){var e=n.sources.shift();e?w(e)?e.then((function(e){return n.sub=e.subscribe(n.handlers)})):n.sub=e.subscribe(n.handlers):(n.sub=null,n.latest&&"next"===n.latest[0]?n.resolve(n.latest[1]):n.resolve(),Object(E.a)(n.observers,"complete"))}}},n.cancel=function(e){n.reject(e),n.sources=[],n.handlers.complete()},n.promise.catch((function(e){})),"function"==typeof t&&(t=[new l.a(t)]),w(t)?t.then((function(e){return n.start(e)}),n.handlers.error):n.start(t),n}return Object(r.c)(t,e),t.prototype.start=function(e){void 0===this.sub&&(this.sources=Array.from(e),this.handlers.complete())},t.prototype.deliverLastMessage=function(e){if(this.latest){var t=this.latest[0],n=e[t];n&&n.call(e,this.latest[1]),null===this.sub&&"next"===t&&e.complete&&e.complete()}},t.prototype.addObserver=function(e){this.observers.has(e)||(this.deliverLastMessage(e),this.observers.add(e),++this.addCount)},t.prototype.removeObserver=function(e,t){this.observers.delete(e)&&--this.addCount<1&&!t&&this.handlers.error(new Error("Observable cancelled prematurely"))},t.prototype.cleanup=function(e){var t=this,n=!1,r=function(){n||(n=!0,t.observers.delete(o),e())},o={next:r,error:r,complete:r},i=this.addCount;this.addObserver(o),this.addCount=i},t}(l.a);function k(e,t,n){return new l.a((function(r){var o=r.next,i=r.error,a=r.complete,s=0,c=!1,u={then:function(e){return new Promise((function(t){return t(e())}))}};function l(e,t){return e?function(t){++s;var n=function(){return e(t)};u=u.then(n,n).then((function(e){--s,o&&o.call(r,e),c&&d.complete()}),(function(e){throw--s,e})).catch((function(e){i&&i.call(r,e)}))}:function(e){return t&&t.call(r,e)}}var d={next:l(t,o),error:l(n,i),complete:function(){c=!0,s||a&&a.call(r)}},f=e.subscribe(d);return function(){return f.unsubscribe()}}))}Object(T.a)(M);var j=n(309),P=n(725),R=n(207),N=n(1306),D=n(586),F=n(250),L=n(525),U=function(){function e(e){var t=e.cache,n=e.client,r=e.resolvers,o=e.fragmentMatcher;this.cache=t,n&&(this.client=n),r&&this.addResolvers(r),o&&this.setFragmentMatcher(o)}return e.prototype.addResolvers=function(e){var t=this;this.resolvers=this.resolvers||{},Array.isArray(e)?e.forEach((function(e){t.resolvers=Object(N.b)(t.resolvers,e)})):this.resolvers=Object(N.b)(this.resolvers,e)},e.prototype.setResolvers=function(e){this.resolvers={},this.addResolvers(e)},e.prototype.getResolvers=function(){return this.resolvers||{}},e.prototype.runResolvers=function(e){var t=e.document,n=e.remoteResult,o=e.context,i=e.variables,a=e.onlyRunForcedResolvers,s=void 0!==a&&a;return Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(e){return t?[2,this.resolveDocument(t,n.data,o,i,this.fragmentMatcher,s).then((function(e){return Object(r.a)(Object(r.a)({},n),{data:e.result})}))]:[2,n]}))}))},e.prototype.setFragmentMatcher=function(e){this.fragmentMatcher=e},e.prototype.getFragmentMatcher=function(){return this.fragmentMatcher},e.prototype.clientQuery=function(e){return Object(x.b)(["client"],e)&&this.resolvers?e:null},e.prototype.serverQuery=function(e){return Object(I.c)(e)},e.prototype.prepareContext=function(e){var t=this.cache;return Object(r.a)(Object(r.a)({},e),{cache:t,getCacheKey:function(e){return t.identify(e)}})},e.prototype.addExportedVariables=function(e,t,n){return void 0===t&&(t={}),void 0===n&&(n={}),Object(r.b)(this,void 0,void 0,(function(){return Object(r.d)(this,(function(o){return e?[2,this.resolveDocument(e,this.buildRootValueFromCache(e,t)||{},this.prepareContext(n),t).then((function(e){return Object(r.a)(Object(r.a)({},t),e.exportedVariables)}))]:[2,Object(r.a)({},t)]}))}))},e.prototype.shouldForceResolvers=function(e){var t=!1;return Object(u.c)(e,{Directive:{enter:function(e){if("client"===e.name.value&&e.arguments&&(t=e.arguments.some((function(e){return"always"===e.name.value&&"BooleanValue"===e.value.kind&&!0===e.value.value}))))return u.a}}}),t},e.prototype.buildRootValueFromCache=function(e,t){return this.cache.diff({query:Object(I.b)(e),variables:t,returnPartialData:!0,optimistic:!1}).result},e.prototype.resolveDocument=function(e,t,n,o,i,a){return void 0===n&&(n={}),void 0===o&&(o={}),void 0===i&&(i=function(){return!0}),void 0===a&&(a=!1),Object(r.b)(this,void 0,void 0,(function(){var s,c,u,l,d,f,p,m,h;return Object(r.d)(this,(function(g){return s=Object(_.e)(e),c=Object(_.d)(e),u=Object(D.a)(c),l=s.operation,d=l?l.charAt(0).toUpperCase()+l.slice(1):"Query",p=(f=this).cache,m=f.client,h={fragmentMap:u,context:Object(r.a)(Object(r.a)({},n),{cache:p,client:m}),variables:o,fragmentMatcher:i,defaultOperationType:d,exportedVariables:{},onlyRunForcedResolvers:a},[2,this.resolveSelectionSet(s.selectionSet,t,h).then((function(e){return{result:e,exportedVariables:h.exportedVariables}}))]}))}))},e.prototype.resolveSelectionSet=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var i,a,s,c,u,l=this;return Object(r.d)(this,(function(d){return i=n.fragmentMap,a=n.context,s=n.variables,c=[t],u=function(e){return Object(r.b)(l,void 0,void 0,(function(){var u,l;return Object(r.d)(this,(function(r){return Object(x.c)(e,s)?Object(F.d)(e)?[2,this.resolveField(e,t,n).then((function(t){var n;void 0!==t&&c.push(((n={})[Object(F.h)(e)]=t,n))}))]:(Object(F.e)(e)?u=e:(u=i[e.name.value],Object(o.b)(u,11)),u&&u.typeCondition&&(l=u.typeCondition.name.value,n.fragmentMatcher(t,l,a))?[2,this.resolveSelectionSet(u.selectionSet,t,n).then((function(e){c.push(e)}))]:[2]):[2]}))}))},[2,Promise.all(e.selections.map(u)).then((function(){return Object(N.c)(c)}))]}))}))},e.prototype.resolveField=function(e,t,n){return Object(r.b)(this,void 0,void 0,(function(){var o,i,a,s,c,u,l,d,f,p=this;return Object(r.d)(this,(function(r){return o=n.variables,i=e.name.value,a=Object(F.h)(e),s=i!==a,c=t[a]||t[i],u=Promise.resolve(c),n.onlyRunForcedResolvers&&!this.shouldForceResolvers(e)||(l=t.__typename||n.defaultOperationType,(d=this.resolvers&&this.resolvers[l])&&(f=d[s?i:a])&&(u=Promise.resolve(L.a.withValue(this.cache,f,[t,Object(F.a)(e,o),n.context,{field:e,fragmentMap:n.fragmentMap}])))),[2,u.then((function(t){return void 0===t&&(t=c),e.directives&&e.directives.forEach((function(e){"export"===e.name.value&&e.arguments&&e.arguments.forEach((function(e){"as"===e.name.value&&"StringValue"===e.value.kind&&(n.exportedVariables[e.value.value]=t)}))})),e.selectionSet?null==t?t:Array.isArray(t)?p.resolveSubSelectedArray(e,t,n):e.selectionSet?p.resolveSelectionSet(e.selectionSet,t,n):void 0:t}))]}))}))},e.prototype.resolveSubSelectedArray=function(e,t,n){var r=this;return Promise.all(t.map((function(t){return null===t?null:Array.isArray(t)?r.resolveSubSelectedArray(e,t,n):e.selectionSet?r.resolveSelectionSet(e.selectionSet,t,n):void 0})))},e}(),B=new(S.a?WeakMap:Map);function H(e,t){var n=e[t];"function"==typeof n&&(e[t]=function(){return B.set(e,(B.get(e)+1)%1e15),n.apply(this,arguments)})}function V(e){e.notifyTimeout&&(clearTimeout(e.notifyTimeout),e.notifyTimeout=void 0)}var z=function(){function e(e){this.cache=e,this.listeners=new Set,this.document=null,this.lastRequestId=1,this.subscriptions=new Set,this.stopped=!1,this.dirty=!1,this.diff=null,this.observableQuery=null,B.has(e)||(B.set(e,0),H(e,"evict"),H(e,"modify"),H(e,"reset"))}return e.prototype.init=function(e){var t=e.networkStatus||R.a.loading;return this.variables&&this.networkStatus!==R.a.loading&&!Object(O.a)(this.variables,e.variables)&&(t=R.a.setVariables),Object(O.a)(e.variables,this.variables)||(this.diff=null),Object.assign(this,{document:e.document,variables:e.variables,networkError:null,graphQLErrors:this.graphQLErrors||[],networkStatus:t}),e.observableQuery&&this.setObservableQuery(e.observableQuery),e.lastRequestId&&(this.lastRequestId=e.lastRequestId),this},e.prototype.reset=function(){V(this),this.diff=null,this.dirty=!1},e.prototype.getDiff=function(e){return void 0===e&&(e=this.variables),this.diff&&Object(O.a)(e,this.variables)?this.diff:(this.updateWatch(this.variables=e),this.diff=this.cache.diff({query:this.document,variables:e,returnPartialData:!0,optimistic:!0}))},e.prototype.setDiff=function(e){var t=this,n=this.diff;this.diff=e,this.dirty||(e&&e.result)===(n&&n.result)||(this.dirty=!0,this.notifyTimeout||(this.notifyTimeout=setTimeout((function(){return t.notify()}),0)))},e.prototype.setObservableQuery=function(e){var t=this;e!==this.observableQuery&&(this.oqListener&&this.listeners.delete(this.oqListener),this.observableQuery=e,e?(e.queryInfo=this,this.listeners.add(this.oqListener=function(){t.getDiff().fromOptimisticTransaction?e.observe():e.reobserve()})):delete this.oqListener)},e.prototype.notify=function(){var e=this;V(this),this.shouldNotify()&&this.listeners.forEach((function(t){return t(e)})),this.dirty=!1},e.prototype.shouldNotify=function(){if(!this.dirty||!this.listeners.size)return!1;if(Object(R.b)(this.networkStatus)&&this.observableQuery){var e=this.observableQuery.options.fetchPolicy;if("cache-only"!==e&&"cache-and-network"!==e)return!1}return!0},e.prototype.stop=function(){if(!this.stopped){this.stopped=!0,this.reset(),this.cancel(),delete this.cancel,this.subscriptions.forEach((function(e){return e.unsubscribe()}));var e=this.observableQuery;e&&e.stopPolling()}},e.prototype.cancel=function(){},e.prototype.updateWatch=function(e){var t=this;void 0===e&&(e=this.variables);var n=this.observableQuery;n&&"no-cache"===n.options.fetchPolicy||this.lastWatch&&this.lastWatch.query===this.document&&Object(O.a)(e,this.lastWatch.variables)||(this.cancel(),this.cancel=this.cache.watch(this.lastWatch={query:this.document,variables:e,optimistic:!0,callback:function(e){return t.setDiff(e)}}))},e.prototype.shouldWrite=function(e,t){var n=this.lastWrite;return!(n&&n.dmCount===B.get(this.cache)&&Object(O.a)(t,n.variables)&&Object(O.a)(e.data,n.result.data))},e.prototype.markResult=function(e,t,n){var r=this;this.graphQLErrors=Object(A.a)(e.errors)?e.errors:[],this.reset(),"no-cache"===t.fetchPolicy?this.diff={result:e.data,complete:!0}:!this.stopped&&n&&(W(e,t.errorPolicy)?this.cache.performTransaction((function(n){if(r.shouldWrite(e,t.variables))n.writeQuery({query:r.document,data:e.data,variables:t.variables}),r.lastWrite={result:e,variables:t.variables,dmCount:B.get(r.cache)};else if(r.diff&&r.diff.complete)return void(e.data=r.diff.result);var o=n.diff({query:r.document,variables:t.variables,returnPartialData:!0,optimistic:!0});r.stopped||r.updateWatch(t.variables),r.diff=o,o.complete&&(e.data=o.result)})):this.lastWrite=void 0)},e.prototype.markReady=function(){return this.networkError=null,this.networkStatus=R.a.ready},e.prototype.markError=function(e){return this.networkStatus=R.a.error,this.lastWrite=void 0,this.reset(),e.graphQLErrors&&(this.graphQLErrors=e.graphQLErrors),e.networkError&&(this.networkError=e.networkError),e},e}();function W(e,t){void 0===t&&(t="none");var n="ignore"===t||"all"===t,r=!C(e);return!r&&n&&e.data&&(r=!0),r}var G=Object.prototype.hasOwnProperty,q=function(){function e(e){var t=e.cache,n=e.link,r=e.queryDeduplication,o=void 0!==r&&r,i=e.onBroadcast,a=e.ssrMode,s=void 0!==a&&a,c=e.clientAwareness,u=void 0===c?{}:c,l=e.localState,d=e.assumeImmutableResults;this.clientAwareness={},this.queries=new Map,this.fetchCancelFns=new Map,this.transformCache=new(S.a?WeakMap:Map),this.queryIdCounter=1,this.requestIdCounter=1,this.mutationIdCounter=1,this.inFlightLinkObservables=new Map,this.cache=t,this.link=n,this.queryDeduplication=o,this.clientAwareness=u,this.localState=l||new U({cache:t}),this.ssrMode=s,this.assumeImmutableResults=!!d,(this.onBroadcast=i)&&(this.mutationStore=Object.create(null))}return e.prototype.stop=function(){var e=this;this.queries.forEach((function(t,n){e.stopQueryNoBroadcast(n)})),this.cancelPendingFetches(new o.a(12))},e.prototype.cancelPendingFetches=function(e){this.fetchCancelFns.forEach((function(t){return t(e)})),this.fetchCancelFns.clear()},e.prototype.mutate=function(e){var t=e.mutation,n=e.variables,i=e.optimisticResponse,a=e.updateQueries,s=e.refetchQueries,c=void 0===s?[]:s,u=e.awaitRefetchQueries,l=void 0!==u&&u,d=e.update,f=e.errorPolicy,p=void 0===f?"none":f,m=e.fetchPolicy,h=e.context,g=void 0===h?{}:h;return Object(r.b)(this,void 0,void 0,(function(){var e,s,u;return Object(r.d)(this,(function(f){switch(f.label){case 0:return Object(o.b)(t,13),Object(o.b)(!m||"no-cache"===m,14),e=this.generateMutationId(),t=this.transform(t).document,n=this.getVariables(t,n),this.transform(t).hasClientExports?[4,this.localState.addExportedVariables(t,n,g)]:[3,2];case 1:n=f.sent(),f.label=2;case 2:return s=this.mutationStore&&(this.mutationStore[e]={mutation:t,variables:n,loading:!0,error:null}),i&&this.markMutationOptimistic(i,{mutationId:e,document:t,variables:n,errorPolicy:p,updateQueries:a,update:d}),this.broadcastQueries(),u=this,[2,new Promise((function(o,f){var h,v;u.getObservableFromLink(t,Object(r.a)(Object(r.a)({},g),{optimisticResponse:i}),n,!1).subscribe({next:function(r){if(C(r)&&"none"===p)v=new j.a({graphQLErrors:r.errors});else{if(s&&(s.loading=!1,s.error=null),"no-cache"!==m)try{u.markMutationResult({mutationId:e,result:r,document:t,variables:n,errorPolicy:p,updateQueries:a,update:d})}catch(e){return void(v=new j.a({networkError:e}))}h=r}},error:function(t){s&&(s.loading=!1,s.error=t),i&&u.cache.removeOptimistic(e),u.broadcastQueries(),f(new j.a({networkError:t}))},complete:function(){if(v&&s&&(s.loading=!1,s.error=v),i&&u.cache.removeOptimistic(e),u.broadcastQueries(),v)f(v);else{"function"==typeof c&&(c=c(h));var t=[];Object(A.a)(c)&&c.forEach((function(e){if("string"==typeof e)u.queries.forEach((function(n){var r=n.observableQuery;r&&r.hasObservers()&&r.queryName===e&&t.push(r.refetch())}));else{var n={query:e.query,variables:e.variables,fetchPolicy:"network-only"};e.context&&(n.context=e.context),t.push(u.query(n))}})),Promise.all(l?t:[]).then((function(){"ignore"===p&&h&&C(h)&&delete h.errors,o(h)}),f)}}})}))]}}))}))},e.prototype.markMutationResult=function(e,t){var n=this;if(void 0===t&&(t=this.cache),W(e.result,e.errorPolicy)){var r=[{result:e.result.data,dataId:"ROOT_MUTATION",query:e.document,variables:e.variables}],o=e.updateQueries;o&&this.queries.forEach((function(i,a){var s=i.observableQuery,c=s&&s.queryName;if(c&&G.call(o,c)){var u=o[c],l=n.queries.get(a),d=l.document,f=l.variables,p=t.diff({query:d,variables:f,returnPartialData:!0,optimistic:!1}),m=p.result;if(p.complete&&m){var h=u(m,{mutationResult:e.result,queryName:d&&Object(_.g)(d)||void 0,queryVariables:f});h&&r.push({result:h,dataId:"ROOT_QUERY",query:d,variables:f})}}})),t.performTransaction((function(t){r.forEach((function(e){return t.write(e)}));var n=e.update;n&&n(t,e.result)}),null)}},e.prototype.markMutationOptimistic=function(e,t){var n=this,o="function"==typeof e?e(t.variables):e;return this.cache.recordOptimisticTransaction((function(e){try{n.markMutationResult(Object(r.a)(Object(r.a)({},t),{result:{data:o}}),e)}catch(e){}}),t.mutationId)},e.prototype.fetchQuery=function(e,t,n){return this.fetchQueryObservable(e,t,n).promise},e.prototype.getQueryStore=function(){var e=Object.create(null);return this.queries.forEach((function(t,n){e[n]={variables:t.variables,networkStatus:t.networkStatus,networkError:t.networkError,graphQLErrors:t.graphQLErrors}})),e},e.prototype.resetErrors=function(e){var t=this.queries.get(e);t&&(t.networkError=void 0,t.graphQLErrors=[])},e.prototype.transform=function(e){var t=this.transformCache;if(!t.has(e)){var n=this.cache.transformDocument(e),r=Object(I.d)(this.cache.transformForLink(n)),o=this.localState.clientQuery(n),i=r&&this.localState.serverQuery(r),a={document:n,hasClientExports:Object(x.a)(n),hasForcedResolvers:this.localState.shouldForceResolvers(n),clientQuery:o,serverQuery:i,defaultVars:Object(_.b)(Object(_.f)(n))},s=function(e){e&&!t.has(e)&&t.set(e,a)};s(e),s(n),s(o),s(i)}return t.get(e)},e.prototype.getVariables=function(e,t){return Object(r.a)(Object(r.a)({},this.transform(e).defaultVars),t)},e.prototype.watchQuery=function(e){void 0===(e=Object(r.a)(Object(r.a)({},e),{variables:this.getVariables(e.query,e.variables)})).notifyOnNetworkStatusChange&&(e.notifyOnNetworkStatusChange=!1);var t=new z(this.cache),n=new P.a({queryManager:this,queryInfo:t,options:e});return this.queries.set(n.queryId,t),t.init({document:e.query,observableQuery:n,variables:e.variables}),n},e.prototype.query=function(e){var t=this;Object(o.b)(e.query,15),Object(o.b)("Document"===e.query.kind,16),Object(o.b)(!e.returnPartialData,17),Object(o.b)(!e.pollInterval,18);var n=this.generateQueryId();return this.fetchQuery(n,e).finally((function(){return t.stopQuery(n)}))},e.prototype.generateQueryId=function(){return String(this.queryIdCounter++)},e.prototype.generateRequestId=function(){return this.requestIdCounter++},e.prototype.generateMutationId=function(){return String(this.mutationIdCounter++)},e.prototype.stopQueryInStore=function(e){this.stopQueryInStoreNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryInStoreNoBroadcast=function(e){var t=this.queries.get(e);t&&t.stop()},e.prototype.clearStore=function(){return this.cancelPendingFetches(new o.a(19)),this.queries.forEach((function(e){e.observableQuery?e.networkStatus=R.a.loading:e.stop()})),this.mutationStore&&(this.mutationStore=Object.create(null)),this.cache.reset()},e.prototype.resetStore=function(){var e=this;return this.clearStore().then((function(){return e.reFetchObservableQueries()}))},e.prototype.reFetchObservableQueries=function(e){var t=this;void 0===e&&(e=!1);var n=[];return this.queries.forEach((function(r,o){var i=r.observableQuery;if(i&&i.hasObservers()){var a=i.options.fetchPolicy;i.resetLastResults(),"cache-only"===a||!e&&"standby"===a||n.push(i.refetch()),t.getQuery(o).setDiff(null)}})),this.broadcastQueries(),Promise.all(n)},e.prototype.setObservableQuery=function(e){this.getQuery(e.queryId).setObservableQuery(e)},e.prototype.startGraphQLSubscription=function(e){var t=this,n=e.query,r=e.fetchPolicy,o=e.errorPolicy,i=e.variables,a=e.context,s=void 0===a?{}:a;n=this.transform(n).document,i=this.getVariables(n,i);var c=function(e){return t.getObservableFromLink(n,s,e,!1).map((function(i){if("no-cache"!==r&&(W(i,o)&&t.cache.write({query:n,result:i.data,dataId:"ROOT_SUBSCRIPTION",variables:e}),t.broadcastQueries()),C(i))throw new j.a({graphQLErrors:i.errors});return i}))};if(this.transform(n).hasClientExports){var u=this.localState.addExportedVariables(n,i,s).then(c);return new l.a((function(e){var t=null;return u.then((function(n){return t=n.subscribe(e)}),e.error),function(){return t&&t.unsubscribe()}}))}return c(i)},e.prototype.stopQuery=function(e){this.stopQueryNoBroadcast(e),this.broadcastQueries()},e.prototype.stopQueryNoBroadcast=function(e){this.stopQueryInStoreNoBroadcast(e),this.removeQuery(e)},e.prototype.removeQuery=function(e){this.fetchCancelFns.delete(e),this.getQuery(e).stop(),this.queries.delete(e)},e.prototype.broadcastQueries=function(){this.onBroadcast&&this.onBroadcast(),this.queries.forEach((function(e){return e.notify()}))},e.prototype.getLocalState=function(){return this.localState},e.prototype.getObservableFromLink=function(e,t,n,o){var i,s,c=this;void 0===o&&(o=null!==(i=null==t?void 0:t.queryDeduplication)&&void 0!==i?i:this.queryDeduplication);var u=this.transform(e).serverQuery;if(u){var d=this.inFlightLinkObservables,f=this.link,p={query:u,variables:n,operationName:Object(_.g)(u)||void 0,context:this.prepareContext(Object(r.a)(Object(r.a)({},t),{forceFetch:!o}))};if(t=p.context,o){var m=d.get(u)||new Map;d.set(u,m);var h=JSON.stringify(n);if(!(s=m.get(h))){var g=new M([Object(a.a)(f,p)]);m.set(h,s=g),g.cleanup((function(){m.delete(h)&&m.size<1&&d.delete(u)}))}}else s=new M([Object(a.a)(f,p)])}else s=new M([l.a.of({data:{}})]),t=this.prepareContext(t);var v=this.transform(e).clientQuery;return v&&(s=k(s,(function(e){return c.localState.runResolvers({document:v,remoteResult:e,context:t,variables:n})}))),s},e.prototype.getResultsFromLink=function(e,t,n){var r=e.lastRequestId=this.generateRequestId();return k(this.getObservableFromLink(e.document,n.context,n.variables),(function(o){var i=Object(A.a)(o.errors);if(r>=e.lastRequestId){if(i&&"none"===n.errorPolicy)throw e.markError(new j.a({graphQLErrors:o.errors}));e.markResult(o,n,t),e.markReady()}var a={data:o.data,loading:!1,networkStatus:e.networkStatus||R.a.ready};return i&&"ignore"!==n.errorPolicy&&(a.errors=o.errors),a}),(function(t){var n=Object(j.b)(t)?t:new j.a({networkError:t});throw r>=e.lastRequestId&&e.markError(n),n}))},e.prototype.fetchQueryObservable=function(e,t,n){var r=this;void 0===n&&(n=R.a.loading);var o=this.transform(t.query).document,i=this.getVariables(o,t.variables),a=this.getQuery(e),s=a.networkStatus,c=t.fetchPolicy,u=void 0===c?"cache-first":c,l=t.errorPolicy,d=void 0===l?"none":l,f=t.returnPartialData,p=void 0!==f&&f,m=t.notifyOnNetworkStatusChange,h=void 0!==m&&m,g=t.context,v=void 0===g?{}:g;("cache-first"===u||"cache-and-network"===u||"network-only"===u||"no-cache"===u)&&h&&"number"==typeof s&&s!==n&&Object(R.b)(n)&&("cache-first"!==u&&(u="cache-and-network"),p=!0);var y=Object.assign({},t,{query:o,variables:i,fetchPolicy:u,errorPolicy:d,returnPartialData:p,notifyOnNetworkStatusChange:h,context:v}),b=function(e){return y.variables=e,r.fetchQueryByPolicy(a,y,n)};this.fetchCancelFns.set(e,(function(e){Promise.resolve().then((function(){return O.cancel(e)}))}));var O=new M(this.transform(y.query).hasClientExports?this.localState.addExportedVariables(y.query,y.variables,y.context).then(b):b(y.variables));return O.cleanup((function(){r.fetchCancelFns.delete(e);var n=t.nextFetchPolicy;n&&(t.nextFetchPolicy=void 0,t.fetchPolicy="function"==typeof n?n.call(t,t.fetchPolicy||"cache-first"):n)})),O},e.prototype.fetchQueryByPolicy=function(e,t,n){var o=this,i=t.query,a=t.variables,s=t.fetchPolicy,c=t.errorPolicy,u=t.returnPartialData,d=t.context;e.init({document:i,variables:a,networkStatus:n});var f=function(){return e.getDiff(a)},p=function(t,n){void 0===n&&(n=e.networkStatus||R.a.loading);var s=t.result;var c=function(e){return l.a.of(Object(r.a)({data:e,loading:Object(R.b)(n),networkStatus:n},t.complete?null:{partial:!0}))};return o.transform(i).hasForcedResolvers?o.localState.runResolvers({document:i,remoteResult:{data:s},context:d,variables:a,onlyRunForcedResolvers:!0}).then((function(e){return c(e.data)})):c(s)},m=function(t){return o.getResultsFromLink(e,t,{variables:a,context:d,fetchPolicy:s,errorPolicy:c})};switch(s){default:case"cache-first":return(h=f()).complete?[p(h,e.markReady())]:u?[p(h),m(!0)]:[m(!0)];case"cache-and-network":var h;return(h=f()).complete||u?[p(h),m(!0)]:[m(!0)];case"cache-only":return[p(f(),e.markReady())];case"network-only":return[m(!0)];case"no-cache":return[m(!1)];case"standby":return[]}},e.prototype.getQuery=function(e){return e&&!this.queries.has(e)&&this.queries.set(e,new z(this.cache)),this.queries.get(e)},e.prototype.prepareContext=function(e){void 0===e&&(e={});var t=this.localState.prepareContext(e);return Object(r.a)(Object(r.a)({},t),{clientAwareness:this.clientAwareness})},e}();n.d(t,"b",(function(){return K})),n.d(t,"a",(function(){return X}));function K(e,t){return Object(s.a)(e,t,t.variables&&{variables:Object(r.a)(Object(r.a)({},e.variables),t.variables)})}var X=function(){function e(e){var t=this;this.defaultOptions={},this.resetStoreCallbacks=[],this.clearStoreCallbacks=[];var n=e.uri,r=e.credentials,a=e.headers,s=e.cache,u=e.ssrMode,l=void 0!==u&&u,d=e.ssrForceFetchDelay,f=void 0===d?0:d,p=e.connectToDevTools,m=void 0===p?"object"==typeof window&&!window.__APOLLO_CLIENT__&&!1:p,h=e.queryDeduplication,g=void 0===h||h,v=e.defaultOptions,y=e.assumeImmutableResults,O=void 0!==y&&y,S=e.resolvers,C=e.typeDefs,A=e.fragmentMatcher,_=e.name,I=e.version,x=e.link;if(x||(x=n?new b({uri:n,credentials:r,headers:a}):i.a.empty()),!s)throw new o.a(9);this.link=x,this.cache=s,this.disableNetworkFetches=l||f>0,this.queryDeduplication=g,this.defaultOptions=v||{},this.typeDefs=C,f&&setTimeout((function(){return t.disableNetworkFetches=!1}),f),this.watchQuery=this.watchQuery.bind(this),this.query=this.query.bind(this),this.mutate=this.mutate.bind(this),this.resetStore=this.resetStore.bind(this),this.reFetchObservableQueries=this.reFetchObservableQueries.bind(this),m&&"object"==typeof window&&(window.__APOLLO_CLIENT__=this),this.version=c,this.localState=new U({cache:s,client:this,resolvers:S,fragmentMatcher:A}),this.queryManager=new q({cache:this.cache,link:this.link,queryDeduplication:g,ssrMode:l,clientAwareness:{name:_,version:I},localState:this.localState,assumeImmutableResults:O,onBroadcast:m?function(){t.devToolsHookCb&&t.devToolsHookCb({action:{},state:{queries:t.queryManager.getQueryStore(),mutations:t.queryManager.mutationStore||{}},dataWithOptimisticResults:t.cache.extract(!0)})}:void 0})}return e.prototype.stop=function(){this.queryManager.stop()},e.prototype.watchQuery=function(e){return this.defaultOptions.watchQuery&&(e=K(this.defaultOptions.watchQuery,e)),!this.disableNetworkFetches||"network-only"!==e.fetchPolicy&&"cache-and-network"!==e.fetchPolicy||(e=Object(r.a)(Object(r.a)({},e),{fetchPolicy:"cache-first"})),this.queryManager.watchQuery(e)},e.prototype.query=function(e){return this.defaultOptions.query&&(e=K(this.defaultOptions.query,e)),Object(o.b)("cache-and-network"!==e.fetchPolicy,10),this.disableNetworkFetches&&"network-only"===e.fetchPolicy&&(e=Object(r.a)(Object(r.a)({},e),{fetchPolicy:"cache-first"})),this.queryManager.query(e)},e.prototype.mutate=function(e){return this.defaultOptions.mutate&&(e=K(this.defaultOptions.mutate,e)),this.queryManager.mutate(e)},e.prototype.subscribe=function(e){return this.queryManager.startGraphQLSubscription(e)},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!1),this.cache.readQuery(e,t)},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!1),this.cache.readFragment(e,t)},e.prototype.writeQuery=function(e){this.cache.writeQuery(e),this.queryManager.broadcastQueries()},e.prototype.writeFragment=function(e){this.cache.writeFragment(e),this.queryManager.broadcastQueries()},e.prototype.__actionHookForDevTools=function(e){this.devToolsHookCb=e},e.prototype.__requestRaw=function(e){return Object(a.a)(this.link,e)},e.prototype.resetStore=function(){var e=this;return Promise.resolve().then((function(){return e.queryManager.clearStore()})).then((function(){return Promise.all(e.resetStoreCallbacks.map((function(e){return e()})))})).then((function(){return e.reFetchObservableQueries()}))},e.prototype.clearStore=function(){var e=this;return Promise.resolve().then((function(){return e.queryManager.clearStore()})).then((function(){return Promise.all(e.clearStoreCallbacks.map((function(e){return e()})))}))},e.prototype.onResetStore=function(e){var t=this;return this.resetStoreCallbacks.push(e),function(){t.resetStoreCallbacks=t.resetStoreCallbacks.filter((function(t){return t!==e}))}},e.prototype.onClearStore=function(e){var t=this;return this.clearStoreCallbacks.push(e),function(){t.clearStoreCallbacks=t.clearStoreCallbacks.filter((function(t){return t!==e}))}},e.prototype.reFetchObservableQueries=function(e){return this.queryManager.reFetchObservableQueries(e)},e.prototype.extract=function(e){return this.cache.extract(e)},e.prototype.restore=function(e){return this.cache.restore(e)},e.prototype.addResolvers=function(e){this.localState.addResolvers(e)},e.prototype.setResolvers=function(e){this.localState.setResolvers(e)},e.prototype.getResolvers=function(){return this.localState.getResolvers()},e.prototype.setLocalStateFragmentMatcher=function(e){this.localState.setFragmentMatcher(e)},e.prototype.setLink=function(e){this.link=this.queryManager.link=e},e}()},8227:function(e,t,n){"use strict";var r=n(20),o=n(8845);n.d(t,"a",(function(){return o.a}));const i=new r.c(()=>n.e(1943).then(n.bind(null,14186)));new r.b(i,e=>e.logJank)},8228:function(e,t,n){var r=n(11825);"string"==typeof r&&(r=[[e.i,r,""]]);var o={transform:void 0};n(77)(r,o);r.locals&&(e.exports=r.locals)},825:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return s}));var r=n(16),o=n(3);const i={viewStates:new r.ObservableMap,primaryComposeId:null,newMessageCreationInProgress:!1},a=Object(o.createStore)("compose",i),s=a()},829:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(20);const o=new r.c(()=>Promise.all([n.e(22),n.e(25),n.e(35),n.e(803)]).then(n.bind(null,1568))),i=new r.a(o,e=>e.generateColorScheme),a=new r.a(o,e=>e.getOptimalTextColorString)},830:function(e,t,n){e.exports=n(1285).Observable},831:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(300),o=n(586),i=function(){function e(){this.getFragmentDoc=Object(r.c)(o.c)}return e.prototype.recordOptimisticTransaction=function(e,t){this.performTransaction(e,t)},e.prototype.transformDocument=function(e){return e},e.prototype.identify=function(e){},e.prototype.gc=function(){return[]},e.prototype.modify=function(e){return!1},e.prototype.transformForLink=function(e){return e},e.prototype.readQuery=function(e,t){return void 0===t&&(t=!!e.optimistic),this.read({rootId:e.id||"ROOT_QUERY",query:e.query,variables:e.variables,returnPartialData:e.returnPartialData,optimistic:t})},e.prototype.readFragment=function(e,t){return void 0===t&&(t=!!e.optimistic),this.read({query:this.getFragmentDoc(e.fragment,e.fragmentName),variables:e.variables,rootId:e.id,returnPartialData:e.returnPartialData,optimistic:t})},e.prototype.writeQuery=function(e){return this.write({dataId:e.id||"ROOT_QUERY",result:e.data,query:e.query,variables:e.variables,broadcast:e.broadcast})},e.prototype.writeFragment=function(e){return this.write({dataId:e.id,result:e.data,variables:e.variables,query:this.getFragmentDoc(e.fragment,e.fragmentName),broadcast:e.broadcast})},e}()},8333:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=[{Id:"8d763f92-e8cb-4843-a9ef-9cba0dca8727",Function:"insertMeetingButton",Name:"BlueJeans",DisplayName:"BlueJeans Meeting",FlightName:"addin-everyMeetingOnlineClient-BlueJeans"},{Id:"7a91e319-a65d-4ceb-909b-12203561dbf5",Function:"apptOrganizerJoinMeetingButton",Name:"Webex",DisplayName:"Cisco Webex Scheduler",FlightName:"addin-everyMeetingOnlineClient-Webex"},{Id:"6df220fc-e48e-4469-8db1-6912ce109886",Function:"addMeetingApptButton",Name:"GoogleMeet",DisplayName:"GoogleMeet",FlightName:"addin-everyMeetingOnlineClient-GoogleMeet"},{Id:"39403046-5079-4d8b-a7d0-d540c95a3a5b",Function:"funcCreateMeetingButton",Name:"GoToMeeting",DisplayName:"GoToMeeting",FlightName:"addin-everyMeetingOnlineClient-GoToMeeting"},{Id:"0ef8b29f-ff7f-4603-b4f3-ea836b406f3f",Function:"addJioMeetButton",Name:"JioMeet",DisplayName:"JioMeet",FlightName:"addin-everyMeetingOnlineClient-JioMeet"},{Id:"a7ca6c74-33fb-43a4-a3e4-781078f0eff5",Function:"addZoomButton",Name:"Zoom",DisplayName:"Zoom",FlightName:"addin-everyMeetingOnlineClient-Zoom"}]},834:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(192);const o=r.a.GreyDark,i=r.a.Red},837:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(25),o=n(1304),i={http:{includeQuery:!0,includeExtensions:!1},headers:{accept:"*/*","content-type":"application/json"},options:{method:"POST"}},a=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var a=Object(r.a)(Object(r.a)({},t.options),{headers:t.headers,credentials:t.credentials}),c=t.http||{};n.forEach((function(e){a=Object(r.a)(Object(r.a)(Object(r.a)({},a),e.options),{headers:Object(r.a)(Object(r.a)({},a.headers),s(e.headers))}),e.credentials&&(a.credentials=e.credentials),c=Object(r.a)(Object(r.a)({},c),e.http)}));var u=e.operationName,l=e.extensions,d=e.variables,f=e.query,p={operationName:u,variables:d};return c.includeExtensions&&(p.extensions=l),c.includeQuery&&(p.query=Object(o.a)(f)),{options:a,body:p}};function s(e){if(e){var t=Object.create(null);return Object.keys(Object(e)).forEach((function(n){t[n.toLowerCase()]=e[n]})),t}return e}},838:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t,n){var r=new Error(n);throw r.name="ServerError",r.response=e,r.statusCode=e.status,r.result=t,r}},839:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(729),o=n(217),i={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},a=Object.freeze({});function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,s=void 0,c=Array.isArray(e),l=[e],d=-1,f=[],p=void 0,m=void 0,h=void 0,g=[],v=[],y=e;do{var b=++d===l.length,O=b&&0!==f.length;if(b){if(m=0===v.length?void 0:g[g.length-1],p=h,h=v.pop(),O){if(c)p=p.slice();else{for(var S={},C=0,A=Object.keys(p);C<A.length;C++){var _=A[C];S[_]=p[_]}p=S}for(var I=0,x=0;x<f.length;x++){var E=f[x][0],T=f[x][1];c&&(E-=I),c&&null===T?(p.splice(E,1),I++):p[E]=T}}d=s.index,l=s.keys,f=s.edits,c=s.inArray,s=s.prev}else{if(m=h?c?d:l[d]:void 0,null==(p=h?h[m]:y))continue;h&&g.push(m)}var w,M=void 0;if(!Array.isArray(p)){if(!Object(o.c)(p))throw new Error("Invalid AST Node: ".concat(Object(r.a)(p),"."));var k=u(t,p.kind,b);if(k){if((M=k.call(t,p,m,h,g,v))===a)break;if(!1===M){if(!b){g.pop();continue}}else if(void 0!==M&&(f.push([m,M]),!b)){if(!Object(o.c)(M)){g.pop();continue}p=M}}}if(void 0===M&&O&&f.push([m,p]),b)g.pop();else s={inArray:c,index:d,keys:l,edits:f,prev:s},l=(c=Array.isArray(p))?p:null!==(w=n[p.kind])&&void 0!==w?w:[],d=-1,f=[],h&&v.push(h),h=p}while(void 0!==s);return 0!==f.length&&(y=f[f.length-1][1]),y}function c(e){var t=new Array(e.length);return{enter:function(n){for(var r=0;r<e.length;r++)if(null==t[r]){var o=u(e[r],n.kind,!1);if(o){var i=o.apply(e[r],arguments);if(!1===i)t[r]=n;else if(i===a)t[r]=a;else if(void 0!==i)return i}}},leave:function(n){for(var r=0;r<e.length;r++)if(null==t[r]){var o=u(e[r],n.kind,!0);if(o){var i=o.apply(e[r],arguments);if(i===a)t[r]=a;else if(void 0!==i&&!1!==i)return i}}else t[r]===n&&(t[r]=null)}}}function u(e,t,n){var r=e[t];if(r){if(!n&&"function"==typeof r)return r;var o=n?r.leave:r.enter;if("function"==typeof o)return o}else{var i=n?e.leave:e.enter;if(i){if("function"==typeof i)return i;var a=i[t];if("function"==typeof a)return a}}}},840:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1056),o=n(645);function i(e){var t=e.prototype.toJSON;"function"==typeof t||Object(r.a)(0),e.prototype.inspect=t,o.a&&(e.prototype[o.a]=t)}},841:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u}));var r=n(714),o=n(729),i=n(750),a=n(1080);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GraphQL request",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{line:1,column:1};"string"==typeof e||Object(i.a)(0,"Body must be a string. Received: ".concat(Object(o.a)(e),".")),this.body=e,this.name=t,this.locationOffset=n,this.locationOffset.line>0||Object(i.a)(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Object(i.a)(0,"column in locationOffset is 1-indexed and must be positive.")}var t,n,a;return t=e,(n=[{key:r.c,get:function(){return"Source"}}])&&s(t.prototype,n),a&&s(t,a),e}();function u(e){return Object(a.a)(e,c)}},842:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(318),o=n(217),i=n(43),a=n(743),s=function(){function e(e){var t=new o.b(i.a.SOF,0,0,0,0,null);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){return this.lastToken=this.token,this.token=this.lookahead()},t.lookahead=function(){var e=this.token;if(e.kind!==i.a.EOF)do{var t;e=null!==(t=e.next)&&void 0!==t?t:e.next=l(this,e)}while(e.kind===i.a.COMMENT);return e},e}();function c(e){return e===i.a.BANG||e===i.a.DOLLAR||e===i.a.AMP||e===i.a.PAREN_L||e===i.a.PAREN_R||e===i.a.SPREAD||e===i.a.COLON||e===i.a.EQUALS||e===i.a.AT||e===i.a.BRACKET_L||e===i.a.BRACKET_R||e===i.a.BRACE_L||e===i.a.PIPE||e===i.a.BRACE_R}function u(e){return isNaN(e)?i.a.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'.concat(("00"+e.toString(16).toUpperCase()).slice(-4),'"')}function l(e,t){for(var n=e.source,a=n.body,s=a.length,c=t.end;c<s;){var u=a.charCodeAt(c),l=e.line,m=1+c-e.lineStart;switch(u){case 65279:case 9:case 32:case 44:++c;continue;case 10:++c,++e.line,e.lineStart=c;continue;case 13:10===a.charCodeAt(c+1)?c+=2:++c,++e.line,e.lineStart=c;continue;case 33:return new o.b(i.a.BANG,c,c+1,l,m,t);case 35:return f(n,c,l,m,t);case 36:return new o.b(i.a.DOLLAR,c,c+1,l,m,t);case 38:return new o.b(i.a.AMP,c,c+1,l,m,t);case 40:return new o.b(i.a.PAREN_L,c,c+1,l,m,t);case 41:return new o.b(i.a.PAREN_R,c,c+1,l,m,t);case 46:if(46===a.charCodeAt(c+1)&&46===a.charCodeAt(c+2))return new o.b(i.a.SPREAD,c,c+3,l,m,t);break;case 58:return new o.b(i.a.COLON,c,c+1,l,m,t);case 61:return new o.b(i.a.EQUALS,c,c+1,l,m,t);case 64:return new o.b(i.a.AT,c,c+1,l,m,t);case 91:return new o.b(i.a.BRACKET_L,c,c+1,l,m,t);case 93:return new o.b(i.a.BRACKET_R,c,c+1,l,m,t);case 123:return new o.b(i.a.BRACE_L,c,c+1,l,m,t);case 124:return new o.b(i.a.PIPE,c,c+1,l,m,t);case 125:return new o.b(i.a.BRACE_R,c,c+1,l,m,t);case 34:return 34===a.charCodeAt(c+1)&&34===a.charCodeAt(c+2)?g(n,c,l,m,t,e):h(n,c,l,m,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return p(n,c,u,l,m,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return y(n,c,l,m,t)}throw Object(r.a)(n,c,d(u))}var v=e.line,b=1+c-e.lineStart;return new o.b(i.a.EOF,s,s,v,b,t)}function d(e){return e<32&&9!==e&&10!==e&&13!==e?"Cannot contain the invalid character ".concat(u(e),"."):39===e?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character ".concat(u(e),".")}function f(e,t,n,r,a){var s,c=e.body,u=t;do{s=c.charCodeAt(++u)}while(!isNaN(s)&&(s>31||9===s));return new o.b(i.a.COMMENT,t,u,n,r,a,c.slice(t+1,u))}function p(e,t,n,a,s,c){var l=e.body,d=n,f=t,p=!1;if(45===d&&(d=l.charCodeAt(++f)),48===d){if((d=l.charCodeAt(++f))>=48&&d<=57)throw Object(r.a)(e,f,"Invalid number, unexpected digit after 0: ".concat(u(d),"."))}else f=m(e,f,d),d=l.charCodeAt(f);if(46===d&&(p=!0,d=l.charCodeAt(++f),f=m(e,f,d),d=l.charCodeAt(f)),69!==d&&101!==d||(p=!0,43!==(d=l.charCodeAt(++f))&&45!==d||(d=l.charCodeAt(++f)),f=m(e,f,d),d=l.charCodeAt(f)),46===d||function(e){return 95===e||e>=65&&e<=90||e>=97&&e<=122}(d))throw Object(r.a)(e,f,"Invalid number, expected digit but got: ".concat(u(d),"."));return new o.b(p?i.a.FLOAT:i.a.INT,t,f,a,s,c,l.slice(t,f))}function m(e,t,n){var o=e.body,i=t,a=n;if(a>=48&&a<=57){do{a=o.charCodeAt(++i)}while(a>=48&&a<=57);return i}throw Object(r.a)(e,i,"Invalid number, expected digit but got: ".concat(u(a),"."))}function h(e,t,n,a,s){for(var c,l,d,f,p=e.body,m=t+1,h=m,g=0,y="";m<p.length&&!isNaN(g=p.charCodeAt(m))&&10!==g&&13!==g;){if(34===g)return y+=p.slice(h,m),new o.b(i.a.STRING,t,m+1,n,a,s,y);if(g<32&&9!==g)throw Object(r.a)(e,m,"Invalid character within String: ".concat(u(g),"."));if(++m,92===g){switch(y+=p.slice(h,m-1),g=p.charCodeAt(m)){case 34:y+='"';break;case 47:y+="/";break;case 92:y+="\\";break;case 98:y+="\b";break;case 102:y+="\f";break;case 110:y+="\n";break;case 114:y+="\r";break;case 116:y+="\t";break;case 117:var b=(c=p.charCodeAt(m+1),l=p.charCodeAt(m+2),d=p.charCodeAt(m+3),f=p.charCodeAt(m+4),v(c)<<12|v(l)<<8|v(d)<<4|v(f));if(b<0){var O=p.slice(m+1,m+5);throw Object(r.a)(e,m,"Invalid character escape sequence: \\u".concat(O,"."))}y+=String.fromCharCode(b),m+=4;break;default:throw Object(r.a)(e,m,"Invalid character escape sequence: \\".concat(String.fromCharCode(g),"."))}h=++m}}throw Object(r.a)(e,m,"Unterminated string.")}function g(e,t,n,s,c,l){for(var d=e.body,f=t+3,p=f,m=0,h="";f<d.length&&!isNaN(m=d.charCodeAt(f));){if(34===m&&34===d.charCodeAt(f+1)&&34===d.charCodeAt(f+2))return h+=d.slice(p,f),new o.b(i.a.BLOCK_STRING,t,f+3,n,s,c,Object(a.a)(h));if(m<32&&9!==m&&10!==m&&13!==m)throw Object(r.a)(e,f,"Invalid character within String: ".concat(u(m),"."));10===m?(++f,++l.line,l.lineStart=f):13===m?(10===d.charCodeAt(f+1)?f+=2:++f,++l.line,l.lineStart=f):92===m&&34===d.charCodeAt(f+1)&&34===d.charCodeAt(f+2)&&34===d.charCodeAt(f+3)?(h+=d.slice(p,f)+'"""',p=f+=4):++f}throw Object(r.a)(e,f,"Unterminated string.")}function v(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function y(e,t,n,r,a){for(var s=e.body,c=s.length,u=t+1,l=0;u!==c&&!isNaN(l=s.charCodeAt(u))&&(95===l||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122);)++u;return new o.b(i.a.NAME,t,u,n,r,a,s.slice(t,u))}},849:function(e,t,n){"use strict";var r,o={themeDarker:"#004578",themeDark:"#005a9e",themeDarkAlt:"#106ebe",themePrimary:"#0078d4",themeSecondary:"#2b88d8",themeTertiary:"#71afe5",themeLight:"#c7e0f4",themeLighter:"#deecf9",themeLighterAlt:"#eff6fc",black:"#000000",blackTranslucent40:"rgba(0,0,0,.4)",neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",accent:"#0078d4",white:"#ffffff",whiteTranslucent40:"rgba(255,255,255,.4)",yellowDark:"#d29200",yellow:"#ffb900",yellowLight:"#fff100",orange:"#d83b01",orangeLight:"#ea4300",orangeLighter:"#ff8c00",redDark:"#a4262c",red:"#e81123",magentaDark:"#5c005c",magenta:"#b4009e",magentaLight:"#e3008c",purpleDark:"#32145a",purple:"#5c2d91",purpleLight:"#b4a0ff",blueDark:"#002050",blueMid:"#00188f",blue:"#0078d4",blueLight:"#00bcf2",tealDark:"#004b50",teal:"#008272",tealLight:"#00b294",greenDark:"#004b1c",green:"#107c10",greenLight:"#bad80a"};!function(e){e.depth0="0 0 0 0 transparent",e.depth4="0 1.6px 3.6px 0 rgba(0, 0, 0, 0.132), 0 0.3px 0.9px 0 rgba(0, 0, 0, 0.108)",e.depth8="0 3.2px 7.2px 0 rgba(0, 0, 0, 0.132), 0 0.6px 1.8px 0 rgba(0, 0, 0, 0.108)",e.depth16="0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",e.depth64="0 25.6px 57.6px 0 rgba(0, 0, 0, 0.22), 0 4.8px 14.4px 0 rgba(0, 0, 0, 0.18)"}(r||(r={}));var i,a,s,c,u,l={elevation4:r.depth4,elevation8:r.depth8,elevation16:r.depth16,elevation64:r.depth64,roundedCorner2:"2px",roundedCorner4:"4px",roundedCorner6:"6px"},d=n(489);!function(e){e.Arabic="Segoe UI Web (Arabic)",e.Cyrillic="Segoe UI Web (Cyrillic)",e.EastEuropean="Segoe UI Web (East European)",e.Greek="Segoe UI Web (Greek)",e.Hebrew="Segoe UI Web (Hebrew)",e.Thai="Leelawadee UI Web",e.Vietnamese="Segoe UI Web (Vietnamese)",e.WestEuropean="Segoe UI Web (West European)",e.Selawik="Selawik Web",e.Armenian="Segoe UI Web (Armenian)",e.Georgian="Segoe UI Web (Georgian)"}(i||(i={})),function(e){e.Arabic="'"+i.Arabic+"'",e.ChineseSimplified="'Microsoft Yahei UI', Verdana, Simsun",e.ChineseTraditional="'Microsoft Jhenghei UI', Pmingliu",e.Cyrillic="'"+i.Cyrillic+"'",e.EastEuropean="'"+i.EastEuropean+"'",e.Greek="'"+i.Greek+"'",e.Hebrew="'"+i.Hebrew+"'",e.Hindi="'Nirmala UI'",e.Japanese="'Yu Gothic UI', 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka",e.Korean="'Malgun Gothic', Gulim",e.Selawik="'"+i.Selawik+"'",e.Thai="'Leelawadee UI Web', 'Kmer UI'",e.Vietnamese="'"+i.Vietnamese+"'",e.WestEuropean="'"+i.WestEuropean+"'",e.Armenian="'"+i.Armenian+"'",e.Georgian="'"+i.Georgian+"'"}(a||(a={})),function(e){e.size10="10px",e.size12="12px",e.size14="14px",e.size16="16px",e.size18="18px",e.size20="20px",e.size24="24px",e.size28="28px",e.size32="32px",e.size42="42px",e.size68="68px",e.mini="10px",e.xSmall="10px",e.small="12px",e.smallPlus="12px",e.medium="14px",e.mediumPlus="16px",e.icon="16px",e.large="18px",e.xLarge="20px",e.xLargePlus="24px",e.xxLarge="28px",e.xxLargePlus="32px",e.superLarge="42px",e.mega="68px"}(s||(s={})),function(e){e.light=100,e.semilight=300,e.regular=400,e.semibold=600,e.bold=700}(c||(c={})),function(e){e.xSmall="10px",e.small="12px",e.medium="16px",e.large="20px"}(u||(u={}));var f="'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif",p="'Segoe UI', '"+i.WestEuropean+"'",m={ar:a.Arabic,bg:a.Cyrillic,cs:a.EastEuropean,el:a.Greek,et:a.EastEuropean,he:a.Hebrew,hi:a.Hindi,hr:a.EastEuropean,hu:a.EastEuropean,ja:a.Japanese,kk:a.EastEuropean,ko:a.Korean,lt:a.EastEuropean,lv:a.EastEuropean,pl:a.EastEuropean,ru:a.Cyrillic,sk:a.EastEuropean,"sr-latn":a.EastEuropean,th:a.Thai,tr:a.EastEuropean,uk:a.Cyrillic,vi:a.Vietnamese,"zh-hans":a.ChineseSimplified,"zh-hant":a.ChineseTraditional,hy:a.Armenian,ka:a.Georgian};function h(e,t,n){return{fontFamily:n,MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontSize:e,fontWeight:t}}var g,v,y,b,O,S=n(543),C=n(45),A="https://static2.sharepointonline.com/files/fabric/assets",_=(g=Object(S.a)(),v=function(e){for(var t in m)if(m.hasOwnProperty(t)&&e&&0===t.indexOf(e))return m[t];return p}(g)+", "+f,{tiny:h(s.mini,c.regular,v),xSmall:h(s.xSmall,c.regular,v),small:h(s.small,c.regular,v),smallPlus:h(s.smallPlus,c.regular,v),medium:h(s.medium,c.regular,v),mediumPlus:h(s.mediumPlus,c.regular,v),large:h(s.large,c.regular,v),xLarge:h(s.xLarge,c.semibold,v),xLargePlus:h(s.xLargePlus,c.semibold,v),xxLarge:h(s.xxLarge,c.semibold,v),xxLargePlus:h(s.xxLargePlus,c.semibold,v),superLarge:h(s.superLarge,c.semibold,v),mega:h(s.mega,c.semibold,v)});function I(e,t,n,r){e="'"+e+"'";var o=void 0!==r?"local('"+r+"'),":"";Object(d.a)({fontFamily:e,src:o+"url('"+t+".woff2') format('woff2'),url('"+t+".woff') format('woff')",fontWeight:n,fontStyle:"normal",fontDisplay:"swap"})}function x(e,t,n,r,o){void 0===r&&(r="segoeui");var i=e+"/"+n+"/"+r;I(t,i+"-light",c.light,o&&o+" Light"),I(t,i+"-semilight",c.semilight,o&&o+" SemiLight"),I(t,i+"-regular",c.regular,o),I(t,i+"-semibold",c.semibold,o&&o+" SemiBold"),I(t,i+"-bold",c.bold,o&&o+" Bold")}!function(e){if(e){var t=e+"/fonts";x(t,i.Thai,"leelawadeeui-thai","leelawadeeui"),x(t,i.Arabic,"segoeui-arabic"),x(t,i.Cyrillic,"segoeui-cyrillic"),x(t,i.EastEuropean,"segoeui-easteuropean"),x(t,i.Greek,"segoeui-greek"),x(t,i.Hebrew,"segoeui-hebrew"),x(t,i.Vietnamese,"segoeui-vietnamese"),x(t,i.WestEuropean,"segoeui-westeuropean","segoeui","Segoe UI"),x(t,a.Selawik,"selawik","selawik"),x(t,i.Armenian,"segoeui-armenian"),x(t,i.Georgian,"segoeui-georgian"),I("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-semilight",c.light),I("Leelawadee UI Web",t+"/leelawadeeui-thai/leelawadeeui-bold",c.semibold)}}((O=null===(y=Object(C.a)())||void 0===y?void 0:y.FabricConfig,null!==(b=null==O?void 0:O.fontBaseUrl)&&void 0!==b?b:A));var E=n(644),T={s2:"4px",s1:"8px",m:"16px",l1:"20px",l2:"32px"},w=n(443);function M(e,t){void 0===e&&(e={}),void 0===t&&(t=!1);var n=!!e.isInverted,r={palette:o,effects:l,fonts:_,spacing:T,isInverted:n,disableGlobalClassNames:!1,semanticColors:Object(w.b)(o,l,void 0,n,t),rtl:void 0};return Object(E.a)(r,e)}n.d(t,"a",(function(){return M}))},8524:function(e,t,n){"use strict";var r=n(7006),o=n(1785),i=n(4956),a=n(1810);function s(e,t,n){var s;const c=Object(o.c)(e);if(!c)return;const u=c.mode,l=Object(i.c)(u);if(!l)return;const d=Object(r.c)(l.addinId,l.commandId,u);if((null===(s=c.isSharedItem)||void 0===s?void 0:s.call(c))&&!Object(a.f)(d))return;if(!d||Object(r.f)(d))return void(!d&&Object(a.O)()&&Object(i.h)(u,null));const f=Object(a.z)();Object(a.cb)(f,e,d,"Persistent",u,t,n)}var c=n(5929),u=n(1797);function l(e){var t;const n=Object(o.c)(e),r=n.mode;return(null===(t=n.isSharedItem)||void 0===t||!t.call(n))&&(r!==u.a.MessageRead||Object(a.eb)(n.getItemWithUnsafeIdsImmediate()))}function d(e){switch(Object(o.c)(e).mode){case u.a.MessageRead:case u.a.MeetingRequest:return u.a.MessageRead;case u.a.MessageCompose:return u.a.MessageCompose;default:return u.a.Unknown}}function f(e,t){const n=Object(o.c)(e),r=Object(a.E)("Persistent",e,t);return!!r&&(!Object(a.f)(r.addinCommand)&&!!(n&&n.isSharedItem&&n.isSharedItem()))}var p=n(5241),m=n(4456);function h(e,t){var n;const r=null===(n=Object(c.a)())||void 0===n?void 0:n.hostItemIndex,o=Object(a.E)("Persistent",r,t),i=null==o?void 0:o.controlId;1!==e&&2!==e||function(e){Object(m.d)(m.a.ITEM_CHANGED_EVENT_DISPID,e,null)}(i),Object(c.b)(),Object(a.hb)("Persistent",r,t)}function g(e,t){var n;const r=null===(n=Object(c.a)())||void 0===n?void 0:n.hostItemIndex,o=Object(a.E)("Persistent",r,t),u=d(e);Object(i.c)(u)?Object(c.c)({hostItemIndex:e,mode:u}):Object(c.b)(),o?(Object(a.ub)(r,e,t),async function(e,t){const n=await Object(p.b)(t,e);Object(m.d)(m.a.ITEM_CHANGED_EVENT_DISPID,t,n)}(e,o.controlId)):s(e,t)}var v=n(5767),y=n(2648);function b(e,t,n=window){if(Object(v.b)())switch(e){case y.a.NotSupported:h(3,n);break;case y.a.Empty:h(1,n),Object(a.rb)("exfc_main");break;case y.a.Multi:h(2,n);break;case y.a.Single:t&&function(e,t){var n;if(!Object(p.g)(e)||!Object(a.O)()||!Object(i.e)()||function(e){const t=Object(o.c)(e);return t.mode===u.a.MessageRead&&t.isInlineComposeOpen()}(e)||!function(e){const t=Object(o.c)(e);return t.mode!==u.a.MessageRead||t.isItemSelected()}(e)||t==window&&function(e){return e===Object(c.a)().hostItemIndex}(e))return;if(t==window)if(l(e))if(f(e,t))h(4,t);else if(function(e){return d(e)!==Object(c.a)().mode}(e)){!function(e,t,n){const r=d(t);Object(i.c)(r)?Object(c.c)({hostItemIndex:t,mode:r}):Object(c.b)(),Object(a.hb)("Persistent",e,n),s(t,n)}(null===(n=Object(c.a)())||void 0===n?void 0:n.hostItemIndex,e,t)}else g(e,t);else h(3,t);else l(e)&&!f(e,t)&&(Object(c.b)(),s(e,t))}(t,n)}}n.d(t,"a",(function(){return b}))},8548:function(e,t,n){"use strict";function r(e){let t=[];return e&&(t=e.map(e=>({Mailbox:e}))),t}var o=n(1817),i=n(7),a=n(2280);function s(e,t,n,s,c,u,l,d,f,p){const m=r(n),h=r(s),g=c?Object(i.o)(new Date(c)):Object(i.Ub)(),v=u?Object(i.o)(new Date(u)):void 0;let y=void 0;if(l){const e=Object(o.m)(l),t=Object(o.j)(e)[0];t&&(y=[t])}let b=void 0;if(d){const e=d.filter(e=>!!e);(null==e?void 0:e.length)>0&&(b=e.map(e=>({Mailbox:{EmailAddress:e}})))}let O=void 0;p&&(O={Value:p,BodyType:"HTML"}),Object(a.a)({fullComposeEntrySource:e,eventUpdates:{ParentFolderId:t,RequiredAttendees:m,OptionalAttendees:h,Start:g,End:v,Locations:y,Resources:b,Subject:f,Body:O}})}n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}))},8583:function(e,t,n){"use strict";var r=n(38);function o(){return function(){var e;const t=null===(e=Object(r.a)().SessionSettings)||void 0===e?void 0:e.WebSessionType;if(1===t)return"outlookCom";if(2===t)return"gmail";if(0==t)return"office365";return"unknown"}()}n.d(t,"a",(function(){return o}))},8845:function(e,t,n){"use strict";t.a=function(){return window.performance?performance.now():Date.now()}},8846:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(7010),o=n(1785),i=n(4956),a=n(1810);function s(e,t,n,s,c){var u;Object(r.a)(e,s);const l=Object(a.E)("Persistent",e,s);if(l&&(d=l.addinCommand,f=t,d&&f&&d.get_Id()===f.get_Id()))return;var d,f;l&&s!==window&&Object(a.hb)("Persistent",e,s);const p=Object(o.c)(e);(null===(u=p)||void 0===u?void 0:u.openTaskPane)&&p.openTaskPane();const m=Object(a.z)();Object(a.cb)(m,e,t,function(e,t){const n=Object(i.c)(t);if(!n)return"NonPersistent";const{addinId:r,commandId:o}=n;return e.get_Id()===`${r}${o}`?"Persistent":"NonPersistent"}(t,n),n,s,c)}},8865:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=n(4670),o=n(2111);const i=function(e={conversationReadingPaneState:Object(o.a)()}){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.itemPart:null},a=function(e={conversationReadingPaneState:Object(o.a)()}){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.focusedItemPart)?e.conversationReadingPaneState.focusedItemPart.focusedItemArea:null},s=function(e={conversationReadingPaneState:Object(o.a)()}){var t;return(null===(t=e.conversationReadingPaneState)||void 0===t?void 0:t.initiallySelectedItemPart)?e.conversationReadingPaneState.initiallySelectedItemPart.itemPart:null},c=function(e,t={conversationReadingPaneState:Object(o.a)()}){const n=i(t),s=a(t);return n==e&&s==r.a.Item}},905:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"ItemId:#Exchange"},e)}n.d(t,"a",(function(){return r}))},906:function(e,t,n){"use strict";n.r(t),n.d(t,"propTypes",(function(){return P})),n.d(t,"PropTypes",(function(){return P})),n.d(t,"onError",(function(){return ve})),n.d(t,"observer",(function(){return ie})),n.d(t,"Observer",(function(){return ae})),n.d(t,"renderReporter",(function(){return z})),n.d(t,"componentByNodeRegistery",(function(){return V})),n.d(t,"componentByNodeRegistry",(function(){return V})),n.d(t,"trackComponents",(function(){return Y})),n.d(t,"useStaticRendering",(function(){return Z})),n.d(t,"Provider",(function(){return me})),n.d(t,"inject",(function(){return F}));var r=n(16),o=n(0),i=n.n(o),a=n(173),s={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},c={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},u=Object.defineProperty,l=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,m=p&&p(Object);var h=function e(t,n,r){if("string"!=typeof n){if(m){var o=p(n);o&&o!==m&&e(t,o,r)}var i=l(n);d&&(i=i.concat(d(n)));for(var a=0;a<i.length;++a){var h=i[a];if(!(s[h]||c[h]||r&&r[h])){var g=f(n,h);try{u(t,h,g)}catch(e){}}}return t}return t},g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v=(function(){function e(e){this.value=e}function t(t){var n,r;function o(n,r){try{var a=t[n](r),s=a.value;s instanceof e?Promise.resolve(s.value).then((function(e){o("next",e)}),(function(e){o("throw",e)})):i(a.done?"return":"normal",a.value)}catch(e){i("throw",e)}}function i(e,t){switch(e){case"return":n.resolve({value:t,done:!0});break;case"throw":n.reject(t);break;default:n.resolve({value:t,done:!1})}(n=n.next)?o(n.key,n.arg):r=null}this._invoke=function(e,t){return new Promise((function(i,a){var s={key:e,arg:t,resolve:i,reject:a,next:null};r?r=r.next=s:(n=r=s,o(e,t))}))},"function"!=typeof t.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(e){return this._invoke("next",e)},t.prototype.throw=function(e){return this._invoke("throw",e)},t.prototype.return=function(e){return this._invoke("return",e)}}(),function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},O=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},S=function(){function e(){v(this,e),this.listeners=[]}return y(e,[{key:"on",value:function(e){var t=this;return this.listeners.push(e),function(){var n=t.listeners.indexOf(e);-1!==n&&t.listeners.splice(n,1)}}},{key:"emit",value:function(e){this.listeners.forEach((function(t){return t(e)}))}}]),e}();function C(e){function t(t,n,o,i,a,s){for(var c=arguments.length,u=Array(c>6?c-6:0),l=6;l<c;l++)u[l-6]=arguments[l];return Object(r.untracked)((function(){if(i=i||"<<anonymous>>",s=s||o,null==n[o]){if(t){var r=null===n[o]?"null":"undefined";return new Error("The "+a+" `"+s+"` is marked as required in `"+i+"`, but its value is `"+r+"`.")}return null}return e.apply(void 0,[n,o,i,a,s].concat(u))}))}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function A(e){var t=void 0===e?"undefined":g(e);return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function _(e,t){return C((function(n,o,i,a,s){return Object(r.untracked)((function(){if(e&&A(n[o])===t.toLowerCase())return null;var a=void 0;switch(t){case"Array":a=r.isObservableArray;break;case"Object":a=r.isObservableObject;break;case"Map":a=r.isObservableMap;break;default:throw new Error("Unexpected mobxType: "+t)}var c=n[o];if(!a(c)){var u=function(e){var t=A(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}(c),l=e?" or javascript `"+t.toLowerCase()+"`":"";return new Error("Invalid prop `"+s+"` of type `"+u+"` supplied to `"+i+"`, expected `mobx.Observable"+t+"`"+l+".")}return null}))}))}function I(e,t){return C((function(n,o,i,a,s){for(var c=arguments.length,u=Array(c>5?c-5:0),l=5;l<c;l++)u[l-5]=arguments[l];return Object(r.untracked)((function(){if("function"!=typeof t)return new Error("Property `"+s+"` of component `"+i+"` has invalid PropType notation.");var r=_(e,"Array")(n,o,i);if(r instanceof Error)return r;for(var c=n[o],l=0;l<c.length;l++)if((r=t.apply(void 0,[c,l,i,a,s+"["+l+"]"].concat(u)))instanceof Error)return r;return null}))}))}var x=_(!1,"Array"),E=I.bind(null,!1),T=_(!1,"Map"),w=_(!1,"Object"),M=_(!0,"Array"),k=I.bind(null,!0),j=_(!0,"Object"),P=Object.freeze({observableArray:x,observableArrayOf:E,observableMap:T,observableObject:w,arrayOrObservableArray:M,arrayOrObservableArrayOf:k,objectOrObservableObject:j});var R={mobxStores:j};Object.seal(R);var N={contextTypes:{get:function(){return R},set:function(e){},configurable:!0,enumerable:!1},isMobxInjector:{value:!0,writable:!0,configurable:!0,enumerable:!0}};function D(e,t,n){var r,i,a="inject-"+(t.displayName||t.name||t.constructor&&t.constructor.name||"Unknown");n&&(a+="-with-"+n);var s=(i=r=function(n){function r(){var e,t,n;v(this,r);for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];return t=n=O(this,(e=r.__proto__||Object.getPrototypeOf(r)).call.apply(e,[this].concat(i))),n.storeRef=function(e){n.wrappedInstance=e},O(n,t)}return b(r,n),y(r,[{key:"render",value:function(){var n={};for(var r in this.props)this.props.hasOwnProperty(r)&&(n[r]=this.props[r]);var i=e(this.context.mobxStores||{},n,this.context)||{};for(var a in i)n[a]=i[a];return function(e){return!(e.prototype&&e.prototype.render)}(t)||(n.ref=this.storeRef),Object(o.createElement)(t,n)}}]),r}(o.Component),r.displayName=a,i);return h(s,t),s.wrappedComponent=t,Object.defineProperties(s,N),s}function F(){var e=void 0;if("function"==typeof arguments[0])return e=arguments[0],function(t){var n=D(e,t);return n.isMobxInjector=!1,(n=ie(n)).isMobxInjector=!0,n};for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e=function(e){return function(t,n){return e.forEach((function(e){if(!(e in n)){if(!(e in t))throw new Error("MobX injector: Store '"+e+"' is not available! Make sure it is provided by some Provider");n[e]=t[e]}})),n}}(t),function(n){return D(e,n,t.join("-"))}}var L=r.$mobx||"$mobx",U=!1,B=!1,H=!1,V="undefined"!=typeof WeakMap?new WeakMap:void 0,z=new S,W={};function G(e){return W[e]||(W[e]=function(e){return"function"==typeof Symbol?Symbol(e):"$mobxReactProp$"+e+Math.random()}(e)),W[e]}var q=G("skipRender"),K=G("isForcingUpdate");function X(e,t,n){Object.hasOwnProperty.call(e,t)?e[t]=n:Object.defineProperty(e,t,{enumerable:!1,configurable:!0,writable:!0,value:n})}function Q(e){if(a.findDOMNode)try{return Object(a.findDOMNode)(e)}catch(e){return null}return null}function J(e){var t=Q(e);t&&V&&V.set(t,e),z.emit({event:"render",renderTime:e.__$mobRenderEnd-e.__$mobRenderStart,totalTime:Date.now()-e.__$mobRenderStart,component:e,node:t})}function Y(){if("undefined"==typeof WeakMap)throw new Error("[mobx-react] tracking components is not supported in this browser.");U||(U=!0)}function Z(e){B=e}var $=new S;function ee(e,t){if(te(e,t))return!0;if("object"!==(void 0===e?"undefined":g(e))||null===e||"object"!==(void 0===t?"undefined":g(t))||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(!hasOwnProperty.call(t,n[o])||!te(e[n[o]],t[n[o]]))return!1;return!0}function te(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function ne(e){var t=this;if(!0===B)return e.call(this);function n(){var e=this;c=!1;var t=void 0,n=void 0;if(u.track((function(){U&&(e.__$mobRenderStart=Date.now());try{n=Object(r._allowStateChanges)(!1,s)}catch(e){t=e}U&&(e.__$mobRenderEnd=Date.now())})),t)throw $.emit(t),t;return n}var i=this.displayName||this.name||this.constructor&&(this.constructor.displayName||this.constructor.name)||"<component>",a=this._reactInternalInstance&&this._reactInternalInstance._rootNodeID||this._reactInternalInstance&&this._reactInternalInstance._debugID||this._reactInternalFiber&&this._reactInternalFiber._debugID;X(this,q,!1),X(this,K,!1);var s=e.bind(this),c=!1,u=new r.Reaction(i+"#"+a+".render()",(function(){if(!c&&(c=!0,"function"==typeof t.componentWillReact&&t.componentWillReact(),!0!==t.__$mobxIsUnmounted)){var e=!0;try{X(t,K,!0),t[q]||o.Component.prototype.forceUpdate.call(t),e=!1}finally{X(t,K,!1),e&&u.dispose()}}}));return u.reactComponent=this,n[L]=u,this.render=n,n.call(this)}var re={componentWillUnmount:function(){if(!0!==B&&(this.render[L]&&this.render[L].dispose(),this.__$mobxIsUnmounted=!0,U)){var e=Q(this);e&&V&&V.delete(e),z.emit({event:"destroy",component:this,node:e})}},componentDidMount:function(){U&&J(this)},componentDidUpdate:function(){U&&J(this)},shouldComponentUpdate:function(e,t){return this.state!==t||!ee(this.props,e)}};function oe(e,t){var n=G(t+" value holder"),o=G(t+" atom holder");function i(){return this[o]||X(this,o,Object(r.createAtom)("reactive "+t)),this[o]}Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:function(){return i.call(this).reportObserved(),this[n]},set:function(e){this[K]||ee(this[n],e)?X(this,n,e):(X(this,n,e),X(this,q,!0),i.call(this).reportChanged(),X(this,q,!1))}})}function ie(e,t){if("string"==typeof e)throw new Error("Store names should be provided as array");if(Array.isArray(e))return H||(H=!0),t?F.apply(null,e)(ie(t)):function(t){return ie(e,t)};var n=e;if(n.isMobxInjector,n.__proto__,o.PureComponent,!("function"!=typeof n||n.prototype&&n.prototype.render||n.isReactClass||o.Component.isPrototypeOf(n))){var r,i,a=ie((i=r=function(e){function t(){return v(this,t),O(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return b(t,e),y(t,[{key:"render",value:function(){return n.call(this,this.props,this.context)}}]),t}(o.Component),r.displayName=n.displayName||n.name,r.contextTypes=n.contextTypes,r.propTypes=n.propTypes,r.defaultProps=n.defaultProps,i));return h(a,n),a}if(!n)throw new Error("Please pass a valid component to 'observer'");var s=n.prototype||n;!function(e){["componentDidMount","componentWillUnmount","componentDidUpdate"].forEach((function(t){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e[t],o=re[t],i=r?!0===n?function(){o.apply(this,arguments),r.apply(this,arguments)}:function(){r.apply(this,arguments),o.apply(this,arguments)}:o;e[t]=i}(e,t)})),e.shouldComponentUpdate?(e.shouldComponentUpdate,re.shouldComponentUpdate):e.shouldComponentUpdate=re.shouldComponentUpdate}(s),n.isMobXReactObserver=!0,oe(s,"props"),oe(s,"state");var c=s.render;return s.render=function(){return ne.call(this,c)},n}var ae=ie((function(e){var t=e.children,n=e.inject,r=e.render,o=t||r;if(void 0===o)return null;if(!n)return o();var a=F(n)(o);return i.a.createElement(a,null)}));ae.displayName="Observer";var se,ce,ue=function(e,t,n,r,o){var i="children"===t?"render":"children";return"function"==typeof e[t]&&"function"==typeof e[i]?new Error("Invalid prop,do not use children and render in the same time in`"+n):"function"!=typeof e[t]&&"function"!=typeof e[i]?new Error("Invalid prop `"+o+"` of type `"+g(e[t])+"` supplied to `"+n+"`, expected `function`."):void 0};function le(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function de(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!=n?n:null}.bind(this))}function fe(e,t){try{var n=this.props,r=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n,this.state=r}}ae.propTypes={render:ue,children:ue},le.__suppressDeprecationWarning=!0,de.__suppressDeprecationWarning=!0,fe.__suppressDeprecationWarning=!0;var pe={children:!0,key:!0,ref:!0},me=(ce=se=function(e){function t(e,n){v(this,t);var r=O(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r.state={},he(e,r.state),r}return b(t,e),y(t,[{key:"render",value:function(){return o.Children.only(this.props.children)}},{key:"getChildContext",value:function(){var e={};return he(this.context.mobxStores,e),he(this.props,e),{mobxStores:e}}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(!e)return null;if(!t)return e;if(Object.keys(e).filter(ge).length,Object.keys(t).filter(ge).length,!e.suppressChangedStoreWarning)for(var n in e)ge(n)&&(t[n],e[n]);return e}}]),t}(o.Component),se.contextTypes={mobxStores:j},se.childContextTypes={mobxStores:j.isRequired},ce);function he(e,t){if(e)for(var n in e)ge(n)&&(t[n]=e[n])}function ge(e){return!pe[e]&&"suppressChangedStoreWarning"!==e}if(function(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof e.getDerivedStateFromProps&&"function"!=typeof t.getSnapshotBeforeUpdate)return e;var n=null,r=null,o=null;if("function"==typeof t.componentWillMount?n="componentWillMount":"function"==typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount"),"function"==typeof t.componentWillReceiveProps?r="componentWillReceiveProps":"function"==typeof t.UNSAFE_componentWillReceiveProps&&(r="UNSAFE_componentWillReceiveProps"),"function"==typeof t.componentWillUpdate?o="componentWillUpdate":"function"==typeof t.UNSAFE_componentWillUpdate&&(o="UNSAFE_componentWillUpdate"),null!==n||null!==r||null!==o){var i=e.displayName||e.name,a="function"==typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+i+" uses "+a+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==r?"\n  "+r:"")+(null!==o?"\n  "+o:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"==typeof e.getDerivedStateFromProps&&(t.componentWillMount=le,t.componentWillReceiveProps=de),"function"==typeof t.getSnapshotBeforeUpdate){if("function"!=typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=fe;var s=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;s.call(this,e,t,r)}}}(me),!o.Component)throw new Error("mobx-react requires React to be available");if(!r.spy)throw new Error("mobx-react requires mobx to be available");"function"==typeof a.unstable_batchedUpdates&&Object(r.configure)({reactionScheduler:a.unstable_batchedUpdates});var ve=function(e){return $.on(e)};if("object"===("undefined"==typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__?"undefined":g(__MOBX_DEVTOOLS_GLOBAL_HOOK__))){var ye={spy:r.spy,extras:{getDebugName:r.getDebugName}},be={renderReporter:z,componentByNodeRegistry:V,componentByNodeRegistery:V,trackComponents:Y};__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobxReact(be,ye)}},907:function(e,t,n){"use strict";function r(e){return e>=200&&e<300}n.d(t,"a",(function(){return r}))},908:function(e,t,n){"use strict";function r(){return{isDragOver:!1,draggableItemType:null}}n.d(t,"a",(function(){return r}))},909:function(e,t,n){"use strict";var r=n(959),o=n(575);t.a=function(e,t,n,i){var a=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var u=t[s],l=i?i(n[u],e[u],u,n,e):void 0;void 0===l&&(l=e[u]),a?Object(o.a)(n,u,l):Object(r.a)(n,u,l)}return n}},910:function(e,t,n){"use strict";var r=n(3);t.a=Object(r.action)("ON_SELECTED_ACCOUNT_CHANGED",(e,t,n)=>({selectedAccountSourceId:e,selectedEmailAddress:t,oldSourceId:n}))},912:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(715);function o(e){const t=Object(r.a)().accountSources.filter(t=>{var n;return(null===(n=t.mailbox)||void 0===n?void 0:n.emailAddress)===e});if(t.length>1)throw new Error("Found "+t.length+" duplicated accounts with same email address: "+e);return 1===t.length?t[0].id:null}},913:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(20);const o=new r.c(()=>n.e(538).then(n.bind(null,1564)));let i=new r.b(o,e=>e.searchCacheTrie),a=new r.b(o,e=>e.compareFeatureData),s=new r.a(o,e=>e.initializeSuggestionTrie),c=new r.a(o,e=>e.isSuggestionTrieEmpty)},914:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l}));var r=n(706),o=n(913);function i(e,t,n,r){return c(l(e),t,n,r)}function a(e,t,n,r){return o.d.import().then(o=>o(e,t,e=>u(n,e,r)))}function s(e,t,n,r){return c(e,t,n,r)}function c(e,t,n,o){let i=[],a=0;for(;i.length<t&&r.a.recipientCache&&a<r.a.recipientCache.length;){const t=r.a.recipientCache[a];if(e(t)){u(n,t.EmailAddress,o)||i.push(t)}a++}return i}function u(e,t,n){let r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}const l=e=>t=>{const n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;const t=n.Name.toLowerCase().split(" ");for(let n=0;n<t.length;n++)if(0==t[n].indexOf(e))return!0}return!1}},916:function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(r||(r={}))},917:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(726);function o(e){const t=Object(r.b)(e.EmailAddress,e.DisplayName);return Object.assign(Object.assign({},t),{isPendingResolution:!1,persona:e})}t.a=o},918:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(538),s=n(50),c=n(1148),u=n(63),l=Object(a.a)(),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderContent=function(e){return"string"==typeof e.content?i.createElement("p",{className:t._classNames.subText},e.content):i.createElement("div",{className:t._classNames.subText},e.content)},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.calloutProps,r=e.directionalHint,a=e.directionalHintForRTL,u=e.styles,d=e.id,f=e.maxWidth,p=e.onRenderContent,m=void 0===p?this._onRenderContent:p,h=e.targetElement,g=e.theme;return this._classNames=l(u,{theme:g,className:t||n&&n.className,beakWidth:n&&n.beakWidth,gapSpace:n&&n.gapSpace,maxWidth:f}),i.createElement(c.a,Object(o.__assign)({target:h,directionalHint:r,directionalHintForRTL:a},n,Object(s.j)(this.props,s.h,["id"]),{className:this._classNames.root}),i.createElement("div",{className:this._classNames.content,id:d,role:"tooltip",onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave},m(this.props,this._onRenderContent)))},t.defaultProps={directionalHint:u.a.topCenter,maxWidth:"364px",calloutProps:{isBeakVisible:!0,beakWidth:16,gapSpace:0,setInitialFocus:!0,doNotLayer:!1}},t}(i.Component),f=n(8);n.d(t,"a",(function(){return p}));var p=Object(r.a)(d,(function(e){var t=e.className,n=e.beakWidth,r=void 0===n?16:n,o=e.gapSpace,i=void 0===o?0:o,a=e.maxWidth,s=e.theme,c=s.semanticColors,u=s.fonts,l=s.effects,d=-(Math.sqrt(r*r/2)+i)+1/window.devicePixelRatio;return{root:["ms-Tooltip",s.fonts.medium,f.AnimationClassNames.fadeIn200,{background:c.menuBackground,boxShadow:l.elevation8,padding:"8px",maxWidth:a,selectors:{":after":{content:"''",position:"absolute",bottom:d,left:d,right:d,top:d,zIndex:0}}},t],content:["ms-Tooltip-content",u.small,{position:"relative",zIndex:1,color:c.menuItemText,wordWrap:"break-word",overflowWrap:"break-word",overflow:"hidden"}],subText:["ms-Tooltip-subtext",{fontSize:"inherit",fontWeight:"inherit",color:"inherit",margin:0}]}}),void 0,{scope:"Tooltip"})},919:function(e,t,n){"use strict";var r=n(931),o=n(940);t.a=function(e){return Object(r.a)((function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&Object(o.a)(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,a)}return t}))}},920:function(e){e.exports=JSON.parse('{"a":{"AccountEntry":["AccountLocalFile","AccountMailbox","AccountSource"],"AppendOnSend":[],"Attachment":["BasicAttachment","ReferenceAttachment"],"AttachmentTypeUnion":["BasicAttachment","ReferenceAttachment"],"CalendarEntry":["LinkedCalendarEntry","LocalCacheForRemoteCalendarEntry","LocalCalendarEntry"],"Connection":["ConversationRowConnection","ConversationToConversationNodesConnection","ItemRowConnection"],"ConversationNodeItem":["Item","Message","MeetingMessage","MeetingResponseMessage","MeetingRequestMessage","MeetingCancellationMessage"],"ConversationRowByIdResult":["ConversationType","NotFound"],"CopyMoveGroupFolderResult":["CopyMoveGroupFolderResponse","ErrorMessage"],"CreateAccountResult":["AccountSource","AccountCreationFailure"],"CreateFolderResult":["FolderId","AccessDenied"],"CreateGroupFolderResult":["CreateGroupFolderResponse","ErrorMessage"],"DeleteGroupFolderResult":["DeleteGroupFolderResponse","ErrorMessage"],"Edge":["ConversationConversationNodesEdge","ConversationRowEdge","ItemRowEdge"],"GenericItem":["CalendarItem","Item","MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"GenericMeetingMessage":["MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage"],"GenericMessage":["MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"GetItemResponseType":["Item","Message","MeetingMessage","MeetingResponseMessage","MeetingRequestMessage","MeetingCancellationMessage"],"IntervalRecurrencePatternBase":["AbsoluteMonthlyRecurrence","DailyRecurrence","RegeneratingPatternBaseType","RelativeMonthlyRecurrence","WeeklyRecurrence"],"M365Application":["M365HubApplication","M365PlatformApplication"],"M365ApplicationBadge":["M365ApplicationNumericBadge"],"M365ApplicationIcon":["InternalIcon","RemoteImage"],"MailFolderPermissions":["MailFolder"],"Node":["CalendarEvent","CalendarItem","Conversation","ConversationNode","ConversationType","Draft","Item","ItemRow","MeetingCancellationMessage","MeetingMessage","MeetingRequestMessage","MeetingResponseMessage","Message"],"NotificationPayload":["GroupFolderHierarchyNotificationPayload","HierarchyNotificationPayload","RowNotificationChangePayload","RowNotificationDeletePayload","UnreadItemNotificationPayload"],"PropertyPath":["BuiltInPropertyUri","ExtendedPropertyUri"],"RecurrencePatternType":["AbsoluteYearlyRecurrence","AbsoluteMonthlyRecurrence","DailyRecurrence","RegeneratingPatternBaseType","RelativeYearlyRecurrence","RelativeMonthlyRecurrence","WeeklyRecurrence"],"RecurrenceRangeBase":["EndDateRecurrence","NoEndRecurrence","NumberedRecurrence"],"RecurrenceRangeType":["EndDateRecurrence","NoEndRecurrence","NumberedRecurrence"],"RenameGroupFolderResult":["RenameGroupFolderResponse","ErrorMessage"],"RowNotificationPayload":["RowNotificationChangePayload","RowNotificationDeletePayload"],"UndoableActionResult":["CategorizeConversationResult","CategorizeItemResult","DeleteConversationResult","DeleteItemResult","MarkItemAsJunkResult","MoveConversationResult","MoveItemResult","ScheduleConversationResult"],"calendarsUnionType":["LocalCalendarEntry","LinkedCalendarEntry","LocalCacheForRemoteCalendarEntry"]}}')},921:function(e,t,n){"use strict";var r=n(471),o=n(575),i=n(406);var a=function(e,t,n){(void 0===n||Object(i.a)(e[t],n))&&(void 0!==n||t in e)||Object(o.a)(e,t,n)},s=n(939),c=n(948),u=n(949),l=n(947),d=n(951),f=n(520),p=n(262),m=n(934),h=n(518),g=n(565),v=n(252),y=n(950),b=n(574);var O=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},S=n(909),C=n(708);var A=function(e){return Object(S.a)(e,Object(C.a)(e))};var _=function(e,t,n,r,o,i,s){var S=O(e,n),C=O(t,n),_=s.get(C);if(_)a(e,n,_);else{var I=i?i(S,C,n+"",e,t,s):void 0,x=void 0===I;if(x){var E=Object(p.a)(C),T=!E&&Object(h.a)(C),w=!E&&!T&&Object(b.a)(C);I=C,E||T||w?Object(p.a)(S)?I=S:Object(m.a)(S)?I=Object(l.a)(S):T?(x=!1,I=Object(c.a)(C,!0)):w?(x=!1,I=Object(u.a)(C,!0)):I=[]:Object(y.a)(C)||Object(f.a)(C)?(I=S,Object(f.a)(S)?I=A(S):Object(v.a)(S)&&!Object(g.a)(S)||(I=Object(d.a)(C))):x=!1}x&&(s.set(C,I),o(I,C,r,i,s),s.delete(C)),a(e,n,I)}};var I=function e(t,n,o,i,c){t!==n&&Object(s.a)(n,(function(s,u){if(c||(c=new r.a),Object(v.a)(s))_(t,n,u,o,e,i,c);else{var l=i?i(O(t,u),s,u+"",t,n,c):void 0;void 0===l&&(l=s),a(t,u,l)}}),C.a)},x=n(919),E=Object(x.a)((function(e,t,n){I(e,t,n)}));t.a=E},923:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"a",(function(){return p}));const r="A-Za-z------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9------------------------------------",o=new RegExp("^(["+r+"!#$%&'*+/=?^_`{|}~-](?:["+r+".!#$%&'*+/=?^_`{|}~-]*["+r+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),i=new RegExp('^("['+r+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),a=new RegExp("^["+r+"-]+(?:\\.["+r+"-]+)*$"),s=/[^\\]"/,c=/^[A-Za-z0-9_-]+:.*$/,u=e=>{const t=e.match(o);if(t)return-1!==t[0].indexOf("..")?null:t[0];const n=e.match(i);if(n){const e=s.exec(n[0]);return e&&e.index!==n[0].length-2?null:n[0]}return null};function l(e){if(!e)return!1;const t=u(e);return!!t&&!!e.substring(t.length+1).match(a)}function d(e){return c.test(e)}function f(e){return!u(e)}function p(e){return l(e)||d(e)}},930:function(e,t,n){"use strict";t.a=function(e){return function(t){return e(t)}}},931:function(e,t,n){"use strict";var r=n(568),o=n(943),i=n(941);t.a=function(e,t){return Object(i.a)(Object(o.a)(e,t,r.a),e+"")}},932:function(e,t,n){"use strict";var r=n(590),o=n(1),i=n(0),a=n(538),s=n(294),c=Object(a.a)(),u=function(e){function t(t){var n=e.call(this,t)||this;return Object(s.a)(n),n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.className,n=e.styles,r=e.theme;return this._classNames=c(n,{theme:r,className:t}),i.createElement("div",{className:this._classNames.actions},i.createElement("div",{className:this._classNames.actionsRight},this._renderChildrenAsActions()))},t.prototype._renderChildrenAsActions=function(){var e=this;return i.Children.map(this.props.children,(function(t){return t?i.createElement("span",{className:e._classNames.action},t):null}))},t}(i.Component),l=n(8),d={actions:"ms-Dialog-actions",action:"ms-Dialog-action",actionsRight:"ms-Dialog-actionsRight"};n.d(t,"a",(function(){return f}));var f=Object(r.a)(u,(function(e){var t=e.className,n=e.theme,r=Object(l.getGlobalClassNames)(d,n);return{actions:[r.actions,{position:"relative",width:"100%",minHeight:"24px",lineHeight:"24px",margin:"16px 0 0",fontSize:"0",selectors:{".ms-Button":{lineHeight:"normal"}}},t],action:[r.action,{margin:"0 4px"}],actionsRight:[r.actionsRight,{textAlign:"right",marginRight:"-4px",fontSize:"0"}]}}),void 0,{scope:"DialogFooter"})},934:function(e,t,n){"use strict";var r=n(402),o=n(306);t.a=function(e){return Object(o.a)(e)&&Object(r.a)(e)}},937:function(e,t,n){"use strict";var r=n(825);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b}))},938:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return"object"==r(e)&&null!==e}n.d(t,"a",(function(){return o}))},939:function(e,t,n){"use strict";var r=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===n(i[c],c,i))break}return t}}();t.a=r},940:function(e,t,n){"use strict";var r=n(406),o=n(402),i=n(577),a=n(252);t.a=function(e,t,n){if(!Object(a.a)(n))return!1;var s=typeof t;return!!("number"==s?Object(o.a)(n)&&Object(i.a)(t,n.length):"string"==s&&t in n)&&Object(r.a)(n[t],e)}},941:function(e,t,n){"use strict";var r=function(e){return function(){return e}},o=n(578),i=n(568),a=o.a?function(e,t){return Object(o.a)(e,"toString",{configurable:!0,enumerable:!1,value:r(t),writable:!0})}:i.a,s=800,c=16,u=Date.now;var l=function(e){var t=0,n=0;return function(){var r=u(),o=c-(r-n);if(n=r,o>0){if(++t>=s)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(a);t.a=l},942:function(e,t,n){"use strict";var r=n(573),o=n(720),i=Object(o.a)(Object.keys,Object),a=Object.prototype.hasOwnProperty;t.a=function(e){if(!Object(r.a)(e))return i(e);var t=[];for(var n in Object(e))a.call(e,n)&&"constructor"!=n&&t.push(n);return t}},943:function(e,t,n){"use strict";var r=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},o=Math.max;t.a=function(e,t,n){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),c=Array(s);++a<s;)c[a]=i[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=i[a];return u[t]=n(c),r(e,this,u)}}},944:function(e,t,n){"use strict";var r=n(581);t.a=function(e){var t=new e.constructor(e.byteLength);return new r.a(t).set(new r.a(e)),t}},946:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var r=n(938),o=n(714),i=n(618),a=n(817);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?l(e):t}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,h(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),m(r,e)})(e)}function f(e,t,n){return(f=p()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&m(o,n.prototype),o}).apply(null,arguments)}function p(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(g,e);var t,n,a,s,d,f=(t=g,n=p(),function(){var e,r=h(t);if(n){var o=h(this).constructor;e=Reflect.construct(r,arguments,o)}else e=r.apply(this,arguments);return u(this,e)});function g(e,t,n,o,a,s,c){var d,p,m,h,v;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,g),v=f.call(this,e);var y,b=Array.isArray(t)?0!==t.length?t:void 0:t?[t]:void 0,O=n;!O&&b&&(O=null===(y=b[0].loc)||void 0===y?void 0:y.source);var S,C=o;!C&&b&&(C=b.reduce((function(e,t){return t.loc&&e.push(t.loc.start),e}),[])),C&&0===C.length&&(C=void 0),o&&n?S=o.map((function(e){return Object(i.a)(n,e)})):b&&(S=b.reduce((function(e,t){return t.loc&&e.push(Object(i.a)(t.loc.source,t.loc.start)),e}),[]));var A=c;if(null==A&&null!=s){var _=s.extensions;Object(r.a)(_)&&(A=_)}return Object.defineProperties(l(v),{name:{value:"GraphQLError"},message:{value:e,enumerable:!0,writable:!0},locations:{value:null!==(d=S)&&void 0!==d?d:void 0,enumerable:null!=S},path:{value:null!=a?a:void 0,enumerable:null!=a},nodes:{value:null!=b?b:void 0},source:{value:null!==(p=O)&&void 0!==p?p:void 0},positions:{value:null!==(m=C)&&void 0!==m?m:void 0},originalError:{value:s},extensions:{value:null!==(h=A)&&void 0!==h?h:void 0,enumerable:null!=A}}),null!=s&&s.stack?(Object.defineProperty(l(v),"stack",{value:s.stack,writable:!0,configurable:!0}),u(v)):(Error.captureStackTrace?Error.captureStackTrace(l(v),g):Object.defineProperty(l(v),"stack",{value:Error().stack,writable:!0,configurable:!0}),v)}return a=g,(s=[{key:"toString",value:function(){return v(this)}},{key:o.c,get:function(){return"Object"}}])&&c(a.prototype,s),d&&c(a,d),g}(d(Error));function v(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var o=r[n];o.loc&&(t+="\n\n"+Object(a.a)(o.loc))}else if(e.source&&e.locations)for(var i=0,s=e.locations;i<s.length;i++){var c=s[i];t+="\n\n"+Object(a.b)(e.source,c)}return t}},947:function(e,t,n){"use strict";t.a=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}},948:function(e,t,n){"use strict";(function(e){var r=n(247),o="object"==typeof exports&&exports&&!exports.nodeType&&exports,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o?r.a.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.a=function(e,t){if(t)return e.slice();var n=e.length,r=s?s(n):new e.constructor(n);return e.copy(r),r}}).call(this,n(709)(e))},949:function(e,t,n){"use strict";var r=n(944);t.a=function(e,t){var n=t?Object(r.a)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},950:function(e,t,n){"use strict";var r=n(347),o=n(712),i=n(306),a="[object Object]",s=Function.prototype,c=Object.prototype,u=s.toString,l=c.hasOwnProperty,d=u.call(Object);t.a=function(e){if(!Object(i.a)(e)||Object(r.a)(e)!=a)return!1;var t=Object(o.a)(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==d}},951:function(e,t,n){"use strict";var r=n(252),o=Object.create,i=function(){function e(){}return function(t){if(!Object(r.a)(t))return{};if(o)return o(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),a=n(712),s=n(573);t.a=function(e){return"function"!=typeof e.constructor||Object(s.a)(e)?{}:i(Object(a.a)(e))}},953:function(e,t,n){"use strict";var r=n(713),o=n(36);function i(e){var t;const n={};return null===(t=null==e?void 0:e.Items)||void 0===t||t.forEach(e=>{e.Id&&(n[e.Id]=e.Value)}),n}const a=e=>{switch(e){case 0:return"Business";case 1:return"ExoConsumer";case 2:return"GMail";default:return null}},s=e=>{switch(e){case 1:return"Disabled";case 2:return"Enabled";case 0:return"FirstRun";default:return null}},c=e=>{switch(e){case 1:return"Celsius";case 0:return"Default";case 2:return"Fahrenheit";default:return null}},u=e=>{switch(e){case 1:return"Disabled";case 2:return"Enabled";case 0:return"FirstRun";default:return null}},l=e=>{switch(e){case 2:return"EmailToast";case 8:return"FaxToast";case 0:return"None";case 1:return"Sound";case 4:return"VoiceMailToast";default:return null}},d=e=>{switch(e){case 7:return"All";case 1:return"Bold";case 2:return"Italic";case 0:return"Normal";case 4:return"Underline";default:return null}},f=e=>{switch(e){case 3:return"Gmail";case 0:return"Hotmail";case 1:return"Off";case 4:return"Owa";case 2:return"Yahoo";default:return null}},p=e=>{switch(e){case 2:return"CalendarItems";case 0:return"Conversation";case 1:return"Message";default:return null}},m=e=>{switch(e){case 1:return"Jsmvvm";case 0:return"None";case 2:return"React";default:return null}},h=e=>{switch(e){case 2:return"Archive";case 1:return"Delete";case 0:return"None";case 5:return"ToggleFlag";case 3:return"TogglePin";case 4:return"ToggleRead";default:return null}},g=e=>{switch(e){case 0:return"None";case 1:return"ExternalLink";case 2:return"DeleteFlaggedMessage";case 4:return"DeleteFlaggedContacts";case 8:return"DeleteFlaggedItems";case 16:return"DeleteOutlookDisabledRules";case 32:return"DisabledRulesLeft";case 64:return"DeleteConversation";case 128:return"IgnoreConversation";case 256:return"CancelIgnoreConversation";case 512:return"FilteredByUnread";case 1024:return"DeleteAllClutter";case 2048:return"ShowFirstRunModalDialog";case 4096:return"StopShowConsumerPromotion";case 8192:return"ShowAdsEdgePromotionMiddle";case 16384:return"UseUCMALegacyChat";case 32768:return"DonotShowAds";case 65536:return"FocusedInboxFirstRunExperience";case 131072:return"ShowGroupsAppUpsellBanner";case 262144:return"HideUpNextAgendaButtonLabel";case 524288:return"FocusedInboxFeedback";case 1048576:return"NotO365HomesubscribedUser";case 2097152:return"SweepGreyEmails";case 4194304:return"ReactDefaultSettingsOverride";case 8388608:return"AdsExperiments";case 16777216:return"AdsDisplayOn";case 33554432:return"AdsNativeOn";case 67108864:return"AdsFocusOnOnly";case 134217728:return"ShowGetStartedPane";case 268435456:return"GdprAdsPrefNotSet";case 536870912:return"GetStartedEnabledViaNewUserPath";case 1073741824:return"OneNoteFeedEverInitialized";case 2147483647:return"All";default:return null}},v=e=>{switch(e){case 2:return"Archive";case 1:return"Delete";case 0:return"None";case 5:return"FlagUnflag";case 6:return"Move";case 3:return"PinUnpin";case 4:return"ReadUnread"}},y=e=>{switch(e){case 0:return"All";case 4:return"DistributionGroups";case 2:return"ExcludeFavorites";case 5:return"FamilyGroup";case 1:return"Favorites";case 3:return"PublicOnly";default:return null}},b=e=>{switch(e){case 0:return"MemberOfUnifiedGroups";case 1:return"OwnerOfDeletedUnifiedGroups";default:return null}},O=e=>{switch(e){case 3:return"DeleteAndAllowRecovery";case 5:return"MarkAsPastRetentionLimit";case 6:return"MoveToArchive";case 1:return"MoveToDeletedItems";case 2:return"MoveToFolder";case 0:return"None";case 4:return"PermanentlyDelete";default:return null}},S=e=>{switch(e){case 1:return"Calendar";case 2:return"Contacts";case 3:return"DeletedItems";case 4:return"Drafts";case 5:return"Inbox";case 6:return"JunkEmail";case 7:return"Journal";case 8:return"Notes";case 9:return"Outbox";case 10:return"SentItems";case 11:return"Tasks";case 12:return"All";case 13:return"ManagedCustomFolder";case 14:return"RssSubscriptions";case 15:return"SyncIssues";case 16:return"ConversationHistory";case 17:return"Personal";case 18:return"RecoverableItems";case 19:return"NonIpmRoot";default:return null}},C=e=>e?e.map(v):null,A=e=>Object.assign(Object.assign({},e),{FilterType:y(null==e?void 0:e.FilterType),GroupsSetType:b(null==e?void 0:e.GroupsSetType)}),_=e=>e?e.map(A):null,I=e=>Object.assign(Object.assign({},e),{WebSessionType:a(null==e?void 0:e.WebSessionType)}),x=e=>Object.assign(Object.assign({},e),{WeatherEnabled:s(null==e?void 0:e.WeatherEnabled),WeatherUnit:c(null==e?void 0:e.WeatherUnit),LocalEventsEnabled:u(null==e?void 0:e.LocalEventsEnabled),NewItemNotify:l(null==e?void 0:e.NewItemNotify),ComposeFontFlags:d(null==e?void 0:e.ComposeFontFlags),NewEnabledPonts:g(null==e?void 0:e.NewEnabledPonts),KeyboardShortcutsMode:f(null==e?void 0:e.KeyboardShortcutsMode),GlobalListViewTypeReact:p(null==e?void 0:e.GlobalListViewTypeReact),ClientTypeOptInState:m(null==e?void 0:e.ClientTypeOptInState),TasksClientTypeOptInState:m(null==e?void 0:e.TasksClientTypeOptInState)}),E=e=>Object.assign(Object.assign({},e),{TemperatureUnit:c(null==e?void 0:e.TemperatureUnit),MailLeftSwipeAction:h(null==e?void 0:e.MailLeftSwipeAction),MailRightSwipeAction:h(null==e?void 0:e.MailRightSwipeAction),MailTriageOnHoverActions:C(null==e?void 0:e.MailTriageOnHoverActions)}),T=e=>({UnifiedGroupsSets:_(null==e?void 0:e.UnifiedGroupsSets)}),w=e=>Object.assign(Object.assign({},e),{Type:S(e.Type),RetentionAction:O(e.RetentionAction)}),M=e=>e?e.map(w):null;var k=n(921);const j=new Map;function P(e,t,n){t=t||r.a;try{if(e){const r=function(e,t){return Object.assign(Object.assign({__typename:"UserConfiguration",id:t},e),{PrimeSettings:i(e.PrimeSettings),UserOptions:x(e.UserOptions),SessionSettings:I(e.SessionSettings),ViewStateConfiguration:E(e.ViewStateConfiguration),GroupsSets:T(e.GroupsSets),RetentionPolicyTags:M(e.RetentionPolicyTags)})}(JSON.parse(JSON.stringify(e)),t);n?N(t,r):j[t]=r}}catch(e){o.d("User configuration cache set failed: "+e)}}function R(e){return e=e||r.a,j[e]||{id:e}}function N(e,t){if(t){e=e||r.a;const n=j[e]||{};j[e]=Object(k.a)(n,t)}}n.d(t,"a",(function(){return R})),n.d(t,"b",(function(){return P})),n.d(t,"c",(function(){return N}))},954:function(e,t,n){"use strict";function r(e){return Object.assign({__type:"GetItemRequest:#Exchange"},e)}n.d(t,"a",(function(){return r}))},955:function(e,t,n){"use strict";var r=n(35);function o(e,t){var n;return void 0===e||e.__type||(n=e,e=Object.assign({__type:"GetItemJsonRequest:#Exchange"},n)),Object(r.a)("GetItem",e,t)}n.d(t,"a",(function(){return o}))},957:function(e,t,n){"use strict";var r=n(702);class o{constructor(e){this.maxSize=e,this.references=[],this.mruList=[]}initialize(e,t){if(!this.store){this.store=e,this.deleteCallback=t;for(let t of e.keys())this.mruList.push(t)}}add(e,t){Object(r.action)("MruCache_add")(()=>{this.store.set(e,t),this.mruList.indexOf(e)>=0?this.touch(e):(this.mruList.push(e),this.purgeIfNecessary())})()}get(e){return this.store.get(e)}getAndTouch(e){const t=this.store.get(e);return t&&this.touch(e),t}has(e){return this.store.has(e)}remove(e){Object(r.action)("MruCache_remove")(()=>{if(this.store.has(e)&&!this.isReferenced(e))return this.removeItemAtIndex(this.mruList.indexOf(e))})()}registerReference(e){this.references.push(e)}clear(){Object(r.action)("MruCache_clear")(()=>{this.purgeTillSize(0)})()}getItemIds(){return new Array(...this.mruList)}touch(e){let t=this.mruList.indexOf(e);if(t<0)throw new Error(`Item with key '${e}' does not exist in the cache.`);this.mruList.splice(t,1),this.mruList.push(e)}purgeIfNecessary(){this.purgeTillSize(this.maxSize)}purgeTillSize(e){let t=0;for(;this.mruList.length>e&&t<this.mruList.length;){let e=this.mruList[t];this.isReferenced(e)?t++:this.removeItemAtIndex(t)}}removeItemAtIndex(e){if(e<0||e>=this.mruList.length)throw new Error("Invalid index to remove: "+e);let t=this.mruList[e];this.mruList.splice(e,1),this.deleteCallback?this.deleteCallback(t):this.store.delete(t)}isReferenced(e){for(let t=0;t<this.references.length;t++){const n=this.references[t]();if(Array.isArray(n)){if(-1!=n.indexOf(e))return!0}else if(n==e)return!0}return!1}}n.d(t,"a",(function(){return o}))},959:function(e,t,n){"use strict";var r=n(575),o=n(406),i=Object.prototype.hasOwnProperty;t.a=function(e,t,n){var a=e[t];i.call(e,t)&&Object(o.a)(a,n)&&(void 0!==n||t in e)||Object(r.a)(e,t,n)}},962:function(e,t,n){"use strict";t.a=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}},964:function(e,t,n){"use strict";var r=n(920);n.d(t,"a",(function(){return r.a}))},966:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(263),o=n(36);function i(){const e=Object(r.a)();for(const t of e.tabs)if(2==t.state)return t;return o.d("There is no active tab. Something went very wrong."),null}},9667:function(e){e.exports=JSON.parse('{"a":"D9b"}')},9668:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4199),o=n(2024);function i(e,t){return o.c.import().then(n=>{n(e,(e,n)=>(e.focus(),e.addUndoSnapshot(()=>{e.insertContent(t,{position:0,updateCursor:!1,replaceSelection:!1,insertOnNewLine:!1})},r.a),n),(e,n,r)=>({value:t+e,selectionStart:n,selectionEnd:r,focus:!0}))})}},9669:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(4199),o=n(2024);function i(e,t){return o.c.import().then(n=>{n(e,(e,n)=>{const o=n?3:0;return e.addUndoSnapshot(()=>{e.insertContent(t,{position:o,updateCursor:!0,replaceSelection:!0,insertOnNewLine:!1})},r.a),n},(e,n,r)=>({value:e.substring(0,n)+t+e.substring(r+1),selectionStart:n,selectionEnd:r,focus:!0}))})}},967:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return a}));var r=n(289);const o={};function i(e,t){o[r.a[e]]=t}function a(e){return o[r.a[e]]}},9670:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(3),o=n(16);const i=Object(r.mutatorAction)("setComposeState",(e,t,n,r,i,a)=>{t.size+=i,t.dataStore.set(n,r),e.sessionStore||(e.sessionStore=new o.ObservableMap),e.sessionStore.set(a,t)}),a=Object(r.mutatorAction)("clearComposeState",(e,t)=>{e.sessionStore.delete(t)}),s=Object(r.mutatorAction)("removeComposeState",(e,t,n,r)=>{const o=e.sessionStore.get(r);o.size-=n,o.dataStore.delete(t)})},968:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(218),o=n(376);function i(){return Object(o.a)(Object(r.a)().selectedSourceId)}},969:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(186);function i(e){var t=r.useState(e),n=t[0],i=t[1];return[n,{setTrue:Object(o.a)((function(){return function(){i(!0)}})),setFalse:Object(o.a)((function(){return function(){i(!1)}})),toggle:Object(o.a)((function(){return function(){i((function(e){return!e}))}}))}]}},9692:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c}));var r=n(669),o=n(4791),i=n(1e3);const a="addinTaskPane";function s(e){Object(r.a)(a,!0,!1,e),i.b.importAndExecute(),o.a.importAndExecute()}function c(e){Object(r.a)(a,!1,!1,e),i.b.importAndExecute()}},971:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(36),o=n(715);function i(e){const t=Object(o.a)().accountSources.filter(t=>t.id===e);if(1===t.length)return t[0];t.length>1&&r.h.warn("Found more than one account with the same source id")}},972:function(e,t,n){"use strict";function r(e,t){if(!e)throw new Error(t||"Assertion failed")}n.d(t,"a",(function(){return r}))},9728:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1777),o=n(4395),i=n(2108),a=n(47);function s(e,t,n,s){return new Promise((c,u)=>{let l=!1;const d=e=>{l||(l=!0,u({errorType:"UploadError"}))},f=e=>{l||(l=!0,c(e.Id))},p=(e,t,n)=>{Object(i.v)(e,t,n,!Object(a.j)("addin-fix-multipleCallbacksForAttachmentHandler")),c(t.Id)};try{const i=Object(r.j)([{name:t,url:n}]);Object(o.a)(i,e,{isInline:s,isHiddenInline:!0,shouldShare:!1},f,p,d)}catch(e){u({errorType:"UploadError"})}})}},9729:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1777),o=n(4395);function i(e,t,n,i){return new Promise((a,s)=>{let c=!1;const u=Object(r.i)([t],[n]);Object(o.a)(u,e,{isInline:i,isHiddenInline:!1,shouldShare:!1},e=>{c||(c=!0,a(e.Id))},null,e=>{c||(c=!0,s({errorType:"UploadError"}))})})}},976:function(e,t,n){"use strict";var r=n(728),o=n(810),i=n(296);var a=(e,t)=>{const n=t||e.Name;if(!n)return!0;const o=Object(r.a)(n),a=function(e,t){return e==t||e&&t&&e.toLowerCase()==t.toLowerCase()}(n,e.EmailAddress),s=-1!==n.indexOf("@"),c=!Object(i.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),u="OneOff"===e.MailboxType||"Unknown"===e.MailboxType;return e.EmailAddress&&!("SMTP"===e.RoutingType&&a)&&(o||s||c||u)};t.a=function(e,t){const n=t||e.Name,i=Object(r.a)(n);return a(e,t)?i?Object(o.a)(e):`${n} <${Object(o.a)(e)}>`:n}},977:function(e,t,n){"use strict";var r=n(23),o=n(334),i=n(521),a=n(377),s=n(0),c=n(408),u=n(1034),l=n(47),d=n(131),f=n(746),p=n.n(f),m=n(166);const h=n.n(m).a.bind(p.a),g=Object(r.a)((function(e){let t;t=e.categoryName?Object(i.a)(e.categoryName,e.categoryList?e.categoryList:Object(c.a)()):e.categoryColorId?a.a.colorCodeColorValueMap[e.categoryColorId]:Object(i.b)();const n=t.iconColor,r=Object(l.j)("mon-densities"),f={color:n},m=h(p.a.categoryIcon,e.iconClassName,r&&Object(d.e)(),r&&p.a.categorySize);return s.createElement(o.a,{className:m,iconName:r?u.a:"TagSolid",style:f})}));t.a=g},978:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(186),i=function(){var e=Object(o.a)({});return r.useEffect((function(){return function(){for(var t=0,n=Object.keys(e);t<n.length;t++){var r=n[t];clearTimeout(r)}}}),[e]),Object(o.a)({setTimeout:function(t,n){var r=setTimeout(t,n);return e[r]=1,r},clearTimeout:function(t){delete e[t],clearTimeout(t)}})}},979:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t,n,r)=>{const o=e,i=o.every(e=>null==e?void 0:e.LastTimeUsed);let a;a=r?o.sort((e,t)=>e.Name.localeCompare(t.Name)):i?o.sort((e,t)=>t.LastTimeUsed.localeCompare(e.LastTimeUsed)):o.reverse();let s=a.map(e=>e.Name);if(!r){t.forEach(e=>{let t=s.indexOf(e);-1!=t&&s.splice(t,1),s.unshift(e)});const e=n?7:8;s.splice(e);const r=s.slice(t.length).sort((e,t)=>e.localeCompare(t));s=s.slice(0,t.length).concat(r)}return s}},981:function(e,t,n){"use strict";function r(e,t){let n=[],r=!1,o=e.trim().toLocaleLowerCase();for(let e of t){const t=e.Name.trim().toLocaleLowerCase();""!=t&&t.indexOf(o)>=0&&(n.push(e),t==o&&(r=!0))}const i=e.toLocaleLowerCase().trim();return n.sort((e,t)=>{const n=e.Name.toLocaleLowerCase().trim(),r=t.Name.toLocaleLowerCase().trim(),o=n.indexOf(i),a=r.indexOf(i);return o==a?n.localeCompare(r):o-a}),{suggestions:n,hasExactMatch:r}}n.d(t,"a",(function(){return r}))},986:function(e,t,n){"use strict";function r(e){return e.clientWidth<e.scrollWidth}function o(e){return e.clientHeight<e.scrollHeight}function i(e){return r(e)||o(e)}n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return i}))},989:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(263);function o(){return Object(r.a)().tabs.filter(e=>3===e.state)}},990:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=/[\(\[\{\<][^\)\]\}\>]*[\)\]\}\>]/g,o=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,i=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,a=/\s+/g,s=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function c(e,t,n){return e?(e=function(e){return e=(e=(e=(e=e.replace(r,"")).replace(o,"")).replace(a," ")).trim()}(e),s.test(e)||!n&&i.test(e)?"":function(e,t){var n="",r=e.split(" ");return 2===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[1].charAt(0).toUpperCase()):3===r.length?(n+=r[0].charAt(0).toUpperCase(),n+=r[2].charAt(0).toUpperCase()):0!==r.length&&(n+=r[0].charAt(0).toUpperCase()),t&&n.length>1?n.charAt(1)+n.charAt(0):n}(e,t)):""}},991:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(923);function o(e){return Object(r.a)(e.EmailAddress)||e.ItemId&&"PrivateDL"==e.MailboxType}},993:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=n(724).a.execute},994:function(e,t){},995:function(e,t){},996:function(e,t){},997:function(e,t,n){"use strict";var r=n(1288);n.d(t,"ApolloProvider",(function(){return r.a}));var o=n(999);n.d(t,"useApolloClient",(function(){return o.a})),n.d(t,"useLazyQuery",(function(){return o.b})),n.d(t,"useMutation",(function(){return o.c})),n.d(t,"useQuery",(function(){return o.d}));var i=n(998);n.o(i,"ApolloClient")&&n.d(t,"ApolloClient",(function(){return i.ApolloClient})),n.o(i,"ApolloLink")&&n.d(t,"ApolloLink",(function(){return i.ApolloLink})),n.o(i,"InMemoryCache")&&n.d(t,"InMemoryCache",(function(){return i.InMemoryCache})),n.o(i,"Observable")&&n.d(t,"Observable",(function(){return i.Observable})),n.o(i,"execute")&&n.d(t,"execute",(function(){return i.execute})),n.o(i,"gql")&&n.d(t,"gql",(function(){return i.gql})),n.o(i,"isApolloError")&&n.d(t,"isApolloError",(function(){return i.isApolloError})),n.o(i,"makeVar")&&n.d(t,"makeVar",(function(){return i.makeVar}))},998:function(e,t){},999:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(68),a=n(723);function s(){var e=o.a.useContext(Object(a.a)()).client;return Object(i.b)(e,33),e}var c=n(25),u=n(212),l=n(309),d=n(207),f=n(349),p=function(){function e(e,t){this.isMounted=!1,this.previousOptions={},this.context={},this.options={},this.options=e||{},this.context=t||{}}return e.prototype.getOptions=function(){return this.options},e.prototype.setOptions=function(e,t){void 0===t&&(t=!1),t&&!Object(u.a)(this.options,e)&&(this.previousOptions=this.options),this.options=e},e.prototype.unmount=function(){this.isMounted=!1},e.prototype.refreshClient=function(){var e=this.options&&this.options.client||this.context&&this.context.client;Object(i.b)(!!e,29);var t=!1;return e!==this.client&&(t=!0,this.client=e,this.cleanup()),{client:this.client,isNew:t}},e.prototype.verifyDocumentType=function(e,t){var n=Object(f.c)(e);Object(f.b)(t),Object(f.b)(n.type);Object(i.b)(n.type===t,30)},e}(),m=function(e){function t(t){var n=t.options,r=t.context,o=t.onNewData,i=e.call(this,n,r)||this;return i.runLazy=!1,i.previous=Object.create(null),i.runLazyQuery=function(e){i.cleanup(),i.runLazy=!0,i.lazyOptions=e,i.onNewData()},i.getQueryResult=function(){var e=i.observableQueryFields(),t=i.getOptions();if(t.skip)e=Object(c.a)(Object(c.a)({},e),{data:void 0,error:void 0,loading:!1,networkStatus:d.a.ready,called:!0});else if(i.currentObservable){var n=i.currentObservable.getCurrentResult(),r=n.data,o=n.loading,a=n.partial,s=n.networkStatus,u=n.errors,f=n.error;if(u&&u.length>0&&(f=new l.a({graphQLErrors:u})),e=Object(c.a)(Object(c.a)({},e),{data:r,loading:o,networkStatus:s,error:f,called:!0}),o);else if(f)Object.assign(e,{data:(i.currentObservable.getLastResult()||{}).data});else{var p=i.currentObservable.options.fetchPolicy;if(t.partialRefetch&&a&&(!r||0===Object.keys(r).length)&&"cache-only"!==p)return Object.assign(e,{loading:!0,networkStatus:d.a.loading}),e.refetch(),e}}e.client=i.client,i.setOptions(t,!0);var m=i.previous.result;return i.previous.loading=m&&m.loading||!1,e.previousData=m&&(m.data||m.previousData),i.previous.result=e,i.currentObservable&&i.currentObservable.resetQueryStoreErrors(),e},i.obsRefetch=function(e){var t;return null===(t=i.currentObservable)||void 0===t?void 0:t.refetch(e)},i.obsFetchMore=function(e){return i.currentObservable.fetchMore(e)},i.obsUpdateQuery=function(e){return i.currentObservable.updateQuery(e)},i.obsStartPolling=function(e){var t;null===(t=i.currentObservable)||void 0===t||t.startPolling(e)},i.obsStopPolling=function(){var e;null===(e=i.currentObservable)||void 0===e||e.stopPolling()},i.obsSubscribeToMore=function(e){return i.currentObservable.subscribeToMore(e)},i.onNewData=o,i}return Object(c.c)(t,e),t.prototype.execute=function(){this.refreshClient();var e=this.getOptions(),t=e.skip,n=e.query;return(t||n!==this.previous.query)&&(this.removeQuerySubscription(),this.removeObservable(!t),this.previous.query=n),this.updateObservableQuery(),this.isMounted&&this.startQuerySubscription(),this.getExecuteSsrResult()||this.getExecuteResult()},t.prototype.executeLazy=function(){return this.runLazy?[this.runLazyQuery,this.execute()]:[this.runLazyQuery,{loading:!1,networkStatus:d.a.ready,called:!1,data:void 0}]},t.prototype.fetchData=function(){var e=this,t=this.getOptions();return!t.skip&&!1!==t.ssr&&new Promise((function(t){return e.startQuerySubscription(t)}))},t.prototype.afterExecute=function(e){var t=(void 0===e?{}:e).lazy,n=void 0!==t&&t;return this.isMounted=!0,n&&!this.runLazy||this.handleErrorOrCompleted(),this.previousOptions=this.getOptions(),this.unmount.bind(this)},t.prototype.cleanup=function(){this.removeQuerySubscription(),this.removeObservable(!0),delete this.previous.result},t.prototype.getOptions=function(){var t=e.prototype.getOptions.call(this);return this.lazyOptions&&(t.variables=Object(c.a)(Object(c.a)({},t.variables),this.lazyOptions.variables),t.context=Object(c.a)(Object(c.a)({},t.context),this.lazyOptions.context)),this.runLazy&&delete t.skip,t},t.prototype.ssrInitiated=function(){return this.context&&this.context.renderPromises},t.prototype.getExecuteResult=function(){var e=this.getQueryResult();return this.startQuerySubscription(),e},t.prototype.getExecuteSsrResult=function(){var e=this.getOptions(),t=e.ssr,n=e.skip,r=!1===t,o=this.refreshClient().client.disableNetworkFetches,i=Object(c.a)({loading:!0,networkStatus:d.a.loading,called:!0,data:void 0,stale:!1,client:this.client},this.observableQueryFields());if(r&&(this.ssrInitiated()||o))return this.previous.result=i,i;if(this.ssrInitiated()){var a=this.getQueryResult()||i;return a.loading&&!n&&this.context.renderPromises.addQueryPromise(this,(function(){return null})),a}},t.prototype.prepareObservableQueryOptions=function(){var e=this.getOptions();this.verifyDocumentType(e.query,f.a.Query);var t=e.displayName||"Query";return!this.ssrInitiated()||"network-only"!==e.fetchPolicy&&"cache-and-network"!==e.fetchPolicy||(e.fetchPolicy="cache-first"),Object(c.a)(Object(c.a)({},e),{displayName:t,context:e.context})},t.prototype.initializeObservableQuery=function(){if(this.ssrInitiated()&&(this.currentObservable=this.context.renderPromises.getSSRObservable(this.getOptions())),!this.currentObservable){var e=this.prepareObservableQueryOptions();this.previous.observableQueryOptions=Object(c.a)(Object(c.a)({},e),{children:null}),this.currentObservable=this.refreshClient().client.watchQuery(Object(c.a)({},e)),this.ssrInitiated()&&this.context.renderPromises.registerSSRObservable(this.currentObservable,e)}},t.prototype.updateObservableQuery=function(){if(this.currentObservable){if(!this.getOptions().skip){var e=Object(c.a)(Object(c.a)({},this.prepareObservableQueryOptions()),{children:null});Object(u.a)(e,this.previous.observableQueryOptions)||(this.previous.observableQueryOptions=e,this.currentObservable.setOptions(e).catch((function(){})))}}else this.initializeObservableQuery()},t.prototype.startQuerySubscription=function(e){var t=this;void 0===e&&(e=this.onNewData),this.currentSubscription||this.getOptions().skip||(this.currentSubscription=this.currentObservable.subscribe({next:function(n){var r=n.loading,o=n.networkStatus,i=n.data,a=t.previous.result;a&&a.loading===r&&a.networkStatus===o&&Object(u.a)(a.data,i)||e()},error:function(n){if(t.resubscribeToQuery(),!n.hasOwnProperty("graphQLErrors"))throw n;var r=t.previous.result;(r&&r.loading||!Object(u.a)(n,t.previous.error))&&(t.previous.error=n,e())}}))},t.prototype.resubscribeToQuery=function(){this.removeQuerySubscription();var e=this.currentObservable;if(e){var t=e.getLastError(),n=e.getLastResult();e.resetLastResults(),this.startQuerySubscription(),Object.assign(e,{lastError:t,lastResult:n})}},t.prototype.handleErrorOrCompleted=function(){if(this.currentObservable&&this.previous.result){var e=this.previous.result,t=e.data,n=e.loading,r=e.error;if(!n){var o=this.getOptions(),i=o.query,a=o.variables,s=o.onCompleted,c=o.onError,l=o.skip;if(this.previousOptions&&!this.previous.loading&&Object(u.a)(this.previousOptions.query,i)&&Object(u.a)(this.previousOptions.variables,a))return;!s||r||l?c&&r&&c(r):s(t)}}},t.prototype.removeQuerySubscription=function(){this.currentSubscription&&(this.currentSubscription.unsubscribe(),delete this.currentSubscription)},t.prototype.removeObservable=function(e){this.currentObservable&&(this.currentObservable.tearDownQuery(),e&&delete this.currentObservable)},t.prototype.observableQueryFields=function(){var e;return{variables:null===(e=this.currentObservable)||void 0===e?void 0:e.variables,refetch:this.obsRefetch,fetchMore:this.obsFetchMore,updateQuery:this.obsUpdateQuery,startPolling:this.obsStartPolling,stopPolling:this.obsStopPolling,subscribeToMore:this.obsSubscribeToMore}},t}(p);function h(e,t,n){void 0===n&&(n=!1);var o=Object(r.useContext)(Object(a.a)()),i=Object(r.useReducer)((function(e){return e+1}),0),s=i[0],l=i[1],d=t?Object(c.a)(Object(c.a)({},t),{query:e}):{query:e},f=Object(r.useRef)(),p=f.current||(f.current=new m({options:d,context:o,onNewData:function(){p.ssrInitiated()?l():Promise.resolve().then((function(){return f.current&&l()}))}}));p.setOptions(d),p.context=o;var h,g,v,y={options:Object(c.a)(Object(c.a)({},d),{onError:void 0,onCompleted:void 0}),context:o,tick:s},b=(h=function(){return n?p.executeLazy():p.execute()},g=y,(v=Object(r.useRef)()).current&&Object(u.a)(g,v.current.key)||(v.current={key:g,value:h()}),v.current.value),O=n?b[1]:b;return Object(r.useEffect)((function(){return function(){return p.cleanup()}}),[]),Object(r.useEffect)((function(){return p.afterExecute({lazy:n})}),[O.loading,O.networkStatus,O.error,O.data]),b}function g(e,t){return h(e,t,!0)}var v=n(822),y=function(e){function t(t){var n=t.options,r=t.context,o=t.result,i=t.setResult,a=e.call(this,n,r)||this;return a.runMutation=function(e){void 0===e&&(e={}),a.onMutationStart();var t=a.generateNewMutationId();return a.mutate(e).then((function(e){return a.onMutationCompleted(e,t),e})).catch((function(e){var n=a.getOptions().onError;if(a.onMutationError(e,t),n)return n(e),{data:void 0,errors:e};throw e}))},a.verifyDocumentType(n.mutation,f.a.Mutation),a.result=o,a.setResult=i,a.mostRecentMutationId=0,a}return Object(c.c)(t,e),t.prototype.execute=function(e){return this.isMounted=!0,this.verifyDocumentType(this.getOptions().mutation,f.a.Mutation),[this.runMutation,Object(c.a)(Object(c.a)({},e),{client:this.refreshClient().client})]},t.prototype.afterExecute=function(){return this.isMounted=!0,this.unmount.bind(this)},t.prototype.cleanup=function(){},t.prototype.mutate=function(e){return this.refreshClient().client.mutate(Object(v.b)(this.getOptions(),e))},t.prototype.onMutationStart=function(){this.result.loading||this.getOptions().ignoreResults||this.updateResult({loading:!0,error:void 0,data:void 0,called:!0})},t.prototype.onMutationCompleted=function(e,t){var n=this.getOptions(),r=n.onCompleted,o=n.ignoreResults,i=e.data,a=e.errors,s=a&&a.length>0?new l.a({graphQLErrors:a}):void 0;this.isMostRecentMutation(t)&&!o&&this.updateResult({called:!0,loading:!1,data:i,error:s}),r&&r(i)},t.prototype.onMutationError=function(e,t){this.isMostRecentMutation(t)&&this.updateResult({loading:!1,error:e,data:void 0,called:!0})},t.prototype.generateNewMutationId=function(){return++this.mostRecentMutationId},t.prototype.isMostRecentMutation=function(e){return this.mostRecentMutationId===e},t.prototype.updateResult=function(e){if(this.isMounted&&(!this.previousResult||!Object(u.a)(this.previousResult,e)))return this.setResult(e),this.previousResult=e,e},t}(p);function b(e,t){var n=Object(r.useContext)(Object(a.a)()),o=Object(r.useState)({called:!1,loading:!1}),i=o[0],s=o[1],u=t?Object(c.a)(Object(c.a)({},t),{mutation:e}):{mutation:e},l=Object(r.useRef)();var d=(l.current||(l.current=new y({options:u,context:n,result:i,setResult:s})),l.current);return d.setOptions(u),d.context=n,Object(r.useEffect)((function(){return d.afterExecute()})),d.execute(i)}function O(e,t){return h(e,t,!1)}n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return O}))}}]);
//# sourceMappingURL=owa.Addins.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.Addins.js'] = 1;