(window.$wj=window.$wj||[]).push([[427],{10572:function(e,t,n){"use strict";var a=n(4960),r=n(10573),o=n(2111),i=n(2096),c=n(10574),s=n(1747),u=n(1692),l=n(806),d=n(702),b=n(3319);t.a=Object(d.action)("loadConversationReadingPaneForSingleMailItemSelected")((function(e,t,n,d,m,f,v={conversationReadingPaneState:Object(o.a)(),hasConversationInMailStore:u.u.conversations.has(null==e?void 0:e.Id)}){var g,p,h,O;if(null===(p=null===(g=null==n?void 0:n.dp)||void 0===g?void 0:g.addCheckpoint)||void 0===p||p.call(g,"LCRPFSMIS"),!e)return Promise.resolve();const j=Object(l.d)(),I=v.conversationReadingPaneState?Object(c.a)(j,v.conversationReadingPaneState.conversationId.Id,0):null;return I&&6!==I.asyncSendState&&!t?Promise.resolve():(null===(h=v.conversationReadingPaneState)||void 0===h?void 0:h.conversationId.Id)==e.Id&&(null===(O=v.conversationReadingPaneState)||void 0===O?void 0:O.currentSelectedFolderId)==Object(s.b)()&&v.hasConversationInMailStore?(Object(b.b)(),Promise.resolve()):(I&&j.type!=l.a.SecondaryReadingPane&&!I.isInlineCompose&&i.i.importAndExecute(I,!0,!1),Object(r.a)(e),Object(a.b)(e,n,d,m,f))}))},10573:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1902),r=n(3),o=n(3402);const i=Object(r.mutatorAction)("updatePrimaryReadingPaneTabId",(function(e){a.a.primaryReadingPaneTabId=e}));Object(r.mutator)(o.a,e=>{a.a.primaryReadingPaneTabId=null})},10574:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(937),r=n(806),o=n(3293),i=n(36);function c(e,t,n){const c=Object(a.b)();let s;if(e){switch(e.type){case r.a.SecondaryReadingPane:e.data.listViewType==n&&(s=Object(o.a)(t,n));break;case r.a.MailCompose:s=c.viewStates.get(e.data);break;case r.a.Primary:s=t?Object(o.a)(t,n,!0):null;break;default:s=null}return s}return i.d("There is no active tab. Something went very wrong."),null}},11866:function(e){e.exports=JSON.parse('{"a":"Tjc"}')},11975:function(e){e.exports=JSON.parse('{"a":"xwc"}')},11976:function(e){e.exports=JSON.parse('{"a":"rwc"}')},11977:function(e,t,n){var a=n(15910);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(77)(a,r);a.locals&&(e.exports=a.locals)},13508:function(e,t,n){var a=n(15911);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(77)(a,r);a.locals&&(e.exports=a.locals)},15909:function(e){e.exports=JSON.parse('{"a":"xpe"}')},15910:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._3iO7z1C60DLdfL8UxMPBD0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;height:36px;pointer-events:none;width:100%;z-index:0}html[dir] ._3iO7z1C60DLdfL8UxMPBD0{border-style:solid;border-color:var(--neutralQuaternaryAlt);border-width:1px 0 0;background-color:var(--neutralLighterAlt);padding-top:4px}@-webkit-keyframes _1uJmaSAWajA5I5VEkuq0R-{0%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}20%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}25%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}85%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}to{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}}@-webkit-keyframes _1gM7YSpCvVziB6rbIBwS21{0%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}20%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}25%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}85%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}to{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}}@keyframes _1uJmaSAWajA5I5VEkuq0R-{0%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}20%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}25%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}85%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}to{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}}@keyframes _1gM7YSpCvVziB6rbIBwS21{0%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}20%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}25%{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}85%{color:var(--neutralSecondary);background-color:var(--neutralLighter);border-top-color:var(--neutralQuaternary)}to{color:var(--white);background-color:var(--themePrimary);border-top-color:var(--themePrimary)}}.twZ95-VxdPJWMoD_BnhP6{-ms-flex-negative:1;flex-shrink:1;cursor:pointer;width:200px;min-width:80px;max-width:200px;color:var(--neutralSecondary);text-overflow:ellipsis;white-space:nowrap;pointer-events:auto;font-weight:600;vertical-align:middle;font-size:14px}html[dir] .twZ95-VxdPJWMoD_BnhP6{background-color:var(--neutralLight);border-color:var(--neutralQuaternaryAlt);border-style:solid;border-radius:2px 2px 0 0;border-width:1px 1px 0}html[dir=ltr] .twZ95-VxdPJWMoD_BnhP6{margin-left:8px}html[dir=rtl] .twZ95-VxdPJWMoD_BnhP6{margin-right:8px}html[dir] .twZ95-VxdPJWMoD_BnhP6:hover{background-color:var(--neutralLighter)}.twZ95-VxdPJWMoD_BnhP6.vo0xYRHYL5T4A88AgyAX4{color:var(--themePrimary)}html[dir] .twZ95-VxdPJWMoD_BnhP6.vo0xYRHYL5T4A88AgyAX4{background-color:var(--white);border-top-color:var(--neutralQuaternary)}.twZ95-VxdPJWMoD_BnhP6._1gM7YSpCvVziB6rbIBwS21{color:var(--white)}html[dir] .twZ95-VxdPJWMoD_BnhP6._1gM7YSpCvVziB6rbIBwS21{background-color:var(--themePrimary);border-top-color:var(--themePrimary)}html[dir=ltr] .twZ95-VxdPJWMoD_BnhP6._1gM7YSpCvVziB6rbIBwS21{-webkit-animation:_1gM7YSpCvVziB6rbIBwS21 2s 1 ease-out;animation:_1gM7YSpCvVziB6rbIBwS21 2s 1 ease-out}html[dir=rtl] .twZ95-VxdPJWMoD_BnhP6._1gM7YSpCvVziB6rbIBwS21{-webkit-animation:_1uJmaSAWajA5I5VEkuq0R- 2s 1 ease-out;animation:_1uJmaSAWajA5I5VEkuq0R- 2s 1 ease-out}html[dir=ltr] .twZ95-VxdPJWMoD_BnhP6:first-child{margin-left:8px}html[dir=ltr] .twZ95-VxdPJWMoD_BnhP6:last-child,html[dir=rtl] .twZ95-VxdPJWMoD_BnhP6:first-child{margin-right:8px}html[dir=rtl] .twZ95-VxdPJWMoD_BnhP6:last-child{margin-left:8px}._36w8A3e-U_ChW95aou_Lvo .twZ95-VxdPJWMoD_BnhP6{height:18px;max-width:200px}._2FdTcMvK9W7JFOQQ9dsUs_{display:-webkit-box;display:-ms-flexbox;display:flex;height:100%;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-align:center;-ms-flex-align:center;align-items:center}html[dir=ltr] ._2FdTcMvK9W7JFOQQ9dsUs_{padding:0 10px 0 8px}html[dir=rtl] ._2FdTcMvK9W7JFOQQ9dsUs_{padding:0 8px 0 10px}._1EELpcUPUsdUvSrZjdhT2p{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}._3kcemUX-8GuCRds38TDoHK{font-size:14px}html[dir=ltr] ._3kcemUX-8GuCRds38TDoHK{margin-left:4px}html[dir=rtl] ._3kcemUX-8GuCRds38TDoHK{margin-right:4px}",""]),t.locals={tabBar:"_3iO7z1C60DLdfL8UxMPBD0",tab:"twZ95-VxdPJWMoD_BnhP6",active:"vo0xYRHYL5T4A88AgyAX4",blink:"_1gM7YSpCvVziB6rbIBwS21","blink-rtl":"_1uJmaSAWajA5I5VEkuq0R-",overflowMenuItem:"_36w8A3e-U_ChW95aou_Lvo",tabContent:"_2FdTcMvK9W7JFOQQ9dsUs_",subject:"_1EELpcUPUsdUvSrZjdhT2p",overflowChevron:"_3kcemUX-8GuCRds38TDoHK"}},15911:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._2ua3hx3NMtsaSa7VKhDBvO{font-size:14px}html[dir=ltr] ._2ua3hx3NMtsaSa7VKhDBvO{margin-right:4px}html[dir=rtl] ._2ua3hx3NMtsaSa7VKhDBvO{margin-left:4px}.zm3FQGM4bSDRKl3fjQ5Jv{height:28px}html[dir] .zm3FQGM4bSDRKl3fjQ5Jv.ms-Button{padding:0}.zm3FQGM4bSDRKl3fjQ5Jv.ms-Button .ms-Icon{font-size:14px}html[dir] .zm3FQGM4bSDRKl3fjQ5Jv.ms-Button .ms-Icon{margin:0}.zm3FQGM4bSDRKl3fjQ5Jv.ms-Button .ms-Button-flexContainer{width:28px}html[dir] .zm3FQGM4bSDRKl3fjQ5Jv.ms-Button:hover{background-color:var(--neutralQuaternaryAlt)}",""]),t.locals={leftIcon:"_2ua3hx3NMtsaSa7VKhDBvO",rightIcon:"zm3FQGM4bSDRKl3fjQ5Jv"}},15912:function(e,t,n){var a=n(15913);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};n(77)(a,r);a.locals&&(e.exports=a.locals)},15913:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,'@charset "UTF-8";._34SHoLphsXgvBsemipa7Je{position:relative}._34SHoLphsXgvBsemipa7Je:before{content:"ðŸ Ÿ";bottom:100%;font-size:1.2em;pointer-events:none;position:absolute;width:100%;color:var(--black);opacity:0}html[dir] ._34SHoLphsXgvBsemipa7Je:before{margin-bottom:.5em;text-align:center;-webkit-transition:opacity .2s,-webkit-transform .2s;transition:opacity .2s,-webkit-transform .2s;transition:opacity .2s,transform .2s;transition:opacity .2s,transform .2s,-webkit-transform .2s;-webkit-transform:translateY(.5em);transform:translateY(.5em)}html[dir=ltr] ._34SHoLphsXgvBsemipa7Je:before{text-shadow:-1px -1px 0 var(--white),0 -1px 0 var(--white),1px -1px 0 var(--white),1px 0 0 var(--white),1px 1px 0 var(--white),0 1px 0 var(--white),-1px 1px 0 var(--white),-1px 0 0 var(--white)}html[dir=rtl] ._34SHoLphsXgvBsemipa7Je:before{text-shadow:1px -1px 0 var(--white),0 -1px 0 var(--white),-1px -1px 0 var(--white),-1px 0 0 var(--white),-1px 1px 0 var(--white),0 1px 0 var(--white),1px 1px 0 var(--white),1px 0 0 var(--white)}._34SHoLphsXgvBsemipa7Je.BKzMtjaNd9TaB0J8LExtU:before{opacity:1}html[dir] ._34SHoLphsXgvBsemipa7Je.BKzMtjaNd9TaB0J8LExtU:before{-webkit-transform:translate(0);transform:translate(0)}',""]),t.locals={canHaveDragIndicator:"_34SHoLphsXgvBsemipa7Je",withDragIndicator:"BKzMtjaNd9TaB0J8LExtU"}},1732:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return c}));const a="FileAttachment:#Exchange",r="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",i="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1738:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1732);function r(e){return(e.__type||e.OwsTypeName)===a.e}},1774:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(332);function r(e){var t;return null===(t=Object(a.a)(e))||void 0===t?void 0:t.AttachmentPolicy}},1804:function(e,t,n){"use strict";var a,r,o;n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),function(e){e[e.Compose=0]="Compose",e[e.Extensibility=1]="Extensibility",e[e.ReadingPane=2]="ReadingPane",e[e.Fileshub=3]="Fileshub",e[e.Txp=4]="Txp",e[e.Peek=5]="Peek",e[e.CalendarCard=6]="CalendarCard"}(a||(a={})),function(e){e[e.SmimeSignature=0]="SmimeSignature",e[e.Safety=1]="Safety",e[e.Error=2]="Error",e[e.Info=3]="Info",e[e.Encryption=4]="Encryption",e[e.Translation=5]="Translation",e[e.Sensitivity=6]="Sensitivity",e[e.InsightMessage=7]="InsightMessage",e[e.External=8]="External",e[e.Spotlight=9]="Spotlight"}(r||(r={})),function(e){e[e.Grey=0]="Grey",e[e.Red=1]="Red",e[e.Green=2]="Green",e[e.Yellow=3]="Yellow",e[e.Orange=4]="Orange",e[e.Green20=5]="Green20"}(o||(o={}))},1953:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(282);function r(e){switch(e){case 0:return"ReadOnlyAccess";case 1:return"ReadOnlyPlusAttachmentsBlockedAccess";case 2:return null;default:return Object(a.a)(e)}}},19541:function(e,t,n){"use strict";n.r(t);var a=n(23),r=n(0),o=n(3012),i=n(1681),c=n(1754),s=n(6),u=n(7802),l=n(1675),d=n(1986);var b=Object(a.a)((function(e){const{className:t,subjectClassName:n}=e;let a="";const o=Object(l.I)(),b=o&&1==o.tableQuery.type,m=o&&2==o.tableQuery.type;if(b)a=Object(s.b)(u.a);else if(m){const e=c.i.tryImportForRender();e&&(a=e(o))}else{const e=Object(d.a)();e&&(a=Object(i.h)(e))}return r.createElement("div",{className:t,title:a},r.createElement("div",{className:n},a))})),m=n(15909),f=n(263),v=n(702),g=Object(v.action)("setIsOverflowMenuShown")((function(e){Object(f.a)().isOverflowMenuShown=e})),p=n(1148),h=n(63),O=n(334),j=n(11977),I=n.n(j),w=Object(a.a)((function(e){const t=r.useRef(),{viewState:n,className:a,subjectClassName:o}=e,i=n.data,c=Object(s.c)(Object(s.b)(m.a),i.length);return r.createElement("div",{className:a,title:c,onClick:P,ref:e=>t.current=e},r.createElement("div",{className:o},c),r.createElement(O.a,{iconName:"ChevronDown",className:I.a.overflowChevron}),Object(f.a)().isOverflowMenuShown&&r.createElement(p.a,{target:t.current,isBeakVisible:!1,directionalHint:h.a.topRightEdge,onDismiss:S},i.map(e=>r.createElement(ae,{viewState:e,key:e.id}))))}));function S(){g(!1)}function P(){g(!0)}var C=n(4646),x=n(11975),y=n(9807),M=n(8245),A=n(11976),R=n(2239),E=n(3735),k=n(2988),V=n(1902),L=n(3293),B=n(2330),N=n(2240),D=n(13508),T=n.n(D);var _=Object(a.a)((function(e){const t=Object(l.I)();if(!t)return null;const{className:n,subjectClassName:a}=e,o=Object(l.n)(t);let i=null;const{tableQuery:c}=t,d=Object(k.a)();let b="";const m=[...t.selectedRowKeys.keys()],{folderId:f,type:v}=c,g=Object(l.w)(t);if(g||Object(l.W)(t))b=Object(l.G)(g,t,o);else if(m.length>1)b=Object(l.R)(t)?Object(s.c)(Object(s.b)(N.c),m.length):Object(s.c)(Object(s.b)(R.c),m.length);else if(1==m.length){b=l.b.getSubject(m[0],t)||"",""==b.trim()&&(b=Object(s.b)(E.a)),i=Object(l.R)(t)&&Object(L.a)(l.b.getRowIdString(m[0],t))}else b="Loaded"==d||V.a.shouldShowEmptyReadingPane?Object(s.b)(M.a):"Empty"==d?Object(B.c)(f,B.b.Uninitialized)||Object(B.c)(f,B.b.Running)?Object(s.b)(A.a):Object(s.b)(y.b):"Error"==d?Object(s.b)(x.a):1==v?Object(s.b)(u.a):Object(s.b)(C.b);return r.createElement("div",{className:n,title:b},i&&r.createElement(O.a,{iconName:"Edit",className:T.a.leftIcon}),r.createElement("div",{className:a},b))})),F=n(11866),U=n(6816),W=n(1264),J=n(3);var z=Object(J.mutatorAction)("Tab_SetReadingPaneTabHiddenWhenSameWithPrimary",(e,t)=>{e.hideWhenSameWithPrimary=t}),Q=Object(a.a)((function(e){const{viewState:t,className:n,subjectClassName:a}=e,o=t.data;let i=o.subject;i=i||"",""==i.trim()&&(i=Object(s.b)(E.a)),r.useEffect(()=>{z(t.data,!1)},[]);const c=Object(l.I)()&&Object(l.R)(Object(l.I)())&&Object(L.a)(o.id.Id);return r.createElement("div",{className:n,title:i},c&&r.createElement(O.a,{iconName:"Edit",className:T.a.leftIcon}),r.createElement("div",{className:a},i),r.createElement(W.a,{iconProps:{iconName:"Cancel"},onClick:t=>{t.stopPropagation(),Object(U.a)(e.viewState)},className:T.a.rightIcon,"aria-label":Object(s.b)(F.a)}))})),H=n(289),q=n(15912),K=n.n(q),Y=n(166),G=n.n(Y);const Z=G.a.bind(K.a);function X(e){r.useEffect(()=>()=>{c()},[]);const t=r.useRef(null),n=r.useRef(0),[a,o]=r.useState(!1),i=()=>{t.current=null,e.onDragTimeout(),o(!1)},c=()=>{window.clearTimeout(t.current),t.current=null,o(!1)},s=Object.assign({},e);return delete s.onDragEnter,delete s.onDragLeave,delete s.showDragIndicatorArrow,delete s.onDragTimeout,delete s.dragTimeoutMs,delete s.className,r.createElement("div",Object.assign({},s,{className:Z(e.className||"",{[K.a.withDragIndicator]:a&&e.showDragIndicatorArrow,[K.a.canHaveDragIndicator]:e.showDragIndicatorArrow}),onDragEnter:()=>{n.current++,null===t.current&&(t.current=window.setTimeout(i,e.dragTimeoutMs),o(!0))},onDragLeave:()=>{n.current--,null===t.current||n.current>0||c()}}))}var $=n(5615),ee=n(1729),te=n(2110);const ne=G.a.bind(I.a);var ae=Object(a.a)((function(e){const t=()=>{e.viewState.type!=H.a.OverflowMenu&&Object(o.a)(e.viewState,!0)},n=e.viewState,{state:a,blink:i}=n;let c=null;const s={className:I.a.tabContent,subjectClassName:I.a.subject};switch(n.type){case H.a.OverflowMenu:c=r.createElement(w,Object.assign({},Object.assign(Object.assign({},s),{viewState:n})));break;case H.a.MailCompose:c=r.createElement($.c,Object.assign({},Object.assign(Object.assign({},s),{viewState:n})));break;case H.a.SecondaryReadingPane:c=r.createElement(Q,Object.assign({},Object.assign(Object.assign({},s),{viewState:n})));break;case H.a.Primary:c=Object(ee.d)()&&!Object(te.a)()?r.createElement(b,Object.assign({},Object.assign(Object.assign({},s),{viewState:n}))):r.createElement(_,Object.assign({},Object.assign(Object.assign({},s),{viewState:n})))}const u=ne(I.a.tab,{active:2==a,blink:i});return r.createElement(X,{tabIndex:0,className:u,dragTimeoutMs:250,onKeyPress:e=>{"Spacebar"!=e.key&&"Enter"!=e.key&&" "!=e.key||t()},onClick:t,onDragTimeout:t,role:"button",showDragIndicatorArrow:!0},c)})),re=Object(J.mutatorAction)("setBlink",(function(e,t){e.blink=t})),oe=n(967);const ie=1,ce=89,se=8;var ue=function(){const e=Object(f.a)();let t=e.tabs.filter(e=>{const t=Object(oe.a)(e.type);return(1==e.state||2==e.state)&&(!t||!t.canShowTab||t.canShowTab(e))});const n=t.length;let a=e.tabBarWidth-se;if(t.reduce(e=>e+ce,0)-se>a){let e,n=[],r=[],o=t.splice(0,ie);for(t.forEach(e=>{2==e.state?n.unshift(e):r.push(e)}),t=[...o,...n,...r],e=0;a>0&&e<t.length&&(a-=ce,!(a<0));e++);const i=t.splice(e-1).map(e=>(re(e,!1),e));t.push({id:"overflowMenu",type:H.a.OverflowMenu,state:1,blink:!1,data:i,sxsId:null})}return{totalVisibleCount:n,visibleTabs:t}},le=n(9282),de=n(10572),be=n(5259),me=n(5285),fe=n(6041),ve=n(3194),ge=n(806),pe=n(1758);const he={onActivate:e=>{const t=Object(l.I)();if(!Object(te.a)()||!t)return;const n=t.isInVirtualSelectAllMode,a=[...t.selectedRowKeys.keys()];if(1==a.length&&!n){const e=l.b.getRowIdToShowInReadingPane(a[0],t),n=t.tableQuery.listViewType,r=Object(ve.a)([a[0]],t)[0];switch(n){case 0:if(Object(pe.a)())Oe(e,r);else{const n=l.b.getSubject(a[0],t),o=l.b.getCategories(a[0],t);Object(fe.a)(e.Id)||Object(de.a)(e,!0,r,n,o)}break;case 1:Oe(e,r)}}}};function Oe(e,t){Object(le.a)(e.Id)||Object(be.a)(e,t,me.a,null,null)}var je=n(1e3),Ie=Object(v.action)("setTabBarWidth")((function(e){Object(f.a)().tabBarWidth=e})),we=Object(J.mutatorAction)("setTabBarAvailable",e=>{Object(f.a)().isTabBarAvailable=e}),Se=Object(a.a)((function(e){r.useEffect(()=>(we(!0),je.a.importAndExecute(n),n(),()=>{we(!1),je.c.importAndExecute(n)}),[]);const t=r.useRef(),n=()=>{if(t.current){const e=t.current.clientWidth;e>0&&e!=Object(f.a)().tabBarWidth&&Ie(e)}},a=r.useCallback(e=>{t.current!=e&&(t.current=e,n())},[]);Object(ge.q)(ge.a.Primary,he);const{totalVisibleCount:o,visibleTabs:i}=ue();return o>1?r.createElement("div",{className:I.a.tabBar,ref:a},i.map(e=>r.createElement(ae,{key:e.id,viewState:e}))):null}));n.d(t,"TabBar",(function(){return Se}))},2036:function(e,t,n){"use strict";var a=n(2792),r=n(702);const o=Object(r.action)("addInfoBarMessage")((function(e,t,n){if(e){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=[...e.infoBarIds];const r=e.infoBarHostKey;n&&(a.b[r]||(a.b[r]={}),a.b[r][t]=n)}}));t.a=o},2108:function(e,t,n){"use strict";n.d(t,"o",(function(){return c})),n.d(t,"r",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"q",(function(){return l})),n.d(t,"f",(function(){return d})),n.d(t,"u",(function(){return b})),n.d(t,"g",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return v})),n.d(t,"j",(function(){return g})),n.d(t,"i",(function(){return p})),n.d(t,"l",(function(){return h})),n.d(t,"k",(function(){return O})),n.d(t,"c",(function(){return j})),n.d(t,"p",(function(){return I})),n.d(t,"s",(function(){return w})),n.d(t,"b",(function(){return S})),n.d(t,"m",(function(){return P})),n.d(t,"h",(function(){return C})),n.d(t,"t",(function(){return x})),n.d(t,"n",(function(){return y}));var a=n(20),r=n(2377);n.d(t,"v",(function(){return r.a}));var o=n(2378);n.d(t,"w",(function(){return o.a}));const i=new a.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(319)]).then(n.bind(null,4005))),c=new a.a(i,e=>e.initializeAttachments),s=new a.a(i,e=>e.reinitializeAttachments),u=(new a.a(i,e=>e.setInlineAttachmentStatus),new a.a(i,e=>e.addAttachmentIntoWellBeforeUpload)),l=new a.b(i,e=>e.refreshSharingTipsAttachmentWell),d=new a.b(i,e=>e.createAttachmentsViaQueueManager),b=new a.b(i,e=>e.createAttachmentsFromRecentAttachments),m=new a.a(i,e=>e.deleteAttachmentViaQueueManager),f=new a.b(i,e=>e.createAttachmentFullViewStateAndStoreBackingModel),v=new a.b(i,e=>e.createAttachmentFullViewState),g=new a.b(i,e=>e.getAttachmentWellInitialValue),p=new a.b(i,e=>e.getAttachmentWellForCompose),h=new a.b(i,e=>e.getConversationAttachmentWellInitialValue),O=(new a.b(i,e=>e.getMaxClassicAttachmentsSize),new a.b(i,e=>e.getAvailableLocalAttachmentSize)),j=new a.b(i,e=>e.createAttachmentFileFromExistingMailboxAttachment),I=new a.a(i,e=>e.mergeToConversationAttachmentWell),w=new a.a(i,e=>e.sortConversationAttachmentWell),S=new a.a(i,e=>e.convertImageViewAttachmentToInlineAttachment),P=new a.b(i,e=>e.getLastCloudyAttachmentsSharingIssueForBlockOnSend),C=new a.b(i,e=>e.getAllValidAttachments),x=new a.b(i,e=>e.uploadLocalFile),y=new a.b(i,e=>e.getShouldShareAttachmentProperties)},2130:function(e,t,n){"use strict";var a=n(1774);function r(){const e=Object(a.a)();return e.ConditionalAccessDirectFileAccessOnPrivateComputersBlocked||e.ConditionalAccessDirectFileAccessOnPublicComputersBlocked?e.ConditionalAccessWacViewingOnPrivateComputersBlocked||e.ConditionalAccessWacViewingOnPublicComputersBlocked?[1]:[0]:[]}var o=n(1953),i=n(1738);function c(){return r()}function s(e){return(e&&e.length>0&&function(e){return e.some(e=>!function(e){return e.IsInline&&!Object(i.a)(e)}(e))}(e)?r():[]).map(o.a)}n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return s}))},2144:function(e,t,n){"use strict";var a=n(20);const r=[0,1];var o=n(2518),i=n(2500),c=n(6),s=n(282),u=n(1804);function l(e){switch(e){case"ReadOnlyPlusAttachmentsBlockedAccess":return{key:"access_control_info_bar",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(i.a),messageParts:[Object(c.b)(i.a),d()],color:u.a.Red};case"ReadOnlyAccess":return{key:"access_control_info_bar_check",source:u.c.Compose,rank:u.b.Error,message:Object(c.b)(o.b),messageParts:[Object(c.b)(o.b),d()],color:u.a.Red};default:return Object(s.a)(e)}}function d(){return{text:Object(c.b)(o.a),action:()=>{window.open("https://docs.microsoft.com/en-us/intune-user-help/use-managed-devices-to-get-work-done","_blank")}}}var b=n(2130),m=n(1953),f=n(47),v=n(1774);function g(){const e=Object(v.a)();if(Object(f.j)("fwk-devTools")){if(Object(f.j)("doc-attachment-CA-readOnlyAccessIssues"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!0,WacViewingOnPublicComputersEnabled:!0});if(Object(f.j)("doc-attachment-CA-readOnlyPlusAttachmentsBlocked"))return Object.assign(Object.assign({},e),{DirectFileAccessOnPrivateComputersEnabled:!1,DirectFileAccessOnPublicComputersEnabled:!1,WacViewingOnPrivateComputersEnabled:!1,WacViewingOnPublicComputersEnabled:!1})}return e}function p(){const e=g();return e.DirectFileAccessOnPrivateComputersEnabled&&e.DirectFileAccessOnPublicComputersEnabled?2:e.WacViewingOnPrivateComputersEnabled&&e.WacViewingOnPublicComputersEnabled?0:1}n.d(t,"g",(function(){return O})),n.d(t,"a",(function(){return r})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return b.a})),n.d(t,"e",(function(){return m.a})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return g}));const h=new a.c(()=>n.e(1929).then(n.bind(null,19270))),O=new a.b(h,e=>e.getAccessIssuesForAttachments)},2377:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("ON_ATTACHMENT_CREATED",(e,t,n,a=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:a}))},2378:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("ON_ATTACHMENT_DELETED",(e,t,n,a=!0)=>({parentItemId:e,attachmentId:t,attachment:n,shouldTriggerAddInAttachmentsChangedCallback:a}))},2500:function(e){e.exports=JSON.parse('{"a":"rda"}')},2518:function(e){e.exports=JSON.parse('{"a":"pda","b":"qda"}')},2519:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(3),r=n(4114);const o=Object(a.createStore)("protection",Object(r.a)()),i=o()},2792:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r}));const a={};function r(e,t){var n;const r=e.infoBarHostKey;return null===(n=a[r])||void 0===n?void 0:n[t]}},2793:function(e,t,n){"use strict";n.d(t,"m",(function(){return o})),n.d(t,"l",(function(){return i})),n.d(t,"o",(function(){return c})),n.d(t,"q",(function(){return s})),n.d(t,"p",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return b})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"n",(function(){return v})),n.d(t,"r",(function(){return g})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"j",(function(){return O})),n.d(t,"f",(function(){return j})),n.d(t,"i",(function(){return I})),n.d(t,"a",(function(){return w}));var a=n(20);const r=new a.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(308)]).then(n.bind(null,4953))),o=new a.a(r,e=>e.onSmimeItemAttachmentOpened),i=new a.a(r,e=>e.mergeSmimeDecodedMessageProperties),c=(new a.b(r,e=>e.fetchAndDecodeSmimeMessage),new a.b(r,e=>e.setSmimePropertiesInDraftMessage)),s=new a.b(r,e=>e.trySetSmimeProperties),u=new a.b(r,e=>e.tryAddSmimeProperties),l=new a.b(r,e=>e.createMailResponseBodyContent),d=new a.b(r,e=>e.downloadSmimeAttachment),b=new a.b(r,e=>e.getMergedSmimeViewState),m=new a.b(r,e=>e.getMergedSmimeViewStateForDraft),f=new a.b(r,e=>e.isSmimeItemDecoding),v=new a.b(r,e=>e.previewSmimeAttachment),g=new a.b(r,e=>e.updateSmimeAttachmentIds),p=new a.b(r,e=>e.createSmimeAttachmentsFromFiles),h=new a.b(r,e=>e.createSmimeAttachmentsViaSmimeQueueManager),O=new a.b(r,e=>e.initializeAttachmentStateForSmimeAttachments),j=new a.b(r,e=>e.getAttachmentsForSmimeResponse),I=new a.b(r,e=>e.getSmimeAttachmentsForRequest),w=Object(a.d)(r,e=>e.SignatureDetails)},3011:function(e,t,n){"use strict";n.d(t,"b",(function(){return r}));var a=n(3);const r=Object(a.createStore)("SmimeStore",{installationStatus:0,isBrowserSupportActiveX:!1,version:""}),o=r();t.a=o},3012:function(e,t,n){"use strict";var a=n(289),r=n(966),o=n(3254),i=n(71),c=n(702),s=n(967);t.a=Object(c.action)("activateTab")((function(e,t){const n=new i.b("TabViewActivateTab",{isVerbose:!0});switch(n.addCustomData([e.type,t]),Object(o.a)(e,!0),e.type){case a.a.Primary:case a.a.OverflowMenu:case a.a.SecondaryReadingPane:case a.a.MailCompose:if(2!=e.state){const t=Object(r.a)();if(t){t.state=1;const e=Object(s.a)(t.type);(null==e?void 0:e.onDeactivate)&&e.onDeactivate(t)}if(e){e.state=2,e.blink=!1;const t=Object(s.a)(e.type);(null==t?void 0:t.onActivate)&&t.onActivate(e)}}}n.end()}))},3205:function(e,t,n){"use strict";n.d(t,"n",(function(){return u})),n.d(t,"m",(function(){return l})),n.d(t,"j",(function(){return d})),n.d(t,"i",(function(){return b})),n.d(t,"k",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return g})),n.d(t,"g",(function(){return p})),n.d(t,"d",(function(){return h})),n.d(t,"h",(function(){return O})),n.d(t,"e",(function(){return I})),n.d(t,"l",(function(){return w})),n.d(t,"b",(function(){return S}));var a=n(3591),r=n(99),o=n(2035),i=n(2322),c=n(3245),s=n(132);function u(){return Object(r.d)()||Object(r.e)()}function l(e){return function(e){if(e.length<2)return!1;const t=e[0]-parseInt(o.b),n=e[1]-parseInt(o.c);return 0==t&&n>=0}("string"==typeof e?e.split(".").map(e=>parseInt(e)):[])}function d(e){const t="string"==typeof e?e.split("."):[];return t.length&&t[0]!=o.b}function b(){return Object(a.a)()&&Object(s.a)("smimeExtension")}function m(e){return 0!==e}function f(e){const t=[];t.push(e.UserEmailAddress),t.push(e.LogonEmailAddress),t.push(e.UserPrincipalName),t.push(e.UserLegacyExchangeDN);const n=e.UserProxyAddresses;return n&&n.length>0&&n.forEach((function(e){t.indexOf(e)>=0||t.push(e)})),t}function v(e){let t=65001;return e.UseGB18030?t=54936:e.UseISO885915&&(t=28605),t}function g(e){return{AllowUserChoiceOfSigningCertificate:e.AllowUserChoiceOfSigningCertificate,IncludeCertificateChainWithoutRootCertificate:e.IncludeCertificateChainWithoutRootCertificate,IncludeCertificateChainAndRootCertificate:e.IncludeCertificateChainAndRootCertificate,EncryptTemporaryBuffers:e.EncryptTemporaryBuffers,SignedEmailCertificateInclusion:e.SignedEmailCertificateInclusion,IncludeSmimeCapabilitiesInMessage:e.IncludeSMIMECapabilitiesInMessage,CopyRecipientHeaders:e.CopyRecipientHeaders,OnlyUseSmartCard:e.OnlyUseSmartCard,EncryptionAlgorithms:e.EncryptionAlgorithms,SigningAlgorithms:e.SigningAlgorithms}}function p(e,t){const n=Object(c.a)().ClearSign;return t||e&&!n?i.a:o.e}function h(e){return btoa(unescape(encodeURIComponent(e)))}function O(e,t){const n=Object(c.a)();return e&&t?n.TripleWrapSignedEncryptedMail?14:12:e?n.ClearSign?11:10:6}function j(){return(Math.floor(4026531839*Math.random())+268435456).toString(16)}function I(e){return o.k+(e||j()+j()+j()+j())}function w(e,t){return t.IsInline&&-1===e.indexOf(t.ContentId)}function S(){return o.d+j()+"@"+j()+"."+j()}},3244:function(e,t,n){"use strict";function a(e,t,n,a){const o=r(e,t,n,a);return o?o.Value:null}function r(e,t,n,a){if(!e||!e.ExtendedProperty)return null;for(let r=0;r<e.ExtendedProperty.length;r++){const o=e.ExtendedProperty[r];let i=null,c=null,s=null;if((null==o?void 0:o.ExtendedFieldURI)&&(i=o.ExtendedFieldURI.PropertyTag,c=o.ExtendedFieldURI.PropertyName,s=o.ExtendedFieldURI.PropertyId),t&&i==t)return o;if(n&&c==n)return o;if(a&&s==a)return o}return null}n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r}))},3245:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(66);function r(){var e;return null===(e=a.a.userConfiguration)||void 0===e?void 0:e.SmimeAdminSettings}},3254:function(e,t,n){"use strict";var a=n(3012),r=n(702),o=n(263);t.a=Object(r.action)("setTabIsShown")((function(e,t){switch(e.state){case 0:t&&(e.state=1,e.blink=!0);break;case 1:case 2:case 3:if(!t){const t=2==e.state&&function(e){const t=Object(o.a)().tabs,n=Math.max(t.indexOf(e),0),a=t.filter(t=>t.id==e.parentTabId&&1==t.state)[0];if(a)return a;for(let e=n;e<t.length;e++)if(1==t[e].state)return t[e];for(let e=n-1;e>=0;e--)if(1==t[e].state)return t[e];return null}(e);t&&Object(a.a)(t),e.state=0}}}))},3291:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(38);function r(){const e=Object(a.a)();return"ChronologicalNewestOnBottom"==(e.UserOptions?e.UserOptions.ConversationSortOrderReact:"ChronologicalNewestOnBottom")}},3293:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(806),r=n(263),o=n(937),i=n(282);function c(e,t=0,n,c){const d=function(e){switch(e){case 0:return s;case 1:return u;case 2:return l;default:return Object(i.a)(e)}}(t),b=Object(o.b)();for(const t of Object(r.a)().tabs)if(t.type==a.a.MailCompose&&0==t.state){const a=b.viewStates.get(t.data);if((null==a?void 0:a.isInlineCompose)&&d(a,e)&&(0==a.asyncSendState||n&&6==a.asyncSendState)&&(!c&&!t.projectionRPTabId||t.projectionRPTabId==c))return a}return null}function s(e,t){return e.conversationId===t}function u(e,t){return e.referenceItemId.Id===t}function l(e,t){return!1}},3407:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3011);function r(){const e=Object(a.b)();return 9==e.installationStatus||6==e.installationStatus}},3453:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return b}));var a=n(20);const r=new a.c(()=>Promise.all([n.e(4),n.e(8),n.e(10),n.e(12),n.e(397)]).then(n.bind(null,5983))),o=new a.a(r,e=>e.loadCLPUserLabels),i=(new a.a(r,e=>e.addAuditActionToViewState),new a.b(r,e=>e.showJustificationModal)),c=new a.a(r,e=>e.loadItemCLPInfo),s=new a.b(r,e=>e.updateItemCLPInfo),u=new a.b(r,e=>e.logReadCLPLabel),l=new a.b(r,e=>e.triggerCLPAutoLabeling),d=(new a.b(r,e=>e.constructCLPAuditAction),Object(a.d)(r,e=>e.CLPSubjectHeaderLabel)),b=Object(a.d)(r,e=>e.CLPMandatoryLabelModal)},3454:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(20);const r=new a.c(()=>Promise.all([n.e(117),n.e(706)]).then(n.bind(null,6136))),o=new a.b(r,e=>e.SmimeAdapter)},3457:function(e,t,n){"use strict";var a=n(47),r=n(2519),o=n(296);t.a=function(){const{clpLabels:e}=r.b;return Object(a.j)("cmp-clp")&&e.length>0&&e.some(e=>e.isLabelEnabled)&&!Object(o.a)()}},3591:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(99),r=n(2035);function o(){return Object(a.d)()&&Object(a.m)([r.f])||Object(a.e)()&&Object(a.m)([r.g])}},3824:function(e,t,n){"use strict";function a(e){return Math.min(Math.floor(e/2),24)}n.d(t,"b",(function(){return a})),t.a={RPPerfLoadConversationReadingPane:{name:"RPPerfLoadConversationReadingPane"},RPPerfLoadItemReadingPane:{name:"RPPerfLoadItemReadingPane"},RPCountExpCollQuotedText:{name:"RPCountExpCollQuotedText",customData:(e,t,n)=>[n?1:0,!e.isExpanded]},RPCountLoadMore:{name:"RPCountLoadMore"},RPCountExpCollAllItemParts:{name:"RPCountExpCollAllItemParts",customData:(e,t,n)=>[t,n]},PrintItem:{name:"PrintItem",actionSource:(e,t,n)=>t},ReplyByMeeting:{name:"ReplyByMeeting",actionSource:(e,t,n)=>n}}},3907:function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"m",(function(){return c})),n.d(t,"p",(function(){return s})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"i",(function(){return v})),n.d(t,"j",(function(){return g})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return h})),n.d(t,"o",(function(){return O})),n.d(t,"n",(function(){return j}));var a=n(20),r=n(4113);n.d(t,"k",(function(){return r.a}));const o=new a.c(()=>Promise.all([n.e(0),n.e(8),n.e(9),n.e(10),n.e(299)]).then(n.bind(null,7676))),i=new a.a(o,e=>e.addItemToCalendar),c=new a.a(o,e=>e.initializeMeetingRequestViewStateAction),s=new a.a(o,e=>e.removeCancelledMeetingFromCalendar),u=Object(a.d)(o,e=>e.MeetingMessageInfo),l=(Object(a.d)(o,e=>e.MeetingRequestActions),Object(a.d)(o,e=>e.MeetingCancellationAction),Object(a.d)(o,e=>e.MeetingActionButton),Object(a.d)(o,e=>e.MeetingDetailsTime),Object(a.d)(o,e=>e.MeetingDetailsLocation),Object(a.d)(o,e=>e.MeetingRequestInfo)),d=Object(a.d)(o,e=>e.MeetingRequestResponseEditor),b=Object(a.d)(o,e=>e.MeetingDetails),m=Object(a.d)(o,e=>e.MeetingRequestConflicts),f=(Object(a.d)(o,e=>e.EditEventLink),Object(a.d)(o,e=>e.MeetingMessageSummary)),v=Object(a.d)(o,e=>e.PreviewSummary),g=Object(a.d)(o,e=>e.SenderSummary),p=Object(a.d)(o,e=>e.CollapsedMeetingMessage),h=Object(a.d)(o,e=>e.MeetingIcon),O=new a.a(o,e=>e.logMeetingMessageActionForInvite),j=new a.a(o,e=>e.logMeetingMessageActionForEvent)},3965:function(e,t,n){"use strict";t.a=e=>{var t;return null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.isDecoded}},4113:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("deleteMeetingMessage",(e,t)=>({item:e,issueDeleteItemCall:t}))},4114:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(16);function r(){return{clpLabels:[],learnMoreUrl:"",hasMandatoryLabel:!1,rmsTemplates:new a.ObservableMap,messageClassifications:new a.ObservableMap}}},4254:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.TXP=0]="TXP",e[e.CalendarCard=1]="CalendarCard",e[e.MeetingPoll=2]="MeetingPoll",e[e.Voting=3]="Voting",e[e.Yammer=4]="Yammer",e[e.SharePointPage=5]="SharePointPage"}(a||(a={}))},4315:function(e,t,n){"use strict";function a(e,t){return{infoBarIds:t||[],infoBarHostKey:e||"0"}}n.d(t,"a",(function(){return a}))},4419:function(e,t,n){"use strict";t.a=(e,t=!0)=>{const n=t?23:24;return e>=n?n:e}},4539:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return c}));var a=n(1693);function r(e){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&e.conversationNodeIdsInCollapsedItemsRollUp.length>0}function o(e){const t=a.a.conversations.get(e.conversationId.Id);return r(e)||(null==t?void 0:t.canLoadMore)}function i(e,t){return(null==e?void 0:e.conversationNodeIdsInCollapsedItemsRollUp)&&t&&e.conversationNodeIdsInCollapsedItemsRollUp.includes(t.conversationNodeId)}function c(e){if(!r(e))return 0;const{conversationNodeIdsInCollapsedItemsRollUp:t,itemPartsMap:n}=e;let a=t.length;return t.forEach(e=>{const t=n.get(e);t.oofRollUpViewState.oofReplyNodeIds&&(a+=t.oofRollUpViewState.oofReplyNodeIds.length)}),a}},4645:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(1902),r=n(3),o=n(806),i=n(3195);const c=Object(r.mutatorAction)("addLoadedItemReadingPaneViewState",(function(e){const t=e.itemId,{loadedItemReadingPaneViewStates:n}=Object(a.b)();n.has(t)||n.set(t,e)})),s=Object(r.mutatorAction)("releaseOrphanedLoadedItemViewStates",(function(){const{loadedItemReadingPaneViewStates:e,loadingProjectionIds:t,itemPreviewPaneViewState:n,itemPrintPaneViewState:r}=Object(a.b)();e.forEach((a,c)=>{c==Object(i.a)()||Object(o.r)(c)||-1!=(null==t?void 0:t.indexOf(c))||c==(null==n?void 0:n.itemId)||c==(null==r?void 0:r.itemId)||e.delete(c)})})),u=Object(r.mutatorAction)("releaseLoadedItemViewState",(function(e){Object(a.b)().loadedItemReadingPaneViewStates.delete(e)}))},4646:function(e){e.exports=JSON.parse('{"a":"Qga","b":"Rga"}')},4670:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e[e.Item=0]="Item",e[e.Oof=1]="Oof",e[e.FossilizedText=2]="FossilizedText",e[e.SeeMore=3]="SeeMore"}(a||(a={}))},4908:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(3011),r=n(3205);function o(){const e=Object(a.b)();return Object(r.k)(e.installationStatus)}},4960:function(e,t,n){"use strict";var a=n(7355),r=n(3824),o=n(5828),i=n(6275),c=n(5829),s=n(5830),u=n(6041),l=n(5032);var d=n(16),b=n(71),m=n(47),f=n(4315),v=n(5831),g=n(1683),p=n(1693);function h(e){const t=g.a.conversationItems.get(e);if(t){const n=function(e){const t={unreadItemCount:0,totalItemCount:0},n=p.a.conversations.get(e);for(const e of n.conversationNodeIds){const n=p.a.conversationNodes.get(e);if(!n){t.totalItemCount=0;break}t.totalItemCount+=n.itemIds.length;for(const e of n.itemIds){const n=p.a.items.get(e);if(!n){t.totalItemCount=0;break}t.unreadItemCount+=n.IsRead?0:1}}return t}(e);return t.globalItemIds.length!=n.totalItemCount||t.globalUnreadCount!=n.unreadItemCount}return!1}var O=n(1747),j=n(1692),I=n(2589),w=n(2013);n.d(t,"a",(function(){return P}));const S=[];let P=function(e){if(!e||!e.Id)return[null,null];const t=j.u.conversationNodes.get(e.Id),[n,a,r]=Object(w.a)(t);if(!Object(w.c)(n,r,a))return[null,null];const i={isExpanded:!1,loadingState:{isLoading:!1,hasLoadFailed:!1}},c=function(e,t,n){return!e.IsRead&&t||e.IsDraft&&!n}(n,a,r),u={mailboxInfo:e.mailboxInfo,Id:n.ItemId.Id};var d;return[Object.assign(Object.assign({},Object(f.a)(u.Id,Object(o.a)())),{conversationNodeId:e.Id,itemId:u.Id,isConversationItemPart:!0,isExpanded:c,isLocal:a,isDeleted:r,attachmentWell:null,quotedBodyViewState:i,isFossilizedTextExpanded:c,hideSmartReplyFeedbackDialog:!0,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,oofRollUpViewState:(d=n.ItemClass,{isOofItem:l.a.test(d),oofReplyNodeIds:[],isOofRollUpExpanded:!1}),isInRollUp:!1,smartPillViewState:{smartPillBlockVisible:!1},ampViewState:Object(v.a)(n),hasMeetingPoll:Object(s.a)(n),omeMessageState:null}),n]};t.b=Object(b.r)(r.a.RPPerfLoadConversationReadingPane,(function(e,t,n,o,s){let l,f=Promise.resolve(),v=function(e,t,n,a,r){return{conversationId:e,conversationSubject:t,conversationCategories:n,initiallySelectedItemPart:null,itemIdToScrollTo:r,itemPartsMap:new d.ObservableMap({}),loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(O.b)(),unsupportedItemId:null,instrumentationContext:a,attachmentWell:null,calendarInlineComposeViewState:null,focusedItemPart:null,conversationNodeIdsInCollapsedItemsRollUp:[],nodeIdBundledWithSeeMoreMessages:null,extendedCardViewState:null}}(e,n,o,t,s);const g=Object(j.q)(e.Id),p=Object(b.q)(e=>e.eventName==r.a.RPPerfLoadConversationReadingPane.name);if(Object(m.j)("ring-dogfood")){let t=!1;S.includes(e.Id)?t=!0:S.push(e.Id),Object(b.o)("RPCacheStatus",{hasValidConversationCache:g,hasOpened:t,OpenedCount:S.length})}return Object(i.c)(),g&&(l="Valid",j.c.getAndTouch(e.Id),Object(u.a)(e.Id)||(Object(i.a)(v),Object(a.a)(e.Id))),g&&!h(e.Id)||(Object(i.a)(v),l=g?"Stale":"Not",f=I.e.importAndExecute(e,"LoadConversationReadingPane",p)),f.then(()=>{var n,a;null===(a=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===a||a.call(n,"LCRP_POST"),p&&p.addCustomData(Object(c.a)(e.Id,l))})}))},5031:function(e,t,n){"use strict";function a(e,t){return(null==e?void 0:e.extendedCardViewState)&&e.extendedCardViewState.cardType==t}function r(e){var t;return null===(t=null==e?void 0:e.extendedCardViewState)||void 0===t?void 0:t.coverOriginalContent}function o(e,t){return a(e,t)?e.extendedCardViewState.cardViewState:null}n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}))},5032:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=/ipm.note.rules.ooftemplate.microsoft/i},5259:function(e,t,n){"use strict";var a=n(3400),r=n(5284),o=n(5285),i=n(3824),c=n(5828),s=n(4645),u=n(6652),l=n(1902),d=n(2709),b=n(5829),m=n(5830),f=n(5286),v=n(47),g=n(4315),p=n(5831),h=n(1747),O=n(3453),j=n(6818),I=n(2589),w=n(1693),S=n(2793),P=n(3454),C=n(3011),x=n(4908),y=n(3407),M=n(5995),A=n(5833);var R=e=>{var t;return(null===(t=null==e?void 0:e.Smime)||void 0===t?void 0:t.ErrorState)||0},E=n(5277),k=n(3965),V=n(2148),L=n(36),B=n(3),N=n(71);const D=(e,t)=>{L.h.info("S/MIME: processing S/MIME message. isSmimeAdapterAlreadyUsable: "+Object(y.a)());const n=new N.b("RPProcessSmimeItem",{isCore:!0});return S.q.import().then(t=>t(e)).then(()=>{J(e,n,t)}).catch(()=>{J(e,n,t)})};function T(e,t,n,o,i,c){if(e.itemId!=t.Id)return;const s=(null==t?void 0:t.Id)&&Object(w.b)().items.get(t.Id);_(e,t,s,n),s&&(o.addCustomData(Object(b.b)(s,c,i)),O.h.import().then(e=>{e(s)}),Object(f.d)(s)?F(e):(Object(r.a)(e.itemViewState,!1,{item:s}),Object(a.a)(e,s)))}const _=Object(B.mutatorAction)("setReadpingPaneItemState",(e,t,n,a)=>{e.itemViewState=function(e,t){return Object.assign(Object.assign({},Object(g.a)(e.Id,Object(c.a)())),{itemId:e.Id,isConversationItemPart:!1,attachmentWell:null,meetingRequestViewState:null,loadingState:{isLoading:!1,hasLoadFailed:!1},actionableMessageCardInItemViewState:{showBodyWithMessageCard:!1,showCardLoading:!0},undoDarkMode:!1,isLoadingFullBody:!1,smartPillViewState:{smartPillBlockVisible:!1},hideSmartReplyFeedbackDialog:!0,ampViewState:Object(p.a)(t),hasMeetingPoll:Object(m.a)(t),omeMessageState:Object(j.a)(t)})}(t,n),e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!n,e.instrumentationContext=a}),F=Object(B.mutatorAction)("setReadpingPaneUnuspportedItem",e=>{e.isUnsupportedItem=!0}),U=(e,t,n,a,r,o)=>a?a(e):I.f.importAndExecute(e,n?"LoadItemPreviewPane":"LoadItemReadingPane",t,Object(y.a)(),r),W=(e,t,n,a,r)=>{if(Object(V.a)(n)){let o;return P.a.import().then(()=>Object(y.a)()&&Object(M.a)(n)?(o=!0,U(e,t,a,r,null)):n).then(()=>D(e,o))}return Promise.resolve()};function J(e,t,n){const a=Object(w.b)().items.get(null==e?void 0:e.Id);t.addCustomData({smimeInstallationStatus:C.a.installationStatus,smimeType:Object(E.a)(a),numAttachments:z(a),wasReloaded:n}),Object(k.a)(a)?t.end():t.endWithError("ClientError",new Error(R(a).toString()))}function z(e){var t;return null===(t=null==e?void 0:e.Attachments)||void 0===t?void 0:t.length}const Q=Object(B.mutatorAction)("setItemReadingPaneOnError",e=>{e&&(e.loadingState.isLoading=!1,e.loadingState.hasLoadFailed=!0)});t.a=Object(N.r)(i.a.RPPerfLoadItemReadingPane,(function(e,t,n,a,r){let c=function(e,t,n,a){return{itemId:e.Id,itemViewState:null,isPrint:t,loadingState:{isLoading:!0,hasLoadFailed:!1},currentSelectedFolderId:Object(h.b)(),isUnsupportedItem:!1,instrumentationContext:null,extendedCardViewState:null,isReadonly:n}}(e,null==a?void 0:a.isPrint,!!(null==a?void 0:a.isReadOnly),null==a||a.isProjection);(null==a?void 0:a.isProjection)&&Object(u.a)(e.Id),Object(s.c)(),Object(o.a)(c),(null==a?void 0:a.isPrint)?(n&&n(c),c=Object(l.b)().itemPrintPaneViewState):(c=Object(d.a)(e.Id),n&&n(c));const b=Object(N.q)(e=>e.eventName==i.a.RPPerfLoadItemReadingPane.name),m=Object(w.b)().items.get(e.Id),f=!(null==a?void 0:a.isPrint)&&!(null==a?void 0:a.isPreviewPane);Object(v.j)("ring-dogfood")&&f&&Object(N.o)("RPMailStoreItemsCount",{count:Object(w.b)().items.size});const g=Object(M.a)(m),p=Object(V.a)(m);if(p&&m.Smime&&!Object(k.a)(m)&&(m.Smime.ErrorState=0),m&&(m.NormalizedBody&&!g||Object(A.a)(m))){if(p&&!Object(k.a)(m)){return new N.b("RPProcessSmimeItem").addCustomData({wasItemReloaded:!1}),D(e,!1).then(()=>{var n,r;return null===(r=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===r||r.call(n,"LIRP_SMIME"),T(c,e,t,b,null==a?void 0:a.isPrint,null==a?void 0:a.isPreviewPane)})}return T(c,e,t,b,null==a?void 0:a.isPrint,null==a?void 0:a.isPreviewPane),Promise.resolve()}return new Promise(e=>p&&g&&!Object(x.a)()?P.a.import().then(e):e(void 0)).then(()=>{var n,o;return null===(o=null===(n=null==t?void 0:t.dp)||void 0===n?void 0:n.addCheckpoint)||void 0===o||o.call(n,"LIRP_THEN"),function(e,t,n,a,r,o){return U(t,a,null==r?void 0:r.isPreviewPane,o,null==r?void 0:r.isDiscovery).then(e=>{var i,c;return null===(c=null===(i=null==n?void 0:n.dp)||void 0===i?void 0:i.addCheckpoint)||void 0===c||c.call(i,"LI_THEN"),W(t,a,e,null==r?void 0:r.isPreviewPane,o)}).then(()=>{var o,i;return null===(i=null===(o=null==n?void 0:n.dp)||void 0===o?void 0:o.addCheckpoint)||void 0===i||i.call(o,"LI_SMIME_THEN"),T(e,t,n,a,null==r?void 0:r.isPrint,null==r?void 0:r.isPreviewPane)}).catch(t=>(Q(e),Promise.reject(t)))}(c,e,t,b,a,r)})}))},5284:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(5997),r=n(1693),o=n(3907),i=n(2481);async function c(e,t=!1,n={item:r.a.items.get(e.itemId)}){await Object(a.a)(e,n.item,t),n.item&&Object(i.f)(n.item.ItemClass)&&o.m.importAndExecute(e)}},5285:function(e,t,n){"use strict";var a=n(4645),r=n(702);t.a=Object(r.action)("setItemReadingPaneViewState")((function(e){Object(a.a)(e)}))},5286:function(e,t,n){"use strict";n.d(t,"d",(function(){return f})),n.d(t,"c",(function(){return v})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p}));var a=n(1681),r=n(1693),o=n(1678);const i="IPM.Appointment",c="IPM.Contact",s="IPM.DistList",u="IPM.Task",l="calendar",d="contacts",b="tasks",m="inbox";function f(e){return e&&(h(e.ItemClass)||O(e.ItemClass)||j(e.ItemClass)||I(e.ItemClass))}function v(e){const t=r.a.conversations.get(e),n=r.a.conversationNodes.get(t&&t.conversationNodeIds[0]);if(n){const e=n.itemIds[0];if(f(r.a.items.get(e)))return e}return null}function g(e){const t=r.a.items.get(e);return h(t.ItemClass)?Object(o.a)(l):O(t.ItemClass)||j(t.ItemClass)?Object(o.a)(d):I(t.ItemClass)?Object(o.a)(b):Object(o.a)(m)}function p(e){let t="";const n=a.d.folderTable.get(e);return n&&(t=Object(a.h)(n)),t}function h(e){return 0==e.indexOf(i)}function O(e){return 0==e.indexOf(c)}function j(e){return 0==e.indexOf(s)}function I(e){return 0==e.indexOf(u)}},5287:function(e,t,n){"use strict";var a,r;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),function(e){e[e.None=0]="None",e[e.Revocable=1]="Revocable",e[e.Expirable=2]="Expirable"}(a||(a={})),function(e){e[e.None=0]="None",e[e.SuccessOrNoChange=1]="SuccessOrNoChange",e[e.FailedOrMessageNotFound=2]="FailedOrMessageNotFound",e[e.PartialFailed=3]="PartialFailed"}(r||(r={}))},5828:function(e,t,n){"use strict";function a(){return["unsubscribeInfoBar","safetyBar","infoImportance","infoSensitivity","infoFlagStatus","irmInfoBar","infoMessageSubmitted","agendaMailFeedback","unauthenticatedSender","infoDelegate","infoMeetingAttendeeDoNotForward","infoSMIME","infoSmimeDecodeError","infoSmimeSigned","infoItemPartLoadFailure","infoLastUserAction","infoReadReceiptRequested","translateInfoBar","infoResend","infoPolicyTag","infoMessageApprovalAndVoting","nudged","nudgeFeedback","infoMessageClassification","infoCLPLabel","infoRevocation","externalMessage","spotlight","spotlightFeedback"]}n.d(t,"a",(function(){return a}))},5829:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var a=n(3291),r=n(2111),o=n(1693),i=n(4419),c=n(2481),s=n(38),u=n(2148);const l="Meeting",d="Message";function b(e,t){let n=0,s=0,u=0,l=0,d=0;const b=Object(r.a)(e);if(b){const e=b.itemPartsMap;e.forEach(e=>{e.isExpanded&&l++;const t=o.a.items.get(e.itemId);t&&(t.IsRead||n++,t.IsDraft&&s++,Object(c.b)(t)&&u++)}),d=e.size}return{owa_1:v(),owa_2:Object(a.a)(),owa_3:Object(i.a)(d),owa_4:Object(i.a)(l),owa_5:Object(i.a)(n),owa_6:Object(i.a)(u),owa_7:Object(i.a)(s),owa_8:t}}function m(e,t,n){return{owa_1:v(),owa_2:f(e),owa_3:t,owa_4:n,owa_5:Object(u.a)(e)}}function f(e){return Object(c.b)(e)?l:d}function v(){return Object(s.a)().UserOptions.GlobalReadingPanePositionReact}},5830:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(6),r=n(47);const o="findtime/vote?getrequesturl=";function i(e){if(!Object(r.j)("cal-mf-meetingPollCard")||!e)return!1;let t=null;return e.UniqueBody?t=e.UniqueBody.Value:e.NormalizedBody&&(t=e.NormalizedBody.Value),!Object(a.k)(t)&&t.indexOf(o)>-1}},5831:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(6581);function r(e){return{preferAmp:!0,ampAvailability:Object(a.a)(e)}}},5832:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1686),r=n(47),o=n(296);function i(){const e=Object(a.g)(a.d.AmpDeveloper);return Object(o.a)()&&Object(r.j)("rp-amp")&&e.enabled}},5833:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2035);function r(e){return(null==e?void 0:e.ItemId)&&0===e.ItemId.Id.indexOf(a.k)}},5995:function(e,t,n){"use strict";var a=n(3439),r=n(3965),o=n(2148),i=n(4908),c=n(3407);var s=()=>!!Object(i.a)()&&!Object(c.a)();t.a=e=>!Object(r.a)(e)&&!s()&&Object(o.a)(e)&&!Object(a.a)(e)},5997:function(e,t,n){"use strict";var a=n(2144),r=n(2108),o=n(3439),i=n(3965),c=n(2148),s=n(3),u=n(2111),l=n(1693),d=n(6220);function b(e,t){var n;const a=l.a.items.get(t);if(a){const t=a.InternetMessageId,r=null===(n=Object(u.a)(e))||void 0===n?void 0:n.itemPartsMap.get(t);return r?r.attachmentWell:null}return null}var m=n(2036);async function f(e,t,n=!1){if(!t||Object(c.a)(t)&&!function(e,t){if(!Object(o.a)(t))return!0;if(!e.isConversationItemPart&&Object(i.a)(t))return!0;return!1}(e,t)||!t.Attachments)return;if(!e.attachmentWell){const t=await r.j.import();v(e,t(!0,!1,""))}d.a.register(b),n?await r.r.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,null,null,!!t.RightsManagementLicenseData,Object(c.a)(t),g(t.ItemClass)):await r.o.importAndExecute(t.Attachments,t.MailboxInfo,e.attachmentWell,!0,!1,null,null,!!t.RightsManagementLicenseData,Object(c.a)(t),g(t.ItemClass)),(await a.g.import())(t.Attachments).forEach(t=>Object(m.a)(e,t))}n.d(t,"a",(function(){return f}));const v=Object(s.mutatorAction)("setAttachmentWellForItem",(e,t)=>{e.attachmentWell=t});function g(e){switch(e){case"IPM.Note.rpmsg.Microsoft.Voicemail.UM.CA":case"IPM.Note.rpmsg.Microsoft.Voicemail.UM":return!0;default:return!1}}},6041:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1902);function r(e){return Object(a.b)().loadedConversationReadingPaneViewStates.has(e)}},6220:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(36);let r=null;const o={register:e=>{r=e},available:()=>!!r,run:(e,t)=>r?r(e,t):(a.d("getAttachmentWellViewStateByItemIdHelper is not registered."),null)}},6221:function(e,t,n){"use strict";var a;n.d(t,"a",(function(){return a})),function(e){e.None="none",e.AmpDisabled="ampDisabled",e.MessageUnsafe="messageUnsafe",e.SenderNotAllowed="sendNotAllowed",e.BrowserNotSupported="browserNotSupported",e.AmpNotValidated="ampNotValidated",e.AmpValidationFailed="ampValidationFailed",e.AmpValidated="ampValidated"}(a||(a={}))},6275:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n(1902),r=n(3),o=n(806),i=n(3195);const c=Object(r.mutatorAction)("addLoadedConversationReadingPaneViewState",(function(e){const t=e.conversationId.Id,{loadedConversationReadingPaneViewStates:n}=Object(a.b)();n.has(t)||n.set(t,e)})),s=Object(r.mutatorAction)("releaseOrphanedLoadedConversationViewStates",(function(){const{loadedConversationReadingPaneViewStates:e}=Object(a.b)();e.forEach((t,n)=>{Object(o.r)(n)||n==Object(i.a)()||e.delete(n)})})),u=Object(r.mutatorAction)("releaseLoadedConversationViewState",(function(e){Object(a.b)().loadedConversationReadingPaneViewStates.delete(e)}))},6581:function(e,t,n){"use strict";var a=n(6);var r=n(6653),o=n(5832),i=n(6221),c=n(6654),s=n(1686);function u(e){if(!function(e){return e&&!Object(a.k)(e.AmpHtmlBody)}(e))return i.a.None;if(!Object(o.a)())return i.a.AmpDisabled;if(!function(e){return e&&!e.BlockStatus&&(!e.MessageSafety||!e.MessageSafety.MessageSafetyLevel||e.MessageSafety.MessageSafetyLevel<=2)}(e))return i.a.MessageUnsafe;const t=Object(r.a)(e);return null==t||!function(e){const t=Object(s.g)(s.d.AmpDeveloper);return t.enabled&&t.allowedSender.some(t=>l(t,e))}(t)&&!function(e){return c.a.allowedSenders&&c.a.allowedSenders.some(t=>l(t,e))}(t)?i.a.SenderNotAllowed:i.a.AmpNotValidated}function l(e,t){return e.toLowerCase()==t.toLowerCase()}n.d(t,"a",(function(){return u}))},6652:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var a=n(1902),r=n(3);const o=Object(r.mutatorAction)("addLoadingProjectionMutatorId",(function(e){const{loadingProjectionIds:t}=Object(a.b)();t.push(e)})),i=Object(r.mutatorAction)("removeLoadingProjectionMutatorId",(function(e){const{loadingProjectionIds:t}=Object(a.b)();t.remove(e)}))},6653:function(e,t,n){"use strict";function a(e){var t;return(null===(t=e.From)||void 0===t?void 0:t.Mailbox)?e.From.Mailbox.EmailAddress:null}n.d(t,"a",(function(){return a}))},6654:function(e,t,n){"use strict";var a=n(3);const r=Object(a.createStore)("ampstore",{allowedSenders:[]});t.a=r()},6816:function(e,t,n){"use strict";var a={TabViewAddTab:{name:"TabViewAddTab",customData:(e,t,n,a)=>[e,t,n]},TabViewCloseTab:{name:"TabViewCloseTab",customData:(e,t)=>[e.type,1==e.state||2==e.state,2==e.state,t,e.startTime?(new Date).getTime()-e.startTime:0]}},r=n(3254),o=n(71),i=n(3),c=n(967),s=n(263);t.a=Object(o.r)(a.TabViewCloseTab,(async function(e,t){let n=!0;const a=Object(c.a)(e.type);if(!t&&a&&a.canClose&&(n=await a.canClose(e)),n){Object(r.a)(e,!1);const t=Object(s.a)().tabs.indexOf(e);t>=0&&u(t)}}));const u=Object(i.mutatorAction)("spliceTabs",e=>{Object(s.a)().tabs.splice(e,1)})},6818:function(e,t,n){"use strict";var a=n(5287),r=n(7);var o=n(3244),i=n(1678);n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return u}));const c="x-ms-exchange-organization-ome-messagestate",s="sentitems";function u(e){if((null==e?void 0:e.ParentFolderId)&&e.ParentFolderId.Id!==Object(i.a)(s))return null;return function(e){if(e){let t={permissions:a.b.None,revoked:!1,expired:!1,revocationDate:null,revokedBy:null,responseState:a.a.None};try{const n=JSON.parse(e);if(1==n.Permissions&&(t.permissions=a.b.Revocable),2==n.Permissions&&(t.permissions=a.b.Expirable),t.revoked=n.IsRevoked,t.expired=n.IsExpired,n.RevocationDate){const e=Object(r.Vb)("UTC",n.RevocationDate);t.revocationDate=new Date(Object(r.Cb)(e))}t.revokedBy=n.RevokedBy}catch(e){return null}return t}return null}(Object(o.a)(e,null,c))}},6907:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("initializeExtendedCardForConversationReadingPane",(e,t)=>({conversationViewState:e,loadedItemParts:t}))},6908:function(e,t,n){"use strict";var a=n(3);t.a=Object(a.action)("tryInitializeShouldShowCLPLabel",e=>({conversationViewState:e}))},6909:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(7457);function r(e,t){const n=t?t.Value:"",r=Object(a.a)(e);return r||n}},7355:function(e,t,n){"use strict";var a=n(7362),r=n(6907),o=n(5284),i=n(4960),c=n(3824),s=n(4539),u=n(3291),l=n(71),d=n(702),b=n(1693),m=n(2481),f=n(5031),v=n(4254);const g=5,p=3;var h=Object(d.action)("markConversationCollapsedItemsRollUp")((function(e,t,n){Object(f.b)(e,v.a.CalendarCard)?function(e,t){const{length:n}=t,a=[],r=Object(u.a)()?0:n-1,o=Object(u.a)()?1:-1;for(let e=r;e<=n-1&&e>=0&&!t[e].isExpanded;e+=o)O(t[e])&&a.push(t[e].conversationNodeId);a.length>1&&(e.conversationNodeIdsInCollapsedItemsRollUp=a)}(e,t):function(e,t,n){const{length:a}=t;if(a<g)return;const r=[];let o=Object(u.a)()?1:a-2;const i=Object(u.a)()?1:-1;n&&(o-=i);for(let e=o;e<=a-1&&e>=0&&!t[e].isExpanded;e+=i)r.push(t[e].conversationNodeId);if(r.length>=p){if(r.pop(),e.conversationNodeIdsInCollapsedItemsRollUp=r,!n){const n=Object(u.a)()?0:a-1;e.nodeIdBundledWithSeeMoreMessages=t[n].conversationNodeId}Object(l.o)("RPCountRenderCollItemsRollUp",[Object(c.b)(Object(s.a)(e))])}}(e,t,n)}));function O(e){let t=b.a.items.get(e.itemId);return!(!t||!Object(m.b)(t))&&t.IsOutOfDate}var j=n(7455),I=n(6908),w=n(4670),S=n(2111),P=n(6909),C=n(1675);var x=n(6);var y=n(5286),M=n(3293),A=n(3457),R=n(2013);function E(e,t,n,a){const c=[],{itemPartsMap:s,itemIdToScrollTo:u}=t;let l=null;if(e.conversationNodeIds){e.conversationNodeIds.forEach(t=>{let[n]=Object(i.a)({mailboxInfo:e.conversationId.mailboxInfo,Id:t});n&&s.set(t,n)}),Object(A.a)()&&Object(I.a)(t),Object(j.a)(s,n,e.conversationNodeIds,!1);let d=!1;e.conversationNodeIds.forEach(e=>{const t=s.get(e);if(t&&!t.isInRollUp){c.push(t);const e=a.get(t.itemId);(function(e){const t=Object(C.I)();if(null==t?void 0:t.highlightTerms){const n=Object(P.a)(e.RightsManagementLicenseData,e.UniqueBody),a=document.createElement("div");return a.innerHTML=n,t.highlightTerms.some((function(e){return a.innerText.toLowerCase().indexOf(e)>=0}))}return!1})(e)&&(t.isExpanded=!0),d=d||t.isExpanded&&!e.IsDraft}});const g="ChronologicalNewestOnBottom"==e.conversationSortOrder;if(function(e,t,n,a){const r=n.length;if(0==r||t)return;let o=null;const i=e?r-1:0;let c=i;const s=e?-1:1,u=e=>{const t=a.get(e);return Object(R.a)(t)[1]};for(;c>=0&&c<r;){const e=n[c],t=e.oofRollUpViewState.oofReplyNodeIds.some(u);if(!e.isExpanded&&(e.isLocal||t)){o=e;break}c+=s}o||(o=n[i]),o.isExpanded=!0,o.isFossilizedTextExpanded=!0}(g,d,c,n),l=function(e,t){const n=e.length;for(let a=0;a<n;a++){const n=e[a],r=n.itemId;if(t){if(r==t)return n.isExpanded=!0,{itemPart:n,focusedItemArea:w.a.Item}}else{if(n.isExpanded)return{itemPart:n,focusedItemArea:w.a.Item};if(n.oofRollUpViewState.isOofRollUpExpanded)return{itemPart:n,focusedItemArea:w.a.Oof}}}return null}(c,u),c.forEach(e=>{e.isExpanded&&Object(o.a)(e)}),Object(r.a)(t,c),Object(f.b)(t,v.a.CalendarCard)&&function(e){var t;const n=e.length;if(0!=n)for(let a=0;a<n;a++){const n=e[a],r=n?n.itemId:null,o=b.a.items.get(r),i=Object(C.I)();if(o&&Object(m.b)(o)&&(null==i||!i.highlightTerms))if(o.IsRead||o.IsOutOfDate)n.isExpanded=!1,n.isFossilizedTextExpanded=!1;else if(Object(m.f)(o.ItemClass)){const e=o;"NewMeetingRequest"==e.MeetingRequestType&&!Object(x.k)(e.Preview)||(null===(t=e.ChangeHighlights)||void 0===t?void 0:t.HasBodyChanged)?n.isExpanded=!0:(n.isExpanded=!1,n.isFossilizedTextExpanded=!1)}else!Object(m.g)(o.ItemClass)&&!Object(m.a)(o.ItemClass)||Object(x.k)(o.Preview)?(n.isExpanded=!1,n.isFossilizedTextExpanded=!1):n.isExpanded=!0}}(c),c.length){const n=g?0:e.conversationNodeIds.length-1,a=e.conversationNodeIds[n],r=s.has(a);e.canLoadMore&&(t.nodeIdBundledWithSeeMoreMessages=a),Object(M.a)(t.conversationId.Id)||h(t,c,e.canLoadMore&&!r)}}return l}t.a=Object(d.action)("firstLoadConversationReadingPane")((function(e,t={loadedConversation:b.a.conversations.get(e),conversationNodes:b.a.conversationNodes,conversationReadingPaneState:Object(S.a)(e),items:b.a.items}){if(t.conversationReadingPaneState.conversationId.Id!=e)return;const n=t.conversationReadingPaneState;if(n.loadingState.isLoading=!1,n.loadingState.hasLoadFailed=t.loadedConversation.loadingState.hasLoadFailed,!n.loadingState.hasLoadFailed){const r=Object(y.c)(e);if(n.unsupportedItemId=r,!r){const e=E(t.loadedConversation,n,t.conversationNodes,t.items);n.initiallySelectedItemPart=n.focusedItemPart=e,Object(a.a)(n,!0)}}}))},7362:function(e,t,n){"use strict";var a=n(5997),r=n(1693);var o=n(1982),i=n(47);function c(e,t){const n=Object(o.a)(e.conversationId.Id);if(null==n?void 0:n.hasSharepointLink)return!0;if(e.itemPartsMap.size>0){if(function(e){if(!e)return!1;const t=r.a.conversations.get(e.conversationId.Id);return null==t?void 0:t.canLoadMore}(e))return!0;const n=[...e.itemPartsMap.keys()];for(let a=0;a<n.length;a++){const r=e.itemPartsMap.get(n[a]);if(!r)continue;const o=t.get(r.itemId);if(o&&(o.Attachments||Object(i.j)("doc-linkDiscovery-useNewProperty")&&o.HasProcessedSharepointLink))return!0}}return!1}var s=n(3291),u=n(2108),l=n(2388),d=n(3);async function b(e,t){const n=Object(r.b)().items;if(c(e,n)){if(!(null==e?void 0:e.attachmentWell)){const[t,n,a]=await l.c.importAndExecute(e.conversationId),r=await u.l.import();m(e,r(n,a)),await u.o.importAndExecute(t,e.conversationId.mailboxInfo,e.attachmentWell,!0,!1)}const r=[...e.itemPartsMap.keys()];for(let o=0;o<r.length;o++){const i=e.itemPartsMap.get(r[o]);if(!i)continue;const c=n.get(i.itemId);c&&(await Object(a.a)(i,c,t),await u.p.importAndExecute(i.attachmentWell,e.attachmentWell,Object.assign(Object.assign({},c.ItemId),{mailboxInfo:c.MailboxInfo}),c.DateTimeReceived))}await u.s.importAndExecute(e.attachmentWell,Object(s.a)())}}n.d(t,"a",(function(){return b}));const m=Object(d.mutatorAction)("setAttachmentWellForConversation",(e,t)=>{e.attachmentWell=t})},7455:function(e,t,n){"use strict";var a=n(7456),r=n(702);t.a=Object(r.action)("tryAddOofNodesInRollUp")((function(e,t,n,r){r&&e.forEach(e=>{e.oofRollUpViewState.oofReplyNodeIds=[]}),n.forEach(n=>{const r=e.get(n);if(!r||!r.oofRollUpViewState.isOofItem)return;r.isInRollUp=!1;const o=Object(a.a)(n,e,t);o&&!o.isInRollUp&&(r.isInRollUp=!0,o.oofRollUpViewState.oofReplyNodeIds.push(n))})}))},7456:function(e,t,n){"use strict";function a(e,t,n){const a=n.get(e);return a?t.get(a.parentInternetMessageId):null}n.d(t,"a",(function(){return a}))},7457:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(7885),r=n(6);function o(e){let t;if((null==e?void 0:e.RightsManagedMessageDecryptionStatus)&&0!=e.RightsManagedMessageDecryptionStatus)switch(e.RightsManagedMessageDecryptionStatus){case-2147160052:case-2147160012:case-2147160011:t=Object(r.c)(Object(r.b)(a.d),i());break;case-2147160010:t=Object(r.b)(a.a);break;case-2147168507:t=Object(r.c)(Object(r.b)(a.l),i());break;case-2147160014:t=Object(r.b)(a.j);break;case-2147160054:case-2147160055:t=Object(r.b)(a.h);break;case-2147160064:case-2147160013:t=Object(r.b)(a.g);break;case-2147160051:t=Object(r.b)(a.c);break;case-2147160060:t=Object(r.b)(a.k);break;case-2147160009:default:t=Object(r.c)(Object(r.b)(a.i),e.RightsManagedMessageDecryptionStatus)}return t}function i(){const e=Object(r.c)('<a href="{0}" target="_blank">{1}</a>',Object(r.b)(a.f),Object(r.b)(a.e));return Object(r.c)(Object(r.b)(a.b),e)}},7885:function(e){e.exports=JSON.parse('{"d":"fab","a":"gab","l":"hab","j":"iab","h":"jab","g":"kab","c":"lab","k":"mab","i":"nab","f":"oab","e":"pab","b":"qab"}')},8245:function(e){e.exports=JSON.parse('{"a":"N9b"}')},9282:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(1902);function r(e){return Object(a.b)().loadedItemReadingPaneViewStates.has(e)}},9807:function(e){e.exports=JSON.parse('{"b":"vwc","a":"wwc"}')}}]);
//# sourceMappingURL=owa.427.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.427.js'] = 1;