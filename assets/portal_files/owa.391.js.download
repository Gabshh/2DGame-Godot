(window.$wj=window.$wj||[]).push([[391,98,149],{1015:function(e,n,t){"use strict";var a;t.d(n,"a",(function(){return a})),function(e){e[e.Add=0]="Add",e[e.Init=1]="Init"}(a||(a={}))},1020:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"GetUserUnifiedGroupsRequest:#Exchange"},e)}t.d(n,"a",(function(){return a}))},1021:function(e,n,t){"use strict";var a=t(35);function r(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetUserUnifiedGroupsJsonRequest:#Exchange"},t)),Object(a.a)("GetUserUnifiedGroups",e,n)}t.d(n,"a",(function(){return r}))},1040:function(e,n,t){"use strict";var a=t(145),r=t(248),i=t(36);function o(e,n){let t,o={},c={},d={};return e.forEach(e=>{const n=Object(a.r)(e.calendarGroupId.mailboxInfo.userIdentity,e.serverGroupId);d[n]=e,e.Calendars.forEach(e=>{if(function(e,n){if(Object(r.l)(e)){let t=e;if(t.IsOwnerEmailAddressInvalid)return i.h.info(`[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: ${t.OwnerEmailAddress}`),!1;let a=t.IsGeneralScheduleCalendar?t.OwnerEmailAddress:t.SharedFolderId?t.SharedFolderId.Id:null;if(!a)return i.h.info(`[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: ${e.calendarId.id}`),!1;if(n.includes(a))return i.h.info(`[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: ${a}`),!1;if(n.push(a),t.OwnerEmailAddress=t.OwnerEmailAddress.toLowerCase(),t.IsGroupMailboxCalendar)return!1}return!0}(e,[e.calendarId.mailboxInfo.userIdentity])){let n=e.calendarId.id,a=Object(r.j)(e).Id;e.IsDefaultCalendar&&(t=e),!o[n]&&(o[n]=e),!c[a]&&(c[a]=e.calendarId)}})}),{defaultCalendar:t,calendarEntryMapping:o,folderIdMapping:c,calendarGroupMapping:d}}const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CalendarGroups"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarGroups"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarGroupId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"serverGroupId"}},{kind:"Field",name:{kind:"Name",value:"GroupName"}},{kind:"Field",name:{kind:"Name",value:"GroupType"}},{kind:"Field",name:{kind:"Name",value:"DisplayOrder"}},{kind:"Field",name:{kind:"Name",value:"Calendars"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarEntry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"CalendarName"}},{kind:"Field",name:{kind:"Name",value:"CalendarFolderType"}},{kind:"Field",name:{kind:"Name",value:"CanShare"}},{kind:"Field",name:{kind:"Name",value:"HexColor"}},{kind:"Field",name:{kind:"Name",value:"HexColorString"}},{kind:"Field",name:{kind:"Name",value:"IsTallyingResponses"}},{kind:"Field",name:{kind:"Name",value:"ParentGroupId"}},{kind:"Field",name:{kind:"Name",value:"AllowedOnlineMeetingProviders"}},{kind:"Field",name:{kind:"Name",value:"CanEnableChangeNotifications"}},{kind:"Field",name:{kind:"Name",value:"ChangeNotificationStatus"}},{kind:"Field",name:{kind:"Name",value:"DefaultOnlineMeetingProvider"}},{kind:"Field",name:{kind:"Name",value:"EffectiveRights"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateContents"}},{kind:"Field",name:{kind:"Name",value:"Read"}},{kind:"Field",name:{kind:"Name",value:"ViewPrivateItems"}}]}},{kind:"Field",name:{kind:"Name",value:"FolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"ProviderId"}},{kind:"Field",name:{kind:"Name",value:"SourceId"}},{kind:"Field",name:{kind:"Name",value:"CalendarColor"}},{kind:"Field",name:{kind:"Name",value:"IsGroupMailboxCalendar"}},{kind:"Field",name:{kind:"Name",value:"AgendaMailDisabled"}},{kind:"Field",name:{kind:"Name",value:"CharmId"}},{kind:"Field",name:{kind:"Name",value:"DisplayOrder"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LocalCalendarEntry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CanViewPrivateItems"}},{kind:"Field",name:{kind:"Name",value:"IsDefaultCalendar"}},{kind:"Field",name:{kind:"Name",value:"IsReadOnly"}},{kind:"Field",name:{kind:"Name",value:"IsRemovable"}},{kind:"Field",name:{kind:"Name",value:"SharedOwnerEmailAddress"}},{kind:"Field",name:{kind:"Name",value:"SharedOwnerName"}},{kind:"Field",name:{kind:"Name",value:"IsSchoolCalendar"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LocalCacheForRemoteCalendarEntry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwnerEmailAddress"}},{kind:"Field",name:{kind:"Name",value:"OwnerName"}},{kind:"Field",name:{kind:"Name",value:"IsGeneralScheduleCalendar"}},{kind:"Field",name:{kind:"Name",value:"IsOwnerEmailAddressInvalid"}},{kind:"Field",name:{kind:"Name",value:"SharedFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"RemoteCategories"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"MasterList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Color"}},{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"LastTimeUsed"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"SharedOwnerMailboxGuid"}},{kind:"Field",name:{kind:"Name",value:"IsDefaultCalendar"}},{kind:"Field",name:{kind:"Name",value:"IsReadOnly"}},{kind:"Field",name:{kind:"Name",value:"IsSharedWithMe"}},{kind:"Field",name:{kind:"Name",value:"CanViewPrivateItems"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LinkedCalendarEntry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwnerEmailAddress"}},{kind:"Field",name:{kind:"Name",value:"OwnerName"}},{kind:"Field",name:{kind:"Name",value:"IsGeneralScheduleCalendar"}},{kind:"Field",name:{kind:"Name",value:"IsOwnerEmailAddressInvalid"}},{kind:"Field",name:{kind:"Name",value:"SharedFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"RemoteCategories"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"MasterList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Color"}},{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"LastTimeUsed"}}]}}]}}]}}]}}]}}]}}]};var d=t(705),l=t(1098),s=t(225),u=t(57),f=t(132),m=t(1112);async function b(e){if(!Object(f.a)("calendarFoldersFromSessionData")&&(!e||Object(u.s)(e))){const n=Object(l.a)();if(n)return Promise.resolve(Object(m.a)(n,Object(s.d)(e)))}return v.invokeCalendarGroupsQuery({mailboxInfo:Object(s.d)(e)})}const v={invokeCalendarGroupsQuery:async function(e){var n;const t=Object(d.a)(),a=await t.query({variables:e,query:c});return null===(n=null==a?void 0:a.data)||void 0===n?void 0:n.calendarGroups}};var p=t(3);const O=Object(p.action)("calendarFolderIdUpdated");var I=t(611);const j={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"SharedCalendarAdditionalInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"calculatedFolderId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MailboxInfoInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isGroupCalendar"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sharedCalendarAdditionalInfo"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"calculatedFolderId"},value:{kind:"Variable",name:{kind:"Name",value:"calculatedFolderId"}}},{kind:"ObjectField",name:{kind:"Name",value:"mailboxInfo"},value:{kind:"Variable",name:{kind:"Name",value:"mailboxInfo"}}},{kind:"ObjectField",name:{kind:"Name",value:"isGroupCalendar"},value:{kind:"Variable",name:{kind:"Name",value:"isGroupCalendar"}}}]}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarFolder"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"folderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ChangeKey"}}]}},{kind:"Field",name:{kind:"Name",value:"distinguishedFolderId"}},{kind:"Field",name:{kind:"Name",value:"effectiveRights"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateContents"}},{kind:"Field",name:{kind:"Name",value:"Read"}},{kind:"Field",name:{kind:"Name",value:"ViewPrivateItems"}}]}},{kind:"Field",name:{kind:"Name",value:"charmId"}},{kind:"Field",name:{kind:"Name",value:"remoteCategories"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"MasterList"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Color"}},{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"LastTimeUsed"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"defaultOnlineMeetingProvider"}},{kind:"Field",name:{kind:"Name",value:"allowedOnlineMeetingProviders"}},{kind:"Field",name:{kind:"Name",value:"replicaList"}}]}}]}}]}}]};var k=t(71);const y=Object(p.action)("setCalendarLoadState",(e,n)=>({calendarId:e,loadState:n}));async function g(e){y(e,"Loading"),await async function(e){const n=Object(a.l)(e);if(!n)throw new Error(`Unable to get calendar entry for calendar ${e}`);const t=Object(a.A)(e),i=Object(a.i)(e),o=Object(a.v)(t),c=o?o.mailboxInfo:Object(s.d)(),l=Object(a.R)(n);let f,m,b,v=Object(a.t)().filter(e=>e.serverGroupId==n.ParentGroupId);b=v?v[0].calendarGroupId.mailboxInfo.userIdentity:Object(s.d)().userIdentity;if(5==n.CalendarFolderType&&Object(u.g)().SessionSettings.DefaultPublicFolderMailbox)f=Object(u.g)().SessionSettings.DefaultPublicFolderMailbox;else{const e=function(e,n){return e||(n?n.userIdentity:null)}(n.OwnerEmailAddress,c);f=l?Object(r.i)(e):e}try{m=await async function(e,n,t){var r;let i,o={type:"GroupMailbox",userIdentity:t,mailboxSmtpAddress:n},c=Object(a.n)(e.Id);i=c&&(c.IsGeneralScheduleCalendar||c.IsGroupMailboxCalendar)?"calendar":5==c.CalendarFolderType?c.SharedFolderId.Id:e.Id;const l=Object(d.a)(),s=await l.query({variables:{calculatedFolderId:i,mailboxInfo:o,isGroupCalendar:c.IsGroupMailboxCalendar},query:j});return null===(r=null==s?void 0:s.data)||void 0===r?void 0:r.sharedCalendarAdditionalInfo}(Object(I.a)({Id:i}),f,b)}catch(e){return Object(k.o)("getCalendarFolderConfigurationServiceFailed"),void Object(a.V)(n)}m&&(Object(a.V)(n),5==n.CalendarFolderType?function(e,n){var t,r;const i=e.calendarFolder;if(i){const e=i.replicaList[0],c=(o=e,{type:"PublicMailbox",userIdentity:Object(s.d)().userIdentity,mailboxSmtpAddress:o}),d=Object(a.x)(n.calendarId.id);Object(a.Y)(n.calendarId.id,c.userIdentity,!0);const l=Object.assign(Object.assign({},n),{calendarId:{id:n.calendarId.id,changeKey:n.calendarId.changeKey,mailboxInfo:c},EffectiveRights:null!==(t=i.effectiveRights)&&void 0!==t?t:n.EffectiveRights,CharmId:null!==(r=i.charmId)&&void 0!==r?r:n.CharmId,FolderId:n.FolderId||i.folderId});Object(a.b)(l,d)}var o}(m,n):function(e,n,t,r,i){var o,c,d,l,s,u,f;const m=e.calendarFolder;if(m&&(i&&(null===(o=null==m?void 0:m.folderId)||void 0===o?void 0:o.Id)&&(m.folderId.Id=Object(a.U)(m.folderId.Id,r)),(null===(c=null==m?void 0:m.effectiveRights)||void 0===c?void 0:c.Read)&&(m.remoteCategories&&(n.RemoteCategories=m.remoteCategories),r==n.OwnerEmailAddress||n.calendarId&&r==n.calendarId.id))){const e=Object(a.x)(r);Object(a.Y)(r,t.userIdentity,!0);const i=Object.assign(Object.assign({},n),{EffectiveRights:null!==(d=m.effectiveRights)&&void 0!==d?d:n.EffectiveRights,FolderId:null!==(l=m.folderId)&&void 0!==l?l:n.FolderId,CharmId:null!==(s=m.charmId)&&void 0!==s?s:n.CharmId,DefaultOnlineMeetingProvider:null!==(u=m.defaultOnlineMeetingProvider)&&void 0!==u?u:n.DefaultOnlineMeetingProvider,AllowedOnlineMeetingProviders:null!==(f=m.allowedOnlineMeetingProviders)&&void 0!==f?f:n.AllowedOnlineMeetingProviders});Object(a.b)(i,e)}}(m,n,c,e,l),O())}(e)}var h=t(287);async function S(e){try{const t=await b(e),r=o(t);let i=(n=t.length)<1?{lowerBoundResultSize:null,upperBoundResultSize:0}:n<=3?{lowerBoundResultSize:1,upperBoundResultSize:3}:n<=6?{lowerBoundResultSize:4,upperBoundResultSize:6}:{lowerBoundResultSize:7,upperBoundResultSize:null};Object(k.o)("CalendarGroupsPerAccount",{connectedAccount_1:Object(h.r)(e),calendarGroupCount:t.length,calendarGroupCount_2:`${i.lowerBoundResultSize} - ${i.upperBoundResultSize}`}),Object(a.H)(r.defaultCalendar,r.calendarEntryMapping,r.calendarGroupMapping,r.folderIdMapping)}catch(e){throw Object(i.d)(e),e}var n}var E=t(16);const _=Object(p.createStore)("OwaCalendarsApiStore",{calendarIdsLoadState:new E.ObservableMap});function F(e){return _().calendarIdsLoadState.get(e)}Object(p.mutator)(y,e=>{const{calendarId:n,loadState:t}=e;_().calendarIdsLoadState.set(n,t)}),Object(p.mutator)(a.Y,e=>{const{calendarId:n,shouldPersistCalendarEntry:t}=e;t||_().calendarIdsLoadState.delete(n)}),t.d(n,"b",(function(){return o})),t.d(n,"e",(function(){return b})),t.d(n,"c",(function(){return g})),t.d(n,"f",(function(){return S})),t.d(n,"a",(function(){return O})),t.d(n,"d",(function(){return F}))},1055:function(e,n,t){"use strict";var a=t(0),r=t(8),i=t(325);n.a="CalendarLtrRegular";const o=Object(i.a)({Svg:e=>a.createElement("svg",Object.assign({},e,{viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"}),a.createElement("path",{d:"M5.25 9a.75.75 0 100-1.5.75.75 0 000 1.5zM6 10.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zM8 9a.75.75 0 100-1.5A.75.75 0 008 9zm.75 1.75a.75.75 0 11-1.5 0 .75.75 0 011.5 0zm2-1.75a.75.75 0 100-1.5.75.75 0 000 1.5zM14 4.5A2.5 2.5 0 0011.5 2h-7A2.5 2.5 0 002 4.5v7A2.5 2.5 0 004.5 14h7a2.5 2.5 0 002.5-2.5v-7zM3 6h10v5.5c0 .83-.67 1.5-1.5 1.5h-7A1.5 1.5 0 013 11.5V6zm1.5-3h7c.83 0 1.5.67 1.5 1.5V5H3v-.5C3 3.67 3.67 3 4.5 3z"})),displayName:"CalendarLtrRegular"});Object(r.registerIcons)({icons:{CalendarLtrRegular:a.createElement(o,null)}})},1059:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"EmailAddress:#Exchange"},e)}t.d(n,"a",(function(){return a}))},1060:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"MailboxData:#Exchange"},e)}t.d(n,"a",(function(){return a}))},1062:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"Duration:#Exchange"},e)}t.d(n,"a",(function(){return a}))},1063:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"FreeBusyViewOptions:#Exchange"},e)}t.d(n,"a",(function(){return a}))},1064:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"GetUserAvailabilityRequest:#Exchange"},e)}t.d(n,"a",(function(){return a}))},1067:function(e,n,t){"use strict";var a=t(35);function r(e,n){var t;return void 0===e.request||e.request.__type||(e.request=(t=e.request,Object.assign({__type:"GetUserAvailabilityInternalJsonRequest:#Exchange"},t))),Object(a.a)("GetUserAvailabilityInternal",e,n)}t.d(n,"a",(function(){return r}))},108:function(e,n,t){"use strict";var a=t(81);let r={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn15Mins:9e5,MillisecondsIn20Mins:12e5,MillisecondsIn22Mins:132e4,MillisecondsIn24Mins:144e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,HoursInOneDay:24,DaysInOneWeek:7,AllDaysOfWeek:[a.c.Sunday,a.c.Monday,a.c.Tuesday,a.c.Wednesday,a.c.Thursday,a.c.Friday,a.c.Saturday]};n.a=r},1091:function(e,n,t){"use strict";var a=t(3),r=Object(a.createStore)("calendarAccountInitializationStateStore",{isAllCalendarAccountsAndCacheLoaded:!1});const i=Object(a.action)("allCalendarAccountsAndCacheLoaded",(e,n)=>({isSuccess:e,userIdentity:n})),o=Object(a.action)("removedConnectedAccountIdCleanup");function c(){return r().isAllCalendarAccountsAndCacheLoaded}Object(a.mutator)(i,e=>{e.isSuccess&&(r().isAllCalendarAccountsAndCacheLoaded=!0)}),t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return o})),t.d(n,"b",(function(){return c}))},1094:function(e,n,t){"use strict";t.d(n,"c",(function(){return i})),t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return c}));var a=t(20);const r=new a.c(()=>Promise.all([t.e(1),t.e(2),t.e(3),t.e(19),t.e(522)]).then(t.bind(null,1608))),i=new a.a(r,e=>e.initializeSelectedTeamsCalendars),o=new a.a(r,e=>e.getSelectedTeamsCalendars),c=new a.a(r,e=>e.createCalendarCacheInfoFromTeamsChannel)},1096:function(e,n,t){"use strict";var a=t(71),r=t(145);const i="Groups";var o=t(225),c=t(261),d=t(704),l=t(1021),s=t(1020),u=t(1099),f=t(6);async function m(e){const n=await async function(e){let n=[];n.push({FilterType:1,SortType:4,SortDirection:"Descending"}),n.push({FilterType:2,SortType:4,SortDirection:"Descending"});const t=Object(c.b)();t.RequestServerVersion="V2018_01_08";const a=Object(d.a)(Object(o.d)(e));return await Object(l.a)({Header:t,Body:Object(s.a)({RequestedGroupsSets:n})},a)}(e);return null!=n&&n.Body.GroupsSets&&n.Body.GroupsSets.length>0?function(e,n){const t=[],a=Object(r.r)(n,i);if(e.forEach(e=>{e.Groups.forEach(e=>{var r;let i=e.SmtpAddress.toLowerCase(),o={calendarId:{id:i,mailboxInfo:{type:"GroupMailbox",userIdentity:n,mailboxSmtpAddress:i}},CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:i,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ParentGroupId:a,CanShare:!1,__typename:"LinkedCalendarEntry"};t.push({entry:o,groupMailboxGuid:null===(r=e.MailboxGuid)||void 0===r?void 0:r.toLowerCase()})})}),t.length>0){const e={calendarGroupId:{id:a,mailboxInfo:{type:"GroupMailbox",userIdentity:n,mailboxSmtpAddress:n}},serverGroupId:a,GroupName:Object(f.b)(u.a),GroupType:3};return{groupCalendars:t,calendarGroup:e}}return null}(n.Body.GroupsSets,e):null}var b=t(248);var v=t(296);async function p(e){const n=await m(e),t=Object(v.a)(e)?function(e){var n;let t=Object(r.k)().filter(e=>Object(b.m)(e));if(0==t.length)return e;const a=[];for(let r=0;r<(null===(n=null==e?void 0:e.groupCalendars)||void 0===n?void 0:n.length);r++){const n=e.groupCalendars[r];t.some(e=>{var t,a;const r=e;return(null===(t=r.OwnerEmailAddress)||void 0===t?void 0:t.toLowerCase())===n.entry.calendarId.mailboxInfo.mailboxSmtpAddress&&(null===(a=r.SharedOwnerMailboxGuid)||void 0===a?void 0:a.toLowerCase())===n.groupMailboxGuid})||a.push(n)}return(null==a?void 0:a.length)>0?{groupCalendars:a,calendarGroup:e.calendarGroup}:null}(n):n;return null!=t&&null!=t.groupCalendars?(t.groupCalendars.forEach(e=>{Object(r.b)(e.entry)}),Object(r.a)(t.calendarGroup),{group:t.calendarGroup}):null}var O=t(57);async function I(e,n){var t;const c=new a.b("initializeGroupCalendars");e||(e=Object(o.d)().userIdentity);const d=!!(null===(t=Object(O.h)(e))||void 0===t?void 0:t.GroupsEnabled),l=Object(r.r)(e,i),s=!Object(r.t)().some(n=>n.serverGroupId===l&&n.calendarGroupId.mailboxInfo.userIdentity===e),u=d&&(n||s);c.addCustomData({issueServiceCall:u,GroupsEnabled:d,featureEnabled:!0,refresh:n,initialLoad:s});try{u&&await p(e),c.end()}catch(e){throw c.endWithError("ServerError",Error(e)),e}}t.d(n,"b",(function(){return I})),t.d(n,"a",(function(){return i}))},1098:function(e,n,t){"use strict";let a;function r(e){return a=null==e?void 0:e.getCalendarFolders,e}function i(){let e=a;return a=void 0,e}t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}))},1099:function(e){e.exports=JSON.parse('{"a":"XNa"}')},1112:function(e,n,t){"use strict";var a=t(579);const r="LocalCalendarEntry:#Exchange",i="LinkedCalendarEntry:#Exchange";function o(e,n){return e.CalendarGroups?e.CalendarGroups.map(t=>(function(e,n,t){var o;const d=null===(o=e.Calendars)||void 0===o?void 0:o.reduce((e,o)=>{var d;const l=function(e){var n,t;if(void 0!==e.CalendarFolderId)return null===(n=e.CalendarFolderId)||void 0===n?void 0:n.Id;const a=e;return a.IsGeneralScheduleCalendar?a.OwnerEmailAddress:null===(t=a.SharedFolderId)||void 0===t?void 0:t.Id}(o),s=l?null===(d=null==n?void 0:n.filter(e=>{var n;return(null===(n=e.FolderId)||void 0===n?void 0:n.Id)==l}))||void 0===d?void 0:d[0]:void 0;return function(e){return 7!==e.CalendarFolderType}(o)&&e.push(function(e,n,t){var o,d;const l={calendarId:{id:e.ItemId.Id,changeKey:e.ItemId.ChangeKey,mailboxInfo:t},CalendarName:1==e.CalendarFolderType&&n?null!==(o=n.DisplayName)&&void 0!==o?o:"":null!==(d=e.CalendarName)&&void 0!==d?d:"",CalendarFolderType:e.CalendarFolderType&&c(e.CalendarFolderType),CanShare:e.CanShare,HexColor:e.HexColor,HexColorString:e.HexColorString,IsTallyingResponses:e.IsTallyingResponses,ParentGroupId:e.ParentGroupId,CanEnableChangeNotifications:null==n?void 0:n.CanEnableChangeNotifications,ChangeNotificationStatus:null==n?void 0:n.ChangeNotificationStatus,EffectiveRights:(null==n?void 0:n.EffectiveRights)?Object(a.a)({ViewPrivateItems:n.EffectiveRights.ViewPrivateItems,Read:n.EffectiveRights.Read,CreateContents:n.EffectiveRights.CreateContents},"CalendarEffectiveRightsType"):void 0,FolderId:(null==n?void 0:n.FolderId)?Object(a.a)(n.FolderId,"FolderId"):void 0,ProviderId:null==n?void 0:n.ProviderId,SourceId:null==n?void 0:n.SourceId,CalendarColor:e.CalendarColor,IsGroupMailboxCalendar:e.IsGroupMailboxCalendar,AgendaMailDisabled:null==n?void 0:n.AgendaMailDisabled,CharmId:null==n?void 0:n.CharmId,DisplayOrder:e.DisplayOrder};if(e.__type==r){const n=e;return Object.assign(Object.assign({},l),{CanViewPrivateItems:n.CanViewPrivateItems,IsDefaultCalendar:n.IsDefaultCalendar,IsReadOnly:n.IsReadOnly,IsRemovable:n.IsRemovable,IsSharedWithMe:n.IsSharedWithMe,SharedOwnerEmailAddress:n.SharedOwnerEmailAddress,SharedOwnerName:n.SharedOwnerName,IsSchoolCalendar:n.IsSchoolCalendar,DefaultOnlineMeetingProvider:n.DefaultOnlineMeetingProvider,AllowedOnlineMeetingProviders:n.AllowedOnlineMeetingProviders,__typename:"LocalCalendarEntry"})}if(e.__type==i){const t=e;return Object.assign(Object.assign({},l),{OwnerEmailAddress:t.OwnerEmailAddress,OwnerName:t.OwnerName,IsGeneralScheduleCalendar:t.IsGeneralScheduleCalendar,IsOwnerEmailAddressInvalid:t.IsOwnerEmailAddressInvalid,SharedFolderId:t.SharedFolderId?Object(a.a)(t.SharedFolderId,"FolderId"):void 0,DefaultOnlineMeetingProvider:null==n?void 0:n.DefaultOnlineMeetingProvider,AllowedOnlineMeetingProviders:null==n?void 0:n.AllowedOnlineMeetingProviders,__typename:"LinkedCalendarEntry"})}{const n=e;return Object.assign(Object.assign({},l),{CanViewPrivateItems:n.CanViewPrivateItems,OwnerEmailAddress:n.OwnerEmailAddress,OwnerName:n.OwnerName,IsDefaultCalendar:n.IsDefaultCalendar,IsReadOnly:n.IsReadOnly,IsSharedWithMe:n.IsSharedWithMe,IsGeneralScheduleCalendar:n.IsGeneralScheduleCalendar,IsOwnerEmailAddressInvalid:n.IsOwnerEmailAddressInvalid,SharedFolderId:n.SharedFolderId,RemoteCategories:n.RemoteCategories?Object(a.a)(n.RemoteCategories,"MasterCategoryList",e=>Object.assign(Object.assign({},e),{MasterList:Object(a.b)(e.MasterList,"Category")})):void 0,SharedOwnerMailboxGuid:n.SharedOwnerMailboxGuid,DefaultOnlineMeetingProvider:n.DefaultOnlineMeetingProvider,AllowedOnlineMeetingProviders:n.AllowedOnlineMeetingProviders,__typename:"LocalCacheForRemoteCalendarEntry"})}}(o,s,t)),e},[]);return{calendarGroupId:{id:e.ItemId.Id,changeKey:e.ItemId.ChangeKey,mailboxInfo:t},serverGroupId:e.GroupId,GroupName:e.GroupName,GroupType:e.GroupType,DisplayOrder:e.DisplayOrder,Calendars:d,__typename:"CalendarGroup"}})(t,e.CalendarFolders,n)):[]}function c(e){if(7!==e&&6!==e)return e}t.d(n,"a",(function(){return o}))},11900:function(e){e.exports=JSON.parse('{"a":"Grc","d":"Hrc","c":"Irc","g":"Jrc","f":"Krc","b":"Lrc","e":"Mrc"}')},13040:function(e,n,t){"use strict";t.r(n);var a=t(3),r=t(6568),i=t(2070),o=t(1718);const c=Object(o.f)("UpNextMailCalendarCacheId");function d(){return c.getLockId()}var l=t(3787);function s(){const e=Object(r.b)();"DoesNotExist"!==Object(i.e)(d())&&Object(l.g)(e,d())}Object(a.orchestrator)(r.d,s);var u=t(843);function f(){const e=Object(r.b)();Object(l.d)(e,d())}Object(a.orchestrator)(u.c,s);var m=t(11900),b=t(23),v=t(334),p=t(0),O=t(131),I=t(47),j=t(1055),k=t(13491),y=t.n(k),g=t(166);const h=t.n(g).a.bind(y.a);var S=Object(b.a)((function(e){const n=Object(I.j)("mon-densities");return p.createElement("div",{className:y.a.upNextEventContainer},e.eventCountString&&p.createElement("div",{className:y.a.conflictingEventsCount},e.eventCountString),p.createElement(v.a,{className:h(y.a.eventIconColumn,!n&&y.a.eventIconColumnSize),iconName:n?j.a:"Event"}),p.createElement("div",{className:h(y.a.eventDetailsColumn,n&&Object(O.e)())},p.createElement("div",{className:y.a.eventName},e.eventName),p.createElement("div",{className:y.a.eventTimeLocationRow},p.createElement("div",{className:y.a.eventTime},e.timeUntilEvent),e.eventLocation&&p.createElement("div",{className:y.a.eventLocation},e.eventLocation))))})),E=t(15586),_=t(6),F=t(22),N=t(7),C=t(561),A=t(1690);const w=59*F.g;function T(e,n){const t=Object(A.h)();if(Object(C.u)(t,e.Start,e.End))return n?Object(_.b)(m.c)+",":Object(_.b)(m.c);const a=Object(N.qc)(e.Start),r=Math.abs(Object(N.Cb)(t)-Object(N.Cb)(a));if(r<=w){const e=Math.ceil(r/F.g);return Object(_.c)(Object(_.b)(E.a),e)}const i=Object(N.Lb)(t,a),o=Object(N.ab)(a);return i?o:Object(_.c)(Object(_.b)(m.f),o)}var R=t(1909);var x=t(1576),P=t(71),D=t(4168),M=t(2492),L=t(610),z=t(2280);const B="UpNext";function U(e,n,t,a,r,i){e.push(p.createElement(S,{key:n,eventCountString:r,eventLocation:a,eventName:t,timeUntilEvent:i}))}var V=Object(b.a)((function(e){var n;let t;const a=e.upNextEvent,r=a.ItemId,i=e.conflictingEvents.length+1,o=i>1,c=[a,...e.conflictingEvents],d=!o&&r,l=p.useCallback(()=>{Object(M.b)()?function(e){Object(P.o)("TnS_UpNextClicked"),e?D.f.importAndExecute(B,e):D.i.importAndExecute(B)}(d):function(e){e?Object(z.c)({itemId:e,entrySource:"Mail_UpNext"}):window.open(Object(L.e)())}(d)},[d]),s=p.useCallback(()=>{const e=c.length;t=setTimeout(()=>{t&&Object(P.o)("TnS_UpNextHover",[e]),t=null},300)},[d]),u=p.useCallback(()=>{t=null},[d]);p.useEffect(()=>{Object(P.o)("TnS_UpNext",[c.length],{sessionSampleRate:10})},[d]);const f=[],b=i>3,v=b?2:c.length;for(let e=0;e<v;e++){const t=c[e],a=null===(n=t.Location)||void 0===n?void 0:n.DisplayName,r=o&&Object(_.c)(Object(_.b)(m.a),e+1,i),d=T(t,!!a);U(f,t.ItemId.Id,Object(R.c)(t),a,r,d)}if(b){const e=i-v;U(f,"viewAll",Object(_.b)(m.g),null,Object(_.c)(Object(_.b)(m.d),e),T(a,!1))}let O=y.a.allEventsContainer;2==i?O=y.a.allEventsContainerTwoEvents:i>2&&(O=y.a.allEventsContainerThreeOrMoreEvents);const j=o?void 0:Object(R.e)(a),k=o?function(e,n,t){let a=[];a.push(Object(_.c)(Object(_.b)(m.b),n));for(let t=0;t<e.length;t++){const r=e[t];a.push(Object(_.c)(Object(_.b)(m.e),t+1,n)),a.push(Object(R.a)(r))}return t&&a.push(Object(_.b)(m.g)),a.join(" ")}(c.slice(0,v),c.length,b):Object(R.a)(a),g=Object(I.j)("mon-ribbon-keytips")?{content:"TU",keySequences:["TU".toLocaleLowerCase()],onExecute:()=>{l()}}:void 0;return p.createElement(x.a,{ariaLabel:k,className:y.a.upNextEventButtonContainer,"data-is-focusable":!0,"data-automation-id":"UpNext",onClick:l,role:"menuitem",title:j,keytipProps:g,styles:e.containerStyle},p.createElement("div",{className:O,onMouseEnter:s,onMouseLeave:u},f))}));var G=Object(b.a)((function(e){const n="DoesNotExist"!==Object(i.e)(d())?Object(l.c)(d()):null;if(!n||!n.upNextEvent)return null;const t=n.conflictingEvents;return p.createElement(V,{upNextEvent:n.upNextEvent,conflictingEvents:t,containerStyle:e.containerStyle})}));function K(){return!!Object(l.b)(d())}t.d(n,"initializeUpNextV2",(function(){return f})),t.d(n,"UpNextV2",(function(){return G})),t.d(n,"isUpNextEventReady",(function(){return K}))},13491:function(e,n,t){var a=t(15585);"string"==typeof a&&(a=[[e.i,a,""]]);var r={transform:void 0};t(77)(a,r);a.locals&&(e.exports=a.locals)},15585:function(e,n,t){(n=e.exports=t(76)(!1)).push([e.i,"@-webkit-keyframes _2tmpo6E5bUVyMxF7zmPzw3{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes Je_Z4rp4aa5KxuX6X45W0{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _2tmpo6E5bUVyMxF7zmPzw3{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes Je_Z4rp4aa5KxuX6X45W0{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _2jTIZQ_CA8nZJrs4-m823D{to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes _9dzh9iZvr0pMD_DBiXD1S{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes _2jTIZQ_CA8nZJrs4-m823D{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes _9dzh9iZvr0pMD_DBiXD1S{to{-webkit-transform:translateY(0);transform:translateY(0)}}.ZpCO7KxbcXTccY0TYq8Zu{font-size:12px;font-weight:400;color:var(--themeDark);cursor:pointer;height:34px;overflow:hidden}html[dir] .ZpCO7KxbcXTccY0TYq8Zu{padding:0 8px}._1NN5vFNWCN1bT0mfs2pNvn,.kB9Hxr3RXAvHKSW2mRd3n,._2nr5GnbiLpPMWlywkqRsEp{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start;height:34px}._2nr5GnbiLpPMWlywkqRsEp{height:68px}html[dir] ._2nr5GnbiLpPMWlywkqRsEp{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1),-webkit-transform .3s cubic-bezier(.8,0,.2,1)}.kB9Hxr3RXAvHKSW2mRd3n{height:102px;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-play-state:running;animation-play-state:running;-webkit-animation-timing-function:cubic-bezier(.8,0,.2,1);animation-timing-function:cubic-bezier(.8,0,.2,1)}html[dir=ltr] .kB9Hxr3RXAvHKSW2mRd3n{-webkit-animation-name:_9dzh9iZvr0pMD_DBiXD1S;animation-name:_9dzh9iZvr0pMD_DBiXD1S}html[dir=rtl] .kB9Hxr3RXAvHKSW2mRd3n{-webkit-animation-name:_2jTIZQ_CA8nZJrs4-m823D;animation-name:_2jTIZQ_CA8nZJrs4-m823D}html[dir] .ZpCO7KxbcXTccY0TYq8Zu:hover ._2nr5GnbiLpPMWlywkqRsEp{-webkit-transform:translateY(-34px);transform:translateY(-34px);-webkit-transition-delay:.1s;transition-delay:.1s}.ZpCO7KxbcXTccY0TYq8Zu:hover .kB9Hxr3RXAvHKSW2mRd3n{-webkit-animation-duration:3.6s;animation-duration:3.6s}html[dir=ltr] .ZpCO7KxbcXTccY0TYq8Zu:hover .kB9Hxr3RXAvHKSW2mRd3n{-webkit-animation-name:Je_Z4rp4aa5KxuX6X45W0;animation-name:Je_Z4rp4aa5KxuX6X45W0}html[dir=rtl] .ZpCO7KxbcXTccY0TYq8Zu:hover .kB9Hxr3RXAvHKSW2mRd3n{-webkit-animation-name:_2tmpo6E5bUVyMxF7zmPzw3;animation-name:_2tmpo6E5bUVyMxF7zmPzw3}._1VwuywmxEjKCLdIqMRcw4V{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;-ms-flex-item-align:end;align-self:flex-end;height:34px}.DjH5rJAAmOUf9EpHzpaK4{font-size:14px;font-weight:400;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;line-height:34px}html[dir=ltr] .DjH5rJAAmOUf9EpHzpaK4{padding-right:6px}html[dir=rtl] .DjH5rJAAmOUf9EpHzpaK4{padding-left:6px}._2kusJAx2UfZhAueTG3CDGf{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir=ltr] ._2kusJAx2UfZhAueTG3CDGf{padding-right:8px}html[dir=rtl] ._2kusJAx2UfZhAueTG3CDGf{padding-left:8px}._1tK2rcFBk58ZkSGaByt7Oy{font-size:16px}._2YF9Z4Fbx8fL9kFzMlEexZ,._2TO7mo_elFt4kBADyZUQ_1,._2VjfS9B6ewXCJDzjfqvTCn,.o40L8oRgZTR6lIdDxpAcj{overflow:hidden;word-break:break-all}html[dir] ._2YF9Z4Fbx8fL9kFzMlEexZ,html[dir] ._2TO7mo_elFt4kBADyZUQ_1,html[dir] ._2VjfS9B6ewXCJDzjfqvTCn,html[dir] .o40L8oRgZTR6lIdDxpAcj{text-align:start}._1Cfs-zyIWAeqbdGQ1TZ9q-{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start}._1Cfs-zyIWAeqbdGQ1TZ9q-._2dhzDvwRRq7Tzrne1Z3Pa9,._1Cfs-zyIWAeqbdGQ1TZ9q-.ucKkEZLxAZhwocpgbUI8X{font-size:11px}._2VjfS9B6ewXCJDzjfqvTCn{font-weight:600;height:16px}._2VjfS9B6ewXCJDzjfqvTCn,._1kX7j8wrWpMsWfmJRuNZRU{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;max-width:162px}._1kX7j8wrWpMsWfmJRuNZRU{display:-webkit-box;display:-ms-flexbox;display:flex}.o40L8oRgZTR6lIdDxpAcj{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;max-width:162px}html[dir=ltr] .o40L8oRgZTR6lIdDxpAcj{margin-right:4px}html[dir=rtl] .o40L8oRgZTR6lIdDxpAcj{margin-left:4px}._2TO7mo_elFt4kBADyZUQ_1{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}",""]),n.locals={upNextEventButtonContainer:"ZpCO7KxbcXTccY0TYq8Zu",allEventsContainer:"_1NN5vFNWCN1bT0mfs2pNvn",allEventsContainerThreeOrMoreEvents:"kB9Hxr3RXAvHKSW2mRd3n",allEventsContainerTwoEvents:"_2nr5GnbiLpPMWlywkqRsEp",reverseMotion:"_9dzh9iZvr0pMD_DBiXD1S","reverseMotion-rtl":"_2jTIZQ_CA8nZJrs4-m823D",motionForThreeOrMore:"Je_Z4rp4aa5KxuX6X45W0","motionForThreeOrMore-rtl":"_2tmpo6E5bUVyMxF7zmPzw3",upNextEventContainer:"_1VwuywmxEjKCLdIqMRcw4V",conflictingEventsCount:"DjH5rJAAmOUf9EpHzpaK4",eventIconColumn:"_2kusJAx2UfZhAueTG3CDGf",eventIconColumnSize:"_1tK2rcFBk58ZkSGaByt7Oy",eventEntities:"_2YF9Z4Fbx8fL9kFzMlEexZ",eventLocation:"_2TO7mo_elFt4kBADyZUQ_1",eventName:"_2VjfS9B6ewXCJDzjfqvTCn",eventTime:"o40L8oRgZTR6lIdDxpAcj",eventDetailsColumn:"_1Cfs-zyIWAeqbdGQ1TZ9q-",compact:"_2dhzDvwRRq7Tzrne1Z3Pa9",medium:"ucKkEZLxAZhwocpgbUI8X",eventTimeLocationRow:"_1kX7j8wrWpMsWfmJRuNZRU"}},15586:function(e){e.exports=JSON.parse('{"a":"Nrc"}')},1695:function(e,n,t){"use strict";var a=t(2732),r=t(145),i=t(1790),o=t(248);function c(e){return!!e.EffectiveRights&&!!e.EffectiveRights.Modify&&!Object(r.P)(e.ParentFolderId.Id)&&!Object(i.c)(e)&&("Private"!==e.Sensitivity||function(e){const n=Object(r.n)(e);return Object(o.h)(n)}(e.ParentFolderId.Id))}var d=e=>Z(e)&&c(e)&&!e.IsCancelled,l=e=>{var n;return(null===(n=null==e?void 0:e.ParentFolderId)||void 0===n?void 0:n.mailboxInfo)&&"GroupMailbox"==e.ParentFolderId.mailboxInfo.type};function s(e,n){if(!e)return!1;let t=!l(e);const a=n=>n?t?n.filter(n=>!e.Organizer||n.Mailbox.EmailAddress!=e.Organizer.Mailbox.EmailAddress):n:[],r=a(e.RequiredAttendees).length,i=a(e.OptionalAttendees).length;return n?r+i>0:r+i+a(e.Resources).length>0}function u(e){const n=e.RequiredAttendees,t=e.OptionalAttendees;return n&&0!=n.length||t&&0!=t.length}function f(e){return!!e&&(e.IsDraft?s(e):e.IsMeeting||s(e))}var m=e=>!f(e)&&!e.IsOrganizer&&c(e)&&!e.IsCancelled,b=e=>!(!e.IsOrganizer||f(e)&&e.MeetingRequestWasSent||!c(e)),v=t(57),p=t(1781);function O(e){const n=Object(r.n)(e.ParentFolderId.Id),t=Object(p.e)(e);return c(e)&&f(e)&&!!n&&!!t&&!(3===n.CalendarFolderType||t.IsMeetingPollEvent)}function I(e){return e.DoNotForwardMeeting&&!e.IsOrganizer}function j(e){return!!(e.IsOrganizer&&e.IsMeeting&&e.MeetingRequestWasSent&&c(e))}const k=e=>b(e)||d(e)||m(e);function y(e){return!l(e)&&!e.IsOrganizer&&e.IsMeeting&&!e.IsCancelled&&c(e)}function g(e){return 0==Object(v.g)().SessionSettings.WebSessionType&&y(e)&&e.IsResponseRequested&&!e.IsAllDayEvent&&(!e.IsRecurring||E(e))}function h(e){return!e.IsOrganizer&&e.IsCancelled&&c(e)}function S(e){return!Object(a.a)(e.EntityNamesMap)&&e.IsOrganizer&&c(e)}function E(e){return e.IsRecurring&&"RecurringMaster"!==e.CalendarItemType&&"ThisAndFollowingInstancesMaster"!==e.CalendarItemType}function _(e){return"RecurringMaster"===e.CalendarItemType}function F(e){return"ThisAndFollowingInstancesMaster"===e.CalendarItemType}function N(e){return l(e)&&!e.IsCancelled&&!e.DoNotForwardMeeting}function C(e){if(e){const n=Object(r.n)(e.ParentFolderId.Id);if(n)return n.IsSharedWithMe||Object(o.l)(n)}return!1}var A=t(47);function w(e){return!!l(e)||(!C(e)||Object(A.j)("cal-mf-enableFTDFOnSharedCalendar"))}var T=e=>Object(i.c)(e)||c(e);function R(e){var n;return!!(null===(n=e.EffectiveRights)||void 0===n?void 0:n.Read)}var x=t(326);function P(e){return e&&R(e)&&D(e.ItemId)}function D(e){return(null==e?void 0:e.Id)&&!Object(x.b)(e.Id)}var M=t(287);function L(e){return e.IsMeeting&&!Object(M.r)(e.ParentFolderId.mailboxInfo.userIdentity)}var z=t(1935);function B(e,n){var t,a;return!(n&&n.length>0)||(e.Subject&&-1!=e.Subject.toLowerCase().indexOf(n.toLowerCase())||(null===(t=e.Location)||void 0===t?void 0:t.DisplayName)&&-1!=Object(z.d)(e.Location.DisplayName,e.Location.PostalAddress).toLowerCase().indexOf(n.toLowerCase())||(null===(a=e.Organizer)||void 0===a?void 0:a.Mailbox)&&-1!=e.Organizer.Mailbox.Name.toLowerCase().indexOf(n.toLowerCase()))}var U=e=>{if(!e)return!1;let n=e.ParentFolderId.mailboxInfo.mailboxSmtpAddress;return V(e.RequiredAttendees,n)||V(e.OptionalAttendees,n)};function V(e,n){return e&&e.some(e=>e.Mailbox.EmailAddress.toLowerCase()==n)}var G=t(991);function K(e){if(!e)return!1;let n=!1;return e.forEach(e=>{Object(G.a)(e.Mailbox)||(n=!0)}),n}function q(e){if(!e)return!1;const n=Object(r.n)(e.ParentFolderId.Id);return n&&3==n.CalendarFolderType}function W(e){return"Exception"===e}function H(e){return"Occurrence"===e}function $(e){return H(e.CalendarItemType)||W(e.CalendarItemType)}function Z(e){return(null==e?void 0:e.IsMeeting)&&!e.IsOrganizer}function J(e){return(null==e?void 0:e.IsMeeting)&&(null==e?void 0:e.IsOrganizer)}function Y(e){return Object(i.c)(e)&&f(e)}var X=t(7);function Q(e,n){return e&&n&&!Object(i.c)(e)&&Object(X.Kb)(n.Start,e.Start)&&Object(X.Kb)(n.End,e.End)&&n.IsAllDayEvent==e.IsAllDayEvent}function ee(e){return"RecurringMaster"===e}function ne(e){return!(!e.ItemId||!e.IsDraft||function(e){return!!(e.ItemId&&e.IsDraft&&e.IsMeeting&&e.IsOrganizer)}(e))}var te=(e,n)=>b(e)||d(e)&&n||q(e)||m(e);t.d(n,"g",(function(){return O})),t.d(n,"A",(function(){return I})),t.d(n,"c",(function(){return j})),t.d(n,"d",(function(){return k})),t.d(n,"n",(function(){return y})),t.d(n,"k",(function(){return g})),t.d(n,"l",(function(){return h})),t.d(n,"e",(function(){return S})),t.d(n,"K",(function(){return E})),t.d(n,"L",(function(){return _})),t.d(n,"z",(function(){return F})),t.d(n,"b",(function(){return N})),t.d(n,"a",(function(){return w})),t.d(n,"f",(function(){return T})),t.d(n,"h",(function(){return c})),t.d(n,"i",(function(){return P})),t.d(n,"j",(function(){return D})),t.d(n,"m",(function(){return L})),t.d(n,"p",(function(){return B})),t.d(n,"q",(function(){return s})),t.d(n,"u",(function(){return u})),t.d(n,"r",(function(){return U})),t.d(n,"s",(function(){return K})),t.d(n,"t",(function(){return R})),t.d(n,"v",(function(){return q})),t.d(n,"w",(function(){return f})),t.d(n,"x",(function(){return $})),t.d(n,"y",(function(){return W})),t.d(n,"B",(function(){return Z})),t.d(n,"C",(function(){return C})),t.d(n,"D",(function(){return J})),t.d(n,"E",(function(){return Y})),t.d(n,"G",(function(){return H})),t.d(n,"H",(function(){return l})),t.d(n,"I",(function(){return Q})),t.d(n,"J",(function(){return ee})),t.d(n,"F",(function(){return ne})),t.d(n,"o",(function(){return te}))},1714:function(e,n,t){"use strict";t.d(n,"g",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"e",(function(){return d})),t.d(n,"c",(function(){return l})),t.d(n,"b",(function(){return s})),t.d(n,"f",(function(){return u})),t.d(n,"a",(function(){return f})),t.d(n,"i",(function(){return m})),t.d(n,"h",(function(){return b}));var a=t(1812),r=t(561),i=t(1814);function o(e,n){const t=Object(a.a)().calendarFolderEvents.get(n);return t?t.locksInfo.get(e):null}function c(e){const n=u(e);return n?[...n.locksInfo.entries()].reduce(Object(i.c)(),[]):[]}function d(e){const n=u(e);return n?[...n.locksInfo.entries()].reduce(Object(i.d)(),{}):{}}function l(e,n){const t=u(e);return t?[...t.locksInfo.entries()].reduce(Object(i.e)(Object(i.m)(n)),[]):[]}function s(){return[...Object(a.a)().calendarFolderEvents.keys()]}function u(e){return Object(a.a)().calendarFolderEvents.get(e)||null}function f(e){const n=u(e);return(null==n?void 0:n.events)?[...n.events.values()]:[]}function m(e){return!!u(e)}function b(e){const n=c(e);return n&&n.length>0?n.sort((e,n)=>{const t=Object(r.l)(e),a=Object(r.l)(n);return t>a?-1:t<a?1:0})[0]:null}},1715:function(e,n,t){"use strict";t.d(n,"d",(function(){return l})),t.d(n,"c",(function(){return s})),t.d(n,"b",(function(){return u})),t.d(n,"e",(function(){return f})),t.d(n,"a",(function(){return m})),t.d(n,"f",(function(){return b})),t.d(n,"j",(function(){return v})),t.d(n,"g",(function(){return p})),t.d(n,"i",(function(){return O})),t.d(n,"h",(function(){return I}));var a=t(2227),r=t(2364),i=t(2365),o=t(6),c=t(80),d=t(3);const l=Object(d.action)("calendarEventsRemoved",e=>({eventsRemoved:e})),s=Object(d.action)("calendarEventsAdded",e=>({eventsAdded:e})),u=Object(d.action)("calendarEventUpdated",e=>({eventUpdated:e})),f=Object(d.action)("calendarEventsRemovedMatchedFilter",e=>({removePredicate:e})),m=Object(d.action)("cacheReloaded",(e,n)=>({previousEvents:e,reloadedEvents:n})),b=Object(d.action)("deleteEventsCache",e=>({folderId:e})),v=Object(d.action)("loadingCalendarEvents",(e,n,t)=>Object(c.b)({name:"CalendarLoadState",customData:{loadingState:t},options:{isVerbose:!0}},{lockId:e,calendarId:n,loadingState:t})),p=Object(d.action)("instantCalendarEventCreate",(e,n,t,a=(()=>{}),i,c=Object(o.b)(r.a),d=(()=>{}))=>({eventToCreate:e,actionToExecute:n,onEventCreatedSuccess:t,onEventCreatedFailed:a,actionSource:i,errorMessage:c,onEventCreatedLocally:d})),O=Object(d.action)("instantCalendarEventUpdate",(e,n,t,r,i,c=(()=>{}),d,l=Object(o.b)(a.a),s=(()=>{}))=>({eventId:e,eventChanges:n,eventScope:t,actionToExecute:r,onEventUpdateSuccess:i,onEventUpdateFailed:c,actionSource:d,errorMessage:l,onEventUpdatedLocally:s})),I=Object(d.action)("instantCalendarEventDelete",(e,n,t,a,r,c=(()=>{}),d,l=Object(o.b)(i.a),s=!1,u=(()=>Promise.resolve(!1)))=>({eventId:e,eventScope:n,dataPoint:t,actionToExecute:a,onEventDeleteSuccess:r,onEventDeleteFailed:c,actionSource:d,errorMessage:l,responseSent:s,asyncUndoAction:u}))},1716:function(e,n,t){"use strict";var a=t(3),r=t(1715);function i(e,n){let t=null;return j(e,n,e=>{t=e}),t&&(t.forEach(n=>m(e,n.Key)),Object(r.d)(t)),t}t.d(n,"d",(function(){return o})),t.d(n,"e",(function(){return c})),t.d(n,"g",(function(){return d})),t.d(n,"f",(function(){return l})),t.d(n,"u",(function(){return s})),t.d(n,"t",(function(){return u})),t.d(n,"m",(function(){return f})),t.d(n,"s",(function(){return m})),t.d(n,"p",(function(){return b})),t.d(n,"w",(function(){return v})),t.d(n,"a",(function(){return p})),t.d(n,"q",(function(){return O})),t.d(n,"k",(function(){return I})),t.d(n,"l",(function(){return j})),t.d(n,"n",(function(){return k})),t.d(n,"o",(function(){return y})),t.d(n,"c",(function(){return g})),t.d(n,"b",(function(){return h})),t.d(n,"i",(function(){return S})),t.d(n,"j",(function(){return E})),t.d(n,"h",(function(){return _})),t.d(n,"v",(function(){return F})),t.d(n,"r",(function(){return i}));const o=Object(a.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK",(e,n,t,a,r)=>({lockId:e,folderId:n,eventKey:t,itemResponseShapeType:a,partialCalendarEvent:r})),c=Object(a.action)("CALENDAR_EVENTS_FETCHING_FULL_CALENDAR_EVENT_FOR_LOCK_FAILED",(e,n,t,a,r)=>({lockId:e,folderId:n,eventKey:t,eventId:a,itemResponseShapeType:r})),d=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED_FOR_LOCK",(e,n,t,a,r,i,o)=>({lockId:e,folderId:n,eventKey:t,itemResponseShapeType:a,event:r,hasEventChanged:i,forceOverrideAllPropertiesForEventIfAvailable:o})),l=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_LOADED",(e,n,t,a)=>({folderId:e,eventKey:n,itemResponseShapeType:t,event:a})),s=Object(a.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_SERVER",e=>({partialCalendarEvent:e})),u=Object(a.action)("CALENDAR_EVENTS_UPDATE_FULL_CALENDAR_EVENT_FROM_PARTIAL_CALENDAR_EVENT",e=>({partialCalendarEvent:e})),f=Object(a.action)("CALENDAR_EVENT_MERGE_EVENTS_INTO_CACHE",e=>({events:e})),m=Object(a.action)("CALENDAR_EVENTS_REMOVE_FULL_CALENDAR_EVENT",(e,n)=>({folderId:e,eventKey:n})),b=Object(a.action)("CALENDAR_EVENTS_REMOVE_ALL_FULL_CALENDAR_EVENTS_INFO_FOR_CACHE",e=>({folderId:e})),v=Object(a.action)("ADD_CALENDAR_EVENTS_TO_EVENTS_CACHE",(e,n,t,a=!1)=>({folderId:e,calendarEvents:n,dateRanges:t,forceReplace:a})),p=Object(a.action)("ADD_CALENDAR_EVENTS_WITHING_CURRENT_LOCKED_DATE_RANGES",(e,n)=>({folderId:e,calendarEvents:n})),O=Object(a.action)("REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(e,n)=>({folderId:e,instanceKey:n})),I=Object(a.action)("INTERNAL_REMOVE_CALENDAR_EVENT_WITH_INSTANCE_KEY_FROM_EVENTS_CACHE",(e,n,t)=>({folderId:e,instanceKey:n,onEventsRemoved:t})),j=Object(a.action)("INTERNAL_REMOVE_CALENDAR_EVENTS_FROM_EVENTS_CACHE_MATCHING_FILTER",(e,n,t)=>({folderId:e,predicate:n,onEventsRemoved:t})),k=Object(a.action)("CALENDAR_EVENTS_RELEASE_LOCK",e=>({lockId:e})),y=Object(a.action)("RELEASE_LOCK",e=>({lockId:e})),g=Object(a.action)("CALENDAR_EVENTS_IN_EVENTS_CACHE_RELOADED",(e,n,t,a=!1)=>({folderId:e,eventsReloaded:n,dateRanges:t,forceReplace:a})),h=Object(a.action)("CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(e,n,t,a)=>({lockId:e,folderId:n,dateRange:t,calendarEvents:a})),S=Object(a.action)("INTERNAL_CALENDAR_EVENTS_IN_DATE_RANGE_LOADED_FOR_LOCK",(e,n,t,a)=>({lockId:e,folderId:n,dateRange:t,calendarEvents:a})),E=Object(a.action)("INTERNAL_DELETE_EVENTS_CACHE",e=>({folderId:e})),_=Object(a.action)("CALENDAR_EVENTS_FULL_CALENDAR_EVENT_WAS_USED",(e,n)=>({lockId:e,eventKey:n})),F=Object(a.action)("UpdateItem",(e,n)=>({existingItem:e,updatedItem:n}))},1718:function(e,n,t){"use strict";var a=t(1714),r=t(2430),i=t(3),o=t(1716),c=t(1715),d=t(1929);Object(i.orchestrator)(c.a,e=>{const{previousEvents:n,reloadedEvents:t}=e;t&&(n&&Object(c.d)(n),Object(c.c)(t))}),Object(i.orchestrator)(o.q,e=>{const{folderId:n,instanceKey:t}=e;let a=null;Object(o.k)(n,t,e=>{a=e}),a&&(a.forEach(e=>Object(o.s)(n,e.Key)),Object(c.d)(a))}),Object(i.orchestrator)(o.b,e=>{const{lockId:n,folderId:t,dateRange:a,calendarEvents:r}=e;Object(o.i)(n,t,a,r),r&&Object(c.c)(r)}),Object(i.orchestrator)(o.a,e=>{const{folderId:n,calendarEvents:t}=e,i=Object(a.d)(n),{eventsOverlapping:d}=Object(r.a)(t,i);d.length>0&&(Object(o.w)(n,d,i),Object(c.c)(d))}),Object(i.orchestrator)(o.c,e=>{const{folderId:n,eventsReloaded:t,dateRanges:i,forceReplace:d}=e,l=Object(a.a)(n),{eventsOverlapping:s}=Object(r.a)(l,i);Object(o.w)(n,t,i,d),Object(c.a)(s,t)}),Object(i.orchestrator)(c.f,e=>{const{folderId:n}=e;Object(d.e)(n),Object(o.p)(n),Object(o.j)(n)});var l=t(7),s=t(2733),u=t(561),f=t(2175),m=t(2205),b=t(307),v=t.n(b);function p(e,n){const t=function(e){return Object(f.d)(e)?O:Object(f.h)(e)?I:Object(f.e)(e)?j:(Object(f.i)(e),null)}(e.Recurrence);if(!t)return[Object.assign({},e)];const a=Object(m.a)(n),r=[];let i=e.Recurrence.RecurrencePattern.Interval;a.forEach(n=>{let a=function(e,n){let t=Object(l.bc)(e.Start),a=Object(s.a)(t.tz,e.Recurrence),r={start:t,end:a};return function(e,n){e.start=Object(l.p)(e.start,n.start)>0?e.start:n.start,e.end=null!=e.end&&Object(l.p)(e.end,n.end)<0?e.end:n.end}(r,n),r}(e,n),o=t(e,a,i);r.push(...o)});let o=Object(l.x)(e.Start,Object(l.bc)(e.Start)),c=Object(l.x)(e.End,Object(l.bc)(e.Start));return function(e,n,t,a){let r=[];return a.forEach(a=>{let i={};v()(i,e),i.Start=Object(l.h)(a,n),i.End=Object(l.h)(a,t),i.CalendarItemType="Occurrence",r.push(i)}),r}(e,o,c,r)}function O(e,n,t){let a=[],r=Object(l.s)(n.end,n.start);for(let e=0;e<=r;e+=t){let t=Object(l.e)(n.start,e);a.push(t)}return a}function I(e,n,t){let a=[],r=e.Recurrence.RecurrencePattern,i=r.DaysOfWeek.split(" ").map(e=>k(e)),o=Math.max(k(r.FirstDayOfWeek),0),c=n.start;for(;Object(l.p)(c,n.end)<=0;){let e=c,r=Object(l.C)(e,o);for(;Object(l.p)(e,r)<=0;)i.includes(Object(l.ob)(e))&&Object(u.t)(n,e)&&a.push(e),e=Object(l.e)(e,1);c=Object(l.fc)(Object(l.e)(c,7*t),o)}return a}function j(e,n,t){let a=[];if(Object(f.b)(e.Recurrence)){let r=e.Recurrence.RecurrencePattern.DayOfMonth,i=n.start;for(;Object(l.p)(i,n.end)<=0;){let e=i,o=Object(l.B)(e);for(;Object(l.p)(e,o)<=0;)Object(l.mb)(e)==r&&Object(u.t)(n,e)&&a.push(e),e=Object(l.e)(e,1);i=Object(l.ec)(Object(l.i)(i,t))}}else{let r=e.Recurrence.RecurrencePattern,i=k(r.DaysOfWeek),o=-1;switch(r.DayOfWeekIndex){case"First":o=1;break;case"Second":o=2;break;case"Third":o=3;break;case"Fourth":o=4}let c=n.start;for(;Object(l.p)(c,n.end)<=0;){let e;e=o>0?y(i,o,c):g(i,c),Object(u.t)(n,e)&&a.push(e),c=Object(l.ec)(Object(l.i)(c,t))}}return a}function k(e){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].indexOf(e)}function y(e,n,t){const a=Object(l.ec)(t),r=(e-Object(l.ob)(a)+7)%7+7*(n-1);return Object(l.e)(a,r)}function g(e,n){let t=y(e,5,n);return Object(l.Ab)(t)==Object(l.Ab)(n)?t:y(e,4,n)}var h=t(2206),S=t(1790);function E(e,n){if(n){const n=e.ParentFolderId.Id;e.Recurrence&&Object(o.r)(n,n=>n.InstanceKey==e.InstanceKey),Object(o.r)(n,n=>n.ItemId.Id===e.ItemId.Id)}}Object(i.orchestrator)(c.g,async e=>{const{eventToCreate:n,actionToExecute:t,actionSource:r,onEventCreatedFailed:i,onEventCreatedSuccess:d,errorMessage:l,onEventCreatedLocally:s}=e,u=function(e){return Object(a.i)(e.ParentFolderId.Id)}(n);!function(e,n,t,r,i){if(n){const n=e.ParentFolderId.Id;if(e.Recurrence){const t=Object(a.d)(n);let r=p(e,t);Object(S.a)(r,!1);let i=r.map(e=>Object.assign(Object.assign({},e),{CalendarItemType:"Occurrence"}));Object(o.a)(n,i)}Object(S.b)(e);const t=e.Recurrence?Object.assign(Object.assign({},e),{CalendarItemType:"RecurringMaster"}):e;Object(o.a)(n,[t])}t(r,i)}(n,u,s,n.IsDraft,r);let f=()=>Object(c.g)(n,t,()=>i(l,null,r),d,r,l),m=null;try{m=await t(n)}catch(e){throw E(n,u),i(e,f,r),e}let b=null;if(!m.isSuccessful)throw E(n,u),i(l,f,r),l;b=m.createdItem,function(e,n,t){n.ParentFolderId||(n.ParentFolderId=Object.assign({},e.ParentFolderId));if(t){const t=n.ParentFolderId.Id;Object(o.r)(t,n=>n.ItemId.Id===e.ItemId.Id),Object(h.a)(n,!0,!1)}}(n,b,u),d(b)});var _=t(1);function F(e,n){const t={Key:e,Start:n.Start,End:n.End};return v()(n,t),n}var N=t(1815),C=t(1736),A=t(1812);var w=t(1695),T=t(2033),R=t(1814),x=t(2034);function P(e){if(!e)return;const n=Object(A.a)();n.calendarFolderEvents.get(e)||n.calendarFolderEvents.set(e,Object(R.f)())}Object(i.mutator)(o.n,e=>{const{lockId:n}=e,t=Object(A.a)();[...t.calendarFolderEvents.keys()].forEach(e=>{t.calendarFolderEvents.get(e).locksInfo.get(n)&&Object(R.n)(n,t.calendarFolderEvents.get(e))}),t.fullItemsMruMap.delete(n)}),Object(i.mutator)(o.f,e=>{const{folderId:n,eventKey:t,event:a}=e,r=Object(C.d)(t,n);r&&Object(R.q)(r,a,!0)}),Object(i.mutator)(o.t,e=>{let{partialCalendarEvent:n}=e;!function(e){var n;if(function(e){const n=e;return!!n.Key&&void 0!==n.Start&&void 0!==n.End}(e)){const{Key:n}=e,t=Object(_.__rest)(e,["Key"]);e=t}const t=Object(x.a)(e),a=null===(n=e.ParentFolderId)||void 0===n?void 0:n.Id;if(a){const n=Object(C.d)(t,a);n&&Object(R.q)(n,e)}}(n)}),Object(i.mutator)(o.m,e=>{const{events:n}=e;n.forEach(e=>{const n=Object(C.b)(e.ItemId.Id);n&&(Object(w.u)(n)&&(delete e.RequiredAttendees,delete e.OptionalAttendees),Object(R.q)(n,e))})}),Object(i.mutator)(o.i,e=>{const{lockId:n,folderId:t,dateRange:r,calendarEvents:i}=e;P(t);const o=Object(a.f)(t),c=Object(N.a)(),d=i.filter(e=>!Object(w.J)(e.CalendarItemType)).map(e=>F(e.ItemId.Id,e)).filter(e=>!c[e.Key]);Object(R.b)(r,d,n,o);const{lockedDateRange:s}=o.locksInfo.get(n);if(Object(l.s)(s.end,s.start)>T.a){const e=function(e,n,t){const a=Object(l.s)(n.end,n.start);if(a===t)return n;if(a>t)return{start:n.start,end:Object(l.e)(n.start,t)};{let r=t-a;const i=Math.abs(Object(l.s)(n.end,e.end)),o=Math.abs(Object(l.s)(e.start,n.start));let{start:c,end:d}=n;if(i>0){const e=Math.min(r,i);d=Object(l.e)(d,e),r-=e}if(r>0&&o>0){const e=Math.min(r,o);c=Object(l.e)(c,-1*e)}return{start:c,end:d}}}(s,r,T.a);Object(R.h)(e,n,o)}}),Object(i.mutator)(o.k,e=>{const{folderId:n,instanceKey:t,onEventsRemoved:r}=e;P(n);const i=Object(a.f)(n);r(Object(R.o)(e=>e.InstanceKey===t,i))}),Object(i.mutator)(o.l,e=>{const{folderId:n,predicate:t,onEventsRemoved:r}=e;P(n);const i=Object(a.f)(n);r(Object(R.o)(t,i))}),Object(i.mutator)(o.j,e=>{const{folderId:n}=e;Object(A.a)().calendarFolderEvents.delete(n)}),Object(i.mutator)(o.w,e=>{const{folderId:n,calendarEvents:t,dateRanges:r,forceReplace:i}=e;P(n);const o=t.map(e=>F(e.ItemId.Id,e)),c=Object(a.f)(n);i?Object(R.p)(o,c,r):Object(R.r)(o,c.events)}),Object(i.mutator)(o.v,e=>{v()(e.existingItem,e.updatedItem)});var D=t(2471);const M=new Map;const L=5;function z(e,n,t,a){U(n,t);const{eventKey:r}=e,i=t.get(n),{eventInfos:o}=i,[c]=o.filter(e=>e.eventKey===r);if(c){V(i.eventInfos.indexOf(c),e,i)}else o.push(e),function(e,n){!function(e,n,t){for(;e.eventInfos.length>n&&0<e.eventInfos.length;)G(0,e,t)}(e,e.maxSize||L,n)}(i,a);[...t.keys()].forEach(n=>{const{eventInfos:a}=t.get(n);a.forEach(n=>{e.eventKey===n.eventKey&&(n.itemResponseShapeType=e.itemResponseShapeType)})})}function B(e,n,t,a=(()=>{})){U(n,t);const r=t.get(n),[i]=r.eventInfos.filter(n=>n.eventKey===e),o=r.eventInfos.indexOf(i);return-1!==o&&G(o,r,a),-1!==o}function U(e,n){if(!n.get(e)){const t=function(e){return M.get(e)}(e);n.set(e,{eventInfos:[],maxSize:t})}}function V(e,n,t){if(-1===e)throw new Error(`Item with eventKey ${n.eventKey} does not exist in the MRU`);t.eventInfos.splice(e,1),t.eventInfos.push(n)}function G(e,n,t){if(e<0||e>=n.eventInfos.length)throw new Error(`Invalid index to remove ${e}`);const a=n.eventInfos[e];n.eventInfos.splice(e,1),t(a.eventKey)}function K(e){if(!e)return;const n=Object(A.a)();n.calendarFolderEvents.get(e)||n.calendarFolderEvents.set(e,Object(R.f)())}function q(e,n){return t=>{Object(R.i)([t],e,Object(A.a)().calendarFolderEvents.get(n))}}Object(i.mutator)(o.d,e=>{const{eventKey:n,folderId:t,lockId:a,partialCalendarEvent:r,itemResponseShapeType:i}=e;K(t);const o=Object(A.a)();if(r){const e=F(n,r);Object(R.a)(e,a,o.calendarFolderEvents.get(t))}z({eventKey:n,eventId:r.ItemId,itemResponseShapeType:i,folderId:t,loadState:0},a,o.fullItemsMruMap,q(a,t))}),Object(i.mutator)(o.e,e=>{const{eventKey:n,eventId:t,folderId:a,lockId:r,itemResponseShapeType:i}=e;K(a),z({eventKey:n,eventId:t,itemResponseShapeType:i,folderId:a,loadState:2},r,Object(A.a)().fullItemsMruMap,q(r,a))}),Object(i.mutator)(o.g,e=>{const{lockId:n,eventKey:t,folderId:a,event:r,hasEventChanged:i,itemResponseShapeType:o,forceOverrideAllPropertiesForEventIfAvailable:c}=e;K(a);const d=Object(A.a)(),l=F(t,r);Object(R.a)(l,n,d.calendarFolderEvents.get(a),i,c),z({eventKey:t,eventId:r.ItemId,itemResponseShapeType:o,folderId:a,loadState:1},n,d.fullItemsMruMap,q(n,a))}),Object(i.mutator)(o.s,e=>{const{folderId:n,eventKey:t}=e,a=Object(A.a)();a.calendarFolderEvents.get(n)&&[...a.fullItemsMruMap.keys()].forEach(e=>{B(t,e,a.fullItemsMruMap)})}),Object(i.mutator)(o.p,e=>{const{folderId:n}=e,t=Object(A.a)(),a=t.calendarFolderEvents.get(n);if(a){const e=[...a.locksInfo.entries()].reduce(Object(R.d)(),{}),n=Object.keys(e);[...t.fullItemsMruMap.keys()].forEach(e=>{n.forEach(n=>B(n,e,t.fullItemsMruMap))})}}),Object(i.mutator)(D.a,()=>{const e=Object(A.a)();[...e.fullItemsMruMap.keys()].forEach(n=>{!function(e,n){U(e,n),n.get(e).eventInfos=[]}(n,e.fullItemsMruMap)})}),Object(i.mutator)(o.h,e=>{const n=Object(A.a)(),{lockId:t,eventKey:a}=e;!function(e,n,t){U(n,t);const a=t.get(n),{eventInfos:r}=a,[i]=r.filter(n=>n.eventKey===e);if(i){V(a.eventInfos.indexOf(i),i,a)}}(a,t,n.fullItemsMruMap)});var W=t(905),H=t(985);function $(e,n){var t;if(3==n){const n=Object(C.b)(e);t=(null==n?void 0:n.SeriesMasterItemId)?Object(W.a)({Id:n.SeriesMasterItemId.Id}):t=Object(H.a)({OccurrenceId:e})}else t=Object(W.a)({Id:e});return t}function Z(e,n,t){t&&(Object(o.w)(n,e,null,!1),Object(c.c)(e))}Object(i.orchestrator)(c.h,async e=>{const{eventId:n,eventScope:t,dataPoint:r,actionToExecute:i,onEventDeleteSuccess:d,onEventDeleteFailed:s,responseSent:u,actionSource:f,errorMessage:m,asyncUndoAction:b}=e,v=Object(C.b)(n.Id);let p=function(e){return e&&Object(a.i)(e.ParentFolderId.Id)}(v);const O=function(e,n,t){let a=[];if(t){const t=e.ParentFolderId.Id;if(3==n||2==n||Object(w.L)(e)){let r=e.Start;a=Object(o.r)(t,t=>t.InstanceKey==e.InstanceKey&&(3==n||Object(w.L)(e)||2==n&&!Object(l.Jb)(t.Start,r)))}else a=Object(o.r)(t,n=>n.ItemId.Id===e.ItemId.Id)}return a}(v,t,p);r&&r.markUserPerceivedTime();let I=$(n.Id,t),j=null;try{if(await b(v,u,f))return void Z(O,v.ParentFolderId.Id,p);if(j=await i(I),!j.isSuccessful)throw new Error(m)}catch(e){Z(O,v.ParentFolderId.Id,p);let a=()=>Object(c.h)(n,t,null,i,d,()=>s(e,null,f),f,m,u);throw s(e,a,f),e}d()});var J=t(2200);Object(i.orchestrator)(o.u,async e=>{const n=e.partialCalendarEvent,t=await async function(e){const n=e.ParentFolderId.Id;if(null!==Object(N.f)(e.ItemId.Id)){const t=Object(N.b)(e.ItemId.Id),{calendarEvent:a}=await Object(J.a)(e.ItemId,n,t);return a}return Promise.resolve(null)}(n);if(t){const e=Object(x.a)(n),a=n.ParentFolderId.Id,r=Object(N.b)(n.ItemId.Id);Object(o.f)(a,e,r,t)}});var Y=t(287);Object(i.orchestrator)(c.i,async e=>{var n;const{eventId:t,eventChanges:r,errorMessage:i,actionToExecute:d,onEventUpdateFailed:s,onEventUpdateSuccess:u,onEventUpdatedLocally:f,actionSource:m}=e;let b=e.eventScope,v=Object(C.b)(t.Id),O=$(t.Id,e.eventScope);v&&Object(w.J)(v.CalendarItemType)&&(b=3);let I=function(e,n){if(!e)return!1;let t=e.ParentFolderId.Id;if(!Object(a.i)(t))return!1;let r=n.ParentFolderId;if(r&&r.Id!=t)return!1;return!0}(v,r);I&&function(e,n,t,r,i){const d=e.ParentFolderId.Id;!Object(w.G)(e.CalendarItemType)||0!=t&&1!=t||(n.CalendarItemType="Exception");let s=Object.assign(Object.assign({},e),n);if(3==t||2==t)if(n.Recurrence||n.Start||n.StartTimeZoneId||n.End||n.EndTimeZoneId||2==t){let r=e.Start;if(Object(o.r)(d,n=>(Object(w.G)(n.CalendarItemType)||Object(w.y)(n.CalendarItemType))&&n.InstanceKey==e.InstanceKey&&(3==t||2==t&&!Object(l.Jb)(n.Start,r))),3===t||2===t){let r=Object(a.d)(d);2===t&&(r=r.map(e=>({start:Object(l.Vb)(e.start.tz,e.start),end:Object(l.Vb)(e.end.tz,e.end)})),function(e,n){let t=[];e.forEach((e,a)=>{Object(l.p)(e.start,n)<=0&&Object(l.p)(e.end,n)<=0&&t.push(a),Object(l.p)(e.start,n)<=0&&Object(l.p)(e.end,n)>0&&(e.start=Object(l.bc)(n))}),t.reverse().forEach(n=>{e.splice(n,1)})}(r,e.Start));let i=s;"Occurrence"!=s.CalendarItemType||s.Recurrence||(i=Object(C.b)(s.SeriesMasterItemId.Id),i||(i=s));let c=p(i,r);Object(S.a)(c.concat(s),!0),delete n.Start,delete n.End;let u=c.map(e=>Object.assign(Object.assign(Object.assign({},e),n),{CalendarItemType:"Occurrence"}));Object(o.a)(s.ParentFolderId.Id,u)}}else{let t=Object(C.a)(d,n=>n.InstanceKey==e.InstanceKey&&Object(w.G)(n.CalendarItemType));for(let e of t){let t=e;Object(o.v)(t,n),Object(c.b)(t)}}if(!Object(w.y)(e.CalendarItemType)||3!=t){let n=null==e.InstanceKey||Object(w.G)(e.CalendarItemType)||Object(w.y)(e.CalendarItemType);Object(h.a)(s,n,!0)}r(s,i)}(v,r,b,f,m);let j=()=>Object(c.i)(t,r,b,d,u,()=>s(i,null,m),m,i),k=null;try{k=await d(O)}catch(e){throw I&&Object(h.b)(v.ParentFolderId.Id),s(e,j,m),e}if(!k.isSuccessful)throw I&&Object(h.b)(v.ParentFolderId.Id),s(i,j,m),i;(null===(n=r.ParentFolderId)||void 0===n?void 0:n.mailboxInfo)&&Object(Y.r)(r.ParentFolderId.mailboxInfo.userIdentity)&&(Object(h.b)(r.ParentFolderId.Id,!0),Object(h.b)(v.ParentFolderId.Id,!0)),u()});var X=t(88),Q=t(2037);Object(i.orchestrator)(X.m,Q.a);var ee=t(145);Object(i.orchestrator)(ee.W,e=>{const{folderId:n}=e;Object(c.f)(n)});var ne=t(20);function te(e){let n=Object(ee.n)(e);return n?n.CharmId:null}function ae(e){return(null==e?void 0:e.CharmId)||te(e.ParentFolderId.Id)}var re=t(2215),ie=t(2217),oe=t(248);function ce(){Object(a.b)().map(e=>{Object(oe.n)(Object(ee.n)(e))&&Object(ie.a)(e,!0)})}const de=3e5;function le(e){e?Object(re.b)(ce,"RELOAD_LINKEDCALENDAR_ENTRIES",de):Object(re.a)("RELOAD_LINKEDCALENDAR_ENTRIES")}function se(e,n,t){let a=null;return a="Decline"===t?"Free":"Free"===e&&"Decline"!==n?"Free":"Accept"===t?"Busy":"Tentative",{FreeBusyType:a,AppointmentReplyTime:Object(l.Ub)(),ResponseType:t}}var ue=t(2216),fe=t(2449),me=t(2466),be=t(282),ve=t(71),pe=t(36),Oe=t(2563),Ie=t(16);const je={};function ke(e,n){return e+n}function ye(e,n){const t=ke(e,n);return je[t]||Promise.resolve({calendarEvent:null,error:"Could not find full event promise in existing promises"})}function ge(e,n,t=null,a={fetchSource:"unknown"},r){var i,o,c;const d=Se(t);r||(r=Object(N.b)(n.Id));const l=Object(N.e)(n.Id,r);let s;if(l)s=function(e,n,t,a,r,i){const o=r(n);switch(t.loadState){case 1:return{event:o,fullEventPromise:Promise.resolve({calendarEvent:o,error:null}),promiseSource:2};case 0:return{event:o,fullEventPromise:ye(n.Id,i),promiseSource:0};case 2:const r=_e(o,n,a,e,i);return Object.assign({event:o},r);default:return Object(be.a)(t.loadState)}}(t=t||l.folderId,n,l,!1,d,r);else{const e=d(n),a=_e(e,n,!1,t||(null===(i=null==e?void 0:e.ParentFolderId)||void 0===i?void 0:i.Id)||null,r);s=Object.assign({event:e},a)}let u=null;return s&&(t=t||(null===(c=null===(o=s.event)||void 0===o?void 0:o.ParentFolderId)||void 0===c?void 0:c.Id)||null,u={event:s.event,fullEventPromise:Fe(s.fullEventPromise,s.promiseSource,s.event,e,t,a,n.Id,!1,r)}),u}function he(e,n,t=null,a={fetchSource:"unknown"},r){var i,o,c;let d;const l=Se(t)(n);t=t||(null===(i=null==l?void 0:l.ParentFolderId)||void 0===i?void 0:i.Id);const s=l&&Object(x.b)(l);r||(r=s?Object(N.b)(s):Object(N.c)()),d=function(e,n,t,a,r){const i=a&&Object(N.e)(a,t);if(i&&1===i.loadState){const n=Object(C.d)(a,e);return{event:n,fullEventPromise:Promise.resolve({calendarEvent:n,error:null}),promiseSource:2}}if(i&&0===i.loadState){return{event:Object(C.d)(a,e)||Ee(r),fullEventPromise:ye(a,t),promiseSource:0}}return{event:Ee(r),fullEventPromise:Ne(n,!0,e,t),promiseSource:0}}(t,n,r,s,l);let u=null;return d&&(t=t||(null===(c=null===(o=d.event)||void 0===o?void 0:o.ParentFolderId)||void 0===c?void 0:c.Id)||null,u={event:d.event,fullEventPromise:Fe(d.fullEventPromise,d.promiseSource,d.event,e,t,a,s,!0,r)}),u}function Se(e){return n=>{return Object(C.b)(n.Id,e)}}function Ee(e){return e&&Object.assign(Object.assign({},Object(Oe.a)(Object(Ie.toJS)(e))),{ItemId:Object.assign({},null==e?void 0:e.SeriesMasterItemId),CalendarItemType:"RecurringMaster"})}function _e(e,n,t,a,r){return e&&e.EffectiveRights&&!Object(w.t)(e)?{fullEventPromise:Promise.resolve({calendarEvent:e,error:null}),promiseSource:1}:{fullEventPromise:Ne(n,t,a,r),promiseSource:0}}async function Fe(e,n,t,a,r,i,d,l,s){let u=Object(N.d)(a,d,s),f=null,m=null,b=null;try{if(pe.h.info(`[fetchFullCalendarEvent] Handling loading full calendar event Key: ${d}, Lock: ${a}`),!r||u&&1===u.loadState||d&&(pe.h.info(`[fetchFullCalendarEvent] Loading full calendar event Key: ${d}, Lock: ${a}`),function(e,n,t){const a=ke(e,n);je[a]=t}(d,s,e),Object(o.d)(a,r,d,s,t)),2==n)f=t;else{const n=await e;f=null==n?void 0:n.calendarEvent,m=null==n?void 0:n.error,b=null==n?void 0:n.responseCode,void 0===d&&(d=Object(x.a)(n.calendarEvent))}if(!f){const e=new Error(`[fetchFullCalendarEvent] Action source:${i.fetchSource} with response code: ${null!=b?b:"<null>"} and error: ${m}`);throw b&&(e.responseCode=b,e.fetchErrorType="ServerFailure"),e.diagnosticInfo=JSON.stringify({responseCode:b,eventKey:d}),e}const v=r||f.ParentFolderId.Id,p=u;if(u=Object(N.d)(a,d,s),!v||u&&1===u.loadState)pe.h.info(`[fetchFullCalendarEvent] Full calendar event already loaded. EventKey: "${d}", Lock: "${a}", FolderId: "${v}"`),Object(o.h)(a,d);else{pe.h.info(`[fetchFullCalendarEvent] Loaded full calendar event Key: "${d}", Lock: "${a}", FolderId: "${v}"`),Object(ve.o)("FullCalendarEventLoaded",Object.assign({eventKey:d,lockId:a,prevFullItemLoadState:p?p.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:void 0!==f.RequiredAttendees,isSameAsExistingEvent:t===f,eventScope:l?3:0,errorMessage:null},i));const e=0===n;Object(o.g)(a,v,d,s,f,l,e)}const O=Object(C.d)(d,r);return O&&Object(c.b)(O),O}catch(m){const e=u;throw u=Object(N.d)(a,d,s),Object(ve.o)("FullCalendarEventLoaded",Object.assign({eventKey:d,lockId:a,prevFullItemLoadState:e?e.loadState:null,fullItemLoadState:u?u.loadState:null,isFullItem:!1,isSameAsExistingEvent:!1,eventScope:l?3:0,errorMessage:m.toString()},i)),r&&("ErrorItemNotFound"===m.responseCode?Object(o.r)(r,e=>Object(x.a)(e)===d):Object(o.e)(a,r,d,null==f?void 0:f.ItemId,s)),m}finally{!function(e,n){const t=ke(e,n);delete je[t]}(d,s)}}function Ne(e,n,t,a){return(()=>(async function(e,n,t,a,r){let i=0;for(;i<e;)try{const o=await Object(J.a)(n,a,r,t);if(i++,!o.error||i>=e)return o}catch(t){if(pe.h.warn(`[fetchFullCalendarEvent] Received error when trying to load calendar event from server for "${n.Id}" with try ${i}: Error ${t.toString()}`),i++,i>=e||"ErrorItemNotFound"===t.responseCode)throw t}return{calendarEvent:null,error:"Error: Unable to fetch event"}})(T.b,e,n,t,a))()}function Ce(e){if(!e)throw new Error("The lock id should be provided");return{fetchCalendarEventsForDateRange:(n,t)=>{const{fetchPromise:a,enhancedFetchPromise:r,events:i}=Object(me.a)(e,n,t);return{fetchPromise:a,enhancedFetchPromise:r,events:i}},subscribeNotifications:n=>Object(d.c)(n,e),fetchFullCalendarEvent:(n,t,a,r)=>{let i=Object(C.b)(n.Id),{event:o,fullEventPromise:c}=Ae(e,n,t,a,r,(null==i?void 0:i.IsOrganizer)?"WithBlockedExternalContent":null);return c=c.then(async i=>{if(i.IsOrganizer&&i.HasBlockedImages){let{fullEventPromise:o}=Ae(e,n,t,a,r,"WithBlockedExternalContent");i=await o}return i}),{event:o,fullEventPromise:c}},fetchFullCalendarEventAndUpdateItemResponseShapeType:(n,t,a,r,i)=>Ae(e,n,a,r,i,t),getLockId:()=>e,release:()=>Object(o.o)(e)}}function Ae(e,n,t,a,r,i){return a?he(e,n,t,r,i):ge(e,n,t,r,i)}function we(e,n){const t=Object(R.g)(e);return n&&function(e,n){n?M.set(e,n):M.delete(e)}(t,n.maxMruSize),Ce(t)}var Te=t(2207),Re=t(2470);function xe(e){return{getCalendarEventsForDateRange:(n,t)=>Object(Te.a)(e,n,t),getEnhancedCalendarEventsForDateRange:(n,t)=>(function(e,n,t){return Object(Re.b)(n,t)?Object(Te.a)(e,n,t):null})(e,n,t),getFullCalendarEvent:(n,t)=>Object(C.e)(n,t,e)}}function Pe(e){const n=Object(A.a)(),{calendarFolderWorkingHours:t}=n;return t.get(e)}t.d(n,"u",(function(){return Me})),t.d(n,"k",(function(){return C.b})),t.d(n,"c",(function(){return c.d})),t.d(n,"b",(function(){return c.c})),t.d(n,"a",(function(){return c.b})),t.d(n,"d",(function(){return c.e})),t.d(n,"g",(function(){return c.f})),t.d(n,"v",(function(){return c.j})),t.d(n,"r",(function(){return c.g})),t.d(n,"t",(function(){return c.i})),t.d(n,"s",(function(){return c.h})),t.d(n,"y",(function(){return d.b})),t.d(n,"z",(function(){return d.d})),t.d(n,"i",(function(){return te})),t.d(n,"m",(function(){return ae})),t.d(n,"o",(function(){return $})),t.d(n,"n",(function(){return N.f})),t.d(n,"w",(function(){return le})),t.d(n,"j",(function(){return se})),t.d(n,"x",(function(){return Q.a})),t.d(n,"h",(function(){return ue.a})),t.d(n,"e",(function(){return fe.a})),t.d(n,"f",(function(){return we})),t.d(n,"q",(function(){return Ce})),t.d(n,"p",(function(){return xe})),t.d(n,"l",(function(){return Pe}));const De=new ne.c(()=>Promise.all([t.e(0),t.e(964)]).then(t.bind(null,19894)));let Me=new ne.a(De,e=>e.getCalendarEventsFromRest)},1725:function(e,n,t){"use strict";var a,r,i;t.d(n,"c",(function(){return a})),t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i})),function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(a||(a={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(r||(r={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(i||(i={}))},1732:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return i})),t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return c}));const a="FileAttachment:#Exchange",r="ItemAttachment:#Exchange",i="ItemIdAttachment:#Exchange",o="ReferenceAttachment:#Exchange",c="LinkAttachment:#Exchange"},1735:function(e,n,t){"use strict";var a=t(1743);function r(e,n){return{"X-OWA-ExplicitLogonUser":e,"X-AnchorMailbox":n||e}}function i(e,n,t){n&&(e||t)&&Object(a.b)(n,r(e,t))}function o(e,n){var t;const a=null!=n?n:{},r=(null===(t=a.headers)||void 0===t?void 0:t.set)?new Headers(a.headers):new Headers;return a.datapoint=a.datapoint||{},a.datapoint.mailbox=a.datapoint.mailbox||"Explicit",i(e,r),Object.assign(Object.assign({},a),{headers:r})}var c=t(287),d=t(1744),l=t(59),s=t(307),u=t.n(s);async function f(e){return Object(l.b)().then(async n=>{if(e)if(Object(c.r)(e.userIdentity)){const t=await Object(d.a)(e.userIdentity,"GroupMailbox"==e.type||"TeamsMailbox"==e.type?e.mailboxSmtpAddress:null);u()(n,t)}else if("GroupMailbox"==e.type||"TeamsMailbox"==e.type){const t=r(e.mailboxSmtpAddress);u()(n,t)}return n})}function m(){return Object(l.b)().then(e=>(e.prefer='exchange.Behavior="CalendarInternal"',e))}function b(e=null){return Object(c.r)(e)?m().then(n=>{return Object(d.a)(e).then(e=>(Object.keys(e).forEach(t=>n[t]=e[t]),n))}):Promise.resolve({})}var v=t(52);function p(e,n,t,a){let r=new Headers;return t&&r.set("X-OWA-CANARY",Object(v.a)()),n&&r.set("X-OWA-ActionName",n),(e||a)&&(a?i(e,r,a):i(e,r)),r}t.d(n,"a",(function(){return o})),t.d(n,"d",(function(){return f})),t.d(n,"b",(function(){return b})),t.d(n,"c",(function(){return m})),t.d(n,"f",(function(){return i})),t.d(n,"e",(function(){return p}))},1736:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return d})),t.d(n,"d",(function(){return l})),t.d(n,"e",(function(){return s}));var a=t(1814),r=t(1812),i=t(1759);function o(e,n){const t=Object(r.a)().calendarFolderEvents.get(e);return t?[...t.events.values()].filter(n):[]}function c(e,n=null){if(n){const[t]=o(n,n=>n.ItemId.Id===e);return t||null}return u(n=>n.ItemId.Id===e)}function d(e,n=null){if(n){const[t]=o(n,n=>n.InstanceKey===e);return t||null}return u(n=>n.InstanceKey===e)}function l(e,n=null){const t=Object(r.a)();if(n){return t.calendarFolderEvents.get(n).events.get(e)||null}return function(e){const n=[...Object(r.a)().calendarFolderEvents.keys()];for(let t=0;t<n.length;t++){const a=l(e,n[t]);if(a)return a}return null}(e)}function s(e,n,t){let o=null;o=e?function(e,n,t){const i=Object(r.a)().calendarFolderEvents.get(e);if(i){const[e]=Object(a.l)([n],t,i);return e||null}return null}(e,n,t):function(e,n){const t=Object(r.a)(),i=[...t.calendarFolderEvents.keys()];for(let r=0;r<i.length;r++){const o=i[r],c=t.calendarFolderEvents.get(o),[d]=c?Object(a.l)([e],n,c):[null];if(d)return d}return null}(n,t);const c=o?"1":"no";return Object(i.a)({lockId:t,updateMessage:`Got ${c} item from the cache for given folder and key`}),o}function u(e){const n=Object(r.a)(),t=[...n.calendarFolderEvents.keys()];for(let a=0;a<t.length;a++){const r=t[a],i=n.calendarFolderEvents.get(r),[o]=i?[...i.events.values()].filter(e):[null];if(o)return o}return null}},1743:function(e,n,t){"use strict";function a(e,n){Object.keys(n).forEach(t=>e.set(t,n[t]))}function r(e){let n=null!=e?e:{headers:new Headers};return n.datapoint=n.datapoint||{},n.datapoint.mailbox="Default",n}t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return r}))},1744:function(e,n,t){"use strict";var a=t(1877),r=t(287),i=t(1690),o=t(71),c=t(7),d=t(36);const l="X-AnchorMailbox",s="Authorization",u="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function m(e,n){const t={},m=Object(r.k)(e);if(n?(t[l]=n,t[f]=n):m&&(t[l]=m.anchorMailbox),Object(r.s)())return d.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),t;if(m){if(m.accountState==r.b.AccessRevoked)return null;if(m.accountState==r.b.AccountDeprovisioned||m.accountState==r.b.AccountNotFound)return Object(r.d)(m.accountState,m.accountProviderType),null}if(m){let n,r=m.token,l=Object(i.f)(m.tokenExpiry);!l&&r||(Object(o.o)("getAndUpdateAccessToken",{tokenExpiry:Object(c.y)(m.tokenExpiry,Object(c.Ub)()),isTokenExpired_1:l,isTokenInvalid_2:!r},{isCore:!0}),r=await a.a.importAndExecute(m.accountId,e,r),d.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+e+r),r||(r="")),"Outlook"==m.accountProviderType?(n=`MSAuth1.0 usertoken="${r}", type="MSACT"`,t[u]=1..toString()):"Google"!=m.accountProviderType&&"ICloud"!=m.accountProviderType&&"Yahoo"!=m.accountProviderType||(n=`Bearer ${r}`,t[u]=2..toString()),t[s]=n}return t}var b=t(1743),v=t(912);async function p(e,n){var t;const a=Object(b.a)();if(a.headers=await async function(e,n){var t;const a=n&&(null===(t=e.headers)||void 0===t?void 0:t.set)?new Headers(e.headers):new Headers,r=await m(e.mailboxInfo.userIdentity,O(e.mailboxInfo.type,e.mailboxInfo.mailboxSmtpAddress)?e.mailboxInfo.mailboxSmtpAddress:null);return Object(b.b)(a,r),a}(e,n),a.authNeededOnUnAuthorized=!1,a.datapoint=a.datapoint||{},Object(r.s)()){const n=Object(v.a)(null===(t=null==e?void 0:e.mailboxInfo)||void 0===t?void 0:t.userIdentity);d.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+n),a.sourceId=n,a.datapoint.mailbox="Connected"}else a.datapoint.mailbox="Connected";return a}function O(e,n){const t="GroupMailbox"==e||"TeamsMailbox"==e||"SharedMailbox"==e||"PublicMailbox"==e;return t&&null==n&&d.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),t}t.d(n,"a",(function(){return m})),t.d(n,"b",(function(){return p})),t.d(n,"c",(function(){return O}))},1759:function(e,n,t){"use strict";var a=t(2835),r=t(47),i=function(e){Object(r.j)("cal-cacheDiagnostics")&&setTimeout(()=>Object(a.a)(e),0)};t.d(n,"a",(function(){return i}))},1761:function(e,n,t){"use strict";var a=t(20);var r={ChannelData:"ChannelData",SubscriptionAdded:"SubscriptionAdded",SubscriptionRemoved:"SubscriptionRemoved",SubscriptionUpdated:"SubscriptionUpdated",NotificationData:"NotificationData",TraceWarn:"TraceWarn",TraceError:"TraceError"};t.d(n,"j",(function(){return o})),t.d(n,"k",(function(){return c})),t.d(n,"b",(function(){return d})),t.d(n,"c",(function(){return l})),t.d(n,"g",(function(){return s})),t.d(n,"h",(function(){return u})),t.d(n,"e",(function(){return f})),t.d(n,"i",(function(){return m})),t.d(n,"f",(function(){return b})),t.d(n,"d",(function(){return v})),t.d(n,"a",(function(){return r}));const i=new a.c(()=>Promise.all([t.e(0),t.e(543)]).then(t.bind(null,19504))),o=new a.a(i,e=>e.subscribe),c=new a.a(i,e=>e.unsubscribe),d=new a.b(i,e=>e.getChannelId),l=new a.a(i,e=>e.getChannelReady),s=new a.a(i,e=>e.retryDisconnectionWithMinimumReconnectInterval),u=new a.a(i,e=>e.setup),f=new a.a(i,e=>e.handleNotification),m=new a.a(i,e=>e.NotificationManager.stopConnection),b=new a.a(i,e=>e.initializeNotificationManager),v=new a.b(i,e=>e.getNotificationEmitter)},1765:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(3);const r=Object(a.action)("triggerReInitializeAccount",e=>({userIdentity:e}))},1781:function(e,n,t){"use strict";const a=175,r="_____";function i(e){if(!e)return null;const n=e.indexOf(r);if(-1!=n&&(e=e.substring(0,n)),(e=e.trim()).length<a)return e;const t=e.substr(0,a).trim();return t.length>0?t.concat("..."):null}var o=t(225),c=t(88),d=t(47),l=t(10),s=t(7),u=t(2131),f=t(1998),m=t(1873),b=t(1999),v=t(2e3),p=t(2001),O=t(2002),I=t(1991),j=t(36);const k=e=>{let n=null,t=null,a=null;if(e)try{const r=JSON.parse(e);if(r){const{location:e,metadata:i}=r;n=e,i&&(t="Enabled"===i.state,a=i.isShared)}}catch(n){j.h.warn("Unable to parse collab space extended property: "+e)}return{shareLinkInfo:{url:(null==n?void 0:n.length)>0?n:null,linkId:null},enabled:(null==n?void 0:n.length)>0?t:null,isShared:(null==n?void 0:n.length)>0?a:null,changeKey:null,resourceId:null}};var y=t(561),g=t(340);function h(e,n,t,a){var r;a=a||Object(o.d)();let i=Object(u.a)(),c=function(e,n){const t=Object(s.rc)(e),a=S(t,Object(s.Fb)(n.start));return Object(y.t)(n,a)?a:S(t,Object(s.Fb)(n.end))}(e.Birthday,t);return Object.assign(Object.assign(Object.assign({},i),e),{Subject:e.Name,Start:c,End:Object(s.e)(c,1),IsAllDayEvent:!0,ParentFolderId:{Id:n,mailboxInfo:a},ItemId:{Id:e.Id.Id,mailboxInfo:a},PersonId:e.PersonId,EffectiveRights:{Read:!0},FreeBusyType:"Free",ReminderIsSet:e.PopupReminderSettings[0].IsReminderSet,ReminderMinutesBeforeStart:e.PopupReminderSettings[0].ReminderMinutesBeforeStart,InboxReminders:null===(r=e.EmailReminderSettings)||void 0===r?void 0:r.map(I.d)})}function S(e,n){const t=Object(s.Ab)(e),a=Object(s.mb)(e),r=Object(g.a)(n,t),i=Math.min(a,r);return Object(s.qc)(n,t,i)}t.d(n,"a",(function(){return F})),t.d(n,"c",(function(){return N})),t.d(n,"e",(function(){return C})),t.d(n,"b",(function(){return h})),t.d(n,"d",(function(){return k}));const E=Object(u.a)(),_=[[Object(s.rc)("2019-11-03T00:00:00.000-03:00"),Object(s.rc)("2020-02-15T23:59:59.999-03:00")],[Object(s.rc)("2020-11-08T00:00:00.000-03:00"),Object(s.rc)("2021-02-20T23:59:59.999-03:00")],[Object(s.rc)("2021-11-07T00:00:00.000-03:00"),Object(s.rc)("2022-02-20T23:59:59.999-03:00")]];function F(e,n){var t;n=n||Object(o.d)();let a=[],r=!1,l=null,u=!1,m=null;if(null==e?void 0:e.ExtendedProperty){let n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===f.a.PropertyName})[0];if(null==n?void 0:n.Value)try{a=JSON.parse(n.Value)}catch(e){a=[]}e.ExtendedProperty.some(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===b.a.PropertyName&&!!e.Value})&&(r=!0),n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===v.a.PropertyName})[0],(null==n?void 0:n.Value)&&(l=k(n.Value)),n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===O.a.PropertyName})[0],(null==n?void 0:n.Value)&&(m=n.Value),n=e.ExtendedProperty.filter(e=>{var n;return(null===(n=e.ExtendedFieldURI)||void 0===n?void 0:n.PropertyName)===p.a.PropertyName})[0],(null==n?void 0:n.Value)&&(u="true"===n.Value.toLowerCase())}const j=Object.assign(Object.assign(Object.assign({},E),e),{ItemId:e.ItemId?Object.assign(Object.assign({},e.ItemId),{mailboxInfo:n}):e.ItemId,ParentFolderId:e.ParentFolderId?Object.assign(Object.assign({},e.ParentFolderId),{mailboxInfo:n}):e.ParentFolderId,Start:N(e.Start),End:N(e.End),StartTimeZoneId:Object(c.b)(e.StartTimeZoneId),EndTimeZoneId:Object(c.b)(e.EndTimeZoneId),LastModifiedTime:N(e.LastModifiedTime),FreeBusyType:e.FreeBusyType,ResponseType:e.ResponseType,AppointmentReplyTime:N(e.AppointmentReplyTime),ExperienceType:e.ExperienceType?e.ExperienceType:"Unspecified",SeriesMasterItemId:e.SeriesMasterItemId?Object.assign(Object.assign({},e.SeriesMasterItemId),{mailboxInfo:n}):null,Sensitivity:"GroupMailbox"==n.type&&"Private"==e.Sensitivity?"Normal":e.Sensitivity,Preview:i(e.Preview),AppendOnSend:a,IsBookedFreeBlocks:r,CollabSpace:l,TravelTimeEventsLinked:u,FlexEventsMetadata:m,InboxReminders:null===(t=e.InboxReminders)||void 0===t?void 0:t.map(I.d)});if(!e.IsAllDayEvent&&e.SeriesId&&"Occurrence"==e.CalendarItemType&&"tzone://Microsoft/Custom"==e.StartTimeZoneId&&"E. South America Standard Time"==e.EndTimeZoneId&&!Object(d.j)("cal-killSwitch-63446")&&j.Start&&j.End&&_.some(([e,n])=>Object(s.Rb)(j.Start,e,n))){const e=Object(s.x)(j.End,j.Start);j.Start=Object(s.f)(j.Start,1),j.End=Object(s.h)(j.Start,e),j.StartTimeZoneId=j.EndTimeZoneId,j.__BrazilHack__=1}return j}function N(e){if(e){if(Object(d.j)("cal-assumeTzOffsetFromCalendarItem")){const n=Object(l.a)().timezone,t=!!n;return Object(s.Wb)(n,e,t)}return Object(s.qb)(e)}}function C(e){var n,t,a;const r=[];if(e.AppendOnSend&&e.AppendOnSend.length>0&&r.push(Object(m.a)({ExtendedFieldURI:f.a,Value:JSON.stringify(e.AppendOnSend)})),e.FlexEventsMetadata&&r.push(Object(m.a)({ExtendedFieldURI:O.a,Value:e.FlexEventsMetadata})),e.IsBookedFreeBlocks&&r.push(Object(m.a)({ExtendedFieldURI:b.a,Value:e.IsBookedFreeBlocks.toString()})),e.CollabSpace){const a=Object.assign({},(null===(t=null===(n=e.CollabSpace.shareLinkInfo)||void 0===n?void 0:n.url)||void 0===t?void 0:t.length)>0&&{type:"collaborativeSpace",location:e.CollabSpace.shareLinkInfo.url,metadata:{state:e.CollabSpace.enabled?"Enabled":"Disabled",isShared:e.CollabSpace.isShared}});r.push(Object(m.a)({ExtendedFieldURI:v.a,Value:JSON.stringify(a)}))}return e.TravelTimeEventsLinked&&r.push(Object(m.a)({ExtendedFieldURI:p.a,Value:e.TravelTimeEventsLinked.toString()})),Object.assign(Object.assign({__type:"CalendarItem:#Exchange"},e),{Start:e.Start&&Object(s.sb)(e.Start),End:e.End&&Object(s.sb)(e.End),LastModifiedTime:e.LastModifiedTime&&Object(s.sb)(e.LastModifiedTime),AppointmentReplyTime:e.AppointmentReplyTime&&Object(s.sb)(e.AppointmentReplyTime),FreeBusyType:e.FreeBusyType,CharmId:e.CharmId,IsDraft:e.IsDraft,IsRoomRequested:e.IsRoomRequested,SkypeTeamsProperties:e.SkypeTeamsProperties&&JSON.stringify(e.SkypeTeamsProperties),ExtendedProperty:r,InboxReminders:null===(a=e.InboxReminders)||void 0===a?void 0:a.map(I.e),AutoRoomBookingStatus:e.AutoRoomBookingStatus&&Object(I.c)(e.AutoRoomBookingStatus)})}},1790:function(e,n,t){"use strict";function a(e){var n;if(null===(n=null==e?void 0:e.ItemId)||void 0===n?void 0:n.Id){let n=e.ClientSeriesId;return!!n&&(e.IsRecurring?n==e.InstanceKey:n==e.ItemId.Id)}return!0}var r=t(905),i=t(326);function o(e,n){let t=Object(i.a)();e.forEach(e=>{const a=Object(i.a)();d(e,t,a,n),e.IsRecurring=!0,e.InstanceKey=e.InstanceKey&&!n?e.InstanceKey:t})}function c(e){const n=Object(i.a)();d(e,n,n,!1)}function d(e,n,t,a){e.ItemId=Object.assign(Object.assign({},Object(r.a)({Id:t})),{mailboxInfo:e.ParentFolderId.mailboxInfo}),e.ClientSeriesId&&!a||(e.ClientSeriesId=n),e.EffectiveRights={Read:!0,Modify:!0,Delete:!0,ViewPrivateItems:!0},e.IsOrganizer=!0}t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return c}))},1812:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(3),r=t(16);const i={calendarFolderEvents:new r.ObservableMap,fullItemsMruMap:new r.ObservableMap,calendarFolderWorkingHours:new r.ObservableMap},o=Object(a.createStore)("calendarEventsStore",i)},1814:function(e,n,t){"use strict";function a(e,n){n.locksInfo.get(e)||n.locksInfo.set(e,{lockedDateRange:null,lockedEvents:{}})}var r=t(1),i=t(2630),o=t(16);function c(e,n,t=!1){const{Key:a}=n,c=Object(r.__rest)(n,["Key"]),l=t?c:(s=c,Object.keys(s).reduce((e,n)=>(void 0!==s[n]&&(e[n]=s[n]),e),{}));var s;Object(o.isObservable)(e)?d(e,l):Object(i.a)(e,l,void 0)}function d(e,n){if(e===n)return;const t=Array.isArray(e)||Object(o.isObservableArray)(e),a=Array.isArray(n)||Object(o.isObservableArray)(n);if(t||a){const r=e,o=n;if(!e&&a)return o.length>0?o:r;if(!n&&t)return r.length>0&&r.splice(0),r;if(t&&a){if(r.length===o.length&&r.length>0)for(let e=0;e<r.length;e++)l(r[e])?Object(i.a)(r[e],o[e],d):r[e]=o[e];else r.length!==o.length&&(r.splice(0),r.push(...o));return r}return o}if(l(e)&&l(n)){if(!Object(o.isObservable)(e))return;return Object(i.a)(e,n,d)}}function l(e){return"[object Object]"===Object.prototype.toString.call(e)}var s=t(7),u=t(1759);function f(e,n,t=!1){const a=function(e,n,t){const a=[];for(let r=0;r<e.length;r++){const i=e[r],o=n.get(i.Key);o?(c(o,i,t),a.push(o)):a.push(i)}return a}(e,n,t);return a.forEach(e=>{n.set(e.Key,e)}),function(e){e.sort((e,n)=>Object(s.p)(e.Start,n.Start))}(a),Object(u.a)({lockId:"",updateMessage:`Upserted ${a.length} items in the cache`}),a}function m(e,n,t,r=!1,i=!1){a(n,t);const{events:o}=t;if(r){const n=o.get(e.Key);n&&(c(n,e,i),e=n)}const[d]=f([e],o,i),{lockedEvents:l}=t.locksInfo.get(n);return l[e.Key]=!0,Object(u.a)({lockId:n,updateMessage:`Event with startTime ${d.Start} added to the lock`}),d}var b=t(561);function v(e,n){const t={start:e.Start,end:e.End};for(let e=0;e<n.length;e++)if(0===Object(b.j)(n[e],t,!0))return!0;return!1}function p(e,n,t){const{dateRangesToRetain:a,eventsToRetain:r}=t;return function(e,n,t){const{dateRangesToRetain:a,eventsToRetain:r}=n,i=[];return e.forEach((e,n)=>{const o=v(e,[t]),c=v(e,a),d=r[e.Key]||c;o&&!d&&i.push(e)}),i.forEach(n=>{e.delete(n.Key)}),i}(n,{dateRangesToRetain:a.filter(n=>0===Object(b.j)(n,e,!0)),eventsToRetain:r},e)}function O(e,n,t){const a=[];return n.forEach(n=>{-1!==e.indexOf(n.Key)&&function(e,n){const{dateRangesToRetain:t,eventsToRetain:a}=n;return!v(e,t)&&!a[e.Key]}(n,t)&&a.push(n)}),a.forEach(e=>{n.delete(e.Key)}),a}function I(e=(()=>!0)){return(n,[t,a])=>(e([t,a])&&Object.keys(a.lockedEvents).forEach(e=>n[e]=!0),n)}function j(e=(()=>!0)){return(n,[t,a])=>(e([t,a])&&a.lockedDateRange&&n.push(a.lockedDateRange),n)}function k(e=(()=>!0)){return(n,[t,a])=>(e([t,a])&&n.push(t),n)}function y(e){return([n,t])=>t.lockedDateRange&&0===Object(b.j)(t.lockedDateRange,e,!1)}const g=e=>([n])=>n!==e;var h;function S(e,n,t){a(n,t);const r=t.locksInfo.get(n),{lockedDateRange:i,lockedEvents:o}=r,c=[...t.locksInfo.entries()].reduce(j(e!==h.EventIds?g(n):()=>!0),[]),d=[...t.locksInfo.entries()].reduce(I(e!==h.DateRange?g(n):()=>!0),{});!i||e!==h.All&&e!==h.DateRange||(p(i,t.events,{dateRangesToRetain:c,eventsToRetain:d}),r.lockedDateRange=null);const l=Object.keys(o);l.length>0&&(e===h.All||e===h.EventIds)&&(O(l,t.events,{dateRangesToRetain:c,eventsToRetain:d}),r.lockedEvents={})}!function(e){e[e.All=0]="All",e[e.DateRange=1]="DateRange",e[e.EventIds=2]="EventIds"}(h||(h={}));var E=t(36);function _(e,n,t,r){a(t,r);let{lockedDateRange:i}=r.locksInfo.get(t);const o=i?`${i.start} - ${i.end}`:"null";var c,d;i&&(c=i,d=e,0==Object(b.j)(c,d,!0)||function(e,n){let t=0;return t=Object(s.p)(e.start,n.start)<0?Object(s.w)(n.start,e.end):Object(s.w)(e.start,n.end),1==t}(c,d))&&!Object(b.c)(e,i,!0)?Object(b.c)(i,e,!0)?E.h.info(`[addEventsForLock]: Date range in lock ${t} already contains the range to be added.`):i=Object(b.f)(i,e):(E.h.info(`[addEventsForLock] Replacing all items in cache for lock "${t}". Date range: ${e.start} - ${e.end}`),S(h.DateRange,t,r),i=e);const l=f(n,r.events);return r.locksInfo.get(t).lockedDateRange=i,E.h.info(`[addEvents] New range in cache for lock "${t}": ${i.start} - ${i.end}`),Object(u.a)({lockId:t,updateMessage:`${l.length} events added to the lock. Previous locked daterange: ${o}. New locked daterange: ${i.start} - ${i.end}`}),l}function F(e,n,t){const a=n.events.size;let r=[];n.events.forEach((e,n)=>{const a={start:e.Start,end:e.End};t.some(e=>0===Object(b.j)(a,e,!0))&&r.push(n)}),r.forEach(e=>{n.events.delete(e)}),e.forEach(e=>{n.events.set(e.Key,e)}),Object(u.a)({lockId:"",updateMessage:`Replaced ${r.length} items of initial ${a} from cache with ${e.length} items`})}function N(e,n,t){if(0===e.length)return[];a(n,t);const r=t.locksInfo.get(n);e=e.filter(e=>r.lockedEvents[e]);const i=[...t.locksInfo.entries()].reduce(j(),[]),o=[...t.locksInfo.entries()].reduce(I(g(n)),{}),c=O(e,t.events,{dateRangesToRetain:i,eventsToRetain:o});return e.forEach(e=>{delete r.lockedEvents[e]}),c}function C(e,n,t){a(n,t);const r=t.locksInfo.get(n),i=r.lockedDateRange;if(!i||Object(b.c)(e,r.lockedDateRange,!0))return;Object(u.a)({lockId:n,updateMessage:`Now evicting events in cache except for events in date range ${e.start} - ${e.end}. Current locked cache range: ${i.start} - ${i.end}`});const o=[...t.locksInfo.entries()].reduce(j(g(n)),[e]),c=[...t.locksInfo.entries()].reduce(I(),{}),d=p(i,t.events,{dateRangesToRetain:o,eventsToRetain:c});E.h.info(`[owa-events-cache:evictEventsExceptInDateRangeForLock] Evicted ${d.length} events for lock '${n}'`),Object(b.c)(i,e,!0)?r.lockedDateRange=Object.assign({},e):r.lockedDateRange=function(e,n){const t=-1===Object(s.p)(e.start,n.start),a=1===Object(s.p)(e.end,n.end);let{start:r,end:i}=e;t&&(r=n.start);a&&(i=n.end);return{start:r,end:i}}(e,i),Object(u.a)({lockId:n,updateMessage:`Evicted ${d.length} events for lock. New locked cache range: ${i.start} - ${i.end}`})}function A(e,n){const{events:t}=n,a=[];return t.forEach((n,t)=>{e(n)&&a.push(n)}),a.forEach(e=>{t.delete(e.Key)}),function(e,n){[...n.locksInfo.keys()].forEach(t=>{const a=n.locksInfo.get(t);e.forEach(e=>delete a.lockedEvents[e.Key])})}(a,n),Object(u.a)({lockId:"",updateMessage:`Unloaded ${a.length} items from cache`}),a.reverse()}function w(e,n){S(h.All,e,n),n.locksInfo.delete(e)}function T(e,n){const t=[];return n.forEach(n=>{const a={start:n.Start,end:n.End};0===Object(b.j)(e,a,!0)&&t.push(n)}),t}var R=t(5);function x(e,n,t){const a=t&&t.locksInfo.get(n)?t.locksInfo.get(n).lockedDateRange:null;if(null!=a&&Object(b.c)(a,e,!0)){const a=T(e,t.events);if(Object(R.f)("debugEventsCache")){const t=a?a.length:"no";Object(u.a)({lockId:n,updateMessage:`Returning ${t} items from cache for date range: ${e.start} - ${e.end}`})}return a}return null}function P(e,n,t){const{lockedDateRange:a=null,lockedEvents:r=[]}=t.locksInfo.get(n)||{};return null===a&&0===Object.keys(r).length?e.map(e=>null):function(e,n,t){const{lockedDateRange:a,lockedEvents:r}=t.locksInfo.get(n),i={};return e.forEach(e=>{const n=t.events.get(e);if(n){const e={start:n.Start,end:n.End};(!!a&&0===Object(b.j)(a,e,!0)||r[n.Key])&&(i[n.Key]=n)}}),e.map(e=>i[e]||null)}(e,n,t)}let D=0;function M(e){const n=e||`events_cache_lock_${D}`;return D++,n}function L(){return{events:new o.ObservableMap,locksInfo:new o.ObservableMap}}t.d(n,"a",(function(){return m})),t.d(n,"b",(function(){return _})),t.d(n,"r",(function(){return f})),t.d(n,"p",(function(){return F})),t.d(n,"i",(function(){return N})),t.d(n,"h",(function(){return C})),t.d(n,"o",(function(){return A})),t.d(n,"n",(function(){return w})),t.d(n,"q",(function(){return c})),t.d(n,"k",(function(){return x})),t.d(n,"j",(function(){return T})),t.d(n,"l",(function(){return P})),t.d(n,"g",(function(){return M})),t.d(n,"f",(function(){return L})),t.d(n,"c",(function(){return j})),t.d(n,"d",(function(){return I})),t.d(n,"e",(function(){return k})),t.d(n,"m",(function(){return y}))},1815:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return d})),t.d(n,"f",(function(){return l})),t.d(n,"b",(function(){return s})),t.d(n,"c",(function(){return u}));var a=t(16),r=t(1812);function i(){return f.get()}function o(e,n){const t=c(e);return t&&t.itemResponseShapeType===n?t:null}function c(e){const n=i()[e];return n||null}function d(e,n,t){const a=Object(r.a)().fullItemsMruMap.get(e);if(a){const[e]=a.eventInfos.filter(e=>e.eventKey===n);if(e&&e.itemResponseShapeType===t)return e}return null}function l(e){const n=c(e);return n?n.loadState:null}function s(e){var n;const t=null===(n=c(e))||void 0===n?void 0:n.itemResponseShapeType;return t||"Default"}function u(){return"Default"}const f=Object(a.computed)(()=>{const e=Object(r.a)();return[...e.fullItemsMruMap.keys()].reduce((n,t)=>{const{eventInfos:a}=e.fullItemsMruMap.get(t);return a.forEach(e=>n[e.eventKey]=e),n},{})})},1817:function(e,n,t){"use strict";var a=t(0),r=t(23),i=Object(r.a)((function(e){return a.createElement(a.Fragment,null,e.location)}));const o=/\(([^)]*)\)/gi,c=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/gi,d=/\s+/gi;function l(e){let n="";if(!e)return n;let t=(e=(e=(e=(e=e.replace(o,"")).replace(c,"")).replace(d," ")).trim()).split(" ");return t.length>=2?(n+=t[0].charAt(0).toUpperCase(),n+=t[t.length-1].charAt(0).toUpperCase()):0!=t.length&&(n+=t[0].charAt(0).toUpperCase()),n}var s=t(1725);const u=Object.keys(s.a).length/2;function f(e){if(!e)return null;let n=0;for(let a=e.length-1;a>=0;a--){let r=e.charCodeAt(a);var t=a%8;n^=(r<<t)+(r>>8-t)}return n%u}function m(e){return{personaId:e,displayName:e,postalAddress:{Type:"Business",LocationSource:"None"},displayAddress:"",initials:l(e),textBoyColor:f(e),selectionSource:"ExplicitTyping",personaType:"Unknown",personaControlId:e}}var b=t(1935);var v=t(703);function p(e){var n;if(e){let t=function(e){return e?null!=e.HomeAddressesArray&&e.HomeAddressesArray.length>0?e.HomeAddressesArray[0].Value:null!=e.BusinessAddressesArray&&e.BusinessAddressesArray.length>0?e.BusinessAddressesArray[0].Value:null!=e.OtherAddressesArray&&e.OtherAddressesArray.length>0?e.OtherAddressesArray[0].Value:null:null}(e),a=Object(b.c)(e.DisplayName,t);return"Room"==e.PersonaTypeString&&(t.LocationUri=e.EmailAddress.EmailAddress),{personaId:null===(n=e.PersonaId)||void 0===n?void 0:n.Id,feedbackId:e.FeedbackId,displayName:a,postalAddress:t,emailAddress:e.EmailAddress,displayAddress:Object(b.a)(t),initials:l(a),textBoyColor:f(a),selectionSource:"LocationWell",personaType:Object(v.a)(e.PersonaTypeString)?"Unknown":e.PersonaTypeString,personaControlId:null==e.PersonaId?e.FeedbackId:e.PersonaId.Id,availability:e.Availability,numberOfAvailableTimeSlots:e.NumberOfAvailableTimeSlots,totalNumberOfTimeSlots:e.TotalNumberOfTimeSlots,isPartialAvailability:e.IsPartialAvailability,capacity:e.Capacity,entityType:e.EntityType,audioDeviceName:e.AudioDeviceName,displayDeviceName:e.DisplayDeviceName,videoDeviceName:e.VideoDeviceName,isWheelChairAccessible:e.IsWheelChairAccessible}}return null}var O=t(1911);function I(e){if((null==e?void 0:e.DisplayName)&&e.PostalAddress){let n=Object(b.c)(e.DisplayName,e.PostalAddress),t=Object(O.a)(e.PostalAddress)&&!Object(v.a)(e.PostalAddress.LocationUri)?{EmailAddress:e.PostalAddress.LocationUri}:null;return{personaId:e.Id,displayName:e.DisplayName,postalAddress:e.PostalAddress,emailAddress:t,displayAddress:Object(b.a)(e.PostalAddress),initials:l(n),textBoyColor:f(n),personaType:Object(O.a)(e.PostalAddress)?"Room":"Unknown",personaControlId:e.DisplayName}}return null}var j=t(6),k=t(38),y=t(327),g=t(283);const h=290,S=135;function E(e,n,t,a,r,i){r=r||h,i=i||S;const o=Object(k.a)();if((!Object(v.a)(t)||e&&n)&&o.PolicySettings.PlacesEnabled){var c=Object(j.c)("/OWS/beta/Location/locationmap?Latitude={0}&Longitude={1}&Address={2}&Culture={3}&Width={4}&Height={5}",e&&e.toString(),n&&n.toString(),encodeURIComponent(t),Object(j.e)(),r,i);Object(y.b)(c,void 0,!0).then(e=>{Object(g.a)(e.status)?e.json().then(e=>{a(`data:image/png;base64,${e.ib}`)}):a("")})}else a("")}var _=t(2412),F=t(36),N=t(307),C=t.n(N);const A=Object(r.a)((function(e){var n,t;const r=a.useRef(),[i,o]=a.useState(null);a.useEffect(()=>{var n;let t=!0;return(null===(n=e.locationPersona)||void 0===n?void 0:n.postalAddress)&&e.locationPersona.postalAddress.Latitude&&e.locationPersona.postalAddress.Longitude&&!Object(v.a)(e.locationPersona.displayName)&&!i&&"pending"!=r.current&&"failed"!=r.current&&(r.current="pending",E(e.locationPersona.postalAddress.Latitude,e.locationPersona.postalAddress.Longitude,null,(function(e){t&&(o(e),e?r.current="success":(r.current="failed",F.h.warn("getLocationPhoto.downloadLocationPhoto failed")))}),64,64)),()=>t=!1},[null===(n=e.locationPersona.postalAddress)||void 0===n?void 0:n.Latitude,null===(t=e.locationPersona.postalAddress)||void 0===t?void 0:t.Longitude,e.locationPersona.displayName]);let{locationPersona:c,className:d,size:l,showPersonaDetails:u}=e;if(c){let e={};return Object(v.a)(i)?C()(e,{imageInitials:c.initials,initialsColor:c.textBoyColor}):C()(e,{imageUrl:i,imageShouldFadeIn:!1}),a.createElement(_.a,Object.assign({className:d,presence:s.b.none,hidePersonaDetails:!u,size:l,text:c.displayName,secondaryText:c.displayAddress},e))}return null})),w="https://www.bing.com/maps?v=2&rtp=~pos.{0}_{1}_{2}_{3}&FORM=CalLoc",T="https://www.bing.com/maps?v=2&rtp=~adr.{0}_{1}&FORM=CalLoc";function R(e,n,t,a){return e&&n?Object(j.c)(w,e.toString(),n.toString(),t,a):t?Object(j.c)(T,t,a):null}var x=t(2011),P=t(20);function D(e,n){return{Id:n,DisplayName:e,PostalAddress:{LocationSource:"Resource",LocationUri:n,Type:"Business"}}}var M=t(1842);function L(e){return{EmailAddress:e.PostalAddress.LocationUri,Name:e.DisplayName}}function z(e){return{Id:e,DisplayName:e,PostalAddress:{Type:"Business",LocationSource:"None"}}}function B(e,n,t,a){return e?{PostalAddress:{LocationUri:t,LocationSource:a,Type:n,Street:e.streetAddress,City:e.addressLocality,State:e.addressRegion,Country:e.addressCountry,PostalCode:e.postalCode,PostOfficeBox:e.postOfficeBoxNumber,Longitude:e.longitude,Latitude:e.latitude}}:null}var U=t(1907);function V(e){let n=[];return e&&"string"!=typeof e&&n.push({Id:e.personaId,DisplayName:e.displayName,PostalAddress:e.postalAddress}),n}t.d(n,"t",(function(){return K})),t.d(n,"b",(function(){return q})),t.d(n,"m",(function(){return m})),t.d(n,"l",(function(){return p})),t.d(n,"k",(function(){return I})),t.d(n,"a",(function(){return A})),t.d(n,"n",(function(){return R})),t.d(n,"o",(function(){return E})),t.d(n,"r",(function(){return x.a})),t.d(n,"s",(function(){return O.a})),t.d(n,"g",(function(){return D})),t.d(n,"c",(function(){return M.a})),t.d(n,"d",(function(){return M.b})),t.d(n,"e",(function(){return M.c})),t.d(n,"p",(function(){return L})),t.d(n,"h",(function(){return z})),t.d(n,"i",(function(){return B})),t.d(n,"f",(function(){return U.a})),t.d(n,"u",(function(){return U.d})),t.d(n,"q",(function(){return U.b})),t.d(n,"j",(function(){return V}));const G=new P.c(()=>Promise.all([t.e(22),t.e(25),t.e(35),t.e(647)]).then(t.bind(null,19814)));let K=new P.b(G,e=>e.createTxpPostalAddressFromLocationPersona);const q=Object(P.d)(G,e=>e.WebUrlLocation,i)},1842:function(e,n,t){"use strict";t.d(n,"d",(function(){return r})),t.d(n,"a",(function(){return o})),t.d(n,"c",(function(){return c})),t.d(n,"b",(function(){return d}));var a=t(1911);function r(e,n){if(null==e&&null!=n||null!=e&&null==n)return!1;if(null==e&&null==n)return!0;if(0==e.length&&0==n.length)return!0;if(e.length!=n.length)return!1;let t=0;for(;t<e.length;){if(!i(e[t],n[t]))return!1;t++}return!0}function i(e,n){return!(!e&&n||e&&!n)&&(e.Id===n.Id||Object(a.a)(e.PostalAddress)&&Object(a.a)(n.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===n.PostalAddress.LocationUri.toLowerCase())}function o(e,n){return e&&Object(a.a)(n.PostalAddress)?c(e,n.PostalAddress.LocationUri):d(e,n.Id)}function c(e,n){return!!(n&&e&&e.some(e=>Object(a.a)(e.PostalAddress)&&e.PostalAddress.LocationUri.toLowerCase()===n.toLowerCase()))}function d(e,n){return e&&e.some(e=>e.Id===n)}},1846:function(e,n,t){"use strict";function a(e){if(!e)return e;let n=e.replace(/\+/g,"_");return n=n.replace(/\//g,"-"),n}function r(e){if(!e)return e;let n=e.replace(/_/g,"+");return n=n.replace(/-/g,"/"),n}t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r}))},1877:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(20),r=t(1765);t.d(n,"b",(function(){return r.a}));const i=new a.c(()=>t.e(874).then(t.bind(null,2361))),o=new a.a(i,e=>e.getAndUpdateAccessToken)},1883:function(e,n,t){"use strict";var a=t(561),r=t(7);function i(e){return o({start:e.Start,end:e.End})}function o(e){const n=Object(r.bc)(e.end),t={start:e.start,end:e.end},a=Object(r.Kb)(e.end,n),i=Object(r.Kb)(e.start,n);return a&&!i&&(t.end=Object(r.ic)(t.end,1)),t}function c(e){return n=>{const t=i(n);return 0===Object(a.j)(e,t,!0)}}var d=t(22);function l(e){const n=i(e),t=Object(r.w)(Object(r.bc)(n.end),Object(r.bc)(n.start));return Math.ceil(t/d.e)}var s=t(108);function u(e){return e.IsAllDayEvent||Object(r.w)(e.End,e.Start)>=s.a.MillisecondsInOneDay}function f(e){return Object(r.Ib)(e.Start,e.End)?m(e):l(e)>=1}function m(e){return Math.abs(Object(r.s)(e.Start,e.End))>1}t.d(n,"d",(function(){return c})),t.d(n,"c",(function(){return l})),t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return i})),t.d(n,"e",(function(){return u})),t.d(n,"g",(function(){return f})),t.d(n,"f",(function(){return m}))},1907:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"d",(function(){return i})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c}));var a=t(1817);function r(e){var n;let t=!1;return e.DisplayName&&(t=(null===(n=o(e.DisplayName))||void 0===n?void 0:n.length)>0),!Object(a.r)(e.PostalAddress)&&t}function i(e){return function(){const n=/^http*/i.test(e)?e:"//"+e;window.open(n,"_blank")}}function o(e){var n;return null===(n=e.match(/\S+/g))||void 0===n?void 0:n.filter(e=>c(e))}function c(e){return/^((http[s]?:\/\/)|(www\.)?){1}[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}\b([-a-zA-Z0-9@:*%_\+.~#?&//=]*)/i.test(e)}},1909:function(e,n,t){"use strict";var a=t(561),r=t(1690),i=t(6),o=t(3396),c=t(7),d=t(1883),l=t(3397),s=t(1935);function u(e,n){const t=[];return e.IsDraft&&t.push(Object(i.b)(l.a)),e.Subject?t.push(e.Subject):n||t.push(Object(i.b)(l.b)),t.join(" ")}function f(e){return e.Location?Object(s.d)(e.Location.DisplayName,e.Location.PostalAddress):""}function m(e,n,t,l,s){const m=[];m.push(function(e,n,t,l,s){const f=u(e),m=Object(d.e)(e),b=p(e.Start,e.End,n,e.IsAllDayEvent,m,!0,l,s),v=function(e,n,t){if(Object(r.g)(e)||Object(r.g)(n))return o.h;return t?o.g:""}(e.Start,e.End,t);let O=Object(i.b)(o.b);e.IsAllDayEvent&&m&&Object(c.w)(e.End,e.Start)==a.a.MillisecondsInOneDay?O=Object(i.b)(o.i):e.IsAllDayEvent&&m&&(O=Object(i.b)(o.a));return Object(i.c)(O,b,f,v)}(e,n,t,l,s));const b=f(e);return b&&m.push(Object(i.c)(Object(i.b)(o.c),b)),e.Organizer&&e.IsMeeting&&m.push(Object(i.c)(Object(i.b)(o.d),e.Organizer.Mailbox.Name)),"Occurrence"===e.CalendarItemType&&m.push(Object(i.b)(o.f)),"Private"===e.Sensitivity&&m.push(Object(i.b)(o.e)),m.join(" ")}function b(e,n){const t=[],a=u(e);a&&t.push(a);const r=f(e);r&&t.push(r);const i=Object(d.e)(e),o=p(e.Start,e.End,n,e.IsAllDayEvent,i,!1);return t.push(o),t.join("\n")}function v(e,n){const t=f(e),a=b(e);return t?a+" "+t:a}function p(e,n,t,r,l,s,u,f){const m=!!((null==u?void 0:u.length)>0&&f);if(m&&(s=!0),t&&(e=Object(c.Vb)(t,e),n=Object(c.Vb)(t,n)),function(e,n,t){return Object(c.Nb)(e,n)&&!(null==t?void 0:t.some(t=>!Object(c.Nb)(e,Object(c.Vb)(t,n))))&&!(null==t?void 0:t.some(t=>!Object(c.Nb)(Object(c.Vb)(t,e),n)))}(e,n,u))return[Object(i.c)(Object(i.b)(o.n),s?Object(c.gb)(e):"",Object(c.ab)(e),Object(c.ab)(n)),...m?u.map(t=>(function(e,n,t){return Object(i.c)(Object(i.b)(o.m),t,Object(c.gb)(e),Object(c.ab)(e),Object(c.ab)(n))})(Object(c.Vb)(t,e),Object(c.Vb)(t,n),f(t))):[]].join(", ").replace("  "," ");if(r&&l){if(Object(c.w)(n,e)==a.a.MillisecondsInOneDay)return Object(c.gb)(e);const t=Object(c.gb)(Object(d.a)({start:e,end:n}).end);return Object(i.c)(Object(i.b)(o.k),Object(c.gb)(e),t)}return[Object(i.c)(Object(i.b)(o.l),Object(c.gb)(e),Object(c.ab)(e),Object(c.gb)(n),Object(c.ab)(n)),...m?u.map(t=>(function(e,n,t){return Object(i.c)(Object(i.b)(o.j),t,Object(c.gb)(e),Object(c.ab)(e),Object(c.gb)(n),Object(c.ab)(n))})(Object(c.Vb)(t,e),Object(c.Vb)(t,n),f(t))):[]].join(", ")}t.d(n,"a",(function(){return m})),t.d(n,"d",(function(){return b})),t.d(n,"e",(function(){return v})),t.d(n,"b",(function(){return f})),t.d(n,"c",(function(){return u}))},1911:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(2011);function r(e){return Object(a.a)(e)&&"Resource"===e.LocationSource}},1929:function(e,n,t){"use strict";var a=t(2205),r=t(1715),i=t(1736),o=t(71),c=t(145),d=t(1695),l=t(1781),s=t(2216),u=t(2836),f=t(47),m=function(e){Object(f.j)("cal-notificationDiagnostics")&&setTimeout(()=>Object(u.a)(e),0)},b=t(1790),v=t(561),p=t(1716),O=t(1761),I=t(2206),j=t(1714),k=t(2037),y=t(2215);const g=864e5;t.d(n,"c",(function(){return w})),t.d(n,"e",(function(){return T})),t.d(n,"a",(function(){return L})),t.d(n,"d",(function(){return U})),t.d(n,"b",(function(){return V}));const h={RowAdded:"RowAdded",RowModified:"RowModified",RowDeleted:"RowDeleted",Reload:"Reload"},S=2e3;let E,_={},F={},N=[],C=!0,A=!0;function w(e,n){if(A&&(Object(y.b)(k.a,"RELOAD_CALENDAR_SUBSCRIPTIONS",g),A=!1),_[e])return _[e].locks[n]=!0,void m({message:"Already subscribed to calendar item notifications for folder",folderId:e});const t=Object(c.n)(e);if(!t)return void m({message:"Calendar entry not found to subscribe to notifications for folder",folderId:e});const a=Object(c.G)(t);if(a){const t=Object(f.j)("cal-surface-declinedMeetings");O.b.import().then(r=>{const i=Object.assign(Object.assign({},a),{ChannelId:r(),NotificationType:"CalendarItemNotification",IncludeDeclinedMeetings:t}),o={subscriptionId:`${i.NotificationType}${e}`+(t?"declinedMeetings":""),requiresExplicitSubscribe:!0,subscriptionParameters:i},c={folderId:e,subscription:o,locks:{[n]:!0}};m({message:`Subscribing to calendar item notifications for folder with includeDeclinedMeetings = ${t}`,folderId:e}),O.j.importAndExecute(o,R),_[e]=c})}}function T(e){const n=_[e];n?(m({message:"Unsubscribing from calendar item notifications for folder",folderId:e}),O.k.importAndExecute(n.subscription,R),delete _[e]):m({message:"Could not unsubscribe calendar item notifications for folder due to subscription data not found",folderId:e})}function R(e){D(e,!0),function(e){if(N.some(e=>M(e.NotificationPayload)))m({message:"A reload notification is in the queue. No additional notifications will be added",notificationPayload:e.NotificationPayload});else if(M(e.NotificationPayload))m({message:"A reload notification will be enqueued. All existing notifications will be discarded.",notificationPayload:e.NotificationPayload}),N=[],N[0]=e;else{for(let n=N.length-1;n>=0;n--){let t,a,r,i=N[n].NotificationPayload.Item;if(null!=e.NotificationPayload.Item.InstanceKey?(a=e.NotificationPayload.Item.InstanceKey,t=i.InstanceKey,r="InstanceKey"):(a=e.NotificationPayload.Item.ItemId.Id,t=i.ItemId.Id,r="ItemId"),a===t){m({message:`Found an existing notification in the queue for the same ${r}. Old notification will be removed.`,notificationPayload:e.NotificationPayload}),N[n].InstanceKeyToDelete&&(e.InstanceKeyToDelete=N[n].InstanceKeyToDelete),N.splice(n,1);break}}let n=!1;if(null!=e.NotificationPayload.Item.InstanceKey)if(e.NotificationPayload.EventType==h.RowModified&&Object(d.J)(e.NotificationPayload.Item.CalendarItemType)&&null!=e.NotificationPayload.Item.UID&&(F[e.NotificationPayload.Item.InstanceKey]=e.NotificationPayload.Item.UID),e.NotificationPayload.EventType===h.RowAdded||e.NotificationPayload.EventType===h.RowModified){for(let n=N.length-1;n>=0;n--)if(N[n].NotificationPayload.EventType===h.RowDeleted&&N[n].OriginalUID==e.NotificationPayload.Item.UID){m({message:"Found an existing RowDeleted notification in the queue for the same UID, which will be removed from the queue.",notificationPayload:e.NotificationPayload}),e.InstanceKeyToDelete=N[n].NotificationPayload.Item.InstanceKey,N.splice(n,1);break}}else if(e.NotificationPayload.EventType===h.RowDeleted){let t=F[e.NotificationPayload.Item.InstanceKey];if(delete F[e.NotificationPayload.Item.InstanceKey],t){e.OriginalUID=t;for(let a=N.length-1;a>=0;a--){let r=N[a].NotificationPayload.Item.UID;if((N[a].NotificationPayload.EventType===h.RowAdded||N[a].NotificationPayload.EventType===h.RowModified)&&r==t){m({message:"Found an existing RowAdded or RowModified notification in the queue for the same UID, which will be merged with the RowDelete.",notificationPayload:e.NotificationPayload}),N[a].InstanceKeyToDelete=e.NotificationPayload.Item.InstanceKey,n=!0;break}}}}n?m({message:"RowDeleted notification was merged with a RowAdded notification for the same UID and will not be enqueued",notificationPayload:e.NotificationPayload}):(m({message:"Notification will be enqueued",notificationPayload:e.NotificationPayload}),N.push(e))}m({message:`Notification queue length is ${N.length}`})}({NotificationPayload:e,InstanceKeyToDelete:null,OriginalUID:null}),C?(E&&(m({message:"Notification processing timer was already started. It will be cancelled and restarted."}),clearTimeout(E)),E=setTimeout(P,S),m({message:"Timer to drain queue has started"})):m({message:"The notification was received while notification processing was suspended"})}function x(e){var n,t;if(D(e.NotificationPayload,!1),M(e.NotificationPayload))L();else{let a=e.NotificationPayload.FolderId;const r=null===(n=e.NotificationPayload.Item)||void 0===n?void 0:n.SkypeTeamsProperties;Object(f.j)("cal-showAddTeamsCalendars")&&r&&!Object(c.n)(a)&&(a=function(e,n){let t=JSON.parse(n);if(null==t?void 0:t.cid){const n=t.cid.split("@")[0];e=n?Object(c.U)(e,n):e}return e}(a,r),(null===(t=e.NotificationPayload.Item)||void 0===t?void 0:t.ParentFolderId)&&(e.NotificationPayload.Item.ParentFolderId.Id=a));const o=Object(j.i)(a),u=Object(j.d)(a),b=Object(j.e)(a),O=Object(c.n)(a),k=Object(c.B)(a);O&&3==O.CalendarFolderType?L(a):o&&(u.length>0||Object.keys(b).length>0)?e.NotificationPayload.EventType==h.RowDeleted?function(e,n){let t=n.Item.InstanceKey;const a=Object(i.c)(t,e);a?(m({message:`Removing event from cache ${a}`,folderId:e,notificationPayload:n,notificationItem:a}),Object(p.q)(e,t)):m({message:`Could not find event with instance key ${t} in the cache to remove`,folderId:e,notificationPayload:n})}(a,e.NotificationPayload):Object(d.J)(e.NotificationPayload.Item.CalendarItemType)?function(e,n,t){const a=Object(l.a)(t.NotificationPayload.Item,n);if(a.UID){G(e).forEach(r=>{const i=Object(s.a)(a.ItemId,r,"Notification");i.then(o=>{o&&"Success"==o.ResponseClass?function(e,n,t,a,r,i,o){if(m({message:`Action to expand series completed successfully. Retrieved ${r?r.length:0} items for dates: ${t.start.toString()} - ${t.end.toString()} `,folderId:a,notificationItem:e}),G(a).some(e=>Object(v.b)(t,e))){m({message:"Updating all cached items for the series and removing nonexistant ones",folderId:a});const n=[];r&&n.push(...r),i&&n.push(i);const c=n.map(e=>e.UID),d=e=>!(c.includes(e.UID)&&e.IsRecurring);B(t,e.ItemId.Id,e.InstanceKey,o,a,d),Object(p.u)(i),Object(p.a)(a,r),r.forEach(e=>{Object(p.u)(e)})}else m({message:"Range in the cache is different from what we originally requested - reloading cache",folderId:a}),Object(I.b)(a,!0)}(a,0,r,e,o.Occurrences.map(e=>Object(l.a)(e,n)),Object(l.a)(o.RecurrenceMaster,n),t.InstanceKeyToDelete):z(a,i,r,e,t.InstanceKeyToDelete,o)}).catch(n=>{z(a,i,r,e,t.InstanceKeyToDelete,null,n.message)})})}}(a,k,e):function(e,n,t){let a=Object(l.a)(t.Item,n),r=!1;switch(t.EventType){case h.RowAdded:r=!0;break;case h.RowModified:r=null==a.InstanceKey||Object(d.G)(a.CalendarItemType)||Object(d.y)(a.CalendarItemType)}Object(I.a)(a,r,!1,!0)}(0,k,e.NotificationPayload):m({message:o?"Events cache was empty for folder":"Events cache has not been loaded for folder yet",folderId:e.NotificationPayload.FolderId,notificationPayload:e.NotificationPayload})}}function P(){let e=N.length;if(e>=8||N.some(e=>M(e.NotificationPayload)))L();else for(let n=0;n<e;n++){x(N[n])}N=[],F={},clearTimeout(E)}function D(e,n){var t;let a=(null===(t=e.Item)||void 0===t?void 0:t.ItemId)?e.Item.ItemId.Id:"<null>";if(m({message:`${n?"Got calendar notification":"Processing calendar notification"} for event type ${e.EventType}`,folderId:e.FolderId,notificationPayload:e}),n){let n=e.Item?e.Item.CalendarItemType:"<null>";Object(o.o)("IncomingNotification",{NotificationType:e.EventType,ItemType:n,ItemId:a},{excludeFromKusto:!0,isVerbose:!0})}}function M(e){return e.EventType==h.Reload||e.Reload}function L(e){let n=e?[e]:Object.keys(_);for(let e of n)Object(I.b)(e,!0)}function z(e,n,t,a,r,i,o=null){if(i&&"ErrorItemNotFound"==i.ResponseCode)m({message:"Action to expand recurring series failed with item not found because item is not on the server. Removing series.",folderId:a,notificationItem:e}),B(t,e.ItemId.Id,e.InstanceKey,r,a);else{const n=i?`${i.ResponseCode}: ${i.MessageText}`:o;m({message:"Action to expand recurring series failed for unknown reason, reloading cache",folderId:a,notificationItem:e,errorMessage:n}),Object(I.b)(a,!0)}}function B(e,n,t,a,o,c){const d=r=>{var i;const o={start:r.Start,end:r.End},d=0==Object(v.j)(e,o,!0),l=r.InstanceKey==t||a&&r.InstanceKey==a||n&&n===(null===(i=r.SeriesMasterItemId)||void 0===i?void 0:i.Id);return d&&(Object(b.c)(r)||l&&(!c||c(r)))};Object(p.r)(o,d);const l=Object(i.a)(o,d);Object(r.d)(l)}function U(){C&&(clearTimeout(E),m({message:"Processing of notifications will be suspended"}),C=!1)}function V(){C||(C=!0,m({message:"Processing of notifications will be resumed"}),E=setTimeout(P,S))}function G(e){const n=Object(j.d)(e);return Object(a.a)(n)}},1935:function(e,n,t){"use strict";var a=t(6),r=t(703);const i="en-us",o={"am-et":"a_c_pc_pr_ctry","ar-dz":"a_pc_c_pr_ctry","ar-bh":"a_pc_c_pr_ctry","ar-eg":"a_ctry_c_pr_pc","ar-iq":"a_pc_c_pr_ctry","ar-jo":"a_c_pc_pr_ctry","ar-kw":"a_pc_c_pr_ctry","ar-lb":"a_c_pc_pr_ctry","ar-ly":"a_pc_c_pr_ctry","ar-ma":"a_pc_c_pr_ctry","ar-om":"a_c_pr_ctry_pc","ar-qa":"a_pc_c_pr_ctry","ar-sa":"a_c_pc_pr_ctry","ar-sy":"a_pc_c_pr_ctry","ar-tn":"a_pc_c_pr_ctry","ar-ae":"a_pc_c_pr_ctry","ar-ye":"a_pc_c_pr_ctry","eu-es":"a_pc_c_pr_ctry","bn-in":"a_c_pc_pr_ctry","bg-bg":"a_pc_c_pr_ctry","ca-es":"a_pc_c_pr_ctry","zh-cn":"pc_ctry_pr_c_a","zh-sg":"a_c_pc_pr_ctry","zh-hk":"ctry_pc_pr_c_a","zh-mo":"ctry_pr_c_pc_a","zh-tw":"pc_ctry_pr_c_a","hr-hr":"a_pc_c_pr_ctry","cs-cz":"a_pc_c_pr_ctry","da-dk":"a_pc_c_pr_ctry","nl-be":"a_pc_c_pr_ctry","nl-nl":"a_pc_c_pr_ctry","en-au":"a_c_pc_pr_ctry","en-bz":"a_pc_c_pr_ctry","en-ca":"a_c_pc_pr_ctry","en-ie":"a_c_pc_pr_ctry","en-jm":"a_pc_c_pr_ctry","en-nz":"a_c_pc_pr_ctry","en-ph":"a_pc_pr_c_ctry","en-za":"a_c_pc_pr_ctry","en-tt":"a_pc_c_pr_ctry","en-gb":"a_c_pc_pr_ctry","en-us":"a_c_pr_pc_ctry","en-zw":"a_pc_c_pr_ctry","et-ee":"a_pc_c_pr_ctry","fil-ph":"a_pc_pr_c_ctry","fi-fi":"a_pc_c_pr_ctry","fr-be":"a_pc_c_pr_ctry","fr-ca":"a_c_pc_pr_ctry","fr-fr":"a_pc_c_pr_ctry","fr-lu":"a_pc_c_pr_ctry","fr-mc":"a_pc_c_pr_ctry","fr-ch":"a_pc_c_pr_ctry","gl-es":"a_pc_c_pr_ctry","de-at":"a_pc_c_pr_ctry","de-de":"a_pc_c_pr_ctry","de-li":"a_pc_c_pr_ctry","de-lu":"a_pc_c_pr_ctry","de-ch":"a_pc_c_pr_ctry","el-gr":"a_pc_c_pr_ctry","gu-in":"a_c_pc_pr_ctry","he-il":"a_pc_c_pr_ctry","hi-in":"a_c_pc_pr_ctry","hu-hu":"c_a_pc_pr_ctry","is-is":"a_pc_c_pr_ctry","id-id":"a_c_pc_pr_ctry","it-it":"a_pc_c_pr_ctry","it-ch":"a_pc_c_pr_ctry","ja-jp":"pc_pr_c_a_ctry","kn-in":"a_c_pc_pr_ctry","kk-kz":"ctry_pr_c_pc_a","ko-kr":"pc_pr_c_a_ctry","lv-lv":"a_c_pc_pr_ctry","lt-lt":"a_c_pc_pr_ctry","ms-bn":"a_c_pc_pr_ctry","ms-my":"a_pc_c_pr_ctry","ml-in":"a_c_pc_pr_ctry","mr-in":"a_c_pc_pr_ctry","nb-no":"a_pc_c_pr_ctry","or-in":"a_c_pc_pr_ctry","fa-ir":"a_c_pc_pr_ctry","pl-pl":"a_pc_c_pr_ctry","pt-br":"a_pc_c_pr_ctry","pt-pt":"a_pc_c_pr_ctry","ro-ro":"a_pc_c_pr_ctry","ru-ru":"ctry_pc_pr_c_a","sr-cyrl-cs":"a_pc_c_pr_ctry","sk-sk":"a_pc_c_pr_ctry","sl-si":"a_pc_c_pr_ctry","es-ar":"a_pc_c_pr_ctry","es-bo":"a_pc_c_pr_ctry","es-cl":"a_pc_c_pr_ctry","es-co":"a_pc_c_pr_ctry","es-cr":"a_pc_c_pr_ctry","es-do":"a_pc_c_pr_ctry","es-ec":"a_pc_c_pr_ctry","es-sv":"a_c_pc_pr_ctry","es-gt":"a_pc_c_pr_ctry","es-hn":"a_pc_c_pr_ctry","es-mx":"a_pc_c_pr_ctry","es-ni":"a_c_pc_pr_ctry","es-pa":"a_pc_c_pr_ctry","es-py":"a_pc_c_pr_ctry","es-pe":"a_pc_c_pr_ctry","es-pr":"a_c_pc_pr_ctry","es-es":"a_pc_c_pr_ctry","es-us":"a_c_pc_pr_ctry","es-uy":"a_pc_c_pr_ctry","es-ve":"a_pc_c_pr_ctry","sv-fi":"a_pc_c_pr_ctry","sv-se":"a_pc_c_pr_ctry","ta-in":"a_c_pc_pr_ctry","te-in":"a_c_pc_pr_ctry","th-th":"a_c_pc_pr_ctry","tr-tr":"a_pc_pr_c_ctry","uk-ua":"ctry_pc_pr_c_a","ur-pk":"a_c_pc_pr_ctry","cy-gb":"a_c_pc_pr_ctry"};const c=", ";function d(e,n,t,a,i,o){let c=[];Object(r.a)(e)||(c[c.length]=e);let d="";return Object(r.a)(n)||(d=n),Object(r.a)(t)||(d=Object(r.a)(d)?t:d+o+t),Object(r.a)(a)||(d=Object(r.a)(d)?a:d+o+a),Object(r.a)(d)||(c[c.length]=d),Object(r.a)(i)||(c[c.length]=i),c}function l(e,n,t,l,s){let u="",f=function(){let e="";Object(r.a)(Object(a.e)())||(e=Object(a.e)());let n=o[e];return null==n&&(n=o[i]),n}(),m=[],b=c;switch(f){case"a_c_pc_pr_ctry":m=d(e,n,t,l,s,b);break;case"a_c_pr_ctry_pc":m=d(e,n,l,s,t,b);break;case"a_c_pr_pc_ctry":m=d(e,n,l,t,s,b);break;case"a_ctry_c_pr_pc":m=d(e,s,n,l,t,b);break;case"a_pc_c_pr_ctry":m=d(e,t,n,l,s,b);break;case"a_pc_pr_c_ctry":m=d(e,t,l,n,s,b);break;case"c_a_pc_pr_ctry":m=d(n,e,t,l,s,b);break;case"ctry_pc_pr_c_a":m=d(s,t,l,n,e,b);break;case"ctry_pr_c_pc_a":m=d(s,l,n,t,e,b);break;case"pc_ctry_pr_c_a":m=d(t,s,l,n,e,b);break;case"pc_pr_c_a_ctry":m=d(t,l,n,e,s,b)}return u=m.join(b),u}function s(e){return e?l(e.Street,e.City,e.PostalCode,e.State,e.Country):""}function u(e,n){return Object(r.a)(e)?s(n):e}function f(e,n,t){const i=s(n);return Object(r.a)(e)?i:""==i||t?e:Object(a.c)("{0} ({1})",e,i)}t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return l})),t.d(n,"c",(function(){return u})),t.d(n,"d",(function(){return f}))},1975:function(e,n,t){"use strict";t.d(n,"e",(function(){return"{id}"})),t.d(n,"f",(function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAEALAAAAAABAAEAAAIBTAA7"})),t.d(n,"a",(function(){return"data-custom"})),t.d(n,"c",(function(){return"originalsrc"})),t.d(n,"b",(function(){return"data-loadstatus"})),t.d(n,"d",(function(){return"pending"}))},1997:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(47);function r(){return Object(a.j)("cal-cmp-fluidCollaborativeSpace")||Object(a.j)("cal-fluid-collabSpaceRead")}},2011:function(e,n,t){"use strict";function a(e){return!!e&&(!!e.LocationUri||!(!e.Latitude||!e.Longitude))}t.d(n,"a",(function(){return a}))},2033:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return r})),t.d(n,"c",(function(){return i}));const a=110,r=3,i=1},2034:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i}));var a=t(2165);function r(e,n=!1){return n?i(e):Object(a.c)(e)}function i(e){var n;return null===(n=e.SeriesMasterItemId)||void 0===n?void 0:n.Id}},2037:function(e,n,t){"use strict";var a=t(1714),r=t(2217);var i=t(2471);function o(){return Object(i.a)(),async function(){const e=Object(a.b)();await Promise.all(e.map(e=>Object(r.a)(e,!0)))}()}t.d(n,"a",(function(){return o}))},2040:function(e,n,t){"use strict";var a=t(7);n.a=e=>e.IsAllDayEvent||Object(a.u)(e.End,e.Start)>0},2045:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(1725),r=[a.a.lightBlue,a.a.blue,a.a.darkBlue,a.a.teal,a.a.green,a.a.darkGreen,a.a.lightPink,a.a.pink,a.a.magenta,a.a.purple,a.a.orange,a.a.lightRed,a.a.darkRed,a.a.violet,a.a.gold,a.a.burgundy,a.a.warmGray,a.a.cyan,a.a.rust,a.a.coolGray],i=r.length;function o(e){var n=e.primaryText,t=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case a.a.lightBlue:return"#4F6BED";case a.a.blue:return"#0078D4";case a.a.darkBlue:return"#004E8C";case a.a.teal:return"#038387";case a.a.lightGreen:case a.a.green:return"#498205";case a.a.darkGreen:return"#0B6A0B";case a.a.lightPink:return"#C239B3";case a.a.pink:return"#E3008C";case a.a.magenta:return"#881798";case a.a.purple:return"#5C2E91";case a.a.orange:return"#CA5010";case a.a.red:return"#EE1111";case a.a.lightRed:return"#D13438";case a.a.darkRed:return"#A4262C";case a.a.transparent:return"transparent";case a.a.violet:return"#8764B8";case a.a.gold:return"#986F0B";case a.a.burgundy:return"#750B1C";case a.a.warmGray:return"#7A7574";case a.a.cyan:return"#005B70";case a.a.rust:return"#8E562E";case a.a.coolGray:return"#69797E";case a.a.black:return"#1D1D1D";case a.a.gray:return"#393939"}}(o=void 0!==o?o:function(e){var n=a.a.blue;if(!e)return n;for(var t=0,o=e.length-1;o>=0;o--){var c=e.charCodeAt(o),d=o%8;t^=(c<<d)+(c>>8-d)}return n=r[t%i]}(t||n))}},2046:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(20),r=t(2085);t.d(n,"d",(function(){return r.c})),t.d(n,"c",(function(){return r.b})),t.d(n,"b",(function(){return r.a}));const i=new a.c(()=>Promise.all([t.e(22),t.e(25),t.e(50),t.e(640)]).then(t.bind(null,4742))),o=Object(a.d)(i,e=>e.JoinOnlineMeetingButton)},2064:function(e,n,t){"use strict";var a=t(22),r=t(2203),i=t(2040),o=t(7),c=t(145);function d(e){return e.ParentFolderId&&e.ParentFolderId.Id===Object(c.j)()}function l(e){if(!e.ParentFolderId)return!1;const n=Object(c.z)(),t=Object(c.n)(e.ParentFolderId.Id);return(null==t?void 0:t.ParentGroupId)===(null==n?void 0:n.ParentGroupId)}function s(e,n){let t=Object(i.a)(e);if(t!=Object(i.a)(n))return t?-1:1;let a=f(n)-f(e);if(0!=a)return a;if(a=Object(o.w)(e.Start,n.Start),0!=a)return a;if(m(e)&&m(n)){let t=d(e);if(t!=d(n))return t?-1:1;let a=l(e);if(a!=l(n))return a?-1:1}return a=Object(r.a)(e,n),0!=a?a:(a=Object(o.w)(n.End,e.End),0!=a?a:(a=u(e.Subject,n.Subject),0!=a?a:(a=u(e.CalendarItemType,n.CalendarItemType),0!=a?a:(a=u(e.ParentFolderId.Id,n.ParentFolderId.Id),0!=a?a:u(e.ItemId.Id,n.ItemId.Id)))))}function u(e,n){return(e||"").localeCompare(n||"")}function f(e){let n=Object(o.w)(e.End,e.Start);return Math.max(Math.ceil(n/a.e),1)}function m(e){return"Booking"!=e.__type&&"AnonymousCalendarEvent"!=e.__type}t.d(n,"a",(function(){return s}))},2084:function(e,n,t){"use strict";t.d(n,"a",(function(){return a})),t.d(n,"d",(function(){return r})),t.d(n,"e",(function(){return i})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return c})),t.d(n,"f",(function(){return d})),t.d(n,"g",(function(){return l})),t.d(n,"h",(function(){return s})),t.d(n,"i",(function(){return u}));const a=2,r=4,i=8,o=32,c=64,d=128,l=4294967296,s=8589934592,u=17179869184},2085:function(e,n,t){"use strict";t.d(n,"c",(function(){return c})),t.d(n,"b",(function(){return d})),t.d(n,"a",(function(){return l}));var a=t(561),r=t(1690),i=t(7);const o=5;function c(e,n){return n?!e.IsCancelled&&null!=e.IsOnlineMeeting&&e.IsOnlineMeeting&&null!=e.OnlineMeetingJoinUrl&&""!=e.OnlineMeetingJoinUrl:!e.IsCancelled&&e.IsOnlineMeeting}function d(e){return l(e.Start,e.End)&&c(e,!0)}function l(e,n){return Object(a.u)(Object(r.h)(),Object(i.jc)(e,o),n)}},2105:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(1686),r=t(57);function i(){let e=!0;if(Object(r.r)()){const n=Object(a.g)(a.d.ExternalImages);e=null===n.externalImagesSelectedOption||0===n.externalImagesSelectedOption}else{const n=Object(r.g)().PolicySettings;e=void 0===n.ExternalImageProxyEnabled||n.ExternalImageProxyEnabled}return e}},2120:function(e,n,t){"use strict";var a=t(248);function r(e,n){return!e.some(e=>{var t,r;return e&&n&&(null===(t=Object(a.j)(e))||void 0===t?void 0:t.Id)===(null===(r=Object(a.j)(n))||void 0===r?void 0:r.Id)})}function i(e,n){return e.indexOf(n)<0}function o(e,n=i){if(!e)return[];const t=[];return e&&e.forEach(e=>{n(t,e)&&t.push(e)}),t}var c=t(16);function d(e,n=i){if(!e)return e;const t=new c.ObservableMap;return e.forEach((e,a)=>{t.set(a,o(e,n))}),t}function l(e,n=i){if(!e)return[];const t=[];return e.forEach(e=>{e&&e.forEach(e=>{n(t,e)&&t.push(e)})}),t}t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return d})),t.d(n,"d",(function(){return l}))},2131:function(e,n,t){"use strict";function a(){return{__type:void 0,ItemId:void 0,ParentFolderId:void 0,Subject:void 0,ReminderIsSet:void 0,ReminderMinutesBeforeStart:void 0,LastModifiedTime:void 0,InstanceKey:void 0,Preview:void 0,EffectiveRights:void 0,HasAttachments:void 0,HasBlockedImages:void 0,Attachments:void 0,Sensitivity:void 0,Body:void 0,EntityNamesMap:void 0,TailoredXpEntities:void 0,IsDraft:void 0,Categories:void 0,Start:void 0,End:void 0,IsAllDayEvent:void 0,IsRoomRequested:void 0,AutoRoomBookingStatus:void 0,FreeBusyType:void 0,IsMeeting:void 0,IsCancelled:void 0,IsRecurring:void 0,IsResponseRequested:void 0,CalendarItemType:void 0,ResponseType:void 0,Organizer:void 0,RequiredAttendees:void 0,OptionalAttendees:void 0,Resources:void 0,AppointmentReplyTime:void 0,Recurrence:void 0,Location:void 0,IntendedFreeBusyStatus:void 0,IsOrganizer:void 0,AppointmentReplyName:void 0,IsSeriesCancelled:void 0,CharmId:void 0,Locations:void 0,ClientSeriesId:void 0,UID:void 0,SeriesId:void 0,ExperienceType:void 0,DoNotForwardMeeting:void 0,IsOnlineMeeting:void 0,JoinOnlineMeetingUrl:void 0,InboxReminders:void 0,MeetingRequestWasSent:void 0,ExtractionSourceId:void 0,StartTimeZoneId:void 0,EndTimeZoneId:void 0,OnlineMeetingProvider:void 0,OnlineMeetingJoinUrl:void 0,OnlineMeetingConferenceId:void 0,OnlineMeetingTollNumber:void 0,OnlineMeetingTollFreeNumbers:void 0,SeriesMasterItemId:void 0,ExtractionSourceInternetMessageId:void 0,HideAttendees:void 0,PersonId:void 0,InReplyTo:void 0,IsFreeBusyOnly:void 0,ConversationId:void 0,SkypeTeamsProperties:void 0,DocLinks:void 0,DateTimeCreated:void 0,AppendOnSend:void 0,IsBookedFreeBlocks:void 0,AssociatedTasks:void 0,CollabSpace:void 0,TravelTimeEventsLinked:void 0,FlexEventsMetadata:void 0}}t.d(n,"a",(function(){return a}))},2155:function(e,n,t){"use strict";var a=t(925),r=t(712),i=t(915),o=t(927),c=Object.getOwnPropertySymbols?function(e){for(var n=[];e;)Object(a.a)(n,Object(i.a)(e)),e=Object(r.a)(e);return n}:o.a;n.a=c},2165:function(e,n,t){"use strict";var a=t(2064),r=t(2203),i=(t(2204),t(7));var o=t(2248),c=(e,n)=>Object(i.Cb)(e.Start)<Object(i.Cb)(n.End)&&Object(i.Cb)(e.End)>Object(i.Cb)(n.Start),d=(e,n)=>n.filter(n=>n!=e&&c(e,n)).sort(a.a);function l(e,n){e.Start=n.Start,e.ItemId=n.ItemId,e.End=n.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=function({StartTimeZoneId:e,Start:n}){const t=Object(i.Vb)(e,n),a=Object(i.bc)(t);return Object(i.wb)(a)}(n)}var s=t(2040);function u(e){e.Start=Object(i.Vb)(e.StartTimeZoneId,e.Start),e.End=Object(i.Vb)(e.EndTimeZoneId,e.End)}t.d(n,"a",(function(){return a.a})),t.d(n,"b",(function(){return r.a})),t.d(n,"c",(function(){return o.a})),t.d(n,"d",(function(){return d})),t.d(n,"e",(function(){return l})),t.d(n,"f",(function(){return c})),t.d(n,"g",(function(){return s.a})),t.d(n,"h",(function(){return u}))},2175:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"e",(function(){return i})),t.d(n,"i",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return d})),t.d(n,"f",(function(){return l})),t.d(n,"g",(function(){return s})),t.d(n,"d",(function(){return u})),t.d(n,"h",(function(){return f}));var a=t(1910);function r(e){return e?u(e)?a.e:f(e)?a.F:l(e)?a.v:c(e)?a.a:s(e)?a.x:d(e)?a.c:a.s:a.s}function i(e){return c(e)||l(e)}function o(e){return d(e)||s(e)}function c(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.b}function d(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.d}function l(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.w}function s(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.y}function u(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.f}function f(e){return(null==e?void 0:e.RecurrencePattern)&&e.RecurrencePattern.__type==a.G}},2200:function(e,n,t){"use strict";var a=t(2941),r=t(2942),i=t(145),o=t(1714),c=t(1781),d=t(705),l=t(47),s=t(2468),u=t(2402),f=t(2868);const m={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"FullCalendarEventFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PartialCalendarEventFragment"}},{kind:"Field",name:{kind:"Name",value:"Body"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"BodyType"}},{kind:"Field",name:{kind:"Name",value:"Value"}},{kind:"Field",name:{kind:"Name",value:"QuotedText"}},{kind:"Field",name:{kind:"Name",value:"IsTruncated"}},{kind:"Field",name:{kind:"Name",value:"UTF8BodySize"}},{kind:"Field",name:{kind:"Name",value:"BodyFragmentInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartOffset"}},{kind:"Field",name:{kind:"Name",value:"EndOffset"}}]}},{kind:"Field",name:{kind:"Name",value:"DataUriCount"}},{kind:"Field",name:{kind:"Name",value:"CustomDataUriCount"}}]}},{kind:"Field",name:{kind:"Name",value:"ConversationId"}},{kind:"Field",name:{kind:"Name",value:"DocLinks"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"ProviderType"}},{kind:"Field",name:{kind:"Name",value:"Url"}},{kind:"Field",name:{kind:"Name",value:"PermissionType"}}]}},{kind:"Field",name:{kind:"Name",value:"EffectiveRights"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateAssociated"}},{kind:"Field",name:{kind:"Name",value:"CreateContents"}},{kind:"Field",name:{kind:"Name",value:"CreateHierarchy"}},{kind:"Field",name:{kind:"Name",value:"Delete"}},{kind:"Field",name:{kind:"Name",value:"Modify"}},{kind:"Field",name:{kind:"Name",value:"Read"}},{kind:"Field",name:{kind:"Name",value:"ViewPrivateItems"}}]}},{kind:"Field",name:{kind:"Name",value:"EntityNamesMap"}},{kind:"Field",name:{kind:"Name",value:"HasBlockedImages"}},{kind:"Field",name:{kind:"Name",value:"InReplyTo"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"TailoredXpEntities"}},{kind:"Field",name:{kind:"Name",value:"AppointmentReplyName"}},{kind:"Field",name:{kind:"Name",value:"AppointmentReplyTime"}},{kind:"Field",name:{kind:"Name",value:"AutoRoomBookingStatus"}},{kind:"Field",name:{kind:"Name",value:"ClientSeriesId"}},{kind:"Field",name:{kind:"Name",value:"DoNotForwardMeeting"}},{kind:"Field",name:{kind:"Name",value:"ExtractionSourceId"}},{kind:"Field",name:{kind:"Name",value:"InboxReminders"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"ReminderOffset"}},{kind:"Field",name:{kind:"Name",value:"Message"}},{kind:"Field",name:{kind:"Name",value:"IsOrganizerReminder"}},{kind:"Field",name:{kind:"Name",value:"OccurrenceChange"}},{kind:"Field",name:{kind:"Name",value:"IsImportedFromOLC"}},{kind:"Field",name:{kind:"Name",value:"SendOption"}}]}},{kind:"Field",name:{kind:"Name",value:"IntendedFreeBusyStatus"}},{kind:"Field",name:{kind:"Name",value:"IsRoomRequested"}},{kind:"Field",name:{kind:"Name",value:"JoinOnlineMeetingUrl"}},{kind:"Field",name:{kind:"Name",value:"Locations"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllEnhancedLocationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingProvider"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingConferenceId"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingTollNumber"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingTollFreeNumbers"}},{kind:"Field",name:{kind:"Name",value:"RequiredAttendees"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllAttendeeFields"}}]}},{kind:"Field",name:{kind:"Name",value:"OptionalAttendees"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllAttendeeFields"}}]}},{kind:"Field",name:{kind:"Name",value:"Resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllAttendeeFields"}}]}},{kind:"Field",name:{kind:"Name",value:"AppendOnSend"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"txt"}},{kind:"Field",name:{kind:"Name",value:"typ"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"CollabSpace"}},{kind:"Field",name:{kind:"Name",value:"FlexEventsMetadata"}},{kind:"Field",name:{kind:"Name",value:"IsBookedFreeBlocks"}},{kind:"Field",name:{kind:"Name",value:"TravelTimeEventsLinked"}},{kind:"Field",name:{kind:"Name",value:"PersonId"}},{kind:"Field",name:{kind:"Name",value:"Attachments"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BasicAttachment"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwsTypeName"}},{kind:"Field",name:{kind:"Name",value:"AttachmentId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"AttachmentIdToAttach"}},{kind:"Field",name:{kind:"Name",value:"AttachmentOriginalUrl"}},{kind:"Field",name:{kind:"Name",value:"Content"}},{kind:"Field",name:{kind:"Name",value:"ContentId"}},{kind:"Field",name:{kind:"Name",value:"ContentLocation"}},{kind:"Field",name:{kind:"Name",value:"ContentType"}},{kind:"Field",name:{kind:"Name",value:"CreateAttachmentInlineType"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"ImageThumbnailHeight"}},{kind:"Field",name:{kind:"Name",value:"ImageThumbnailSalientRegions"}},{kind:"Field",name:{kind:"Name",value:"ImageThumbnailWidth"}},{kind:"Field",name:{kind:"Name",value:"IsContactPhoto"}},{kind:"Field",name:{kind:"Name",value:"IsInline"}},{kind:"Field",name:{kind:"Name",value:"IsInlineToNormalBody"}},{kind:"Field",name:{kind:"Name",value:"IsInlineToUniqueBody"}},{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Size"}},{kind:"Field",name:{kind:"Name",value:"Thumbnail"}},{kind:"Field",name:{kind:"Name",value:"ThumbnailMimeType"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReferenceAttachment"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"OwsTypeName"}},{kind:"Field",name:{kind:"Name",value:"AttachmentId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"AttachmentIdToAttach"}},{kind:"Field",name:{kind:"Name",value:"AttachmentOriginalUrl"}},{kind:"Field",name:{kind:"Name",value:"Content"}},{kind:"Field",name:{kind:"Name",value:"ContentId"}},{kind:"Field",name:{kind:"Name",value:"ContentLocation"}},{kind:"Field",name:{kind:"Name",value:"ContentType"}},{kind:"Field",name:{kind:"Name",value:"CreateAttachmentInlineType"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"ImageThumbnailHeight"}},{kind:"Field",name:{kind:"Name",value:"ImageThumbnailSalientRegions"}},{kind:"Field",name:{kind:"Name",value:"ImageThumbnailWidth"}},{kind:"Field",name:{kind:"Name",value:"IsContactPhoto"}},{kind:"Field",name:{kind:"Name",value:"IsInline"}},{kind:"Field",name:{kind:"Name",value:"IsInlineToNormalBody"}},{kind:"Field",name:{kind:"Name",value:"IsInlineToUniqueBody"}},{kind:"Field",name:{kind:"Name",value:"ItemId"}},{kind:"Field",name:{kind:"Name",value:"LastModifiedTime"}},{kind:"Field",name:{kind:"Name",value:"Name"}},{kind:"Field",name:{kind:"Name",value:"Size"}},{kind:"Field",name:{kind:"Name",value:"Thumbnail"}},{kind:"Field",name:{kind:"Name",value:"ThumbnailMimeType"}},{kind:"Field",name:{kind:"Name",value:"ProviderType"}},{kind:"Field",name:{kind:"Name",value:"WebUrl"}},{kind:"Field",name:{kind:"Name",value:"AttachLongPathName"}},{kind:"Field",name:{kind:"Name",value:"AttachmentThumbnailUrl"}},{kind:"Field",name:{kind:"Name",value:"AttachmentPreviewUrl"}}]}}]}}]}},...s.a.definitions,...u.a.definitions,...f.a.definitions]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FullCalendarEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"EventRequestTypeParameters"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullCalendarEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FullCalendarEventFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"error"}},{kind:"Field",name:{kind:"Name",value:"responseCode"}}]}}]}},...m.definitions]},v={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"FullBirthdayCalendarEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BirthdayEventRequestTypeParameters"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fullBirthdayCalendarEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarEvent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"FullCalendarEventFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"error"}},{kind:"Field",name:{kind:"Name",value:"responseCode"}}]}}]}},...m.definitions]};var p=t(7),O=t(2469),I=t(248);async function j(e,n,t,s=!1){var u;const f=Object(i.n)(n),m=Object(I.n)(f)?null===(u=f)||void 0===u?void 0:u.OwnerEmailAddress:void 0;if(Object(l.j)("mon-cal-loadEventsViaGql"))return async function(e,n,t,a=!1,r){const c=Object(i.n)(n);if(c&&3==c.CalendarFolderType){const t=Object(o.h)(n),a=Object(d.a)(),r=await a.query({query:v,variables:{input:{id:e,parentFolderId:n,dateRange:{start:Object(p.vb)(t.start),end:Object(p.vb)(t.end)}}}});return Object.assign(Object.assign({},r.data.fullBirthdayCalendarEvent),{calendarEvent:Object(O.a)(r.data.fullBirthdayCalendarEvent.calendarEvent)})}{const o=Object(i.R)(c),l=Object(d.a)(),s=await l.query({query:b,variables:{input:{id:{mailboxInfo:e.mailboxInfo,Id:e.Id,ChangeKey:e.ChangeKey},parentFolderId:o?n:void 0,shape:t,fetchMasterItemFromOccurence:a,explicitLogonEmail:r}}});return Object.assign(Object.assign({},s.data.fullCalendarEvent),{calendarEvent:Object(O.a)(s.data.fullCalendarEvent.calendarEvent)})}}(e,n,t,s,m);let j;if(f&&3==f.CalendarFolderType){const t=Object(o.h)(n);return j=await Object(r.a)(e),j.calendarEvent?Object.assign(Object.assign({},j),{calendarEvent:Object(c.b)(j.calendarEvent,n,t,e.mailboxInfo)}):j}{const r=Object(i.R)(f);return j=await Object(a.a)(e,r?n:void 0,t,s,m),j.calendarEvent&&(j.calendarEvent=Object(c.a)(j.calendarEvent,e.mailboxInfo)),j}}t.d(n,"a",(function(){return j}))},2203:function(e,n,t){"use strict";var a=t(2204);n.a=(e,n)=>Object(a.a)(e.FreeBusyType)-Object(a.a)(n.FreeBusyType)},2204:function(e,n,t){"use strict";n.a=e=>{switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},2205:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(561);function r(e){if(0===e.length)return[];const n=[];return e.forEach(e=>(function(e,n){let t=!1;for(let r=0;r<n.length&&!t;r++){const i=n[r];0===Object(a.j)(i,e,!0)&&(n[r]=Object(a.f)(i,e),t=!0)}t||n.push(e)})(e,n)),n}},2206:function(e,n,t){"use strict";t.d(n,"a",(function(){return d})),t.d(n,"b",(function(){return l}));var a=t(1715),r=t(2217),i=t(36),o=t(1736),c=t(1716);function d(e,n,t,r=!1){const d=e.ParentFolderId.Id;let l=!1,s=function(e,n,t){let a=null;if(t)a=Object(o.b)(n.ItemId.Id,e);else{let t=e=>e.InstanceKey==n.InstanceKey;[a]=Object(o.a)(e,t)}if(!a){const t=n.ClientSeriesId;if(t){const n=e=>e.ClientSeriesId==t;[a]=Object(o.a)(e,n)}}return a}(d,e,n);s?s.IsRecurring&&!n?r?Object(a.d)([s]):l=!0:(null==e.IsOnlineMeeting&&null!=s.IsOnlineMeeting&&(e.IsOnlineMeeting=s.IsOnlineMeeting),null==e.OnlineMeetingJoinUrl&&null!=s.OnlineMeetingJoinUrl&&(e.OnlineMeetingJoinUrl=s.OnlineMeetingJoinUrl),s.IsDraft&&void 0===e.IsDraft&&(e.IsDraft=s.IsDraft),Object(a.d)([s])):i.h.info("[SharedCacheFunctions] addOrModifyItemInCache: Skipping removal of old item from cache as no old item was found"),!s&&t||(l||(Object(c.w)(d,[e],[{start:e.Start,end:e.End}]),Object(a.c)([e])),r?Object(c.u)(e):Object(c.t)(e))}async function l(e,n=!1){await Object(r.a)(e,n)}},2207:function(e,n,t){"use strict";t.d(n,"a",(function(){return o}));var a=t(1814),r=t(1714),i=t(2467);function o(e,n,t){const o=Object(a.k)(t,e,Object(r.f)(n));return o?Object(i.a)(o):[]}},2215:function(e,n,t){"use strict";var a=t(3);const r=Object(a.action)("poll",(e,n,t)=>({requestFunction:e,requestIdentifier:n,interval:t})),i=Object(a.action)("cancelPoll",e=>({requestIdentifier:e}));const o={currentRequest:new(t(16).ObservableMap)};let c=Object(a.createStore)("requestIdStore",o);Object(a.mutator)(i,e=>{const n=c().currentRequest.get(e.requestIdentifier);if(!n)return;let t=n.timer;clearTimeout(t),n.timer=null});const d=Object(a.mutatorAction)("setCurrentRequestId",(e,n)=>{let t=c().currentRequest.get(e);t?t.requestId=n:c().currentRequest.set(e,{requestId:n,timer:null})});function l(e,n){return c().currentRequest.get(e).requestId===n}async function s(e,n){const t=Math.random();d(n,t);let a=await e();const r={isCurrent:l(n,t)};return Object.assign({response:a},r)}const u=Object(a.mutatorAction)("setPollTimer",(e,n)=>{const t=c().currentRequest.get(e);t&&(t.timer=n)});Object(a.orchestrator)(r,e=>{const{requestFunction:n,requestIdentifier:t,interval:a}=e;i(t);const o=setTimeout(()=>(async function(e,n,t){await s(()=>e(),n),r(e,n,t)})(n,t,a),a);u(t,o)}),t.d(n,"c",(function(){return s})),t.d(n,"b",(function(){return r})),t.d(n,"a",(function(){return i}))},2216:function(e,n,t){"use strict";var a=t(704),r=t(47),i=t(7);function o(e){return Object.assign({__type:"ExpandCalendarEventRequest:#Exchange"},e)}var c=t(905),d=t(35);function l(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"ExpandCalendarEventJsonRequest:#Exchange"},t)),Object(d.a)("ExpandCalendarEvent",e,n)}var s=t(261),u=t(922),f=t(71);t.d(n,"a",(function(){return v}));const m=6;let b=null;async function v(e,n,t){return b||(b=Object(u.a)(m)),b.add(()=>{const d={Header:Object(s.b)(),Body:o({EventId:Object(c.a)({Id:e.Id}),WindowStart:Object(i.sb)(n.start),WindowEnd:Object(i.sb)(n.end),ReturnMaster:!0,ReturnRegularOccurrences:!0,ReturnExceptions:!0,ReturnCancellations:!0,IncludeDeclinedMeetings:Object(r.j)("cal-surface-declinedMeetings")})},u=b.getQueueLength()>m;u&&Object(f.o)("ExpandCalendarEventThrottled");const v={datapoint:{customData:{source:t,throttled:u}}};return l(d,Object(a.a)(e.mailboxInfo,v)).then(e=>e.Body)})}},2217:function(e,n,t){"use strict";var a=t(1716),r=t(1714),i=t(2466),o=t(2482),c=t(1715),d=t(2033),l=t(2205);var s=t(1815),u=t(2034),f=t(2200),m=t(307),b=t.n(m);async function v(e,n=!1){var t,f;const m=function(e){const n=Object(i.b)(e),t=null==n?void 0:n.filter(e=>null!==e),a=Object(r.d)(e),o=[...t,...a];return Object(l.a)(o)}(e),v=m.map(n=>Object(o.a)(n,e,function(e,n){return(t,a)=>{"Loading"!==a&&Object(r.c)(e,n).forEach(e=>{Object(c.j)(e,t,a)})}}(e,n),d.c));let O=[];for(let e=0;e<v.length;e++)await Promise.all([null===(t=v[e])||void 0===t?void 0:t.fetchPromise,null===(f=v[e])||void 0===f?void 0:f.enhancedFetchPromise]).then(e=>{let n=e[0];const t=e[1];if(n&&t)for(let e=0;e<n.length;e++){const a=n[e].ItemId.Id;let[r]=t.filter(e=>e.ItemId.Id===a);r&&b()(n[e],r),O.push(n[e])}else n&&O.push(...n)});if(O.length>0){const t=Object.values(Object(s.a)()).filter(n=>n.folderId===e).map(p);await Promise.all(t).then(e=>{const n=O.map(e=>Object(u.a)(e));for(let t=0;t<e.length;t++){const a=e[t],r=n.indexOf(Object(u.a)(a));r>=0?b()(O[r],a):O.push(a)}});const r=function(e,n){const t={},a=[];return e.forEach(e=>{const r=n(e);t.hasOwnProperty(r)||(a.push(e),t[r]=!0)}),a}(O.reduce((e,n)=>(n&&e.push(n),e),[]),e=>e.ItemId.Id);return Object(a.c)(e,r,m,n),r}return null}async function p(e){const{folderId:n,eventId:t,itemResponseShapeType:a}=e,{calendarEvent:r}=await Object(f.a)(t,n,a);return r}t.d(n,"a",(function(){return v}))},2227:function(e){e.exports=JSON.parse('{"a":"AJa"}')},2248:function(e,n,t){"use strict";function a(e){var n;return null===(n=null==e?void 0:e.ItemId)||void 0===n?void 0:n.Id}t.d(n,"a",(function(){return a}))},2280:function(e,n,t){"use strict";var a=t(3);const r=Object(a.action)("launchCalendarFullCompose",e=>({config:e})),i=Object(a.action)("launchCalendarFullComposeToDuplicate",(e,n)=>({itemId:e,entrySource:n})),o=Object(a.action)("launchCalendarReadingPane",(e,n)=>({config:e,targetWindow:n}));t.d(n,"a",(function(){return r})),t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return o}))},2364:function(e){e.exports=JSON.parse('{"a":"CJa"}')},2365:function(e){e.exports=JSON.parse('{"a":"BJa"}')},2386:function(e,n,t){"use strict";var a;!function(e){e.EwsId="ews",e.EwsImmutableId="ewsimmutable"}(a||(a={}));var r=t(47),i=t(3),o=Object(i.createStore)("immutableId",{IsImmutableIdFeatureOnForConnectedAccount:!1});var c=t(287);function d(e){return Object(c.r)(e)?o().IsImmutableIdFeatureOnForConnectedAccount?a.EwsImmutableId:a.EwsId:Object(r.j)("fwk-immutable-ids")?a.EwsImmutableId:a.EwsId}function l(e){return!!e&&e.length<90}function s(e){const n=[],t=[],a=[];return null==e||e.forEach((e,r)=>{"string"==typeof e&&(e.indexOf("@")>-1?a.push({id:e,idx:r}):l(e)?n.push({id:e,idx:r}):t.push({id:e,idx:r}))}),[n,t,a]}function u(e,n){const[t,r]=s(e),i=d(n);return i===a.EwsImmutableId&&r.length>0||i===a.EwsId&&t.length>0}const f=Object(i.mutatorAction)("setIsImmutableIdFeatureOnForConnectedAccount",e=>{o().IsImmutableIdFeatureOnForConnectedAccount=e});t.d(n,"b",(function(){return d})),t.d(n,"e",(function(){return s})),t.d(n,"c",(function(){return u})),t.d(n,"d",(function(){return l})),t.d(n,"f",(function(){return f})),t.d(n,"a",(function(){return a}))},2399:function(e,n,t){"use strict";var a=t(2084),r=t(2307),i=t(1964);var o=t(2807);function c(e){return function(e){return!(e<=0)&&(Object(i.a)(e,r.a)==r.a||Object(i.a)(e,a.d)==a.d||Object(i.a)(e,a.e)==a.e||Object(i.a)(e,r.b)==r.b||Object(i.a)(e,a.a)==a.a||Object(i.a)(e,a.b)==a.b||Object(i.a)(e,a.f)==a.f)}(e)||function(e){return Object(i.a)(e,a.g)==a.g||Object(i.a)(e,a.h)==a.h||Object(i.a)(e,a.i)==a.i}(e)||Object(o.a)(e)}t.d(n,"a",(function(){return c}))},2402:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AllEnhancedLocationFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EnhancedLocation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DisplayName"}},{kind:"Field",name:{kind:"Name",value:"Annotation"}},{kind:"Field",name:{kind:"Name",value:"PostalAddress"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Street"}},{kind:"Field",name:{kind:"Name",value:"City"}},{kind:"Field",name:{kind:"Name",value:"State"}},{kind:"Field",name:{kind:"Name",value:"Country"}},{kind:"Field",name:{kind:"Name",value:"PostalCode"}},{kind:"Field",name:{kind:"Name",value:"PostOfficeBox"}},{kind:"Field",name:{kind:"Name",value:"Type"}},{kind:"Field",name:{kind:"Name",value:"Latitude"}},{kind:"Field",name:{kind:"Name",value:"Longitude"}},{kind:"Field",name:{kind:"Name",value:"Accuracy"}},{kind:"Field",name:{kind:"Name",value:"Altitude"}},{kind:"Field",name:{kind:"Name",value:"AltitudeAccuracy"}},{kind:"Field",name:{kind:"Name",value:"FormattedAddress"}},{kind:"Field",name:{kind:"Name",value:"LocationUri"}},{kind:"Field",name:{kind:"Name",value:"LocationSource"}}]}},{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"IdType"}},{kind:"Field",name:{kind:"Name",value:"LocationType"}}]}}]}},2412:function(e,n,t){"use strict";var a=t(590),r=t(1),i=t(0),o=t(538),c=t(740),d=t(50),l=t(1561),s=t(807),u=t(2099),f=t(1725),m=t(453),b=t(63),v=Object(o.a)(),p={size:f.c.size48,presence:f.b.none,imageAlt:"",showOverflowTooltip:!0};var O=i.forwardRef((function(e,n){var t=Object(c.a)(p,e),a=i.useRef(null),o=Object(m.a)(n,a),O=function(){return t.text||t.primaryText||""},I=function(e,n,a){return i.createElement("div",{dir:"auto",className:e},n&&n(t,a))},j=function(e,n){return void 0===n&&(n=!0),e?n?function(){return i.createElement(l.a,{content:e,overflowMode:s.a.Parent,directionalHint:b.a.topLeftEdge},e)}:function(){return i.createElement(i.Fragment,null,e)}:void 0},k=j(O(),t.showOverflowTooltip),y=j(t.secondaryText,t.showOverflowTooltip),g=j(t.tertiaryText,t.showOverflowTooltip),h=j(t.optionalText,t.showOverflowTooltip),S=t.hidePersonaDetails,E=t.onRenderOptionalText,_=void 0===E?h:E,F=t.onRenderPrimaryText,N=void 0===F?k:F,C=t.onRenderSecondaryText,A=void 0===C?y:C,w=t.onRenderTertiaryText,T=void 0===w?g:w,R=t.onRenderPersonaCoin,x=void 0===R?function(e){return i.createElement(u.a,Object(r.__assign)({},e))}:R,P=t.size,D=t.allowPhoneInitials,M=t.className,L=t.coinProps,z=t.showUnknownPersonaCoin,B=t.coinSize,U=t.styles,V=t.imageAlt,G=t.imageInitials,K=t.imageShouldFadeIn,q=t.imageShouldStartVisible,W=t.imageUrl,H=t.initialsColor,$=t.initialsTextColor,Z=t.isOutOfOffice,J=t.onPhotoLoadingStateChange,Y=t.onRenderCoin,X=t.onRenderInitials,Q=t.presence,ee=t.presenceTitle,ne=t.presenceColors,te=t.showInitialsUntilImageLoads,ae=t.showSecondaryText,re=t.theme,ie=Object(r.__assign)({allowPhoneInitials:D,showUnknownPersonaCoin:z,coinSize:B,imageAlt:V,imageInitials:G,imageShouldFadeIn:K,imageShouldStartVisible:q,imageUrl:W,initialsColor:H,initialsTextColor:$,onPhotoLoadingStateChange:J,onRenderCoin:Y,onRenderInitials:X,presence:Q,presenceTitle:ee,showInitialsUntilImageLoads:te,size:P,text:O(),isOutOfOffice:Z,presenceColors:ne},L),oe=v(U,{theme:re,className:M,showSecondaryText:ae,presence:Q,size:P}),ce=Object(d.j)(t,d.h),de=i.createElement("div",{className:oe.details},I(oe.primaryText,N,k),I(oe.secondaryText,A,y),I(oe.tertiaryText,T,g),I(oe.optionalText,_,h),t.children);return i.createElement("div",Object(r.__assign)({},ce,{ref:o,className:oe.root,style:B?{height:B,minWidth:B}:void 0}),x(ie,x),(!S||P===f.c.size8||P===f.c.size10||P===f.c.tiny)&&de)}));O.displayName="PersonaBase";var I=t(8),j=t(1756),k={root:"ms-Persona",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"};t.d(n,"a",(function(){return y}));var y=Object(a.a)(O,(function(e){var n=e.className,t=e.showSecondaryText,a=e.theme,r=a.semanticColors,i=a.fonts,o=Object(I.getGlobalClassNames)(k,a),c=Object(j.d)(e.size),d=Object(j.c)(e.presence),l={color:r.bodySubtext,fontWeight:I.FontWeights.regular,fontSize:i.small.fontSize};return{root:[o.root,a.fonts.medium,I.normalize,{color:r.bodyText,position:"relative",height:j.b.size48,minWidth:j.b.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"}}},c.isSize8&&[o.size8,{height:j.b.size8,minWidth:j.b.size8}],c.isSize10&&[o.size10,{height:j.b.size10,minWidth:j.b.size10}],c.isSize16&&[o.size16,{height:j.b.size16,minWidth:j.b.size16}],c.isSize24&&[o.size24,{height:j.b.size24,minWidth:j.b.size24}],c.isSize24&&t&&{height:"36px"},c.isSize28&&[o.size28,{height:j.b.size28,minWidth:j.b.size28}],c.isSize28&&t&&{height:"32px"},c.isSize32&&[o.size32,{height:j.b.size32,minWidth:j.b.size32}],c.isSize40&&[o.size40,{height:j.b.size40,minWidth:j.b.size40}],c.isSize48&&o.size48,c.isSize56&&[o.size56,{height:j.b.size56,minWidth:j.b.size56}],c.isSize72&&[o.size72,{height:j.b.size72,minWidth:j.b.size72}],c.isSize100&&[o.size100,{height:j.b.size100,minWidth:j.b.size100}],c.isSize120&&[o.size120,{height:j.b.size120,minWidth:j.b.size120}],d.isAvailable&&o.available,d.isAway&&o.away,d.isBlocked&&o.blocked,d.isBusy&&o.busy,d.isDoNotDisturb&&o.doNotDisturb,d.isOffline&&o.offline,n],details:[o.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},(c.isSize8||c.isSize10)&&{paddingLeft:17},(c.isSize24||c.isSize28||c.isSize32)&&{padding:"0 8px"},(c.isSize40||c.isSize48)&&{padding:"0 12px"}],primaryText:[o.primaryText,I.noWrap,{color:r.bodyText,fontWeight:I.FontWeights.regular,fontSize:i.medium.fontSize,selectors:{":hover":{color:r.inputTextHovered}}},t&&{height:"16px",lineHeight:"16px",overflowX:"hidden"},(c.isSize8||c.isSize10)&&{fontSize:i.small.fontSize,lineHeight:j.b.size8},c.isSize16&&{lineHeight:j.b.size28},(c.isSize24||c.isSize28||c.isSize32||c.isSize40||c.isSize48)&&t&&{height:18},(c.isSize56||c.isSize72||c.isSize100||c.isSize120)&&{fontSize:i.xLarge.fontSize},(c.isSize56||c.isSize72||c.isSize100||c.isSize120)&&t&&{height:22}],secondaryText:[o.secondaryText,I.noWrap,l,(c.isSize8||c.isSize10||c.isSize16||c.isSize24||c.isSize28||c.isSize32)&&{display:"none"},t&&{display:"block",height:"16px",lineHeight:"16px",overflowX:"hidden"},c.isSize24&&t&&{height:18},(c.isSize56||c.isSize72||c.isSize100||c.isSize120)&&{fontSize:i.medium.fontSize},(c.isSize56||c.isSize72||c.isSize100||c.isSize120)&&t&&{height:18}],tertiaryText:[o.tertiaryText,I.noWrap,l,{display:"none",fontSize:i.medium.fontSize},(c.isSize72||c.isSize100||c.isSize120)&&{display:"block"}],optionalText:[o.optionalText,I.noWrap,l,{display:"none",fontSize:i.medium.fontSize},(c.isSize100||c.isSize120)&&{display:"block"}],textContent:[o.textContent,I.noWrap]}}),void 0,{scope:"Persona"})},2430:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(561);function r(e,n){const t=[],r=[];return e.forEach(e=>{const i={start:e.Start,end:e.End};n.some(e=>0===Object(a.j)(e,i,!0))?t.push(e):r.push(e)}),{eventsOverlapping:t,eventsNotOverlapping:r}}},2449:function(e,n,t){"use strict";t.d(n,"a",(function(){return c}));var a=t(1846),r=t(1781),i=t(38),o=t(225);function c(e){var n,t;const i=[];for(let c=0;c<e.length;c++){const u=e[c],{requiredAttendees:f,optionalAttendees:m}=l(u.Attendees),b={ItemId:{Id:Object(a.b)(u.Id),mailboxInfo:Object(o.d)()},ResponseType:d(null===(n=u.ResponseStatus)||void 0===n?void 0:n.Response),AppointmentReplyTime:Object(r.c)(s(u.Attendees)),IsOnlineMeeting:u.IsOnlineMeeting,OnlineMeetingProvider:u.OnlineMeetingProvider,OnlineMeetingJoinUrl:null===(t=u.OnlineMeeting)||void 0===t?void 0:t.JoinUrl,RequiredAttendees:f,OptionalAttendees:m};i.push(b)}return i}function d(e){let n;switch(e){case"Accepted":n="Accept";break;case"TentativelyAccepted":n="Tentative";break;case"Organizer":n="Organizer";break;case"Declined":n="Decline";break;case"NotResponded":n="NoResponseReceived";break;default:n="Unknown"}return n}function l(e){const n=[],t=[];return null==e||e.forEach(e=>{var a,r,i,o;const c={Mailbox:{Name:null===(a=e.EmailAddress)||void 0===a?void 0:a.Name,EmailAddress:null===(r=e.EmailAddress)||void 0===r?void 0:r.Address},ResponseType:d(null===(i=e.Status)||void 0===i?void 0:i.Response),LastResponseTime:null===(o=e.Status)||void 0===o?void 0:o.Time};"Required"==e.Type?n.push(c):"Optional"==e.Type&&t.push(c)}),{requiredAttendees:n,optionalAttendees:t}}function s(e){var n,t,a,r;if(!e)return null;for(let o=0;o<e.length;o++){const c=e[o];if((r=c.EmailAddress)&&(t=r.Address,a=Object(i.a)().SessionSettings.UserEmailAddress,t===a||t&&a&&t.toLowerCase()==a.toLowerCase()))return null===(n=c.Status)||void 0===n?void 0:n.Time}return null}},2466:function(e,n,t){"use strict";t.d(n,"b",(function(){return k})),t.d(n,"a",(function(){return y}));var a=t(2207),r=t(1716),i=t(1715),o=t(2033),c=t(145),d=t(1759),l=t(561),s=t(1814),u=t(2482),f=t(1714),m=t(2470),b=t(36),v=t(2467);const p={};function O(e){p[e]||(p[e]=[])}function I(e,n){O(e);const t=p[e];for(let e=0;e<t.length;e++)if(n(t[e]))return{index:e,info:t[e]};return{index:-1,info:null}}function j(e,n){return I(e,e=>Object(l.c)(e.dateRange,n,!0))}function k(e){return O(e),p[e].map(e=>e.dateRange)}function y(e,n,t){const d=Object(f.g)(e,n);if(null===t)return{fetchPromise:new Promise(async e=>e([]))};!function(e,n,t){var a,r;const{info:i}=function(e,n){return I(e,e=>e.lockIds.indexOf(n)>-1)}(e,t);if(i){const e=1==i.lockIds.length,t=Object(l.c)(i.dateRange,n,!0);e&&!t&&(null===(r=null===(a=i.requestPromises)||void 0===a?void 0:a.cancelEnhancedFetchPromise)||void 0===r||r.call(a))}}(n,t,e);const{info:b}=j(n,t);if(d&&d.lockedDateRange&&Object(l.c)(d.lockedDateRange,t,!0)){const r=Object(c.v)(n);Object(i.j)(e,r,"Loaded");const o=Object(a.a)(e,n,t);let d=g(o,n,t,b);return{fetchPromise:Promise.resolve(o),enhancedFetchPromise:d,events:o}}{const a=function(e,n){const t=Object(f.d)(e),a=Object(f.f)(e);return t.some(e=>Object(l.c)(e,n,!0))&&a?Object(v.a)(Object(s.j)(n,a.events)).map(e=>Object.assign({},e)):null}(n,t);if(a){const r=h(e,n,t,Promise.resolve(a),"existing");let o=g(a,n,t,b);return null==r||r.then(t=>{const a=Object(c.v)(n);Object(i.j)(e,a,"Loaded")}),{fetchPromise:r,enhancedFetchPromise:o,events:a}}if(null==b?void 0:b.requestPromises){const{fetchPromise:a,enhancedFetchPromise:r}=b.requestPromises;return b.lockIds.push(e),{fetchPromise:h(e,n,t,null==a?void 0:a.then(e=>e?e.filter(({Start:e,End:n})=>0==Object(l.j)(t,{start:e,end:n},!0)):[]),"new"),enhancedFetchPromise:null==r?void 0:r.then(e=>S(t)(e)),events:null}}!function(e,n,t){O(n),p[n].push({dateRange:t,requestPromises:null,lockIds:[e]})}(e,n,t);const d=function(e,n,t){const a=Object(u.a)(n,e,t,o.c);return{fetchPromise:(async()=>{try{return await(null==a?void 0:a.fetchPromise)}finally{!function(e,n){const{index:t}=j(e,n);-1!==t&&p[e].splice(t,1)}(e,n)}})(),enhancedFetchPromise:null==a?void 0:a.enhancedFetchPromise}}(n,t,function(e,n){return(t,a)=>{const{index:r,info:o}=j(e,n);-1!==r&&o.lockIds.forEach(e=>{Object(i.j)(e,t,a)})}}(n,t)),I=null==d?void 0:d.fetchPromise,k=null==d?void 0:d.enhancedFetchPromise;!function(e,n,t){const{index:a,info:r}=j(e,n);-1!==a&&(r.requestPromises=t)}(n,t,d);const y=h(e,n,t,I,"new");return{fetchPromise:y,enhancedFetchPromise:async function(e,n,t,a){const[i]=await Promise.all([t,a]);i&&(Object(m.a)(e,n),Object(r.m)(i));return i}(n,t,k,y),events:null}}}function g(e,n,t,a){var r;let i=null;if(n===Object(c.j)())if(Object(m.b)(n,t)&&e)i=Promise.resolve(e);else if(null===(r=null==a?void 0:a.requestPromises)||void 0===r?void 0:r.enhancedFetchPromise){const{enhancedFetchPromise:e}=a.requestPromises;i=e.then(S(t))}else b.h.warn("[loadEnhancedEvents] - Failed to load GetCalendarView++ events on an existing lock.");return i}async function h(e,n,t,a,i){const o=await a,c=o?o.length:"no";return Object(d.a)({lockId:e,updateMessage:`Fetched ${c} ${i} items for date range: ${t.start} - ${t.end}`}),o&&Object(r.b)(e,n,t,o),o}function S(e){return n=>n?n.filter(({Start:n,End:t})=>!(!n||!t)&&0==Object(l.j)(e,{start:n,end:t},!0)):[]}},2467:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(1695);function r(e){return e.filter(e=>!Object(a.J)(e.CalendarItemType))}},2468:function(e,n,t){"use strict";t.d(n,"a",(function(){return i}));var a=t(2402),r=t(2867);const i={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"PartialCalendarEventFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarEvent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"ItemId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}},{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"Categories"}},{kind:"Field",name:{kind:"Name",value:"EffectiveRights"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"CreateAssociated"}},{kind:"Field",name:{kind:"Name",value:"CreateContents"}},{kind:"Field",name:{kind:"Name",value:"CreateHierarchy"}},{kind:"Field",name:{kind:"Name",value:"Delete"}},{kind:"Field",name:{kind:"Name",value:"Modify"}},{kind:"Field",name:{kind:"Name",value:"Read"}},{kind:"Field",name:{kind:"Name",value:"ViewPrivateItems"}}]}},{kind:"Field",name:{kind:"Name",value:"HasAttachments"}},{kind:"Field",name:{kind:"Name",value:"InstanceKey"}},{kind:"Field",name:{kind:"Name",value:"IsDraft"}},{kind:"Field",name:{kind:"Name",value:"ParentFolderId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Id"}},{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"Preview"}},{kind:"Field",name:{kind:"Name",value:"ReminderIsSet"}},{kind:"Field",name:{kind:"Name",value:"ReminderMinutesBeforeStart"}},{kind:"Field",name:{kind:"Name",value:"Sensitivity"}},{kind:"Field",name:{kind:"Name",value:"Subject"}},{kind:"Field",name:{kind:"Name",value:"CalendarItemType"}},{kind:"Field",name:{kind:"Name",value:"CharmId"}},{kind:"Field",name:{kind:"Name",value:"End"}},{kind:"Field",name:{kind:"Name",value:"EndTimeZoneId"}},{kind:"Field",name:{kind:"Name",value:"ExperienceType"}},{kind:"Field",name:{kind:"Name",value:"FreeBusyType"}},{kind:"Field",name:{kind:"Name",value:"HideAttendees"}},{kind:"Field",name:{kind:"Name",value:"IsAllDayEvent"}},{kind:"Field",name:{kind:"Name",value:"IsMeeting"}},{kind:"Field",name:{kind:"Name",value:"IsCancelled"}},{kind:"Field",name:{kind:"Name",value:"IsOnlineMeeting"}},{kind:"Field",name:{kind:"Name",value:"IsOrganizer"}},{kind:"Field",name:{kind:"Name",value:"IsRecurring"}},{kind:"Field",name:{kind:"Name",value:"IsResponseRequested"}},{kind:"Field",name:{kind:"Name",value:"IsSeriesCancelled"}},{kind:"Field",name:{kind:"Name",value:"SkypeTeamsProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"cid"}},{kind:"Field",name:{kind:"Name",value:"rid"}},{kind:"Field",name:{kind:"Name",value:"mid"}},{kind:"Field",name:{kind:"Name",value:"uid"}},{kind:"Field",name:{kind:"Name",value:"private"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"Location"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllEnhancedLocationFields"}}]}},{kind:"Field",name:{kind:"Name",value:"MeetingRequestWasSent"}},{kind:"Field",name:{kind:"Name",value:"OnlineMeetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"Organizer"}},{kind:"Field",name:{kind:"Name",value:"Recurrence"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"AllRecurrenceFields"}}]}},{kind:"Field",name:{kind:"Name",value:"ResponseType"}},{kind:"Field",name:{kind:"Name",value:"SeriesMasterItemId"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mailboxInfo"}},{kind:"Field",name:{kind:"Name",value:"Id"}}]}},{kind:"Field",name:{kind:"Name",value:"PersonId"}},{kind:"Field",name:{kind:"Name",value:"Start"}},{kind:"Field",name:{kind:"Name",value:"StartTimeZoneId"}},{kind:"Field",name:{kind:"Name",value:"UID"}}]}},...a.a.definitions,...r.a.definitions]}},2469:function(e,n,t){"use strict";t.d(n,"a",(function(){return l}));var a=t(7),r=t(2131),i=t(225),o=t(1991),c=t(2161),d=t(1781);function l(e){var n,t,l,s,u,f,m,b;return Object.assign(Object.assign(Object.assign({},Object(r.a)()),e),{ItemId:{mailboxInfo:(null===(n=e.ItemId)||void 0===n?void 0:n.mailboxInfo)||Object(i.d)(),Id:null===(t=e.ItemId)||void 0===t?void 0:t.Id,ChangeKey:null===(l=e.ItemId)||void 0===l?void 0:l.ChangeKey},ParentFolderId:{mailboxInfo:(null===(s=e.ParentFolderId)||void 0===s?void 0:s.mailboxInfo)||Object(i.d)(),Id:null===(u=e.ParentFolderId)||void 0===u?void 0:u.Id},SeriesMasterItemId:e.SeriesMasterItemId?{mailboxInfo:e.SeriesMasterItemId.mailboxInfo||Object(i.d)(),Id:null===(f=e.SeriesMasterItemId)||void 0===f?void 0:f.Id}:void 0,Start:Object(a.qc)(e.Start),End:Object(a.qc)(e.End),AppointmentReplyTime:e.AppointmentReplyTime?Object(a.qc)(e.AppointmentReplyTime):void 0,LastModifiedTime:e.LastModifiedTime?Object(a.qc)(e.LastModifiedTime):void 0,InboxReminders:e.InboxReminders,AutoRoomBookingStatus:e.AutoRoomBookingStatus,AppendOnSend:e.AppendOnSend,FreeBusyType:e.FreeBusyType,DocLinks:null===(m=e.DocLinks)||void 0===m?void 0:m.map(c.d),Recurrence:e.Recurrence&&Object(o.g)(e.Recurrence),__type:"CalendarItem:#Exchange",ResponseType:e.ResponseType,Attachments:null===(b=e.Attachments)||void 0===b?void 0:b.map(c.b),CollabSpace:Object(d.d)(e.CollabSpace)})}},2470:function(e,n,t){"use strict";t.d(n,"a",(function(){return i})),t.d(n,"b",(function(){return o}));var a=t(561);const r={};function i(e,n){c(e),r[e].push({dateRange:n})}function o(e,n){return function(e,n){c(e);const t=r[e];for(let e=0;e<t.length;e++)if(Object(a.c)(t[e].dateRange,n,!0))return{index:e,info:t[e]};return{index:-1,info:null}}(e,n).index>=0}function c(e){r[e]||(r[e]=[])}},2471:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(3);const r=Object(a.action)("CALENDAR_EVENTS_CLEAR_ALL_FULL_CALENDAR_EVENTS",()=>({}))},248:function(e,n,t){"use strict";const a="LinkedCalendarEntry",r="LocalCacheForRemoteCalendarEntry";function i(e){return(null==e?void 0:e.__typename)==a}function o(e){return(null==e?void 0:e.__typename)==r}function c(e){return(null==e?void 0:e.__typename)==a&&!(null==e?void 0:e.IsGroupMailboxCalendar)}function d(e){var n;return(null===(n=e)||void 0===n?void 0:n.CanViewPrivateItems)||i(e)}const l="_CHANNELTEAMSTYPE_";function s(e){return e.split(l)[0]}function u(e,n){return[e,n].join(l)}function f(e){if(e.FolderId)return e.FolderId;let n=e;return n.IsGeneralScheduleCalendar?{Id:n.OwnerEmailAddress,ChangeKey:""}:n.SharedFolderId?{Id:n.SharedFolderId.Id,ChangeKey:null!=n.SharedFolderId.ChangeKey?n.SharedFolderId.ChangeKey:""}:null}function m(e){return e&&!!e.ProviderId}function b(e){return e&&(null==e.IsRemovable||e.IsRemovable)&&(null==e.CalendarFolderType||3!=e.CalendarFolderType)&&!e.IsGroupMailboxCalendar}function v(e){return e&&b(e)&&!i(e)&&(!e.FolderId||!m(e))}function p(e){return e&&!e.IsGroupMailboxCalendar}function O(e){return e&&void 0!==e.FolderId}function I(e){return v(e)||p(e)||O(e)}t.d(n,"l",(function(){return i})),t.d(n,"m",(function(){return o})),t.d(n,"n",(function(){return c})),t.d(n,"a",(function(){return a})),t.d(n,"b",(function(){return"LocalCalendarEntry"})),t.d(n,"h",(function(){return d})),t.d(n,"i",(function(){return s})),t.d(n,"o",(function(){return u})),t.d(n,"j",(function(){return f})),t.d(n,"e",(function(){return b})),t.d(n,"g",(function(){return v})),t.d(n,"d",(function(){return p})),t.d(n,"c",(function(){return O})),t.d(n,"f",(function(){return I})),t.d(n,"k",(function(){return m}))},2482:function(e,n,t){"use strict";var a=t(145),r=t(1781),i=t(2944),o=t(2749),c=t(2923),d=t(835),l=t(47),s=t(248),u=t(1718);function f(e,n,t){return a=>{if(!m(a)||a.ParentFolderId.Id!==e)return!1;const r=function(e,n){return t=>m(t)&&t.ParentFolderId.Id===e&&t.ItemId.Id===n}(a.ParentFolderId.Id,a.ItemId.Id);return t?n.some(r):!n.some(r)}}function m(e){var n;return(null===(n=null==e?void 0:e.ItemId)||void 0===n?void 0:n.Id)&&e.ParentFolderId&&e.ParentFolderId.Id}var b=t(1716),v=t(1714),p=t(2430);function O(e,n){const t=Object(v.a)(e);if(null==t?void 0:t.length){const{eventsOverlapping:a}=Object(p.a)(t,[n]);Object(b.r)(e,f(e,a,!0))}}var I=t(1715);function j(e){const n=Object(v.f)(e),t=n?[...n.events.values()]:[];Object(I.e)(f(e,t,!1))}var k=t(36),y=t(3),g=t(1812);const h=Object(y.mutatorAction)("updateCalendarWorkingHours",(e,n)=>{const{calendarFolderWorkingHours:t}=Object(g.a)();t.set(e,n)});var S=t(705);const E={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"CalendarEvents"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CalendarEventsInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"calendarEvents"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"events"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"PartialCalendarEventFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"requiresForceOverride"}},{kind:"Field",name:{kind:"Name",value:"workingHours"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"WorkHoursStartTimeInMinutes"}},{kind:"Field",name:{kind:"Name",value:"WorkHoursEndTimeInMinutes"}},{kind:"Field",name:{kind:"Name",value:"WorkDays"}},{kind:"Field",name:{kind:"Name",value:"WorkingHoursTimeZoneId"}}]}}]}}]}},...t(2468).a.definitions]};var _=t(1678),F=t(57),N=t(2469),C=t(7);function A(e,n,t,r=0){return Object.assign({fetchPromise:w(e,n,t,r)},function(e,n){if(Object(l.j)("cal-mf-noPeekJump")&&e==Object(a.j)()){const e=u.u.importAndExecute(n);return{enhancedFetchPromise:e.then(e=>e.requestPromise),cancelEnhancedFetchPromise:()=>{e.then(e=>{e.cancel()})}}}return{enhancedFetchPromise:null,cancelEnhancedFetchPromise:null}}(n,e))}async function w(e,n,t,r=0){var i,o,c;const d=n==Object(a.j)(),s=Object(a.v)(n);let u,f,m;const b=Object(a.O)(n);b?f=Object(a.n)(n):(f=Object(a.l)(s.id),u=Object(a.S)(f)),t(s,"Loading"),n||(n=null!==(i=f.SharedFolderId.Id)&&void 0!==i?i:Object(_.a)("calendar"));try{const a=Object(S.a)();m=await a.query({query:E,variables:{input:{dateRange:{start:Object(C.vb)(e.start),end:Object(C.vb)(e.end)},calendarEntryData:{calendarId:{id:s.id,mailboxInfo:s.mailboxInfo},folderId:n,ownerEmailAddress:f.OwnerEmailAddress,isGroupMailboxCalendar:f.IsGroupMailboxCalendar,hasEffectiveRights:!!f.EffectiveRights,hasReadRights:!!(null===(o=f.EffectiveRights)||void 0===o?void 0:o.Read),isGeneralScheduleCalendar:f.IsGeneralScheduleCalendar,calendarFolderType:f.CalendarFolderType,typename:f.__typename,isDefault:d,isValidCalendarEntry:u,isLocalCalendarEntry:b},retryCount:r,timeZone:Object(F.g)().UserOptions.TimeZone,includeDeclinedMeetings:Object(l.j)("cal-surface-declinedMeetings")}}}),t(s,"Loaded")}catch(e){throw"RequestNotComplete"==e.fetchErrorType?t(s,"Throttled"):t(s,"Failed"),e}const v=m.data.calendarEvents;return v.forceOverride&&(O(n,e),j(n)),v.workingHours&&h(n,v.workingHours),null===(c=v.events)||void 0===c?void 0:c.map(N.a)}function T(e,n,t,o=0){if(Object(l.j)("mon-cal-loadEventsViaGql"))return A(e,n,t,o);const c=async function(e,n,t,o=0){const c=Object(a.v)(n);if(t(c,"Loading"),Object(a.O)(n)){return 3==Object(a.n)(n).CalendarFolderType?async function(e,n,t,a,o=0){for(;o>=0;)try{const c=await Object(i.a)(Object(C.sb)(e.start),Object(C.sb)(e.end),n);if("NoError"==c.ResponseCode){return a(n,"Loaded"),c.BirthdayEvents.map(a=>Object(r.b)(a,t,e,n.mailboxInfo))}o--}catch(e){if(k.h.warn(`[loadCalendarEventsInDateRange:getBirthdayCalendarView: Exception occured: ${e}`),e.message&&(e.message.indexOf("ErrorApiQuarantined")>=0||e.message.indexOf("ErrorTooManyObjectsOpened")>=0))return a(n,"Throttled"),null;o--}return a(n,"Failed"),null}(e,c,n,t,o):R(e,c,n,t,null,o)}{let i=Object(a.l)(c.id);return Object(a.S)(i)?async function(e,n,t,a,i,o=0){if(!n.FolderId&&Object(s.l)(n)||n.hasOwnProperty("OwnerEmailAddress")&&!n.IsGroupMailboxCalendar&&!n.EffectiveRights||(!n.EffectiveRights||!n.EffectiveRights.Read)&&n.IsGeneralScheduleCalendar){for(;o>=0;)try{const c=await Object(d.b)(Object(C.sb)(t.start),Object(C.sb)(t.end),[n.OwnerEmailAddress],"DetailedMerged",null,a.mailboxInfo);if("NoError"==c.ResponseCode){i(a,"Loaded"),O(e,t),j(e);const{WorkingHours:n,Items:o}=c.Responses[0].CalendarView;return h(e,n),null==o?void 0:o.map(e=>Object(r.a)(e,a.mailboxInfo))}o--}catch(e){if(k.h.warn(`[loadCalendarEventsInDateRange:loadCalendarEventsUsingFolderId: Exception occured: ${e}`),e.message&&(e.message.indexOf("ErrorApiQuarantined")>=0||e.message.indexOf("ErrorTooManyObjectsOpened")>=0))return i(a,"Throttled"),null;o--}return i(a,"Failed"),null}{let e=n.FolderId?n.FolderId.Id:n.SharedFolderId.Id;return R(t,a,e,i,n.IsGroupMailboxCalendar?null:n.OwnerEmailAddress,o)}}(n,i,e,c,t,o):(t(c,"Failed"),null)}}(e,n,t,o);return Object.assign({fetchPromise:c},function(e,n){if(Object(l.j)("cal-mf-noPeekJump")&&e==Object(a.j)()){const e=u.u.importAndExecute(n);return{enhancedFetchPromise:e.then(e=>e.requestPromise),cancelEnhancedFetchPromise:()=>{e.then(e=>{e.cancel()})}}}return{enhancedFetchPromise:null,cancelEnhancedFetchPromise:null}}(n,e))}async function R(e,n,t,a,i,d=0){for(var u;d>=0;)try{let f;if(n.mailboxInfo&&"TeamsMailbox"==n.mailboxInfo.type?(f=await Object(c.a)(Object(C.sb)(e.start),Object(C.sb)(e.end),Object(s.i)(t),n.id,Object(F.g)().UserOptions.TimeZone),f&&(f=f.Body)):f=await Object(o.a)(Object(C.sb)(e.start),Object(C.sb)(e.end),null!=t?t:Object(_.a)("calendar"),n,i,Object(l.j)("cal-surface-declinedMeetings")),"NoError"==f.ResponseCode){return a(n,"Loaded"),null===(u=f.Items)||void 0===u?void 0:u.map(e=>(n.mailboxInfo&&"TeamsMailbox"==n.mailboxInfo.type&&(e.ParentFolderId.Id=t),Object(r.a)(e,n.mailboxInfo)))}d--}catch(e){if(k.h.warn(`[loadCalendarEventsInDateRange:getCalendarView: Exception occured: ${e}`),e.message&&(e.message.indexOf("ErrorApiQuarantined")>=0||e.message.indexOf("ErrorTooManyObjectsOpened")>=0))return a(n,"Throttled"),null;d--}return a(n,"Failed"),null}t.d(n,"a",(function(){return T}))},2485:function(e,n,t){"use strict";var a=t(926),r=t(2155),i=t(708);n.a=function(e){return Object(a.a)(e,i.a,r.a)}},2512:function(e,n,t){"use strict";n.a=function(e,n){for(var t=-1,a=null==e?0:e.length;++t<a&&!1!==n(e[t],t,e););return e}},2524:function(e,n,t){"use strict";var a=t(471),r=t(2512),i=t(959),o=t(909),c=t(566);var d=function(e,n){return e&&Object(o.a)(n,Object(c.a)(n),e)},l=t(708);var s=function(e,n){return e&&Object(o.a)(n,Object(l.a)(n),e)},u=t(948),f=t(947),m=t(915);var b=function(e,n){return Object(o.a)(e,Object(m.a)(e),n)},v=t(2155);var p=function(e,n){return Object(o.a)(e,Object(v.a)(e),n)},O=t(816),I=t(2485),j=t(803),k=Object.prototype.hasOwnProperty;var y=function(e){var n=e.length,t=new e.constructor(n);return n&&"string"==typeof e[0]&&k.call(e,"index")&&(t.index=e.index,t.input=e.input),t},g=t(944);var h=function(e,n){var t=n?Object(g.a)(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)},S=/\w*$/;var E=function(e){var n=new e.constructor(e.source,S.exec(e));return n.lastIndex=e.lastIndex,n},_=t(366),F=_.a?_.a.prototype:void 0,N=F?F.valueOf:void 0;var C=function(e){return N?Object(N.call(e)):{}},A=t(949),w="[object Boolean]",T="[object Date]",R="[object Map]",x="[object Number]",P="[object RegExp]",D="[object Set]",M="[object String]",L="[object Symbol]",z="[object ArrayBuffer]",B="[object DataView]",U="[object Float32Array]",V="[object Float64Array]",G="[object Int8Array]",K="[object Int16Array]",q="[object Int32Array]",W="[object Uint8Array]",H="[object Uint8ClampedArray]",$="[object Uint16Array]",Z="[object Uint32Array]";var J=function(e,n,t){var a=e.constructor;switch(n){case z:return Object(g.a)(e);case w:case T:return new a(+e);case B:return h(e,t);case U:case V:case G:case K:case q:case W:case H:case $:case Z:return Object(A.a)(e,t);case R:return new a;case x:case M:return new a(e);case P:return E(e);case D:return new a;case L:return C(e)}},Y=t(951),X=t(262),Q=t(518),ee=t(306),ne="[object Map]";var te=function(e){return Object(ee.a)(e)&&Object(j.a)(e)==ne},ae=t(930),re=t(812),ie=re.a&&re.a.isMap,oe=ie?Object(ae.a)(ie):te,ce=t(252),de="[object Set]";var le=function(e){return Object(ee.a)(e)&&Object(j.a)(e)==de},se=re.a&&re.a.isSet,ue=se?Object(ae.a)(se):le,fe=1,me=2,be=4,ve="[object Arguments]",pe="[object Function]",Oe="[object GeneratorFunction]",Ie="[object Object]",je={};je[ve]=je["[object Array]"]=je["[object ArrayBuffer]"]=je["[object DataView]"]=je["[object Boolean]"]=je["[object Date]"]=je["[object Float32Array]"]=je["[object Float64Array]"]=je["[object Int8Array]"]=je["[object Int16Array]"]=je["[object Int32Array]"]=je["[object Map]"]=je["[object Number]"]=je[Ie]=je["[object RegExp]"]=je["[object Set]"]=je["[object String]"]=je["[object Symbol]"]=je["[object Uint8Array]"]=je["[object Uint8ClampedArray]"]=je["[object Uint16Array]"]=je["[object Uint32Array]"]=!0,je["[object Error]"]=je[pe]=je["[object WeakMap]"]=!1;n.a=function e(n,t,o,m,v,k){var g,h=t&fe,S=t&me,E=t&be;if(o&&(g=v?o(n,m,v,k):o(n)),void 0!==g)return g;if(!Object(ce.a)(n))return n;var _=Object(X.a)(n);if(_){if(g=y(n),!h)return Object(f.a)(n,g)}else{var F=Object(j.a)(n),N=F==pe||F==Oe;if(Object(Q.a)(n))return Object(u.a)(n,h);if(F==Ie||F==ve||N&&!v){if(g=S||N?{}:Object(Y.a)(n),!h)return S?p(n,s(g,n)):b(n,d(g,n))}else{if(!je[F])return v?n:{};g=J(n,F,h)}}k||(k=new a.a);var C=k.get(n);if(C)return C;k.set(n,g),ue(n)?n.forEach((function(a){g.add(e(a,t,o,a,n,k))})):oe(n)&&n.forEach((function(a,r){g.set(r,e(a,t,o,r,n,k))}));var A=E?S?I.a:O.a:S?l.a:c.a,w=_?void 0:A(n);return Object(r.a)(w||n,(function(a,r){w&&(a=n[r=a]),Object(i.a)(g,r,e(a,t,o,r,n,k))})),g}},2549:function(e,n,t){"use strict";var a;!function(e){e.None="None",e.OwaProxy="OwaProxy",e.ConnectorsProxy="ConnectorsProxy",e.Compose="Compose",e.OwaAndConnectorsProxy="OwaAndConnectorsProxy",e.OwaConnectorsProxyAndCompose="OwaConnectorsProxyAndCompose"}(a||(a={})),n.a=a},2563:function(e,n,t){"use strict";var a=t(2524),r=1,i=4;n.a=function(e){return Object(a.a)(e,r|i)}},2590:function(e,n,t){"use strict";var a=t(327);const r=!0,i=!0;function o(e,n,t){return Object(a.g)(e,"GET",t,{throwServiceError:r,customHeaders:s(n)})}function c(e,n,t,o){return Object(a.g)(e,"DELETE",t,{requestObject:o,sendPayloadAsBody:i,throwServiceError:r,customHeaders:s(n)})}function d(e,n,t,o,c){return Object(a.g)(e,"POST",t,{requestObject:o,sendPayloadAsBody:i,throwServiceError:r,customHeaders:s(n,c)})}function l(e,n,t,o,c){return Object(a.g)(e,"PATCH",t,{requestObject:o,sendPayloadAsBody:i,throwServiceError:r,customHeaders:s(n,c)})}function s(e,n){const t={};return e&&(t["x-anchormailbox"]=e),!0===n&&(t.Prefer="return=representation"),!1===n&&(t.Prefer="return=minimal"),t}t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return c})),t.d(n,"d",(function(){return d})),t.d(n,"c",(function(){return l}))},2630:function(e,n,t){"use strict";var a=t(909),r=t(919),i=t(566),o=Object(r.a)((function(e,n,t,r){Object(a.a)(n,Object(i.a)(n),e,r)}));n.a=o},2654:function(e,n,t){"use strict";var a,r=t(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(a||(a={})),t.d(n,"b",(function(){return c})),t.d(n,"e",(function(){return d})),t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return s})),t.d(n,"a",(function(){return a}));const i=new r.d(()=>t.e(872).then(t.bind(null,19655))),o=(e,n)=>{const t=new r.a(e,n);return(...e)=>t.importAndExecute(...e)},c=o(i,e=>e.convertIdsToTargetFormat),d=o(i,e=>e.translateRestImmutableIdsToEwsIds),l=o(i,e=>e.translateEwsIdsToEwsImmutableIds),s=o(i,e=>e.translateEwsIdsToRestImmutableIds);o(i,e=>e.translateEwsImmutableIdsToEwsIds)},2732:function(e,n,t){"use strict";t.d(n,"b",(function(){return o}));var a=t(20),r=t(2399);t.d(n,"a",(function(){return r.a}));const i=new a.c(()=>Promise.all([t.e(133),t.e(1979)]).then(t.bind(null,4143))),o=new a.a(i,e=>e.getTxpObjectFromTxpEntities)},2733:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(7);function r(e,n){if(null==n?void 0:n.RecurrenceRange){const t=n.RecurrenceRange.EndDate;if(t)return Object(a.Vb)(e,t)}return null}},2749:function(e,n,t){"use strict";t.d(n,"a",(function(){return b}));var a=t(611),r=t(2865),i=t(2837),o=t(1788),c=t(261),d=t(704),l=t(922);const s="X-OWA-ExplicitLogonUser",u="X-AnchorMailbox",f=6;let m=null;function b(e,n,t,b,v,p,O){let I=null;return v?I={headers:{[s]:v,[u]:v}}:b?I=Object(d.a)(b.mailboxInfo):O&&(I={sourceId:O}),m||(m=Object(l.a)(f)),m.add(()=>{const d={Header:Object(c.b)(),Body:Object(i.a)({CalendarId:Object(o.a)({BaseFolderId:Object(a.a)({Id:t})}),RangeStart:e,RangeEnd:n,IncludeDeclinedMeetings:p})};return Object(r.a)(d,I).then(e=>e.Body)})}},2788:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"GetCalendarEventRequest:#Exchange"},e)}t.d(n,"a",(function(){return a}))},2805:function(e,n,t){"use strict";var a=t(3),r=t(57);const i=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",(e,n)=>({settings:e,userIdentity:n})),o=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",e=>({userIdentity:e}));const c="ows/beta/ScenarioSettings",d=["IsTimePanelDatePickerExpanded","TimePanelCalendarIds","IsTimePanelCalendarViewTaskListSelected"];function l(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}const s=71;var u=t(132);function f(e){return!!Object(u.a)("workloadScenarioSettings")&&0!=(e&s)}var m=t(1694);function b(e){if(d.some(n=>n===e))return"Owa";const n=Object(m.c)();return f(n)?l(n):null}var v=t(1735),p=t(327);async function O(e){var n;const t=["Owa"],a=Object(m.c)();if(f(a)){const e=l(a);t.push(e)}const r=function(e){const n=e.join(",");return`${c}/?Scenarios=${n}`}(t),i=await Object(p.b)(r,void 0,void 0,await Object(v.b)(e),!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS"),o={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1,isTimePanelCalendarViewTaskListSelected:!0};return null===(n=null==i?void 0:i.settings)||void 0===n||n.forEach(e=>{const n=b(e.settingName);!function(e){return!!e.calendarIds&&"TimePanelCalendarIds"===e.settingName}(e)||n!==b("TimePanelCalendarIds")?!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)||n!==b("TimePanelSelectedView")?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)||n!==b("SelectedCalendarListView")?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)||n!==b("IsTimePanelOpen")?!function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)||n!==b("IsTimePanelDatePickerExpanded")?function(e){return void 0!==e.isSelected&&"IsTimePanelCalendarViewTaskListSelected"===e.settingName}(e)&&n===b("IsTimePanelCalendarViewTaskListSelected")&&(o.isTimePanelCalendarViewTaskListSelected=e.isSelected):o.isTimePanelDatePickerExpanded=e.isExpanded:o.isTimePanelOpen=e.isOpen:o.timePanelSelectedCalendarView=e.selectedView:o.timePanelSelectedView=e.selectedView:o.timePanelCalendarIds=e.calendarIds}),o}var I=t(811);const j=Object(I.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(I.a)(1e3)}),k={};async function y(){const e=Object(r.d)().map(g);await Promise.all(e)}async function g(e){let n;try{if(k[e])return;k[e]=j(()=>O(e)),n=await k[e].retriableFunc(),i(n,e)}catch(n){o(e)}}var h=t(637);Object(a.orchestrator)(h.f,e=>{const{userIdentity:n}=e;g(n)});function S(e,n){return`${c}/${e}/${n}`}async function E(e){const n=b("TimePanelSelectedView");if(n){const t=S(n,"TimePanelSelectedView"),a={ViewType:e};await Object(p.d)(t,a,void 0,void 0,void 0,!0,void 0)}}async function _(e,n){const t=b("TimePanelCalendarIds");if(t){const a=S(t,"TimePanelCalendarIds"),r={CalendarIds:e};await Object(p.d)(a,r,void 0,void 0,await Object(v.b)(n),!0,void 0,"UpdateTimePanelCalendarIdsRequest")}}async function F(e){const n=b("IsTimePanelOpen");if(n){const t=S(n,"IsTimePanelOpen"),a={IsOpen:e};await Object(p.d)(t,a,void 0,void 0,void 0,!0,void 0)}}async function N(e){const n=b("SelectedCalendarListView");if(n){const t=S(n,"SelectedCalendarListView"),a={ViewType:e};await Object(p.d)(t,a,void 0,void 0,void 0,!0,void 0)}}async function C(e){const n=b("IsTimePanelDatePickerExpanded");if(n){const t=S(n,"IsTimePanelDatePickerExpanded"),a={isExpanded:e};await Object(p.d)(t,a,void 0,void 0,void 0,!0,void 0)}}async function A(e){const n=b("IsTimePanelCalendarViewTaskListSelected");if(n){const t=S(n,"IsTimePanelCalendarViewTaskListSelected"),a={isSelected:e};await Object(p.d)(t,a,void 0,void 0,void 0,!0,void 0)}}t.d(n,"i",(function(){return i})),t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return y})),t.d(n,"h",(function(){return E})),t.d(n,"g",(function(){return _})),t.d(n,"f",(function(){return F})),t.d(n,"e",(function(){return N})),t.d(n,"d",(function(){return C})),t.d(n,"c",(function(){return A}))},2807:function(e,n,t){"use strict";var a=t(1964);var r=t(2084),i=t(47);const o="cal-txp-invoice";function c(e){return function(e,n,t){return Object(a.a)(e,n)==n&&t}(e,r.c,Object(i.j)(o))}t.d(n,"a",(function(){return c}))},2808:function(e,n,t){"use strict";var a=t(35);function r(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetCalendarEventJsonRequest:#Exchange"},t)),Object(a.a)("GetCalendarEvent",e,n)}t.d(n,"a",(function(){return r}))},283:function(e,n,t){"use strict";var a=t(907);t.d(n,"a",(function(){return a.a}))},2835:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(3);const r=Object(a.action)("logCacheUpdateForDiagnostics",e=>({cacheUpdateLog:e}))},2836:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(3);const r=Object(a.action)("logNotificationUpdateForDiagnostics",e=>({notificationUpdateLog:e}))},2837:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"GetCalendarViewRequest:#Exchange"},e)}t.d(n,"a",(function(){return a}))},2865:function(e,n,t){"use strict";var a=t(35);function r(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetCalendarViewJsonRequest:#Exchange"},t)),Object(a.a)("GetCalendarView",e,n)}t.d(n,"a",(function(){return r}))},2867:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AllRecurrenceFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RecurrenceType"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"RecurrencePattern"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AbsoluteYearlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DayOfMonth"}},{kind:"Field",name:{kind:"Name",value:"Month"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AbsoluteMonthlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Interval"}},{kind:"Field",name:{kind:"Name",value:"DayOfMonth"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DailyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Interval"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RegeneratingPatternBaseType"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Interval"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RelativeYearlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DaysOfWeek"}},{kind:"Field",name:{kind:"Name",value:"DayOfWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"Month"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RelativeMonthlyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DaysOfWeek"}},{kind:"Field",name:{kind:"Name",value:"DayOfWeekIndex"}},{kind:"Field",name:{kind:"Name",value:"Interval"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WeeklyRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"DaysOfWeek"}},{kind:"Field",name:{kind:"Name",value:"FirstDayOfWeek"}},{kind:"Field",name:{kind:"Name",value:"Interval"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"RecurrenceRange"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"EndDateRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartDate"}},{kind:"Field",name:{kind:"Name",value:"EndDate"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NoEndRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartDate"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"NumberedRecurrence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"StartDate"}},{kind:"Field",name:{kind:"Name",value:"NumberOfOccurrences"}}]}}]}}]}}]}},2868:function(e,n,t){"use strict";t.d(n,"a",(function(){return a}));const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"AllAttendeeFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Attendee"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"Mailbox"}},{kind:"Field",name:{kind:"Name",value:"ResponseType"}},{kind:"Field",name:{kind:"Name",value:"LastResponseTime"}},{kind:"Field",name:{kind:"Name",value:"ResponseComment"}},{kind:"Field",name:{kind:"Name",value:"ProposedStart"}},{kind:"Field",name:{kind:"Name",value:"ProposedEnd"}},{kind:"Field",name:{kind:"Name",value:"IsCoauthor"}}]}}]}},2923:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(2590);async function r(e,n,t,r,i){const o=`ows/api/beta/TeamsCalendarEvents/items?id=${encodeURIComponent(t)}&rangeStart=${encodeURIComponent(e)}&rangeEnd=${encodeURIComponent(n)}&channelId=${r}&timeZone=${i}`;return Object(a.b)("getTeamsCalendarView",null,o)}},2941:function(e,n,t){"use strict";var a=t(905),r=t(985),i=t(704),o=t(47),c=t(2788),d=t(2808),l=t(261),s=t(965),u=t(1842),f=t(1817);var m=t(922);const b="X-RedirectToCalendarService",v=3;let p=null;const O="X-OWA-ExplicitLogonUser",I="X-AnchorMailbox";async function j(e,n,t,a,r,j){const{Id:k,mailboxInfo:y}=e;let g,h=null,S=null;const E=Object(i.a)(y)||{};E.datapoint={customData:{itemId:k,fetchingMasterItem:t},jsonCustomData:e=>{let n=e.Body.ResponseMessages.Items[0];return{responseClass:n.ResponseClass,responseCode:n.ResponseCode}}},Object(o.j)("platform-redirectToCalendarService")&&(E.headers||(E.headers=new Headers),E.headers.set(b,"true")),j&&(E.headers||(E.headers=new Headers),E.headers.set(O,j),E.headers.set(I,j));try{if(h=await function(){null==p&&(p=Object(m.a)(v));return p}().add(()=>Object(d.a)({Header:Object(l.b)(),Body:Object(c.a)({EventIds:a,ItemShape:n,IncludeDeclinedMeetings:Object(o.j)("cal-surface-declinedMeetings")})},E)),g=h.Body.ResponseMessages.Items[0],"Success"==g.ResponseClass)if(null!=g){let e=g.Items[0];null!=e&&(!function(e){e.Locations?e.Locations=e.Locations.filter(e=>e):e.Locations=[],e.Resources&&e.Resources.map(n=>{Object(u.c)(e.Locations,n.Mailbox.EmailAddress)||(e.Locations=e.Locations.filter(e=>e.DisplayName!==n.Mailbox.Name||Object(f.r)(e.PostalAddress)),e.Locations.push(Object(f.g)(n.Mailbox.Name,n.Mailbox.EmailAddress)))})}(e),r&&(e.ParentFolderId.Id=r),S={calendarEvent:e,error:null,responseCode:g.ResponseCode})}else S={calendarEvent:null,error:"[getCalendarEventService] null response.",responseCode:g.ResponseCode};else{S={calendarEvent:null,error:`[getCalendarEventService] request failed. Message: ${g.MessageText}, ResponseCode: ${g.ResponseCode}, ResponseClass: ${g.ResponseClass}`,responseCode:g.ResponseCode}}}catch(e){S={calendarEvent:null,error:e.message}}finally{Object(o.j)("cal-mf-diagnostics")&&Object(s.a)({action:"GetCalendarEvent",status:(null==g?void 0:g.ResponseClass)||"Error",response:null==h?void 0:h.Body})}return S}var k=t(1975),y=t(1998),g=t(2105),h=t(2549),S=t(282);var E=t(1999),_=t(2e3),F=t(2001),N=t(2002),C=t(1997);function A(e,n,t,i,c){const d=[i?Object(r.a)({OccurrenceId:e.Id}):Object(a.a)({Id:e.Id})];return j(e,function(e){const n=[y.a];Object(o.j)("cal-dev-focusTime")&&n.push(E.a),Object(C.a)()&&n.push(_.a),Object(o.j)("cal-mf-mobility-create")&&(n.push(F.a),n.push(N.a));const t={BaseShape:"IdOnly",MaximumBodySize:0,BodyType:"HTML",FilterHtmlContent:!0,InlineImageCustomDataTemplate:k.e,InlineImageUrlTemplate:k.f,AddBlankTargetToLinks:!0,CssScopeClassName:"cal_"+Math.ceil(65534*Math.random()+1).toString(16),AdditionalProperties:n,ImageProxyCapability:Object(o.j)("cal-bodyImageProxy")&&Object(g.a)()?h.a.OwaAndConnectorsProxy:h.a.None};if(!Object(o.j)("cal-mf-blockExternalContent"))return t;switch(e){case"Default":return Object.assign(Object.assign({},t),{BlockContentFromUnknownSenders:!0,BlockExternalImages:!0});case"WithBlockedExternalContent":return t;default:return Object(S.a)(e)}}(t),i,d,n,c)}t.d(n,"a",(function(){return A}))},2942:function(e,n,t){"use strict";var a=t(704);var r=t(905),i=t(35);function o(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetBirthdayEventJsonRequest:#Exchange"},t)),Object(i.a)("GetBirthdayEvent",e,n)}var c=t(261);async function d(e){const{Id:n,mailboxInfo:t}=e,i=Object(a.a)(t)||{};i.datapoint={customData:{itemId:n},jsonCustomData:e=>{var n,t;return{responseClass:null===(n=null==e?void 0:e.Body)||void 0===n?void 0:n.ResponseClass,responseCode:null===(t=null==e?void 0:e.Body)||void 0===t?void 0:t.ResponseCode}}};const d=await o({Header:Object(c.b)(),Body:(l={CalendarItemId:Object(r.a)({Id:n})},Object.assign({__type:"GetBirthdayEventRequest:#Exchange"},l))},i);var l;if(null!=d.Body&&"Success"==d.Body.ResponseClass){let e=d.Body.BirthdayEvent;if(null!=e)return{calendarEvent:e,error:null}}return{calendarEvent:null,error:"[getBirthdayEventService] request failed"}}t.d(n,"a",(function(){return d}))},2944:function(e,n,t){"use strict";var a=t(35);function r(e,n){var t;return void 0===e||e.__type||(t=e,e=Object.assign({__type:"GetBirthdayCalendarViewJsonRequest:#Exchange"},t)),Object(a.a)("GetBirthdayCalendarView",e,n)}var i=t(261),o=t(704);async function c(e,n,t){var a;return(await r({Header:Object(i.b)(),Body:(a={StartRange:e,EndRange:n},Object.assign({__type:"GetBirthdayCalendarViewRequest:#Exchange"},a))},Object(o.a)(t.mailboxInfo))).Body}t.d(n,"a",(function(){return c}))},3043:function(e,n,t){"use strict";var a=t(3),r=t(80);const i=Object(a.action)("toggleShowDeclinedEventsMode",(e,n)=>Object(r.b)({name:"ToggleShowDeclinedEventsMode",customData:{CurrentDateRangeType:n,ShowDeclinedEventsMode:e}},{isDeclinedEventsMode:e,dateRangeType:n}));var o=i,c=t(470);Object(a.orchestrator)(i,e=>{const{isDeclinedEventsMode:n}=e;Object(c.a)(e=>{e.ViewStateConfiguration.CalendarViewShowDeclinedMeetings=n},[{key:"CalendarViewShowDeclinedMeetings",valuetype:"Boolean",value:[`${n}`]}],"OWA.ViewStateConfiguration")});var d=t(57),l=t(47);function s(){return!!Object(l.j)("cal-surface-declinedMeetings")&&Object(d.g)().ViewStateConfiguration.CalendarViewShowDeclinedMeetings}t.d(n,"a",(function(){return s})),t.d(n,"b",(function(){return o}))},3396:function(e){e.exports=JSON.parse('{"c":"oib","e":"pib","f":"qib","d":"rib","b":"sib","i":"tib","a":"uib","n":"vib","m":"wib","k":"xib","l":"yib","j":"zib","h":"Aib","g":"Bib"}')},3397:function(e){e.exports=JSON.parse('{"a":"mib","b":"nib"}')},3787:function(e,n,t){"use strict";var a=t(3);const r=Object(a.action)("updateUpNextEvent",(e,n)=>({id:e,eventsCacheLockId:n}));const i={scenarios:new(t(16).ObservableMap)},o=Object(a.createStore)("UpNextStore",i);Object(a.mutator)(r,e=>{o().scenarios.set(e.eventsCacheLockId,e.id)});var c=t(1718),d=t(2070);Object(a.action)("cancelRefreshUpNextPoll",e=>({eventsCacheLockId:e}));const l=Object(a.action)("onUpNextEventUpdated",(e,n,t)=>({id:e,parentFolderId:n,eventsCacheLockId:t})),s=Object(a.action)("initializeUpNextEventLoader",(e,n)=>({calendarIds:e,eventsCacheLockId:n}));var u=t(7);function f(){const e=Object(u.pc)(),n=Object(u.e)(e,1);return{start:e,end:Object(u.A)(n)}}var m=t(1695),b=t(1790),v=t(2165),p=t(22);function O(e,n=!1){const t=Object(u.Ub)(),a=[...e];return n||a.sort(v.a),function(e,n){if(!e||0===e.length)return null;const t=I(n),a=e.filter((a,r)=>{if(!t(a))return!1;return!e.slice(r+1).some(e=>Object(u.Jb)(e.End,n))});if(0===a.length)return null;if(1===a.length)return a[0];return a.reduce((e,t)=>{if(0===e.length)return[t];const a=j(e[0].Start,n),r=j(t.Start,n);return r<a?[t]:r===a?(e.push(t),e):e},[]).sort(v.b)[0]}(a,t)}function I(e){return n=>{const t=Object(u.Jb)(n.End,e),a=Object(u.w)(n.End,n.Start)>p.e,r=!Object(b.c)(n),i=Object(m.t)(n);return!t&&!a&&!n.IsAllDayEvent&&!n.IsCancelled&&!n.IsDraft&&"Decline"!==n.ResponseType&&r&&i}}function j(e,n){return Math.abs(Object(u.w)(e,n))}var k=t(1883);function y(e){const n=f();return Object(d.d)(e,n).filter(Object(k.d)(n))}var g=t(1690);function h(e){if(!e.IsOnlineMeeting||null===e.OnlineMeetingJoinUrl)return!1;const n=Object(g.h)(),t=Object(u.Rb)(Object(u.jc)(n,1),e.Start,e.End),a=Object(u.Rb)(n,e.Start,e.End);return(t||a)&&!e.IsCancelled&&!e.IsDraft&&"Decline"!==e.ResponseType&&!Object(b.c)(e)&&Object(m.t)(e)}function S(e){return o().scenarios.get(e)}function E(e){const n=S(e);return n?function(e,n){return y(e).filter(e=>e.ItemId.Id===n.Id)[0]||null}(e,n):null}function _(e){const n=E(e);if(!n)return{upNextEvent:null,conflictingEvents:[]};const t=y(e).filter(e=>(function(e,n){const t=Object(g.h)();return n.ItemId.Id!==e.ItemId.Id&&(Object(v.f)(n,e)&&!Object(u.Hb)(n.Start,e.Start)&&I(t)(n))})(n,e));return{upNextEvent:n,conflictingEvents:t}}function F(e){return o().scenarios.has(e)}function N(){return[...o().scenarios.keys()]}async function C(e){const n=function(e){return O(y(e),!0)}(e),t=n?n.ItemId:null;S(e)!==t&&(r(t,e),l(t,n?n.ParentFolderId:null,e))}function A(){N().forEach(C)}Object(a.orchestrator)(c.b,()=>{A()}),Object(a.orchestrator)(c.c,()=>{A()}),Object(a.orchestrator)(c.a,()=>{A()}),Object(a.orchestrator)(s,e=>{const{calendarIds:n,eventsCacheLockId:t}=e,a=f();F(t)||r(null,t),Object(d.i)(t,n,a)});var w=t(2215);Object(a.orchestrator)(d.a,async e=>{const{eventsCacheLockId:n}=e;F(n)&&(await C(n),Object(w.b)(()=>(async function(e){return await C(e),null})(n),n,1e4))});Object(a.orchestrator)(d.l,e=>{const{eventsCacheLockId:n}=e;F(n)&&C(n)});var T=t(2046);Object(a.orchestrator)(g.i,()=>{N().forEach(e=>{const{upNextEvent:n,onlineEventsHappeningNow:t}=function(e){return{upNextEvent:E(e),onlineEventsHappeningNow:y(e).filter(h)}}(e);n&&!Object(T.d)(n,!0)&&Object(d.j)(e,n.ItemId),t.forEach(t=>{n&&t.ItemId.Id===n.ItemId.Id||Object(T.d)(t,!0)||Object(d.j)(e,t.ItemId)})})});Object(a.orchestrator)(g.k,()=>{N().forEach(e=>Object(d.n)(f(),e))}),Object(a.orchestrator)(d.k,e=>{const{eventsCacheLockId:n}=e;F(n)&&C(n)});t.d(n,"f",(function(){return l})),t.d(n,"d",(function(){return s})),t.d(n,"g",(function(){return d.m})),t.d(n,"a",(function(){return E})),t.d(n,"b",(function(){return S})),t.d(n,"c",(function(){return _})),t.d(n,"e",(function(){return F}))},4168:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return c})),t.d(n,"d",(function(){return d})),t.d(n,"f",(function(){return l})),t.d(n,"h",(function(){return s})),t.d(n,"i",(function(){return u})),t.d(n,"e",(function(){return f})),t.d(n,"c",(function(){return m})),t.d(n,"g",(function(){return b}));var a=t(2492),r=t(20);const i=new r.c(()=>Promise.all([t.e(1),t.e(2),t.e(3),t.e(8),t.e(209)]).then(t.bind(null,5749)));Object(r.f)(a.d,i,e=>e.openTimePanelOrchestrator);const o=Object(r.d)(i,e=>e.TimePanel),c=Object(r.d)(i,e=>e.TimePanelHeaderBar),d=new r.a(i,e=>e.loadTimePanelData),l=new r.a(i,e=>e.openEventDetailsView),s=(new r.a(i,e=>e.openAttendeeTrackingView),new r.a(i,e=>e.closeAttendeeTrackingView),new r.a(i,e=>e.openTasksView)),u=new r.a(i,e=>e.openCalendarView),f=new r.a(i,e=>e.openConflictsView),m=new r.a(i,e=>e.closeConflictsView),b=new r.a(i,e=>e.openEventQuickComposeView)},523:function(e,n,t){"use strict";t.d(n,"g",(function(){return o})),t.d(n,"f",(function(){return c})),t.d(n,"k",(function(){return d})),t.d(n,"c",(function(){return l})),t.d(n,"d",(function(){return s})),t.d(n,"n",(function(){return u})),t.d(n,"l",(function(){return f})),t.d(n,"m",(function(){return m})),t.d(n,"a",(function(){return b})),t.d(n,"h",(function(){return v})),t.d(n,"b",(function(){return p})),t.d(n,"e",(function(){return O})),t.d(n,"j",(function(){return I})),t.d(n,"i",(function(){return j})),t.d(n,"o",(function(){return k}));var a=t(108),r=t(81),i=t(7);function o(e,n=Object(i.Ub)()){return l(Object(i.fc)(n,e),a.a.DaysInOneWeek)}function c(e,n){let t=d(e,n),a=Object(i.B)(e),r=Object(i.e)(Object(i.C)(a,n),1);return l(t,Math.abs(Object(i.s)(t,r)-1))}function d(e,n){let t=Object(i.ec)(e);return Object(i.fc)(t,n)}function l(e,n){return{start:e,end:Object(i.e)(e,n-1)}}function s(e,n,t,a,c=1){switch(e){case r.b.Day:return l(Object(i.bc)(n),c);case r.b.Month:const e=Object(i.ec)(n),d=Object(i.B)(n);return l(e,Math.abs(Object(i.s)(e,d)-1));case r.b.Week:return o(t,n);case r.b.WorkWeek:return function(e,n,t=Object(i.Ub)()){let a=o(e,t);for(var r,c,d=0;d<=I(a);d++){let e=Object(i.e)(a.start,d);if(!r&&n.includes(Object(i.ob)(e))&&(r=e),e=Object(i.e)(a.end,-d),!c&&n.includes(Object(i.ob)(e))&&(c=e),r&&c)break}return{start:r,end:c}}(t,a,n)}}function u(e,n){let t=c(e,n);return Object(i.t)(t.end,t.start,n)}function f(e,n){var t;return l(t=n==r.b.WorkWeek?Object(i.k)(e.start,1):Object(i.e)(e.end,1),n==r.b.Month?Object(i.pb)(t):Object(i.s)(e.end,e.start)+1)}function m(e,n){var t,a;if(n==r.b.WorkWeek)t=Object(i.k)(e.start,-1),a=Object(i.k)(e.end,-1);else{a=Object(i.e)(e.start,-1);const o=n==r.b.Month?-Object(i.pb)(a):Object(i.s)(e.start,e.end)-1;t=Object(i.e)(e.start,o)}return{start:t,end:a}}function b(e,n){return e&&n&&0==Object(i.p)(e.start,n.start)&&0==Object(i.p)(e.end,n.end)}function v(e,n,t){if(!e||!n)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return t?Object(i.p)(e.start,n.start)<=0?Object(i.p)(e.end,n.start)>=0?0:1:Object(i.p)(n.end,e.start)>=0?0:-1:Object(i.p)(e.start,n.start)<0?Object(i.p)(e.end,n.start)>0?0:1:Object(i.p)(n.end,e.start)>0?0:-1}function p(e,n,t){return!(!e||!n)&&(t?Object(i.p)(e.start,n.start)<=0&&Object(i.p)(e.end,n.end)>=0:Object(i.p)(e.start,n.start)<0&&Object(i.p)(e.end,n.end)>0)}function O(e,n){if(e&&n){return{start:Object(i.p)(e.start,n.start)<0?e.start:n.start,end:Object(i.p)(e.end,n.end)>0?e.end:n.end}}return null}function I(e){return Object(i.s)(e.end,e.start)}function j(e){return Math.floor(Object(i.v)(e.end,e.start)/24)+(Object(i.v)(e.end,e.start)%24>0?1:0)}function k(e,n){return Object(i.s)(e.start,n)<=0&&Object(i.s)(e.end,n)>=0}},561:function(e,n,t){"use strict";var a=t(523),r=t(7);function i(){const e=Object(r.Ub)(),n=Object(r.f)(Object(r.pc)(),12),t=Object(r.f)(Object(r.pc)(),18);let a="Evening";return Object(r.y)(n,e)>0?a="Morning":Object(r.y)(t,e)>0&&(a="Afternoon"),a}function o(e,n,t){return Object(r.Rb)(e,n,t)}var c=t(108);function d(e,n){return function(e){const n=e%c.a.SecondsInOneMinute;return e-n+c.a.SecondsInOneMinute}(Object(r.y)(e,n))}const l=15*c.a.SecondsInOneMinute;function s(e,n){return d(e,n)<=l}var u=t(81),f=(e,n,t)=>{switch(t){case u.d.FirstFullWeek:return m(e,n,c.a.DaysInOneWeek);case u.d.FirstFourDayWeek:return m(e,n,4);default:return function(e,n){const t=b(e)-1,a=(Object(r.ob)(e)-t%c.a.DaysInOneWeek-n+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;return Math.floor((t+a)/c.a.DaysInOneWeek+1)}(e,n)}};function m(e,n,t){const a=b(e)-1;let i=Object(r.ob)(e)-a%c.a.DaysInOneWeek;const o=b(Object(r.qc)(Object(r.Fb)(e)-1,u.e.December,31))-1;let d=(n-i+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek;0!==d&&d>=t&&(d-=c.a.DaysInOneWeek);let l=a-d;return l<0&&(i-=o%c.a.DaysInOneWeek,d=(n-i+2*c.a.DaysInOneWeek)%c.a.DaysInOneWeek,0!==d&&d+1>=t&&(d-=c.a.DaysInOneWeek),l=o-d),Math.floor(l/c.a.DaysInOneWeek+1)}function b(e){const n=Object(r.Ab)(e),t=Object(r.Fb)(e);let a=0;for(let e=0;e<n;e++)a+=v(e+1,t);return a+=Object(r.mb)(e),a}function v(e,n){return Object(r.pb)(Object(r.qc)(n,e,0))}function p(e){let n=[];for(let t=0;t<c.a.DaysInOneWeek;t++)e&1<<t&&n.push(t);return n}function O(e,n,t){const i=[],o=t.sort((e,n)=>{const t=Object(r.p)(e.start,n.start);return 0!==t?t:Object(r.p)(e.end,n.end)});let c=Object(r.bc)(e),d=0;for(;Object(r.p)(c,n)<0&&d<o.length;){const e={start:c,end:Object(r.A)(c)},n=Object(a.h)(o[d],e,!1);n<=0?(0===n&&i.push(c),c=Object(r.e)(c,1)):d++}return i}t.d(n,"h",(function(){return a.g})),t.d(n,"g",(function(){return a.f})),t.d(n,"n",(function(){return a.k})),t.d(n,"d",(function(){return a.c})),t.d(n,"e",(function(){return a.d})),t.d(n,"s",(function(){return a.n})),t.d(n,"o",(function(){return a.l})),t.d(n,"p",(function(){return a.m})),t.d(n,"b",(function(){return a.a})),t.d(n,"j",(function(){return a.h})),t.d(n,"c",(function(){return a.b})),t.d(n,"f",(function(){return a.e})),t.d(n,"l",(function(){return a.j})),t.d(n,"k",(function(){return a.i})),t.d(n,"t",(function(){return a.o})),t.d(n,"w",(function(){return i})),t.d(n,"u",(function(){return o})),t.d(n,"v",(function(){return s})),t.d(n,"q",(function(){return d})),t.d(n,"r",(function(){return f})),t.d(n,"a",(function(){return c.a})),t.d(n,"i",(function(){return p})),t.d(n,"m",(function(){return O}))},566:function(e,n,t){"use strict";var a=t(719),r=t(942),i=t(402);n.a=function(e){return Object(i.a)(e)?Object(a.a)(e):Object(r.a)(e)}},637:function(e,n,t){"use strict";t.d(n,"b",(function(){return c})),t.d(n,"c",(function(){return d})),t.d(n,"d",(function(){return l}));var a=t(824);t.d(n,"f",(function(){return a.c})),t.d(n,"e",(function(){return a.b}));var r=t(1015);t.d(n,"a",(function(){return r.a}));var i=t(20);const o=new i.c(()=>Promise.all([t.e(8),t.e(10),t.e(13),t.e(33),t.e(486)]).then(t.bind(null,1595))),c=new i.a(o,e=>e.initializeOwaAccountsStore),d=new i.a(o,e=>e.initializeOwaConnectedAccount),l=new i.a(o,e=>e.removeOWAConnectedAccount)},6568:function(e,n,t){"use strict";var a=t(3);const r=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",(e,n)=>({calendarIds:e,userIdentity:n})),i=Object(a.action)("SET_TIME_PANEL_CONFIG_LOAD_STATE",(e,n)=>({loadState:e,userIdentity:n})),o=Object(a.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",(e,n)=>({calendarIds:e,userIdentity:n})),c=Object(a.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED");var d;!function(e){e[e.Loaded=0]="Loaded",e[e.Failed=1]="Failed"}(d||(d={}));var l=t(2805);Object(a.orchestrator)(l.b,e=>{i(d.Failed,e.userIdentity),c()});var s=t(16);const u=Object(a.createStore)("timePanelSelectedCalendarIdsStore",{configLoadStates:new s.ObservableMap,calendarIdsMap:new s.ObservableMap});var f=t(2120);function m(){return Object(f.c)(u().calendarIdsMap)}function b(e){return e?function(e){const n=m().get(e);return n?n.length:0}(e):Object(f.d)(m()).length}function v(){return b()>0}function p(){return u().configLoadStates}var O=t(287),I=t(145),j=t(225);function k(){const e=p(),n=0===e.size,t=new s.ObservableMap;return n?t:([Object(j.d)().userIdentity,...Object(O.n)().map(e=>e.userIdentity)].forEach(n=>{if(v()&&e.get(n)!==d.Failed)t.set(n,m().get(n));else{const e=Object(I.z)(n);e&&t.set(n,[e.calendarId.id])}}),t)}var y=t(811),g=t(57),h=t(36);const S=Object(y.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(y.a)(1e3)});let E={};Object(a.orchestrator)(o,async e=>{const{calendarIds:n,userIdentity:t}=e;Object(j.d)().userIdentity===t&&1===b()&&1===b(t)&&0===n.length||(v()||await async function(){await Promise.all(Object(g.d)().map(e=>{let n=[];const t=Object(I.z)(e);t&&(n=[t.calendarId.id]),F(n,e,!0)}))}(),F(n,t))});const _=1e3;async function F(e,n,t){var a;const i=Object(f.b)(e),o=k().get(n);try{r(i,n),t||c(),null===(a=E[n])||void 0===a||a.cancel();let e=S(()=>Object(l.g)(i,n));const o=function(e,n){let t=!1;return{delayFunc:()=>new Promise((a,r)=>((a,r)=>{setTimeout(()=>{if(!t)return e(),a()},n)})(a)),cancel:()=>t=!0}}(e.retriableFunc,_),d={cancel:()=>{o.cancel(),e.cancel()},updateFunc:o.delayFunc};E[n]=d,await d.updateFunc()}catch(e){h.h.warn(`updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: ${e}`),r(o,n),t||c()}finally{delete E[n]}}var N=t(2654),C=t(2386);Object(a.orchestrator)(l.i,async e=>{var n;const{settings:t,userIdentity:a}=e;if(i(d.Loaded,a),(null===(n=t.timePanelCalendarIds)||void 0===n?void 0:n.length)>0)if(Object(C.c)(t.timePanelCalendarIds,a)){const e=await Object(N.b)(t.timePanelCalendarIds,Object(C.b)(a),a,N.a.MyDay);o(e,a)}else r(t.timePanelCalendarIds,a);c()}),Object(a.mutator)(i,e=>{const{userIdentity:n,loadState:t}=e;u().configLoadStates.set(n,t)}),Object(a.mutator)(r,e=>{const{calendarIds:n,userIdentity:t}=e;u().calendarIdsMap.set(t,Object(f.b)(n))});function A(){return Object(f.d)(k())}t.d(n,"e",(function(){return o})),t.d(n,"d",(function(){return c})),t.d(n,"a",(function(){return p})),t.d(n,"c",(function(){return k})),t.d(n,"b",(function(){return A}))},703:function(e,n,t){"use strict";function a(e){return null==e||0==e.trim().length}t.d(n,"a",(function(){return a}))},704:function(e,n,t){"use strict";function a(e,n){return e?Object.assign({mailboxInfo:e},n):null!=n?n:void 0}t.d(n,"a",(function(){return a}))},717:function(e,n,t){"use strict";var a=t(328),r=t(247),i=Object(a.a)(r.a,"Set");n.a=i},803:function(e,n,t){"use strict";var a=t(328),r=t(247),i=Object(a.a)(r.a,"DataView"),o=t(475),c=Object(a.a)(r.a,"Promise"),d=t(717),l=Object(a.a)(r.a,"WeakMap"),s=t(347),u=t(434),f=Object(u.a)(i),m=Object(u.a)(o.a),b=Object(u.a)(c),v=Object(u.a)(d.a),p=Object(u.a)(l),O=s.a;(i&&"[object DataView]"!=O(new i(new ArrayBuffer(1)))||o.a&&"[object Map]"!=O(new o.a)||c&&"[object Promise]"!=O(c.resolve())||d.a&&"[object Set]"!=O(new d.a)||l&&"[object WeakMap]"!=O(new l))&&(O=function(e){var n=Object(s.a)(e),t="[object Object]"==n?e.constructor:void 0,a=t?Object(u.a)(t):"";if(a)switch(a){case f:return"[object DataView]";case m:return"[object Map]";case b:return"[object Promise]";case v:return"[object Set]";case p:return"[object WeakMap]"}return n});n.a=O},81:function(e,n,t){"use strict";var a,r,i,o;t.d(n,"c",(function(){return a})),t.d(n,"e",(function(){return r})),t.d(n,"d",(function(){return i})),t.d(n,"b",(function(){return o})),t.d(n,"a",(function(){return c})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday"}(a||(a={})),function(e){e[e.January=0]="January",e[e.February=1]="February",e[e.March=2]="March",e[e.April=3]="April",e[e.May=4]="May",e[e.June=5]="June",e[e.July=6]="July",e[e.August=7]="August",e[e.September=8]="September",e[e.October=9]="October",e[e.November=10]="November",e[e.December=11]="December"}(r||(r={})),function(e){e[e.FirstDay=0]="FirstDay",e[e.FirstFullWeek=1]="FirstFullWeek",e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(i||(i={})),function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.WorkWeek=3]="WorkWeek"}(o||(o={}));var c=7},811:function(e,n,t){"use strict";function a(e={}){!function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||(()=>6e4)}(e);const{maximumAttempts:n,timeBetweenRetryInMS:t}=e;return e=>{let a=0,r=!1;const i=(o,c)=>{r?c(new Error("The function retry was cancelled")):(a++,e().then(e=>o(e)).catch(e=>{n&&a>=n?c(e):setTimeout(()=>i(o,c),t(a))}))};return{retriableFunc:()=>new Promise((e,n)=>i(e,n)),cancel:()=>r=!0}}}function r(e){return n=>Math.pow(2,n)*e}t.d(n,"b",(function(){return a})),t.d(n,"a",(function(){return r}))},816:function(e,n,t){"use strict";var a=t(926),r=t(915),i=t(566);n.a=function(e){return Object(a.a)(e,i.a,r.a)}},824:function(e,n,t){"use strict";t.d(n,"a",(function(){return r})),t.d(n,"c",(function(){return i})),t.d(n,"d",(function(){return o})),t.d(n,"b",(function(){return c}));var a=t(3);const r=Object(a.action)("initializeOwaAccountsStore"),i=Object(a.action)("owaConnectedAccountAdded",(e,n,t)=>({userIdentity:e,accountProviderType:n,source:t})),o=Object(a.action)("removeAccount",e=>({userIdentity:e})),c=Object(a.action)("owaAccountStoreInitializationFailed",(e,n,t,a)=>({userIdentity:e,isRetry:n,accountProvider:t,error:a}))},835:function(e,n,t){"use strict";var a=t(7),r=t(1062),i=t(1059),o=t(1063),c=t(1064),d=t(1060),l=t(1067),s=t(261),u=t(965),f=t(47),m=t(704);async function b(e,n,t,a,b,v,p){const O=Object(s.b)();let I;b&&(O.TimeZoneContext.TimeZoneDefinition.Id=b);let j=null;v&&(j=Object(m.a)(v));try{I=await Object(l.a)({request:{Header:O,Body:Object(c.a)({MailboxDataArray:t.map(e=>Object(d.a)({Email:Object(i.a)({Address:e})})),FreeBusyViewOptions:Object(o.a)({RequestedView:a,TimeWindow:Object(r.a)({StartTime:e,EndTime:n}),MergedFreeBusyIntervalInMinutes:p})})}},j)}finally{Object(f.j)("cal-mf-diagnostics")&&Object(u.a)({action:"GetUserAvailabilityInternal",status:I?I.Body.ResponseCode:"Error",response:null==I?void 0:I.Body})}return I.Body}var v=t(310),p=t(36),O=t(922);const I=Object(O.a)(4),j=e=>{let n={};return e.forEach(e=>n[e]={FreeBusyViewType:"None"}),n};async function k(e,n,t,r,i=!0,o,c){if(0===t.length)return;const d=new v.a("FreeBusyAvailabilityRequested",{isCore:!0});d.addCustomData({numAttendees:t.length});try{const l=await I.add(()=>b(Object(a.sb)(e),Object(a.sb)(n),t,"DetailedMerged",e.tz,o,c));d.addCustomData({executingRequests:I.getRunningCount(),queuedRequests:I.getQueueLength()}),d.end();const s="Success"===l.ResponseClass&&t.length===l.Responses.length;let u={};if(s?t.forEach((e,n)=>{u[e]=l.Responses[n].CalendarView}):u=j(t),i){const a=s?Object.keys(u).filter(e=>"None"==u[e].FreeBusyViewType):t;a.length>0&&k(e,n,a,r,!1,o,c)}r(u)}catch(a){if(d.endWithError("ServerError",a),p.h.warn(`[getAvailabilityFunction] Received error calling getUserAvailabilityService, Error: "${a.stack}"`),i)k(e,n,t,r,!1,o,c);else{r(j(t))}}}t.d(n,"a",(function(){return k})),t.d(n,"b",(function(){return b}))},843:function(e,n,t){"use strict";var a=t(3),r=t(16);var i,o=Object(a.createStore)("cacheLoaderStore",{calendarAccountLoadMap:new r.ObservableMap({})});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup",e[e.TeamsCalendars=2]="TeamsCalendars"}(i||(i={}));var c=t(282),d=t(225);function l(e,n){switch(e){case i.Outlook:case i.OutlookGroup:return(n||Object(d.d)().userIdentity)+e.toString();case i.TeamsCalendars:return e.toString();default:return Object(c.a)(e)}}var s,u=t(57),f=t(47);function m(e,n){var t;const a=l(e,n);return(null===(t=o().calendarAccountLoadMap.get(a))||void 0===t?void 0:t.loadState)==s.Loaded}function b(e){return function(e){if(e&&e!==Object(u.b)()){const e=[i.Outlook];return Object(f.j)("cal-multiAccounts-groups")&&e.push(i.OutlookGroup),e}return[i.Outlook,i.OutlookGroup,i.TeamsCalendars]}(e).every(n=>m(n,e))}!function(e){e[e.Loading=0]="Loading",e[e.Loaded=1]="Loaded",e[e.Error=2]="Error"}(s||(s={}));const v=Object(a.mutatorAction)("addToAccounts",(e,n,t,a)=>{const r=o(),i={calendarEndpointType:t,userId:n,loadState:a};r.calendarAccountLoadMap.has(e)||r.calendarAccountLoadMap.set(e,i)}),p=Object(a.mutatorAction)("updateAccountLoadState",(e,n)=>{const t=o(),a=t.calendarAccountLoadMap.get(e);a.loadState=n,t.calendarAccountLoadMap.set(e,a)});var O=t(637),I=t(36);const j=Object(a.action)("calendarCacheInitializedForAccount",(e,n,t)=>({calendarEndpointType:e,userId:n,source:t}));var k=t(1040),y=t(1096),g=t(1094);var h=t(811);const S=Object(h.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(h.a)(1e3)});var E=t(287),_=t(1091);const F={};function N(e,n){const t=n?n.userIdentity:Object(d.d)().userIdentity,a=Object(E.r)(t),r=l(e,t);if(v(r,t,e,s.Loading),m(e,t))return Promise.resolve();const o=F[r];if(o)return o.requestPromise;const u=S(()=>(async function(e,n){switch(e){case i.Outlook:await Object(k.f)(n);break;case i.OutlookGroup:await Object(y.b)(n);break;case i.TeamsCalendars:Object(f.j)("cal-showAddTeamsCalendars")&&await g.c.importAndExecute();break;default:Object(c.a)(e)}})(e,t)).retriableFunc();return F[r]={requestPromise:u},u.then(()=>{p(r,s.Loaded),j(e,t,null==n?void 0:n.source),a&&b(t)&&Object(_.a)(!0,t)}).catch(e=>{p(r,s.Error),I.d("initializeCalendarsCacheForAccount: failed to initialize calendar cache",e)})}async function C(){const e=N(i.Outlook),n=Object(E.n)().map(e=>{if(Object(u.h)(e.userIdentity)){const n={userIdentity:e.userIdentity,source:O.a.Init};N(i.Outlook,n)}});let t=[e,N(i.OutlookGroup),...n,N(i.TeamsCalendars)];if(Object(f.j)("cal-multiAccounts-groups")){const e=Object(E.n)().map(e=>{if(Object(u.h)(e.userIdentity)){const n={userIdentity:e.userIdentity,source:O.a.Init};N(i.OutlookGroup,n)}});t=t.concat(e)}await Promise.all(t)}function A(e,n){const{calendarAccountLoadMap:t}=o(),a=l(n,e);return t.get(a).loadState}Object(a.orchestrator)(O.f,e=>{const{userIdentity:n,source:t}=e,a={userIdentity:n,source:t};N(i.Outlook,a),Object(f.j)("cal-multiAccounts-groups")&&N(i.OutlookGroup,a)}),t.d(n,"g",(function(){return m})),t.d(n,"b",(function(){return b})),t.d(n,"f",(function(){return N})),t.d(n,"a",(function(){return i})),t.d(n,"c",(function(){return j})),t.d(n,"e",(function(){return C})),t.d(n,"d",(function(){return A}))},907:function(e,n,t){"use strict";function a(e){return e>=200&&e<300}t.d(n,"a",(function(){return a}))},915:function(e,n,t){"use strict";var a=t(945),r=t(927),i=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,c=o?function(e){return null==e?[]:(e=Object(e),Object(a.a)(o(e),(function(n){return i.call(e,n)})))}:r.a;n.a=c},922:function(e,n,t){"use strict";function a(e){let n=0;const t=[];function a(){n-=1,t.length>0&&t.shift()()}return{add:function(r){return new Promise((i,o)=>{const c=()=>{n+=1,r().then(e=>{a(),i(e)},e=>{a(),o(e)})};n===e?t.push(c):c()})},getRunningCount:()=>n,getQueueLength:()=>t.length}}t.d(n,"a",(function(){return a}))},923:function(e,n,t){"use strict";t.d(n,"e",(function(){return l})),t.d(n,"d",(function(){return s})),t.d(n,"b",(function(){return u})),t.d(n,"c",(function(){return f})),t.d(n,"a",(function(){return m}));const a="A-Za-z------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------0-9------------------------------------",r=new RegExp("^(["+a+"!#$%&'*+/=?^_`{|}~-](?:["+a+".!#$%&'*+/=?^_`{|}~-]*["+a+"!#$%&'*+/=?^_`{|}~-])?)(?=@)"),i=new RegExp('^("['+a+'.!#$%&\'*+\\/=?^_`{|}~\\-(),:;<>@[\\\\\\]" ]*")(?=@)'),o=new RegExp("^["+a+"-]+(?:\\.["+a+"-]+)*$"),c=/[^\\]"/,d=/^[A-Za-z0-9_-]+:.*$/,l=e=>{const n=e.match(r);if(n)return-1!==n[0].indexOf("..")?null:n[0];const t=e.match(i);if(t){const e=c.exec(t[0]);return e&&e.index!==t[0].length-2?null:t[0]}return null};function s(e){if(!e)return!1;const n=l(e);return!!n&&!!e.substring(n.length+1).match(o)}function u(e){return d.test(e)}function f(e){return!l(e)}function m(e){return s(e)||u(e)}},925:function(e,n,t){"use strict";n.a=function(e,n){for(var t=-1,a=n.length,r=e.length;++t<a;)e[r+t]=n[t];return e}},926:function(e,n,t){"use strict";var a=t(925),r=t(262);n.a=function(e,n,t){var i=n(e);return Object(r.a)(e)?i:Object(a.a)(i,t(e))}},927:function(e,n,t){"use strict";n.a=function(){return[]}},942:function(e,n,t){"use strict";var a=t(573),r=t(720),i=Object(r.a)(Object.keys,Object),o=Object.prototype.hasOwnProperty;n.a=function(e){if(!Object(a.a)(e))return i(e);var n=[];for(var t in Object(e))o.call(e,t)&&"constructor"!=t&&n.push(t);return n}},945:function(e,n,t){"use strict";n.a=function(e,n){for(var t=-1,a=null==e?0:e.length,r=0,i=[];++t<a;){var o=e[t];n(o,t,e)&&(i[r++]=o)}return i}},965:function(e,n,t){"use strict";var a=t(984);t.d(n,"a",(function(){return a.a}))},984:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(3);const r=Object(a.action)("logServiceCallForDiagnostics",e=>({serviceCall:e}))},985:function(e,n,t){"use strict";function a(e){return Object.assign({__type:"RecurringMasterItemId:#Exchange"},e)}t.d(n,"a",(function(){return a}))},990:function(e,n,t){"use strict";t.d(n,"a",(function(){return d}));var a=/[\(\[\{\<][^\)\]\}\>]*[\)\]\}\>]/g,r=/[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g,i=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i,o=/\s+/g,c=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/;function d(e,n,t){return e?(e=function(e){return e=(e=(e=(e=e.replace(a,"")).replace(r,"")).replace(o," ")).trim()}(e),c.test(e)||!t&&i.test(e)?"":function(e,n){var t="",a=e.split(" ");return 2===a.length?(t+=a[0].charAt(0).toUpperCase(),t+=a[1].charAt(0).toUpperCase()):3===a.length?(t+=a[0].charAt(0).toUpperCase(),t+=a[2].charAt(0).toUpperCase()):0!==a.length&&(t+=a[0].charAt(0).toUpperCase()),n&&t.length>1?t.charAt(1)+t.charAt(0):t}(e,n)):""}},991:function(e,n,t){"use strict";t.d(n,"a",(function(){return r}));var a=t(923);function r(e){return Object(a.a)(e.EmailAddress)||e.ItemId&&"PrivateDL"==e.MailboxType}}}]);
//# sourceMappingURL=owa.391.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.391.js'] = 1;