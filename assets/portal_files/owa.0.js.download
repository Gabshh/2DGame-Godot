(window.$wj=window.$wj||[]).push([[0],{260:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u}));var o=n(188);let r=null;const s=9e4;function c(){return null==r&&(r=new o.Cache),r}function i(e){return c().get(e)}function a(e){return c().del(e)}function u(e,t){c().put(e,t,s)}},320:function(e,t,n){"use strict";function o(e){return{error:{subErrorCode:null==e?void 0:e.SubErrorCode},accessToken:null==e?void 0:e.AccessToken,accessTokenExpiry:null==e?void 0:e.AccessTokenExpiry}}n.d(t,"a",(function(){return o}))},404:function(e,t,n){"use strict";n.r(t);var o=n(458),r=n(188),s=n(260),c=n(456),i=n(227),a=n(202),u=n(213),l=n(132),d=n(146),f=n(135);const h="OWA_GetDelegationAccessToken";let k={};function p(e){return Object(l.a)("resourceTokenFromHost")?async function(e){const t=Object(d.c)()?Object(d.a)():void 0;if((null==t?void 0:t.isResourceTokenPrefetchEnabled)&&await t.isResourceTokenPrefetchEnabled()&&t.getResourceToken){const n=await t.getResourceToken(Object(f.a)(),e.wwwAuthenticateHeader,e.sourceId,e.scope);if(n)return n}return{}}(e):async function(e){let t=encodeURIComponent(e.client_id+e.scope+e.requestId),n={};try{n=await async function(e,t,n){let o=function(e){let t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+i.stringify(t)}(e);if(!t.document.getElementById(n)){const r=t.document.createElement("iframe");return r.src=o.toString(),r.style.display="none",r.id=n,t.document.body.appendChild(r),new Promise((o,s)=>{k[n]=function(n){let c={};try{r.contentWindow&&r.contentWindow.location.host==t.location.host&&(c=function(e,t){let n=i.parse(e),o={};n.access_token?(o.AccessToken=n.access_token,o.AccessTokenExpiry=Object(a.a)(Date.now(),parseInt(n.expires_in)).toISOString(),o.TokenResultCode=0):"login_required"==n.error||"interaction_required"==n.error||"consent_required"==n.error?(o.TokenResultCode=3,Object(u.d)(h+" MSA Failure Unauthorized",{error:n.error,param:e,requestId:t})):(o.TokenResultCode=2,Object(u.d)(h+" MSA Failure",{error:n.error,param:e,requestId:t}));return o}(r.contentWindow.location.hash.substring(1),e.requestId))}catch(t){Object(u.d)(h+" Hash Param Parsing Failure ",{err:t.toString(),message:t.message,stk:t.stack||"",scope:e.scope,uri:e.redirect_uri,requestId:e.requestId}),c.TokenResultCode=2,s(c)}o(c)},r.addEventListener("load",k[n],!1)})}return{TokenResultCode:2}}(e,window,t)}catch(e){n.TokenResultCode=2}finally{!function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",k[e]),t.document.body.removeChild(n),delete k[e])}(t,window)}return n}(e)}const m=3,T=1500;let g;function b(e){return new Promise((t,n)=>{(null==g&&(g=new c.a(m,w,T)),g).add({onFulfilled:t,onRejected:n,options:e})})}function w(e){return p(e.options).then(t=>{e.onFulfilled(t)}).catch(t=>{e.onRejected(t)}),Promise.resolve()}var v=n(326),O=n(320);let j=null;const A="OWA_GetDelegationAccessToken",y="https://login.live.com/oauth20_authorize.srf",R="/owa/auth/dt.aspx",I="292841";async function _(e,t,n,o,r){let c,i={scope:e,client_id:"",authorization_uri:"",redirect_uri:"",requestId:n||Object(v.a)(),sourceId:r};try{return c=await async function(e,t,n){let o=function(e){return e.client_id+e.scope+(e.sourceId||"")}(e),r=function(e,t){const n=e.get(t);let o=void 0;if(null==n?void 0:n.AccessTokenExpiry){new Date(n.AccessTokenExpiry)>new Date(Date.now())&&(o=n)}return o}(C(),o);if(null==r?void 0:r.AccessToken)return n?Object(O.a)(r):r.AccessToken;{let r,c=Object(s.a)(o);return c?r=c:(r=b(e),Object(s.b)(o,r)),r.then(e=>(function(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){const n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&C().put(e,t,n)}}(o,e),Object(s.c)(o),n?Object(O.a)(e):e.AccessToken)).catch(n=>{Object(s.c)(o),Object(u.d)(A,{category:"Promise_For_Token_Request_Failed",err:n?n.toString():"",message:n?n.message:"",scope:e.scope,requestId:e.requestId,api:t})})}}((a=i,a.redirect_uri=Object(f.a)()+R,a.authorization_uri=y,a.client_id=I,a),void 0,o),c}catch(n){return Object(u.d)(A+" GetDelegationToken Operation failed ",{err:n.toString(),message:n.message,stk:n.stack||"",scope:e,requestId:i.requestId,api:t}),c}var a}function C(){return null==j&&(j=new r.Cache),j}var E=n(10),x=n(411);let S=!1;function D(){S||(!function(){let e=Object(x.a)("/owa");Object(E.b)({baseUrl:e})}(),S=!0)}var q={NoUserLogin:"AADSTS50058",InvalidResourceUrl:"AADSTS50001",NoPreAuth:"AADSTS65001",UserAborted:"AADSTS65004",NotConsent:"AADSTS70011"};function F(e,t,n,o,r){n?e.acquireTokenPopup(t,null,n,r):e.acquireToken(t,(function(n,s){!function(e,t){if(!e)return!1;if(e.indexOf(q.NoUserLogin)>=0)return!0;if(e.indexOf(q.NoPreAuth)>=0&&t)return!0;return!1}(n,o)?r(n,s):e.acquireTokenPopup(t,null,null,r)}))}var P=n(20);const U=new P.c(()=>n.e(1131).then(n.bind(null,19865))),L=new P.a(U,e=>e.createAdalAuthenticationContext);var N=n(144);let H=(e,t,n,o,r)=>(s,c)=>{s||!c?r(s,null):(e.getCachedUser(),F(e,t,n,o,r))};const M="adalIdTokenFrame";function z(e,t,n,o,r){e.config.displayCall=function(s){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(s),window.detectUserCachedCallback=H(e,t,n,o,r),function(e,t){e._addAdalFrame(M).src="about:blank",e._loadFrame(t+"&prompt=none",M)}(e,s)},e.login()}var W=n(38);async function G(e,t,n,o,r,s){var c,i;const a=await async function(){const e=await Object(N.a)({});let t;if(0===(null==e?void 0:e.ResultCode)&&(null==e?void 0:e.AuthenticationUrl)){const n=e.AuthenticationUrl.split("/");t=n[0]+"//"+n[2]+"/"}return t||"https://login.microsoftonline.com/"}(),u=await L.importAndExecute(a,e,t),l=Object(W.a)(),d=null===(c=l.SessionSettings)||void 0===c?void 0:c.UserPrincipalName,f=null===(i=l.SessionSettings)||void 0===i?void 0:i.UserEmailAddress;u._user={profile:{upn:d||f}},u.getCachedUser()?F(u,n,o,r,s):z(u,n,o,r,s)}n.d(t,"getAccessTokenforResource",(function(){return o.b})),n.d(t,"getAccessTokenforResourceAsLazy",(function(){return o.c})),n.d(t,"getDelegationTokenForOwa",(function(){return _})),n.d(t,"bootstrap",(function(){return D})),n.d(t,"getAccessTokenOnBehalfOfResource",(function(){return G})),n.d(t,"AdalErrorCode",(function(){return q}))},456:function(e,t,n){"use strict";class o{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return o}))},458:function(e,t,n){"use strict";var o=n(188),r=n(229),s=n(202);function c(e){return Object.assign({__type:"TokenRequest:#Exchange"},e)}var i=n(54),a=n(35);var u=n(291),l=n(135),d=n(146),f=n(132),h=n(2),k=n(47),p=n(213),m=n(226);const T="OWA_GetAccessTokenForResource",g=["requestnotcomplete","requesttimeout"];async function b(e,t,n,o,r,s,c,i){const a=await Object(u.a)(i),h=Object(l.a)();if(a&&(e==h||e==h+"/"))return{AccessToken:a};if(e.toLowerCase().indexOf("/notificationchannel")>0||e.toLowerCase().indexOf("/outlookimageproxy.azurewebsites.net")>0)return w(e,t,n,!1,o,r,c,a,i);if(Object(f.a)("resourceTokenFromHost")){const t=Object(d.c)()?Object(d.a)():void 0;if((null==t?void 0:t.isResourceTokenPrefetchEnabled)&&await t.isResourceTokenPrefetchEnabled()&&t.getResourceToken){const n=await t.getResourceToken(e,s,i);if(n)return n}}return w(e,t,n,!0,o,r,c,a,i)}async function w(e,t,n,o=!0,r,s,i,u,l){var d;const f={isUserActivity:!1,datapoint:{customData:{Scenario:T,Resource_Url:e,Retry_attempt:t,Request_Id:n,Target_Tenant_Id:s||"",Api:r||""},headersCustomData:e=>({TokenResultDetails:e.get("x-tokenresult")||"",ServerRequestId:e.get("request-id")||""}),jsonCustomData:e=>{var t;return{TokenStatus:(null===(t=null==e?void 0:e.TokenResultCode)||void 0===t?void 0:t.toString())||2}},datapointOptions:{isCore:"lamp152"==(null===(d=Object(h.y)())||void 0===d?void 0:d.toLowerCase())||Object(k.j)("auth-logAllDataPointForTokenFetching")}},returnFullResponseOnSuccess:!0,sourceId:l};u&&(f.headers=new Headers,f.headers.set("authorization",Object(m.a)(u)));let p=c({Resource:e,TargetTenantId:s,PreferIdpToken:i});o&&(p.UserToken=u);const g=await function(e,t){return void 0===e||e.__type||(e=c(e)),Object(a.a)("GetAccessTokenforResource",e,t)}(p,f);return await g.json()}async function v(e,t,n,o,r,s,c,a,u){return t<1?Promise.reject(new Error("Max retrying limit (1) reached.")):b(e,t,o,r,s,c,a,u).catch(l=>{var d,f,m,b;return function(e){var t,n;const o=e,r=null!==(n=null===(t=null==o?void 0:o.fetchErrorType)||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"";return-1==g.indexOf(r)}(l)&&Object(i.a)(n).then(()=>v(e,t-1,2*n,o,r,s,c,a,u)),Object(p.d)(`${T}::NonTransientError`,{err:null!==(d=null==l?void 0:l.toString())&&void 0!==d?d:"",message:null!==(f=null==l?void 0:l.message)&&void 0!==f?f:"",stk:null!==(m=null==l?void 0:l.stack)&&void 0!==m?m:"",resource:e,requestId:o,apiName:null!=r?r:""},{isCore:"lamp152"==(null===(b=Object(h.y)())||void 0===b?void 0:b.toLowerCase())||Object(k.j)("auth-logAllDataPointForTokenFetching")}),Promise.reject(l)})}var O=n(456);const j=1,A=500;let y;function R(e,t,n,o,r,s,c){return new Promise((i,a)=>{(null==y&&(y=new O.a(j,I,A)),y).add({onFulfilled:i,onRejected:a,resource:e,requestId:t,apiName:n,targetTenantId:o,wwwAuthenticateHeader:r,preferIdpToken:s,sourceId:c})})}function I(e){return z(e.resource,e.apiName,e.requestId,e.targetTenantId,e.wwwAuthenticateHeader,e.preferIdpToken,e.sourceId,!0).then(t=>{e.onFulfilled(t)}).catch(t=>{e.onRejected(t)}),Promise.resolve()}var _=n(260),C=n(326),E=n(320),x=n(551),S=n(10);n.d(t,"b",(function(){return L})),n.d(t,"c",(function(){return N})),n.d(t,"a",(function(){return z}));const D=1,q=8e3,F=3,P=1500;let U=null;async function L(e,t,n,o,r,s,c){n=n||Object(C.a)();let[i,a]=N(e,t,n,o,r,!1,s,c);return i||(i=await a),i}function N(e,t,n,o,r,s,c,i){return Object(k.j)("auth-msaljs-fetchResourceToken")&&Object(f.a)("msalTokenFetch")&&Object(x.a)(e)?[void 0,H(e,t,n,o,r,s,c,i)]:M(e,t,n,o,r,s,c,i)}async function H(e,t,n,o,r,s,c,i){const a=Object(S.a)();var u=(null==a?void 0:a.getMsalToken)?await a.getMsalToken(e):await x.b.importAndExecute(e);if(null==u?void 0:u.AccessToken)return s?Object(E.a)(u):u.AccessToken;{let[a,u]=M(e,t,n,o,r,s,c,i);return null!=a?a:u}}function M(e,t,n,o,s,c,i,a){n=n||Object(C.a)();const u=G(e,o,i,a);let l;if(s||(l=function(e,t){const n=e.get(t);let o=void 0;if((null==n?void 0:n.AccessTokenExpiry)&&n.AccessToken){Object(r.a)(new Date(n.AccessTokenExpiry),-D)>new Date(Date.now())&&(o=n)}return o}(W(),u)),l)return[c?Object(E.a)(l):l.AccessToken,void 0];{let r,l=Object(_.a)(u);return l?r=l:(r=R(e,n,t,o,s,i,a),Object(_.b)(u,r)),[void 0,r.then(e=>(Object(_.c)(u),c?Object(E.a)(e):e.AccessToken)).catch(r=>{Object(_.c)(u),Object(p.d)(T,{category:"Promise_For_Token_Request_Failed",err:r?r.toString():"",message:r?r.message:"",stk:r?r.stack:"",resource:e,requestId:n,targetTenantId:o||"",api:t,wwwAuthenticateHeader:s||"",showFullTokenResponse:c||!1},{isCore:Object(k.j)("auth-logAllDataPointForTokenFetching")})})]}}async function z(e,t,n,o,r,c,i,a){let u=a?await v(e,F,P,n,t,o,r,c,i):await b(e,F,n,t,o,r,c,i);if(null!=u&&0==u.TokenResultCode&&null!=u.AccessTokenExpiry){u.ExpiresIn&&u.ExpiresIn>0&&(u.AccessTokenExpiry=Object(s.a)(Date.now(),u.ExpiresIn).toISOString());const a=G(e,o,c,i),l=new Date(u.AccessTokenExpiry).getTime()-Date.now()-q;l>0&&W().put(a,u,l,(function(s,a){z(e,t,n,o,r,c,i,!1).catch(e=>{Object(p.d)(T,{category:"Cache_Expired",err:e?e.toString():"",message:e?e.message:"",stk:e?e.stack:"",resource:s,requestId:n,targetTenantId:o||"",api:t,wwwAuthenticateHeader:r||"",preferIdpToken:c},{isCore:Object(k.j)("auth-logAllDataPointForTokenFetching")})})}))}return u}function W(){return null==U&&(U=new o.Cache),U}function G(e,t,n,o){let r=e;return t&&(r+="|"+t),n&&(r+="|IdpToken"),o&&(r+="|"+o),r}},551:function(e,t,n){"use strict";var o=n(20);let r={"https://loki.delve.office.com/":!0,"https://www.yammer.com/":!0,"https://web.yammer.com/teams":!0,"https://fe-26.qas.bing.net/compose":!0,"https://api.diagnostics.office.com":!0,"https://outlook.office365.com/connectors":!0,"https://api.office.net":!0,"https://clients.config.office.net/":!0,"https://outlook.office.com/FocusedInboxB2":!0,"https://outlook.office.com/search":!0,"https://augloop.office.com/v2":!0,"https://arc.msn.com/v4":!0,"https://outlook-sdf.office.com":!0,"https://outlook-sdf.office365.com":!0,"https://microsoft.sharepoint.com":!1,"https://microsoft-my.sharepoint-df.com":!1,"https://webdir.online.lync.com":!1,"https://chatsvcagg.teams.microsoft.com":!1,"https://teams.microsoft.com":!1,"https://graph.microsoft.com":!1,"https://outlook.office.com":!1,"https://outlook.office365.com":!1,"https://outlook-sdf.live.com":!1,"https://outlook.live.com":!1};function s(e){return r[e]}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));const c=new o.c(()=>n.e(1123).then(n.bind(null,19760))),i=new o.a(c,e=>e.fetchAccessTokenFromMsal)}}]);
//# sourceMappingURL=owa.0.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.0.js'] = 1;