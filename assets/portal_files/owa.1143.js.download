(window.$wj=window.$wj||[]).push([[1143],{10927:function(t,n,i){"use strict";i.r(n);var e=i(1761),a=i(47);function o(){return new Date(Date.now()).toLocaleTimeString()}function s(t,n,i){t.push(n),t.length>i&&t.splice(0,1)}var c=i(702);var r=Object(c.action)("addChannelDatapoint")((function(t,n){s(n.datapoints,{message:t,timestamp:o()},1e3)})),u=i(3431);const d="Channel";let f,l=!1;function p(t){!async function(){if(!l){l=!0,f={name:d,datapoints:[]};const t=await u.d.import(),n=await u.e.import(),i=t();n(f),f=i.loggers.get(d)}}(),r(t,f)}var b=i(1681);function g(t){let n="";if(t){const i=b.d.folderTable.get(t);i&&(n=i.displayName)}return n}function m(t){let n="";return t.Conversation?n=t.Conversation.ConversationTopic:t.Item&&(n=t.Item.Subject),n}var w=Object(c.action)("addNotificationDatapoint")((function(t,n){const i=t,e=t;s(n.datapoints,{id:t.id,type:t.EventType,folder:g(i.FolderId||e.folderId),subject:m(i),timestamp:o()},1e3)}));const D="Notifications";let j,v=!1;function h(t){!async function(){if(!v){v=!0,j={name:D,datapoints:[]};const t=await u.d.import(),n=await u.e.import(),i=t();n(j),j=i.loggers.get(D)}}(),w(t,j)}var O=Object(c.action)("addSubscriptionDatapoint")((function(t,n){var i;n.datapoints.push({id:t.subscriptionId,type:(null===(i=t.subscriptionParameters)||void 0===i?void 0:i.NotificationType)?t.subscriptionParameters.NotificationType:"",folder:t.subscriptionParameters?g(t.subscriptionParameters.FolderId):"",status:"Uninitialized",handlers:1,retries:0,error:""})})),S=Object(c.action)("disconnectSubscriptionDatapoint")((function(t,n){const i=n.datapoints;for(let n=0;n<i.length;n++)if(i[n].id===t){i[n].status="Disconnected";break}})),I=Object(c.action)("setSubscriptionDatapointStatus")((function(t,n,i,e,a,o){const s=o.datapoints;for(let o=0;o<s.length;o++)if(s[o].id===t)switch(s[o].handlers=i,s[o].retries=e,a&&(s[o].error=a),n){case 0:s[o].status="Uninitialized";break;case 3:s[o].status="Connected";break;case 2:s[o].status="Pending";break;case 1:s[o].status="Disconnected"}}));const y="Subscriptions";let T,C=!1;async function N(){if(!C){C=!0,T={name:y,datapoints:[]};const t=await u.d.import(),n=await u.e.import(),i=t();n(T),T=i.loggers.get(y)}}function P(t){N(),O(t,T)}function k(t,n,i){N(),I(t.subscriptionId,n.status,n.refs.length,n.retries,i,T)}function z(t){N(),S(t.subscriptionId,T)}var F=i(36);function U(t){F.h.warn(t)}function E(t){F.d(t)}async function L(){if(Object(a.j)("fwk-devTools")){const t=(await e.d.import())();t.on(e.a.ChannelData,p),t.on(e.a.NotificationData,h),t.on(e.a.SubscriptionAdded,P),t.on(e.a.SubscriptionRemoved,z),t.on(e.a.SubscriptionUpdated,k),t.on(e.a.TraceWarn,U),t.on(e.a.TraceError,E)}}i.d(n,"initializeNotificationDiagnostics",(function(){return L}))},3431:function(t,n,i){"use strict";var e=i(20),a=i(3),o=i(71);const s=(t,n,i)=>{let e=null;return{init:s=>{try{if(!e)return e=Object(a.createStore)(t,n),i(e()),Object.assign(Object.assign({},s),{[t]:e})}catch(n){Object(o.o)("DeclareDiagnosticFailed",{n_1:t,er:n.message})}return s},getIfInitialized:()=>e?e():null}};i.d(n,"e",(function(){return r})),i.d(n,"d",(function(){return u})),i.d(n,"f",(function(){return d})),i.d(n,"a",(function(){return f})),i.d(n,"b",(function(){return l})),i.d(n,"c",(function(){return s}));const c=new e.c(()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(7),i.e(364)]).then(i.bind(null,19532))),r=new e.a(c,t=>t.registerDiagnostics),u=(new e.b(c,t=>t.setSelectedPivot),new e.b(c,t=>t.getDiagnosticsLogState)),d=new e.a(c,t=>t.initializeDefaultDiagnostics),f=Object(e.d)(c,t=>t.DiagnosticsHost),l=(Object(e.d)(c,t=>t.DiagnosticsInspector),Object(e.d)(c,t=>t.TwoColumnInspector))}}]);
//# sourceMappingURL=owa.1143.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.1143.js'] = 1;