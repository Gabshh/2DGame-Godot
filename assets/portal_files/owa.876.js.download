(window.$wj=window.$wj||[]).push([[876],{11906:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(1845),o=n(3732);function s(){const e=Object(o.a)();return Object(a.c)(e)}},19621:function(e,t,n){"use strict";n.r(t);var a=n(20),o=n(3731),s=n(2989),c=n(6603),i=n(1675);const r=Object(a.e)(o.a,"reloadTableOnTriageActionFailClone",e=>{const{tableView:t}=e;u(t)}),l=Object(a.e)(s.a,"reloadTableOnTriageActionFailClone",e=>{u(Object(i.I)())});function u(e){e&&Object(c.a)(e)}var d=n(2128),b=n(71),O=n(702);let h=Object(O.action)("onLoadMoreRowsSucceeded")((function(e,t,n,a){e.isLoading=!1,a(e,t,n),e.currentLoadedIndex=e.rowKeys.length})),j=Object(O.action)("onLoadMoreRowsFailed")((function(e,t){e.isLoading=!1,Object(b.o)("TnS_LoadMoreRowsError",[e.tableQuery.listViewType,t])}));var f=n(1800),w=n(2222),y=n(2870);var g=n(2552),m=n(2553),T=n(4072),I=n(1701),p=n(2554),k=n(9386);var R=n(47),v=n(3442);function F(e,t){const n=e.rowKeys.length-1,a=e.tableQuery;return Object(R.j)("mon-messageList-useGqlForFindItem")?Object(w.h)(Object(i.k)(a),t,a.viewFilter,a.sortBy,Object(d.l)(a),a.focusedViewFilter,a.requestShapeName,Object(f.d)(a),void 0,Object(f.e)(a),a.categoryName,Object(i.l)(e,!0),e.rowKeys[n]).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),h(e,n,t.totalItemRowsInView,d.b)}).catch(t=>{const n=Object(y.a)(t);j(e,n)}):function(e,t,n,a,o,s,c,i,r,l){const u=Object(T.a)({FieldURIOrConstant:Object(m.a)({Item:Object(g.a)({Value:t})}),Item:Object(I.a)({FieldURI:"InstanceKey"})}),d=Object(p.a)({Item:u}),b=Object(k.a)({BasePoint:"Beginning",Condition:d,MaxEntriesReturned:n});return Object(w.b)(e,b,a,o,s,c,i,r,Object(w.g)(a),l)}(Object(i.k)(a),e.rowKeys[n],t,a.viewFilter,Object(v.a)(a),a.focusedViewFilter,a.requestShapeName,Object(f.e)(a),a.categoryName,Object(i.l)(e,!0)).then(t=>{"Success"===t.ResponseClass?h(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView,d.b):j(e,t.ResponseCode)},t=>{j(e)})}var L=n(3),x=n(2903);const V=50;async function C(e){if(!e)throw new Error("Selected tableview must not be null if loadMoreRows is being called.");if(e.currentLoadedIndex<e.rowKeys.length){if(e.rowKeys.length-e.currentLoadedIndex>=V)return void S(e,e.currentLoadedIndex+V);S(e,e.rowKeys.length)}if((0==e.tableQuery.type||2==e.tableQuery.type||Object(R.j)("grp-loadFolders")&&3==e.tableQuery.type)&&"spotlight"!==e.tableQuery.scenarioType)switch(Q(e),e.tableQuery.listViewType){case 0:await function(e,t){var n;const a=e.rowKeys.length-1,o=e.tableQuery,s=null===(n=Object(i.l)(e,!0))||void 0===n?void 0:n.Id;return Object(w.d)(o.folderId,t,o.viewFilter,o.sortBy,Object(d.l)(o),o.focusedViewFilter,o.requestShapeName,Object(f.d)(o),e.rowKeys[a],o.categoryName,s).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),h(e,n,t.totalConversationRowsInView,d.a)}).catch(t=>{const n=Object(y.a)(t);j(e,n)})}(e,V);break;case 1:await F(e,V)}else if(1===e.tableQuery.type){if("FindItem"===e.tableQuery.searchProvider)await x.b.importAndExecute(e,h,j);else{const t=e.rowKeys.length-1,n=e.tableQuery;t>n.lastIndexFetched&&(n.lastIndexFetched=t,await x.c.importAndExecute(t,e))}}}const Q=Object(L.mutatorAction)("setTableIsLoading",e=>{e.isLoading=!0}),S=Object(L.mutatorAction)("setTableCurrentLoadedIndex",(e,t)=>{e.currentLoadedIndex=t});var N=n(11906);function E(){setTimeout(()=>{const e=Object(N.a)();Object(c.a)(e)},3e3)}n.d(t,"reloadTableOnTriageActionFailOrchestrator",(function(){return r})),n.d(t,"reloadTableUponUndoWithoutNotificaitonChannel",(function(){return l})),n.d(t,"loadMoreInTable",(function(){return C})),n.d(t,"reloadInboxPostBoot",(function(){return E}))},2552:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"Constant:#Exchange"},e)}n.d(t,"a",(function(){return a}))},2553:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"FieldURIOrConstantType:#Exchange"},e)}n.d(t,"a",(function(){return a}))},2554:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"RestrictionType:#Exchange"},e)}n.d(t,"a",(function(){return a}))},4072:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"IsEqualTo:#Exchange"},e)}n.d(t,"a",(function(){return a}))},456:function(e,t,n){"use strict";class a{constructor(e,t,n){this.maxParallelTasks=e,this.taskCallback=t,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}add(e){this.taskList.unshift(e),this.scheduleTask()}clear(){this.taskList.splice(0,this.taskList.length)}canRunMoreTasks(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0}scheduleTask(){this.canRunMoreTasks()&&setTimeout(()=>{this.tryRunTask()},this.taskDelay)}onTaskComplete(){this.numberOfTasksRunning--,this.scheduleTask()}tryRunTask(){if(this.canRunMoreTasks()){let e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(()=>{this.onTaskComplete()}).catch(()=>{this.onTaskComplete()}),this.scheduleTask()}}}n.d(t,"a",(function(){return a}))},6603:function(e,t,n){"use strict";var a=n(71),o=n(2128),s=n(702);let c=Object(s.action)("onReloadTableSucceeded")((function(e,t,n){Object(o.h)(t,e,n,!0,!1,"MergeOnReload"),e.currentLoadedIndex=e.rowKeys.length})),i=Object(s.action)("onReloadTableFailed")((function(e){Object(a.o)("TnS_ReloadError",[e])}));var r=n(2870),l=n(47),u=n(3193),d=n(2222),b=n(1845),O=n(3442),h=n(456),j=n(1675),f=n(1800);const w=new h.a(1,(async function(e){const t=e.tableViewId,n=Object(j.L)().tableViews.get(t);if(!n)return Promise.resolve();const s=Math.max(n.currentLoadedIndex,b.a);switch(n.tableQuery.listViewType){case 0:await function(e,t){var n;const a=e.tableQuery,s=Object(j.l)(e,!0),l=null===(n=s)||void 0===n?void 0:n.Id;return Object(d.d)(a.folderId,t,a.viewFilter,a.sortBy,Object(o.l)(a),a.focusedViewFilter,a.requestShapeName,Object(f.d)(a),void 0,a.categoryName,l).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),c(e,n,t.totalConversationRowsInView)}).catch(e=>{const t=Object(r.a)(e);i(t)})}(n,s);break;case 1:await function(e,t){const n=e.tableQuery;return Object(l.j)("mon-messageList-useGqlForFindItem")?Object(d.h)(Object(j.k)(n),t,n.viewFilter,n.sortBy,Object(o.l)(n),n.focusedViewFilter,n.requestShapeName,Object(f.d)(n),void 0,Object(f.e)(n),n.categoryName,Object(j.l)(e,!0)).then(t=>{let n=[];t.edges&&(n=t.edges.map(e=>e.node)),c(e,n,t.totalItemRowsInView)}).catch(e=>{const t=Object(r.a)(e);i(t)}):Object(d.c)(Object(j.k)(n),0,t,n.viewFilter,Object(O.a)(n),n.focusedViewFilter,n.requestShapeName,void 0,Object(f.e)(n),n.categoryName,Object(j.l)(e,!0)).then(t=>{"Success"==t.ResponseClass?c(e,t.RootFolder.Items,t.RootFolder.TotalItemsInView):i(t.ResponseCode)}).catch(e=>{i()})}(n,s)}0==n.tableQuery.type&&Object(u.a)(n.tableQuery.folderId);return Object(a.o)("ReloadTable",[s],{sessionSampleRate:10}),Promise.resolve()}),150);t.a=Object(s.action)("reloadMailListTableAction")((function(e){1===e.tableQuery.type||Object(j.V)(e.tableQuery.folderId)||w.add({tableViewId:e.id})}))},9386:function(e,t,n){"use strict";function a(e){return Object.assign({__type:"SeekToConditionPageView:#Exchange"},e)}n.d(t,"a",(function(){return a}))}}]);
//# sourceMappingURL=owa.876.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.876.js'] = 1;