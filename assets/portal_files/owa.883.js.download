(window.$wj=window.$wj||[]).push([[883],{1263:function(o,t,e){"use strict";e.d(t,"a",(function(){return c}));var r=e(1),n=e(0),i=e(398),a=e(507),l=e(612),c=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Object(r.__extends)(t,o),t.prototype.render=function(){return n.createElement(l.a,Object(r.__assign)({},this.props,{primary:!0,onRenderDescription:i.b}))},t=Object(r.__decorate)([Object(a.a)("PrimaryButton",["theme","styles"],!0)],t)}(n.Component)},13895:function(o,t,e){var r=e(18242);"string"==typeof r&&(r=[[o.i,r,""]]);var n={transform:void 0};e(77)(r,n);r.locals&&(o.exports=r.locals)},18241:function(o){o.exports=JSON.parse('{"b":"y9b","a":"z9b"}')},18242:function(o,t,e){(t=o.exports=e(76)(!1)).push([o.i,".V0I5Z6KURX_1mHlgi1Gxt{min-height:70px;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}html[dir] .V0I5Z6KURX_1mHlgi1Gxt{padding:10px;background-color:var(--white)}html[dir=ltr] .V0I5Z6KURX_1mHlgi1Gxt{margin:8px 20px 10px 8px}html[dir=rtl] .V0I5Z6KURX_1mHlgi1Gxt{margin:8px 8px 10px 20px}.V0I5Z6KURX_1mHlgi1Gxt:hover{cursor:pointer}._2IXYQE4F8_WDXtCD1AKL0E{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;cursor:pointer}html[dir] ._2IXYQE4F8_WDXtCD1AKL0E{padding-bottom:10px}._9FWy5Y93rs9CekowJadQx{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}._2NVy78nBycH8DCaIgK6osT{max-width:100px}html[dir=ltr] ._2NVy78nBycH8DCaIgK6osT{padding:10px 0 0 12px}html[dir=rtl] ._2NVy78nBycH8DCaIgK6osT{padding:10px 12px 0 0}html[dir] .vpop-xhOV9OBRykQb0e-G{padding:0 15px 0 15px}._12u8TA54vJZQoDGV0UniIH{font-size:20px;font-weight:600}html[dir=ltr] ._12u8TA54vJZQoDGV0UniIH{padding-left:10px}html[dir=rtl] ._12u8TA54vJZQoDGV0UniIH{padding-right:10px}._2dmClI5HLxQBAUJJmGA4V0{position:absolute;height:70px;width:auto}html[dir] ._2dmClI5HLxQBAUJJmGA4V0{border-width:0;margin:0}html[dir=ltr] ._2dmClI5HLxQBAUJJmGA4V0,html[dir=rtl] ._2dmClI5HLxQBAUJJmGA4V0{left:0;right:0}",""]),t.locals={commercialHeaderContainer:"V0I5Z6KURX_1mHlgi1Gxt",commercialLogoContainer:"_2IXYQE4F8_WDXtCD1AKL0E",commercialButtonContainer:"_9FWy5Y93rs9CekowJadQx",commercialLogo:"_2NVy78nBycH8DCaIgK6osT",commercialButton:"vpop-xhOV9OBRykQb0e-G",commercialName:"_12u8TA54vJZQoDGV0UniIH",logoIFrame:"_2dmClI5HLxQBAUJJmGA4V0"}},19742:function(o,t,e){"use strict";e.r(t);var r=e(0),n=e(23),i=e(612),a=e(1263),l=e(6),c=e(18241),s=e(13895),d=e.n(s);var u=e(47),b=e(71),p=e(1766),m=e(57);function g(o){return o&&(o.indexOf("promotions")>-1||o.indexOf("newsletter")>-1||o.indexOf("receipt")>-1||o.indexOf("social")>-1||o.indexOf("promotionsplus")>-1)}var h=e(975);let x;var k=Object(n.a)((function(o){r.useEffect(()=>{n()});const t=t=>{o.onClick()};Object(h.a)("blur",()=>{x&&t()});const e=r.useRef(null),n=()=>{e.current&&(e.current.onload=()=>{var t,r,n,i,a,l,c,s,d;if(e.current){e.current.onload=null,e.current.setAttribute("scrolling","no");const u=null===(t=e.current)||void 0===t?void 0:t.contentDocument;u&&!(null==u?void 0:u.body)&&u.write('<body><div id="owaInboxShopping"></div></body>');const b=null===(n=null===(r=e.current)||void 0===r?void 0:r.contentWindow)||void 0===n?void 0:n.document.createElement("div");b&&(b.id="owaInboxShopping",null===(a=null===(i=e.current)||void 0===i?void 0:i.contentWindow)||void 0===a||a.document.body.appendChild(b));const p=null===(c=null===(l=null==e?void 0:e.current)||void 0===l?void 0:l.contentWindow)||void 0===c?void 0:c.document.createElement("script");p&&(p.src=o.clickUrl,p.type="text/javascript",null===(d=null===(s=e.current)||void 0===s?void 0:s.contentWindow)||void 0===d||d.document.body.appendChild(p)),e.current.src="about:blank"}})};return r.createElement(r.Fragment,null,e&&r.createElement("iframe",{onMouseOver:()=>{x=!0},onMouseOut:()=>{x=!1},ref:e,className:d.a.logoIFrame,allowTransparency:!0}),(o=>r.createElement("div",{onClick:t},r.createElement("img",{className:d.a.commercialLogo,src:o})))(o.imageUrl))})),C=e(326),f=e(11873),B=e(13477),v=Object(n.a)((function(o){const{messageSenderName:t,messageSender:e,hashtag:n}=o,s=g(n),[h,x]=r.useState(!1),[v,y]=r.useState(""),[w,_]=r.useState(""),[O,j]=r.useState(""),[H,S]=r.useState(""),[I,T]=r.useState(""),[E,D]=r.useState({}),L={isCore:!0},U=r.useRef(new b.b("InboxShopping_RenderTime"));r.useEffect(()=>(Object(B.a)(Object(C.a)()),s&&Object(b.o)("InboxShopping_hasClassifier",{guid:Object(f.a)(),classifier:n},L),P(),()=>{null==U||U.current.endWithError("UserError")}),[]);const A=r.useCallback(()=>{Object(b.o)("InboxShopping_AnyClick",Object.assign(Object.assign({},E),{brandLogo:!!v,storeFrontUrl:!!O,siteUrl:!!w,affiliateLink:!!H}),L)},[E,v,O,w,H,L]),W=r.useCallback((o,t)=>{null==t||t.stopPropagation(),Object(b.o)(o,E,L),A(),H?window.open(H,"_blank"):w&&window.open(w,"_blank")},[w,H,E,L]),R=r.useCallback(()=>{W("InboxShopping_Header_Clicked")},[W]),G=r.useCallback(o=>{W("InboxShopping_VisitSite_Clicked",o)},[W]),N=r.useCallback(o=>{W("InboxShopping_BrandLogo_Clicked",o)},[W]),V=r.useCallback(o=>{o.stopPropagation(),Object(b.o)("InboxShopping_ShopOffers_Clicked",E,L),A(),window.open(O)},[O,E,L]),P=r.useCallback(async()=>{let o=e.substring(e.lastIndexOf("@")+1);if(s){const e=new b.b("InboxShopping_APILatency"),r=await function(o){return fetch("https://www.bing.com/inboxcommerce/api/v1/merchant?version=PREV3&MerchantDomain="+o,{method:"GET"})}(o);e.end();const i=await r.json();if(!Object(u.j)("rp-inboxShopping-UX")&&"Ok"==i.status&&i.merchantFound&&(Object(u.j)("rp-inboxShopping-UX-shopOffers")||Object(u.j)("rp-inboxShopping-UX-visitSiteOnly"))){x(!0),i.brandLogo&&y(i.brandLogo),i.siteURL&&_(i.siteURL),i.storefrontURL&&j(i.storefrontURL),i.affiliateLink&&S(i.affiliateLink),i.merchantName?T(i.merchantName):T(t),D({classifier:n,guid:Object(f.a)(),merchant:i.merchantName||t});const o=!(!i.siteURL&&!i.affiliateLink);Object(b.o)("InboxShopping_Render",{classifier:n,guid:Object(f.a)(),merchant:i.merchantName||t,brandLogo:!!i.brandLogo,visitSite:o,shopOffers:!!i.storefrontURL,siteUrl:!!i.siteURL,affiliateLink:!!i.affiliateLink,isPremium:Object(m.t)()},L)}null==U||U.current.end()}},[E,t,n,e,L,U.current]);return r.createElement("div",null,h&&r.createElement("div",{className:d.a.commercialHeaderContainer,onClick:R},r.createElement("div",{className:d.a.commercialLogoContainer},v?r.createElement("div",null,r.createElement(k,{imageUrl:v,clickUrl:H||w,onClick:N})):r.createElement(p.a,{name:I}),r.createElement("div",{className:d.a.commercialName},I)),r.createElement("div",{className:d.a.commercialButtonContainer},O&&Object(u.j)("rp-inboxShopping-UX-shopOffers")&&r.createElement("div",{className:d.a.commercialButton},r.createElement(i.a,{onClick:V},Object(l.b)(c.a))),(w||H)&&r.createElement("div",{className:d.a.commercialButton},r.createElement(a.a,{onClick:G},Object(l.b)(c.b))))))}));e.d(t,"CommercialMessageHeader",(function(){return v})),e.d(t,"hasRelevantHashtag",(function(){return g}))},515:function(o,t,e){"use strict";e.d(t,"b",(function(){return l})),e.d(t,"a",(function(){return c}));var r=e(1),n=e(8),i=e(183),a=function(){return{position:"absolute",width:1,right:31,top:8,bottom:8}};function l(o){var t,e,i,l,c,s=o.semanticColors,d=o.palette,u=s.buttonBackground,b=s.buttonBackgroundPressed,p=s.buttonBackgroundHovered,m=s.buttonBackgroundDisabled,g=s.buttonText,h=s.buttonTextHovered,x=s.buttonTextDisabled,k=s.buttonTextChecked,C=s.buttonTextCheckedHovered;return{root:{backgroundColor:u,color:g},rootHovered:{backgroundColor:p,color:h,selectors:(t={},t[n.HighContrastSelector]={borderColor:"Highlight",color:"Highlight"},t)},rootPressed:{backgroundColor:b,color:k},rootExpanded:{backgroundColor:b,color:k},rootChecked:{backgroundColor:b,color:k},rootCheckedHovered:{backgroundColor:b,color:C},rootDisabled:{color:x,backgroundColor:m,selectors:(e={},e[n.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},e)},splitButtonContainer:{selectors:(i={},i[n.HighContrastSelector]={border:"none"},i)},splitButtonMenuButton:{color:d.white,backgroundColor:"transparent",selectors:{":hover":{backgroundColor:d.neutralLight,selectors:(l={},l[n.HighContrastSelector]={color:"Highlight"},l)}}},splitButtonMenuButtonDisabled:{backgroundColor:s.buttonBackgroundDisabled,selectors:{":hover":{backgroundColor:s.buttonBackgroundDisabled}}},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},a()),{backgroundColor:d.neutralTertiaryAlt,selectors:(c={},c[n.HighContrastSelector]={backgroundColor:"WindowText"},c)}),splitButtonDividerDisabled:{backgroundColor:o.palette.neutralTertiaryAlt},splitButtonMenuButtonChecked:{backgroundColor:d.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:d.neutralQuaternaryAlt}}},splitButtonMenuButtonExpanded:{backgroundColor:d.neutralQuaternaryAlt,selectors:{":hover":{backgroundColor:d.neutralQuaternaryAlt}}},splitButtonMenuIcon:{color:s.buttonText},splitButtonMenuIconDisabled:{color:s.buttonTextDisabled}}}function c(o){var t,e,l,c,s,d,u,b,p,m=o.palette,g=o.semanticColors;return{root:{backgroundColor:g.primaryButtonBackground,border:"1px solid "+g.primaryButtonBackground,color:g.primaryButtonText,selectors:(t={},t[n.HighContrastSelector]=Object(r.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},Object(n.getHighContrastNoAdjustStyle)()),t["."+i.a+" &:focus"]={selectors:{":after":{border:"none",outlineColor:m.white}}},t)},rootHovered:{backgroundColor:g.primaryButtonBackgroundHovered,border:"1px solid "+g.primaryButtonBackgroundHovered,color:g.primaryButtonTextHovered,selectors:(e={},e[n.HighContrastSelector]={color:"Window",backgroundColor:"Highlight",borderColor:"Highlight"},e)},rootPressed:{backgroundColor:g.primaryButtonBackgroundPressed,border:"1px solid "+g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed,selectors:(l={},l[n.HighContrastSelector]=Object(r.__assign)({color:"Window",backgroundColor:"WindowText",borderColor:"WindowText"},Object(n.getHighContrastNoAdjustStyle)()),l)},rootExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootChecked:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootCheckedHovered:{backgroundColor:g.primaryButtonBackgroundPressed,color:g.primaryButtonTextPressed},rootDisabled:{color:g.primaryButtonTextDisabled,backgroundColor:g.primaryButtonBackgroundDisabled,selectors:(c={},c[n.HighContrastSelector]={color:"GrayText",borderColor:"GrayText",backgroundColor:"Window"},c)},splitButtonContainer:{selectors:(s={},s[n.HighContrastSelector]={border:"none"},s)},splitButtonDivider:Object(r.__assign)(Object(r.__assign)({},a()),{backgroundColor:m.white,selectors:(d={},d[n.HighContrastSelector]={backgroundColor:"Window"},d)}),splitButtonMenuButton:{backgroundColor:g.primaryButtonBackground,color:g.primaryButtonText,selectors:(u={},u[n.HighContrastSelector]={backgroundColor:"WindowText"},u[":hover"]={backgroundColor:g.primaryButtonBackgroundHovered,selectors:(b={},b[n.HighContrastSelector]={color:"Highlight"},b)},u)},splitButtonMenuButtonDisabled:{backgroundColor:g.primaryButtonBackgroundDisabled,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundDisabled}}},splitButtonMenuButtonChecked:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuButtonExpanded:{backgroundColor:g.primaryButtonBackgroundPressed,selectors:{":hover":{backgroundColor:g.primaryButtonBackgroundPressed}}},splitButtonMenuIcon:{color:g.primaryButtonText},splitButtonMenuIconDisabled:{color:m.neutralTertiary,selectors:(p={},p[n.HighContrastSelector]={color:"GrayText"},p)}}}},612:function(o,t,e){"use strict";var r=e(1),n=e(0),i=e(298),a=e(398),l=e(507),c=e(8),s=e(127),d=e(297),u=e(365),b=e(515),p=Object(s.c)((function(o,t,e){var r=Object(d.a)(o),n=Object(u.a)(o),i={root:{minWidth:"80px",height:"32px"},label:{fontWeight:c.FontWeights.semibold}};return Object(c.concatStyleSets)(r,i,e?Object(b.a)(o):Object(b.b)(o),n,t)}));e.d(t,"a",(function(){return m}));var m=function(o){function t(){return null!==o&&o.apply(this,arguments)||this}return Object(r.__extends)(t,o),t.prototype.render=function(){var o=this.props,t=o.primary,e=void 0!==t&&t,l=o.styles,c=o.theme;return n.createElement(i.a,Object(r.__assign)({},this.props,{variantClassName:e?"ms-Button--primary":"ms-Button--default",styles:p(c,l,e),onRenderDescription:a.b}))},t=Object(r.__decorate)([Object(l.a)("DefaultButton",["theme","styles"],!0)],t)}(n.Component)},975:function(o,t,e){"use strict";e.d(t,"a",(function(){return l}));var r=e(0);const n={};function i(o){var t;const e=null===(t=n[o.type])||void 0===t?void 0:t.values();if(e)for(const t of e)t(o)}function a(o){var t;return n[o]=null!==(t=n[o])&&void 0!==t?t:new Map}function l(o,t,e){const n=r.useRef();r.useEffect(()=>(function(o,t,e){const r=a(o);0===r.size&&window.addEventListener(o,i),r.set(t,e)}(o,n,t),()=>(function(o,t){const e=a(o);e.delete(t),0===e.size&&window.removeEventListener(o,i)})(o,n)),e)}}}]);
//# sourceMappingURL=owa.883.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.883.js'] = 1;