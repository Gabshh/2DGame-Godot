(window.$wj=window.$wj||[]).push([[845],{1112:function(e,n,r){"use strict";var a=r(579);const t="LocalCalendarEntry:#Exchange",i="LinkedCalendarEntry:#Exchange";function d(e,n){return e.CalendarGroups?e.CalendarGroups.map(r=>(function(e,n,r){var d;const l=null===(d=e.Calendars)||void 0===d?void 0:d.reduce((e,d)=>{var l;const s=function(e){var n,r;if(void 0!==e.CalendarFolderId)return null===(n=e.CalendarFolderId)||void 0===n?void 0:n.Id;const a=e;return a.IsGeneralScheduleCalendar?a.OwnerEmailAddress:null===(r=a.SharedFolderId)||void 0===r?void 0:r.Id}(d),u=s?null===(l=null==n?void 0:n.filter(e=>{var n;return(null===(n=e.FolderId)||void 0===n?void 0:n.Id)==s}))||void 0===l?void 0:l[0]:void 0;return function(e){return 7!==e.CalendarFolderType}(d)&&e.push(function(e,n,r){var d,l;const s={calendarId:{id:e.ItemId.Id,changeKey:e.ItemId.ChangeKey,mailboxInfo:r},CalendarName:1==e.CalendarFolderType&&n?null!==(d=n.DisplayName)&&void 0!==d?d:"":null!==(l=e.CalendarName)&&void 0!==l?l:"",CalendarFolderType:e.CalendarFolderType&&o(e.CalendarFolderType),CanShare:e.CanShare,HexColor:e.HexColor,HexColorString:e.HexColorString,IsTallyingResponses:e.IsTallyingResponses,ParentGroupId:e.ParentGroupId,CanEnableChangeNotifications:null==n?void 0:n.CanEnableChangeNotifications,ChangeNotificationStatus:null==n?void 0:n.ChangeNotificationStatus,EffectiveRights:(null==n?void 0:n.EffectiveRights)?Object(a.a)({ViewPrivateItems:n.EffectiveRights.ViewPrivateItems,Read:n.EffectiveRights.Read,CreateContents:n.EffectiveRights.CreateContents},"CalendarEffectiveRightsType"):void 0,FolderId:(null==n?void 0:n.FolderId)?Object(a.a)(n.FolderId,"FolderId"):void 0,ProviderId:null==n?void 0:n.ProviderId,SourceId:null==n?void 0:n.SourceId,CalendarColor:e.CalendarColor,IsGroupMailboxCalendar:e.IsGroupMailboxCalendar,AgendaMailDisabled:null==n?void 0:n.AgendaMailDisabled,CharmId:null==n?void 0:n.CharmId,DisplayOrder:e.DisplayOrder};if(e.__type==t){const n=e;return Object.assign(Object.assign({},s),{CanViewPrivateItems:n.CanViewPrivateItems,IsDefaultCalendar:n.IsDefaultCalendar,IsReadOnly:n.IsReadOnly,IsRemovable:n.IsRemovable,IsSharedWithMe:n.IsSharedWithMe,SharedOwnerEmailAddress:n.SharedOwnerEmailAddress,SharedOwnerName:n.SharedOwnerName,IsSchoolCalendar:n.IsSchoolCalendar,DefaultOnlineMeetingProvider:n.DefaultOnlineMeetingProvider,AllowedOnlineMeetingProviders:n.AllowedOnlineMeetingProviders,__typename:"LocalCalendarEntry"})}if(e.__type==i){const r=e;return Object.assign(Object.assign({},s),{OwnerEmailAddress:r.OwnerEmailAddress,OwnerName:r.OwnerName,IsGeneralScheduleCalendar:r.IsGeneralScheduleCalendar,IsOwnerEmailAddressInvalid:r.IsOwnerEmailAddressInvalid,SharedFolderId:r.SharedFolderId?Object(a.a)(r.SharedFolderId,"FolderId"):void 0,DefaultOnlineMeetingProvider:null==n?void 0:n.DefaultOnlineMeetingProvider,AllowedOnlineMeetingProviders:null==n?void 0:n.AllowedOnlineMeetingProviders,__typename:"LinkedCalendarEntry"})}{const n=e;return Object.assign(Object.assign({},s),{CanViewPrivateItems:n.CanViewPrivateItems,OwnerEmailAddress:n.OwnerEmailAddress,OwnerName:n.OwnerName,IsDefaultCalendar:n.IsDefaultCalendar,IsReadOnly:n.IsReadOnly,IsSharedWithMe:n.IsSharedWithMe,IsGeneralScheduleCalendar:n.IsGeneralScheduleCalendar,IsOwnerEmailAddressInvalid:n.IsOwnerEmailAddressInvalid,SharedFolderId:n.SharedFolderId,RemoteCategories:n.RemoteCategories?Object(a.a)(n.RemoteCategories,"MasterCategoryList",e=>Object.assign(Object.assign({},e),{MasterList:Object(a.b)(e.MasterList,"Category")})):void 0,SharedOwnerMailboxGuid:n.SharedOwnerMailboxGuid,DefaultOnlineMeetingProvider:n.DefaultOnlineMeetingProvider,AllowedOnlineMeetingProviders:n.AllowedOnlineMeetingProviders,__typename:"LocalCacheForRemoteCalendarEntry"})}}(d,u,r)),e},[]);return{calendarGroupId:{id:e.ItemId.Id,changeKey:e.ItemId.ChangeKey,mailboxInfo:r},serverGroupId:e.GroupId,GroupName:e.GroupName,GroupType:e.GroupType,DisplayOrder:e.DisplayOrder,Calendars:l,__typename:"CalendarGroup"}})(r,e.CalendarFolders,n)):[]}function o(e){if(7!==e&&6!==e)return e}r.d(n,"a",(function(){return d}))},19183:function(e,n,r){"use strict";r.r(n),r.d(n,"calendarGroupsQueryWeb",(function(){return o}));var a=r(6942),t=r(261),i=r(704),d=r(1112);const o=async(e,n,r,o)=>{const l=Object(i.a)(n.mailboxInfo),s=await Object(a.a)({Header:Object(t.b)()},l);if(null==s||!s.WasSuccessful){const e=`getCalendarFoldersOperation failed with Error code: ${s?s.ErrorCode:"null response"}`,n=new Error(e);return s?n.fetchErrorType="ServerFailure":n.networkError=!0,Promise.reject(n)}return Object(d.a)(s,n.mailboxInfo)}},261:function(e,n,r){"use strict";r.d(n,"b",(function(){return l})),r.d(n,"a",(function(){return s}));var a=r(382),t=r(479),i=r(477),d=r(467),o=r(10);function l(e){return e||(e=Object(o.a)().timezone),e?Object(a.a)({RequestServerVersion:"V2018_01_08",TimeZoneContext:Object(t.a)({TimeZoneDefinition:Object(i.a)({Id:e})})}):Object(a.a)({RequestServerVersion:"V2018_01_08"})}function s(e,n,r){return Object(d.a)({PropertySetId:e,PropertyName:n,PropertyType:r})}},382:function(e,n,r){"use strict";function a(e){return Object.assign({__type:"JsonRequestHeaders:#Exchange"},e)}r.d(n,"a",(function(){return a}))},467:function(e,n,r){"use strict";function a(e){return Object.assign({__type:"ExtendedPropertyUri:#Exchange"},e)}r.d(n,"a",(function(){return a}))},477:function(e,n,r){"use strict";function a(e){return Object.assign({__type:"TimeZoneDefinitionType:#Exchange"},e)}r.d(n,"a",(function(){return a}))},479:function(e,n,r){"use strict";function a(e){return Object.assign({__type:"TimeZoneContext:#Exchange"},e)}r.d(n,"a",(function(){return a}))},579:function(e,n,r){"use strict";function a(e,n,r){return null==e?null:Object.assign({__typename:n},r?r(e):e)}function t(e,n,r){return(null==e?void 0:e.map(e=>a(e,n,r)))||null}r.d(n,"a",(function(){return a})),r.d(n,"b",(function(){return t}))},6942:function(e,n,r){"use strict";r.d(n,"a",(function(){return t}));var a=r(35);function t(e,n){return Object(a.a)("GetCalendarFolders",e,n)}},704:function(e,n,r){"use strict";function a(e,n){return e?Object.assign({mailboxInfo:e},n):null!=n?n:void 0}r.d(n,"a",(function(){return a}))}}]);
//# sourceMappingURL=owa.845.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.845.js'] = 1;