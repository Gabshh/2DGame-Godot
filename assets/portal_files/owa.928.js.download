(window.$wj=window.$wj||[]).push([[928],{14182:function(e,t,i){"use strict";i.r(t);var r=i(3);let n=Object(r.createStore)("LeftNavIrisState",{message:"",userRedirectionUrl:"",textColor:"",iconUri:"",trackingBaseUri:"",impressionBaseUri:""})();var o=Object(r.mutatorAction)("setLeftNavIrisState",e=>{var t,i;let r=null==e?void 0:e.ad;r&&(n.message=r.body,n.iconUri=r.icon,n.textColor=r.textColor,n.userRedirectionUrl=r.ctaUrl,n.trackingBaseUri=null===(t=e.tracking)||void 0===t?void 0:t.baseUri,n.impressionBaseUri=null===(i=e.prm)||void 0===i?void 0:i._imp)}),c=i(404),a=i(283),s=i(57),u=i(6),l=i(71),f=i(296);const d="https://arc.msn.com/v4/api/selection?placement={0}&puid={1}&country={2}&locale={3}&nct=1{4}",m="service::ads.arcct.msn.com::MBI_SSL";async function p(e,t=""){var i;let r,n=new Headers;if(Object(f.a)())r=await Object(c.getDelegationTokenForOwa)(m);else{let[e,t]=Object(c.getAccessTokenforResourceAsLazy)("https://arc.msn.com/v4","OwaIrisStore");r=e||await t}n.append("authorization",`WLID1.1 t=${r}`);const o={method:"GET",headers:n},a=Object(u.e)();let l="";a&&(l=a.split("-").pop());let p=null===(i=Object(s.g)().SessionSettings)||void 0===i?void 0:i.UserPuid;return Promise.race([fetch(Object(u.c)(d,e,p,l,a,t),o).then(w),new Promise((e,t)=>{setTimeout(()=>t(),2e3)})])}function v(e,t){var i=e.replace(new RegExp("{ACTION}"),t);fetch(i,{method:"GET"}).then(w)}function b(e){fetch(e,{method:"GET"}).then(w)}const w=e=>(Object(a.a)(e.status)||Object(l.o)("FailedIrisApi",{st:e.status,te:e.statusText}),e.json());var h=i(47);const g="88000363",O="88000364";async function j(){const e=Object(h.j)("auth-EnableIrisTestCampaign")?g:O;let t=await p(e);t&&o(t)}let S=Object(r.createStore)("UpsellBizBarState",{message:"",userRedirectionText:"",userRedirectionUrl:"",textColor:"",backgroundColor:"",urlTextColor:"",iconUri:"",trackingBaseUri:"",impressionBaseUri:""})();var x=Object(r.mutatorAction)("setBizBarUpsellState",e=>{var t,i;let r=null==e?void 0:e.ad;r&&(S.message=r.bodyText,S.userRedirectionText=r.ctaText,S.textColor=r.bodyTextColor,S.urlTextColor=r.ctaTextColor,S.backgroundColor=r.backgroundColor,S.userRedirectionUrl=r.ctaUrl,S.trackingBaseUri=null===(t=e.tracking)||void 0===t?void 0:t.baseUri,S.impressionBaseUri=null===(i=e.prm)||void 0===i?void 0:i._imp)}),N=i(99);const C="88000453",U="88000452",T=Object(N.b)(),B={Edge:"1",Chrome:"2",MSIE:"3",Firefox:"4",Safari:"5","Edge Anaheim":"6",Opera:"7",Electron:"8",SkypeShell:"9",PhantomJS:"10"},k={"Chromium OS":"CHROMIUMOS",iOS:"IOS",Android:"ANDROID",Linux:"LINUX","Mac OS X":"MAC",Windows:{XP:"WINXP",7:"WIN7",8:"WIN8",8.1:"WIN81",10:"WIN10"}[T.osVersion]||"WIN"};async function I(){if(Object(h.j)("edge-iris-upsell-experiment")||Object(h.j)("iris-commercial-bizbar")){const e=Object(h.j)("edge-iris-upsell-testExperiment")?C:U;let t=`&OPSYS=${k[T.os]||"UNKNOWN"}&browser=${B[Object(N.a)().browser]||"11"}&${function(){let e="ofc_flights=";return Object(h.j)("iris-commercial-bizbar")&&(e=e.concat("iris-commercial-bizbar;")),Object(h.j)("edge-iris-upsell-experiment")&&(e=e.concat("edge-iris-upsell-experiment;")),e}()}`,i=await p(e,t);i&&x(i)}}i.d(t,"initializeLeftNavUpsellState",(function(){return j})),i.d(t,"makeBeaconCall",(function(){return v})),i.d(t,"makeImpressionCall",(function(){return b})),i.d(t,"initializeUpsellBarState",(function(){return I})),i.d(t,"ArcStore",(function(){return n})),i.d(t,"BizBarArcStore",(function(){return S}))},188:function(e,t,i){"use strict";function r(){var e=Object.create(null),t=0,i=0,r=0,n=!1;function o(t){r--,delete e[t]}this.put=function(t,i,n,c){if(void 0!==n&&("number"!=typeof n||isNaN(n)||n<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var s={value:i,expire:n+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){o(t),c&&c(t,i)}.bind(this),n)),e[t]=s,i},this.del=function(t){var i=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(i=!1)):i=!1,i&&o(t),i},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);r=0,e=Object.create(null),n&&(t=0,i=0)},this.get=function(o){var c=e[o];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return n&&t++,c.value;n&&i++,r--,delete e[o]}else n&&i++;return null},this.size=function(){return r},this.memsize=function(){var t,i=0;for(t in e)i++;return i},this.debug=function(e){n=e},this.hits=function(){return t},this.misses=function(){return i},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var i in e){var r=e[i];t[i]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,i){var r=JSON.parse(t),n=Date.now(),o=i&&i.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(o)if(e[c])continue;var a=r[c],s=a.expire-n;if(s<=0){this.del(c);continue}s=s>0?s:void 0,this.put(c,a.value,s)}return this.size()}}e.exports=new r,e.exports.Cache=r},213:function(e,t,i){"use strict";var r=i(36);let n;function o(){return null==n&&(n="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),n}var c=i(113);const a=500,s=[],u=[],l=[];let f=!0;function d(e,t){Object(r.g)((e,t,i,n)=>{f&&(t==r.b.Error&&u.push({message:e,error:n}),s.push({message:e,level:t}))}),e(p),t(p),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(a):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(a))}function m(e){const t=Object(c.a)(e);return f=!1,{traces:s,errors:u,network:l,usage:t}}function p(){f&&l.push(arguments)}i.d(t,"a",(function(){return d})),i.d(t,"b",(function(){return m})),i.d(t,"d",(function(){return c.b})),i.d(t,"c",(function(){return o}))},226:function(e,t,i){"use strict";function r(e){var t,i;if((null==e?void 0:e.length)>0){const r=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(i=e[1])||void 0===i?void 0:i.length)>0?r:void 0}}const n="bearer",o="msauth1.0",c=3600,a=86400,s=6e4,u=1e3;function l(e){if(e){const t=e.split(" ");return r(t)==n?t[1]:e}}function f(e,t){if(e){const i=r(e.split(" "));if(i){if(t){return(1e3*t-Date.now()-s)/u}return i==o?a:c}}}function d(e){var t;const i=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==i||"bearer"==i?e:`Bearer ${e}`}i.d(t,"c",(function(){return l})),i.d(t,"b",(function(){return f})),i.d(t,"a",(function(){return d}))},283:function(e,t,i){"use strict";var r=i(907);i.d(t,"a",(function(){return r.a}))},291:function(e,t,i){"use strict";i.d(t,"b",(function(){return a})),i.d(t,"a",(function(){return s}));var r=i(135),n=i(100),o=i(2);let c;function a(e){c=e}async function s(e){var t,i;if(Object(o.Q)())return n.f.importAndExecute(Object(r.a)());const a=c&&await c(void 0,e);if(a&&a.length>0){if("bearer"===(null===(t=null==a?void 0:a.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return a.split(" ")[1];if("msauth1.0"===(null===(i=null==a?void 0:a.split(" ")[0])||void 0===i?void 0:i.toLowerCase()))return a}}},907:function(e,t,i){"use strict";function r(e){return e>=200&&e<300}i.d(t,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.928.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.928.js'] = 1;