(window.$wj=window.$wj||[]).push([[870],{188:function(e,t,n){"use strict";function i(){var e=Object.create(null),t=0,n=0,i=0,r=!1;function o(t){i--,delete e[t]}this.put=function(t,n,r,u){if(void 0!==r&&("number"!=typeof r||isNaN(r)||r<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==u&&"function"!=typeof u)throw new Error("Cache timeout callback must be a function");var c=e[t];c?clearTimeout(c.timeout):i++;var s={value:n,expire:r+Date.now()};return isNaN(s.expire)||(s.timeout=setTimeout(function(){o(t),u&&u(t,n)}.bind(this),r)),e[t]=s,n},this.del=function(t){var n=!0,i=e[t];return i?(clearTimeout(i.timeout),!isNaN(i.expire)&&i.expire<Date.now()&&(n=!1)):n=!1,n&&o(t),n},this.clear=function(){for(var o in e)clearTimeout(e[o].timeout);i=0,e=Object.create(null),r&&(t=0,n=0)},this.get=function(o){var u=e[o];if(void 0!==u){if(isNaN(u.expire)||u.expire>=Date.now())return r&&t++,u.value;r&&n++,i--,delete e[o]}else r&&n++;return null},this.size=function(){return i},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){r=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var i=e[n];t[n]={value:i.value,expire:i.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var i=JSON.parse(t),r=Date.now(),o=n&&n.skipDuplicates;for(var u in i)if(i.hasOwnProperty(u)){if(o)if(e[u])continue;var c=i[u],s=c.expire-r;if(s<=0){this.del(u);continue}s=s>0?s:void 0,this.put(u,c.value,s)}return this.size()}}e.exports=new i,e.exports.Cache=i},19813:function(e,t,n){"use strict";n.r(t);var i=n(404),r=n(922),o=n(47),u=n(6),c=n(226);const s=1;let a=null;const f="/{0}/api/v2.0/me/connectednotes",l="NotesClient",d="NotesClientB2",v="NotesFabric";async function w(){let[e,t]=Object(i.getAccessTokenforResourceAsLazy)(window.location.origin,"OwaNotesFeedBootstrap");return e||(e=await t),a||(a=Object(r.a)(s)),a.add(()=>fetch(function(){let e=l;return Object(o.j)("notes-B2Endpoint")&&(e=d),Object(o.j)("notes-microRepoEndpoint")&&(e=v),Object(u.c)(f,e)}(),{method:"GET",headers:{Authorization:Object(c.a)(e),"Content-Type":"application/json"}}))}var p=n(283),h=n(4965),m=n(2642),b=n(132);let g=!1;async function j(){if(!Object(h.b)()&&!g){g=!0;const e=await w();if(Object(p.a)(e.status)){const t=(await e.json()).value;Object(b.a)("floodgate")&&t.length>0&&(m.b.import().then(e=>{e("SamsungNotesSynced")}),Object(h.a)())}}}n.d(t,"initializeOneNoteFeed",(function(){return j}))},213:function(e,t,n){"use strict";var i=n(36);let r;function o(){return null==r&&(r="undefined"!=typeof window&&null!=window.performance&&null!=window.performance.timing&&null!=window.performance.navigation&&null!=window.performance.getEntriesByName),r}var u=n(113);const c=500,s=[],a=[],f=[];let l=!0;function d(e,t){Object(i.g)((e,t,n,r)=>{l&&(t==i.b.Error&&a.push({message:e,error:r}),s.push({message:e,level:t}))}),e(w),t(w),o()&&(window.performance.setResourceTimingBufferSize?window.performance.setResourceTimingBufferSize(c):window.performance.webkitSetResourceTimingBufferSize&&window.performance.webkitSetResourceTimingBufferSize(c))}function v(e){const t=Object(u.a)(e);return l=!1,{traces:s,errors:a,network:f,usage:t}}function w(){l&&f.push(arguments)}n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return u.b})),n.d(t,"c",(function(){return o}))},226:function(e,t,n){"use strict";function i(e){var t,n;if((null==e?void 0:e.length)>0){const i=null===(t=e[0])||void 0===t?void 0:t.toLowerCase();return(null===(n=e[1])||void 0===n?void 0:n.length)>0?i:void 0}}const r="bearer",o="msauth1.0",u=3600,c=86400,s=6e4,a=1e3;function f(e){if(e){const t=e.split(" ");return i(t)==r?t[1]:e}}function l(e,t){if(e){const n=i(e.split(" "));if(n){if(t){return(1e3*t-Date.now()-s)/a}return n==o?c:u}}}function d(e){var t;const n=null===(t=null==e?void 0:e.split(" "))||void 0===t?void 0:t[0].toLowerCase();return"msauth1.0"==n||"bearer"==n?e:`Bearer ${e}`}n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return d}))},2642:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var i=n(20);const r=new i.c(()=>Promise.all([n.e(25),n.e(35),n.e(567)]).then(n.bind(null,4092))),o=new i.a(r,e=>e.loadAndInitializeFloodgateEngine),u=new i.b(r,e=>e.logFloodgateActivity)},283:function(e,t,n){"use strict";var i=n(907);n.d(t,"a",(function(){return i.a}))},291:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return s}));var i=n(135),r=n(100),o=n(2);let u;function c(e){u=e}async function s(e){var t,n;if(Object(o.Q)())return r.f.importAndExecute(Object(i.a)());const c=u&&await u(void 0,e);if(c&&c.length>0){if("bearer"===(null===(t=null==c?void 0:c.split(" ")[0])||void 0===t?void 0:t.toLowerCase()))return c.split(" ")[1];if("msauth1.0"===(null===(n=null==c?void 0:c.split(" ")[0])||void 0===n?void 0:n.toLowerCase()))return c}}},907:function(e,t,n){"use strict";function i(e){return e>=200&&e<300}n.d(t,"a",(function(){return i}))},922:function(e,t,n){"use strict";function i(e){let t=0;const n=[];function i(){t-=1,n.length>0&&n.shift()()}return{add:function(r){return new Promise((o,u)=>{const c=()=>{t+=1,r().then(e=>{i(),o(e)},e=>{i(),u(e)})};t===e?n.push(c):c()})},getRunningCount:()=>t,getQueueLength:()=>n.length}}n.d(t,"a",(function(){return i}))}}]);
//# sourceMappingURL=owa.870.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.870.js'] = 1;