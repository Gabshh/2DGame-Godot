(window.$wj=window.$wj||[]).push([[598],{10337:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s}));let r=!0;function o(){r=!1}function i(){r=!0}function s(){return r}},114:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(469);function o(t,e){return void 0===e&&(e=!0),t&&(e&&Object(r.a)(t)||t.parentNode&&t.parentNode)}},1985:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("START_SEARCH",(t,e,n=!1,r=[],o,i="All")=>({actionSource:t,scenarioId:e,explicitSearch:n,connectedAccountInfo:r,searchProvider:o,filter:i}))},19869:function(t,e,n){"use strict";n.r(e);var r=n(10337),o=n(2247),i=n(1694),s=n(3646),a=n(5989),c=n(4743),u=n(610),d=n(3943),l=n(2),f=n(391),p=n(132),g=n(136);function m(){const t=Object(d.b)();let e=[];const n=Object(s.a)();return n!=i.a.MailDeepLink&&n!=i.a.PublishedCalendar&&(e=[h(t.gotoMail,b),h(t.gotoCalendar,v),h(t.gotoPeople,y)],Object(o.d)()!==o.a.None&&e.push(h(t.gotoToDo,I)),!Object(g.a)()||"Dogfood"!=Object(l.E)()&&"Microsoft"!=Object(l.E)()||e.push(h(t.goToDevTools,O))),e}function h(t,e){return{command:t,handler:e,options:{allowHotkeyOnTextFields:!0,isEnabled:S}}}function b(){w(i.a.Mail)}function v(){w(i.a.Calendar)}function y(){w(i.a.People)}function I(){w(i.a.Tasks)}function w(t){const e=Object(s.a)();e&&Object(c.b)(e,t)?Object(c.e)(t,e):window.location.assign(t===i.a.Tasks&&Object(o.d)()===o.a.ToDo?Object(u.u)():Object(u.o)({path:"/"+t.toLowerCase()}))}function S(){return!Object(p.a)("disableAppModuleKeys")&&(Object(s.a)()!=i.a.Calendar||Object(r.c)()&&Object(a.b)())}function O(){Object(f.h)(f.a.DevTools)}n.d(e,"setupAppModuleKeys",(function(){return m}))},235:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(114);function o(t,e,n){void 0===n&&(n=!0);var o=!1;if(t&&e)if(n)if(t===e)o=!0;else for(o=!1;e;){var i=Object(r.a)(e);if(i===t){o=!0;break}e=i}else t.contains&&(o=t.contains(e));return o}},2816:function(t,e,n){"use strict";var r=n(3);const o=Object(r.createStore)("AppHostStore",{hostedApp:void 0,selectedEntityId:"",selectedSubEntityId:"",subEntityLabel:"",isInError:!1});e.a=o},3006:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(47);function o(){return Object(r.j)("tri-officeRailHost")||Object(r.j)("tri-appServiceApps")}},3139:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("onOfficeAppClick",(t,e)=>({app:t,currentlySelectedModule:e}))},3192:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("onModuleClick",(t,e,n)=>({module:t,currentlySelectedModule:e,activeModuleAction:n}))},3234:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);const o=Object(r.action)("onOpenMetaOsApp",({appManifest:t,entityId:e,subEntityId:n,subEntityLabel:r})=>({appManifest:t,entityId:e,subEntityId:n,subEntityLabel:r}))},3283:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("onSelectOfficeRailApp",t=>({app:t}))},329:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(114);function o(t,e){return t&&t!==document.body?e(t)?t:o(Object(r.a)(t),e):null}},3658:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("onAppHostHeaderStartSearch")},3811:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),o=n(2816);const i=Object(r.mutatorAction)("onInvalidAppNavigation",()=>{Object(o.a)().isInError=!0})},3892:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var r=n(47),o=n(132),i=n(3006);const s={Mail:!0,Calendar:!0,People:!0,FilesHub:!0,AppHost:!0};function a(t){return(Object(o.a)("moduleSwitch")||Object(r.j)("fwk-module-switch")||Object(i.a)())&&s[t]}function c(t,e){return a(t)&&a(e)}},3893:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);let o=Object(r.createStore)("leftRailStore",{selectedApp:null,enabledRailItems:[]});o()},3902:function(t){t.exports=JSON.parse('{"c":"Ceb","a":"Deb","d":"Eeb","e":"Feb","f":"Geb","b":"Heb"}')},391:function(t,e,n){"use strict";n.d(e,"c",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"g",(function(){return d})),n.d(e,"r",(function(){return l})),n.d(e,"j",(function(){return f})),n.d(e,"i",(function(){return p})),n.d(e,"q",(function(){return g})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return h})),n.d(e,"u",(function(){return b})),n.d(e,"s",(function(){return v})),n.d(e,"t",(function(){return y})),n.d(e,"v",(function(){return I})),n.d(e,"k",(function(){return w})),n.d(e,"h",(function(){return S})),n.d(e,"o",(function(){return O})),n.d(e,"m",(function(){return H})),n.d(e,"l",(function(){return j})),n.d(e,"p",(function(){return M})),n.d(e,"n",(function(){return E}));var r,o,i,s,a,c=n(87);!function(t){t.Unknown="Unknown",t.WW="WW",t.Dogfood="Dogfood",t.SIP="SIP",t.BlackForest="BlackForest",t.DONMT="DONMT",t.MSIT="MSIT",t.Gallatin="Gallatin",t.SDFV2="SDFV2",t.PDT="PDT",t.TDF="TDF",t.ITAR="ITAR"}(r||(r={})),function(t){t.Unknown="Unknown",t.AG08="AG08",t.AG09="AG09",t.BlackForest="BlackForest",t.DITAR="DITAR",t.DoD="DoD",t.Dogfood="Dogfood",t.Gallatin="Gallatin",t.GCCModerate="GCCModerate",t.GccHigh="GccHigh",t.GovCloud="GovCloud",t.ITAR="ITAR",t.Prod="Prod"}(o||(o={})),function(t){t.Dogfood="Dogfood",t.Microsoft="Microsoft",t.FirstRelease="FirstRelease",t.WW="WW",t.Unknown="Unknown"}(i||(i={})),function(t){t.Business="Business",t.Consumer="Consumer"}(s||(s={})),function(t){t.Unknown="Unknown",t.DevTools="DevTools"}(a||(a={}));class u{static ArrayOfRectDimensionsValue(t){for(let e=0;e<t.length;e++)t[e]=u.RectDimensionsValue(t[e]);return t}static ArrayOfKeyValuePairValue(t){for(let e=0;e<t.length;e++)t[e]=u.KeyValuePairValue(t[e]);return t}static ArrayOfStringValue(t){return t}static PhysicalRingEnumValue(t){return t}static VariantEnvironmentEnumValue(t){return t}static LogicalRingEnumValue(t){return t}static UserTypeValue(t){return t}static HotKeyValue(t){return t}static WindowDimensionsValue(t){return t}static RectDimensionsValue(t){return t}static UpdateFrameContextValue(t){const e=t;return e.window=u.WindowDimensionsValue(e.window),e.titleBar=u.RectDimensionsValue(e.titleBar),e.excluded=u.ArrayOfRectDimensionsValue(e.excluded),e}static DiagnosticInfoValue(t){const e=t;return e.physicalRing=u.PhysicalRingEnumValue(e.physicalRing),e.variantEnv=u.VariantEnvironmentEnumValue(e.variantEnv),e.logicalRing=u.LogicalRingEnumValue(e.logicalRing),e.userType=u.UserTypeValue(e.userType),e}static KeyValuePairValue(t){return t}static WindowStateValue(t){return t}static CloseParamsValue(t){return t}static ToggleMaximizeParamsValue(t){return t}static MinimizeParamsValue(t){return t}static MaximizeParamsValue(t){return t}static RestoreParamsValue(t){return t}static BootCompletedParamsValue(t){const e=t;return void 0!==e.info&&(e.info=u.DiagnosticInfoValue(e.info)),e}static BootFailedParamsValue(t){const e=t;return void 0!==e.telemetry&&(e.telemetry=u.ArrayOfKeyValuePairValue(e.telemetry)),e}static UpdateHostParamsValue(t){return t}static UpdateFlightsParamsValue(t){return t}static UpdateFrameParamsValue(t){const e=t;return e.context=u.UpdateFrameContextValue(e.context),e}static UpdateMainWindowIconParamsValue(t){return t}static PopoutLoadedParamsValue(t){return t}static MainWindowCreatedParamsValue(t){return t}static InitialWindowStateParamsValue(t){const e=t;return e.windowState=u.WindowStateValue(e.windowState),e}static UpdateWindowStateParamsValue(t){const e=t;return e.windowState=u.WindowStateValue(e.windowState),e}static HotKeyPressedParamsValue(t){const e=t;return e.hotKey=u.HotKeyValue(e.hotKey),e}}async function d(t){await c.throwIfVersionIsNotSupported("System",.4);const e={windowId:t};return c.HostBridge.invokeHost("System.close",e,void 0)}async function l(t){await c.throwIfVersionIsNotSupported("System",.4);const e={windowId:t};return c.HostBridge.invokeHost("System.toggleMaximize",e,void 0)}async function f(t){await c.throwIfVersionIsNotSupported("System",.4);const e={windowId:t};return c.HostBridge.invokeHost("System.minimize",e,void 0)}async function p(t){await c.throwIfVersionIsNotSupported("System",.9);const e={windowId:t};return c.HostBridge.invokeHost("System.maximize",e,void 0)}async function g(t){await c.throwIfVersionIsNotSupported("System",.9);const e={windowId:t};return c.HostBridge.invokeHost("System.restore",e,void 0)}async function m(t){await c.throwIfVersionIsNotSupported("System",.3);const e={info:t};return c.HostBridge.invokeHost("System.bootCompleted",e,void 0)}async function h(t){await c.throwIfVersionIsNotSupported("System",.6);const e={telemetry:t};return c.HostBridge.invokeHost("System.bootFailed",e,void 0)}async function b(t){await c.throwIfVersionIsNotSupported("System",.1);const e={forceUpdate:t};return c.HostBridge.invokeHost("System.updateHost",e,void 0)}async function v(t,e){await c.throwIfVersionIsNotSupported("System",.7);const n={flights:t,bootFlights:e};return c.HostBridge.invokeHost("System.updateFlights",n,void 0)}async function y(t,e){await c.throwIfVersionIsNotSupported("System",.5);const n={context:t,windwowId:e};return c.HostBridge.invokeHost("System.updateFrame",n,void 0)}async function I(t,e){await c.throwIfVersionIsNotSupported("System",.8);const n={fullIconResourcePath:t,overlayIconResourcePath:e};return c.HostBridge.invokeHost("System.updateMainWindowIcon",n,void 0)}async function w(t){await c.throwIfVersionIsNotSupported("System",.4);const e={windowId:t};return c.HostBridge.invokeHost("System.popoutLoaded",e,void 0)}async function S(t){await c.throwIfVersionIsNotSupported("System",.8);const e={hotKey:t};return c.HostBridge.invokeHost("System.hotKeyPressed",e,void 0)}function O(t){return c.HostBridge.registerForEvent("System.promptUpdateHost",(function(){t()}))}function H(t){return c.HostBridge.registerForEvent("System.mainWindowCreated",(function(e){if(e){const n=u.MainWindowCreatedParamsValue(e);t(n.instanceId,n.isRefresh)}}))}function j(t){return c.HostBridge.registerForEvent("System.initialWindowState",(function(e){if(e){const n=u.InitialWindowStateParamsValue(e);t(n.windowState)}}))}function M(t){return c.HostBridge.registerForEvent("System.updateWindowState",(function(e){if(e){const n=u.UpdateWindowStateParamsValue(e);t(n.windowState)}}))}function E(t){return c.HostBridge.registerForEvent("System.openNewWindow",(function(){t()}))}},3943:function(t,e,n){"use strict";var r=n(6),o=n(3902),i=n(2247),s=n(2),a=n(136);const c="goTo";function u(){const t={gotoMail:d(o.c,"ctrl+shift+1","ctrl+1"),gotoCalendar:d(o.a,"ctrl+shift+2","ctrl+2"),gotoPeople:d(o.d,"ctrl+shift+3","ctrl+3")};return Object(i.d)()!==i.a.None&&(t.gotoToDo=d(Object(i.b)()?o.f:o.e,"ctrl+shift+4","ctrl+4")),!Object(a.a)()||"Dogfood"!=Object(s.E)()&&"Microsoft"!=Object(s.E)()||(t.goToDevTools=d(o.b,"ctrl+shift+d","ctrl+shift+d")),t}function d(t,e,n){return{category:c,description:Object(r.b)(t),hotmail:e,yahoo:e,gmail:e,owa:e,outlook:n}}n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return c}))},3951:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(3),o=n(2816);const i=Object(r.mutatorAction)("onSelectAppTab",(t,e)=>{Object(o.a)().selectedEntityId=t,e&&(Object(o.a)().selectedSubEntityId=e)})},3952:function(t,e,n){"use strict";var r=n(2816);e.a=()=>{var t;return{appId:null===(t=Object(r.a)().hostedApp)||void 0===t?void 0:t.appId,appManifest:Object(r.a)().hostedApp,entityId:Object(r.a)().selectedEntityId,subEntityId:Object(r.a)().selectedSubEntityId,subEntityLabel:Object(r.a)().subEntityLabel}}},4042:function(t,e,n){"use strict";var r=n(2816);e.a=()=>Object(r.a)().isInError},407:function(t,e,n){"use strict";function r(t){return t&&!!t._virtual}n.d(e,"a",(function(){return r}))},4157:function(t,e,n){"use strict";var r=n(20),o=n(4233);n(4989);n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o.a}));const i=new r.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(365)]).then(n.bind(null,19703))),s=Object(r.d)(i,t=>t.AppDrawer)},4233:function(t,e,n){"use strict";var r=n(3);e.a=Object(r.action)("onAppDrawerAppClick",t=>({appId:t}))},4603:function(t,e,n){"use strict";var r=n(20),o=n(3234),i=n(3811),s=(n(3951),n(3952)),a=n(4042),c=n(3),u=n(2816);Object(c.mutator)(o.a,t=>{const{appManifest:e,entityId:n,subEntityId:r,subEntityLabel:o}=t;if(!e||!e.staticTabs||0===e.staticTabs.length)return void(Object(u.a)().isInError=!0);const i=e.staticTabs.map(t=>t.entityId).indexOf(n)>-1;Object(u.a)().hostedApp=e,Object(u.a)().selectedEntityId=n&&i?n:e.staticTabs[0].entityId,r&&(Object(u.a)().selectedSubEntityId=r),o&&(Object(u.a)().subEntityLabel=o)}),n.d(e,"a",(function(){return l})),n.d(e,"e",(function(){return f})),n.d(e,"d",(function(){return p})),n.d(e,"g",(function(){return o.a})),n.d(e,"f",(function(){return i.a})),n.d(e,"b",(function(){return s.a})),n.d(e,"c",(function(){return a.a}));const d=new r.c(()=>Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(314)]).then(n.bind(null,19656))),l=Object(r.d)(d,t=>t.AppHostContainer),f=new r.a(d,t=>t.tryOpenMOSAppWithContext),p=new r.a(d,t=>t.dispatchOpenMetaOsApp)},4634:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var r=n(3006),o=n(47);const i=["db5e5970-212f-477f-a3fc-2227dc7782bf","4c4ec2e8-4a2c-4bce-8d8f-00fc664a4e5b","9b049ed6-fc8b-40c7-815b-bf84e344d270","f3a6e67f-850d-4dd9-960a-04c6638ded36","Y29tLm1pY3Jvc29mdC50ZWFtc3BhY2UudGFiLnBsYW5uZXIjIzEuMi4zIyNQdWJsaXNoZWQ=","MmUzYTYyOGQtNmY1NC00MTAwLTllN2EtZjAwYmMzNjIxYTg1IyMxLjAuOCMjUHVibGlzaGVk","ZGI1ZTU5NzAtMjEyZi00NzdmLWEzZmMtMjIyN2RjNzc4MmJmIyMyLjIuMyMjUHVibGlzaGVk",...Object(o.j)("mos-testApp")?["com.example.metaostestapp.test"]:[]];function s(t){return Object(r.a)()&&i.indexOf(t)>-1}},469:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(407);function o(t){var e;return t&&Object(r.a)(t)&&(e=t._virtual.parent),e}},4743:function(t,e,n){"use strict";var r=n(20),o=n(4157),i=n(3192),s=n(3139),a=n(3283),c=n(1985),u=n(3658),d=n(3006),l=n(3892),f=n(3),p=n(3893);Object(f.mutator)(i.a,t=>{Object(p.a)().selectedApp=null}),Object(f.mutator)(u.a,t=>{Object(p.a)().selectedApp=null});var g=n(4634),m=n(4603);Object(f.mutator)(s.a,t=>{Object(g.a)(t.app)&&(Object(p.a)().selectedApp=t.app)}),Object(f.mutator)(o.b,t=>{Object(p.a)().selectedApp=t.appId}),Object(f.mutator)(a.a,t=>{Object(p.a)().selectedApp=t.app}),Object(f.mutator)(m.g,t=>{Object(p.a)().selectedApp=t.appManifest.appId}),n.d(e,"c",(function(){return b})),n.d(e,"e",(function(){return i.a})),n.d(e,"f",(function(){return s.a})),n.d(e,"d",(function(){return u.a})),n.d(e,"a",(function(){return d.a})),n.d(e,"b",(function(){return l.b}));const h=new r.c(()=>Promise.all([n.e(0),n.e(8),n.e(10),n.e(13),n.e(434)]).then(n.bind(null,19731))),b=(new r.b(h,t=>t.getSelectedOfficeRailApp),new r.b(h,t=>t.getLeftRailItemContextualMenuItems));Object(r.f)(i.a,h,t=>t.onModuleClickOrchestrator),Object(r.f)(s.a,h,t=>t.onOfficeAppClickOrchestrator),Object(r.f)(c.a,h,t=>t.startSearchOrchestrator),Object(r.f)(s.a,h,t=>t.onOfficeAppClickAppHostOrchestration),Object(r.f)(o.b,h,t=>t.onAppDrawerAppClickAppHostOrchestration),Object(r.f)(a.a,h,t=>t.onSelectOfficeRailAppHostOrchestration)},48:function(t,e,n){"use strict";n.d(e,"e",(function(){return f})),n.d(e,"h",(function(){return p})),n.d(e,"f",(function(){return g})),n.d(e,"i",(function(){return m})),n.d(e,"c",(function(){return h})),n.d(e,"k",(function(){return b})),n.d(e,"j",(function(){return v})),n.d(e,"o",(function(){return y})),n.d(e,"p",(function(){return I})),n.d(e,"n",(function(){return w})),n.d(e,"m",(function(){return S})),n.d(e,"l",(function(){return O})),n.d(e,"a",(function(){return H})),n.d(e,"q",(function(){return j})),n.d(e,"b",(function(){return E})),n.d(e,"g",(function(){return V})),n.d(e,"d",(function(){return N}));var r=n(580),o=n(235),i=n(114),s=n(45),a=n(78),c="data-is-focusable",u="data-is-visible",d="data-focuszone-id",l="data-is-sub-focuszone";function f(t,e,n){return v(t,e,!0,!1,!1,n)}function p(t,e,n){return b(t,e,!0,!1,!0,n)}function g(t,e,n,r){return void 0===r&&(r=!0),v(t,e,r,!1,!1,n,!1,!0)}function m(t,e,n,r){return void 0===r&&(r=!0),b(t,e,r,!1,!0,n,!1,!0)}function h(t){var e=v(t,t,!0,!1,!1,!0);return!!e&&(E(e),!0)}function b(t,e,n,r,o,i,s,a){if(!e||!s&&e===t)return null;var c=y(e);if(o&&c&&(i||!S(e)&&!O(e))){var u=b(t,e.lastElementChild,!0,!0,!0,i,s,a);if(u){if(a&&w(u,!0)||!a)return u;var d=b(t,u.previousElementSibling,!0,!0,!0,i,s,a);if(d)return d;for(var l=u.parentElement;l&&l!==e;){var f=b(t,l.previousElementSibling,!0,!0,!0,i,s,a);if(f)return f;l=l.parentElement}}}if(n&&c&&w(e,a))return e;var p=b(t,e.previousElementSibling,!0,!0,!0,i,s,a);return p||(r?null:b(t,e.parentElement,!0,!1,!1,i,s,a))}function v(t,e,n,r,o,i,s,a){if(!e||e===t&&o&&!s)return null;var c=y(e);if(n&&c&&w(e,a))return e;if(!o&&c&&(i||!S(e)&&!O(e))){var u=v(t,e.firstElementChild,!0,!0,!1,i,s,a);if(u)return u}if(e===t)return null;var d=v(t,e.nextElementSibling,!0,!0,!1,i,s,a);return d||(r?null:v(t,e.parentElement,!1,!1,!0,i,s,a))}function y(t){if(!t||!t.getAttribute)return!1;var e=t.getAttribute(u);return null!=e?"true"===e:0!==t.offsetHeight||null!==t.offsetParent||!0===t.isVisible}function I(t){return!!t&&y(t)&&!t.hidden&&"hidden"!==window.getComputedStyle(t).visibility}function w(t,e){if(!t||t.disabled)return!1;var n=0,r=null;t&&t.getAttribute&&(r=t.getAttribute("tabIndex"))&&(n=parseInt(r,10));var o=t.getAttribute?t.getAttribute(c):null,i=null!==r&&n>=0,s=!!t&&"false"!==o&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"SELECT"===t.tagName||"true"===o||i);return e?-1!==n&&s:s}function S(t){return!!(t&&t.getAttribute&&t.getAttribute(d))}function O(t){return!(!t||!t.getAttribute||"true"!==t.getAttribute(l))}function H(t){var e=Object(a.a)(t),n=e&&e.activeElement;return!(!n||!Object(o.a)(t,n))}function j(t,e){return"true"!==Object(r.a)(t,e)}var M=void 0;function E(t){if(t){if(M)return void(M=t);M=t;var e=Object(s.a)(t);e&&e.requestAnimationFrame((function(){M&&M.focus(),M=void 0}))}}function V(t,e){for(var n=t,r=0,o=e;r<o.length;r++){var i=o[r],s=n.children[Math.min(i,n.children.length-1)];if(!s)break;n=s}return n=w(n)&&y(n)?n:v(t,n,!0)||b(t,n)}function N(t,e){for(var n=[];e&&t&&e!==t;){var r=Object(i.a)(e,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,e)),e=r}return n}},4989:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(3);let o=Object(r.createStore)("appDrawerStore",{appServiceApps:[],hasFetchedAppData:!1});o()},580:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n(329);function o(t,e){var n=Object(r.a)(t,(function(t){return t.hasAttribute(e)}));return n&&n.getAttribute(e)}},5989:function(t,e,n){"use strict";let r=[];function o(t,e){return!t&&!e||!(!t||!e)&&t.popupRoot==e.popupRoot}function i(t){for(let e=r.length-1;e>=0;e--){if(r[e].popupRoot==t.popupRoot)return r.splice(e,1),!0}return!1}function s(){return r[r.length-1]}var a=n(48);function c(t){window.addEventListener("focus",e=>{if(function(t){if(t.target==window)return!0;if(!(t.target!=document.body&&document.body.contains(t.target)||Object(a.n)(t.target)))return t.preventDefault(),!0;return!1}(e))return;let n=function(t){if(t==document.body||t.contains(document.body))return null;let e=t;for(;(null==e?void 0:e.parentElement)&&e.parentElement!=document.body;)e=e.parentElement;return e}(e.target);null!=(Object(a.n)(e.target)?e.target:e.relatedTarget)&&t(e.target,n)},!0)}let u;var d=n(36);let l=0;const f=200;function p(){var t,e;t=h,e=b,u||(u=new MutationObserver(n=>{n.forEach(n=>{let r=n.removedNodes,o=n.addedNodes;for(let e=0;e<o.length;e++){let n=o.item(e);t(n)}for(let t=0;t<r.length;t++){let n=r.item(t);e(n)}})})),u.disconnect(),u.observe(document.body,{childList:!0,subtree:!1}),c(I)}function g(){l++,setTimeout(()=>l--,f)}function m(){return t=s(),o(r[0],t);var t}function h(t){g()}function b(t){let e=s(),n={popupRoot:t,element:null,path:null,fullPath:null};if(i(n),o(e,n)){w();let t=s();t&&function(t){if(!t)return;let e=t.element;if(document.body.contains(e))y(e);else{let e=v(t.path,t.popupRoot);e?y(e):(e=v(t.fullPath,t.popupRoot),e&&y(e))}}(t)}}function v(t,e){let n;try{n=e.querySelectorAll(t)}catch(t){d.h.warn("moduleFocusController: Error selecting for elements, will not set focus")}return n&&1==n.length?n.item(0):null}function y(t){let e=t;for(;e&&e!=document.body;){let t=Object(a.e)(e,e,!0);if(t&&Object(a.n)(t))return void setTimeout(()=>{0==l&&t.focus({preventScroll:!document.body.classList.contains("ms-Fabric--isFocusVisible")})},0);e=e.parentElement}}function I(t,e){let n={popupRoot:e,element:t,fullPath:O(t,e),path:S(t)};w(),g(),i(n),function(t){let e=!1;for(let n=r.length-1;n>=0;n--){r[n].popupRoot==t.popupRoot&&(r[n]=t,e=!0)}e||r.push(t)}(n)}function w(){let t=s();for(;t;){if(document.body.contains(t.popupRoot)&&Object(a.e)(t.popupRoot,t.popupRoot,!0))return;i(t),t=s()}}function S(t,e){let n=t.tagName;for(let r=0;r<t.attributes.length;r++){let o=t.attributes[r];if(null==e?void 0:e.includes(o.name))continue;let i=o.value.replace("\\","\\\\");if(0===i.length)continue;i=i.replace(/[\n']/g,"']["+o.name+"*='");let s="["+o.name+"*='"+i+"']";n=n.concat(s)}return n}function O(t,e){let n=t,r="";const o=["class","style"];for(;n!==e;)r=` ${S(n,o)}`+r,n=n.parentElement;return r}n.d(e,"a",(function(){return p})),n.d(e,"c",(function(){return g})),n.d(e,"b",(function(){return m}))},87:function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function s(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((r=r.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.throwIfVersionIsNotSupported=e.IsVersonSupportedByHost=e.isPIEHostPresent=e.HostBridge=void 0;var i=function(){function t(){this.nextHandlerId=1,this.registeredHandlers=new Map}return t.prototype.registerHandler=function(t){var e=this,n=this.nextHandlerId;return this.nextHandlerId=this.nextHandlerId+1,this.registeredHandlers.set(n,t),function(){e.unregisterHandler(n)}},t.prototype.RaiseEvent=function(t){this.registeredHandlers.forEach((function(e){e(t)}))},t.prototype.HasHandlers=function(){return 0!==this.registeredHandlers.size},t.prototype.unregisterHandler=function(t){this.registeredHandlers.has(t)&&this.registeredHandlers.delete(t)},t}(),s=function(){function t(){this.nextMessageId=1,this.pendingMessages=new Map,this.eventHandlers=new Map,this.abandonedCallHandlers=new i,this.namespaceVersionChangeHandlers=new i,this.hostNotificationHandlers=new i,this.firstSyncIdCall=!0,this.nextSyncId=1,this.maxMessageId=2147483647}return t.prototype.isNamespaceVersionChange=function(t){return t.isIdRequest&&"version-change"===t.messageName&&-3===t.messageId},t.prototype.onMessageFromHost=function(t){if("app/pie"===t.contentType)if(this.raiseMessageInfoIfNeeded(t,!1),t.isEvent){var e=t.messageName;this.eventHandlers.has(e)&&this.eventHandlers.get(e).RaiseEvent(t.args)}else{var n=t.messageId;if(this.pendingMessages.has(n)){var r=this.pendingMessages.get(n);this.pendingMessages.delete(n),t.abandoned?this.abandonedCallHandlers.RaiseEvent(t.messageName):t.wasSuccessful?r.resolve(r.postProcessing?r.postProcessing(t.message):t.message):r.reject(new Error(t.messageName+":"+t.errorMessage))}else this.isNamespaceVersionChange(t)&&this.namespaceVersionChangeHandlers.RaiseEvent(t.message)}},t.prototype.addMessageToPendingMessages=function(t,e,n){var r=this.nextMessageId;this.nextMessageId=this.nextMessageId===this.maxMessageId?1:this.nextMessageId+1;var o={resolve:t,reject:e,postProcessing:n};return this.pendingMessages.set(r,o),r},t.prototype.invokeIdRequest=function(t,e,n,r,o){var i={contentType:"app/pie",messageName:e,isIdRequest:!0,messageId:this.addMessageToPendingMessages(r,o),message:n};this.raiseMessageInfoIfNeeded(i,!0,!0),t.sendMessageToHost(i)},t.throwPieSyncNotSupported=function(){throw new Error("Synchronous bridge not supported")},t.prototype.getNextSyncId=function(t){this.firstSyncIdCall&&(this.nextSyncId=t.getStartingSyncId(),this.firstSyncIdCall=!1);var e=this.nextSyncId;return this.nextSyncId=this.nextSyncId===Number.MAX_SAFE_INTEGER?1:this.nextSyncId+1,e},t.prototype.invokeOnHostSync=function(e,n,r,o,i,s){if(e.sendMessageToHostSync){var a=this.addMessageToPendingMessages(o,i,s),c={contentType:"app/pie",messageName:n,syncId:this.getNextSyncId(e),messageId:a,message:r};this.raiseMessageInfoIfNeeded(c,!0,!1),e.sendMessageToHostSync(c)}else t.throwPieSyncNotSupported()},t.prototype.invokeOnHost=function(t,e,n,r,o,i){var s={contentType:"app/pie",messageName:e,messageId:this.addMessageToPendingMessages(r,o,i),message:n};this.raiseMessageInfoIfNeeded(s,!0,!0),t.sendMessageToHost(s)},t.prototype.registerForEvent=function(t,e){return this.eventHandlers.has(t)||this.eventHandlers.set(t,new i),this.eventHandlers.get(t).registerHandler(e)},t.prototype.registerForAbandonedCalls=function(t){return this.abandonedCallHandlers.registerHandler(t)},t.prototype.registerForNamespaceVersionChange=function(t){return this.namespaceVersionChangeHandlers.registerHandler(t)},t.prototype.registerForHostMessageNotification=function(t){return this.hostNotificationHandlers.registerHandler(t)},t.prototype.raiseMessageInfoIfNeeded=function(t,e,n){if(this.hostNotificationHandlers.HasHandlers()){var r={isToHost:e,isAsync:n,messageName:t.messageName,isIdRequest:t.isIdRequest,syncId:t.syncId,messageId:t.messageId,isEvent:t.isEvent,wasSuccessful:t.wasSuccessful,abandoned:t.abandoned};this.hostNotificationHandlers.RaiseEvent(r)}},t}(),a=function(){function t(t){this.bridge=t,this.processor=new s,this.instanceId=null,this.namespaceVersions=new Map;var e=function(t){this.namespaceVersions.has(t)&&this.namespaceVersions.delete(t)}.bind(this);this.processor.registerForNamespaceVersionChange(e);var n=function(t){this.processor.onMessageFromHost(t)}.bind(this);this.bridge.addHostMessageHandler(n)}return t.prototype.isUsingBridge=function(t){return this.bridge===t},t.prototype.invokeHost=function(t,e,n){var r=this;return new Promise((function(o,i){r.processor.invokeOnHost(r.bridge,t,e,o,i,n)}))},t.prototype.invokeHostSync=function(t,e,n){var r;return this.processor.invokeOnHostSync(this.bridge,t,e,(function(t){r=t}),(function(t){throw t}),n),r},t.prototype.invokeIdRequestOnHost=function(t,e){var n=this;return new Promise((function(r,o){n.processor.invokeIdRequest(n.bridge,t,e,r,o)}))},t.prototype.registerForEvent=function(t,e){return this.processor.registerForEvent(t,e)},t.prototype.registerForAbandonedCalls=function(t){return this.processor.registerForAbandonedCalls(t)},t.prototype.registerForHostMessageNotification=function(t){return this.processor.registerForHostMessageNotification(t)},t.prototype.getInstanceId=function(){var t=this;return new Promise((function(e,n){t.instanceId?e(t.instanceId):t.invokeIdRequestOnHost("instance","id").then((function(n){t.instanceId=n,e(t.instanceId)})).catch((function(t){n(t)}))}))},t.prototype.getNamespaceVersion=function(t){var e=this;return new Promise((function(n,r){e.namespaceVersions.has(t)?n(e.namespaceVersions.get(t)):e.invokeIdRequestOnHost("version",t).then((function(o){var i=parseFloat(o);isNaN(i)?r("Non numeric version returned"):(e.namespaceVersions.set(t,i),n(i))})).catch((function(t){r(t)}))}))},t}(),c=function(){function t(){}return t.setGlobalPreprocessCheck=function(e){t._globalPreprocessCheck=e},t.isInitializationNeeded=function(e){return!t._implInstance||!t._implInstance.isUsingBridge(e)},t.initialize=function(e){t.isInitializationNeeded(e)&&(t._implInstance=new a(e))},t.resetBridgeForUnitTests=function(){t._implInstance=null},t.reloadBridgeForUnitTests=function(){if(t._implInstance){var e=t._implInstance.bridge;t._implInstance=new a(e)}},t.failBridgeNotInitialized=function(){return new Promise((function(t,e){e(new Error("HostBridge not initialized"))}))},t.invokeHost=function(e,n,i){return r(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return t._implInstance?t._globalPreprocessCheck?[4,t._globalPreprocessCheck(e)]:[3,2]:[3,3];case 1:r.sent(),r.label=2;case 2:return[2,t._implInstance.invokeHost(e,n,i)];case 3:return[2,t.failBridgeNotInitialized()]}}))}))},t.invokeHostSync=function(e,n,r){if(t._implInstance)return t._implInstance.invokeHostSync(e,n,r);throw new Error("HostBridge not initialized")},t.getInstanceId=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){return t._implInstance?[2,t._implInstance.getInstanceId()]:[2,t.failBridgeNotInitialized()]}))}))},t.getNamespaceVersion=function(e){return r(this,void 0,void 0,(function(){return o(this,(function(n){return t._implInstance?[2,t._implInstance.getNamespaceVersion(e)]:[2,t.failBridgeNotInitialized()]}))}))},t.registerForEvent=function(e,n){return t._implInstance?t._implInstance.registerForEvent(e,n):null},t.registerForAbandonedCalls=function(e){return t._implInstance?t._implInstance.registerForAbandonedCalls(e):null},t.registerForHostMessageNotification=function(e){return t._implInstance?t._implInstance.registerForHostMessageNotification(e):null},t.throwPieSyncNotSupported=function(){s.throwPieSyncNotSupported()},t._implInstance=null,t._globalPreprocessCheck=null,t}();function u(){return r(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t){c.getInstanceId().then((function(e){t(!!e)})).catch((function(){t(!1)}))}))]}))}))}function d(t,e,n){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){switch(o.label){case 0:return[4,u()];case 1:return o.sent()?[4,c.getNamespaceVersion(t)]:[3,3];case 2:if((r=o.sent())>=e&&(!n||r<n))return[2,!0];o.label=3;case 3:return[2,!1]}}))}))}e.HostBridge=c,e.isPIEHostPresent=u,e.IsVersonSupportedByHost=d,e.throwIfVersionIsNotSupported=function(t,e,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,d(t,e,n)];case 1:if(!r.sent())throw new Error("VersionNotSupported for "+t+": "+e+", "+n);return[2]}}))}))}}}]);
//# sourceMappingURL=owa.598.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.598.js'] = 1;