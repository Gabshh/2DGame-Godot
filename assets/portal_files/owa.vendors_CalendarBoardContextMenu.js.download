(window.$wj=window.$wj||[]).push([[247],{13056:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(18392),o=n.n(a),i=n(23),c=n(6),u=n(18394),s=Object(i.a)((function({item:e,dismissMenu:t}){const{onClick:n,data:{space:a}}=e,i=r.useCallback(r=>{null==n||n(r,e),t()},[n,e,t]);return r.createElement("button",{key:a.id,className:o.a.spaceProjectContainer,onClick:i,"aria-label":Object(c.b)(u.a,a.name),role:"menuitem",tabIndex:0},r.createElement("span",null,a.name))})),d=n(3),l=n(16),m=Object(d.createStore)("timeStreamProjects",{spaces:new l.ObservableMap});function f(){return m().spaces}var O=n(3913);const b=Object(d.mutatorAction)("reloadProjects",e=>{const t=m().spaces;t.clear(),e.map(e=>{t.set(e.id,e)})});var p=n(4458);const g=Object(O.a)((async function(){let e=await Object(p.g)();if(e=e.filter(e=>"OutlookCalendar"===e.appName||!e.appName),e){const t=f();let n=!1;e.map(r=>{var a;e.length===t.size&&t.has(r.id)&&(null===(a=t.get(r.id))||void 0===a?void 0:a.name)===r.name||(n=!0)}),n&&b(e)}}),3e3);var j=n(18395),T=n(4417);const S=["ConversationId","DateTimeReceived","Flag","HasAttachments","IsRead","ItemId","ParentFolderId","Preview","Sender","Subject"];function I(e){const t={};return S.forEach(n=>{t[n]=e[n]}),t}const h=["CalendarItemType","End","Start","HasAttachments","FreeBusyType","Location","Subject","Organizer","ItemId","ParentFolderId","Preview","IsMeeting","IsOrganizer","IsCancelled","ResponseType","InstanceKey"];function v(e){const t={};return h.forEach(n=>{t[n]=e[n]}),t}var C=n(610),y=n(138),D=n(2223),w=n(2507),k=n(7),A=n(2151),E=n(2654),x=n(2386),N=n(282),F=n(71);const P={paddingLeft:"12px"},L={iconName:"OpenInNewWindow",styles:{root:{marginRight:7}}};function R(e,t,n,r){const a=f(),o=(a,o)=>{o&&async function e(t,n,r,a,o){var i;null==o||o();const u=Math.pow(2,16),s={x:u,y:u};let d;if(function(e){return!!e.CalendarItemType}(r))d=Object.assign(Object.assign({},s),{type:"calendarItem",payload:{itemId:n,item:v(r)},isCaptured:!0});else if(function(e){return!!e.ConversationId}(r)){let e;try{Object(x.d)(n)||(e=await Object(E.d)([n],E.a.BoardMailItem)[0])}catch(e){}d=Object.assign(Object.assign({},s),{type:"mailItem",payload:{itemId:n,immutableId:null==e?void 0:e.TargetId,item:I(r)},isCaptured:!0})}else if(Object(D.j)(r)){const{ParentFolderId:e,Subject:t,Status:a,DueDateTime:o}=r,c=o?Object(k.nb)(o):"",u=null!==(i=null==o?void 0:o.tz)&&void 0!==i?i:"";d=Object.assign(Object.assign({},s),{type:"task",payload:{taskId:n,taskParentId:e,taskSubject:t,isComplete:Object(w.p)(a)},dueDate:c,dueDateTz:u,taskId:n})}else Object(N.a)(r);await A.e.importAndExecute("createCaptureAssetInitial",a,Object(c.b)(j.b),{icon:"CheckMark"});let l=!0;try{await Object(p.c)(t,d)}catch(o){A.e.importAndExecute("createCaptureAsset",a,Object(c.b)(j.a),{icon:"Error",primaryActionHotKeyCommand:A.a.Retry},{primaryActionText:Object(c.b)(T.a),notificationCallback:o=>{o===A.b.PrimaryActionClicked?e(t,n,r,a):l=!1}})}l&&Object(F.o)("OUTLOOKSPACES_CREATE_ASSET",{assetType_1:d.type,source_2:"ContextMenu",x:s.x,y:s.y})}(o.data.space.id,e,t,n,r)},i=[];(null==a?void 0:a.size)>=0&&a.forEach(e=>{i.push({key:e.id,text:e.name,title:e.name,onRender:M,onClick:o,data:{space:e}})}),i.sort((e,t)=>(e.text||"").localeCompare(t.text||""));const u=Object(c.b)(j.c);return i.push({key:"spaces-contextmenu-divider",itemType:y.a.Divider},{key:"go-to-calendarBoard",text:u,title:u,style:P,onClick:_,iconProps:L}),{items:i,onMenuOpened:g}}function _(){window.open(Object(C.e)()+"view/board"+Object(C.s)(),"_blank")}function M(e,t){return r.createElement(s,{item:e,dismissMenu:t})}n.d(t,"getSpacesContextMenuItems",(function(){return R}))},18392:function(e,t,n){var r=n(18393);"string"==typeof r&&(r=[[e.i,r,""]]);var a={transform:void 0};n(77)(r,a);r.locals&&(e.exports=r.locals)},18393:function(e,t,n){(t=e.exports=n(76)(!1)).push([e.i,"._2C9SrakQubH8DZwX-KCv2Y{color:inherit;font:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:36px;cursor:pointer}html[dir] ._2C9SrakQubH8DZwX-KCv2Y{background:none;border:none;padding-bottom:0;padding-top:0}html[dir=ltr] ._2C9SrakQubH8DZwX-KCv2Y{padding:0 8px 0 13px}html[dir=rtl] ._2C9SrakQubH8DZwX-KCv2Y{padding:0 13px 0 8px}html[dir] ._2C9SrakQubH8DZwX-KCv2Y:focus,html[dir] ._2C9SrakQubH8DZwX-KCv2Y:hover{background-color:var(--neutralLighter)}html[dir] ._2C9SrakQubH8DZwX-KCv2Y:active{background-color:var(--neutralLight)}html[dir=ltr] ._1FbqRv1YsQ_jaQRu-NmPoq{margin-right:11px}html[dir=rtl] ._1FbqRv1YsQ_jaQRu-NmPoq{margin-left:11px}",""]),t.locals={spaceProjectContainer:"_2C9SrakQubH8DZwX-KCv2Y",spaceIcon:"_1FbqRv1YsQ_jaQRu-NmPoq"}},18394:function(e){e.exports=JSON.parse('{"a":"aqb"}')},18395:function(e){e.exports=JSON.parse('{"c":"Zpb","b":"_pb","a":"$pb"}')},2151:function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d}));var r=n(20),a=n(2818);n.d(t,"a",(function(){return a.b}));var o=n(1807);n.d(t,"b",(function(){return o.a}));const i=new r.c(()=>n.e(862).then(n.bind(null,4957)));let c=new r.a(i,e=>e.showNotification),u=new r.a(i,e=>e.showNotificationWithButtonCallback),s=new r.a(i,e=>e.dismissNotification),d=new r.a(i,e=>e.enableNotificationBar)},2223:function(e,t,n){"use strict";const r="dragged_email";var a;!function(e){e.Normal="Normal",e.High="High",e.Low="Low"}(a||(a={}));var o=a;function i(e){return"Todo"===(null==e?void 0:e.__type)}var c=n(326);function u(e){return e=null!==e?e:{},Object.assign(Object.assign({},e),{CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,Id:e.Id?e.Id:Object(c.a)(),IsCompleted:!!e.IsCompleted&&e.IsCompleted,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Subject:e.Subject?e.Subject:null})}function s(e){const t=(e=null!==e?e:{}).Id?e.Id:Object(c.a)();return Object.assign(Object.assign({},e),{__type:"Todo",Id:t,ParentFolderId:e.ParentFolderId?e.ParentFolderId:null,Subject:e.Subject?e.Subject:null,ReminderDateTime:e.ReminderDateTime?e.ReminderDateTime:null,IsReminderOn:!!e.IsReminderOn&&e.IsReminderOn,CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,DueDateTime:e.DueDateTime?e.DueDateTime:null,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Status:e.Status?e.Status:"NotStarted",Subtasks:e.Subtasks?e.Subtasks:null,Importance:e.Importance?e.Importance:o.Normal,Note:e.Note?e.Note:null,LinkedEmail:e.LinkedEmail?e.LinkedEmail:null,CommittedDay:e.CommittedDay?e.CommittedDay:null,CommittedOrder:e.CommittedOrder?e.CommittedOrder:null,PostponedDay:e.PostponedDay?e.PostponedDay:null,CreatedWithLocalId:t,Categories:e.Categories?e.Categories:null})}function d(e){return e=null!==e?e:{},Object.assign(Object.assign({},e),{Id:e.Id?e.Id:Object(c.a)(),Name:e.Name?e.Name:null,IsDefaultFolder:!!e.IsDefaultFolder&&e.IsDefaultFolder,IsSharedFolder:!!e.IsSharedFolder&&e.IsSharedFolder,IsOwner:!!e.IsOwner&&e.IsOwner,FolderType:e.FolderType?e.FolderType:"Other",SyncStatus:e.SyncStatus?e.SyncStatus:"Synced",OrderDateTime:e.OrderDateTime?e.OrderDateTime:null})}function l(e){if(!e||!e.subjects||0===e.subjects.length)return[];return e.subjects.map((t,n)=>({Subject:t,LinkedEmail:{Id:e.latestItemIds[n],EntitySubtype:r,DisplayName:t}}))}n.d(t,"c",(function(){return"message"})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return"highlight_from_email"})),n.d(t,"a",(function(){return"context_menu_email"})),n.d(t,"e",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return l}))},2386:function(e,t,n){"use strict";var r;!function(e){e.EwsId="ews",e.EwsImmutableId="ewsimmutable"}(r||(r={}));var a=n(47),o=n(3),i=Object(o.createStore)("immutableId",{IsImmutableIdFeatureOnForConnectedAccount:!1});var c=n(287);function u(e){return Object(c.r)(e)?i().IsImmutableIdFeatureOnForConnectedAccount?r.EwsImmutableId:r.EwsId:Object(a.j)("fwk-immutable-ids")?r.EwsImmutableId:r.EwsId}function s(e){return!!e&&e.length<90}function d(e){const t=[],n=[],r=[];return null==e||e.forEach((e,a)=>{"string"==typeof e&&(e.indexOf("@")>-1?r.push({id:e,idx:a}):s(e)?t.push({id:e,idx:a}):n.push({id:e,idx:a}))}),[t,n,r]}function l(e,t){const[n,a]=d(e),o=u(t);return o===r.EwsImmutableId&&a.length>0||o===r.EwsId&&n.length>0}const m=Object(o.mutatorAction)("setIsImmutableIdFeatureOnForConnectedAccount",e=>{i().IsImmutableIdFeatureOnForConnectedAccount=e});n.d(t,"b",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return m})),n.d(t,"a",(function(){return r}))},2507:function(e,t,n){"use strict";var r=n(3504),a=n(6);function o(){return Object(a.b)(r.a)}var i=n(7);function c(e){const t=e||Object(i.Ub)(),n=Object(i.bc)(t),r=Object(i.e)(n,1);return Object(i.f)(r,11)}function u(e){return e.IsDefaultFolder?o():"Commitments"===e.FolderType?e.Name:"FlaggedEmails"===e.FolderType?Object(a.b)(r.b):e.Name}function s(e){return"FlaggedEmails"===e.FolderType}var d=n(2223);function l(e){return e===d.e.High}var m=function(e,t=Object(i.Ub)()){return Object(i.u)(Object(i.bc)(t),Object(i.bc)(e))>0};function f(e){return!!e.CommittedDay&&Object(i.Lb)(e.CommittedDay,Object(i.pc)())}var O=function(e){return"Completed"===e};function b(e){const t=[];let n=null,r=null,a=null;e.forEach(e=>{e.IsDefaultFolder?(n=Object.assign({},e),n.Name=u(e)):"Commitments"===e.FolderType?(r=Object.assign({},e),r.Name=u(e)):"FlaggedEmails"===e.FolderType?(a=Object.assign({},e),a.Name=u(e)):t.push(e)});const o=t.sort((e,t)=>e.OrderDateTime&&t.OrderDateTime?Object(i.p)(t.OrderDateTime,e.OrderDateTime):e.OrderDateTime?-1:t.OrderDateTime?1:0);return r&&o.splice(0,0,r),a&&o.splice(0,0,a),n&&o.splice(0,0,n),o}function p(e,t){return Object(i.Hb)(e.OrderDateTime,t.OrderDateTime)?-1:1}function g(e,t){return Object(i.Hb)(e.CommittedOrder,t.CommittedOrder)?-1:1}var j=n(3408);function T(e,t){return e&&t&&t.Id!==e.ParentFolderId?{ParentFolderId:t.Id}:{}}function S(e){return null!==e.CompletedDateTime&&"NotStarted"!==e.Status?{Status:"NotStarted"}:{}}function I(e,t){let n={};return t&&(n={CommittedOrder:Object(i.Ub)()}),e?n=Object.assign(Object.assign({},n),{CommittedDay:Object(i.pc)(),PostponedDay:null}):e||(n=Object.assign(Object.assign({},n),{CommittedDay:void 0,PostponedDay:Object(i.pc)()})),n}var h=n(282);const v=36e5;function C(e,t,n){if(0===t.length)return{};if(e>=t.length){return function(e,t){switch(t){case"CommittedOrder":return{CommittedOrder:Object(i.g)(e.CommittedOrder,-v)};case"OrderDateTime":return D(e);default:return Object(h.a)(t)}}(t[t.length-1],n)}if(0===e){return function(e,t){const n=Object(i.Ub)();switch(t){case"CommittedOrder":return{CommittedOrder:A(Object(i.Hb)(e.CommittedOrder,n)?Object(i.g)(e.CommittedOrder,v):n,e.CommittedOrder)};case"OrderDateTime":return w(e);default:return Object(h.a)(t)}}(t[e],n)}const r=t[e];return function(e,t,n){switch(n){case"CommittedOrder":return{CommittedOrder:A(e.CommittedOrder,t.CommittedOrder)};case"OrderDateTime":return k(e,t);default:return Object(h.a)(n)}}(t[e-1],r,n)}function y(e,t){if(0===t.length)return{};if(e>=t.length){return function(e,t){switch(t){case"OrderDateTime":return D(e);default:return Object(h.a)(t)}}(t[t.length-1],"OrderDateTime")}if(0===e){return function(e,t){switch(t){case"OrderDateTime":return w(e);default:Object(h.a)(t)}}(t[e],"OrderDateTime")}const n=t[e];return function(e,t,n){switch(n){case"OrderDateTime":return k(e,t);default:return Object(h.a)(n)}}(t[e-1],n,"OrderDateTime")}function D(e){return{OrderDateTime:Object(i.g)(e.OrderDateTime,-v)}}function w(e){const t=Object(i.Ub)();return{OrderDateTime:A(Object(i.Hb)(e.OrderDateTime,t)?Object(i.g)(e.OrderDateTime,v):t,e.OrderDateTime)}}function k(e,t){return{OrderDateTime:A(e.OrderDateTime,t.OrderDateTime)}}function A(e,t){const n=Object(i.w)(e,t)/2;return Object(i.g)(t,n)}n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"l",(function(){return s})),n.d(t,"m",(function(){return l})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return O})),n.d(t,"q",(function(){return b})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return g})),n.d(t,"k",(function(){return j.a})),n.d(t,"g",(function(){return T})),n.d(t,"i",(function(){return S})),n.d(t,"f",(function(){return I})),n.d(t,"h",(function(){return C})),n.d(t,"j",(function(){return y}))},2590:function(e,t,n){"use strict";var r=n(327);const a=!0,o=!0;function i(e,t,n){return Object(r.g)(e,"GET",n,{throwServiceError:a,customHeaders:d(t)})}function c(e,t,n,i){return Object(r.g)(e,"DELETE",n,{requestObject:i,sendPayloadAsBody:o,throwServiceError:a,customHeaders:d(t)})}function u(e,t,n,i,c){return Object(r.g)(e,"POST",n,{requestObject:i,sendPayloadAsBody:o,throwServiceError:a,customHeaders:d(t,c)})}function s(e,t,n,i,c){return Object(r.g)(e,"PATCH",n,{requestObject:i,sendPayloadAsBody:o,throwServiceError:a,customHeaders:d(t,c)})}function d(e,t){const n={};return e&&(n["x-anchormailbox"]=e),!0===t&&(n.Prefer="return=representation"),!1===t&&(n.Prefer="return=minimal"),n}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return s}))},2654:function(e,t,n){"use strict";var r,a=n(4);!function(e){e.SelectedCalendars="SelectedCalendars",e.MyDay="MyDay",e.SavedCalendarViews="SavedCalendarViews",e.BoardCalendarAsset="BoardCalendarAsset",e.Spotlight="Spotlight",e.CalendarWidget="CalendarWidget",e.Addins="Addins",e.ActivityFeed="ActivityFeed",e.ReadingPane="ReadingPane",e.SXSAttachments="SXSAttachments",e.BoardMailItem="BoardMailItem"}(r||(r={})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return r}));const o=new a.d(()=>n.e(872).then(n.bind(null,19655))),i=(e,t)=>{const n=new a.a(e,t);return(...e)=>n.importAndExecute(...e)},c=i(o,e=>e.convertIdsToTargetFormat),u=i(o,e=>e.translateRestImmutableIdsToEwsIds),s=i(o,e=>e.translateEwsIdsToEwsImmutableIds),d=i(o,e=>e.translateEwsIdsToRestImmutableIds);i(o,e=>e.translateEwsImmutableIdsToEwsIds)},2818:function(e,t,n){"use strict";var r,a;n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a})),function(e){e[e.Retry=1]="Retry",e[e.Undo=2]="Undo"}(r||(r={})),function(e){e[e.ForceDismissedFromCode=11]="ForceDismissedFromCode"}(a||(a={}))},3408:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(282),a=n(2);function o(e){const t=function(e){switch(e){case"TimePanelAgenda":case"TimePanelTodo":return"MyDay";case"BoardCalendarAsset":case"BoardTaskListAsset":case"BoardTaskAsset":return"CalendarBoard";case"TodoWidget":return"ToDoWidget";case"AgendaTodo":case"CalendarSurface":case"CalendarAgenda":return;default:Object(r.a)(e)}}(e);if(t){const e=Object(a.F)();if(e===a.f)return{utmSource:`${t}SuiteHeader`};if(e===a.g)return{utmSource:`${t}Desktop`,removeFromOwa:!0};if(e===a.j&&"ToDoWidget"===t)return{utmSource:t}}return{utmSource:""}}},3504:function(e){e.exports=JSON.parse('{"a":"npb","b":"opb"}')},3913:function(e,t,n){"use strict";var r=n(958),a=n(252),o="Expected a function";t.a=function(e,t,n){var i=!0,c=!0;if("function"!=typeof e)throw new TypeError(o);return Object(a.a)(n)&&(i="leading"in n?!!n.leading:i,c="trailing"in n?!!n.trailing:c),Object(r.a)(e,t,{leading:i,maxWait:t,trailing:c})}},4417:function(e){e.exports=JSON.parse('{"a":"mea"}')},4458:function(e,t,n){"use strict";var r={};n.r(r),n.d(r,"getOutlookSpaces",(function(){return s})),n.d(r,"createOutlookSpace",(function(){return d})),n.d(r,"getOutlookSpace",(function(){return l})),n.d(r,"deleteOutlookSpace",(function(){return m})),n.d(r,"patchOutlookSpace",(function(){return f})),n.d(r,"getOutlookSpaceAssets",(function(){return O})),n.d(r,"canSyncAssets",(function(){return b})),n.d(r,"syncAssets",(function(){return p})),n.d(r,"createOutlookSpaceAsset",(function(){return g})),n.d(r,"deleteOutlookSpaceAsset",(function(){return j})),n.d(r,"patchOutlookSpaceAsset",(function(){return T})),n.d(r,"reorderOutlookSpaceAssetChildren",(function(){return S})),n.d(r,"emptyOutlookSpaceRecycleBin",(function(){return I}));var a=n(1);function o(){return JSON.parse(localStorage.LocalOutlookSpaces||"{}")}function i(e){localStorage.LocalOutlookSpaces=JSON.stringify(e)}function c(e){return JSON.parse(JSON.stringify(e))}function u(e){const{assets:t}=e,n=Object(a.__rest)(e,["assets"]);return Object.assign({},n)}function s(e){return new Promise(t=>{const n=o();let r=Object.keys(n).map(e=>u(n[e])).sort((e,t)=>e.createdDateTime<t.createdDateTime?-1:1);const a=(null==e?void 0:e.appName)||"";a&&(r=r.filter(e=>e.appName&&e.appName.indexOf(a)>-1)),t(r)})}function d(e){return new Promise(t=>{const{assets:n}=e,r=c(Object(a.__rest)(e,["assets"])),s=new Date;r.id=`VOLATILE_${s.getTime()}`,r.createdDateTime=s.toISOString(),r.lastModifiedDateTime=s.toISOString(),r.assets=(null==n?void 0:n.reduce((e,t,n)=>{const r=c(t),a=new Date;return r.id=`VOLATILE_${a.getTime()}_${n}`,r.createdDateTime=a.toISOString(),r.lastModifiedDateTime=a.toISOString(),e[r.id]=r,e},{}))||{};const d=o();d[r.id]=r,i(d),t(u(r))})}function l(e){return new Promise((t,n)=>{const r=o()[e];r?t(u(r)):n("VOLATILE PROJECT NOT FOUND")})}function m(e){return new Promise((t,n)=>{const r=o();r[e]?(delete r[e],i(r),t()):n("VOLATILE PROJECT NOT FOUND")})}function f(e,t){return new Promise((n,r)=>{const a=o();if(a[e]){const r=a[e]=Object.assign(Object.assign(Object.assign({},a[e]),c(t)),{lastModifiedDateTime:(new Date).toISOString()});i(a),n(u(r))}else r("VOLATILE PROJECT NOT FOUND")})}async function O(e){return new Promise((t,n)=>{var r;const a=null===(r=o()[e])||void 0===r?void 0:r.assets;if(a){const e=Object.keys(a).map(e=>a[e]).sort((e,t)=>e.createdDateTime<t.createdDateTime?-1:1);for(const t of e)t.x=t.x||0,t.y=t.y||0;t(e)}else n("VOLATILE PROJECT NOT FOUND")})}function b(){return!1}function p(e,t){return Promise.reject()}async function g(e,t){return new Promise((n,r)=>{var a;const u=o(),s=null===(a=u[e])||void 0===a?void 0:a.assets;if(s){const e=c(t),r=new Date;e.id=`VOLATILE_${r.getTime()}`,e.createdDateTime=r.toISOString(),e.lastModifiedDateTime=r.toISOString(),s[e.id]=e,i(u),n(e)}else r("VOLATILE PROJECT NOT FOUND")})}function j(e,t){return new Promise((n,r)=>{var a;const c=o(),u=null===(a=c[e])||void 0===a?void 0:a.assets;if(u){u[t]||r("VOLATILE ASSET NOT FOUND"),delete u[t],Object.keys(u).forEach(e=>{u[e].parentId==t&&delete u[e]}),i(c),setTimeout(n,1)}else r("VOLATILE PROJECT NOT FOUND")})}function T(e,t,n,r){return new Promise((r,a)=>{var u;const s=o(),d=null===(u=s[e])||void 0===u?void 0:u.assets;if(d){const e=d[t];e||a("VOLATILE ASSET NOT FOUND");const o=d[t]=Object.assign(Object.assign(Object.assign({},e),c(n)),{parentId:null===n.parentId?void 0:n.parentId||e.parentId,lastModifiedDateTime:(new Date).toISOString()});i(s),r(o)}else a("VOLATILE PROJECT NOT FOUND")})}function S(e,t){return Promise.reject("NOT IMPLEMENTED")}function I(e){return Promise.resolve()}var h=n(47),v=n(2590);const C=[["cal-board-dev-useApiVersion2_0","v2.0/spaces"],["cal-board-dev-useApiVersion1_0","v1.0/spaces"],["cal-board-dev-useApiVersion1_5","v1.5/spaces"]];function y(){for(const[e,t]of C)if(Object(h.j)(e))return t;return"api/spaces"}function D(e){const t=null==e?void 0:e.appName,n=t?"?appName="+encodeURIComponent(t):"";return y()+n}function w(e){return y()+"/"+encodeURIComponent(e)}function k(e){return w(e)+"/assets"}function A(e,t){return k(e)+"/"+encodeURIComponent(t)}class E{constructor(e){this.targetMailbox=e,this.baseUrl="ows/"+(e?e+"/":"")}getOutlookSpaces(e){return Object(v.b)("getOutlookSpaces",this.targetMailbox,this.baseUrl+D(e))}createOutlookSpace(e){return Object(v.d)("createOutlookSpace",this.targetMailbox,this.baseUrl+D(),e)}getOutlookSpace(e){return Object(v.b)("getOutlookSpace",this.targetMailbox,this.baseUrl+w(e))}deleteOutlookSpace(e){return Object(v.a)("deleteOutlookSpace",this.targetMailbox,this.baseUrl+w(e))}patchOutlookSpace(e,t){return Object(v.c)("patchOutlookSpace",this.targetMailbox,this.baseUrl+w(e),t)}getOutlookSpaceAssets(e){return Object(v.b)("getOutlookSpaceAssets",this.targetMailbox,this.baseUrl+k(e))}canSyncAssets(){return!0}syncAssets(e,t){return Object(v.b)("syncAssets",this.targetMailbox,this.baseUrl+function(e,t){const n=k(e)+"/sync",r=["skipToken","deltaToken","maxPageSize"].map(e=>t[e]?`${e}=${encodeURIComponent(t[e])}`:"").filter(e=>e).join("&");return n+(r?"?"+r:"")}(e,t))}createOutlookSpaceAsset(e,t){return Object(v.d)("createOutlookSpaceAsset",this.targetMailbox,this.baseUrl+k(e),t)}deleteOutlookSpaceAsset(e,t){return Object(v.a)("deleteOutlookSpaceAsset",this.targetMailbox,this.baseUrl+A(e,t)+"?deleteChildren=true")}patchOutlookSpaceAsset(e,t,n,r){return Object(v.c)("patchOutlookSpaceAsset",this.targetMailbox,this.baseUrl+A(e,t),n,r)}reorderOutlookSpaceAssetChildren(e,t){return Object(v.d)("reorderOutlookSpaceAssetChildren",this.targetMailbox,this.baseUrl+function(e,t){return A(e,t)+"/reorderChildren"}(e,t),null)}emptyOutlookSpaceRecycleBin(e){return Object(v.a)("emptyOutlookSpaceRecycleBin",this.targetMailbox,this.baseUrl+function(e){return w(e)+"/recycleBin"}(e))}}let x=void 0;function N(){return void 0===x&&(x=Object(h.j)("cal-board-dev-useLocalService")?r:new E),x}function F(e){return N().getOutlookSpaces(e)}function P(e,t){const n=t?new E(t):N();return e.assets&&e.assets.forEach((function(e){M(e)})),n.createOutlookSpace(e)}function L(e){return N().getOutlookSpaceAssets(e)}function R(e,t){return N().createOutlookSpaceAsset(e,M(t))}function _(e){return N().emptyOutlookSpaceRecycleBin(e)}function M(e){return e.x=U(e.x),e.y=U(e.y),e.width=U(e.width),e.height=U(e.height),e.rotation=U(e.rotation),e}function U(e){return e?Math.round(e):e}n.d(t,"g",(function(){return F})),n.d(t,"b",(function(){return P})),n.d(t,"f",(function(){return L})),n.d(t,"c",(function(){return R})),n.d(t,"d",(function(){return _})),n.d(t,"a",(function(){return E})),n.d(t,"e",(function(){return N}))},473:function(e,t,n){"use strict";var r=n(347),a=n(306),o="[object Symbol]";t.a=function(e){return"symbol"==typeof e||Object(a.a)(e)&&Object(r.a)(e)==o}},629:function(e,t,n){"use strict";var r=/\s/;var a=function(e){for(var t=e.length;t--&&r.test(e.charAt(t)););return t},o=/^\s+/;var i=function(e){return e?e.slice(0,a(e)+1).replace(o,""):e},c=n(252),u=n(473),s=NaN,d=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,m=/^0o[0-7]+$/i,f=parseInt;t.a=function(e){if("number"==typeof e)return e;if(Object(u.a)(e))return s;if(Object(c.a)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Object(c.a)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=i(e);var n=l.test(e);return n||m.test(e)?f(e.slice(2),n?2:8):d.test(e)?s:+e}},958:function(e,t,n){"use strict";var r=n(252),a=n(247),o=function(){return a.a.Date.now()},i=n(629),c="Expected a function",u=Math.max,s=Math.min;t.a=function(e,t,n){var a,d,l,m,f,O,b=0,p=!1,g=!1,j=!0;if("function"!=typeof e)throw new TypeError(c);function T(t){var n=a,r=d;return a=d=void 0,b=t,m=e.apply(r,n)}function S(e){var n=e-O;return void 0===O||n>=t||n<0||g&&e-b>=l}function I(){var e=o();if(S(e))return h(e);f=setTimeout(I,function(e){var n=t-(e-O);return g?s(n,l-(e-b)):n}(e))}function h(e){return f=void 0,j&&a?T(e):(a=d=void 0,m)}function v(){var e=o(),n=S(e);if(a=arguments,d=this,O=e,n){if(void 0===f)return function(e){return b=e,f=setTimeout(I,t),p?T(e):m}(O);if(g)return clearTimeout(f),f=setTimeout(I,t),T(O)}return void 0===f&&(f=setTimeout(I,t)),m}return t=Object(i.a)(t)||0,Object(r.a)(n)&&(p=!!n.leading,l=(g="maxWait"in n)?u(Object(i.a)(n.maxWait)||0,t):l,j="trailing"in n?!!n.trailing:j),v.cancel=function(){void 0!==f&&clearTimeout(f),b=0,a=O=d=f=void 0},v.flush=function(){return void 0===f?m:h(o())},v}}}]);
//# sourceMappingURL=owa.vendors~CalendarBoardContextMenu.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.vendors~CalendarBoardContextMenu.js'] = 1;