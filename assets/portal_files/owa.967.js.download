(window.$wj=window.$wj||[]).push([[967],{10581:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var c=n(1675);function r(e){const t=Object(c.L)().meetingMessageItems.get(e);if(!t)return null;const n=t;return n.Start&&n.End&&n.CalendarItemType?n:null}},10582:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var c=n(2481),r=n(1690),i=n(1698),o=n(6467);function a(e){const t=Object(i.a)(e.ParentFolderId.Id);if("deleteditems"===t||"sentitems"===t)return!1;if(e.IsDelegated&&e.ReceivedRepresenting)return!1;if(!e.AssociatedCalendarItemId)return!1;if(Object(c.f)(e.ItemClass)){const t=e;if("InformationalUpdate"===t.MeetingRequestType)return!1;if("NoResponseReceived"!==e.ResponseType)return!1;if(Object(o.a)(t,Object(r.h)()))return!1}return!0}},1690:function(e,t,n){"use strict";var c=n(3);const r=Object(c.action)("initializeOwaObservableDateTime"),i=Object(c.action)("observableNowChanged"),o=Object(c.action)("observableTodayChanged");var a=n(7),s=n(16),b=Object(c.createStore)("ObservableDateTime",{now:0,today:0});const d=Object(s.computed)(()=>Object(a.qc)(b().now)),u=()=>d.get(),O=Object(s.computed)(()=>Object(a.qc)(b().today)),j=()=>O.get(),l=e=>Object(a.Jb)(e,u()),f=e=>Object(a.Hb)(e,u()),m=e=>g(e,a.Jb),I=e=>g(e,a.Kb),g=(e,t)=>t(Object(a.bc)(Object(a.qc)(e)),j());function R(e){if(!e)return"";const t=Object(a.qc)(e);return function(e,t){const n=Object(a.bc)(e);if(Object(a.Lb)(n,t))return a.ab;const c=e=>Object(a.Rb)(n,Object(a.e)(t,-e),t);if(c(3))return a.ib;if(c(30))return a.hb;return a.Y}(t,j())(t)}function h(e){if(!e)return"";return function(e,t){const n=Object(a.bc)(e);return Object(a.Lb)(n,t)?Object(a.ab)(e):p(n,t,2)?Object(a.lb)(e):p(n,t,7)?Object(a.H)(Object(a.bb)(e),Object(a.ab)(e)):Object(a.H)(Object(a.J)(e),Object(a.ab)(e))}(Object(a.qc)(e),j())}function p(e,t,n){return Object(a.Rb)(e,Object(a.e)(t,-n),t)}const y=Object(c.action)("updateTimes"),v=Object(c.action)("setNow"),w=Object(c.action)("setToday",e=>({today:e}));Object(c.mutator)(v,()=>{b().now=Object(a.oc)()}),Object(c.mutator)(w,({today:e})=>{b().today=e});var F=n(22),M=n(88);let E=!1;Object(c.orchestrator)(r,()=>{if(y(),!E){const e=Object(a.Ub)(),t=Object(a.dc)(Object(a.h)(e,1)),n=Object(a.w)(t,e);setTimeout(()=>setInterval(y,F.g),n),document&&document.addEventListener("visibilitychange",y),E=!0}}),Object(c.orchestrator)(M.m,()=>{y()}),Object(c.orchestrator)(y,()=>{v();const e=Object(a.Cb)(Object(a.pc)()),t=b().today!=e;t&&w(e),i(),t&&o()}),n.d(t,"c",(function(){return r})),n.d(t,"i",(function(){return i})),n.d(t,"k",(function(){return o})),n.d(t,"h",(function(){return u})),n.d(t,"j",(function(){return j})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"g",(function(){return I})),n.d(t,"a",(function(){return R})),n.d(t,"b",(function(){return h}))},468:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}));n(588);let c;function r(e){if(!c)throw new Error("Localization has not yet been initialized");return c(e)}function i(e){c=e}},5575:function(e,t,n){"use strict";n.r(t);var c=n(3);const r=Object(c.action)("parseGetItemResponseAction",(e,t)=>({items:e,clientItemIds:t})),i=Object(c.action)("tryPrefetchMeetingMessage",(e,t,n)=>({mailboxInfo:e,listViewType:t,shouldDelayPrefetch:n})),o=Object(c.action)("removeMeetingMessagesFromStore",e=>({itemIds:e}));var a=n(3817),s=n(71),b=n(1675),d=n(1692),u=n(10581),O=n(707),j=n(1701),l=n(2548),f=n(36),m=n(10582);const I=Object(c.mutatorAction)("updateMailStoreForRsvp",(e,t)=>{e.shouldShowRSVP=t}),g=Object(c.mutatorAction)("updateTableRelationMapForRsvp",(e,t)=>{e.shouldShowRSVP=t}),R=[Object(j.a)({FieldURI:"Start"}),Object(j.a)({FieldURI:"End"}),Object(j.a)({FieldURI:"AssociatedCalendarItemId"}),Object(j.a)({FieldURI:"RecurrenceId"}),Object(j.a)({FieldURI:"Recurrence"}),Object(j.a)({FieldURI:"ConflictingMeetings"}),Object(j.a)({FieldURI:"CalendarItemType"}),Object(j.a)({FieldURI:"IsResponseRequested"}),Object(j.a)({FieldURI:"Organizer"}),Object(j.a)({FieldURI:"ItemClass"}),Object(j.a)({FieldURI:"MeetingRequestType"}),Object(j.a)({FieldURI:"ItemParentId"}),Object(j.a)({FieldURI:"Sender"}),Object(j.a)({FieldURI:"ConversationId"}),Object(j.a)({FieldURI:"IsDelegated"}),Object(j.a)({FieldURI:"ReceivedRepresenting"}),Object(j.a)({FieldURI:"ResponseType"})];async function h(e,t,n){const c=new s.b("LoadMeetingMessage");c.addCustomProperty("count",e.length);const i=e.map(e=>e.Id);try{const t=await Object(d.e)(i,Object(O.a)({BaseShape:"IdOnly",AdditionalProperties:R}),null);if(!t||t instanceof Error)c.endWithError("ServerError");else{const n=e.filter(e=>t.some(t=>t.ItemId.Id===e.Id));r(t,n),c.end()}(t instanceof Error||t.length!==i.length)&&f.h.warn(`[loadingmeetingmessage] some items failed in: ${i}`)}catch(e){c.endWithError("ServerError",Error(e)),f.h.warn(`[loadingmeetingmessage] all items failed in: ${i}`)}!function(e,t){t.forEach(t=>{if(1===e){const e=d.u.items.get(t.itemId);if(!e)return;const n=Object(u.a)(t.itemId);n&&Object(m.a)(n)||I(e,!1)}else{const e=Object(b.M)(t.rowKey,t.tableViewId);if(!e)return;const n=Object(u.a)(t.itemId);n&&Object(m.a)(n)||g(e,!1)}})}(n,t)}Object(c.orchestrator)(i,e=>{const{listViewType:t,mailboxInfo:n,shouldDelayPrefetch:c}=e,r=n.mailboxSmtpAddress,i=a.b(r);if(a.c(r),!i||0===i.length)return;const o=i.map(e=>({Id:e.itemId,mailboxInfo:n}));c?l.c.importAndExecute({task:()=>h(o,i,t),priority:l.a.Messages}):h(o,i,t)}),Object(c.mutator)(r,e=>{const{items:t,clientItemIds:n}=e;for(let e=0;e<t.length;e++){const c=t[e],r=n[e],i=Object(b.L)().meetingMessageItems.get(r.Id);if(i){Object.keys(i).forEach(e=>{c[e]&&(i[e]=c[e])})}else{const e=Object.assign(Object.assign({},c),{MailboxInfo:r.mailboxInfo,SmartTimeData:null,SmartTimeExtendedProperty:null,smartPillFeedbackSubmitted:!1});Object(b.L)().meetingMessageItems.set(r.Id,e)}}}),Object(c.mutator)(o,e=>{const{itemIds:t}=e,n=Object(b.L)();t.forEach(e=>{n.meetingMessageItems.has(e)&&setTimeout(()=>{n.meetingMessageItems.delete(e)},1e3)})}),n.d(t,"tryPrefetchMeetingMessage",(function(){return i})),n.d(t,"removeMeetingMessagesFromStore",(function(){return o}))},6467:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var c=n(7),r=n(3101);function i({End:e,Recurrence:t},n){if(t){const{RecurrenceRange:e}=t,{EndDate:i}=e;if(i){const e=Object(c.qc)(i);return Object(c.Jb)(e,n)}const{NumberOfOccurrences:o,StartDate:a}=e;if(o){const e=Object(c.qc)(a),i=Object(r.a)(t.RecurrencePattern).getNumberedRecurrenceEndDate(t.RecurrencePattern,e,o);return Object(c.Jb)(i,n)}return!1}return Object(c.Jb)(Object(c.qc)(e),n)}}}]);
//# sourceMappingURL=owa.967.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.967.js'] = 1;