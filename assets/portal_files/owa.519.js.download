(window.$wj=window.$wj||[]).push([[519],{1678:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(66);function c(t){if(!t)throw new Error("Input parameter to folderNameToId must not be null.");return r.a.defaultFolderNameToIdMap.get(t)}},1690:function(t,n,e){"use strict";var r=e(3);const c=Object(r.action)("initializeOwaObservableDateTime"),o=Object(r.action)("observableNowChanged"),a=Object(r.action)("observableTodayChanged");var i=e(7),u=e(16),s=Object(r.createStore)("ObservableDateTime",{now:0,today:0});const d=Object(u.computed)(()=>Object(i.qc)(s().now)),l=()=>d.get(),f=Object(u.computed)(()=>Object(i.qc)(s().today)),b=()=>f.get(),m=t=>Object(i.Jb)(t,l()),h=t=>Object(i.Hb)(t,l()),p=t=>j(t,i.Jb),O=t=>j(t,i.Kb),j=(t,n)=>n(Object(i.bc)(Object(i.qc)(t)),b());function g(t){if(!t)return"";const n=Object(i.qc)(t);return function(t,n){const e=Object(i.bc)(t);if(Object(i.Lb)(e,n))return i.ab;const r=t=>Object(i.Rb)(e,Object(i.e)(n,-t),n);if(r(3))return i.ib;if(r(30))return i.hb;return i.Y}(n,b())(n)}function v(t){if(!t)return"";return function(t,n){const e=Object(i.bc)(t);return Object(i.Lb)(e,n)?Object(i.ab)(t):I(e,n,2)?Object(i.lb)(t):I(e,n,7)?Object(i.H)(Object(i.bb)(t),Object(i.ab)(t)):Object(i.H)(Object(i.J)(t),Object(i.ab)(t))}(Object(i.qc)(t),b())}function I(t,n,e){return Object(i.Rb)(t,Object(i.e)(n,-e),n)}const y=Object(r.action)("updateTimes"),A=Object(r.action)("setNow"),w=Object(r.action)("setToday",t=>({today:t}));Object(r.mutator)(A,()=>{s().now=Object(i.oc)()}),Object(r.mutator)(w,({today:t})=>{s().today=t});var S=e(22),x=e(88);let P=!1;Object(r.orchestrator)(c,()=>{if(y(),!P){const t=Object(i.Ub)(),n=Object(i.dc)(Object(i.h)(t,1)),e=Object(i.w)(n,t);setTimeout(()=>setInterval(y,S.g),e),document&&document.addEventListener("visibilitychange",y),P=!0}}),Object(r.orchestrator)(x.m,()=>{y()}),Object(r.orchestrator)(y,()=>{A();const t=Object(i.Cb)(Object(i.pc)()),n=s().today!=t;n&&w(t),o(),n&&a()}),e.d(n,"c",(function(){return c})),e.d(n,"i",(function(){return o})),e.d(n,"k",(function(){return a})),e.d(n,"h",(function(){return l})),e.d(n,"j",(function(){return b})),e.d(n,"f",(function(){return m})),e.d(n,"d",(function(){return h})),e.d(n,"e",(function(){return p})),e.d(n,"g",(function(){return O})),e.d(n,"a",(function(){return g})),e.d(n,"b",(function(){return v}))},1732:function(t,n,e){"use strict";e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return c})),e.d(n,"c",(function(){return o})),e.d(n,"e",(function(){return a})),e.d(n,"d",(function(){return i}));const r="FileAttachment:#Exchange",c="ItemAttachment:#Exchange",o="ItemIdAttachment:#Exchange",a="ReferenceAttachment:#Exchange",i="LinkAttachment:#Exchange"},1743:function(t,n,e){"use strict";function r(t,n){Object.keys(n).forEach(e=>t.set(e,n[e]))}function c(t){let n=null!=t?t:{headers:new Headers};return n.datapoint=n.datapoint||{},n.datapoint.mailbox="Default",n}e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return c}))},1744:function(t,n,e){"use strict";var r=e(1877),c=e(287),o=e(1690),a=e(71),i=e(7),u=e(36);const s="X-AnchorMailbox",d="Authorization",l="X-OwaWebSessionType",f="X-OWA-ExplicitLogonUser";async function b(t,n){const e={},b=Object(c.k)(t);if(n?(e[s]=n,e[f]=n):b&&(e[s]=b.anchorMailbox),Object(c.s)())return u.h.info("[cal-multiAccounts-sourceId] Bypassing legacy connected account header processing."),e;if(b){if(b.accountState==c.b.AccessRevoked)return null;if(b.accountState==c.b.AccountDeprovisioned||b.accountState==c.b.AccountNotFound)return Object(c.d)(b.accountState,b.accountProviderType),null}if(b){let n,c=b.token,s=Object(o.f)(b.tokenExpiry);!s&&c||(Object(a.o)("getAndUpdateAccessToken",{tokenExpiry:Object(i.y)(b.tokenExpiry,Object(i.Ub)()),isTokenExpired_1:s,isTokenInvalid_2:!c},{isCore:!0}),c=await r.a.importAndExecute(b.accountId,t,c),u.h.info("[AccountLoadRecovery] getConnectedAccountHeaders: finished GetAndUpdateAccessToken for "+t+c),c||(c="")),"Outlook"==b.accountProviderType?(n=`MSAuth1.0 usertoken="${c}", type="MSACT"`,e[l]=1..toString()):"Google"!=b.accountProviderType&&"ICloud"!=b.accountProviderType&&"Yahoo"!=b.accountProviderType||(n=`Bearer ${c}`,e[l]=2..toString()),e[d]=n}return e}var m=e(1743),h=e(912);async function p(t,n){var e;const r=Object(m.a)();if(r.headers=await async function(t,n){var e;const r=n&&(null===(e=t.headers)||void 0===e?void 0:e.set)?new Headers(t.headers):new Headers,c=await b(t.mailboxInfo.userIdentity,O(t.mailboxInfo.type,t.mailboxInfo.mailboxSmtpAddress)?t.mailboxInfo.mailboxSmtpAddress:null);return Object(m.b)(r,c),r}(t,n),r.authNeededOnUnAuthorized=!1,r.datapoint=r.datapoint||{},Object(c.s)()){const n=Object(h.a)(null===(e=null==t?void 0:t.mailboxInfo)||void 0===e?void 0:e.userIdentity);u.h.info("[cal-multiAccounts-sourceId:getConnectedAccountRequestOptions] sourceId: "+n),r.sourceId=n,r.datapoint.mailbox="Connected"}else r.datapoint.mailbox="Connected";return r}function O(t,n){const e="GroupMailbox"==t||"TeamsMailbox"==t||"SharedMailbox"==t||"PublicMailbox"==t;return e&&null==n&&u.d("getHeadersForConnectedAccount: mailboxSmtpAddress should be passed for Group or Teams or Shared or Public Mbx request"),e}e.d(n,"a",(function(){return b})),e.d(n,"b",(function(){return p})),e.d(n,"c",(function(){return O}))},1765:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(3);const c=Object(r.action)("triggerReInitializeAccount",t=>({userIdentity:t}))},1796:function(t,n,e){"use strict";function r(t){return Object.assign({__type:"IndexedPageView:#Exchange"},t)}e.d(n,"a",(function(){return r}))},1858:function(t,n,e){"use strict";e.d(n,"b",(function(){return r})),e.d(n,"d",(function(){return c})),e.d(n,"a",(function(){return o})),e.d(n,"c",(function(){return a})),e.d(n,"e",(function(){return i}));const r="originalsrc",c="shash",o="data-auth",a="&reserved=0",i="Verified"},1877:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(20),c=e(1765);e.d(n,"b",(function(){return c.a}));const o=new r.c(()=>e.e(874).then(e.bind(null,2361))),a=new r.a(o,t=>t.getAndUpdateAccessToken)},2007:function(t,n,e){"use strict";var r;function c(){return[r.noPermissionToShare,r.getSharingInfoFailed,r.linkHasExpired,r.linkWillExpire,r.noPermissionToShareExternally,r.externalRecipientCSL,r.noPermissionSet,r.sharingWithLargeDL]}e.d(n,"a",(function(){return r})),e.d(n,"b",(function(){return c})),function(t){t.noPermissionToShare="WarningNoPermissionToShare",t.getSharingInfoFailed="WarningGetSharingInfoFailed",t.linkHasExpired="WarningLinksHasExpired",t.linkWillExpire="WarningLinksWillExpire",t.noPermissionToShareExternally="WarningExternalRecipientButNoPermissionToShareExternally",t.externalRecipientCSL="WarningExternalRecipientsCannotOpenCSLs",t.noPermissionSet="WarningOnlyPeopleWithExistingAccessCanAccess",t.sharingWithLargeDL="WarningNotAllMembersOfDLCanAccess"}(r||(r={}))},2067:function(t,n,e){var r=e(2074),c=36e5,o=6e4,a=2,i=/[T ]/,u=/:/,s=/^(\d{2})$/,d=[/^([+-]\d{2})$/,/^([+-]\d{3})$/,/^([+-]\d{4})$/],l=/^(\d{4})/,f=[/^([+-]\d{4})/,/^([+-]\d{5})/,/^([+-]\d{6})/],b=/^-(\d{2})$/,m=/^-?(\d{3})$/,h=/^-?(\d{2})-?(\d{2})$/,p=/^-?W(\d{2})$/,O=/^-?W(\d{2})-?(\d{1})$/,j=/^(\d{2}([.,]\d*)?)$/,g=/^(\d{2}):?(\d{2}([.,]\d*)?)$/,v=/^(\d{2}):?(\d{2}):?(\d{2}([.,]\d*)?)$/,I=/([Z+-].*)$/,y=/^(Z)$/,A=/^([+-])(\d{2})$/,w=/^([+-])(\d{2}):?(\d{2})$/;function S(t,n,e){n=n||0,e=e||0;var r=new Date(0);r.setUTCFullYear(t,0,4);var c=7*n+e+1-(r.getUTCDay()||7);return r.setUTCDate(r.getUTCDate()+c),r}t.exports=function(t,n){if(r(t))return new Date(t.getTime());if("string"!=typeof t)return new Date(t);var e=(n||{}).additionalDigits;e=null==e?a:Number(e);var x=function(t){var n,e={},r=t.split(i);u.test(r[0])?(e.date=null,n=r[0]):(e.date=r[0],n=r[1]);if(n){var c=I.exec(n);c?(e.time=n.replace(c[1],""),e.timezone=c[1]):e.time=n}return e}(t),P=function(t,n){var e,r=d[n],c=f[n];if(e=l.exec(t)||c.exec(t)){var o=e[1];return{year:parseInt(o,10),restDateString:t.slice(o.length)}}if(e=s.exec(t)||r.exec(t)){var a=e[1];return{year:100*parseInt(a,10),restDateString:t.slice(a.length)}}return{year:null}}(x.date,e),T=P.year,E=function(t,n){if(null===n)return null;var e,r,c,o;if(0===t.length)return(r=new Date(0)).setUTCFullYear(n),r;if(e=b.exec(t))return r=new Date(0),c=parseInt(e[1],10)-1,r.setUTCFullYear(n,c),r;if(e=m.exec(t)){r=new Date(0);var a=parseInt(e[1],10);return r.setUTCFullYear(n,0,a),r}if(e=h.exec(t)){r=new Date(0),c=parseInt(e[1],10)-1;var i=parseInt(e[2],10);return r.setUTCFullYear(n,c,i),r}if(e=p.exec(t))return o=parseInt(e[1],10)-1,S(n,o);if(e=O.exec(t)){o=parseInt(e[1],10)-1;var u=parseInt(e[2],10)-1;return S(n,o,u)}return null}(P.restDateString,T);if(E){var k,L=E.getTime(),C=0;return x.time&&(C=function(t){var n,e,r;if(n=j.exec(t))return(e=parseFloat(n[1].replace(",",".")))%24*c;if(n=g.exec(t))return e=parseInt(n[1],10),r=parseFloat(n[2].replace(",",".")),e%24*c+r*o;if(n=v.exec(t)){e=parseInt(n[1],10),r=parseInt(n[2],10);var a=parseFloat(n[3].replace(",","."));return e%24*c+r*o+1e3*a}return null}(x.time)),x.timezone?k=function(t){var n,e;if(n=y.exec(t))return 0;if(n=A.exec(t))return e=60*parseInt(n[2],10),"+"===n[1]?-e:e;if(n=w.exec(t))return e=60*parseInt(n[2],10)+parseInt(n[3],10),"+"===n[1]?-e:e;return 0}(x.timezone):(k=new Date(L+C).getTimezoneOffset(),k=new Date(L+C+k*o).getTimezoneOffset()),new Date(L+C+k*o)}return new Date(t)}},2074:function(t,n){t.exports=function(t){return t instanceof Date}},2142:function(t,n,e){"use strict";e.d(n,"h",(function(){return s})),e.d(n,"i",(function(){return d})),e.d(n,"f",(function(){return l})),e.d(n,"k",(function(){return f})),e.d(n,"m",(function(){return b})),e.d(n,"e",(function(){return m})),e.d(n,"g",(function(){return h})),e.d(n,"j",(function(){return p})),e.d(n,"l",(function(){return O}));var r=e(20),c=e(2283);e.d(n,"n",(function(){return c.a}));var o=e(2269);e.d(n,"a",(function(){return o.a}));var a=e(2007);e.d(n,"d",(function(){return a.b})),e.d(n,"c",(function(){return a.a}));var i=e(2284);e.d(n,"b",(function(){return i.a}));const u=new r.c(()=>Promise.all([e.e(0),e.e(24),e.e(96),e.e(608)]).then(e.bind(null,3852))),s=new r.b(u,t=>t.getSharingInformation),d=new r.b(u,t=>t.getSharingIssuesForSharingData),l=new r.b(u,t=>t.getInfoBarCreator),f=new r.b(u,t=>t.hasLargeDLRecipient),b=new r.b(u,t=>t.hasRecipientExpansionFailure),m=new r.b(u,t=>t.getGroupsAndSmallDLs),h=new r.b(u,t=>t.getInvididualRecipients),p=new r.b(u,t=>t.hasGetRecipientPermissionFailed),O=new r.b(u,t=>t.logSharingTipChangesForLinkRemoval)},2269:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.InProgress=0]="InProgress",t[t.Failed=1]="Failed",t[t.Succeeded=2]="Succeeded"}(r||(r={}))},227:function(t,n,e){"use strict";n.decode=n.parse=e(380),n.encode=n.stringify=e(381)},2283:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(3);const c=Object(r.action)("REFRESH_EXPIRATION_DATE",t=>({id:t}))},2284:function(t,n,e){"use strict";var r;e.d(n,"a",(function(){return r})),function(t){t[t.ignore=0]="ignore",t[t.refreshExpiration=1]="refreshExpiration",t[t.changePermission=2]="changePermission",t[t.attachAsACopy=3]="attachAsACopy"}(r||(r={}))},2413:function(t,n,e){"use strict";var r=e(47),c=e(6),o=e(2945),a=e(3020),i=e(1943),u=e(2998),s=e(2533),d=e(2426),l=e(2916),f=e(1862),b=e(2802),m=e(1786),h=e(36),p=e(702),O=e(1824);var j=e(1857),g=e(1738);n.a=Object(p.action)("addAndInitializeAttachments")((function(t,n,e=!1,v=!1){const I=Object(O.a)();e||(t=t.filter(t=>!I.attachments.has(t.attachment.AttachmentId.Id))),t.map(t=>{const{attachmentId:e,attachment:I,permissionInfo:y,modelInitializationValues:A}=t,w=function(t,n){const e={id:t,type:Object(j.a)(n),download:{url:null},attachmentClass:0,previewImage:{url:null},thumbnailImage:{url:null},info:{allowDownload:!1,supportedPermissionLevels:[],sharingInfo:null},model:n};if(1===e.type&&Object(g.a)(n)){return Object.assign(Object.assign({},e),{type:1,openUrl:null,originalUrl:null,isFolder:n.AttachmentIsFolder,requiresFetchingSharingInformation:!1})}return e}(e,I);return v||function(t,n,e){const j=Object(f.a)(t),g=Object(m.b)(t.model,!0),v=Object(a.a)(g,t.model);t.attachmentClass=v,t.info=Object(o.a)(g,v,t.model,j,j?t.model.ProviderType:null,n),t.info.allowDownload&&(t.download.url=Object(d.a)(t.id,t.model,!0,!0)),j&&(t.openUrl=Object(l.a)(t.model)),(j&&Object(r.j)("doc-unwrap-safelinks")?Object(s.a)(t.model):Promise.resolve(void 0)).then(n=>{if(n&&(t.originalUrl=n),j&&!e){const n=t.model,e=Object(i.a)(n.ProviderType);(null==e?void 0:e.requiresFetchingSharingInformation)&&!Object(c.k)(n.AttachLongPathName)&&(t.requiresFetchingSharingInformation=!0)}if(Object(b.a)(t.model)){const n=t.id.Id;Object(u.a)(t.id,t.model,j).then(Object(p.action)("updateAttachmentThumbnailUrl")((function(t){Object(O.a)().attachments.has(n)&&(Object(O.a)().attachments.get(n).thumbnailImage.url=t)})),t=>{h.h.warn(t)})}})}(w,y,n),function(t,n){n=n||{},Object.keys(n).forEach(e=>{n[e]&&(t[e]=n[e])})}(w,A||{}),w}).forEach(t=>{var n;const e=t.model;if(e&&!e.AttachmentOriginalUrl){const r=I.attachments.get(t.id.Id);(null===(n=null==r?void 0:r.model)||void 0===n?void 0:n.AttachmentOriginalUrl)&&(e.AttachmentOriginalUrl=r.model.AttachmentOriginalUrl)}if(e&&Object(f.b)(e)){const n=e;if(!n.AttachLongPathName){const e=I.attachments.get(t.id.Id),r=null==e?void 0:e.model;(null==r?void 0:r.AttachLongPathName)&&(n.AttachLongPathName=r.AttachLongPathName)}}I.attachments.set(t.id.Id,t)})}))},2426:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(1778),c=e(1862),o=e(2238);function a(t,n,e,a=!1){if(Object(c.b)(n))switch(n.ProviderType){case r.b:return function(t){const n=t.AttachLongPathName,e=n.lastIndexOf("?");return`${n.substring(0,e)}?dl=1`}(n)}return Object(o.a)(t,n,0,Object(c.b)(n),e,a)}},2533:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(2652);async function c(t){let n,e;return(e=await r.f.import())&&(n=await e(t.AttachLongPathName)),n}},2652:function(t,n,e){"use strict";e.d(n,"f",(function(){return a})),e.d(n,"g",(function(){return i})),e.d(n,"h",(function(){return u}));var r=e(20),c=e(1858);e.d(n,"b",(function(){return c.b})),e.d(n,"d",(function(){return c.d})),e.d(n,"a",(function(){return c.a})),e.d(n,"c",(function(){return c.c})),e.d(n,"e",(function(){return c.e}));const o=new r.c(()=>e.e(1159).then(e.bind(null,4221))),a=new r.b(o,t=>t.evaluateSafeLink),i=(new r.b(o,t=>t.evaluateSafeLinks),new r.b(o,t=>t.isSafeLink)),u=new r.b(o,t=>t.isSafeLinkUrl)},2692:function(t,n,e){"use strict";var r=e(1713),c=e(2426),o=e(702);n.a=Object(o.action)("refreshDownloadUrl")((function(t,n,e=!1){const o=Object(r.a)(t),a=Object(c.a)(t,o.model,n,e);o.download.url=a}))},2802:function(t,n,e){"use strict";e.d(n,"a",(function(){return d}));var r=e(1943),c=e(1957),o=e(1786),a=e(1696),i=e(1738),u=e(2425),s=e(2521);function d(t){if(!Object(o.b)(t,!0).directFileAccessEnabled&&!t.IsInline||Object(c.b)(t.AttachmentId.Id))return!1;if(t.Thumbnail)return!0;const n=Object(a.g)(t.Name,t.ContentType,!1),e=Object(a.h)(t.Name);if((Object(u.a)(t)||Object(s.a)(t))&&(n||e))return!0;if(Object(i.a)(t)){const e=Object(r.a)(t.ProviderType);if(t.AttachmentThumbnailUrl||n&&e&&e.supportImageThumbnail)return!0}return!1}},287:function(t,n,e){"use strict";var r,c=e(3);!function(t){t[t.Valid=0]="Valid",t[t.AccountDeprovisioned=1]="AccountDeprovisioned",t[t.AccessRevoked=2]="AccessRevoked",t[t.TransientTokenError=3]="TransientTokenError",t[t.FailedToInitializeOWAConfig=4]="FailedToInitializeOWAConfig",t[t.AccountNotFound=5]="AccountNotFound",t[t.UnknownTokenError=6]="UnknownTokenError"}(r||(r={}));var o=e(80);const a=Object(c.action)("addAccount",t=>({userIdentity:t.userIdentity,account:t})),i=Object(c.action)("removeAccount",t=>({userIdentity:t})),u=Object(c.action)("updateAccount",(t,n,e)=>({userIdentity:t,accountToken:n,accountTokenExpiresIn:e})),s=Object(c.action)("updateOWAConnectedAccountStatus",(t,n)=>({userIdentity:t,accountState:n})),d=Object(c.action)("connectedAccountIsInErrorState",(t,n)=>Object(o.b)({name:"connectedAccountIsInErrorState",customData:{accountState_1:r[t],accountProvider_2:n}},{accountState:t})),l=Object(c.action)("connectedAccountsListRequested",t=>({isSuccess:t})),f=Object(c.action)("setAccountsStoreState",t=>({state:t}));var b,m=e(16);!function(t){t[t.None=0]="None",t[t.Loading=1]="Loading",t[t.AccountsLoadSuccessful=2]="AccountsLoadSuccessful",t[t.AccountsLoadError=3]="AccountsLoadError"}(b||(b={}));var h=Object(c.createStore)("OWAAccountsStore",{accountsMap:new m.ObservableMap({}),accountsLoadedState:b.None}),p=e(282),O=e(57),j=e(912),g=e(971),v=e(516);function I(t){var n;if(Object(v.a)()){const e=Object(g.a)(Object(j.a)(t));if(e&&"OFFICE365"==(null===(n=e.mailbox)||void 0===n?void 0:n.mailboxType))return!1}else if(t==Object(O.b)())return!1;return void 0!==w(t)}var y=e(972);function A(){return[...h().accountsMap.values()]}function w(t){return h().accountsMap.get(t)}function S(){var t,n;return Object(v.a)()?(null===(t=A())||void 0===t?void 0:t.length)>1?A()[1]:null:(null===(n=A())||void 0===n?void 0:n.length)>0?A()[0]:null}function x(){return A().filter(t=>t.accountState!=r.Valid)}function P(t){return A().filter(n=>t.includes(n.accountState))}function T(t){return A().filter(n=>n.accountProviderType==t)}function E(t){return I(t)?w(t).accountProviderType:null}function k(t){return Object(v.a)()?t.token:"Outlook"==t.accountProviderType?`MSAuth1.0 usertoken="${t.token}", type="MSACT"`:"Google"==t.accountProviderType||"ICloud"==t.accountProviderType||"Yahoo"==t.accountProviderType?`Bearer ${t.token}`:"Office365"==t.accountProviderType?(Object(y.a)(!1,"Office365 accounts should not use this function."),""):Object(p.a)(t.accountProviderType)}function L(t,n){return function(e){const r=w(e);return r?r[t]:n}}L("accountUniqueId","0");const C=L("accountState",r.Valid),U=()=>A().some(t=>!N(t.userIdentity)),D=L("accountProviderType",null),F=t=>"Outlook"==D(t),N=t=>C(t)==r.Valid,R=()=>A().length>0;function $(){return h().accountsLoadedState}var _=e(71),q=e(727),M=e(7),W=e(132),z=e(13);function H(){return!Object(W.a)("acctmonaccounts")&&(Object(z.i)("sourcelistapi")||Object(z.i)("accountsapi"))}Object(c.mutator)(a,({account:t})=>{Object(_.o)("owaAccountAdded",{accountStatus_1:r[t.accountState]}),h().accountsMap.set(t.userIdentity,t)}),Object(c.orchestrator)(a,({account:t})=>{H()&&q.a.importAndExecute(t.userIdentity,t.accountUniqueId,t.accountState)}),Object(c.mutator)(i,({userIdentity:t})=>{h().accountsMap.delete(t)}),Object(c.orchestrator)(i,({userIdentity:t})=>{H()&&q.c.importAndExecute(t)}),Object(c.mutator)(u,({userIdentity:t,accountToken:n,accountTokenExpiresIn:e})=>{const r=h().accountsMap.get(t);r.token=n,r.tokenExpiry=Object(M.j)(Object(M.Ub)(),e)}),Object(c.mutator)(s,({userIdentity:t,accountState:n})=>{const e=h().accountsMap.get(t);e.accountState==r.Valid&&n!=r.Valid&&Object(_.o)("owaConnectedAccountStatusUpdated",{accountStatus_1:r[n]}),e.accountState=n}),Object(c.orchestrator)(s,({userIdentity:t,accountState:n})=>{H()&&q.d.importAndExecute(t,n)}),Object(c.mutator)(l,t=>{const n=t.isSuccess?b.AccountsLoadSuccessful:b.AccountsLoadError;h().accountsLoadedState=n}),Object(c.mutator)(f,t=>{h().accountsLoadedState=t.state}),e.d(n,"c",(function(){return a})),e.d(n,"v",(function(){return i})),e.d(n,"y",(function(){return u})),e.d(n,"x",(function(){return s})),e.d(n,"d",(function(){return d})),e.d(n,"e",(function(){return l})),e.d(n,"w",(function(){return f})),e.d(n,"n",(function(){return A})),e.d(n,"k",(function(){return w})),e.d(n,"i",(function(){return S})),e.d(n,"f",(function(){return x})),e.d(n,"g",(function(){return P})),e.d(n,"o",(function(){return T})),e.d(n,"j",(function(){return E})),e.d(n,"m",(function(){return k})),e.d(n,"l",(function(){return C})),e.d(n,"q",(function(){return U})),e.d(n,"u",(function(){return F})),e.d(n,"t",(function(){return N})),e.d(n,"p",(function(){return R})),e.d(n,"h",(function(){return $})),e.d(n,"r",(function(){return I})),e.d(n,"s",(function(){return v.a})),e.d(n,"b",(function(){return r})),e.d(n,"a",(function(){return b}))},2916:function(t,n,e){"use strict";e.d(n,"a",(function(){return u}));var r=e(6),c=e(1778),o=e(2264),a=e(38);function i(t){return Object(r.k)(t)?null:("/"!=(t=t.trim())[t.length-1]&&(t+="/"),t)}function u(t){let n=t.AttachLongPathName;if(Object(o.e)(t.PermissionType)||t.ProviderType!==c.i)return n;const e=Object(a.a)(),r=e.ApplicationSettings;if(null!==n&&null!==r){let t;t=i(r.VDirIsPublicProperty||e.PublicComputersDetectionEnabled&&e.SessionSettings.IsPublicComputerSession?r.ExternalSPMySiteHostURL:r.InternalSPMySiteHostURL),null!==t&&(n=function(t,n){const e=new RegExp("^(https?)\\:[\\/\\\\]{2}([\\w\\.-]+)(\\:[0-9]{1,4})?(.*)$","i"),r=e.exec(t),c=e.exec(n);let o,a,i;return r&&c&&r.length>=5&&c.length>=5&&(c[1]&&c[2]&&(i=c[1]+"://"+c[2],o=!0),c[3]&&(i+=c[3]),r[4]&&(a=!0,i+=r[4])),o&&a?i:null}(n,t))}return null!==n?n:t.AttachLongPathName}},2945:function(t,n,e){"use strict";var r=e(2264),c=e(1696),o=e(7),a=e(47);var i=e(2956),u=e(1943);function s(t,n,e,s,d,l=null){if(1===n)return{allowDownload:!1,supportedPermissionLevels:null,sharingInfo:null};const f=Object(c.b)(e.Name),b=Object(i.a)(t,e,f),m=function(t,n,e){if(!t)return null;if(e&&e.length>0)return e;const r=Object(u.a)(n);return null==r?void 0:r.supportedPermissionLevels}(s,d,Object(r.a)(l,0)),h=(p=l)&&0===p.ResultCode?(Object(a.j)("doc-attachment-referenceAttachmentExpiration")||(p.ExpirationDate=null),{getSharingInfoSucceeded:!0,blocksDownload:p.BlocksDownload,canonicalUrl:p.CanonicalUrl,canShareInternally:p.CanShareInternally,canShareExternally:p.CanShareExternally,expirationDate:p.ExpirationDate?Object(o.qc)(p.ExpirationDate):null,canRefresh:!1,shareId:p.ShareId,siteUrl:p.SiteUrl,linkType:p.Type,itemUniqueId:p.ItemUniqueId,mimeType:p.MimeType}):null;var p;return s?function(t,n,e){return{allowDownload:t,supportedPermissionLevels:n,sharingInfo:e}}(b,m,h):function(t){return{allowDownload:t,supportedPermissionLevels:null,sharingInfo:null}}(b)}e.d(n,"a",(function(){return s}))},2956:function(t,n,e){"use strict";e.d(n,"a",(function(){return i}));var r=e(1738),c=e(1943),o=e(1786),a=e(47);function i(t,n,e){let i=t.level!==o.a.Block&&t.directFileAccessEnabled;return i&&Object(r.a)(n)&&(i=function(t,n){if(t.AttachLongPathName){const n=document.createElement("a");if(n.href=t.AttachLongPathName,!Object(a.j)("doc-unwrap-safelinks")&&n.host.indexOf(u,0)>0||n.search.indexOf(s,0)>0)return!1}if(function(t){const n=Object(c.a)(t);return null==n?void 0:n.supportDownload}(t.ProviderType)&&!t.AttachmentIsFolder)return".fluid"!==n&&!function(t,n){return!(t||n&&"application/onenote"!==n&&"image/png"!==n)}(n,t.ContentType);return!1}(n,e)),i}const u="safelinks.protection.outlook.com",s="b7780972f918485c8cfc32b1ba7438eb"},2998:function(t,n,e){"use strict";e.d(n,"a",(function(){return a}));var r=e(1778),c=e(2889),o=e(2238);async function a(t,n,e){if(!e)return Object(o.a)(t,n,2,e,!0);const a=n;return a.ProviderType===r.e&&a.AttachLongPathName?Object(c.a)(a):a.AttachmentThumbnailUrl||null}},326:function(t,n,e){"use strict";e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return a}));const r=/^[0-9a-z]{8}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{4}-[0-9a-z]{12}$/;function c(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function o(){return c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c()}function a(t){return r.test(t)}},369:function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},3788:function(t,n,e){"use strict";e.r(n);var r=e(3);var c=Object(r.action)("checkPendingAttachmentOperation",(t,n,e,r,c)=>({attachmentId:t,itemId:n,operationId:e,operationType:r,completeHandler:c}));function o(t){return Object.assign({__type:"CheckPendingAttachmentOperationRequest:#Exchange"},t)}var a=e(35);function i(t,n,e,r,c){const i=function(t,n,e,r){return o({ewsAttachmentId:t,itemId:n,operationId:e,operationType:r})}(t,n,e,r);return s=c,void 0===(u=i)||u.__type||(u=o(u)),Object(a.a)("CheckPendingAttachmentOperation",u,s);var u,s}var u=e(36),s=e(704),d=(Object(r.orchestrator)(c,async t=>{try{const n=t.itemId?t.itemId.mailboxInfo:t.attachmentId.mailboxInfo,e=await i(t.attachmentId?t.attachmentId.Id:null,t.itemId?t.itemId.Id:null,t.operationId,t.operationType,Object(s.a)(n));t.completeHandler(e)}catch(t){u.h.warn("checkPendingAttachmentOperationAction is failing with error: "+t)}}),e(1905)),l=e(1713),f=e(2142),b=e(9038);Object(r.orchestrator)(f.n,async t=>{if("object"==typeof t.id){const n=Object(l.a)(t.id);if(n){const e=n.model;await Object(b.a)([t.id],e.PermissionType),Object(d.a)(n.id)}}}),Object(r.mutator)(d.b,t=>{const{attachmentId:n,attachmentContentId:e}=t;Object(l.a)(n).model.ContentId=e}),Object(r.mutator)(d.c,t=>{const{attachmentId:n,isInline:e}=t;Object(l.a)(n).model.IsInline=e});var m=e(2413),h=e(702),p=Object(h.action)("setPreviewImageUrl")((function(t,n){Object(l.a)(t).previewImage.url=n})),O=e(2692),j=e(9063),g=e(1778),v=e(2889),I=e(1862),y=e(2238);async function A(t,n,e=!1){const r=Object(l.a)(t);if(Object(I.b)(r.model)&&r.model.ProviderType===g.e){const n=await async function(t){const n=await Object(v.a)(t);if(null==n)throw new Error("URL not available");return n+"2"}(r.model);p(t,n)}else if(!Object(I.b)(r.model)||r.model.ProviderType===g.h||r.model.ProviderType===g.i){const c=Object(y.a)(t,r.model,1,1===r.type,n,e);p(t,c)}}var w=e(2802),S=e(2945),x=Object(h.action)("setAttachmentInfo")((function(t,n){Object(l.a)(t).info=n}));e.d(n,"addAndInitializeAttachments",(function(){return m.a})),e.d(n,"setPreviewImageUrl",(function(){return p})),e.d(n,"refreshDownloadUrl",(function(){return O.a})),e.d(n,"refreshThumbnailImageUrl",(function(){return j.a})),e.d(n,"refreshPreviewImageUrl",(function(){return A})),e.d(n,"getAttachment",(function(){return l.a})),e.d(n,"checkPendingAttachmentOperation",(function(){return c})),e.d(n,"shouldShowImageView",(function(){return w.a})),e.d(n,"createAttachmentInfo",(function(){return S.a})),e.d(n,"setAttachmentInfo",(function(){return x}))},380:function(t,n,e){"use strict";function r(t,n){return Object.prototype.hasOwnProperty.call(t,n)}t.exports=function(t,n,e,o){n=n||"&",e=e||"=";var a={};if("string"!=typeof t||0===t.length)return a;var i=/\+/g;t=t.split(n);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var s=t.length;u>0&&s>u&&(s=u);for(var d=0;d<s;++d){var l,f,b,m,h=t[d].replace(i,"%20"),p=h.indexOf(e);p>=0?(l=h.substr(0,p),f=h.substr(p+1)):(l=h,f=""),b=decodeURIComponent(l),m=decodeURIComponent(f),r(a,b)?c(a[b])?a[b].push(m):a[b]=[a[b],m]:a[b]=m}return a};var c=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},381:function(t,n,e){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,n,e,i){return n=n||"&",e=e||"=",null===t&&(t=void 0),"object"==typeof t?o(a(t),(function(a){var i=encodeURIComponent(r(a))+e;return c(t[a])?o(t[a],(function(t){return i+encodeURIComponent(r(t))})).join(n):i+encodeURIComponent(r(t[a]))})).join(n):i?encodeURIComponent(r(i))+e+encodeURIComponent(r(t)):""};var c=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,n){if(t.map)return t.map(n);for(var e=[],r=0;r<t.length;r++)e.push(n(t[r],r));return e}var a=Object.keys||function(t){var n=[];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}},516:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(132),c=e(13);function o(){return Object(r.a)("acctmonaccounts")&&Object(c.i)("acctmonaccounts")}},611:function(t,n,e){"use strict";function r(t){return Object.assign({__type:"FolderId:#Exchange"},t)}e.d(n,"a",(function(){return r}))},614:function(t,n,e){"use strict";e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return a}));var r=e(132),c=e(13);function o(){return Object(r.a)("acctmonaccounts")&&Object(c.i)("acctmonaccounts")}function a(){return o()||!Object(r.a)("acctmonaccounts")&&Object(c.i)("accountsapi")}},6742:function(t,n,e){"use strict";var r=e(1905),c=e(1713),o=e(2916),a=e(47),i=e(702);n.a=Object(i.action)("setAttachmentPermissionLevel")((function(t,n,e,i){const u=Object(c.a)(t),s=u.model;s.PermissionType=n,e&&(s.AttachLongPathName=e,u.openUrl=Object(o.a)(s)),Object(a.j)("doc-attachment-referenceAttachmentExpiration")&&u.info&&u.info.sharingInfo&&(u.info.sharingInfo.expirationDate=i),Object(r.a)(t)}))},704:function(t,n,e){"use strict";function r(t,n){return t?Object.assign({mailboxInfo:t},n):null!=n?n:void 0}e.d(n,"a",(function(){return r}))},707:function(t,n,e){"use strict";function r(t){return Object.assign({__type:"ItemResponseShape:#Exchange"},t)}e.d(n,"a",(function(){return r}))},715:function(t,n,e){"use strict";var r=e(315);const c=e.n(r)()("Profile",{profileId:"",profileName:"",accountSources:[]});n.a=c},727:function(t,n,e){"use strict";e.d(n,"b",(function(){return o})),e.d(n,"a",(function(){return a})),e.d(n,"c",(function(){return i})),e.d(n,"d",(function(){return u}));var r=e(4);const c=new r.b(()=>e.e(850).then(e.bind(null,1569)));let o=new r.a(c,t=>t.initOwaAccountSourceListStore),a=new r.a(c,t=>t.addConnectedAccount),i=new r.a(c,t=>t.removeConnectedAccount),u=new r.a(c,t=>t.updateConnectedAccountState)},80:function(t,n,e){"use strict";var r=e(3);function c(t,n){return(n=n||{}).dp=t,n}function o(t,n,e){return Object(r.action)(t,(...r)=>{const o=n?n(...r):{},a=e?e(o,...r):{name:t};return a.name=a.name||t,a.options=a.options||{isCore:!0},c(a,o)})}function a(t){const{value:n,exactMatches:e=[0,1,2,3,4,5],buckets:r=[10,15,25,50,100]}=t;if(0===r.length)throw new Error("getAggregationBucket: buckets cannot be an empty array");if(e[0]&&n<e[0])return`<${e[0]}`;if(e.includes(n))return`${n}`;for(let t=0;t<r.length;t++)if(n<=r[t])return`${t>0?r[t-1]+1:e[e.length-1]+1||"0"}-${r[t]}`;return`${r[r.length-1]+1}+`}e.d(n,"a",(function(){return o})),e.d(n,"b",(function(){return c})),e.d(n,"c",(function(){return a}))},9038:function(t,n,e){"use strict";var r=e(7),c=e(6742);function o(t){return Object.assign({__type:"SetAttachmentPermissionsRequest:#Exchange"},t)}var a=e(35);function i(t,n,e=null,r=!1){const c=function(t,n,e=null,r=!1){return o({AttachmentIds:t,PermissionLevel:n,NewAttachLongPathNames:e,SetToOriginalPermissionLevel:r})}(t,n,e,r);return void 0===(i={request:c}).request||i.request.__type||(i.request=o(i.request)),Object(a.a)("SetAttachmentPermissionsV2",i,u);var i,u}async function u(t,n,e=null,o=!1){const a=await i(t.map(t=>t.Id),n,e,o);if(!a.OperationSucceeded||!a.NewAttachLongPathNames||a.NewAttachLongPathNames.length!==t.length)throw new Error("Error setting attachment permissions");t.forEach((t,e)=>{var o;let i=null;(null===(o=a.ExpirationDates)||void 0===o?void 0:o[e])&&(i=Object(r.qc)(a.ExpirationDates[e])),Object(c.a)(t,n,a.NewAttachLongPathNames[e],i)})}e.d(n,"a",(function(){return u}))},912:function(t,n,e){"use strict";e.d(n,"a",(function(){return c}));var r=e(715);function c(t){const n=Object(r.a)().accountSources.filter(n=>{var e;return(null===(e=n.mailbox)||void 0===e?void 0:e.emailAddress)===t});if(n.length>1)throw new Error("Found "+n.length+" duplicated accounts with same email address: "+t);return 1===n.length?n[0].id:null}},960:function(t,n,e){"use strict";function r(t){return Object.assign({__type:"FindItemJsonRequest:#Exchange"},t)}e.d(n,"a",(function(){return r}))},970:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(35),c=e(960);function o(t,n){return void 0===t||t.__type||(t=Object(c.a)(t)),Object(r.a)("FindItem",t,n)}},971:function(t,n,e){"use strict";e.d(n,"a",(function(){return o}));var r=e(36),c=e(715);function o(t){const n=Object(c.a)().accountSources.filter(n=>n.id===t);if(1===n.length)return n[0];n.length>1&&r.h.warn("Found more than one account with the same source id")}},972:function(t,n,e){"use strict";function r(t,n){if(!t)throw new Error(n||"Assertion failed")}e.d(n,"a",(function(){return r}))},973:function(t,n,e){"use strict";function r(t){return Object.assign({__type:"FindItemRequest:#Exchange"},t)}e.d(n,"a",(function(){return r}))}}]);
//# sourceMappingURL=owa.519.js.map
self.scriptsLoaded = self.scriptsLoaded || {};self.scriptsLoaded['owa.519.js'] = 1;